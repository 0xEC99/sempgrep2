typedef unsigned char   undefined;

typedef unsigned char    byte;
typedef unsigned int    dword;
typedef long long    longlong;
typedef unsigned int    uint;
typedef unsigned long    ulong;
typedef unsigned long long    ulonglong;
typedef unsigned char    undefined1;
typedef unsigned short    undefined2;
typedef unsigned int    undefined3;
typedef unsigned int    undefined4;
typedef unsigned long long    undefined6;
typedef unsigned long long    undefined7;
typedef unsigned long long    undefined8;
typedef unsigned short    ushort;
typedef unsigned short    word;
typedef ushort sa_family_t;

typedef void _IO_lock_t;

typedef struct _IO_marker _IO_marker, *P_IO_marker;

typedef struct _IO_FILE _IO_FILE, *P_IO_FILE;

typedef long __off_t;

typedef longlong __quad_t;

typedef __quad_t __off64_t;

typedef ulong size_t;

struct _IO_FILE {
    int _flags;
    char * _IO_read_ptr;
    char * _IO_read_end;
    char * _IO_read_base;
    char * _IO_write_base;
    char * _IO_write_ptr;
    char * _IO_write_end;
    char * _IO_buf_base;
    char * _IO_buf_end;
    char * _IO_save_base;
    char * _IO_backup_base;
    char * _IO_save_end;
    struct _IO_marker * _markers;
    struct _IO_FILE * _chain;
    int _fileno;
    int _flags2;
    __off_t _old_offset;
    ushort _cur_column;
    char _vtable_offset;
    char _shortbuf[1];
    _IO_lock_t * _lock;
    __off64_t _offset;
    void * __pad1;
    void * __pad2;
    void * __pad3;
    void * __pad4;
    size_t __pad5;
    int _mode;
    char _unused2[40];
};

struct _IO_marker {
    struct _IO_marker * _next;
    struct _IO_FILE * _sbuf;
    int _pos;
};

typedef struct stat stat, *Pstat;

typedef ulonglong __u_quad_t;

typedef __u_quad_t __dev_t;

typedef ulong __ino_t;

typedef uint __mode_t;

typedef uint __nlink_t;

typedef uint __uid_t;

typedef uint __gid_t;

typedef long __blksize_t;

typedef long __blkcnt_t;

typedef struct timespec timespec, *Ptimespec;

typedef long __time_t;

struct timespec {
    __time_t tv_sec;
    long tv_nsec;
};

struct stat {
    __dev_t st_dev;
    ushort __pad1;
    __ino_t st_ino;
    __mode_t st_mode;
    __nlink_t st_nlink;
    __uid_t st_uid;
    __gid_t st_gid;
    __dev_t st_rdev;
    ushort __pad2;
    __off_t st_size;
    __blksize_t st_blksize;
    __blkcnt_t st_blocks;
    struct timespec st_atim;
    struct timespec st_mtim;
    struct timespec st_ctim;
    ulong __unused4;
    ulong __unused5;
};

typedef void * __gnuc_va_list;

typedef struct timeval timeval, *Ptimeval;

typedef long __suseconds_t;

struct timeval {
    __time_t tv_sec;
    __suseconds_t tv_usec;
};

typedef struct timezone timezone, *Ptimezone;

typedef struct timezone * __timezone_ptr_t;

struct timezone {
    int tz_minuteswest;
    int tz_dsttime;
};

typedef struct tm tm, *Ptm;

struct tm {
    int tm_sec;
    int tm_min;
    int tm_hour;
    int tm_mday;
    int tm_mon;
    int tm_year;
    int tm_wday;
    int tm_yday;
    int tm_isdst;
    long tm_gmtoff;
    char * tm_zone;
};

typedef __time_t time_t;

typedef struct sigaction sigaction, *Psigaction;

typedef union _union_1051 _union_1051, *P_union_1051;

typedef struct siginfo siginfo, *Psiginfo;

typedef struct siginfo siginfo_t;

typedef struct __sigset_t __sigset_t, *P__sigset_t;

typedef void (* __sighandler_t)(int);

typedef union _union_1031 _union_1031, *P_union_1031;

typedef struct _struct_1032 _struct_1032, *P_struct_1032;

typedef struct _struct_1033 _struct_1033, *P_struct_1033;

typedef struct _struct_1034 _struct_1034, *P_struct_1034;

typedef struct _struct_1035 _struct_1035, *P_struct_1035;

typedef struct _struct_1036 _struct_1036, *P_struct_1036;

typedef struct _struct_1037 _struct_1037, *P_struct_1037;

typedef int __pid_t;

typedef union sigval sigval, *Psigval;

typedef union sigval sigval_t;

typedef long __clock_t;

struct _struct_1032 {
    __pid_t si_pid;
    __uid_t si_uid;
};

union sigval {
    int sival_int;
    void * sival_ptr;
};

struct _struct_1034 {
    __pid_t si_pid;
    __uid_t si_uid;
    sigval_t si_sigval;
};

struct _struct_1035 {
    __pid_t si_pid;
    __uid_t si_uid;
    int si_status;
    __clock_t si_utime;
    __clock_t si_stime;
};

struct _struct_1037 {
    long si_band;
    int si_fd;
};

struct _struct_1033 {
    int si_tid;
    int si_overrun;
    sigval_t si_sigval;
};

struct _struct_1036 {
    void * si_addr;
};

union _union_1031 {
    int _pad[29];
    struct _struct_1032 _kill;
    struct _struct_1033 _timer;
    struct _struct_1034 _rt;
    struct _struct_1035 _sigchld;
    struct _struct_1036 _sigfault;
    struct _struct_1037 _sigpoll;
};

struct __sigset_t {
    ulong __val[32];
};

union _union_1051 {
    __sighandler_t sa_handler;
    void (* sa_sigaction)(int, siginfo_t *, void *);
};

struct siginfo {
    int si_signo;
    int si_errno;
    int si_code;
    union _union_1031 _sifields;
};

struct sigaction {
    union _union_1051 __sigaction_handler;
    struct __sigset_t sa_mask;
    int sa_flags;
    void (* sa_restorer)(void);
};

typedef struct in_addr in_addr, *Pin_addr;

typedef uint uint32_t;

typedef uint32_t in_addr_t;

struct in_addr {
    in_addr_t s_addr;
};

typedef struct _IO_FILE FILE;

typedef struct sockaddr sockaddr, *Psockaddr;

struct sockaddr {
    sa_family_t sa_family;
    char sa_data[14];
};

typedef uint __socklen_t;

typedef __socklen_t socklen_t;

typedef long __fd_mask;

typedef struct __sigset_t sigset_t;

typedef struct fd_set fd_set, *Pfd_set;

struct fd_set {
    __fd_mask fds_bits[32];
};

typedef int __ssize_t;

typedef __ssize_t ssize_t;

typedef uint __useconds_t;

typedef struct evp_pkey_ctx_st evp_pkey_ctx_st, *Pevp_pkey_ctx_st;

struct evp_pkey_ctx_st {
};

typedef struct evp_pkey_ctx_st EVP_PKEY_CTX;

typedef union pthread_mutex_t pthread_mutex_t, *Ppthread_mutex_t;

typedef struct __pthread_mutex_s __pthread_mutex_s, *P__pthread_mutex_s;

typedef union _union_13 _union_13, *P_union_13;

typedef struct __pthread_internal_slist __pthread_internal_slist, *P__pthread_internal_slist;

typedef struct __pthread_internal_slist __pthread_slist_t;

struct __pthread_internal_slist {
    struct __pthread_internal_slist * __next;
};

union _union_13 {
    int __spins;
    __pthread_slist_t __list;
};

struct __pthread_mutex_s {
    int __lock;
    uint __count;
    int __owner;
    int __kind;
    uint __nusers;
    union _union_13 field5_0x14;
};

union pthread_mutex_t {
    struct __pthread_mutex_s __data;
    char __size[24];
    long __align;
};

typedef union pthread_mutexattr_t pthread_mutexattr_t, *Ppthread_mutexattr_t;

union pthread_mutexattr_t {
    char __size[4];
    int __align;
};

typedef struct Elf32_Phdr Elf32_Phdr, *PElf32_Phdr;

typedef enum Elf_ProgramHeaderType_MIPS {
    PT_NULL=0,
    PT_LOAD=1,
    PT_DYNAMIC=2,
    PT_INTERP=3,
    PT_NOTE=4,
    PT_SHLIB=5,
    PT_PHDR=6,
    PT_TLS=7,
    PT_GNU_EH_FRAME=1685382480,
    PT_GNU_STACK=1685382481,
    PT_GNU_RELRO=1685382482,
    PT_MIPS_REGINFO=1879048192,
    PT_MIPS_RTPROC=1879048193,
    PT_MIPS_OPTIONS=1879048194,
    PT_MIPS_ABIFLAGS=1879048195
} Elf_ProgramHeaderType_MIPS;

struct Elf32_Phdr {
    enum Elf_ProgramHeaderType_MIPS p_type;
    dword p_offset;
    dword p_vaddr;
    dword p_paddr;
    dword p_filesz;
    dword p_memsz;
    dword p_flags;
    dword p_align;
};

typedef struct Elf32_Sym Elf32_Sym, *PElf32_Sym;

struct Elf32_Sym {
    dword st_name;
    dword st_value;
    dword st_size;
    byte st_info;
    byte st_other;
    word st_shndx;
};

typedef enum Elf_SectionHeaderType_MIPS {
    SHT_NULL=0,
    SHT_PROGBITS=1,
    SHT_SYMTAB=2,
    SHT_STRTAB=3,
    SHT_RELA=4,
    SHT_HASH=5,
    SHT_DYNAMIC=6,
    SHT_NOTE=7,
    SHT_NOBITS=8,
    SHT_REL=9,
    SHT_SHLIB=10,
    SHT_DYNSYM=11,
    SHT_INIT_ARRAY=14,
    SHT_FINI_ARRAY=15,
    SHT_PREINIT_ARRAY=16,
    SHT_GROUP=17,
    SHT_SYMTAB_SHNDX=18,
    SHT_ANDROID_REL=1610612737,
    SHT_ANDROID_RELA=1610612738,
    SHT_GNU_ATTRIBUTES=1879048181,
    SHT_GNU_HASH=1879048182,
    SHT_GNU_LIBLIST=1879048183,
    SHT_CHECKSUM=1879048184,
    SHT_SUNW_move=1879048186,
    SHT_SUNW_COMDAT=1879048187,
    SHT_SUNW_syminfo=1879048188,
    SHT_GNU_verdef=1879048189,
    SHT_GNU_verneed=1879048190,
    SHT_GNU_versym=1879048191,
    SHT_MIPS_LIBLIST=1879048192,
    SHT_MIPS_MSYM=1879048193,
    SHT_MIPS_CONFLICT=1879048194,
    SHT_MIPS_GPTAB=1879048195,
    SHT_MIPS_UCODE=1879048196,
    SHT_MIPS_DEBUG=1879048197,
    SHT_MIPS_REGINFO=1879048198,
    SHT_MIPS_PACKAGE=1879048199,
    SHT_MIPS_PACKSYM=1879048200,
    SHT_MIPS_RELD=1879048201,
    =1879048203,
    SHT_MIPS_CONTENT=1879048204,
    SHT_MIPS_OPTIONS=1879048205,
    SHT_MIPS_SHDR=1879048208,
    SHT_MIPS_FDESC=1879048209,
    SHT_MIPS_EXTSYM=1879048210,
    SHT_MIPS_DENSE=1879048211,
    SHT_MIPS_PDESC=1879048212,
    SHT_MIPS_LOCSYM=1879048213,
    SHT_MIPS_AUXSYM=1879048214,
    SHT_MIPS_OPTSYM=1879048215,
    SHT_MIPS_LOCSTR=1879048216,
    SHT_MIPS_LINE=1879048217,
    SHT_MIPS_RFDESC=1879048218,
    SHT_MIPS_DELTASYM=1879048219,
    SHT_MIPS_DELTAINST=1879048220,
    SHT_MIPS_DELTACLASS=1879048221,
    SHT_MIPS_DWARF=1879048222,
    SHT_MIPS_DELTADECL=1879048223,
    SHT_MIPS_SYMBOL_LIB=1879048224,
    SHT_MIPS_EVENTS=1879048225,
    SHT_MIPS_TRANSLATE=1879048226,
    SHT_MIPS_PIXIE=1879048227,
    SHT_MIPS_XLATE=1879048228,
    SHT_MIPS_XLATE_DEBUG=1879048229,
    SHT_MIPS_WHIRL=1879048230,
    SHT_MIPS_EH_REGION=1879048231,
    SHT_MIPS_XLATE_OLD=1879048232,
    SHT_MIPS_PDR_EXCEPTION=1879048233,
    SHT_MIPS_ABIFLAGS=1879048234
} Elf_SectionHeaderType_MIPS;

typedef struct Elf32_Dyn_MIPS Elf32_Dyn_MIPS, *PElf32_Dyn_MIPS;

typedef enum Elf32_DynTag_MIPS {
    DT_NULL=0,
    DT_NEEDED=1,
    DT_PLTRELSZ=2,
    DT_PLTGOT=3,
    DT_HASH=4,
    DT_STRTAB=5,
    DT_SYMTAB=6,
    DT_RELA=7,
    DT_RELASZ=8,
    DT_RELAENT=9,
    DT_STRSZ=10,
    DT_SYMENT=11,
    DT_INIT=12,
    DT_FINI=13,
    DT_SONAME=14,
    DT_RPATH=15,
    DT_SYMBOLIC=16,
    DT_REL=17,
    DT_RELSZ=18,
    DT_RELENT=19,
    DT_PLTREL=20,
    DT_DEBUG=21,
    DT_TEXTREL=22,
    DT_JMPREL=23,
    DT_BIND_NOW=24,
    DT_INIT_ARRAY=25,
    DT_FINI_ARRAY=26,
    DT_INIT_ARRAYSZ=27,
    DT_FINI_ARRAYSZ=28,
    DT_RUNPATH=29,
    DT_FLAGS=30,
    DT_PREINIT_ARRAY=32,
    DT_PREINIT_ARRAYSZ=33,
    DT_RELRSZ=35,
    DT_RELR=36,
    DT_RELRENT=37,
    DT_ANDROID_REL=1610612751,
    DT_ANDROID_RELSZ=1610612752,
    DT_ANDROID_RELA=1610612753,
    DT_ANDROID_RELASZ=1610612754,
    DT_ANDROID_RELR=1879040000,
    DT_ANDROID_RELRSZ=1879040001,
    DT_ANDROID_RELRENT=1879040003,
    DT_GNU_PRELINKED=1879047669,
    DT_GNU_CONFLICTSZ=1879047670,
    DT_GNU_LIBLISTSZ=1879047671,
    DT_CHECKSUM=1879047672,
    DT_PLTPADSZ=1879047673,
    DT_MOVEENT=1879047674,
    DT_MOVESZ=1879047675,
    DT_FEATURE_1=1879047676,
    DT_POSFLAG_1=1879047677,
    DT_SYMINSZ=1879047678,
    DT_SYMINENT=1879047679,
    DT_GNU_XHASH=1879047924,
    DT_GNU_HASH=1879047925,
    DT_TLSDESC_PLT=1879047926,
    DT_TLSDESC_GOT=1879047927,
    DT_GNU_CONFLICT=1879047928,
    DT_GNU_LIBLIST=1879047929,
    DT_CONFIG=1879047930,
    DT_DEPAUDIT=1879047931,
    DT_AUDIT=1879047932,
    DT_PLTPAD=1879047933,
    DT_MOVETAB=1879047934,
    DT_SYMINFO=1879047935,
    DT_VERSYM=1879048176,
    DT_RELACOUNT=1879048185,
    DT_RELCOUNT=1879048186,
    DT_FLAGS_1=1879048187,
    DT_VERDEF=1879048188,
    DT_VERDEFNUM=1879048189,
    DT_VERNEED=1879048190,
    DT_VERNEEDNUM=1879048191,
    DT_MIPS_RLD_VERSION=1879048193,
    DT_MIPS_TIME_STAMP=1879048194,
    DT_MIPS_ICHECKSUM=1879048195,
    DT_MIPS_IVERSION=1879048196,
    DT_MIPS_FLAGS=1879048197,
    DT_MIPS_BASE_ADDRESS=1879048198,
    DT_MIPS_MSYM=1879048199,
    DT_MIPS_CONFLICT=1879048200,
    DT_MIPS_LIBLIST=1879048201,
    DT_MIPS_LOCAL_GOTNO=1879048202,
    DT_MIPS_CONFLICTNO=1879048203,
    DT_MIPS_LIBLISTNO=1879048208,
    DT_MIPS_SYMTABNO=1879048209,
    DT_MIPS_UNREFEXTNO=1879048210,
    DT_MIPS_GOTSYM=1879048211,
    DT_MIPS_HIPAGENO=1879048212,
    DT_MIPS_RLD_MAP=1879048214,
    DT_MIPS_DELTA_CLASS=1879048215,
    DT_MIPS_DELTA_CLASS_NO=1879048216,
    DT_MIPS_DELTA_INSTANCE=1879048217,
    DT_MIPS_DELTA_INSTANCE_NO=1879048218,
    DT_MIPS_DELTA_RELOC=1879048219,
    DT_MIPS_DELTA_RELOC_NO=1879048220,
    DT_MIPS_DELTA_SYM=1879048221,
    DT_MIPS_DELTA_SYM_NO=1879048222,
    DT_MIPS_DELTA_CLASSSYM=1879048224,
    DT_MIPS_DELTA_CLASSSYM_NO=1879048225,
    DT_MIPS_CXX_FLAGS=1879048226,
    DT_MIPS_PIXIE_INIT=1879048227,
    DT_MIPS_SYMBOL_LIB=1879048228,
    DT_MIPS_LOCALPAGE_GOTIDX=1879048229,
    DT_MIPS_LOCAL_GOTIDX=1879048230,
    DT_MIPS_HIDDEN_GOTIDX=1879048231,
    DT_MIPS_PROTECTED_GOTIDX=1879048232,
    DT_MIPS_OPTIONS=1879048233,
    DT_MIPS_INTERFACE=1879048234,
    DT_MIPS_DYNSTR_ALIGN=1879048235,
    DT_MIPS_INTERFACE_SIZE=1879048236,
    DT_MIPS_RLD_TEXT_RESOLVE_ADDR=1879048237,
    DT_MIPS_PERF_SUFFIX=1879048238,
    DT_MIPS_COMPACT_SIZE=1879048239,
    DT_MIPS_GP_VALUE=1879048240,
    DT_MIPS_AUX_DYNAMIC=1879048241,
    DT_MIPS_PLTGOT=1879048242,
    DT_MIPS_RWPLT=1879048244,
    DT_MIPS_RLD_MAP_REL=1879048245,
    DT_AUXILIARY=2147483645,
    DT_FILTER=2147483647
} Elf32_DynTag_MIPS;

struct Elf32_Dyn_MIPS {
    enum Elf32_DynTag_MIPS d_tag;
    dword d_val;
};

typedef struct Elf32_Shdr Elf32_Shdr, *PElf32_Shdr;

struct Elf32_Shdr {
    dword sh_name;
    enum Elf_SectionHeaderType_MIPS sh_type;
    dword sh_flags;
    dword sh_addr;
    dword sh_offset;
    dword sh_size;
    dword sh_link;
    dword sh_info;
    dword sh_addralign;
    dword sh_entsize;
};

typedef struct Elf32_Ehdr Elf32_Ehdr, *PElf32_Ehdr;

struct Elf32_Ehdr {
    byte e_ident_magic_num;
    char e_ident_magic_str[3];
    byte e_ident_class;
    byte e_ident_data;
    byte e_ident_version;
    byte e_ident_osabi;
    byte e_ident_abiversion;
    byte e_ident_pad[7];
    word e_type;
    word e_machine;
    dword e_version;
    dword e_entry;
    dword e_phoff;
    dword e_shoff;
    dword e_flags;
    word e_ehsize;
    word e_phentsize;
    word e_phnum;
    word e_shentsize;
    word e_shnum;
    word e_shstrndx;
};




int _init(EVP_PKEY_CTX *ctx)

{
  int iVar1;
  
  FUN_00408730();
  iVar1 = FUN_00489090();
  return iVar1;
}



void processEntry entry(undefined4 param_1,undefined4 param_2)

{
  undefined auStack_20 [16];
  code *local_10;
  undefined4 local_c;
  undefined *local_8;
  
  local_8 = auStack_20;
  local_10 = _fini;
  local_c = param_1;
  __uClibc_main(main,param_2,&stack0x00000004,_init);
  do {
                    // WARNING: Do nothing block with infinite loop
  } while( true );
}



void FUN_00408660(void)

{
  code *pcVar1;
  
  if (__bss_start == '\0') {
    while( true ) {
      pcVar1 = *(code **)_fdata;
      if (pcVar1 == (code *)0x0) break;
      _fdata = _fdata + 4;
      (*pcVar1)();
    }
    __deregister_frame_info(&DWORD_00494a64);
    __bss_start = '\x01';
  }
  return;
}



void FUN_00408730(void)

{
  __register_frame_info(&DWORD_00494a64,&DAT_004d8c64);
  if (DAT_004d4a78 != 0) {
    _Jv_RegisterClasses(&DAT_004d4a78);
  }
  return;
}



void trace(uint param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 local_res8;
  undefined4 local_resc;
  
  if ((Debug_Trace_Level & param_1) == param_1) {
    if (param_2 != (char *)0x0) {
      local_res8 = param_3;
      local_resc = param_4;
      fprintf(stderr,"%s: ","alphapd",param_4,&_gp);
      vfprintf(stderr,param_2,&local_res8);
      return;
    }
  }
  return;
}



void FUN_00408888(int param_1)

{
  char *pcVar1;
  
  pcVar1 = "SIGINT!";
  if (param_1 != 2) {
    pcVar1 = "SIGTERM!";
    if (param_1 != 0xf) {
      return;
    }
  }
  trace(0,pcVar1);
  gotsigterm = 1;
  return;
}



void httpd_main(void)

{
  bool bVar1;
  uint uVar2;
  
  bVar1 = gotsigterm == 0;
  while (bVar1) {
    uVar2 = getSysInfoLong(0x38);
    if ((((uVar2 >> 9 & 1) != 0) || ((uVar2 >> 0xf & 1) != 0)) || ((uVar2 >> 0x10 & 1) != 0)) {
      if ((uVar2 >> 9 & 1) == 0) {
        if ((uVar2 >> 0xf & 1) == 0) {
          if ((uVar2 >> 0x10 & 1) != 0) {
            setSysInfoLong(0x3a,0x10000);
          }
        }
        else {
          setSysInfoLong(0x3a,0x8000);
        }
      }
      else {
        setSysInfoLong(0x3a,0x200);
      }
      websEndAuthentication();
      nvram_close(0);
      nvram_init(0);
      websStartAuthentication();
      trace(0x10,"reload configuration!\n");
    }
    websSocketEventPoll();
    usleep(1000);
    websCgiReapChildren();
    usleep(1000);
    websFrameReapChildren();
    usleep(1000);
    websStreamReapChildren();
    usleep(1000);
    websTimeoutProcess();
    usleep(1000);
    websAntiBruteReapChildren();
    usleep(1000);
    bVar1 = gotsigterm == 0;
  }
  return;
}



void preparesslkey(void)

{
  char *__s;
  char *__s_00;
  FILE *pFVar1;
  size_t sVar2;
  int iVar3;
  size_t sVar4;
  undefined *puVar5;
  code *pcVar6;
  undefined auStack_1020 [4096];
  
  __s = (char *)nvram_bufget(0,"SSLCertificate1");
  __s_00 = (char *)nvram_bufget(0,"SSLCertificate2");
  if ((*__s == '\0') || (*__s_00 == '\0')) {
    doSystem("/etc_ro/gensslkey.sh");
    pFVar1 = fopen("/etc_ro/servercert.pem","r");
    if (pFVar1 == (FILE *)0x0) {
      trace(0x10,"cannot open /etc_ro/servercert.pem");
    }
    else {
      puVar5 = auStack_1020;
      memset(puVar5,0,0x1000);
      sVar4 = 0x1000;
      do {
        sVar2 = fread(puVar5,1,sVar4,pFVar1);
        puVar5 = puVar5 + sVar2;
        sVar4 = sVar4 - sVar2;
        if ((int)sVar2 < 0) {
          trace(0x10,"failure to read /etc_ro/servercert.pem");
          break;
        }
        iVar3 = feof(pFVar1);
      } while (iVar3 == 0);
      nvram_bufset(0,"SSLCertificate1",auStack_1020);
      fclose(pFVar1);
    }
    pFVar1 = fopen("/etc_ro/serverkey.pem","r");
    if (pFVar1 == (FILE *)0x0) {
      trace(0x10,"cannot open /etc_ro/serverkey.pem");
      pcVar6 = nvram_commit;
      pFVar1 = (FILE *)0x0;
    }
    else {
      puVar5 = auStack_1020;
      memset(puVar5,0,0x1000);
      sVar4 = 0x1000;
      do {
        sVar2 = fread(puVar5,1,sVar4,pFVar1);
        puVar5 = puVar5 + sVar2;
        sVar4 = sVar4 - sVar2;
        if ((int)sVar2 < 0) {
          trace(0x10,"failure to read /etc_ro/serverkey.pem");
          nvram_bufset(0,"SSLCertificate2",auStack_1020);
          fclose(pFVar1);
          goto LAB_00408db8;
        }
        iVar3 = feof(pFVar1);
      } while (iVar3 == 0);
      nvram_bufset(0,"SSLCertificate2",auStack_1020);
      fclose(pFVar1);
LAB_00408db8:
      pFVar1 = (FILE *)0x0;
      pcVar6 = nvram_commit;
    }
  }
  else {
    pFVar1 = fopen("/etc_ro/servercert.pem","w+");
    if (pFVar1 == (FILE *)0x0) {
      trace(0x10,"cannot open /etc_ro/servercert.pem");
    }
    else {
      sVar4 = strlen(__s);
      do {
        if ((int)sVar4 < 1) goto LAB_00408e64;
        sVar2 = fwrite(__s,1,sVar4,pFVar1);
        sVar4 = sVar4 - sVar2;
        __s = __s + sVar2;
      } while (-1 < (int)sVar2);
      trace(0x10,"failure to write /etc_ro/servercert.pem");
LAB_00408e64:
      fclose(pFVar1);
    }
    pFVar1 = fopen("/etc_ro/serverkey.pem","w+");
    if (pFVar1 == (FILE *)0x0) {
      trace(0x10,"cannot open /etc_ro/serverkey.pem");
      return;
    }
    sVar4 = strlen(__s_00);
    do {
      if ((int)sVar4 < 1) {
        pcVar6 = fclose;
        goto LAB_00408dc8;
      }
      sVar2 = fwrite(__s_00,1,sVar4,pFVar1);
      sVar4 = sVar4 - sVar2;
      __s_00 = __s_00 + sVar2;
    } while (-1 < (int)sVar2);
    trace(0x10,"failure to write /etc_ro/serverkey.pem");
    pcVar6 = fclose;
  }
LAB_00408dc8:
  (*pcVar6)(pFVar1);
  return;
}



undefined4 main(void)

{
  FILE *pFVar1;
  char *pcVar2;
  int iVar3;
  __pid_t _Var4;
  char *__nptr;
  int iVar5;
  undefined4 uVar6;
  undefined local_228 [144];
  undefined local_198 [368];
  __pid_t local_28 [2];
  
  iVar5 = WebSrv_HTTP_Port;
  trace(0,"Startup!\n");
  local_28[0] = 0;
  pFVar1 = fopen(PTR_s__var_run_alphapd_pid_004d4a9c,"r");
  if (pFVar1 != (FILE *)0x0) {
    do {
      pcVar2 = fgets(local_228,0x200,pFVar1);
      if (pcVar2 == (char *)0x0) goto LAB_00409148;
      iVar3 = sscanf(local_228,"%d",local_28);
    } while (iVar3 < 0);
    iVar3 = 10;
    while( true ) {
      _Var4 = getpgid(local_28[0]);
      if ((_Var4 < 0) || (iVar3 < 1)) break;
      trace(0x10,"wait last alphapd exit = %d(%d)\n",local_28[0],iVar3);
      sleep(1);
      iVar3 = iVar3 + -1;
    }
LAB_00409148:
    fclose(pFVar1);
  }
  doSystem("rm -f /etc_ro/web/pack/dbgulf.lzma");
  pFVar1 = fopen(PTR_s__var_run_alphapd_pid_004d4a9c,"w+");
  if (pFVar1 == (FILE *)0x0) {
    pcVar2 = "cannot open pid file";
    uVar6 = 0x10;
  }
  else {
    _Var4 = getpid();
    fprintf(pFVar1,"%d",_Var4);
    fclose(pFVar1);
    iVar3 = 0;
    do {
      pFVar1 = fopen("/var/run/nvramd.pid","r");
      pcVar2 = "waiting for nvram_daemon";
      if (pFVar1 != (FILE *)0x0) {
        fclose(pFVar1);
        nvram_init(0);
        preparesslkey();
        switch_language(0,0);
        pcVar2 = (char *)nvram_bufget(0,"SecondHTTPPortEnable");
        __nptr = (char *)nvram_bufget(0,"SecondHTTPPort");
        if (pcVar2 != (char *)0x0) {
          iVar3 = strcmp(pcVar2,"3");
          if (((iVar3 == 0) && (__nptr != (char *)0x0)) && (*__nptr != '\0')) {
            iVar5 = atoi(__nptr);
          }
        }
        doSystem("rm -f /etc_ro/web/crossdomain.xml");
        local_198._4_4_ = FUN_00408888;
        local_228._4_4_ = local_198._4_4_;
        sigemptyset((sigset_t *)(local_228 + 8));
        local_228._0_4_ = (__sighandler_t)0x0;
        sigaction(0xf,(sigaction *)local_228,(sigaction *)0x0);
        sigemptyset((sigset_t *)(local_198 + 8));
        local_198._0_4_ = (__sighandler_t)0x0;
        sigaction(2,(sigaction *)local_198,(sigaction *)0x0);
        signal(0xd,(__sighandler_t)0x1);
        iVar3 = websStartupServer(iVar5);
        if (-1 < iVar3) {
          trace(0,"Version %s running at address %s:%d\n","2.1.8",&websSrvIpAddr,iVar5);
          websParaOpen();
          websSetFormOpen();
          websEnableErrorMessage();
          websStartAuthentication();
          httpd_main();
          websEndAuthentication();
          websDisableErrorMessage();
          websSetFormClose();
          websParaClose();
          websShutdownServer();
        }
        trace(0,"Shutdown!\n");
        return 0;
      }
      if (iVar3 != 0) {
        pcVar2 = ". ";
      }
      iVar3 = iVar3 + 1;
      trace(0x10,pcVar2);
      Sleep(1);
      uVar6 = 0;
    } while (iVar3 < 0xf);
    pcVar2 = "please execute nvram_daemon first!";
  }
  trace(uVar6,pcVar2);
  return 0xffffffff;
}



bool websReapChildren(int param_1,int *param_2)

{
  __pid_t _Var1;
  
  _Var1 = waitpid(param_1,param_2,1);
  return _Var1 != param_1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

undefined4 websStartupServer(undefined4 param_1)

{
  bool bVar1;
  undefined4 uVar2;
  in_addr __in;
  char *pcVar3;
  size_t sVar4;
  void *__ptr;
  int iVar5;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  undefined4 local_c4;
  undefined4 local_c0;
  undefined4 local_bc;
  undefined auStack_58 [64];
  
  DAT_004d4c40 = DAT_004d4c40 + 1;
  if (DAT_004d4c40 != 1) {
    return websSrvPort;
  }
  websConnList = 0;
  websConnLast = 0xffffffff;
  websSocketOpen();
  __in.s_addr = getSysInfoLong(0x1e);
  if (__in.s_addr == 0) {
    pcVar3 = (char *)nvram_bufget(0,"IPAddress");
    trace(0,"Can\'t get lan ip from sysinfo!\n");
    __in.s_addr = inet_addr(pcVar3);
    if (__in.s_addr == 0xffffffff) {
      trace(0,"failed to convert %s to binary ip data",pcVar3);
      return 0xffffffff;
    }
  }
  pcVar3 = inet_ntoa(__in);
  sVar4 = strlen(pcVar3);
  sVar4 = sVar4 + 1;
  if (0x7f < sVar4) {
    sVar4 = 0x80;
  }
  memcpy(&local_d8,pcVar3,sVar4);
  _DAT_004d8cb0 = local_d4;
  _DAT_004d8cb4 = local_d0;
  _DAT_004d8cb8 = local_cc;
  websSrvIpAddr = local_d8;
  DAT_004d8cbc = local_c8;
  websSrvHostName = local_d8;
  DAT_004d8cc0 = local_c4;
  DAT_004d8c90 = local_d4;
  DAT_004d8c94 = local_d0;
  DAT_004d8c98 = local_cc;
  DAT_004d8cc8 = local_bc;
  DAT_004d8cc4 = local_c0;
  DAT_004d8ca8 = local_bc;
  DAT_004d8c9c = local_c8;
  DAT_004d8ca0 = local_c4;
  DAT_004d8ca4 = local_c0;
  memset(auStack_58,0,0x40);
  getSysInfoBuffer(1,auStack_58,0x40);
  __ptr = (void *)AllocateMACAddress(0,0);
  if (__ptr != (void *)0x0) {
    snprintf(&DAT_004d4b40,0x80,"%s_%s",auStack_58,(int)__ptr + 10);
    snprintf((char *)&PTR_DAT_004d4c44,0x80,"%s_cgi%s",auStack_58,(int)__ptr + 10);
    free(__ptr);
  }
  iVar5 = 10;
  while ((DAT_004d8ccc = websSocketOpenConnection(param_1,websAccept,0), DAT_004d8ccc < 0 &&
         (bVar1 = 0 < iVar5, iVar5 = iVar5 + -1, bVar1))) {
    usleep(100000);
  }
  uVar2 = param_1;
  if (DAT_004d8ccc < 0) {
    trace(0,"Can\'t open a socket on ports %d!\n",param_1);
    param_1 = 0xffffffff;
    uVar2 = websSrvPort;
  }
  websSrvPort = uVar2;
  return param_1;
}



undefined4 websConnValid(int param_1)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = 0;
  piVar1 = websConnList;
  if (-1 < websConnLast) {
    do {
      iVar2 = iVar2 + 1;
      if (*piVar1 == param_1) {
        return 1;
      }
      piVar1 = piVar1 + 1;
    } while (iVar2 <= websConnLast);
  }
  return 0;
}



void websSetEnv(int param_1)

{
  undefined auStack_28 [16];
  void *local_18 [2];
  
  websSetVar(param_1,"REMOTE_HOST",param_1 + 4);
  websSetVar(param_1,"REMOTE_ADDR",param_1 + 4);
  websSetVar(param_1,"QUERY_STRING",*(undefined4 *)(param_1 + 0xa0));
  websSetVar(param_1,"GATEWAY_INTERFACE","CGI/1.1");
  websSetVar(param_1,"SERVER_NAME",&websSrvHostName);
  websSetVar(param_1,"SERVER_HOST",&websSrvHostName);
  websSetVar(param_1,"PATH_INFO",*(undefined4 *)(param_1 + 0x88));
  websSetVar(param_1,"SERVER_PROTOCOL",*(undefined4 *)(param_1 + 0xb0));
  websSetVar(param_1,"SERVER_ADDR",param_1 + 0x24);
  stritoa(websSrvPort,auStack_28,0x10);
  websSetVar(param_1,"SERVER_PORT",auStack_28);
  allocFmtString(local_18,0xfe,"%s/%s","alphapd","2.1.8");
  websSetVar(param_1,"SERVER_SOFTWARE",local_18[0]);
  if (local_18[0] == (void *)0x0) {
    return;
  }
  free(local_18[0]);
  return;
}



void websSetQuery(int param_1)

{
  char *__s;
  char *__s_00;
  char *pcVar1;
  size_t sVar2;
  int iVar3;
  char *__s_01;
  void *local_20 [2];
  
  __s = (char *)strdupWithoutNull(*(undefined4 *)(param_1 + 0xa0));
  if (__s != (char *)0x0) {
    __s_00 = strtok(__s,"&");
    while (__s_00 != (char *)0x0) {
      pcVar1 = strchr(__s_00,0x3d);
      __s_01 = pcVar1 + 1;
      if (pcVar1 == (char *)0x0) {
        __s_01 = "";
      }
      else {
        *pcVar1 = '\0';
        sVar2 = strlen(__s_00);
        websDecodeUrl(__s_00,__s_00,sVar2);
        sVar2 = strlen(__s_01);
        websDecodeUrl(__s_01,__s_01,sVar2);
      }
      if (*__s_00 != '\0') {
        trace(2,"SetEnv=(%s,%s)\n",__s_00,__s_01);
        iVar3 = websGetVar(param_1,__s_00,0);
        if (iVar3 == 0) {
          websSetVar(param_1,__s_00,__s_01,0);
        }
        else {
          allocFmtString(local_20,0x100,"%s %s",iVar3,__s_01);
          websSetVar(param_1,__s_00,local_20[0]);
          if (local_20[0] != (void *)0x0) {
            free(local_20[0]);
            local_20[0] = (void *)0x0;
          }
        }
      }
      __s_00 = strtok((char *)0x0,"&");
    }
    if (__s != (char *)0x0) {
      free(__s);
    }
  }
  return;
}



void websTimeoutCancel(int param_1)

{
  if (-1 < *(int *)(param_1 + 0xec)) {
    websTimeoutUnsched(*(int *)(param_1 + 0xec));
    *(undefined4 *)(param_1 + 0xec) = 0xffffffff;
  }
  return;
}



void websSetTimeStamp(time_t *param_1)

{
  time_t tVar1;
  
  tVar1 = time((time_t *)0x0);
  *param_1 = tVar1;
  return;
}



int websWriteComplete(int param_1,void *param_2,size_t param_3)

{
  int iVar1;
  size_t sVar2;
  int iVar3;
  
  iVar3 = 0;
  if (0 < (int)param_3) {
    do {
      if (((*(uint *)(param_1 + 0xe4) >> 10 & 1) == 0) || (*(int *)(param_1 + 0xbc) < 0)) {
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar1 = websSocketWrite(*(undefined4 *)(param_1 + 0xd4),param_2,param_3);
          if (iVar1 < 0) {
            return -1;
          }
          websSocketFlush(*(undefined4 *)(param_1 + 0xd4));
        }
        else {
          sVar2 = param_3;
          if (0x200 < (int)param_3) {
            sVar2 = 0x200;
          }
          iVar1 = websSSLWrite(*(undefined4 *)(param_1 + 0x110),param_2,sVar2);
          if (iVar1 < 0) {
            return -1;
          }
          websSSLFlush(*(undefined4 *)(param_1 + 0x110));
        }
      }
      else {
        iVar1 = write(*(int *)(param_1 + 0xbc),param_2,param_3);
        if (iVar1 < 0) {
          return -1;
        }
      }
      param_3 = param_3 - iVar1;
      iVar3 = iVar3 + iVar1;
      param_2 = (void *)((int)param_2 + iVar1);
    } while (0 < (int)param_3);
  }
  return iVar3;
}



int websWriteFmt(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  size_t __n;
  ssize_t sVar2;
  int iVar3;
  size_t sVar4;
  char *__ptr;
  char *__buf;
  undefined4 local_res8;
  undefined4 local_resc;
  char *local_20 [2];
  
  local_20[0] = (char *)0x0;
  local_res8 = param_3;
  local_resc = param_4;
  iVar1 = vallocFmtString(local_20,0x400,param_2,&local_res8);
  if (0x3ff < iVar1) {
    trace(2,"websConnWrite lost data, buffer overflow\n");
  }
  __buf = local_20[0];
  iVar1 = 0;
  if (local_20[0] != (char *)0x0) {
    __n = strlen(local_20[0]);
    iVar1 = 0;
    if ((int)__n < 1) {
      iVar1 = 0;
      __ptr = __buf;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          sVar2 = write(*(int *)(param_1 + 0xbc),__buf,__n);
          if (sVar2 < 0) {
LAB_0040a1f4:
            iVar1 = -1;
            __ptr = local_20[0];
            goto LAB_0040a0a8;
          }
          __n = __n - sVar2;
          iVar1 = iVar1 + sVar2;
          __buf = __buf + sVar2;
          __ptr = local_20[0];
          if ((int)__n < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar3 = websSocketWrite(*(undefined4 *)(param_1 + 0xd4),__buf,__n);
          if (-1 < iVar3) {
            websSocketFlush(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        sVar4 = __n;
        if (0x200 < (int)__n) {
          sVar4 = 0x200;
        }
        iVar3 = websSSLWrite(*(undefined4 *)(param_1 + 0x110),__buf,sVar4);
        if (iVar3 < 0) goto LAB_0040a1f4;
        websSSLFlush(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        __n = __n - iVar3;
        iVar1 = iVar1 + iVar3;
        __buf = __buf + iVar3;
        __ptr = local_20[0];
      } while (0 < (int)__n);
    }
LAB_0040a0a8:
    free(__ptr);
  }
  return iVar1;
}



ssize_t websWritePartial(int param_1,void *param_2,size_t param_3)

{
  ssize_t sVar1;
  undefined4 uVar2;
  code *pcVar3;
  
  if (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0) && (-1 < *(int *)(param_1 + 0xbc))) {
    sVar1 = write(*(int *)(param_1 + 0xbc),param_2,param_3);
    return sVar1;
  }
  if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
    sVar1 = websSocketWrite(*(undefined4 *)(param_1 + 0xd4),param_2,param_3);
    uVar2 = *(undefined4 *)(param_1 + 0xd4);
    pcVar3 = websSocketFlush;
  }
  else {
    sVar1 = websSSLWrite(*(undefined4 *)(param_1 + 0x110),param_2,param_3);
    uVar2 = *(undefined4 *)(param_1 + 0x110);
    pcVar3 = websSSLFlush;
  }
  (*pcVar3)(uVar2);
  return sVar1;
}



int websConnAlloc(undefined4 param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = AllocEntry(&websConnList,&websConnLast,0x154);
  if (iVar1 < 0) {
    trace(0x10,"webs connection slot full!\n");
    iVar1 = -1;
  }
  else {
    iVar2 = *(int *)(iVar1 * 4 + websConnList);
    *(undefined4 *)(iVar2 + 0xd4) = param_1;
    *(int *)(iVar2 + 0xfc) = iVar1;
    *(undefined4 *)(iVar2 + 0xe0) = 1;
    *(undefined4 *)(iVar2 + 0x100) = 0xffffffff;
    *(undefined4 *)(iVar2 + 0xec) = 0xffffffff;
    *(undefined4 *)(iVar2 + 0x88) = 0;
    *(undefined4 *)(iVar2 + 0x8c) = 0;
    *(undefined4 *)(iVar2 + 0x90) = 0;
    *(undefined4 *)(iVar2 + 0x94) = 0;
    *(undefined4 *)(iVar2 + 0x98) = 0;
    *(undefined4 *)(iVar2 + 0x9c) = 0;
    *(undefined4 *)(iVar2 + 0xa0) = 0;
    *(undefined4 *)(iVar2 + 0xa4) = 0;
    *(undefined4 *)(iVar2 + 0xb0) = 0;
    *(undefined4 *)(iVar2 + 0xac) = 0;
    *(undefined4 *)(iVar2 + 0xa8) = 0;
    *(undefined4 *)(iVar2 + 0xc0) = 0;
    *(undefined4 *)(iVar2 + 0xc4) = 0;
    *(undefined4 *)(iVar2 + 300) = 0;
    *(undefined4 *)(iVar2 + 0x130) = 0;
    *(undefined4 *)(iVar2 + 0x134) = 0;
    *(undefined4 *)(iVar2 + 0x138) = 0;
    *(undefined4 *)(iVar2 + 0x13c) = 0;
    *(undefined4 *)(iVar2 + 0x140) = 0;
    *(undefined4 *)(iVar2 + 0x144) = 0;
    *(undefined4 *)(iVar2 + 0x148) = 0;
    *(undefined4 *)(iVar2 + 0x84) = 0;
    *(undefined4 *)(iVar2 + 0xb4) = 0;
    *(undefined4 *)(iVar2 + 0xf0) = 0;
    *(undefined4 *)(iVar2 + 0xf4) = 0;
    *(undefined4 *)(iVar2 + 0xb8) = 0;
    *(undefined4 *)(iVar2 + 0xbc) = 0xffffffff;
    *(undefined4 *)(iVar2 + 0x128) = 1;
    *(undefined4 *)(iVar2 + 0xf8) = 0;
    *(undefined4 *)(iVar2 + 200) = 0;
    *(undefined4 *)(iVar2 + 0xcc) = 0;
    *(undefined4 *)(iVar2 + 0xd0) = 0;
    *(undefined4 *)(iVar2 + 0x110) = 0;
    *(undefined4 *)(iVar2 + 0x14c) = 0;
    *(undefined4 *)(iVar2 + 0x150) = 0;
    *(undefined4 *)(iVar2 + 0x114) = 0;
    *(undefined4 *)(iVar2 + 0x118) = 0;
    *(undefined4 *)(iVar2 + 0x11c) = 0;
    *(undefined4 *)(iVar2 + 0x120) = 0;
    *(undefined4 *)(iVar2 + 0x124) = 0;
  }
  return iVar1;
}



undefined4 websAccept(int param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  size_t sVar2;
  char *__s;
  undefined4 uVar3;
  int iVar4;
  char *__s1;
  undefined auStack_30 [16];
  socklen_t local_20 [2];
  
  iVar1 = AllocEntry(&websConnList,&websConnLast,0x154);
  if (iVar1 < 0) {
    trace(0x10,"webs connection slot full!\n");
    return 0xffffffff;
  }
  iVar4 = *(int *)(iVar1 * 4 + websConnList);
  *(int *)(iVar4 + 0xfc) = iVar1;
  *(int *)(iVar4 + 0xd4) = param_1;
  *(undefined4 *)(iVar4 + 0xe0) = 1;
  *(undefined4 *)(iVar4 + 0x100) = 0xffffffff;
  *(undefined4 *)(iVar4 + 0xec) = 0xffffffff;
  *(undefined4 *)(iVar4 + 0x88) = 0;
  *(undefined4 *)(iVar4 + 0x8c) = 0;
  *(undefined4 *)(iVar4 + 0x90) = 0;
  *(undefined4 *)(iVar4 + 0x94) = 0;
  *(undefined4 *)(iVar4 + 0x98) = 0;
  *(undefined4 *)(iVar4 + 0x9c) = 0;
  *(undefined4 *)(iVar4 + 0xa0) = 0;
  *(undefined4 *)(iVar4 + 0xa4) = 0;
  *(undefined4 *)(iVar4 + 0xb0) = 0;
  *(undefined4 *)(iVar4 + 0xac) = 0;
  *(undefined4 *)(iVar4 + 0xa8) = 0;
  *(undefined4 *)(iVar4 + 0xc0) = 0;
  *(undefined4 *)(iVar4 + 0xc4) = 0;
  *(undefined4 *)(iVar4 + 300) = 0;
  *(undefined4 *)(iVar4 + 0x130) = 0;
  *(undefined4 *)(iVar4 + 0x134) = 0;
  *(undefined4 *)(iVar4 + 0x138) = 0;
  *(undefined4 *)(iVar4 + 0x13c) = 0;
  *(undefined4 *)(iVar4 + 0x140) = 0;
  *(undefined4 *)(iVar4 + 0x144) = 0;
  *(undefined4 *)(iVar4 + 0x148) = 0;
  *(undefined4 *)(iVar4 + 0x84) = 0;
  *(undefined4 *)(iVar4 + 0xb4) = 0;
  *(undefined4 *)(iVar4 + 0xf0) = 0;
  *(undefined4 *)(iVar4 + 0xf4) = 0;
  *(undefined4 *)(iVar4 + 0xb8) = 0;
  *(undefined4 *)(iVar4 + 0xbc) = 0xffffffff;
  *(undefined4 *)(iVar4 + 0x128) = 1;
  *(undefined4 *)(iVar4 + 0xf8) = 0;
  *(undefined4 *)(iVar4 + 200) = 0;
  *(undefined4 *)(iVar4 + 0xcc) = 0;
  *(undefined4 *)(iVar4 + 0xd0) = 0;
  *(undefined4 *)(iVar4 + 0x110) = 0;
  *(undefined4 *)(iVar4 + 0x14c) = 0;
  *(undefined4 *)(iVar4 + 0x150) = 0;
  *(undefined4 *)(iVar4 + 0x114) = 0;
  *(undefined4 *)(iVar4 + 0x118) = 0;
  *(undefined4 *)(iVar4 + 0x11c) = 0;
  *(undefined4 *)(iVar4 + 0x120) = 0;
  *(undefined4 *)(iVar4 + 0x124) = 0;
  iVar1 = *(int *)(iVar1 * 4 + websConnList);
  *(undefined4 *)(iVar1 + 0xd8) = param_4;
  sVar2 = strlen(param_2);
  sVar2 = sVar2 + 1;
  if (0x20 < sVar2) {
    sVar2 = 0x20;
  }
  __s1 = (char *)(iVar1 + 4);
  memcpy(__s1,param_2,sVar2);
  local_20[0] = 0x10;
  iVar4 = getsockname(*(int *)(*(int *)(param_1 * 4 + socketList) + 0x70),(sockaddr *)auStack_30,
                      local_20);
  if (-1 < iVar4) {
    __s = inet_ntoa((in_addr)auStack_30._4_4_);
    sVar2 = strlen(__s);
    strncpy((char *)(iVar1 + 0x24),__s,sVar2);
    iVar4 = strcmp(__s1,"127.0.0.1");
    if (((iVar4 == 0) || (iVar4 = strcmp(__s1,(char *)&websSrvIpAddr), iVar4 == 0)) ||
       (iVar4 = strcmp(__s1,(char *)&websSrvHostName), iVar4 == 0)) {
      *(uint *)(iVar1 + 0xe4) = *(uint *)(iVar1 + 0xe4) | 4;
    }
    websSocketCreateEvent(param_1,2,websSocketEvent,iVar1);
    uVar3 = websTimeoutSched(0x3c,websTimeout,iVar1);
    *(undefined4 *)(iVar1 + 0xec) = uVar3;
    trace(1,"accept request(%s, %s)\n",(char *)(iVar1 + 0x24),__s1);
    return 0;
  }
  return 0xffffffff;
}



void websConnFree(void *param_1)

{
  int iVar1;
  char *pcVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  void **ppvVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  
  iVar8 = 0;
  ppvVar6 = websConnList;
  if (-1 < websConnLast) {
    do {
      iVar8 = iVar8 + 1;
      if (*ppvVar6 == param_1) {
        iVar9 = *(int *)((int)param_1 + 0x120);
        iVar8 = *(int *)((int)param_1 + 0x128);
        websConnLast = FreeEntryId(&websConnList,*(undefined4 *)((int)param_1 + 0xfc));
        if ((((*(char **)((int)param_1 + 0xb4) != (char *)0x0) &&
             (iVar3 = access(*(char **)((int)param_1 + 0xb4),4), iVar3 == 0)) &&
            ((*(uint *)((int)param_1 + 0xe4) >> 6 & 1) == 0)) &&
           (iVar3 = remove(*(char **)((int)param_1 + 0xb4)), iVar3 < 0)) {
          piVar4 = __errno_location();
          pcVar2 = strerror(*piVar4);
          trace(0x10,"websConnFree remove(%s,%s)\n",*(undefined4 *)((int)param_1 + 0xb4),pcVar2);
        }
        if (((*(char **)((int)param_1 + 0xb8) != (char *)0x0) &&
            (iVar3 = access(*(char **)((int)param_1 + 0xb8),4), iVar3 == 0)) &&
           (iVar3 = remove(*(char **)((int)param_1 + 0xb8)), iVar3 < 0)) {
          piVar4 = __errno_location();
          pcVar2 = strerror(*piVar4);
          trace(0x10,"websConnFree remove(%s,%s)\n",*(undefined4 *)((int)param_1 + 0xb8),pcVar2);
        }
        uVar7 = *(uint *)((int)param_1 + 0xe4);
        if (((uVar7 >> 0xe & 1) != 0) || ((uVar7 >> 0x17 & 1) != 0)) {
          pcVar2 = (char *)nvram_bufget(0,"LastDownloadStatus");
          iVar3 = atoi(pcVar2);
          if (iVar3 != 1) {
            doSystem("sleep 3 && /mydlink/opt.local start &");
          }
          LockCriticalCMD = LockCriticalCMD + -1;
          uVar7 = *(uint *)((int)param_1 + 0xe4);
        }
        if ((uVar7 >> 0xf & 1) != 0) {
          LockCriticalCMD = LockCriticalCMD + -1;
        }
        if (*(void **)((int)param_1 + 0x88) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x88));
          *(undefined4 *)((int)param_1 + 0x88) = 0;
        }
        if (*(void **)((int)param_1 + 0x8c) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x8c));
          *(undefined4 *)((int)param_1 + 0x8c) = 0;
        }
        if (*(void **)((int)param_1 + 0x90) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x90));
          *(undefined4 *)((int)param_1 + 0x90) = 0;
        }
        if (*(void **)((int)param_1 + 0x94) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x94));
          *(undefined4 *)((int)param_1 + 0x94) = 0;
        }
        if (*(void **)((int)param_1 + 0x98) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x98));
          *(undefined4 *)((int)param_1 + 0x98) = 0;
        }
        if (*(void **)((int)param_1 + 0x9c) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x9c));
          *(undefined4 *)((int)param_1 + 0x9c) = 0;
        }
        if (*(void **)((int)param_1 + 0xa0) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0xa0));
          *(undefined4 *)((int)param_1 + 0xa0) = 0;
        }
        if (*(void **)((int)param_1 + 0xa4) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0xa4));
          *(undefined4 *)((int)param_1 + 0xa4) = 0;
        }
        if (*(void **)((int)param_1 + 0xa8) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0xa8));
          *(undefined4 *)((int)param_1 + 0xa8) = 0;
        }
        if (*(void **)((int)param_1 + 0xac) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0xac));
          *(undefined4 *)((int)param_1 + 0xac) = 0;
        }
        if (*(void **)((int)param_1 + 0xb0) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0xb0));
          *(undefined4 *)((int)param_1 + 0xb0) = 0;
        }
        if (*(void **)((int)param_1 + 0xb4) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0xb4));
          *(undefined4 *)((int)param_1 + 0xb4) = 0;
        }
        if (*(void **)((int)param_1 + 0xb8) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0xb8));
          *(undefined4 *)((int)param_1 + 0xb8) = 0;
        }
        if (*(void **)((int)param_1 + 0x14c) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x14c));
          *(undefined4 *)((int)param_1 + 0x14c) = 0;
        }
        if (*(void **)((int)param_1 + 0x150) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x150));
          *(undefined4 *)((int)param_1 + 0x150) = 0;
        }
        if (*(void **)((int)param_1 + 300) != (void *)0x0) {
          free(*(void **)((int)param_1 + 300));
          *(undefined4 *)((int)param_1 + 300) = 0;
        }
        if (*(void **)((int)param_1 + 0x138) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x138));
          *(undefined4 *)((int)param_1 + 0x138) = 0;
        }
        if (*(void **)((int)param_1 + 0x134) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x134));
          *(undefined4 *)((int)param_1 + 0x134) = 0;
        }
        if (*(void **)((int)param_1 + 0x130) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x130));
          *(undefined4 *)((int)param_1 + 0x130) = 0;
        }
        if (*(void **)((int)param_1 + 0x13c) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x13c));
          *(undefined4 *)((int)param_1 + 0x13c) = 0;
        }
        if (*(void **)((int)param_1 + 0x140) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x140));
          *(undefined4 *)((int)param_1 + 0x140) = 0;
        }
        if (*(void **)((int)param_1 + 0x144) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x144));
          *(undefined4 *)((int)param_1 + 0x144) = 0;
        }
        if (*(void **)((int)param_1 + 0x148) != (void *)0x0) {
          free(*(void **)((int)param_1 + 0x148));
          *(undefined4 *)((int)param_1 + 0x148) = 0;
        }
        websSSLFree(*(undefined4 *)((int)param_1 + 0x110));
        *(undefined4 *)((int)param_1 + 0x110) = 0;
        websCloseVar(param_1);
        if (param_1 != (void *)0x0) {
          free(param_1);
        }
        if (iVar9 < 1) {
          iVar3 = PendRebootMode;
          iVar1 = PendRebootCMD;
          if (((LockCriticalCMD < 1) && (0 < PendRebootCMD)) &&
             (LockCriticalCMD = LockCriticalCMD + 1, iVar8 = getSysInfoShort(0x41),
             iVar3 = PendRebootMode, iVar1 = PendRebootCMD, iVar8 != 2)) {
            doSystem("sleep %d && reboot &",PendRebootCMD);
            iVar8 = PendRebootMode;
LAB_0040af44:
            if (iVar8 != 0) {
              gettimeofday((timeval *)&stack0xffffffe8,(__timezone_ptr_t)&stack0xfffffff0);
            }
            iVar8 = open("/dev/gpio",0);
            if (-1 < iVar8) {
              ioctl(iVar8,0x44281,&stack0xffffffe8);
              close(iVar8);
            }
            return;
          }
        }
        else {
          iVar3 = iVar8;
          iVar1 = iVar9;
          if (LockCriticalCMD < 1) {
            LockCriticalCMD = LockCriticalCMD + 1;
            iVar5 = getSysInfoShort(0x41);
            iVar3 = PendRebootMode;
            iVar1 = PendRebootCMD;
            if (iVar5 != 2) {
              doSystem("sleep %d && reboot &",iVar9);
              goto LAB_0040af44;
            }
          }
        }
        PendRebootCMD = iVar1;
        PendRebootMode = iVar3;
        return;
      }
      ppvVar6 = ppvVar6 + 1;
    } while (iVar8 <= websConnLast);
  }
  trace(0x10,"websFree=(%s)!\n","Null wp");
  return;
}



void websConnClose(int param_1,int param_2)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  ssize_t sVar4;
  int *piVar5;
  undefined4 uVar6;
  int iVar7;
  size_t sVar8;
  size_t sVar9;
  size_t __n;
  code *pcVar10;
  char *__buf;
  stat sStack_c0;
  
  iVar7 = 0;
  piVar5 = websConnList;
  if (-1 < websConnLast) {
    do {
      iVar7 = iVar7 + 1;
      if (*piVar5 == param_1) {
        if ((*(int *)(param_1 + 0x88) == 0) && (param_2 == 0x38e)) {
          trace(0x10,"websConnClose=(%d, wp->path == NULL)!\n",0x38e);
          return;
        }
        if (((*(uint *)(param_1 + 0xe4) >> 10 & 1) == 0) || (*(int *)(param_1 + 0xbc) < 0))
        goto LAB_0040b108;
        websTimeoutResched(*(undefined4 *)(param_1 + 0xec),0x3c);
        if (-1 < *(int *)(param_1 + 0xbc)) {
          close(*(int *)(param_1 + 0xbc));
          *(undefined4 *)(param_1 + 0xbc) = 0xffffffff;
        }
        *(uint *)(param_1 + 0xe4) = *(uint *)(param_1 + 0xe4) & 0xfffffbff;
        if ((*(char **)(param_1 + 0xb8) == (char *)0x0) ||
           (iVar7 = open(*(char **)(param_1 + 0xb8),0), iVar7 < 0)) goto LAB_0040b108;
        iVar1 = fstat(iVar7,&sStack_c0);
        if (iVar1 < 0) {
          piVar5 = __errno_location();
          pcVar2 = strerror(*piVar5);
          trace(1,"Can\'t stat %s: %s\n",*(undefined4 *)(param_1 + 0xb8),pcVar2);
          goto LAB_0040b414;
        }
        pcVar2 = (char *)mmap((void *)0x0,sStack_c0.st_atim.tv_sec,1,1,iVar7,0);
        pcVar3 = strstr(pcVar2,"\r\n\r\n");
        __buf = pcVar3 + 4;
        if (pcVar3 == (char *)0x0) goto LAB_0040b404;
        sVar9 = (int)pcVar3 - (int)pcVar2;
        __n = sStack_c0.st_atim.tv_sec - ((int)__buf - (int)pcVar2);
        pcVar3 = pcVar2;
        goto LAB_0040b330;
      }
      piVar5 = piVar5 + 1;
    } while (iVar7 <= websConnLast);
  }
  trace(0x10,"websConnClose=(%d,%s)!\n",param_2,"Null wp");
  return;
LAB_0040b330:
  if (0 < (int)sVar9) {
    if (((*(uint *)(param_1 + 0xe4) >> 10 & 1) == 0) || (*(int *)(param_1 + 0xbc) < 0)) {
      if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
        iVar1 = websSocketWrite(*(undefined4 *)(param_1 + 0xd4),pcVar3,sVar9);
        if (iVar1 < 0) goto LAB_0040b388;
        sVar9 = sVar9 - iVar1;
        websSocketFlush(*(undefined4 *)(param_1 + 0xd4));
        pcVar3 = pcVar3 + iVar1;
      }
      else {
        sVar8 = sVar9;
        if (0x200 < (int)sVar9) {
          sVar8 = 0x200;
        }
        iVar1 = websSSLWrite(*(undefined4 *)(param_1 + 0x110),pcVar3,sVar8);
        if (iVar1 < 0) goto LAB_0040b388;
        sVar9 = sVar9 - iVar1;
        websSSLFlush(*(undefined4 *)(param_1 + 0x110));
        pcVar3 = pcVar3 + iVar1;
      }
    }
    else {
      sVar4 = write(*(int *)(param_1 + 0xbc),pcVar3,sVar9);
      if (sVar4 < 0) goto LAB_0040b388;
      sVar9 = sVar9 - sVar4;
      pcVar3 = pcVar3 + sVar4;
    }
    goto LAB_0040b330;
  }
LAB_0040b388:
  websWriteFmt(param_1,"\r\nContent-length: %d\r\n\r\n",__n);
  while (0 < (int)__n) {
    if (((*(uint *)(param_1 + 0xe4) >> 10 & 1) == 0) || (*(int *)(param_1 + 0xbc) < 0)) {
      if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
        iVar1 = websSocketWrite(*(undefined4 *)(param_1 + 0xd4),__buf,__n);
        if (iVar1 < 0) break;
        __n = __n - iVar1;
        websSocketFlush(*(undefined4 *)(param_1 + 0xd4));
        __buf = __buf + iVar1;
      }
      else {
        sVar9 = __n;
        if (0x200 < (int)__n) {
          sVar9 = 0x200;
        }
        iVar1 = websSSLWrite(*(undefined4 *)(param_1 + 0x110),__buf,sVar9);
        if (iVar1 < 0) break;
        __n = __n - iVar1;
        websSSLFlush(*(undefined4 *)(param_1 + 0x110));
        __buf = __buf + iVar1;
      }
    }
    else {
      sVar4 = write(*(int *)(param_1 + 0xbc),__buf,__n);
      if (sVar4 < 0) break;
      __n = __n - sVar4;
      __buf = __buf + sVar4;
    }
  }
LAB_0040b404:
  munmap(pcVar2,sStack_c0.st_atim.tv_sec);
LAB_0040b414:
  close(iVar7);
LAB_0040b108:
  if (-1 < *(int *)(param_1 + 0xec)) {
    websTimeoutUnsched();
    *(undefined4 *)(param_1 + 0xec) = 0xffffffff;
  }
  trace(1,"websConnClose(%s)!\n",*(undefined4 *)(param_1 + 0x88));
  websSocketDeleteEvent(*(undefined4 *)(param_1 + 0xd4));
  if (-1 < *(int *)(param_1 + 0x100)) {
    close(*(int *)(param_1 + 0x100));
    *(undefined4 *)(param_1 + 0x100) = 0xffffffff;
  }
  if (-1 < *(int *)(param_1 + 0xbc)) {
    close(*(int *)(param_1 + 0xbc));
    *(undefined4 *)(param_1 + 0xbc) = 0xffffffff;
  }
  if (*(char *)(param_1 + 0xe4) < '\0') {
    websSSLFlush(*(undefined4 *)(param_1 + 0x110));
    uVar6 = *(undefined4 *)(param_1 + 0x110);
    pcVar10 = webssslWriteClosureAlert;
  }
  else {
    websSocketSetBlock(*(undefined4 *)(param_1 + 0xd4),1);
    uVar6 = *(undefined4 *)(param_1 + 0xd4);
    pcVar10 = websSocketFlush;
  }
  (*pcVar10)(uVar6);
  websSocketCloseConnection(*(undefined4 *)(param_1 + 0xd4));
  websConnFree(param_1);
  return;
}



void websTimeout(int *param_1,int param_2)

{
  time_t tVar1;
  time_t tVar2;
  int iVar3;
  int iVar4;
  
  tVar1 = time((time_t *)0x0);
  iVar3 = *param_1;
  if (tVar1 - iVar3 < 0x3c) {
    if ((((DAT_004d8cd0 != 0) && (param_2 != -1)) && (param_2 <= DAT_004d4cc4)) &&
       (iVar4 = *(int *)(param_2 * 4 + DAT_004d8cd0), iVar4 != 0)) {
      tVar2 = time((time_t *)0x0);
      *(time_t *)(iVar4 + 4) = tVar2 + (0x3c - (tVar1 - iVar3));
    }
    return;
  }
  trace(1,"websTimeout!\n");
  websTimeoutUnsched(param_2);
  param_1[0x3b] = -1;
  websConnClose(param_1,0x38e);
  return;
}



void websShutdownServer(void)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  
  DAT_004d4c40 = DAT_004d4c40 + -1;
  if (0 < DAT_004d4c40) {
    return;
  }
  iVar3 = websConnLast;
  if (-1 < DAT_004d8ccc) {
    websSocketCloseConnection();
    DAT_004d8ccc = -1;
    iVar3 = websConnLast;
  }
  while ((websConnList != 0 && (-1 < iVar3))) {
    iVar2 = *(int *)(iVar3 * 4 + websConnList);
    iVar3 = iVar3 + -1;
    if (iVar2 != 0) {
      websSocketCloseConnection(*(undefined4 *)(iVar2 + 0xd4));
      websConnFree(iVar2);
    }
  }
  DAT_004d6098 = DAT_004d6098 + -1;
  if (DAT_004d6098 < 1) {
    websSSLClose();
    for (iVar3 = socketLast; -1 < iVar3; iVar3 = iVar3 + -1) {
      if ((socketList != 0) && (*(int *)(iVar3 * 4 + socketList) != 0)) {
        if ((iVar3 < 0) || (socketLast < iVar3)) {
          piVar1 = __errno_location();
          *piVar1 = 9;
        }
        else {
          websSocketFree(iVar3);
        }
      }
    }
    DAT_004d6098 = 0;
    return;
  }
  return;
}



void websCommonWriteHeader(int param_1,int param_2,int param_3,int param_4,int param_5)

{
  bool bVar1;
  int *piVar2;
  size_t sVar3;
  void *__ptr;
  int iVar4;
  char *pcVar5;
  undefined *puVar6;
  time_t local_20 [2];
  
  if (param_2 == 0xcc) {
LAB_0040ba00:
    piVar2 = &websConnErrors;
    iVar4 = websConnErrors;
    if (websConnErrors != 0) {
      do {
        if (iVar4 == param_2) goto LAB_0040ba74;
        piVar2 = piVar2 + 2;
        iVar4 = *piVar2;
      } while (iVar4 != 0);
      puVar6 = &DAT_0049445c;
      goto LAB_0040b834;
    }
  }
  else {
    if (param_2 < 0xcd) {
      if (param_2 == 200) goto LAB_0040ba00;
    }
    else if (param_2 == 0x193) {
      piVar2 = &websConnErrors;
      bVar1 = websConnErrors != 0;
      iVar4 = websConnErrors;
      while (bVar1) {
        if (iVar4 == 0x193) {
          puVar6 = (undefined *)piVar2[1];
          pcVar5 = "HTTP/1.1 %d %s\r\n";
          goto LAB_0040b840;
        }
        piVar2 = piVar2 + 2;
        iVar4 = *piVar2;
        bVar1 = iVar4 != 0;
      }
      puVar6 = &DAT_0049445c;
      pcVar5 = "HTTP/1.1 %d %s\r\n";
      goto LAB_0040b840;
    }
    piVar2 = &websConnErrors;
    bVar1 = websConnErrors != 0;
    iVar4 = websConnErrors;
    while (bVar1) {
      if (iVar4 == param_2) goto LAB_0040ba74;
      piVar2 = piVar2 + 2;
      iVar4 = *piVar2;
      bVar1 = iVar4 != 0;
    }
  }
  puVar6 = &DAT_0049445c;
  goto LAB_0040b834;
LAB_0040ba74:
  puVar6 = (undefined *)piVar2[1];
LAB_0040b834:
  pcVar5 = "HTTP/1.0 %d %s\r\n";
LAB_0040b840:
  websWriteFmt(param_1,pcVar5,param_2,puVar6);
  websWriteFmt(param_1,"Server: %s/%s\r\n","alphapd","2.1.8");
  if (param_5 == 0) {
    time(local_20);
  }
  else {
    local_20[0] = *(time_t *)(param_5 + 0x48);
  }
  pcVar5 = ctime(local_20);
  if (pcVar5 != (char *)0x0) {
    sVar3 = strlen(pcVar5);
    pcVar5[sVar3 - 1] = '\0';
    __ptr = (void *)strdupWithoutNull(pcVar5);
    if (__ptr != (void *)0x0) {
      websWriteFmt(param_1,"Date: %s\r\n",__ptr);
      if ((param_5 != 0) && (0 < param_3)) {
        websWriteFmt(param_1,"Last-modified: %s\r\n",__ptr);
      }
      free(__ptr);
    }
  }
  if ((param_5 == 0) || (param_3 < 1)) {
    if (*(char *)(param_1 + 0xe4) < '\0') {
      websWriteFmt(param_1,"Cache-Control: no-cache\r\n");
    }
    else {
      websWriteFmt(param_1,"Pragma: no-cache\r\nCache-Control: no-cache\r\n");
    }
  }
  if (param_4 != 0) {
    websWriteFmt(param_1,"Content-type: %s\r\n",param_4);
  }
  if (0 < param_3) {
    websWriteFmt(param_1,"Content-length: %d\r\n",param_3);
  }
  return;
}



char * websGetRealm(int param_1)

{
  int iVar1;
  char *pcVar2;
  
  iVar1 = *(int *)(param_1 + 0xc4);
  pcVar2 = s_NIPCA_004d4bc0;
  if ((((iVar1 != 2) && (iVar1 != 5)) && (pcVar2 = s_NIPCA_004d4bc0, iVar1 != 3)) && (iVar1 != 6)) {
    pcVar2 = &DAT_004d4b40;
  }
  return pcVar2;
}



// WARNING: Switch with 1 destination removed at 0x0040bbc0

uint websWriteNormalHeader(int param_1,int param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iStackX_8;
  int iStackX_c;
  int local_20 [2];
  undefined *local_18;
  
  local_18 = &_gp;
  uVar2 = *(uint *)(param_1 + 0xe4) >> 9 & 1;
  if (uVar2 != 0) {
    return uVar2;
  }
  *(uint *)(param_1 + 0xe4) = *(uint *)(param_1 + 0xe4) | 0x200;
  local_20[0] = param_5;
  websCommonWriteHeader();
  if (param_2 == 0x191) {
    iVar3 = *(int *)(param_1 + 0xc4);
    if ((((iVar3 == 2) || (iVar3 == 5)) || (param_4 = 6, iVar3 == 3)) || (iVar3 == 6)) {
      param_3 = *(int *)(local_18 + -0x7fe4) + 0x4bc0;
    }
    else {
      param_3 = *(int *)(local_18 + -0x7fe4) + 0x4b40;
    }
    iVar3 = (**(code **)(local_18 + -0x6f38))(param_1);
    if ((iVar3 == 0) && ((*(uint *)(param_1 + 0xe4) >> 0xd & 1) != 0)) {
      iVar3 = 1;
    }
    if (iVar3 == 1) {
      iVar3 = (**(code **)(local_18 + -0x73b0))(param_1);
      param_4 = *(int *)(local_18 + -0x7fe0) + -0x5fb4;
      local_20[0] = iVar3;
      (**(code **)(local_18 + -0x7884))(param_1,*(int *)(local_18 + -0x7fe0) + -0x5ff0);
      (**(code **)(local_18 + -0x7b84))(iVar3);
    }
    else {
      (**(code **)(local_18 + -0x7884))(param_1,*(int *)(local_18 + -0x7fe0) + -0x6018);
    }
  }
  iVar5 = *(int *)(local_18 + -0x7884);
  local_20[0] = 0;
  iStackX_8 = param_3;
  iStackX_c = param_4;
  iVar3 = (**(code **)(iVar5 + 0xce114))
                    (local_20,0x400,*(undefined4 *)(local_18 + -0x72cc),&iStackX_8);
  if (0x3ff < iVar3) {
    (**(code **)(iVar5 + 0xceac8))(2,*(int *)(iVar5 + 0xcda44) + -0x626c);
  }
  iVar3 = local_20[0];
  uVar2 = 0;
  if (local_20[0] != 0) {
    iVar1 = (**(code **)(iVar5 + 0xce008))(local_20[0]);
    uVar2 = 0;
    if (iVar1 < 1) {
      uVar2 = 0;
      iVar4 = iVar3;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          iVar4 = (**(code **)(iVar5 + 0xce750))(*(int *)(param_1 + 0xbc),iVar3,iVar1);
          if (iVar4 < 0) {
LAB_0040a1f4:
            uVar2 = 0xffffffff;
            iVar4 = local_20[0];
            goto LAB_0040a0a8;
          }
          iVar1 = iVar1 - iVar4;
          uVar2 = uVar2 + iVar4;
          iVar3 = iVar3 + iVar4;
          iVar4 = local_20[0];
          if (iVar1 < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar4 = (**(code **)(iVar5 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),iVar3,iVar1);
          if (-1 < iVar4) {
            (**(code **)(iVar5 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        iVar4 = iVar1;
        if (0x200 < iVar1) {
          iVar4 = 0x200;
        }
        iVar4 = (**(code **)(iVar5 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),iVar3,iVar4);
        if (iVar4 < 0) goto LAB_0040a1f4;
        (**(code **)(iVar5 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        iVar1 = iVar1 - iVar4;
        uVar2 = uVar2 + iVar4;
        iVar3 = iVar3 + iVar4;
        iVar4 = local_20[0];
      } while (0 < iVar1);
    }
LAB_0040a0a8:
    (**(code **)(iVar5 + 0xcdea0))(iVar4);
  }
  return uVar2;
}



void websConnResponse(int param_1,undefined4 param_2,char *param_3)

{
  size_t sVar1;
  int iVar2;
  int *piVar3;
  char *pcVar4;
  
  if (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0) && (-1 < *(int *)(param_1 + 0xbc))) {
    close(*(int *)(param_1 + 0xbc));
    *(undefined4 *)(param_1 + 0xbc) = 0xffffffff;
    if (*(char **)(param_1 + 0xb8) != (char *)0x0) {
      iVar2 = access(*(char **)(param_1 + 0xb8),4);
      if (iVar2 == 0) {
        iVar2 = remove(*(char **)(param_1 + 0xb8));
        if (iVar2 < 0) {
          piVar3 = __errno_location();
          pcVar4 = strerror(*piVar3);
          trace(0x10,"websConnFree remove(%s,%s)\n",*(undefined4 *)(param_1 + 0xb8),pcVar4);
        }
      }
      if (*(void **)(param_1 + 0xb8) != (void *)0x0) {
        free(*(void **)(param_1 + 0xb8));
        *(undefined4 *)(param_1 + 0xb8) = 0;
      }
    }
    *(uint *)(param_1 + 0xe4) = *(uint *)(param_1 + 0xe4) & 0xfffff9ff;
  }
  if (param_3 == (char *)0x0) {
    sVar1 = 0;
  }
  else {
    sVar1 = strlen(param_3);
  }
  websWriteNormalHeader(param_1,param_2,sVar1,"text/html",0);
  if (((((*(uint *)(param_1 + 0xe4) >> 1 ^ 1) & 1) != 0) && (param_3 != (char *)0x0)) &&
     (*param_3 != '\0')) {
    websWriteFmt(param_1,"%s\r\n",param_3);
    websConnClose(param_1,param_2);
    return;
  }
  websConnClose(param_1,param_2);
  return;
}



void websConnError(int param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  void *pvVar2;
  int *piVar3;
  int iVar4;
  undefined *puVar5;
  undefined4 local_resc;
  void *local_20;
  void *local_1c;
  
  iVar4 = 0;
  piVar3 = websConnList;
  local_resc = param_4;
  if (-1 < websConnLast) {
    do {
      iVar4 = iVar4 + 1;
      if (*piVar3 == param_1) {
        uVar1 = websSafeUrl(*(undefined4 *)(param_1 + 0x8c));
        if (*(void **)(param_1 + 0x8c) != (void *)0x0) {
          free(*(void **)(param_1 + 0x8c));
        }
        *(undefined4 *)(param_1 + 0x8c) = uVar1;
        local_20 = (void *)0x0;
        vallocFmtString(&local_20,0x400,param_3,&local_resc);
        pvVar2 = (void *)websSafeUrl(local_20);
        if (local_20 != (void *)0x0) {
          free(local_20);
        }
        local_20 = pvVar2;
        trace(1,"websConnError=(%d,%s)!\n",param_2,pvVar2);
        local_1c = (void *)0x0;
        if (param_2 == 0x193) {
          piVar3 = &websConnErrors;
          iVar4 = websConnErrors;
          goto joined_r0x0040c184;
        }
        piVar3 = &websConnErrors;
        iVar4 = websConnErrors;
        goto joined_r0x0040c060;
      }
      piVar3 = piVar3 + 1;
    } while (iVar4 <= websConnLast);
  }
  trace(0x10,"websConnError=(%d,%s)!\n",param_2,"Null wp");
  return;
joined_r0x0040c060:
  if (iVar4 == 0) goto LAB_0040c084;
  if (iVar4 == param_2) {
    puVar5 = (undefined *)piVar3[1];
    goto LAB_0040c090;
  }
  piVar3 = piVar3 + 2;
  iVar4 = *piVar3;
  goto joined_r0x0040c060;
LAB_0040c084:
  puVar5 = &DAT_0049445c;
LAB_0040c090:
  allocFmtString(&local_1c,0x400,"<html><body><h2>Error: %s</h2>\r\n<p>%s</p></body></html>\r\n",
                 puVar5,local_20);
  goto LAB_0040c0b0;
joined_r0x0040c184:
  if (iVar4 == 0) goto LAB_0040c18c;
  if (iVar4 == 0x193) {
    puVar5 = (undefined *)piVar3[1];
    goto LAB_0040c198;
  }
  piVar3 = piVar3 + 2;
  iVar4 = *piVar3;
  goto joined_r0x0040c184;
LAB_0040c18c:
  puVar5 = &DAT_0049445c;
LAB_0040c198:
  allocFmtString(&local_1c,0x400,"<html><body><h1>The request is forbidden.</h1></body></html>\r\n",
                 puVar5);
LAB_0040c0b0:
  websConnResponse(param_1,param_2,local_1c);
  if (local_1c != (void *)0x0) {
    free(local_1c);
    local_1c = (void *)0x0;
  }
  if (local_20 != (void *)0x0) {
    free(local_20);
  }
  return;
}



// WARNING: Removing unreachable block (ram,0x0040ccb0)
// WARNING: Removing unreachable block (ram,0x0040ccc0)

void websReadEvent(time_t *param_1)

{
  void *pvVar1;
  time_t tVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  code *pcVar6;
  undefined auStack_148 [264];
  void *local_40;
  int local_3c;
  void *local_38 [2];
  int local_30;
  
  tVar2 = time((time_t *)0x0);
  *param_1 = tVar2;
  local_30 = -1;
  local_40 = (void *)0x0;
  iVar4 = param_1[0x38];
  iVar3 = 1000;
  if (iVar4 == 0x10) {
    uVar5 = 0x10;
  }
  else {
    while( true ) {
      local_38[0] = (void *)0x0;
      local_40 = (void *)0x0;
      local_3c = 0;
      if (iVar4 != 8) break;
      iVar4 = param_1[0x3e];
      if (iVar4 < 0x101) {
        if (iVar4 < 1) break;
      }
      else {
        iVar4 = 0x100;
      }
      if (*(char *)(param_1 + 0x39) < '\0') {
        iVar4 = websSSLRead(param_1[0x44],auStack_148);
      }
      else {
        iVar4 = websSocketRead(param_1[0x35],auStack_148,iVar4);
      }
      if (iVar4 < 0) goto LAB_0040cbc0;
      if (iVar4 != 0) {
        auStack_148[iVar4] = 0;
        local_38[0] = (void *)strndupWithoutNull(auStack_148,iVar4);
        pvVar1 = local_38[0];
        if (local_38[0] != (void *)0x0) goto LAB_0040cb68;
        websConnError(param_1,0x1f7,"Insufficient memory");
        goto LAB_0040cbd4;
      }
      if (iVar3 < 1) goto LAB_0040cbd4;
      usleep(5000);
      iVar4 = param_1[0x38];
      iVar3 = iVar3 + -1;
    }
    if (-1 < *(char *)(param_1 + 0x39)) {
      iVar4 = websSocketGets(param_1[0x35],local_38);
      if (-1 < iVar4) goto LAB_0040cb50;
LAB_0040cd28:
      if (*(char *)(param_1 + 0x39) < '\0') {
        if (param_1[0x38] != 1) {
          pcVar6 = websSSLEof;
          tVar2 = param_1[0x44];
          goto LAB_0040cd54;
        }
LAB_0040cd68:
        if (param_1[0x38] == 4) {
          param_1[0x38] = 0x10;
          pvVar1 = local_40;
          iVar4 = local_3c;
          goto LAB_0040cb68;
        }
LAB_0040cbc0:
        websConnClose(param_1,0);
      }
      else {
        pcVar6 = websSocketEof;
        tVar2 = param_1[0x35];
LAB_0040cd54:
        iVar3 = (*pcVar6)(tVar2);
        if (iVar3 != 0) goto LAB_0040cd68;
      }
LAB_0040cbd4:
      if (-1 < local_30) {
        close(local_30);
        local_30 = -1;
        if ((char *)param_1[0x2d] != (char *)0x0) {
          remove((char *)param_1[0x2d]);
        }
      }
      websConnError(param_1,400,"Receive data failure");
      goto LAB_0040cc24;
    }
    iVar4 = websSSLGets(param_1[0x44],local_38);
    if (iVar4 < 0) goto LAB_0040cd28;
LAB_0040cb50:
    if (iVar4 == 0) {
      pvVar1 = local_40;
      iVar4 = local_3c;
      if (param_1[0x38] == 2) goto LAB_0040cb68;
      goto LAB_0040cbd4;
    }
    pvVar1 = local_38[0];
LAB_0040cb68:
    local_3c = iVar4;
    local_40 = pvVar1;
    uVar5 = param_1[0x38];
  }
  if (uVar5 < 0x11) {
                    // WARNING: Could not recover jumptable at 0x0040cb9c. Too many branches
                    // WARNING: Treating indirect jump as call
    (*(code *)(&_gp + *(int *)(&DAT_0048b37c + uVar5 * 4)))();
    return;
  }
  websConnError(param_1,0x194,"Invalid state");
LAB_0040cc24:
  if (-1 < local_30) {
    close(local_30);
  }
  if (local_40 != (void *)0x0) {
    free(local_40);
    return;
  }
  return;
}



void websSocketEvent(undefined4 param_1,uint param_2,int param_3)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = 0;
  piVar1 = websConnList;
  if (-1 < websConnLast) {
    do {
      iVar2 = iVar2 + 1;
      if (*piVar1 == param_3) {
        if ((param_2 >> 1 & 1) != 0) {
          websReadEvent(param_3);
        }
        if ((param_2 >> 2 & 1) == 0) {
          return;
        }
        if (*(code **)(param_3 + 0x10c) == (code *)0x0) {
          return;
        }
                    // WARNING: Could not recover jumptable at 0x0040e448. Too many branches
                    // WARNING: Treating indirect jump as call
        (**(code **)(param_3 + 0x10c))(param_3);
        return;
      }
      piVar1 = piVar1 + 1;
    } while (iVar2 <= websConnLast);
  }
  return;
}



// WARNING: Switch with 1 destination removed at 0x0040e4e4

void websWriteActiveHeader
               (int param_1,int param_2,int param_3,undefined4 param_4,undefined4 param_5)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  code *pcVar6;
  undefined *puVar7;
  
  puVar7 = &_gp;
  if ((param_2 == 200) && (param_3 == 0)) {
    puVar7 = &_gp;
    iVar5 = websGetTempFileName();
    pcVar6 = *(code **)(puVar7 + -0x7a24);
    *(int *)(param_1 + 0xb8) = iVar5;
    if (iVar5 != 0) {
      iVar5 = (*pcVar6)(iVar5,0x101);
      pcVar6 = *(code **)(puVar7 + -0x7934);
      *(int *)(param_1 + 0xbc) = iVar5;
      if (iVar5 < 0) {
        puVar2 = (undefined4 *)(*pcVar6)();
        uVar3 = (**(code **)(puVar7 + -0x6ec0))(*puVar2);
        (**(code **)(puVar7 + -0x6f5c))
                  (0x10,*(int *)(puVar7 + -0x7fe0) + -0x5a8c,*(undefined4 *)(param_1 + 0xb8),uVar3);
        if (*(int *)(param_1 + 0xb8) != 0) {
          (**(code **)(puVar7 + -0x7b84))(*(int *)(param_1 + 0xb8));
          *(undefined4 *)(param_1 + 0xb8) = 0;
        }
      }
      else {
        *(uint *)(param_1 + 0xe4) = *(uint *)(param_1 + 0xe4) | 0x400;
      }
    }
  }
  iVar5 = *(int *)(puVar7 + -0x7408);
  if ((*(uint *)(param_1 + 0xe4) >> 9 & 1) == 0) {
    pcVar6 = *(code **)(iVar5 + 0xcc41c);
    *(uint *)(param_1 + 0xe4) = *(uint *)(param_1 + 0xe4) | 0x200;
    (*pcVar6)(param_1,param_2,param_3,param_4,param_5);
    if (param_2 == 0x191) {
      iVar4 = *(int *)(param_1 + 0xc4);
      if ((((iVar4 == 2) || (iVar4 == 5)) || (iVar4 == 3)) || (iVar4 == 6)) {
        iVar4 = *(int *)(iVar5 + 0xcbf24) + 0x4bc0;
      }
      else {
        iVar4 = *(int *)(iVar5 + 0xcbf24) + 0x4b40;
      }
      iVar1 = (**(code **)(iVar5 + 0xccfd0))(param_1);
      if ((iVar1 == 0) && ((*(uint *)(param_1 + 0xe4) >> 0xd & 1) != 0)) {
        iVar1 = 1;
      }
      if (iVar1 == 1) {
        uVar3 = (**(code **)(iVar5 + 0xccb58))(param_1);
        (**(code **)(iVar5 + 0xcc684))
                  (param_1,*(int *)(iVar5 + 0xcbf28) + -0x5ff0,iVar4,
                   *(int *)(iVar5 + 0xcbf28) + -0x5fb4,uVar3);
        (**(code **)(iVar5 + 0xcc384))(uVar3);
      }
      else {
        (**(code **)(iVar5 + 0xcc684))(param_1,*(int *)(iVar5 + 0xcbf28) + -0x6018);
      }
    }
                    // WARNING: Could not recover jumptable at 0x0040bbc0. Too many branches
                    // WARNING: Treating indirect jump as call
    (**(code **)(iVar5 + 0xcc684))(param_1,*(undefined4 *)(iVar5 + 0xccc3c));
    return;
  }
  return;
}



void websWriteSpecialHeader(int param_1)

{
  int iVar1;
  size_t __n;
  ssize_t sVar2;
  size_t sVar3;
  char *__ptr;
  char *__buf;
  undefined4 param_5;
  undefined4 param_6;
  char *local_20 [2];
  
  if ((*(uint *)(param_1 + 0xe4) >> 9 & 1) != 0) {
    return;
  }
  *(uint *)(param_1 + 0xe4) = *(uint *)(param_1 + 0xe4) | 0x200;
  websCommonWriteHeader();
  local_20[0] = (char *)0x0;
  iVar1 = vallocFmtString(local_20,0x400,param_6,&stack0x00000018,param_5);
  if (0x3ff < iVar1) {
    trace(2,"websWriteSpecialHeader lost data, buffer overflow\n");
  }
  __buf = local_20[0];
  if (local_20[0] != (char *)0x0) {
    __n = strlen(local_20[0]);
    __ptr = __buf;
    for (; 0 < (int)__n; __n = __n - iVar1) {
      while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
        sVar2 = write(*(int *)(param_1 + 0xbc),__buf,__n);
        __ptr = local_20[0];
        if (sVar2 < 0) goto LAB_0040e738;
        __n = __n - sVar2;
        __buf = __buf + sVar2;
        if ((int)__n < 1) goto LAB_0040e738;
      }
      if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
        iVar1 = websSocketWrite(*(undefined4 *)(param_1 + 0xd4),__buf,__n);
        __ptr = local_20[0];
        if (iVar1 < 0) break;
        websSocketFlush(*(undefined4 *)(param_1 + 0xd4));
      }
      else {
        sVar3 = __n;
        if (0x200 < (int)__n) {
          sVar3 = 0x200;
        }
        iVar1 = websSSLWrite(*(undefined4 *)(param_1 + 0x110),__buf,sVar3);
        __ptr = local_20[0];
        if (iVar1 < 0) break;
        websSSLFlush(*(undefined4 *)(param_1 + 0x110));
      }
      __buf = __buf + iVar1;
      __ptr = local_20[0];
    }
LAB_0040e738:
    free(__ptr);
  }
  websWriteFmt(param_1,&WebCRLF);
  return;
}



// WARNING: Switch with 1 destination removed at 0x0040e910

int websJsonWriteHeader(int param_1,int param_2)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  undefined *puVar7;
  int iVar8;
  int iStackX_8;
  int iStackX_c;
  int aiStack_20 [2];
  undefined *local_18;
  
  local_18 = &_gp;
  piVar4 = &websConnErrors;
  bVar1 = websConnErrors != 0;
  iVar5 = websConnErrors;
  while (bVar1) {
    if (iVar5 == 200) {
      puVar7 = (undefined *)piVar4[1];
      goto LAB_0040e83c;
    }
    piVar4 = piVar4 + 2;
    iVar5 = *piVar4;
    bVar1 = iVar5 != 0;
  }
  puVar7 = &DAT_0049445c;
LAB_0040e83c:
  websWriteFmt(param_1,"HTTP/1.0 %d %s\r\n",200,puVar7);
  iStackX_c = *(int *)(local_18 + -0x7fe0) + -0x64e8;
  (**(code **)(local_18 + -0x7884))
            (param_1,*(int *)(local_18 + -0x7fe0) + -0x60d0,*(int *)(local_18 + -0x7fe0) + -0x6760);
  (**(code **)(local_18 + -0x7884))(param_1,*(int *)(local_18 + -0x7fe0) + -0x5a2c);
  (**(code **)(local_18 + -0x7884))(param_1,*(int *)(local_18 + -0x7fe0) + -0x5a08);
  (**(code **)(local_18 + -0x7884))(param_1,*(int *)(local_18 + -0x7fe0) + -0x6044);
  if (0 < param_2) {
    (**(code **)(local_18 + -0x7884))(param_1,*(int *)(local_18 + -0x7fe0) + -0x608c);
  }
  iVar8 = *(int *)(local_18 + -0x7884);
  aiStack_20[0] = 0;
  iStackX_8 = param_2;
  iVar5 = (**(code **)(iVar8 + 0xce114))
                    (aiStack_20,0x400,*(undefined4 *)(local_18 + -0x72cc),&iStackX_8);
  if (0x3ff < iVar5) {
    (**(code **)(iVar8 + 0xceac8))(2,*(int *)(iVar8 + 0xcda44) + -0x626c);
  }
  iVar5 = aiStack_20[0];
  iVar2 = 0;
  if (aiStack_20[0] != 0) {
    iVar3 = (**(code **)(iVar8 + 0xce008))(aiStack_20[0]);
    iVar2 = 0;
    if (iVar3 < 1) {
      iVar2 = 0;
      iVar6 = iVar5;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) == 0 || (*(int *)(param_1 + 0xbc) < 0))) {
          if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
            iVar6 = (**(code **)(iVar8 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),iVar5,iVar3);
            if (iVar6 < 0) goto LAB_0040a1f4;
            (**(code **)(iVar8 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
          }
          else {
            iVar6 = iVar3;
            if (0x200 < iVar3) {
              iVar6 = 0x200;
            }
            iVar6 = (**(code **)(iVar8 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),iVar5,iVar6);
            if (iVar6 < 0) {
LAB_0040a1f4:
              iVar2 = -1;
              iVar6 = aiStack_20[0];
              goto LAB_0040a0a8;
            }
            (**(code **)(iVar8 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
          }
          iVar3 = iVar3 - iVar6;
          iVar2 = iVar2 + iVar6;
          iVar5 = iVar5 + iVar6;
          iVar6 = aiStack_20[0];
          if (iVar3 < 1) goto LAB_0040a0a8;
        }
        iVar6 = (**(code **)(iVar8 + 0xce750))(*(int *)(param_1 + 0xbc),iVar5,iVar3);
        if (iVar6 < 0) goto LAB_0040a1f4;
        iVar3 = iVar3 - iVar6;
        iVar2 = iVar2 + iVar6;
        iVar5 = iVar5 + iVar6;
        iVar6 = aiStack_20[0];
      } while (0 < iVar3);
    }
LAB_0040a0a8:
    (**(code **)(iVar8 + 0xcdea0))(iVar6);
  }
  return iVar2;
}



void websReplyNoContent(undefined4 param_1)

{
  websWriteNormalHeader(param_1,0xcc,0,0,0);
  websConnClose(param_1,0xcc);
  return;
}



void websReplyUnSupportMsg(int param_1)

{
  size_t sVar1;
  char *__s;
  uint uVar2;
  undefined local_50 [64];
  
  if (*(int *)(param_1 + 0xf4) == 1) {
    uVar2 = *(uint *)(param_1 + 0xe4);
    __s = 
    "<html><body><font size=5 color=red><br><p>The web-based setup page on this device works best in Internet Explorer.<br>You can find Internet Explorer in the start menu under the following context:</p><b><I>All Apps &gt; Windows Accessories &gt; Internet Explorer</I></b></font></body></html>"
    ;
  }
  else {
    memset(local_50,0,0x40);
    getSysInfoBuffer(0x4f,local_50,1);
    switch(local_50[0]) {
    default:
      __s = 
      "<html><body><font size=5 color=red><br><p>The browser you are using may have difficulty receiving images and video. If you experience any issues viewing this page, we suggest using Internet Explorer or Apple Safari.</p></font></body></html>"
      ;
      break;
    case 1:
      __s = 
      "<html><body><font size=5 color=red><br><p>&#24744;&#25152;&#20351;&#29992;&#30340;&#27983;&#35272;&#22120;&#21487;&#33021;&#26080;&#27861;&#25509;&#25910;&#22270;&#20687;&#21644;&#35270;&#39057;&#12290;&#22914;&#26524;&#22312;&#26597;&#30475;&#27492;&#39029;&#38754;&#26102;&#20986;&#29616;&#20219;&#20309;&#38382;&#39064;&#65292;&#25105;&#20204;&#24314;&#35758;&#24744;&#20351;&#29992;Internet Explorer&#25110;Apple Sarfari&#27983;&#35272;&#22120;&#12290;</p></font></body></html>"
      ;
      break;
    case 2:
      __s = 
      "<html><body><font size=5 color=red><br><p>&#24744;&#29694;&#22312;&#20351;&#29992;&#30340;&#28687;&#35261;&#22120;&#21487;&#33021;&#26377;&#22256;&#38627;&#25509;&#21463;&#22294;&#29255;&#25110;&#26159;&#24433;&#29255;&#65292;&#22914;&#26524;&#24744;&#36935;&#21040;&#20219;&#20309;&#21839;&#38988;&#65292;&#24314;&#35696;&#24744;&#20351;&#29992;IE&#28687;&#35261;&#22120;&#25110;Apple Safari</p></font></body></html>"
      ;
      break;
    case 3:
      __s = 
      "<html><body><font size=5 color=red><br><p>Der Browser, den Sie verwenden, hat m&ouml;glicherweise Schwierigkeiten beim Empfangen von Bildern und Videos. Wenn Sie Probleme bei der Darstellung dieser Seite haben, empfehlen wir Ihnen, Internet Explorer oder Apple Safari zu verwenden.</p></font></body></html>"
      ;
      break;
    case 4:
      __s = 
      "<html><body><font size=5 color=red><br><p>Le navigateur utilis&eacute; &agrave; des difficult&eacute;s &agrave; recevoir des images et des vid&eacute;os. Si vous avez des difficult&eacute;s &agrave; voir cette page, essayez d\'utiliser Internet Explorer ou Apple Safari.</p></font></body></html>"
      ;
      break;
    case 5:
      __s = 
      "<html><body><font size=5 color=red><br><p>Il browser in uso potrebbe non ricevere immagini e video correttamente. Se si riscontrano problemi nella visualizzazione di questa pagina, si consiglia di usare Internet Explorer o Apple Safari.</p></font></body></html>"
      ;
      break;
    case 6:
      __s = 
      "<html><body><font size=5 color=red><br><p>Es posible que el navegador web que utiliza tenga dificultades para recibir im&aacute;genes y v&iacute;deo. Si tiene problemas para ver esta p&aacute;gina, le sugerimos que utilice Internet Explorer o Apple Safari.</p></font></body></html>"
      ;
      break;
    case 7:
      __s = 
      "<html><body><font size=5 color=red><br><p>&#51060;&#48120;&#51648;&#50752; &#48708;&#46356;&#50724;&#47484; &#49688;&#49888;&#54616;&#44592; &#50612;&#47140;&#50868; &#48652;&#46972;&#50864;&#51256;&#47484; &#49324;&#50857;&#54616;&#44256; &#51080;&#49845;&#45768;&#45796;. &#51060; &#54168;&#51060;&#51648;&#47484; &#48372;&#45716; &#45936; &#47928;&#51228;&#44032; &#48156;&#49373;&#54616;&#47732; &#51064;&#53552;&#45367; &#51061;&#49828;&#54540;&#47196;&#47084;&#45208; &#50528;&#54540; &#49324;&#54028;&#47532; &#48652;&#46972;&#50864;&#51256; &#51473; &#54616;&#45208;&#47484; &#49324;&#50857;&#54644; &#48372;&#49884;&#44592; &#48148;&#46989;&#45768;&#45796;.</p></font></body></html>"
      ;
    }
    uVar2 = *(uint *)(param_1 + 0xe4);
  }
  if ((uVar2 >> 9 & 1) != 0) {
    return;
  }
  sVar1 = strlen(__s);
  websWriteNormalHeader(param_1,200,sVar1,"text/html",0);
  websWriteFmt(param_1,"%s\r\n",__s);
  websConnClose(param_1,200);
  return;
}



int websTimeoutSched(int param_1,int param_2,int param_3)

{
  int iVar1;
  time_t tVar2;
  int iVar3;
  int *piVar4;
  
  iVar1 = AllocEntry(&DAT_004d8cd0,&DAT_004d4cc4,0x10);
  iVar3 = -1;
  if (-1 < iVar1) {
    piVar4 = *(int **)(iVar1 * 4 + DAT_004d8cd0);
    piVar4[2] = param_2;
    piVar4[3] = param_3;
    *piVar4 = iVar1;
    tVar2 = time((time_t *)0x0);
    piVar4[1] = tVar2 + param_1;
    iVar3 = iVar1;
  }
  return iVar3;
}



void websTimeoutResched(int param_1,int param_2)

{
  time_t tVar1;
  int iVar2;
  
  if ((DAT_004d8cd0 != 0) && (param_1 != -1)) {
    if (param_1 <= DAT_004d4cc4) {
      iVar2 = *(int *)(param_1 * 4 + DAT_004d8cd0);
      if (iVar2 != 0) {
        tVar1 = time((time_t *)0x0);
        *(time_t *)(iVar2 + 4) = tVar1 + param_2;
      }
    }
  }
  return;
}



void websTimeoutUnsched(int param_1)

{
  void *__ptr;
  
  if (DAT_004d8cd0 != 0) {
    if (param_1 != -1) {
      if (param_1 <= DAT_004d4cc4) {
        __ptr = *(void **)(param_1 * 4 + DAT_004d8cd0);
        if (__ptr != (void *)0x0) {
          DAT_004d4cc4 = FreeEntryId(&DAT_004d8cd0,param_1);
          free(__ptr);
        }
      }
    }
  }
  return;
}



void websTimeoutProcess(void)

{
  time_t tVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  
  if (-1 < DAT_004d4cc4) {
    iVar4 = DAT_004d4cc8;
    if (DAT_004d4cc4 < DAT_004d4cc8) {
      DAT_004d4cc8 = 0;
      iVar4 = DAT_004d4cc8;
    }
    do {
      iVar3 = *(int *)(iVar4 * 4 + DAT_004d8cd0);
      if ((iVar3 != 0) && (tVar1 = time((time_t *)0x0), *(int *)(iVar3 + 4) <= tVar1)) {
        puVar2 = *(undefined4 **)(iVar4 * 4 + DAT_004d8cd0);
        (*(code *)puVar2[2])(puVar2[3],*puVar2);
        DAT_004d4cc8 = iVar4 + 1;
        return;
      }
      iVar4 = iVar4 + 1;
      if (DAT_004d4cc4 < iVar4) {
        iVar4 = 0;
      }
    } while (iVar4 != DAT_004d4cc8);
  }
  return;
}



void allocDecodePasswordByName(undefined4 param_1,undefined4 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  
  uVar1 = websGetVar(param_1,param_2,&DAT_0049445c);
  uVar2 = websGetVar(param_1,"SessionKey",&DAT_0049445c);
                    // WARNING: Treating indirect jump as call
  allocDecryptbyKey(uVar1,uVar2);
  return;
}



undefined4 allocEncodePasswordByName(int param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  void *local_18 [2];
  
  uVar1 = nvram_bufget(0);
  allocFmtString(local_18,0xfe,"%s",*(undefined4 *)(param_1 + 0x9c));
  uVar2 = 0;
  if (local_18[0] != (void *)0x0) {
    uVar2 = allocEncryptbyKey(uVar1,local_18[0]);
    if (local_18[0] != (void *)0x0) {
      free(local_18[0]);
    }
  }
  return uVar2;
}



int websWritePasswordByString(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  size_t __n;
  ssize_t sVar2;
  int iVar3;
  size_t sVar4;
  char *__ptr;
  char *__buf;
  undefined4 uStackX_8;
  undefined4 uStackX_c;
  char *apcStack_20 [2];
  
  apcStack_20[0] = (char *)0x0;
  uStackX_8 = param_2;
  uStackX_c = param_4;
  iVar1 = vallocFmtString(apcStack_20,0x400,"%s",&uStackX_8);
  if (0x3ff < iVar1) {
    trace(2,"websConnWrite lost data, buffer overflow\n");
  }
  __buf = apcStack_20[0];
  iVar1 = 0;
  if (apcStack_20[0] != (char *)0x0) {
    __n = strlen(apcStack_20[0]);
    iVar1 = 0;
    if ((int)__n < 1) {
      iVar1 = 0;
      __ptr = __buf;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          sVar2 = write(*(int *)(param_1 + 0xbc),__buf,__n);
          if (sVar2 < 0) {
LAB_0040a1f4:
            iVar1 = -1;
            __ptr = apcStack_20[0];
            goto LAB_0040a0a8;
          }
          __n = __n - sVar2;
          iVar1 = iVar1 + sVar2;
          __buf = __buf + sVar2;
          __ptr = apcStack_20[0];
          if ((int)__n < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar3 = websSocketWrite(*(undefined4 *)(param_1 + 0xd4),__buf,__n);
          if (-1 < iVar3) {
            websSocketFlush(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        sVar4 = __n;
        if (0x200 < (int)__n) {
          sVar4 = 0x200;
        }
        iVar3 = websSSLWrite(*(undefined4 *)(param_1 + 0x110),__buf,sVar4);
        if (iVar3 < 0) goto LAB_0040a1f4;
        websSSLFlush(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        __n = __n - iVar3;
        iVar1 = iVar1 + iVar3;
        __buf = __buf + iVar3;
        __ptr = apcStack_20[0];
      } while (0 < (int)__n);
    }
LAB_0040a0a8:
    free(__ptr);
  }
  return iVar1;
}



void websWritePasswordByName(undefined4 param_1)

{
  undefined4 uVar1;
  
  uVar1 = nvram_bufget(0);
  websWriteFmt(param_1,"%s",uVar1);
  return;
}



void nipcaWritePasswordByString(undefined4 param_1,undefined4 param_2)

{
  undefined auStack_108 [256];
  
  websEncode64(auStack_108,param_2,0xff);
  websWriteFmt(param_1,"%s",auStack_108);
  return;
}



undefined4 websPatchRequest(int param_1,char *param_2)

{
  int iVar1;
  ssize_t sVar2;
  size_t sVar3;
  char *__s1;
  size_t sVar4;
  undefined4 uVar5;
  char cVar6;
  char *pcVar7;
  char cVar8;
  int iVar9;
  int iVar10;
  undefined4 *__src;
  size_t sVar11;
  size_t __nbytes;
  char *pcVar12;
  char acStackX_0 [16];
  stat sStack_1e8;
  char local_150 [256];
  undefined4 local_50;
  undefined4 local_4c;
  undefined2 local_48;
  undefined local_46;
  undefined2 local_40;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined local_2c;
  
  uVar5 = 0xffffffff;
  if (*(int *)(param_1 + 0x114) != 0) {
    iVar1 = stat(param_2,&sStack_1e8);
    if (iVar1 < 0) {
      websConnError(param_1,500,"Can\'t stat %s",param_2);
      uVar5 = 0xffffffff;
    }
    else {
      __nbytes = 0x100;
      iVar1 = 0;
      sVar11 = 0;
      pcVar12 = local_150;
      if (0 < sStack_1e8.st_atim.tv_sec) {
LAB_0040f130:
        sVar2 = read(*(int *)(param_1 + 0x100),pcVar12,__nbytes);
        if (0 < sVar2) {
          sStack_1e8.st_atim.tv_sec = sStack_1e8.st_atim.tv_sec - sVar2;
          pcVar12 = pcVar12 + sVar2;
          if (*(int *)(param_1 + 0x114) == 1) {
            sVar3 = strlen(&WebWiFiToken);
            iVar9 = (int)WebWiFiToken;
            pcVar7 = local_150;
            sVar11 = iVar1 + sVar2;
            while( true ) {
              __s1 = (char *)memchr(pcVar7,iVar9,sVar11);
              if (__s1 == (char *)0x0) goto LAB_0040f2a8;
              iVar10 = memcmp(__s1,&WebWiFiToken,sVar3);
              pcVar7 = __s1 + 1;
              if (iVar10 == 0) break;
              sVar11 = (iVar1 + sVar2) - ((int)pcVar7 - (int)local_150);
            }
            if (__s1 == (char *)0x0) goto LAB_0040f2a8;
            sVar11 = (int)__s1 - (int)local_150;
            if (local_150 != __s1) goto LAB_0040f168;
            sVar11 = strlen(WiFiPatchIPAddress);
            iVar1 = memcmp(local_150,WiFiPatchIPAddress,sVar11);
            if (iVar1 != 0) {
              sVar3 = strlen(WiFiPatchUserName);
              iVar1 = memcmp(local_150,WiFiPatchUserName,sVar3);
              if (iVar1 == 0) {
                pcVar7 = *(char **)(param_1 + 0xac);
                sVar4 = strlen(pcVar7);
              }
              else {
                sVar3 = strlen(WiFiPatchUserPass);
                iVar1 = memcmp(local_150,WiFiPatchUserPass,sVar3);
                if (iVar1 != 0) {
                  sVar11 = strlen(WiFiPatchWlanEnable);
                  iVar1 = memcmp(local_150,WiFiPatchWlanEnable,sVar11);
                  if (iVar1 != 0) {
                    sVar11 = strlen(WiFiPatchMacAddress);
                    iVar1 = memcmp(local_150,WiFiPatchMacAddress,sVar11);
                    if (iVar1 == 0) {
                      local_30 = 0x33333232;
                      local_2c = 0;
                      local_38 = 0x30383030;
                      local_34 = 0x31313863;
                      sVar3 = strlen((char *)&local_38);
                      sVar4 = strlen(WiFiPatchMacAddress);
                      pcVar7 = local_150 + sVar4;
                      __src = &local_38;
                      goto LAB_0040f55c;
                    }
                    sVar11 = strlen(&WebWiFiToken);
                    goto LAB_0040f168;
                  }
                  local_40._0_1_ = '0';
                  local_40._1_1_ = '\0';
                  sVar3 = strlen((char *)&local_40);
                  sVar4 = strlen(WiFiPatchWlanEnable);
                  pcVar7 = local_150 + sVar4;
                  __src = (undefined4 *)&local_40;
                  goto LAB_0040f55c;
                }
                pcVar7 = *(char **)(param_1 + 0xa8);
                sVar4 = strlen(pcVar7);
              }
              memcpy(local_150 + sVar3,pcVar7,sVar4);
              sVar11 = sVar3 + sVar4 + 1;
              local_150[sVar3 + sVar4] = '\0';
              goto LAB_0040f168;
            }
            local_50 = 0x36362e32;
            local_4c = 0x2e38372e;
            local_48 = 0x3036;
            local_46 = 0;
            sVar3 = strlen((char *)&local_50);
            sVar4 = strlen(WiFiPatchIPAddress);
            pcVar7 = local_150 + sVar4;
            __src = &local_50;
LAB_0040f55c:
            memcpy(pcVar7,__src,sVar3);
            sVar11 = sVar4 + sVar3 + 1;
            local_150[sVar4 + sVar3] = '\0';
          }
          goto LAB_0040f168;
        }
      }
LAB_0040f1d0:
      uVar5 = 1;
      if (-1 < *(int *)(param_1 + 0x100)) {
        close(*(int *)(param_1 + 0x100));
        *(undefined4 *)(param_1 + 0x100) = 0xffffffff;
        uVar5 = 1;
      }
    }
  }
  return uVar5;
LAB_0040f2a8:
  sVar11 = (int)pcVar12 - (int)local_150;
  if (pcVar12[-2] == '#') {
    cVar6 = pcVar12[-1];
    if (cVar6 != '@') goto LAB_0040f2bc;
    cVar8 = *pcVar12;
    if (cVar8 != '$') goto LAB_0040f2c4;
    sVar11 = sVar11 - 3;
  }
  else {
    cVar6 = pcVar12[-1];
LAB_0040f2bc:
    cVar8 = *pcVar12;
LAB_0040f2c4:
    if ((cVar6 == '#') && (cVar8 == '@')) {
      sVar11 = sVar11 - 2;
    }
    else if (cVar8 == '#') {
      sVar11 = websWriteComplete(param_1,local_150,sVar11 - 1);
      goto joined_r0x0040f308;
    }
  }
LAB_0040f168:
  sVar11 = websWriteComplete(param_1,local_150,sVar11);
joined_r0x0040f308:
  pcVar7 = local_150 + sVar11;
  if (pcVar7 == pcVar12) {
    __nbytes = 0x100;
    iVar1 = 0;
    pcVar12 = local_150;
  }
  else {
    __nbytes = (__nbytes - sVar2) + sVar11;
    iVar1 = (int)pcVar12 - (int)pcVar7;
    iVar9 = 0;
    if (0 < iVar1) {
      do {
        iVar10 = iVar9 + 1;
        local_150[iVar9] = pcVar7[iVar9];
        iVar9 = iVar10;
      } while (iVar10 < iVar1);
    }
    pcVar12 = local_150 + iVar1;
  }
  if ((sStack_1e8.st_atim.tv_sec < 1) || ((int)__nbytes < 1)) goto LAB_0040f1d0;
  goto LAB_0040f130;
}



void websetReplayPage(int param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  char cVar1;
  char *pcVar2;
  int local_20 [2];
  
  if (param_2 == 0) {
    pcVar2 = (char *)websGetVar(param_1,param_3,&DAT_0049445c);
    cVar1 = *pcVar2;
  }
  else {
    pcVar2 = (char *)websGetVar(param_1,param_4,&DAT_0049445c);
    cVar1 = *pcVar2;
  }
  if (cVar1 != '\0') {
    local_20[0] = 0;
    if (*pcVar2 == '/') {
      local_20[0] = strdupWithoutNull(pcVar2);
    }
    else {
      allocFmtString(local_20,0xfe,&DAT_0048bae0);
    }
    if (local_20[0] != 0) {
      if (*(void **)(param_1 + 0x88) == (void *)0x0) {
        *(int *)(param_1 + 0x88) = local_20[0];
      }
      else {
        free(*(void **)(param_1 + 0x88));
        *(int *)(param_1 + 0x88) = local_20[0];
      }
    }
    return;
  }
  trace(0x10,"websetReplayPage(%d,%s,%s)\n",param_2,param_3,param_4);
  return;
}



int websAddUser(char *param_1,char *param_2,char *param_3)

{
  bool bVar1;
  int iVar2;
  size_t sVar3;
  size_t sVar4;
  char *__dest;
  char *pcVar5;
  char *pcVar6;
  int iVar7;
  int iVar8;
  char acStack_60 [64];
  
  bVar1 = false;
  iVar8 = 0;
  if ((param_3 == (char *)0x0) || (iVar2 = strcmp(param_3,"1"), iVar2 != 0)) {
    sVar3 = strlen(param_1);
    sVar4 = strlen(param_2);
    __dest = (char *)mmalloc(sVar3 + sVar4 + 9);
  }
  else {
    sVar3 = strlen(param_1);
    sVar4 = strlen(param_2);
    __dest = (char *)mmalloc(sVar3 + sVar4 + 9);
    bVar1 = true;
  }
  if (__dest == (char *)0x0) {
    iVar8 = -1;
  }
  else {
    strcpy(__dest,param_1);
    strcat(__dest,"/");
    strcat(__dest,param_2);
    strcat(__dest,"/");
    if (bVar1) {
      pcVar5 = "iter == 1";
    }
    else {
      pcVar5 = "plen == 0";
    }
    strcat(__dest,pcVar5 + 8);
    iVar2 = 1;
    do {
      snprintf(acStack_60,0x40,"User%d",iVar2);
      pcVar5 = (char *)nvram_bufget(0,acStack_60);
      if ((pcVar5 == (char *)0x0) || (*pcVar5 == '\0')) {
        nvram_bufset(0,acStack_60,__dest);
LAB_0040fb24:
        if (8 < iVar2) {
          iVar8 = -2;
        }
        goto LAB_0040fa1c;
      }
      pcVar5 = (char *)strdupWithoutNull(pcVar5);
      if (pcVar5 == (char *)0x0) {
        iVar8 = -1;
        goto LAB_0040fb24;
      }
      pcVar6 = strchr(pcVar5,0x2f);
      if (pcVar6 != (char *)0x0) {
        *pcVar6 = '\0';
        pcVar6 = strrchr(pcVar6 + 1,0x2f);
        if (pcVar6 != (char *)0x0) {
          *pcVar6 = '\0';
        }
      }
      if (pcVar5 != (char *)0x0) {
        if ((*pcVar5 != '\0') && (iVar7 = strcmp(pcVar5,param_1), iVar7 == 0)) {
          nvram_bufset(0,acStack_60,__dest);
          iVar8 = 1;
          free(pcVar5);
          goto LAB_0040fb24;
        }
        free(pcVar5);
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 < 9);
    iVar8 = -2;
LAB_0040fa1c:
    if (__dest != (char *)0x0) {
      free(__dest);
    }
    if (-1 < iVar8) {
      nvram_commit(0);
      return iVar8;
    }
  }
  return iVar8;
}



int websDeleteUser(char *param_1)

{
  char *pcVar1;
  char *pcVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  char acStack_40 [16];
  char acStack_30 [16];
  
  iVar7 = 0;
  iVar6 = 0;
  iVar5 = 1;
  do {
    snprintf(acStack_40,0x10,"User%d",iVar5);
    pcVar1 = (char *)nvram_bufget(0,acStack_40);
    if ((pcVar1 != (char *)0x0) && (*pcVar1 != '\0')) {
      pcVar1 = (char *)strdupWithoutNull(pcVar1);
      if (pcVar1 == (char *)0x0) {
        iVar6 = -1;
LAB_0040fd00:
        if (8 < iVar5) {
          return -2;
        }
        if (iVar6 == 0) {
          if (iVar7 < 8) {
            do {
              snprintf(acStack_40,0x10,"User%d",iVar7);
              iVar7 = iVar7 + 1;
              snprintf(acStack_30,0x10,"User%d",iVar7);
              uVar4 = nvram_bufget(0,acStack_30);
              nvram_bufset(0,acStack_40,uVar4);
            } while (iVar7 < 8);
            nvram_bufset(0,acStack_30,&DAT_0049445c);
          }
          nvram_commit(0);
          return 0;
        }
        return iVar6;
      }
      pcVar2 = strchr(pcVar1,0x2f);
      if (pcVar2 != (char *)0x0) {
        *pcVar2 = '\0';
        pcVar2 = strrchr(pcVar2 + 1,0x2f);
        if (pcVar2 != (char *)0x0) {
          *pcVar2 = '\0';
        }
      }
      if (pcVar1 != (char *)0x0) {
        if ((*pcVar1 != '\0') && (iVar3 = strcmp(pcVar1,param_1), iVar3 == 0)) {
          nvram_bufset(0,acStack_40,&DAT_0049445c);
          free(pcVar1);
          iVar7 = iVar5;
          goto LAB_0040fd00;
        }
        if (pcVar1 != (char *)0x0) {
          free(pcVar1);
        }
      }
    }
    iVar5 = iVar5 + 1;
    if (8 < iVar5) {
      return -2;
    }
  } while( true );
}



void webAddReplyMessage(int param_1,char *param_2,int param_3)

{
  int iVar1;
  char acStack_258 [64];
  char acStack_218 [512];
  
  if (param_2 != (char *)0x0) {
    if (*param_2 != '\0') {
      memset(acStack_218,0,0x200);
      snprintf(acStack_258,0x40,"Message%d",*(undefined4 *)(param_1 + 0x118));
      if (param_3 == 0) {
        snprintf(acStack_218,0x200,"%s",param_2);
      }
      else {
        iVar1 = *(int *)(param_1 + 0x11c);
        *(int *)(param_1 + 0x11c) = iVar1 + 1;
        snprintf(acStack_218,0x200,"%2d. %s",iVar1,param_2);
      }
      *(int *)(param_1 + 0x118) = *(int *)(param_1 + 0x118) + 1;
      websSetVar(param_1,acStack_258,acStack_218);
      trace(1,"webAddReplyMessage(%s=%s)\n",acStack_258,acStack_218);
      return;
    }
  }
  trace(1,"webAddReplyMessage(empty!)\n");
  return;
}



undefined4 AllocPassFromConfigByUser(undefined4 param_1,char *param_2,int *param_3)

{
  char *__s;
  char *__s_00;
  void *__ptr;
  char *pcVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  undefined *puVar6;
  char acStack_68 [64];
  
  puVar6 = &_gp;
  uVar5 = 0;
  iVar3 = 1;
  iVar4 = 0;
  do {
    snprintf(acStack_68,0x40,"User%d",iVar3,puVar6);
    __s = (char *)nvram_bufget(0,acStack_68);
    if ((__s != (char *)0x0) && (*__s != '\0')) {
      __s_00 = strchr(__s,0x2f);
      __ptr = (void *)strdupWithoutNull(__s);
      if (__ptr != (void *)0x0) {
        if (__s_00 != (char *)0x0) {
          *__s_00 = '\0';
          __s_00 = __s_00 + 1;
          pcVar1 = strrchr(__s_00,0x2f);
          if (pcVar1 != (char *)0x0) {
            *pcVar1 = '\0';
          }
        }
        iVar2 = strcmp(__s,param_2);
        if (iVar2 == 0) {
          uVar5 = strdupWithoutNull(__s_00);
          iVar4 = iVar4 + 1;
          *param_3 = iVar3;
        }
        if (__ptr != (void *)0x0) {
          free(__ptr);
        }
      }
    }
    iVar3 = iVar3 + 1;
  } while ((iVar3 < 9) && (iVar4 == 0));
  return uVar5;
}



undefined4 * AllocPrintableString(char *param_1)

{
  undefined uVar1;
  undefined uVar2;
  char cVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  char *pcVar7;
  int iVar8;
  undefined4 *puVar9;
  
  cVar3 = *param_1;
  iVar8 = 0;
  pcVar7 = param_1;
  while (cVar3 != '\0') {
    switch(cVar3) {
    case '\"':
    case '\'':
      cVar3 = pcVar7[1];
      iVar8 = iVar8 + 6;
      break;
    default:
      cVar3 = pcVar7[1];
      iVar8 = iVar8 + 1;
      break;
    case '&':
      cVar3 = pcVar7[1];
      iVar8 = iVar8 + 5;
      break;
    case '<':
    case '>':
      cVar3 = pcVar7[1];
      iVar8 = iVar8 + 4;
    }
    pcVar7 = pcVar7 + 1;
  }
  puVar4 = (undefined4 *)mmalloc(iVar8 + 1);
  if (puVar4 != (undefined4 *)0x0) {
    cVar3 = *param_1;
    puVar9 = puVar4;
    while (cVar3 != '\0') {
      switch(cVar3) {
      case '\"':
        uVar6 = 0x6f757126;
        puVar5 = &DAT_0048bb74;
        goto LAB_004102c4;
      default:
        *(char *)puVar9 = *param_1;
        cVar3 = param_1[1];
        puVar9 = (undefined4 *)((int)puVar9 + 1);
        break;
      case '&':
        *puVar9 = 0x706d6126;
        *(undefined *)(puVar9 + 1) = 0x3b;
        cVar3 = param_1[1];
        puVar9 = (undefined4 *)((int)puVar9 + 5);
        break;
      case '\'':
        uVar6 = 0x6f706126;
        puVar5 = &DAT_0048bb64;
LAB_004102c4:
        uVar1 = *(undefined *)((int)puVar5 + 5);
        uVar2 = *(undefined *)(puVar5 + 1);
        *puVar9 = uVar6;
        *(undefined *)(puVar9 + 1) = uVar2;
        *(undefined *)((int)puVar9 + 5) = uVar1;
        cVar3 = param_1[1];
        puVar9 = (undefined4 *)((int)puVar9 + 6);
        break;
      case '<':
        *puVar9 = 0x3b746c26;
        goto LAB_00410284;
      case '>':
        *puVar9 = 0x3b746726;
LAB_00410284:
        puVar9 = puVar9 + 1;
        cVar3 = param_1[1];
      }
      param_1 = param_1 + 1;
    }
  }
  return puVar4;
}



undefined4 * AllocXMLString(char *param_1)

{
  undefined uVar1;
  undefined uVar2;
  char cVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  char *pcVar7;
  int iVar8;
  undefined4 *puVar9;
  
  cVar3 = *param_1;
  iVar8 = 0;
  pcVar7 = param_1;
  while (cVar3 != '\0') {
    switch(cVar3) {
    case '\"':
    case '\'':
      cVar3 = pcVar7[1];
      iVar8 = iVar8 + 6;
      break;
    default:
      cVar3 = pcVar7[1];
      iVar8 = iVar8 + 1;
      break;
    case '&':
      cVar3 = pcVar7[1];
      iVar8 = iVar8 + 5;
      break;
    case '<':
    case '>':
      cVar3 = pcVar7[1];
      iVar8 = iVar8 + 4;
    }
    pcVar7 = pcVar7 + 1;
  }
  puVar4 = (undefined4 *)mmalloc(iVar8 + 1);
  if (puVar4 != (undefined4 *)0x0) {
    cVar3 = *param_1;
    puVar9 = puVar4;
    while (cVar3 != '\0') {
      switch(cVar3) {
      case '\"':
        uVar6 = 0x6f757126;
        puVar5 = &DAT_0048bb74;
        goto LAB_004104c8;
      default:
        *(char *)puVar9 = *param_1;
        cVar3 = param_1[1];
        puVar9 = (undefined4 *)((int)puVar9 + 1);
        break;
      case '&':
        *puVar9 = 0x706d6126;
        *(undefined *)(puVar9 + 1) = 0x3b;
        cVar3 = param_1[1];
        puVar9 = (undefined4 *)((int)puVar9 + 5);
        break;
      case '\'':
        uVar6 = 0x6f706126;
        puVar5 = &DAT_0048bb64;
LAB_004104c8:
        uVar1 = *(undefined *)((int)puVar5 + 5);
        uVar2 = *(undefined *)(puVar5 + 1);
        *puVar9 = uVar6;
        *(undefined *)(puVar9 + 1) = uVar2;
        *(undefined *)((int)puVar9 + 5) = uVar1;
        cVar3 = param_1[1];
        puVar9 = (undefined4 *)((int)puVar9 + 6);
        break;
      case '<':
        *puVar9 = 0x3b746c26;
        goto LAB_00410488;
      case '>':
        *puVar9 = 0x3b746726;
LAB_00410488:
        puVar9 = puVar9 + 1;
        cVar3 = param_1[1];
      }
      param_1 = param_1 + 1;
    }
  }
  return puVar4;
}



undefined4 WriteHexString(undefined4 param_1,byte *param_2)

{
  byte bVar1;
  undefined4 uVar2;
  size_t sVar3;
  char *__s;
  size_t sVar4;
  uint uVar5;
  uint __n;
  char acStack_30 [16];
  
  if ((param_2 != (byte *)0x0) && (*param_2 != 0)) {
    sVar3 = strlen((char *)param_2);
    __n = sVar3 * 2 + 2;
    __s = (char *)mmalloc(__n);
    if (__s != (char *)0x0) {
      memset(__s,0,__n);
      bVar1 = *param_2;
      while (uVar5 = (uint)bVar1, uVar5 != 0) {
        while( true ) {
          snprintf(acStack_30,0x10,"%X",uVar5);
          param_2 = param_2 + 1;
          sVar3 = strlen(__s);
          sVar4 = strlen(acStack_30);
          if (__n <= sVar3 + sVar4) break;
          strcat(__s,acStack_30);
          uVar5 = (uint)*param_2;
          if (uVar5 == 0) goto LAB_004106b0;
        }
        bVar1 = *param_2;
      }
LAB_004106b0:
      if (__s != (char *)0x0) {
        uVar2 = websWriteFmt(param_1,"%s",__s);
        free(__s);
        return uVar2;
      }
    }
  }
  uVar2 = websWriteFmt(param_1,"%s",&DAT_0049445c);
  return uVar2;
}



// WARNING: Switch with 1 destination removed at 0x00410784

int WritePrintableString(int param_1,char *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  char *pcVar4;
  int iVar5;
  code *pcVar6;
  code *pcStackX_8;
  code *pcStackX_c;
  int aiStack_20 [2];
  undefined *local_18;
  
  local_18 = &_gp;
  pcStackX_c = websWriteFmt;
  pcStackX_8 = (code *)&DAT_0049445c;
  pcVar4 = "%s";
  pcVar6 = pcStackX_c;
  if ((param_2 != (char *)0x0) && (*param_2 != '\0')) {
    iVar2 = AllocPrintableString(param_2);
    if (iVar2 != 0) {
      iVar3 = (**(code **)(local_18 + -0x7884))(param_1,*(int *)(local_18 + -0x7fe0) + -0x42c,iVar2)
      ;
      (**(code **)(local_18 + -0x7b84))(iVar2);
      return iVar3;
    }
    pcStackX_c = *(code **)(local_18 + -0x7fe0);
    pcVar4 = (char *)(*(int *)(local_18 + -0x7fe0) + -0x42c);
    pcStackX_8 = pcStackX_c + 0x445c;
    pcVar6 = *(code **)(local_18 + -0x7884);
  }
  aiStack_20[0] = 0;
  iVar2 = (**(code **)(pcVar6 + 0xce114))(aiStack_20,0x400,pcVar4,&pcStackX_8);
  if (0x3ff < iVar2) {
    (**(code **)(pcVar6 + 0xceac8))(2,*(int *)(pcVar6 + 0xcda44) + -0x626c);
  }
  iVar2 = aiStack_20[0];
  iVar3 = 0;
  if (aiStack_20[0] != 0) {
    iVar1 = (**(code **)(pcVar6 + 0xce008))(aiStack_20[0]);
    iVar3 = 0;
    if (iVar1 < 1) {
      iVar3 = 0;
      iVar5 = iVar2;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          iVar5 = (**(code **)(pcVar6 + 0xce750))(*(int *)(param_1 + 0xbc),iVar2,iVar1);
          if (iVar5 < 0) {
LAB_0040a1f4:
            iVar3 = -1;
            iVar5 = aiStack_20[0];
            goto LAB_0040a0a8;
          }
          iVar1 = iVar1 - iVar5;
          iVar3 = iVar3 + iVar5;
          iVar2 = iVar2 + iVar5;
          iVar5 = aiStack_20[0];
          if (iVar1 < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar5 = (**(code **)(pcVar6 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),iVar2,iVar1);
          if (-1 < iVar5) {
            (**(code **)(pcVar6 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        iVar5 = iVar1;
        if (0x200 < iVar1) {
          iVar5 = 0x200;
        }
        iVar5 = (**(code **)(pcVar6 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),iVar2,iVar5);
        if (iVar5 < 0) goto LAB_0040a1f4;
        (**(code **)(pcVar6 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        iVar1 = iVar1 - iVar5;
        iVar3 = iVar3 + iVar5;
        iVar2 = iVar2 + iVar5;
        iVar5 = aiStack_20[0];
      } while (0 < iVar1);
    }
LAB_0040a0a8:
    (**(code **)(pcVar6 + 0xcdea0))(iVar5);
  }
  return iVar3;
}



void WriteMacString(undefined4 param_1,byte *param_2,int param_3)

{
  char cVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  int iVar5;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  local_10 = 0;
  local_c = 0;
  iVar5 = 0;
  puVar3 = &local_28;
  do {
    uVar2 = (uint)*param_2;
    param_2 = param_2 + 1;
    if (0xf < uVar2) {
      cVar1 = *(char *)puVar3;
      do {
        uVar2 = uVar2 - 0x10;
        cVar1 = cVar1 + '\x01';
      } while (0xf < uVar2);
      *(char *)puVar3 = cVar1;
    }
    cVar1 = *(char *)puVar3 + '0';
    if (cVar1 < ':') {
      *(char *)puVar3 = cVar1;
    }
    else {
      *(char *)puVar3 = *(char *)puVar3 + '7';
    }
    if ((int)((uVar2 + 0x30) * 0x1000000) >> 0x18 < 0x3a) {
      *(char *)((int)puVar3 + 1) = (char)(uVar2 + 0x30);
    }
    else {
      *(char *)((int)puVar3 + 1) = (char)uVar2 + '7';
    }
    puVar4 = (undefined4 *)((int)puVar3 + 2);
    if (iVar5 < 5) {
      if (param_3 == 1) {
        puVar4 = (undefined4 *)((int)puVar3 + 3);
        *(char *)((int)puVar3 + 2) = ' ';
      }
      else if (param_3 == 2) {
        puVar4 = (undefined4 *)((int)puVar3 + 3);
        *(char *)((int)puVar3 + 2) = ':';
      }
    }
    iVar5 = iVar5 + 1;
    puVar3 = puVar4;
  } while (iVar5 < 6);
  *(char *)puVar4 = '\0';
  websWriteFmt(param_1,"%s",&local_28);
  return;
}



void WriteTimerString(undefined4 param_1,char *param_2,uint param_3,uint param_4,ushort param_5,
                     ushort param_6,ushort param_7,ushort param_8)

{
  tm local_60;
  char acStack_30 [32];
  
  local_60.tm_hour = (int)param_6;
  local_60.tm_min = (int)param_7;
  local_60.tm_sec = (int)param_8;
  local_60.tm_mday = (int)param_5;
  local_60.tm_year = param_3 & 0xffff;
  local_60.tm_mon = param_4 & 0xffff;
  strftime(acStack_30,0x20,param_2,&local_60);
  websWriteFmt(param_1,"%s",acStack_30);
  return;
}



// WARNING: Switch with 1 destination removed at 0x00410a9c
// WARNING: Switch with 1 destination removed at 0x00410af0

int getStringConfig(int param_1,undefined4 param_2,int param_3,char **param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  char *pcVar4;
  int iVar5;
  int iVar6;
  char *pcStackX_8;
  int iStackX_c;
  int aiStack_20 [2];
  undefined *local_18;
  
  local_18 = &_gp;
  if (0 < param_3) {
    iVar3 = strcmp(*param_4,"2");
    if (iVar3 == 0) {
      iVar3 = (**(code **)(local_18 + -0x74ac))(param_1,param_2);
      if (iVar3 != 0) {
        pcVar4 = (char *)(**(code **)(local_18 + -0x745c))
                                   (param_1,param_2,*(int *)(local_18 + -0x7fe0) + 0x445c);
        goto LAB_00410a54;
      }
    }
  }
  pcVar4 = (char *)(**(code **)(local_18 + -0x71d4))(0,param_2);
LAB_00410a54:
  iVar6 = *(int *)(local_18 + -0x7884);
  iStackX_c = *(int *)(local_18 + -0x7fe0);
  pcStackX_8 = (char *)(*(int *)(local_18 + -0x7fe0) + 0x445c);
  iVar3 = iStackX_c;
  if ((pcVar4 != (char *)0x0) && (*pcVar4 != '\0')) {
    pcStackX_8 = pcVar4;
    iVar3 = *(int *)(local_18 + -0x7fe0);
  }
  aiStack_20[0] = 0;
  iVar3 = (**(code **)(iVar6 + 0xce114))(aiStack_20,0x400,iVar3 + -0x42c,&pcStackX_8);
  if (0x3ff < iVar3) {
    (**(code **)(iVar6 + 0xceac8))(2,*(int *)(iVar6 + 0xcda44) + -0x626c);
  }
  iVar3 = aiStack_20[0];
  iVar1 = 0;
  if (aiStack_20[0] != 0) {
    iVar2 = (**(code **)(iVar6 + 0xce008))(aiStack_20[0]);
    iVar1 = 0;
    if (iVar2 < 1) {
      iVar1 = 0;
      iVar5 = iVar3;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) == 0 || (*(int *)(param_1 + 0xbc) < 0))) {
          if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
            iVar5 = (**(code **)(iVar6 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),iVar3,iVar2);
            if (iVar5 < 0) goto LAB_0040a1f4;
            (**(code **)(iVar6 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
          }
          else {
            iVar5 = iVar2;
            if (0x200 < iVar2) {
              iVar5 = 0x200;
            }
            iVar5 = (**(code **)(iVar6 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),iVar3,iVar5);
            if (iVar5 < 0) {
LAB_0040a1f4:
              iVar1 = -1;
              iVar5 = aiStack_20[0];
              goto LAB_0040a0a8;
            }
            (**(code **)(iVar6 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
          }
          iVar2 = iVar2 - iVar5;
          iVar1 = iVar1 + iVar5;
          iVar3 = iVar3 + iVar5;
          iVar5 = aiStack_20[0];
          if (iVar2 < 1) goto LAB_0040a0a8;
        }
        iVar5 = (**(code **)(iVar6 + 0xce750))(*(int *)(param_1 + 0xbc),iVar3,iVar2);
        if (iVar5 < 0) goto LAB_0040a1f4;
        iVar2 = iVar2 - iVar5;
        iVar1 = iVar1 + iVar5;
        iVar3 = iVar3 + iVar5;
        iVar5 = aiStack_20[0];
      } while (0 < iVar2);
    }
LAB_0040a0a8:
    (**(code **)(iVar6 + 0xcdea0))(iVar5);
  }
  return iVar1;
}



void getHashMd5StringConfig(int param_1,undefined4 param_2,int param_3,char **param_4)

{
  char *pcVar1;
  int iVar2;
  char *__s;
  size_t sVar3;
  size_t sVar4;
  undefined auStack_a8 [64];
  undefined auStack_68 [64];
  char *local_28 [2];
  
  local_28[0] = (char *)0x0;
  memset(auStack_a8,0,0x40);
  memset(auStack_68,0,0x40);
  allocFmtString(local_28,0xfe,"%s",*(undefined4 *)(param_1 + 0x9c));
  if (local_28[0] == (char *)0x0) goto LAB_00410c60;
  if (param_3 < 1) {
LAB_00410bd4:
    __s = (char *)nvram_bufget(0,param_2);
  }
  else {
    iVar2 = strcmp(*param_4,"2");
    if (iVar2 != 0) goto LAB_00410bd4;
    iVar2 = websTestVar(param_1,param_2);
    if (iVar2 == 0) goto LAB_00410bd4;
    __s = (char *)websGetVar(param_1,param_2,&DAT_0049445c);
  }
  sVar3 = strlen(__s);
  pcVar1 = local_28[0];
  sVar4 = strlen(local_28[0]);
  hmac_md5(__s,sVar3,pcVar1,sVar4,auStack_a8);
  hexarraytohexstring(auStack_a8,auStack_68,0x10);
  if (local_28[0] != (char *)0x0) {
    free(local_28[0]);
    local_28[0] = (char *)0x0;
    websWriteFmt(param_1,"%s",auStack_68);
    return;
  }
LAB_00410c60:
  websWriteFmt(param_1,"%s",auStack_68);
  return;
}



undefined4 getHexStringConfig(undefined4 param_1,undefined4 param_2,int param_3,char **param_4)

{
  byte bVar1;
  int iVar2;
  byte *__s;
  undefined4 uVar3;
  size_t sVar4;
  char *__s_00;
  size_t sVar5;
  uint uVar6;
  uint __n;
  char acStack_30 [16];
  
  if (((param_3 < 1) || (iVar2 = strcmp(*param_4,"2"), iVar2 != 0)) ||
     (iVar2 = websTestVar(param_1,param_2), iVar2 == 0)) {
    __s = (byte *)nvram_bufget(0,param_2);
  }
  else {
    __s = (byte *)websGetVar(param_1,param_2,&DAT_0049445c);
  }
  if ((__s != (byte *)0x0) && (*__s != 0)) {
    sVar4 = strlen((char *)__s);
    __n = sVar4 * 2 + 2;
    __s_00 = (char *)mmalloc(__n);
    if (__s_00 != (char *)0x0) {
      memset(__s_00,0,__n);
      bVar1 = *__s;
      while (uVar6 = (uint)bVar1, uVar6 != 0) {
        while( true ) {
          snprintf(acStack_30,0x10,"%X",uVar6);
          __s = __s + 1;
          sVar4 = strlen(__s_00);
          sVar5 = strlen(acStack_30);
          if (__n <= sVar4 + sVar5) break;
          strcat(__s_00,acStack_30);
          uVar6 = (uint)*__s;
          if (uVar6 == 0) goto LAB_00410ee4;
        }
        bVar1 = *__s;
      }
LAB_00410ee4:
      if (__s_00 != (char *)0x0) {
        uVar3 = websWriteFmt(param_1,"%s",__s_00);
        free(__s_00);
        return uVar3;
      }
    }
  }
  uVar3 = websWriteFmt(param_1,"%s",&DAT_0049445c);
  return uVar3;
}



// WARNING: Switch with 1 destination removed at 0x00411020

int getPrintableStringConfig(int param_1,undefined4 param_2,int param_3,char **param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  char *pcVar4;
  int iVar5;
  int iVar6;
  int iStackX_8;
  int iStackX_c;
  int aiStack_20 [2];
  undefined *local_18;
  
  local_18 = &_gp;
  if (((param_3 < 1) || (iVar3 = strcmp(*param_4,"2"), iVar3 != 0)) ||
     (iVar3 = (**(code **)(local_18 + -0x74ac))(param_1,param_2), iVar3 == 0)) {
    pcVar4 = (char *)(**(code **)(local_18 + -0x71d4))(0,param_2);
  }
  else {
    pcVar4 = (char *)(**(code **)(local_18 + -0x745c))
                               (param_1,param_2,*(int *)(local_18 + -0x7fe0) + 0x445c);
  }
  if (((pcVar4 != (char *)0x0) && (*pcVar4 != '\0')) &&
     (iVar3 = (**(code **)(local_18 + -0x7898))(pcVar4), iVar3 != 0)) {
    iVar6 = (**(code **)(local_18 + -0x7884))(param_1,*(int *)(local_18 + -0x7fe0) + -0x42c,iVar3);
    (**(code **)(local_18 + -0x7b84))(iVar3);
    return iVar6;
  }
  iStackX_c = *(int *)(local_18 + -0x7fe0);
  iVar6 = *(int *)(local_18 + -0x7884);
  iStackX_8 = *(int *)(local_18 + -0x7fe0) + 0x445c;
  aiStack_20[0] = 0;
  iVar3 = (**(code **)(iVar6 + 0xce114))(aiStack_20,0x400,iStackX_c + -0x42c,&iStackX_8);
  if (0x3ff < iVar3) {
    (**(code **)(iVar6 + 0xceac8))(2,*(int *)(iVar6 + 0xcda44) + -0x626c);
  }
  iVar3 = aiStack_20[0];
  iVar1 = 0;
  if (aiStack_20[0] != 0) {
    iVar2 = (**(code **)(iVar6 + 0xce008))(aiStack_20[0]);
    iVar1 = 0;
    if (iVar2 < 1) {
      iVar1 = 0;
      iVar5 = iVar3;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          iVar5 = (**(code **)(iVar6 + 0xce750))(*(int *)(param_1 + 0xbc),iVar3,iVar2);
          if (iVar5 < 0) {
LAB_0040a1f4:
            iVar1 = -1;
            iVar5 = aiStack_20[0];
            goto LAB_0040a0a8;
          }
          iVar2 = iVar2 - iVar5;
          iVar1 = iVar1 + iVar5;
          iVar3 = iVar3 + iVar5;
          iVar5 = aiStack_20[0];
          if (iVar2 < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar5 = (**(code **)(iVar6 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),iVar3,iVar2);
          if (-1 < iVar5) {
            (**(code **)(iVar6 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        iVar5 = iVar2;
        if (0x200 < iVar2) {
          iVar5 = 0x200;
        }
        iVar5 = (**(code **)(iVar6 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),iVar3,iVar5);
        if (iVar5 < 0) goto LAB_0040a1f4;
        (**(code **)(iVar6 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        iVar2 = iVar2 - iVar5;
        iVar1 = iVar1 + iVar5;
        iVar3 = iVar3 + iVar5;
        iVar5 = aiStack_20[0];
      } while (0 < iVar2);
    }
LAB_0040a0a8:
    (**(code **)(iVar6 + 0xcdea0))(iVar5);
  }
  return iVar1;
}



// WARNING: Switch with 1 destination removed at 0x0041117c
// WARNING: Switch with 1 destination removed at 0x004111d0

int getIntConfig(int param_1,undefined4 param_2,int param_3,char **param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  char *pcVar4;
  int iVar5;
  int iVar6;
  char *pcStackX_8;
  int iStackX_c;
  int aiStack_20 [2];
  undefined *local_18;
  
  local_18 = &_gp;
  if (0 < param_3) {
    iVar3 = strcmp(*param_4,"2");
    if (iVar3 == 0) {
      iVar3 = (**(code **)(local_18 + -0x74ac))(param_1,param_2);
      if (iVar3 != 0) {
        pcVar4 = (char *)(**(code **)(local_18 + -0x745c))
                                   (param_1,param_2,*(int *)(local_18 + -0x7fe0) + 0x1988);
        goto LAB_00411134;
      }
    }
  }
  pcVar4 = (char *)(**(code **)(local_18 + -0x71d4))(0,param_2);
LAB_00411134:
  iVar6 = *(int *)(local_18 + -0x7884);
  iStackX_c = *(int *)(local_18 + -0x7fe0);
  pcStackX_8 = (char *)(*(int *)(local_18 + -0x7fe0) + 0x1988);
  iVar3 = iStackX_c;
  if ((pcVar4 != (char *)0x0) && (*pcVar4 != '\0')) {
    pcStackX_8 = pcVar4;
    iVar3 = *(int *)(local_18 + -0x7fe0);
  }
  aiStack_20[0] = 0;
  iVar3 = (**(code **)(iVar6 + 0xce114))(aiStack_20,0x400,iVar3 + -0x42c,&pcStackX_8);
  if (0x3ff < iVar3) {
    (**(code **)(iVar6 + 0xceac8))(2,*(int *)(iVar6 + 0xcda44) + -0x626c);
  }
  iVar3 = aiStack_20[0];
  iVar1 = 0;
  if (aiStack_20[0] != 0) {
    iVar2 = (**(code **)(iVar6 + 0xce008))(aiStack_20[0]);
    iVar1 = 0;
    if (iVar2 < 1) {
      iVar1 = 0;
      iVar5 = iVar3;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) == 0 || (*(int *)(param_1 + 0xbc) < 0))) {
          if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
            iVar5 = (**(code **)(iVar6 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),iVar3,iVar2);
            if (iVar5 < 0) goto LAB_0040a1f4;
            (**(code **)(iVar6 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
          }
          else {
            iVar5 = iVar2;
            if (0x200 < iVar2) {
              iVar5 = 0x200;
            }
            iVar5 = (**(code **)(iVar6 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),iVar3,iVar5);
            if (iVar5 < 0) {
LAB_0040a1f4:
              iVar1 = -1;
              iVar5 = aiStack_20[0];
              goto LAB_0040a0a8;
            }
            (**(code **)(iVar6 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
          }
          iVar2 = iVar2 - iVar5;
          iVar1 = iVar1 + iVar5;
          iVar3 = iVar3 + iVar5;
          iVar5 = aiStack_20[0];
          if (iVar2 < 1) goto LAB_0040a0a8;
        }
        iVar5 = (**(code **)(iVar6 + 0xce750))(*(int *)(param_1 + 0xbc),iVar3,iVar2);
        if (iVar5 < 0) goto LAB_0040a1f4;
        iVar2 = iVar2 - iVar5;
        iVar1 = iVar1 + iVar5;
        iVar3 = iVar3 + iVar5;
        iVar5 = aiStack_20[0];
      } while (0 < iVar2);
    }
LAB_0040a0a8:
    (**(code **)(iVar6 + 0xcdea0))(iVar5);
  }
  return iVar1;
}



// WARNING: Switch with 1 destination removed at 0x004112c0

int getRadioConfig(int param_1,undefined4 param_2,int param_3,char **param_4)

{
  int iVar1;
  char *pcVar2;
  int iVar3;
  int iVar4;
  undefined *puVar5;
  char *__s1;
  undefined *puVar6;
  int iVar7;
  char **ppcStackX_8;
  char **ppcStackX_c;
  undefined *local_20 [2];
  
  local_20[0] = &_gp;
  __s1 = *param_4;
  ppcStackX_c = param_4;
  if (param_3 < 2) {
LAB_00411240:
    pcVar2 = (char *)(**(code **)(local_20[0] + -0x71d4))(0,param_2);
    if (pcVar2 != (char *)0x0) goto LAB_0041125c;
  }
  else {
    iVar1 = strcmp(__s1,"2");
    if (iVar1 != 0) goto LAB_00411240;
    __s1 = param_4[1];
    iVar1 = (**(code **)(local_20[0] + -0x74ac))(param_1,param_2);
    if ((iVar1 == 0) ||
       (pcVar2 = (char *)(**(code **)(local_20[0] + -0x745c))
                                   (param_1,param_2,*(int *)(local_20[0] + -0x7fe0) + 0x1988),
       pcVar2 == (char *)0x0)) goto LAB_00411240;
LAB_0041125c:
    if (*pcVar2 != '\0') {
      iVar3 = (**(code **)(local_20[0] + -0x76e4))(pcVar2,__s1);
      iVar1 = *(int *)(local_20[0] + -0x7fe0);
      ppcStackX_c = *(char ***)(local_20[0] + -0x7fe0);
      iVar7 = *(int *)(local_20[0] + -0x7884);
      ppcStackX_8 = ppcStackX_c + -0x1120;
      if (iVar3 == 0) goto LAB_004112ac;
    }
  }
  iVar1 = *(int *)(local_20[0] + -0x7fe0);
  iVar7 = *(int *)(local_20[0] + -0x7884);
  ppcStackX_8 = (char **)(*(int *)(local_20[0] + -0x7fe0) + 0x445c);
LAB_004112ac:
  local_20[0] = (undefined *)0x0;
  iVar1 = (**(code **)(iVar7 + 0xce114))(local_20,0x400,iVar1 + -0x42c,&ppcStackX_8);
  if (0x3ff < iVar1) {
    (**(code **)(iVar7 + 0xceac8))(2,*(int *)(iVar7 + 0xcda44) + -0x626c);
  }
  puVar6 = local_20[0];
  iVar1 = 0;
  if (local_20[0] != (undefined *)0x0) {
    iVar3 = (**(code **)(iVar7 + 0xce008))(local_20[0]);
    iVar1 = 0;
    if (iVar3 < 1) {
      iVar1 = 0;
      puVar5 = puVar6;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          iVar4 = (**(code **)(iVar7 + 0xce750))(*(int *)(param_1 + 0xbc),puVar6,iVar3);
          if (iVar4 < 0) {
LAB_0040a1f4:
            iVar1 = -1;
            puVar5 = local_20[0];
            goto LAB_0040a0a8;
          }
          iVar3 = iVar3 - iVar4;
          iVar1 = iVar1 + iVar4;
          puVar6 = puVar6 + iVar4;
          puVar5 = local_20[0];
          if (iVar3 < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar4 = (**(code **)(iVar7 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),puVar6,iVar3);
          if (-1 < iVar4) {
            (**(code **)(iVar7 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        iVar4 = iVar3;
        if (0x200 < iVar3) {
          iVar4 = 0x200;
        }
        iVar4 = (**(code **)(iVar7 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),puVar6,iVar4);
        if (iVar4 < 0) goto LAB_0040a1f4;
        (**(code **)(iVar7 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        iVar3 = iVar3 - iVar4;
        iVar1 = iVar1 + iVar4;
        puVar6 = puVar6 + iVar4;
        puVar5 = local_20[0];
      } while (0 < iVar3);
    }
LAB_0040a0a8:
    (**(code **)(iVar7 + 0xcdea0))(puVar5);
  }
  return iVar1;
}



// WARNING: Switch with 1 destination removed at 0x0041140c

int getCheckConfig(int param_1,undefined4 param_2,int param_3,char **param_4)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  undefined *puVar7;
  char **ppcVar8;
  undefined *puVar9;
  char *__s1;
  int iStackX_8;
  char **ppcStackX_c;
  undefined *local_20 [2];
  
  local_20[0] = &_gp;
  __s1 = *param_4;
  ppcStackX_c = param_4;
  if (param_3 < 2) {
LAB_00411374:
    pcVar3 = (char *)(**(code **)(local_20[0] + -0x71d4))(0,param_2);
    if (pcVar3 != (char *)0x0) goto LAB_00411390;
LAB_00411458:
    iVar2 = *(int *)(local_20[0] + -0x7884);
  }
  else {
    iVar2 = strcmp(__s1,"2");
    if (iVar2 != 0) goto LAB_00411374;
    __s1 = param_4[1];
    iVar2 = (**(code **)(local_20[0] + -0x74ac))(param_1,param_2);
    if ((iVar2 == 0) ||
       (pcVar3 = (char *)(**(code **)(local_20[0] + -0x745c))
                                   (param_1,param_2,*(int *)(local_20[0] + -0x7fe0) + 0x1988),
       pcVar3 == (char *)0x0)) goto LAB_00411374;
LAB_00411390:
    if (*pcVar3 == '\0') goto LAB_00411458;
    uVar4 = (**(code **)(local_20[0] + -0x79a0))(__s1);
    ppcVar8 = (char **)(1 << (uVar4 & 0x1f));
    uVar4 = (**(code **)(local_20[0] + -0x79a0))(pcVar3);
    ppcStackX_c = (char **)((uint)ppcVar8 & uVar4);
    iVar6 = *(int *)(local_20[0] + -0x7fe0);
    iVar2 = *(int *)(local_20[0] + -0x7884);
    iStackX_8 = *(int *)(local_20[0] + -0x7fe0) + -0x4480;
    if (ppcStackX_c == ppcVar8) goto LAB_004113f8;
  }
  iVar6 = *(int *)(local_20[0] + -0x7fe0);
  iStackX_8 = *(int *)(local_20[0] + -0x7fe0) + 0x445c;
LAB_004113f8:
  local_20[0] = (undefined *)0x0;
  iVar6 = (**(code **)(iVar2 + 0xce114))(local_20,0x400,iVar6 + -0x42c,&iStackX_8);
  if (0x3ff < iVar6) {
    (**(code **)(iVar2 + 0xceac8))(2,*(int *)(iVar2 + 0xcda44) + -0x626c);
  }
  puVar9 = local_20[0];
  iVar6 = 0;
  if (local_20[0] != (undefined *)0x0) {
    iVar1 = (**(code **)(iVar2 + 0xce008))(local_20[0]);
    iVar6 = 0;
    if (iVar1 < 1) {
      iVar6 = 0;
      puVar7 = puVar9;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          iVar5 = (**(code **)(iVar2 + 0xce750))(*(int *)(param_1 + 0xbc),puVar9,iVar1);
          if (iVar5 < 0) {
LAB_0040a1f4:
            iVar6 = -1;
            puVar7 = local_20[0];
            goto LAB_0040a0a8;
          }
          iVar1 = iVar1 - iVar5;
          iVar6 = iVar6 + iVar5;
          puVar9 = puVar9 + iVar5;
          puVar7 = local_20[0];
          if (iVar1 < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar5 = (**(code **)(iVar2 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),puVar9,iVar1);
          if (-1 < iVar5) {
            (**(code **)(iVar2 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        iVar5 = iVar1;
        if (0x200 < iVar1) {
          iVar5 = 0x200;
        }
        iVar5 = (**(code **)(iVar2 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),puVar9,iVar5);
        if (iVar5 < 0) goto LAB_0040a1f4;
        (**(code **)(iVar2 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        iVar1 = iVar1 - iVar5;
        iVar6 = iVar6 + iVar5;
        puVar9 = puVar9 + iVar5;
        puVar7 = local_20[0];
      } while (0 < iVar1);
    }
LAB_0040a0a8:
    (**(code **)(iVar2 + 0xcdea0))(puVar7);
  }
  return iVar6;
}



int getSelectString(undefined4 param_1,undefined4 param_2,char **param_3,int param_4,char **param_5)

{
  char cVar1;
  int iVar2;
  char *__s2;
  int iVar3;
  int iVar4;
  int iVar5;
  char **ppcVar6;
  char *pcVar7;
  int iVar8;
  int iVar9;
  
  iVar9 = 0;
  iVar8 = 0;
  if (((param_4 < 1) || (iVar2 = strcmp(*param_5,"2"), iVar2 != 0)) ||
     (iVar2 = websTestVar(param_1,param_2), iVar2 == 0)) {
    __s2 = (char *)nvram_bufget(0,param_2);
  }
  else {
    __s2 = (char *)websGetVar(param_1,param_2,&DAT_0049445c);
  }
  if (*param_3 != (char *)0x0) {
    iVar2 = 0;
    cVar1 = **param_3;
    ppcVar6 = param_3;
    while (cVar1 != '\0') {
      iVar3 = strcmp(*ppcVar6,__s2);
      pcVar7 = WebOptionCheck;
      if (iVar3 != 0) {
        pcVar7 = WebOptionStart;
      }
      iVar9 = iVar9 + 1;
      iVar3 = websWriteFmt(param_1,"%s",pcVar7);
      iVar4 = websWriteFmt(param_1,"%s",*(undefined4 *)(iVar2 + (int)param_3));
      iVar2 = iVar9 * 4;
      iVar5 = websWriteFmt(param_1,"%s",WebOptionEnd);
      ppcVar6 = param_3 + iVar9;
      iVar8 = iVar8 + iVar3 + iVar4 + iVar5;
      if (*ppcVar6 == (char *)0x0) {
        return iVar8;
      }
      cVar1 = **ppcVar6;
    }
  }
  return iVar8;
}



int getSelectStringOfMatchValue
              (undefined4 param_1,undefined4 param_2,int param_3,char **param_4,int param_5,
              char **param_6)

{
  char cVar1;
  int iVar2;
  char *__s2;
  int iVar3;
  int iVar4;
  int iVar5;
  char **ppcVar6;
  char *pcVar7;
  int iVar8;
  int iVar9;
  
  iVar9 = 0;
  iVar8 = 0;
  if (((param_5 < 1) || (iVar2 = strcmp(*param_6,"2"), iVar2 != 0)) ||
     (iVar2 = websTestVar(param_1,param_2), iVar2 == 0)) {
    __s2 = (char *)nvram_bufget(0,param_2);
  }
  else {
    __s2 = (char *)websGetVar(param_1,param_2,&DAT_0049445c);
  }
  if (*param_4 != (char *)0x0) {
    iVar2 = 0;
    cVar1 = **param_4;
    ppcVar6 = param_4;
    while (cVar1 != '\0') {
      iVar3 = strcmp(*ppcVar6,__s2);
      pcVar7 = WebOptionCheck;
      if (iVar3 != 0) {
        pcVar7 = WebOptionStart;
      }
      iVar9 = iVar9 + 1;
      iVar3 = websWriteFmt(param_1,"%s",pcVar7);
      iVar4 = websWriteFmt(param_1,"%s",*(undefined4 *)(iVar2 + param_3));
      iVar2 = iVar9 * 4;
      iVar5 = websWriteFmt(param_1,"%s",WebOptionEnd);
      ppcVar6 = param_4 + iVar9;
      iVar8 = iVar8 + iVar3 + iVar4 + iVar5;
      if (*ppcVar6 == (char *)0x0) {
        return iVar8;
      }
      cVar1 = **ppcVar6;
    }
  }
  return iVar8;
}



// WARNING: Switch with 1 destination removed at 0x004118dc

int getStringOfValueSelect(int param_1,undefined4 param_2,char **param_3,int param_4,char **param_5)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  char **ppcVar4;
  int iVar5;
  int iVar6;
  undefined *puVar7;
  int iVar8;
  undefined *puVar9;
  undefined4 uStackX_8;
  int iStackX_c;
  undefined *local_20 [2];
  
  local_20[0] = &_gp;
  iVar8 = 0;
  if (((param_4 < 1) || (iVar2 = strcmp(*param_5,"2"), iVar2 != 0)) ||
     (iVar2 = (**(code **)(local_20[0] + -0x74ac))(param_1,param_2), iVar2 == 0)) {
    uVar3 = (**(code **)(local_20[0] + -0x71d4))(0,param_2);
  }
  else {
    uVar3 = (**(code **)(local_20[0] + -0x745c))
                      (param_1,param_2,*(int *)(local_20[0] + -0x7fe0) + 0x445c);
  }
  iVar2 = (**(code **)(local_20[0] + -0x79a0))(uVar3);
  iVar5 = 0;
  if ((*param_3 != (char *)0x0) && (ppcVar4 = param_3, **param_3 != '\0')) {
    while (ppcVar4 = ppcVar4 + 1, iVar8 != iVar2) {
      iVar8 = iVar8 + 1;
      iVar5 = iVar8 * 4;
      if ((*ppcVar4 == (char *)0x0) || (param_4 = (int)**ppcVar4, param_4 == 0)) goto LAB_004118b0;
    }
    iVar5 = iVar8 << 2;
  }
LAB_004118b0:
  piVar1 = (int *)(local_20[0] + -0x7fe0);
  uStackX_8 = *(undefined4 *)(iVar5 + (int)param_3);
  iVar2 = *(int *)(local_20[0] + -0x7884);
  local_20[0] = (undefined *)0x0;
  iStackX_c = param_4;
  iVar8 = (**(code **)(iVar2 + 0xce114))(local_20,0x400,*piVar1 + -0x42c,&uStackX_8);
  if (0x3ff < iVar8) {
    (**(code **)(iVar2 + 0xceac8))(2,*(int *)(iVar2 + 0xcda44) + -0x626c);
  }
  puVar9 = local_20[0];
  iVar8 = 0;
  if (local_20[0] != (undefined *)0x0) {
    iVar5 = (**(code **)(iVar2 + 0xce008))(local_20[0]);
    iVar8 = 0;
    if (iVar5 < 1) {
      iVar8 = 0;
      puVar7 = puVar9;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          iVar6 = (**(code **)(iVar2 + 0xce750))(*(int *)(param_1 + 0xbc),puVar9,iVar5);
          if (iVar6 < 0) {
LAB_0040a1f4:
            iVar8 = -1;
            puVar7 = local_20[0];
            goto LAB_0040a0a8;
          }
          iVar5 = iVar5 - iVar6;
          iVar8 = iVar8 + iVar6;
          puVar9 = puVar9 + iVar6;
          puVar7 = local_20[0];
          if (iVar5 < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar6 = (**(code **)(iVar2 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),puVar9,iVar5);
          if (-1 < iVar6) {
            (**(code **)(iVar2 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        iVar6 = iVar5;
        if (0x200 < iVar5) {
          iVar6 = 0x200;
        }
        iVar6 = (**(code **)(iVar2 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),puVar9,iVar6);
        if (iVar6 < 0) goto LAB_0040a1f4;
        (**(code **)(iVar2 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        iVar5 = iVar5 - iVar6;
        iVar8 = iVar8 + iVar6;
        puVar9 = puVar9 + iVar6;
        puVar7 = local_20[0];
      } while (0 < iVar5);
    }
LAB_0040a0a8:
    (**(code **)(iVar2 + 0xcdea0))(puVar7);
  }
  return iVar8;
}



int getLogoSelectString(undefined4 param_1,undefined4 param_2,undefined4 *param_3,int param_4,
                       char **param_5)

{
  int iVar1;
  char *__s2;
  int iVar2;
  int iVar3;
  char *__s1;
  int iVar4;
  
  iVar4 = 0;
  if (((param_4 < 1) || (iVar1 = strcmp(*param_5,"2"), iVar1 != 0)) ||
     (iVar1 = websTestVar(param_1,param_2), iVar1 == 0)) {
    __s2 = (char *)nvram_bufget(0,param_2);
  }
  else {
    __s2 = (char *)websGetVar(param_1,param_2,&DAT_0049445c);
  }
  __s1 = (char *)param_3[1];
  do {
    if (__s1 == (char *)0x0) {
      return iVar4;
    }
    while (iVar1 = strcmp(__s1,__s2), iVar1 != 0) {
      iVar1 = websWriteFmt(param_1,WebOptionValueStart,*param_3);
      iVar2 = websWriteFmt(param_1,"%s",param_3[1]);
      iVar3 = websWriteFmt(param_1,"%s",WebOptionEnd);
      __s1 = (char *)param_3[3];
      iVar4 = iVar4 + iVar1 + iVar2 + iVar3;
      param_3 = param_3 + 2;
      if (__s1 == (char *)0x0) {
        return iVar4;
      }
    }
    iVar1 = websWriteFmt(param_1,WebOptionValueCheck,*param_3);
    iVar2 = websWriteFmt(param_1,"%s",param_3[1]);
    iVar3 = websWriteFmt(param_1,"%s",WebOptionEnd);
    __s1 = (char *)param_3[3];
    iVar4 = iVar4 + iVar1 + iVar2 + iVar3;
    param_3 = param_3 + 2;
  } while( true );
}



int getStringOfMatchValue
              (int param_1,undefined4 param_2,int param_3,char **param_4,int param_5,char **param_6)

{
  size_t __n;
  ssize_t sVar1;
  int iVar2;
  char *pcVar3;
  size_t sVar4;
  int iVar5;
  char *__buf;
  undefined4 uStackX_8;
  undefined4 *puStackX_c;
  char *pcVar6;
  
  iVar5 = 0;
  if (((param_5 < 1) || (iVar2 = strcmp(*param_6,"2"), iVar2 != 0)) ||
     (iVar2 = websTestVar(param_1,param_2), iVar2 == 0)) {
    pcVar3 = (char *)nvram_bufget(0,param_2);
  }
  else {
    pcVar3 = (char *)websGetVar(param_1,param_2,&DAT_0049445c);
  }
  iVar2 = 0;
  if ((*param_4 != (char *)0x0) && (**param_4 != '\0')) {
    while( true ) {
      iVar2 = strcmp(*param_4,pcVar3);
      param_4 = param_4 + 1;
      if (iVar2 == 0) break;
      iVar5 = iVar5 + 1;
      iVar2 = iVar5 * 4;
      if ((*param_4 == (char *)0x0) || (**param_4 == '\0')) goto LAB_00411be0;
    }
    iVar2 = iVar5 << 2;
  }
LAB_00411be0:
  puStackX_c = (undefined4 *)(iVar2 + param_3);
  uStackX_8 = *puStackX_c;
  pcVar3 = (char *)0x0;
  iVar5 = vallocFmtString(&stack0xffffffe0,0x400,"%s",&uStackX_8);
  if (0x3ff < iVar5) {
    trace(2,"websConnWrite lost data, buffer overflow\n");
  }
  iVar5 = 0;
  if (pcVar3 != (char *)0x0) {
    pcVar6 = pcVar3;
    __n = strlen(pcVar3);
    iVar5 = 0;
    __buf = pcVar3;
    if ((int)__n < 1) {
      iVar5 = 0;
    }
    else {
      do {
        while ((pcVar3 = pcVar6, (*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 &&
               (-1 < *(int *)(param_1 + 0xbc)))) {
          sVar1 = write(*(int *)(param_1 + 0xbc),__buf,__n);
          if (sVar1 < 0) {
LAB_0040a1f4:
            iVar5 = -1;
            goto LAB_0040a0a8;
          }
          __n = __n - sVar1;
          iVar5 = iVar5 + sVar1;
          __buf = __buf + sVar1;
          pcVar6 = pcVar3;
          if ((int)__n < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar2 = websSocketWrite(*(undefined4 *)(param_1 + 0xd4),__buf,__n);
          if (-1 < iVar2) {
            websSocketFlush(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        sVar4 = __n;
        if (0x200 < (int)__n) {
          sVar4 = 0x200;
        }
        iVar2 = websSSLWrite(*(undefined4 *)(param_1 + 0x110),__buf,sVar4);
        if (iVar2 < 0) goto LAB_0040a1f4;
        websSSLFlush(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        __n = __n - iVar2;
        iVar5 = iVar5 + iVar2;
        __buf = __buf + iVar2;
        pcVar6 = pcVar3;
      } while (0 < (int)__n);
    }
LAB_0040a0a8:
    free(pcVar3);
  }
  return iVar5;
}



void getCurrentTimeString(undefined4 param_1,char *param_2)

{
  tm *__tp;
  char acStack_58 [64];
  time_t atStack_18 [2];
  
  memset(acStack_58,0,0x40);
  time(atStack_18);
  __tp = localtime(atStack_18);
  if (__tp != (tm *)0x0) {
    strftime(acStack_58,0x40,param_2,__tp);
  }
  websWriteFmt(param_1,"%s",acStack_58);
  return;
}



// WARNING: Switch with 1 destination removed at 0x00411da0
// WARNING: Switch with 1 destination removed at 0x00411dbc

int getStringVar(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  char *pcStackX_8;
  undefined4 uStackX_c;
  int aiStack_20 [3];
  undefined *puVar7;
  
  puVar7 = &_gp;
  pcVar3 = (char *)websGetVar();
  iVar6 = *(int *)(puVar7 + -0x7884);
  iVar4 = *(int *)(puVar7 + -0x7fe0);
  pcStackX_8 = (char *)(*(int *)(puVar7 + -0x7fe0) + 0x445c);
  if ((pcVar3 != (char *)0x0) && (*pcVar3 != '\0')) {
    iVar4 = *(int *)(puVar7 + -0x7fe0);
    pcStackX_8 = pcVar3;
  }
  aiStack_20[0] = 0;
  uStackX_c = param_4;
  iVar4 = (**(code **)(iVar6 + 0xce114))(aiStack_20,0x400,iVar4 + -0x42c,&pcStackX_8);
  if (0x3ff < iVar4) {
    (**(code **)(iVar6 + 0xceac8))(2,*(int *)(iVar6 + 0xcda44) + -0x626c);
  }
  iVar4 = aiStack_20[0];
  iVar1 = 0;
  if (aiStack_20[0] != 0) {
    iVar2 = (**(code **)(iVar6 + 0xce008))(aiStack_20[0]);
    iVar1 = 0;
    if (iVar2 < 1) {
      iVar1 = 0;
      iVar5 = iVar4;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) == 0 || (*(int *)(param_1 + 0xbc) < 0))) {
          if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
            iVar5 = (**(code **)(iVar6 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),iVar4,iVar2);
            if (iVar5 < 0) goto LAB_0040a1f4;
            (**(code **)(iVar6 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
          }
          else {
            iVar5 = iVar2;
            if (0x200 < iVar2) {
              iVar5 = 0x200;
            }
            iVar5 = (**(code **)(iVar6 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),iVar4,iVar5);
            if (iVar5 < 0) {
LAB_0040a1f4:
              iVar1 = -1;
              iVar5 = aiStack_20[0];
              goto LAB_0040a0a8;
            }
            (**(code **)(iVar6 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
          }
          iVar2 = iVar2 - iVar5;
          iVar1 = iVar1 + iVar5;
          iVar4 = iVar4 + iVar5;
          iVar5 = aiStack_20[0];
          if (iVar2 < 1) goto LAB_0040a0a8;
        }
        iVar5 = (**(code **)(iVar6 + 0xce750))(*(int *)(param_1 + 0xbc),iVar4,iVar2);
        if (iVar5 < 0) goto LAB_0040a1f4;
        iVar2 = iVar2 - iVar5;
        iVar1 = iVar1 + iVar5;
        iVar4 = iVar4 + iVar5;
        iVar5 = aiStack_20[0];
      } while (0 < iVar2);
    }
LAB_0040a0a8:
    (**(code **)(iVar6 + 0xcdea0))(iVar5);
  }
  return iVar1;
}



undefined4 getHexStringVar(undefined4 param_1)

{
  byte bVar1;
  byte *__s;
  undefined4 uVar2;
  size_t sVar3;
  char *__s_00;
  size_t sVar4;
  uint uVar5;
  uint __n;
  char acStack_30 [16];
  
  __s = (byte *)websGetVar();
  if ((__s != (byte *)0x0) && (*__s != 0)) {
    sVar3 = strlen((char *)__s);
    __n = sVar3 * 2 + 2;
    __s_00 = (char *)mmalloc(__n);
    if (__s_00 != (char *)0x0) {
      memset(__s_00,0,__n);
      bVar1 = *__s;
      while (uVar5 = (uint)bVar1, uVar5 != 0) {
        while( true ) {
          snprintf(acStack_30,0x10,"%X",uVar5);
          __s = __s + 1;
          sVar3 = strlen(__s_00);
          sVar4 = strlen(acStack_30);
          if (__n <= sVar3 + sVar4) break;
          strcat(__s_00,acStack_30);
          uVar5 = (uint)*__s;
          if (uVar5 == 0) goto LAB_00411f58;
        }
        bVar1 = *__s;
      }
LAB_00411f58:
      if (__s_00 != (char *)0x0) {
        uVar2 = websWriteFmt(param_1,"%s",__s_00);
        free(__s_00);
        return uVar2;
      }
    }
  }
  uVar2 = websWriteFmt(param_1,"%s",&DAT_0049445c);
  return uVar2;
}



// WARNING: Switch with 1 destination removed at 0x00412030

int getPrintableStringVar(int param_1,undefined4 param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  char *pcVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  code *pcVar6;
  int iStackX_8;
  int iStackX_c;
  int aiStack_20 [2];
  undefined *local_18;
  
  local_18 = &_gp;
  pcVar2 = (char *)websGetVar();
  pcVar6 = *(code **)(local_18 + -0x7884);
  iVar4 = *(int *)(local_18 + -0x7fe0);
  iStackX_8 = *(int *)(local_18 + -0x7fe0);
  if ((pcVar2 != (char *)0x0) && (*pcVar2 != '\0')) {
    iVar4 = (**(code **)(local_18 + -0x7898))(pcVar2);
    pcVar6 = *(code **)(local_18 + -0x7884);
    if (iVar4 != 0) {
      iVar3 = (*pcVar6)(param_1,*(int *)(local_18 + -0x7fe0) + -0x42c,iVar4);
      (**(code **)(local_18 + -0x7b84))(iVar4);
      return iVar3;
    }
    iVar4 = *(int *)(local_18 + -0x7fe0);
    param_4 = *(int *)(local_18 + -0x7fe0);
    iStackX_8 = param_4;
  }
  iStackX_8 = iStackX_8 + 0x445c;
  aiStack_20[0] = 0;
  iStackX_c = param_4;
  iVar4 = (**(code **)(pcVar6 + 0xce114))(aiStack_20,0x400,iVar4 + -0x42c,&iStackX_8);
  if (0x3ff < iVar4) {
    (**(code **)(pcVar6 + 0xceac8))(2,*(int *)(pcVar6 + 0xcda44) + -0x626c);
  }
  iVar4 = aiStack_20[0];
  iVar3 = 0;
  if (aiStack_20[0] != 0) {
    iVar1 = (**(code **)(pcVar6 + 0xce008))(aiStack_20[0]);
    iVar3 = 0;
    if (iVar1 < 1) {
      iVar3 = 0;
      iVar5 = iVar4;
    }
    else {
      do {
        while (((*(uint *)(param_1 + 0xe4) >> 10 & 1) != 0 && (-1 < *(int *)(param_1 + 0xbc)))) {
          iVar5 = (**(code **)(pcVar6 + 0xce750))(*(int *)(param_1 + 0xbc),iVar4,iVar1);
          if (iVar5 < 0) {
LAB_0040a1f4:
            iVar3 = -1;
            iVar5 = aiStack_20[0];
            goto LAB_0040a0a8;
          }
          iVar1 = iVar1 - iVar5;
          iVar3 = iVar3 + iVar5;
          iVar4 = iVar4 + iVar5;
          iVar5 = aiStack_20[0];
          if (iVar1 < 1) goto LAB_0040a0a8;
        }
        if ((*(uint *)(param_1 + 0xe4) >> 7 & 1) == 0) {
          iVar5 = (**(code **)(pcVar6 + 0xce5f8))(*(undefined4 *)(param_1 + 0xd4),iVar4,iVar1);
          if (-1 < iVar5) {
            (**(code **)(pcVar6 + 0xce3b8))(*(undefined4 *)(param_1 + 0xd4));
            goto LAB_0040a184;
          }
          goto LAB_0040a1f4;
        }
        iVar5 = iVar1;
        if (0x200 < iVar1) {
          iVar5 = 0x200;
        }
        iVar5 = (**(code **)(pcVar6 + 0xce9a0))(*(undefined4 *)(param_1 + 0x110),iVar4,iVar5);
        if (iVar5 < 0) goto LAB_0040a1f4;
        (**(code **)(pcVar6 + 0xce4a8))(*(undefined4 *)(param_1 + 0x110));
LAB_0040a184:
        iVar1 = iVar1 - iVar5;
        iVar3 = iVar3 + iVar5;
        iVar4 = iVar4 + iVar5;
        iVar5 = aiStack_20[0];
      } while (0 < iVar1);
    }
LAB_0040a0a8:
    (**(code **)(pcVar6 + 0xcdea0))(iVar5);
  }
  return iVar3;
}



// WARNING: Removing unreachable block (ram,0x00413868)
// WARNING: Removing unreachable block (ram,0x00413898)
// WARNING: Removing unreachable block (ram,0x00413874)
// WARNING: Removing unreachable block (ram,0x00413984)
// WARNING: Removing unreachable block (ram,0x0041398c)
// WARNING: Removing unreachable block (ram,0x004139d4)
// WARNING: Removing unreachable block (ram,0x0041399c)
// WARNING: Removing unreachable block (ram,0x00413890)
// WARNING: Removing unreachable block (ram,0x004138a0)
// WARNING: Removing unreachable block (ram,0x004138bc)

void copyStringHexVar(int param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  char cVar1;
  bool bVar2;
  char *__s;
  size_t sVar3;
  byte *__s_00;
  void *__ptr;
  int iVar4;
  undefined4 uVar5;
  uint uVar6;
  int iVar7;
  byte *pbVar8;
  uint uVar9;
  undefined4 *puVar10;
  
  __s = (char *)websGetVar(param_1,param_3,param_4);
  websDeleteVar(param_1,param_2);
  if ((__s != (char *)0x0) && (*__s != '\0')) {
    sVar3 = strlen(__s);
    __s_00 = (byte *)mmalloc(sVar3);
    if (__s_00 != (byte *)0x0) {
      memset(__s_00,0,sVar3);
      cVar1 = *__s;
      bVar2 = false;
      uVar9 = 0;
      pbVar8 = __s_00;
      while (iVar4 = (int)cVar1, iVar4 != 0) {
        iVar7 = uVar9 << 4;
        uVar9 = 0;
        uVar6 = iVar4 - 0x37;
        if (((5 < iVar4 - 0x41U) && (uVar6 = iVar4 - 0x57, 5 < iVar4 - 0x61U)) &&
           (uVar6 = iVar4 - 0x30, 9 < (uVar6 & 0xff))) break;
        if (bVar2) {
          *pbVar8 = (byte)iVar7 | (byte)uVar6;
          cVar1 = __s[1];
          pbVar8 = pbVar8 + 1;
        }
        else {
          cVar1 = __s[1];
          uVar9 = uVar6;
        }
        bVar2 = !bVar2;
        __s = __s + 1;
      }
      if (__s_00 != (byte *)0x0) {
        websSetVar(param_1,param_2,__s_00);
        free(__s_00);
        return;
      }
    }
  }
  trace(2,"websSetVar=(%s,%s)\n",param_2,&DAT_0049445c);
  if (param_2 == (char *)0x0) {
    trace(0x10,"websSetVar with null var\n");
    return;
  }
  sVar3 = strlen("");
  if (0x800 < sVar3) {
    trace(0x10,"websSetVar out of length(%s)\n");
    return;
  }
  __ptr = (void *)strdupWithoutNull(&DAT_0049445c);
  puVar10 = *(undefined4 **)(param_1 + 0x84);
  do {
    if (puVar10 == (undefined4 *)0x0) {
LAB_004137e4:
      puVar10 = (undefined4 *)mmalloc(0xc);
      if (puVar10 != (undefined4 *)0x0) {
        uVar5 = strdupWithoutNull(param_2);
        puVar10[1] = uVar5;
        uVar5 = strdupWithoutNull(__ptr);
        puVar10[2] = uVar5;
        *puVar10 = *(undefined4 *)(param_1 + 0x84);
        *(undefined4 **)(param_1 + 0x84) = puVar10;
      }
LAB_00413930:
      if (__ptr != (void *)0x0) {
        free(__ptr);
      }
      return;
    }
    iVar4 = strcasecmp(param_2,(char *)puVar10[1]);
    if (iVar4 == 0) {
      if (puVar10 != (undefined4 *)0x0) {
        if ((void *)puVar10[2] != (void *)0x0) {
          free((void *)puVar10[2]);
          puVar10[2] = 0;
        }
        uVar5 = strdupWithoutNull(__ptr);
        puVar10[2] = uVar5;
        goto LAB_00413930;
      }
      goto LAB_004137e4;
    }
    puVar10 = (undefined4 *)*puVar10;
  } while( true );
}



undefined4 websConfigGetFromVar(undefined4 param_1,undefined4 param_2,char *param_3,char **param_4)

{
  char *pcVar1;
  
  pcVar1 = (char *)websGetVar(param_1,param_2,WebNotFound);
  if (pcVar1 != WebNotFound) {
    *param_4 = pcVar1;
    return 1;
  }
  *param_4 = param_3;
  return 0;
}



char * websGetSelectString(char **param_1,int param_2)

{
  char cVar1;
  int iVar2;
  char **ppcVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar2 = 0;
  if (*param_1 != (char *)0x0) {
    cVar1 = **param_1;
    ppcVar3 = param_1;
    while (cVar1 != '\0') {
      ppcVar3 = ppcVar3 + 1;
      if (iVar4 == param_2) {
        return param_1[iVar4];
      }
      iVar4 = iVar4 + 1;
      iVar2 = iVar4 * 4;
      if (*ppcVar3 == (char *)0x0) break;
      cVar1 = **ppcVar3;
    }
  }
  return *(char **)(iVar2 + (int)param_1);
}



int getSysInfoShort(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int __fd;
  short local_18 [4];
  
  __fd = open("/dev/gpio",0,param_3,param_4,&_gp);
  local_18[0] = 0;
  if (-1 < __fd) {
    ioctl(__fd,param_1 << 8 | 0x10080,local_18);
    close(__fd);
  }
  return (int)local_18[0];
}



int getChannelSelectString
              (undefined4 param_1,undefined4 param_2,char **param_3,int param_4,char **param_5)

{
  ushort uVar1;
  int iVar2;
  char *__s2;
  int iVar3;
  int iVar4;
  int iVar5;
  char *pcVar6;
  ushort uVar7;
  char **ppcVar8;
  uint uVar9;
  int iVar10;
  ushort local_30 [4];
  
  iVar2 = open("/dev/gpio",0);
  local_30[0] = 0;
  uVar9 = 0;
  iVar10 = 0;
  if (-1 < iVar2) {
    ioctl(iVar2,0x14480,local_30);
    close(iVar2);
  }
  uVar1 = local_30[0];
  if (((param_4 < 1) || (iVar2 = strcmp(*param_5,"2"), iVar2 != 0)) ||
     (iVar2 = websTestVar(param_1,param_2), iVar2 == 0)) {
    __s2 = (char *)nvram_bufget(0,param_2);
  }
  else {
    __s2 = (char *)websGetVar(param_1,param_2,&DAT_0049445c);
  }
  if ((*param_3 != (char *)0x0) && (**param_3 != '\0')) {
    iVar2 = 0;
    ppcVar8 = param_3;
    do {
      uVar7 = (ushort)(1 << (uVar9 & 0x1f));
      if ((uVar1 & uVar7) == uVar7) {
        iVar3 = strcmp(*(char **)(iVar2 + (int)param_3),__s2);
        pcVar6 = WebOptionCheck;
        if (iVar3 != 0) {
          pcVar6 = WebOptionStart;
        }
        iVar3 = websWriteFmt(param_1,"%s",pcVar6);
        iVar4 = websWriteFmt(param_1,"%s",*ppcVar8);
        iVar5 = websWriteFmt(param_1,"%s",WebOptionEnd);
        iVar10 = iVar10 + iVar3 + iVar4 + iVar5;
        pcVar6 = ppcVar8[1];
      }
      else {
        pcVar6 = ppcVar8[1];
      }
      if (pcVar6 == (char *)0x0) {
        return iVar10;
      }
      uVar9 = uVar9 + 1;
      iVar2 = iVar2 + 4;
      ppcVar8 = ppcVar8 + 1;
    } while (*pcVar6 != '\0');
  }
  return iVar10;
}



void * getSysInfoBuffer(int param_1,void *param_2,size_t param_3,undefined4 param_4)

{
  int __fd;
  
  __fd = open("/dev/gpio",0,param_3,param_4,&_gp);
  memset(param_2,0,param_3);
  if (-1 < __fd) {
    ioctl(__fd,param_1 << 8 | param_3 << 0xf | 0x80,param_2);
    close(__fd);
  }
  return param_2;
}



// WARNING: Type propagation algorithm not settling

void AllocateMACAddress(int param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  char cVar1;
  uint uVar2;
  ulong __request;
  int iVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined local_40 [4];
  undefined2 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  
  local_40 = (undefined  [4])0x0;
  local_3c = 0;
  if (param_1 == 0) {
    iVar3 = open("/dev/gpio",0,param_3,param_4,&_gp);
    memset(local_40,0,6);
    if (-1 < iVar3) {
      __request = 0x31980;
LAB_00412918:
      ioctl(iVar3,__request,local_40);
      close(iVar3);
      local_38 = 0;
      goto LAB_004127a0;
    }
  }
  else if (param_1 == 1) {
    iVar3 = open("/dev/gpio",0,param_3,param_4,&_gp);
    memset(local_40,0,6);
    if (-1 < iVar3) {
      __request = 0x32580;
      goto LAB_00412918;
    }
  }
  local_38 = 0;
LAB_004127a0:
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  iVar3 = 0;
  puVar4 = (undefined4 *)local_40;
  puVar5 = &local_38;
  do {
    uVar2 = (uint)*(byte *)puVar4;
    if (0xf < uVar2) {
      cVar1 = *(char *)puVar5;
      do {
        uVar2 = uVar2 - 0x10;
        cVar1 = cVar1 + '\x01';
      } while (0xf < uVar2);
      *(char *)puVar5 = cVar1;
    }
    cVar1 = *(char *)puVar5 + '0';
    if (cVar1 < ':') {
      *(char *)puVar5 = cVar1;
    }
    else {
      *(char *)puVar5 = *(char *)puVar5 + '7';
    }
    if ((int)((uVar2 + 0x30) * 0x1000000) >> 0x18 < 0x3a) {
      *(char *)((int)puVar5 + 1) = (char)(uVar2 + 0x30);
    }
    else {
      *(char *)((int)puVar5 + 1) = (char)uVar2 + '7';
    }
    puVar6 = (undefined4 *)((int)puVar5 + 2);
    if (iVar3 < 5) {
      if (param_2 == 1) {
        puVar6 = (undefined4 *)((int)puVar5 + 3);
        *(char *)((int)puVar5 + 2) = ' ';
      }
      else if (param_2 == 2) {
        puVar6 = (undefined4 *)((int)puVar5 + 3);
        *(char *)((int)puVar5 + 2) = ':';
      }
    }
    iVar3 = iVar3 + 1;
    puVar4 = (undefined4 *)((int)local_40 + iVar3);
    puVar5 = puVar6;
  } while (iVar3 < 6);
  *(char *)puVar6 = '\0';
  strdupWithoutNull(&local_38);
  return;
}



undefined4 getSysInfoLong(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int __fd;
  undefined4 local_18 [2];
  
  __fd = open("/dev/gpio",0,param_3,param_4,&_gp);
  local_18[0] = 0;
  if (-1 < __fd) {
    ioctl(__fd,param_1 << 8 | 0x20080,local_18);
    close(__fd);
  }
  return local_18[0];
}



void setSysInfoNone(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int __fd;
  
  __fd = open("/dev/gpio",0,param_3,param_4,&_gp);
  if (-1 < __fd) {
    ioctl(__fd,param_1 << 8 | 0x81,0);
                    // WARNING: Treating indirect jump as call
    close(__fd);
    return;
  }
  return;
}



void setSysInfoBuffer(int param_1,undefined4 param_2,int param_3,undefined4 param_4)

{
  int __fd;
  
  __fd = open("/dev/gpio",0,param_3,param_4,&_gp);
  if (-1 < __fd) {
    ioctl(__fd,param_1 << 8 | param_3 << 0xf | 0x81,param_2);
                    // WARNING: Treating indirect jump as call
    close(__fd);
    return;
  }
  return;
}



void setSysInfoShort(int param_1,undefined2 param_2,undefined4 param_3,undefined4 param_4)

{
  int __fd;
  undefined2 local_18 [4];
  
  __fd = open("/dev/gpio",0,param_3,param_4,&_gp);
  if (-1 < __fd) {
    local_18[0] = param_2;
    ioctl(__fd,param_1 << 8 | 0x10081,local_18);
    close(__fd);
  }
  return;
}



void setSysInfoLong(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int __fd;
  undefined4 local_18 [2];
  
  __fd = open("/dev/gpio",0,param_3,param_4,&_gp);
  if (-1 < __fd) {
    local_18[0] = param_2;
    ioctl(__fd,param_1 << 8 | 0x20081,local_18);
    close(__fd);
  }
  return;
}



void websgetSysInfoString(undefined4 param_1,int param_2)

{
  int __fd;
  undefined auStack_118 [256];
  
  __fd = open("/dev/gpio",0);
  memset(auStack_118,0,0x100);
  if (-1 < __fd) {
    ioctl(__fd,param_2 << 8 | 0x800080,auStack_118);
    close(__fd);
  }
  websWriteFmt(param_1,"%s",auStack_118);
  return;
}



undefined4 websgetSysInfoPrintableString(undefined4 param_1,int param_2)

{
  int __fd;
  void *__ptr;
  undefined4 uVar1;
  undefined auStack_118 [256];
  
  __fd = open("/dev/gpio",0);
  memset(auStack_118,0,0x100);
  if (-1 < __fd) {
    ioctl(__fd,param_2 << 8 | 0x800080,auStack_118);
    close(__fd);
  }
  __ptr = (void *)AllocPrintableString(auStack_118);
  if (__ptr != (void *)0x0) {
    uVar1 = websWriteFmt(param_1,"%s",__ptr);
    free(__ptr);
    return uVar1;
  }
  uVar1 = websWriteFmt(param_1,"%s",auStack_118);
  return uVar1;
}



void websgetSysInfoLong(undefined4 param_1,int param_2)

{
  int __fd;
  undefined4 local_18 [2];
  
  __fd = open("/dev/gpio",0);
  local_18[0] = 0;
  if (-1 < __fd) {
    ioctl(__fd,param_2 << 8 | 0x20080,local_18);
    close(__fd);
  }
  websWriteFmt(param_1,&DAT_0048bb04,local_18[0]);
  return;
}



void websgetSysInfoShort(undefined4 param_1,int param_2)

{
  int __fd;
  short local_18 [4];
  
  __fd = open("/dev/gpio",0);
  local_18[0] = 0;
  if (-1 < __fd) {
    ioctl(__fd,param_2 << 8 | 0x10080,local_18);
    close(__fd);
  }
  websWriteFmt(param_1,&DAT_0048bb04,(int)local_18[0]);
  return;
}



void websgetSysInfoNetAddress(undefined4 param_1,int param_2)

{
  int __fd;
  char *pcVar1;
  in_addr local_18 [2];
  
  __fd = open("/dev/gpio",0);
  local_18[0].s_addr = 0;
  if (-1 < __fd) {
    ioctl(__fd,param_2 << 8 | 0x20080,local_18);
    close(__fd);
  }
  pcVar1 = inet_ntoa(local_18[0]);
  websWriteFmt(param_1,"%s",pcVar1);
  return;
}



void set_reboot_time(int param_1,int param_2)

{
  int __fd;
  timeval local_18;
  timezone local_10;
  
  local_18.tv_sec = 0;
  local_18.tv_usec = 0;
  local_10.tz_minuteswest = 0;
  local_10.tz_dsttime = 0;
  if (param_2 != 0) {
    gettimeofday(&local_18,&local_10);
    local_18.tv_sec = local_18.tv_sec + param_1;
  }
  __fd = open("/dev/gpio",0);
  if (-1 < __fd) {
    ioctl(__fd,0x44281,&local_18);
    close(__fd);
  }
  return;
}



undefined4 switch_language(int param_1,uint param_2)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  uint uVar4;
  uint local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  char *local_28 [2];
  
  local_28[0] = (char *)0x0;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  iVar2 = open("/dev/gpio",0);
  memset(&local_38,0,1);
  if (-1 < iVar2) {
    ioctl(iVar2,0xcf80,&local_38);
    close(iVar2);
  }
  uVar4 = (uint)(char)local_38;
  bVar1 = param_2 < 10;
  if (param_1 == 0) {
    bVar1 = uVar4 < 10;
    param_2 = uVar4;
  }
  if (!bVar1) {
    allocFmtString(local_28,0xfe,"%s/pack/%s.lzma","/etc_ro/web",&DAT_0048bb94);
    if ((local_28[0] != (char *)0x0) && (iVar2 = access(local_28[0],4), iVar2 == 0)) {
      trace(1,"switch_language: %s\n",local_28[0]);
      doSystem("htmlunpack %s %s",local_28[0],"/etc_ro/web");
      if (local_28[0] != (char *)0x0) {
        free(local_28[0]);
        local_28[0] = (char *)0x0;
      }
      if (uVar4 != 0) {
        local_38 = local_38 & 0xffffff00;
        iVar2 = open("/dev/gpio",0);
        if (-1 < iVar2) {
          ioctl(iVar2,0xcf81,&local_38);
          close(iVar2);
        }
      }
      if (param_1 != 0) {
        websDisableErrorMessage();
        websEndAuthentication();
        websStartAuthentication();
        websEnableErrorMessage();
      }
      WebCurrentLanguage = 0;
      return 0;
    }
    trace(1,"switch_language: %s was not found!\n",local_28[0]);
    if (local_28[0] != (char *)0x0) {
      free(local_28[0]);
    }
    return 0xffffffff;
  }
                    // WARNING: Could not recover jumptable at 0x00413334. Too many branches
                    // WARNING: Treating indirect jump as call
  uVar3 = (*(code *)(&_gp + *(int *)(&DAT_0048be00 + param_2 * 4)))();
  return uVar3;
}



char * skipSpace(char *param_1)

{
  ushort uVar1;
  char *pcVar2;
  
  pcVar2 = (char *)0x0;
  if ((param_1 != (char *)0x0) && (pcVar2 = param_1, *param_1 != 0)) {
    uVar1 = *(ushort *)(*param_1 * 2 + __ctype_b);
    while (pcVar2 = param_1, (uVar1 >> 5 & 1) != 0) {
      param_1 = param_1 + 1;
      if (*param_1 == 0) {
        return param_1;
      }
      uVar1 = *(ushort *)(*param_1 * 2 + __ctype_b);
    }
  }
  return pcVar2;
}



void websSetVar(int param_1,char *param_2,char *param_3)

{
  size_t sVar1;
  void *__ptr;
  int iVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  
  trace(2,"websSetVar=(%s,%s)\n",param_2,param_3);
  if (param_2 == (char *)0x0) {
    trace(0x10,"websSetVar with null var\n");
    return;
  }
  if (param_3 == (char *)0x0) {
    for (puVar4 = *(undefined4 **)(param_1 + 0x84); puVar4 != (undefined4 *)0x0;
        puVar4 = (undefined4 *)*puVar4) {
      iVar2 = strcasecmp(param_2,(char *)puVar4[1]);
      if (iVar2 == 0) {
        if (puVar4 != (undefined4 *)0x0) {
          if ((void *)puVar4[2] != (void *)0x0) {
            free((void *)puVar4[2]);
            puVar4[2] = 0;
          }
          uVar3 = strdupWithoutNull(&DAT_0049445c);
          puVar4[2] = uVar3;
          return;
        }
        break;
      }
    }
    puVar4 = (undefined4 *)mmalloc(0xc);
    if (puVar4 != (undefined4 *)0x0) {
      uVar3 = strdupWithoutNull(param_2);
      puVar4[1] = uVar3;
      uVar3 = strdupWithoutNull(&DAT_0049445c);
      puVar4[2] = uVar3;
      *puVar4 = *(undefined4 *)(param_1 + 0x84);
      *(undefined4 **)(param_1 + 0x84) = puVar4;
    }
  }
  else {
    sVar1 = strlen(param_3);
    if (0x800 < sVar1) {
      trace(0x10,"websSetVar out of length(%s)\n");
      return;
    }
    __ptr = (void *)strdupWithoutNull(param_3);
    for (puVar4 = *(undefined4 **)(param_1 + 0x84); puVar4 != (undefined4 *)0x0;
        puVar4 = (undefined4 *)*puVar4) {
      iVar2 = strcasecmp(param_2,(char *)puVar4[1]);
      if (iVar2 == 0) {
        if (puVar4 != (undefined4 *)0x0) {
          if ((void *)puVar4[2] != (void *)0x0) {
            free((void *)puVar4[2]);
            puVar4[2] = 0;
          }
          uVar3 = strdupWithoutNull(__ptr);
          puVar4[2] = uVar3;
          goto LAB_00413930;
        }
        break;
      }
    }
    puVar4 = (undefined4 *)mmalloc(0xc);
    if (puVar4 != (undefined4 *)0x0) {
      uVar3 = strdupWithoutNull(param_2);
      puVar4[1] = uVar3;
      uVar3 = strdupWithoutNull(__ptr);
      puVar4[2] = uVar3;
      *puVar4 = *(undefined4 *)(param_1 + 0x84);
      *(undefined4 **)(param_1 + 0x84) = puVar4;
    }
LAB_00413930:
    if (__ptr != (void *)0x0) {
      free(__ptr);
    }
  }
  return;
}



undefined4 websTestVar(int param_1,char *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = *(undefined4 **)(param_1 + 0x84);
  while( true ) {
    if (puVar2 == (undefined4 *)0x0) {
      return 0;
    }
    iVar1 = strcasecmp(param_2,(char *)puVar2[1]);
    if (iVar1 == 0) break;
    puVar2 = (undefined4 *)*puVar2;
  }
  if (puVar2 == (undefined4 *)0x0) {
    return 0;
  }
  return 1;
}



undefined4 websGetVar(int param_1,char *param_2,undefined4 param_3)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = *(undefined4 **)(param_1 + 0x84);
  while( true ) {
    if (puVar2 == (undefined4 *)0x0) {
      return param_3;
    }
    iVar1 = strcasecmp(param_2,(char *)puVar2[1]);
    if (iVar1 == 0) break;
    puVar2 = (undefined4 *)*puVar2;
  }
  if (puVar2 == (undefined4 *)0x0) {
    return param_3;
  }
  return puVar2[2];
}



bool websTestVarValue(int param_1,char *param_2,char *param_3)

{
  int iVar1;
  int *__s2;
  int **ppiVar2;
  int **ppiVar3;
  
  ppiVar3 = *(int ***)(param_1 + 0x84);
  ppiVar2 = ppiVar3;
  if (ppiVar3 == (int **)0x0) {
LAB_00413ba0:
    if (ppiVar2 != (int **)0x0) {
      do {
        if (ppiVar3 == (int **)0x0) {
LAB_00413bdc:
          __s2 = (int *)&DAT_0049445c;
LAB_00413be8:
          iVar1 = strcasecmp(param_3,(char *)__s2);
          return iVar1 == 0;
        }
        iVar1 = strcasecmp(param_2,(char *)ppiVar3[1]);
        if (iVar1 == 0) {
          if (ppiVar3 != (int **)0x0) {
            __s2 = ppiVar3[2];
            goto LAB_00413be8;
          }
          goto LAB_00413bdc;
        }
        ppiVar3 = (int **)*ppiVar3;
      } while( true );
    }
  }
  else {
    do {
      iVar1 = strcasecmp(param_2,(char *)ppiVar2[1]);
      if (iVar1 == 0) goto LAB_00413ba0;
      ppiVar2 = (int **)*ppiVar2;
    } while (ppiVar2 != (int **)0x0);
  }
  return false;
}



void websDeleteVar(int param_1,char *param_2)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 *__ptr;
  undefined4 *puVar4;
  
  if (param_2 != (char *)0x0) {
    puVar3 = *(undefined4 **)(param_1 + 0x84);
    puVar1 = puVar3;
    puVar4 = puVar3;
    while (__ptr = puVar1, __ptr != (undefined4 *)0x0) {
      iVar2 = strcasecmp(param_2,(char *)__ptr[1]);
      if (iVar2 == 0) {
        if (puVar3 == __ptr) {
          *(undefined4 *)(param_1 + 0x84) = *__ptr;
        }
        else {
          *puVar4 = *__ptr;
        }
        trace(2,"websDeleteVar=(%s,%s)\n",param_2,__ptr[2]);
        if ((void *)__ptr[1] != (void *)0x0) {
          free((void *)__ptr[1]);
          __ptr[1] = 0;
        }
        if ((void *)__ptr[2] != (void *)0x0) {
          free((void *)__ptr[2]);
          __ptr[2] = 0;
        }
        free(__ptr);
        return;
      }
      puVar4 = __ptr;
      puVar1 = (undefined4 *)*__ptr;
    }
  }
  return;
}



void websCloseVar(int param_1)

{
  void *__ptr;
  void **__ptr_00;
  void **ppvVar1;
  
  __ptr_00 = (void **)*(void **)(param_1 + 0x84);
  if (*(void **)(param_1 + 0x84) == (void *)0x0) {
    *(undefined4 *)(param_1 + 0x84) = 0;
  }
  else {
    do {
      while( true ) {
        ppvVar1 = (void **)*__ptr_00;
        if (__ptr_00[1] == (void *)0x0) break;
        free(__ptr_00[1]);
        __ptr = __ptr_00[2];
        __ptr_00[1] = (void *)0x0;
        if (__ptr == (void *)0x0) goto LAB_00413de8;
LAB_00413e30:
        free(__ptr);
        __ptr_00[2] = (void *)0x0;
        free(__ptr_00);
        __ptr_00 = ppvVar1;
        if (ppvVar1 == (void **)0x0) goto LAB_00413e5c;
      }
      __ptr = __ptr_00[2];
      if (__ptr != (void *)0x0) goto LAB_00413e30;
LAB_00413de8:
      free(__ptr_00);
      __ptr_00 = ppvVar1;
    } while (ppvVar1 != (void **)0x0);
LAB_00413e5c:
    *(undefined4 *)(param_1 + 0x84) = 0;
  }
  return;
}



undefined4 websParaDefine(char *param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  
  puVar2 = websParaFuncList;
  do {
    if (puVar2 == (undefined4 *)0x0) {
LAB_00413ee0:
      puVar2 = (undefined4 *)mmalloc(0xc);
      if (puVar2 != (undefined4 *)0x0) {
        uVar3 = strdupWithoutNull(param_1);
        puVar2[1] = uVar3;
        puVar2[2] = param_2;
        *puVar2 = websParaFuncList;
        websParaFuncList = puVar2;
      }
      return 0;
    }
    iVar1 = strcasecmp(param_1,(char *)puVar2[1]);
    if (iVar1 == 0) {
      if (puVar2 != (undefined4 *)0x0) {
        puVar2[2] = param_2;
        return 0;
      }
      goto LAB_00413ee0;
    }
    puVar2 = (undefined4 *)*puVar2;
  } while( true );
}



void websParaOpen(void)

{
  formDefineInternet();
  formDefineWireless();
  formDefineDevice();
  formDefineMedia();
                    // WARNING: Treating indirect jump as call
  formDefineNetworkAPI();
  return;
}



void websParaClose(void)

{
  void **__ptr;
  void **ppvVar1;
  
  __ptr = (void **)websParaFuncList;
  if (websParaFuncList != (void *)0x0) {
    do {
      while( true ) {
        ppvVar1 = (void **)*__ptr;
        if (__ptr[1] == (void *)0x0) break;
        free(__ptr[1]);
        __ptr[1] = (void *)0x0;
        free(__ptr);
        __ptr = ppvVar1;
        if (ppvVar1 == (void **)0x0) {
          websParaFuncList = (void *)0x0;
          return;
        }
      }
      free(__ptr);
      __ptr = ppvVar1;
    } while (ppvVar1 != (void **)0x0);
  }
  websParaFuncList = (void *)0x0;
  return;
}



undefined4 websParaRequest(int param_1,char *param_2)

{
  ushort uVar1;
  char cVar2;
  int iVar3;
  size_t sVar4;
  char *pcVar5;
  char *pcVar6;
  char *pcVar7;
  undefined4 *puVar8;
  undefined4 *__dest;
  int iVar9;
  char *pcVar10;
  undefined4 uVar11;
  int iVar12;
  undefined4 *__src;
  int iVar13;
  stat sStack_c8;
  void *local_30;
  char *local_2c;
  
  local_30 = (void *)0x0;
  local_2c = (char *)0x0;
  iVar3 = stat(param_2,&sStack_c8);
  uVar11 = 0xffffffff;
  if (iVar3 < 0) {
    pcVar5 = "Can\'t stat %s";
  }
  else {
    local_30 = (void *)mmalloc(sStack_c8.st_atim.tv_sec + 1);
    if (local_30 == (void *)0x0) {
      websConnError(param_1,0x1f7,"Can\'t allocate buffer");
      goto LAB_004145e0;
    }
    *(undefined *)((int)local_30 + sStack_c8.st_atim.tv_sec) = 0;
    sVar4 = read(*(int *)(param_1 + 0x100),local_30,sStack_c8.st_atim.tv_sec);
    if (sVar4 == sStack_c8.st_atim.tv_sec) {
      if (-1 < *(int *)(param_1 + 0x100)) {
        close(*(int *)(param_1 + 0x100));
        *(undefined4 *)(param_1 + 0x100) = 0xffffffff;
      }
      pcVar5 = (char *)strndupWithoutNull(local_30,sStack_c8.st_atim.tv_sec);
      local_2c = pcVar5;
      if (pcVar5 == (char *)0x0) {
        websConnError(param_1,0x1f7,"Can\'t allocate memory");
      }
      else {
        iVar3 = 0;
LAB_00414190:
        if (iVar3 == 0) {
LAB_00414198:
          if (*pcVar5 != '\0') {
            do {
              pcVar6 = strstr(pcVar5,"%%");
              if (pcVar6 == (char *)0x0) break;
              websWriteComplete(param_1,pcVar5,(int)pcVar6 - (int)pcVar5);
              pcVar5 = pcVar6 + 2;
              pcVar10 = (char *)0x0;
              if ((pcVar5 != (char *)0x0) && (pcVar10 = pcVar5, pcVar6[2] != 0)) {
                uVar1 = *(ushort *)(pcVar6[2] * 2 + __ctype_b);
                while ((uVar1 >> 5 & 1) != 0) {
                  pcVar10 = pcVar10 + 1;
                  if (*pcVar10 == 0) break;
                  uVar1 = *(ushort *)(*pcVar10 * 2 + __ctype_b);
                }
              }
              pcVar6 = strstr(pcVar10,"%%");
              pcVar5 = pcVar6 + 2;
              if (pcVar6 == (char *)0x0) {
                websConnError(param_1,500,"Unterminated script in %s: \n",param_2);
                uVar11 = 0xffffffff;
                goto LAB_004145e0;
              }
              *pcVar6 = '\0';
              pcVar6 = (char *)0x0;
              if ((pcVar10 != (char *)0x0) && (pcVar6 = pcVar10, *pcVar10 != 0)) {
                uVar1 = *(ushort *)(*pcVar10 * 2 + __ctype_b);
                while ((uVar1 >> 5 & 1) != 0) {
                  pcVar6 = pcVar6 + 1;
                  if (*pcVar6 == 0) break;
                  uVar1 = *(ushort *)(*pcVar6 * 2 + __ctype_b);
                }
              }
              cVar2 = *pcVar6;
              pcVar10 = pcVar6;
              if (cVar2 != '\0') {
                do {
                  if ((cVar2 == '\\') && ((pcVar10[1] == '\r' || (pcVar10[1] == '\n')))) {
                    *pcVar10 = ' ';
                    pcVar7 = pcVar10 + 1;
                    cVar2 = *pcVar7;
                    if ((cVar2 != '\r') && (cVar2 != '\n')) goto LAB_00414334;
                    do {
                      do {
                        *pcVar7 = ' ';
                        pcVar7 = pcVar7 + 1;
                        cVar2 = *pcVar7;
                      } while (cVar2 == '\r');
                    } while (cVar2 == '\n');
                  }
                  else {
                    cVar2 = pcVar10[1];
LAB_00414334:
                    pcVar7 = pcVar10 + 1;
                  }
                  pcVar10 = pcVar7;
                } while (cVar2 != '\0');
                cVar2 = *pcVar6;
              }
              if (cVar2 == '\0') goto LAB_00414198;
              pcVar10 = strrchr(pcVar6,0x28);
              __src = (undefined4 *)0x0;
              iVar13 = 0;
              puVar8 = websParaFuncList;
              if (pcVar10 != (char *)0x0) {
                *pcVar10 = '\0';
                pcVar7 = strrchr(pcVar10 + 1,0x29);
                if (pcVar7 != (char *)0x0) {
                  *pcVar7 = '\0';
                }
                __src = (undefined4 *)mmalloc(0xc);
                iVar12 = 3;
                puVar8 = websParaFuncList;
                if (__src != (undefined4 *)0x0) {
                  iVar9 = 2;
                  puVar8 = __src;
                  do {
                    iVar9 = iVar9 + -1;
                    *puVar8 = 0;
                    puVar8 = puVar8 + 1;
                  } while (-1 < iVar9);
                  pcVar10 = strtok(pcVar10 + 1,",");
                  iVar9 = 0;
                  while (puVar8 = websParaFuncList, pcVar10 != (char *)0x0) {
                    iVar13 = iVar13 + 1;
                    *(char **)(iVar9 + (int)__src) = pcVar10;
                    puVar8 = __src;
                    if (iVar12 <= iVar13) {
                      __dest = (undefined4 *)mmalloc(iVar12 << 3);
                      sVar4 = iVar12 << 2;
                      if (__dest != (undefined4 *)0x0) {
                        iVar12 = iVar12 << 1;
                        memcpy(__dest,__src,sVar4);
                        puVar8 = __dest;
                        if (__src != (undefined4 *)0x0) {
                          free(__src);
                        }
                      }
                    }
                    pcVar10 = strtok((char *)0x0,",");
                    iVar9 = iVar13 * 4;
                    __src = puVar8;
                  }
                }
              }
              for (; puVar8 != (undefined4 *)0x0; puVar8 = (undefined4 *)*puVar8) {
                iVar12 = strcasecmp(pcVar6,(char *)puVar8[1]);
                if (iVar12 == 0) {
                  if (puVar8 != (undefined4 *)0x0) {
                    if ((code *)puVar8[2] != (code *)0x0) {
                      (*(code *)puVar8[2])(param_1,iVar13,__src);
                    }
                    goto LAB_00414470;
                  }
                  break;
                }
              }
              iVar3 = -1;
LAB_00414470:
              if (__src != (undefined4 *)0x0) {
                free(__src);
              }
              if (-1 < iVar3) goto LAB_00414190;
              websWriteFmt(param_1,"%s:NotSupport",pcVar6);
              iVar3 = 0;
              if (*pcVar5 == '\0') break;
            } while( true );
          }
        }
        uVar11 = 0;
        if (((pcVar5 != (char *)0x0) && (*pcVar5 != '\0')) && (iVar3 == 0)) {
          sVar4 = strlen(pcVar5);
          websWriteComplete(param_1,pcVar5,sVar4);
          uVar11 = 0;
        }
      }
      goto LAB_004145e0;
    }
    pcVar5 = "Can\'t read %s";
  }
  websConnError(param_1,500,pcVar5,param_2);
LAB_004145e0:
  iVar3 = websConnValid(param_1);
  if ((iVar3 != 0) && (-1 < *(int *)(param_1 + 0x100))) {
    close(*(int *)(param_1 + 0x100));
    *(undefined4 *)(param_1 + 0x100) = 0xffffffff;
  }
  if (local_2c != (char *)0x0) {
    free(local_2c);
  }
  if (local_30 != (void *)0x0) {
    free(local_30);
  }
  return uVar11;
}



undefined4 websSetFormDefine(char *param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  
  puVar2 = websSetFormFuncList;
  do {
    if (puVar2 == (undefined4 *)0x0) {
LAB_004147e4:
      puVar2 = (undefined4 *)mmalloc(0xc);
      if (puVar2 != (undefined4 *)0x0) {
        uVar3 = strdupWithoutNull(param_1);
        puVar2[1] = uVar3;
        puVar2[2] = param_2;
        *puVar2 = websSetFormFuncList;
        websSetFormFuncList = puVar2;
      }
      return 0;
    }
    iVar1 = strcasecmp(param_1,(char *)puVar2[1]);
    if (iVar1 == 0) {
      if (puVar2 != (undefined4 *)0x0) {
        puVar2[2] = param_2;
        return 0;
      }
      goto LAB_004147e4;
    }
    puVar2 = (undefined4 *)*puVar2;
  } while( true );
}



void websSetFormOpen(void)

{
                    // WARNING: Treating indirect jump as call
  formDefineManagement();
  return;
}



void websSetFormClose(void)

{
  void **__ptr;
  void **ppvVar1;
  
  __ptr = (void **)websSetFormFuncList;
  if (websSetFormFuncList != (void *)0x0) {
    do {
      while( true ) {
        ppvVar1 = (void **)*__ptr;
        if (__ptr[1] == (void *)0x0) break;
        free(__ptr[1]);
        __ptr[1] = (void *)0x0;
        free(__ptr);
        __ptr = ppvVar1;
        if (ppvVar1 == (void **)0x0) {
          websSetFormFuncList = (void *)0x0;
          return;
        }
      }
      free(__ptr);
      __ptr = ppvVar1;
    } while (ppvVar1 != (void **)0x0);
  }
  websSetFormFuncList = (void *)0x0;
  return;
}



undefined4
websSetFormProcessor
          (int param_1,undefined4 param_2,undefined4 param_3,char *param_4,undefined4 param_5)

{
  char *pcVar1;
  int iVar2;
  undefined4 *puVar3;
  char *__s;
  char cStack_110;
  char acStack_10f [255];
  
  trace(1,"websSetFormProcessor=%s\n",*(undefined4 *)(param_1 + 0x88));
  strncpy(&cStack_110,param_4,0xfe);
  pcVar1 = strchr(acStack_10f,0x2f);
  __s = pcVar1 + 1;
  if (pcVar1 == (char *)0x0) {
    websConnError(param_1,500,"Missing form name");
  }
  else {
    pcVar1 = strchr(__s,0x2f);
    puVar3 = websSetFormFuncList;
    if (pcVar1 != (char *)0x0) {
      *pcVar1 = '\0';
      puVar3 = websSetFormFuncList;
    }
    for (; puVar3 != (undefined4 *)0x0; puVar3 = (undefined4 *)*puVar3) {
      iVar2 = strcasecmp(__s,(char *)puVar3[1]);
      if (iVar2 == 0) {
        if (puVar3 != (undefined4 *)0x0) {
          if ((code *)puVar3[2] != (code *)0x0) {
            (*(code *)puVar3[2])(param_1,__s,param_5);
          }
          if (*(int *)(param_1 + 0x124) != 0) {
            websConnError(param_1,*(int *)(param_1 + 0x124),"Form %s is return error",__s);
            return 1;
          }
          return 0;
        }
        break;
      }
    }
    websConnError(param_1,500,"Form %s is not defined",__s);
  }
  return 1;
}



undefined4 websDecode64(char *param_1,char *param_2,uint param_3)

{
  char cVar1;
  char cVar2;
  size_t sVar3;
  byte *__src;
  byte *pbVar4;
  int iVar5;
  byte bVar6;
  uint uVar7;
  byte bVar8;
  uint uVar9;
  undefined4 uVar10;
  byte bVar11;
  
  sVar3 = strlen(param_2);
  uVar10 = 0xffffffff;
  if ((sVar3 < param_3) && (__src = (byte *)mmalloc(param_3), pbVar4 = __src, __src != (byte *)0x0))
  {
    while( true ) {
      cVar1 = *param_2;
      if (cVar1 == '\0') break;
      if (cVar1 < 'A') {
        if (cVar1 < ':') {
          cVar2 = '\x04';
          if ('/' < cVar1) goto LAB_00414b94;
          iVar5 = 0x3e;
          if (cVar1 != '+') {
            iVar5 = (cVar1 != '/') + 0x3f;
          }
        }
        else {
          iVar5 = (uint)(cVar1 != '=') << 6;
        }
      }
      else {
        if (cVar1 < '[') {
          cVar2 = -0x41;
LAB_00414b94:
          cVar2 = cVar1 + cVar2;
        }
        else {
          iVar5 = 0x40;
          if ((cVar1 < 'a') || (cVar2 = cVar1 + -0x47, 'z' < cVar1)) goto LAB_00414b9c;
        }
        iVar5 = (int)cVar2;
      }
LAB_00414b9c:
      if (iVar5 == 0x40) goto LAB_00414cb8;
      cVar1 = param_2[1];
      if (cVar1 == '\0') goto LAB_00414cb8;
      if (cVar1 < 'A') {
        if (cVar1 < ':') {
          cVar2 = '\x04';
          if ('/' < cVar1) goto LAB_00414bd0;
          uVar7 = 0x3e;
          if (cVar1 != '+') {
            uVar7 = (cVar1 != '/') + 0x3f;
          }
        }
        else {
          uVar7 = (uint)(cVar1 != '=') << 6;
        }
      }
      else {
        if (cVar1 < '[') {
          cVar2 = -0x41;
LAB_00414bd0:
          cVar2 = cVar1 + cVar2;
        }
        else {
          uVar7 = 0x40;
          if ((cVar1 < 'a') || (cVar2 = cVar1 + -0x47, 'z' < cVar1)) goto LAB_00414bd8;
        }
        uVar7 = (uint)cVar2;
      }
LAB_00414bd8:
      if (uVar7 == 0x40) goto LAB_00414cb8;
      bVar11 = (byte)(iVar5 << 2) | (byte)((int)uVar7 >> 4);
      cVar1 = param_2[2];
      if (cVar1 == '\0') goto LAB_00414cb8;
      if (cVar1 < 'A') {
        if (cVar1 < ':') {
          if ('/' < cVar1) {
            cVar2 = '\x04';
            goto LAB_00414c18;
          }
          uVar9 = 0x3e;
          if (cVar1 != '+') {
            uVar9 = (cVar1 != '/') + 0x3f;
          }
        }
        else {
          uVar9 = (uint)(cVar1 != '=') << 6;
        }
      }
      else {
        if (cVar1 < '[') {
          cVar2 = -0x41;
LAB_00414c18:
          cVar2 = cVar1 + cVar2;
        }
        else {
          uVar9 = 0x40;
          if ((cVar1 < 'a') || (cVar2 = cVar1 + -0x47, 'z' < cVar1)) goto LAB_00414c20;
        }
        uVar9 = (uint)cVar2;
      }
LAB_00414c20:
      if (uVar9 == 0x40) goto LAB_00414cb8;
      bVar6 = (byte)((uVar7 & 0xf) << 4) | (byte)((int)uVar9 >> 2);
      cVar1 = param_2[3];
      param_2 = param_2 + 4;
      if (cVar1 == '\0') goto LAB_00414cb8;
      if (cVar1 < 'A') {
        if (cVar1 < ':') {
          cVar2 = '\x04';
          if ('/' < cVar1) goto LAB_00414c60;
          iVar5 = 0x3e;
          if (cVar1 != '+') {
            iVar5 = (cVar1 != '/') + 0x3f;
          }
        }
        else {
          iVar5 = (uint)(cVar1 != '=') << 6;
        }
      }
      else {
        if (cVar1 < '[') {
          cVar2 = -0x41;
LAB_00414c60:
          cVar2 = cVar1 + cVar2;
        }
        else {
          iVar5 = 0x40;
          if ((cVar1 < 'a') || (cVar2 = cVar1 + -0x47, 'z' < cVar1)) goto LAB_00414c68;
        }
        iVar5 = (int)cVar2;
      }
LAB_00414c68:
      if (iVar5 == 0x40) goto LAB_00414cb8;
      bVar8 = (byte)iVar5 | (byte)((uVar9 & 3) << 6);
      *pbVar4 = bVar11;
      if ((bVar11 == 0) || (pbVar4[1] = bVar6, bVar6 == 0)) goto LAB_00414c9c;
      pbVar4[2] = bVar8;
      pbVar4 = pbVar4 + 3;
      if (bVar8 == 0) goto LAB_00414c9c;
    }
    *pbVar4 = 0;
LAB_00414c9c:
    strncpy(param_1,(char *)__src,param_3 - 1);
    uVar10 = 0;
LAB_00414cb8:
    if (__src != (byte *)0x0) {
      free(__src);
      return uVar10;
    }
  }
  else {
    uVar10 = 0xffffffff;
  }
  return uVar10;
}



void websEncode64(undefined *param_1,char *param_2,int param_3)

{
  uint uVar1;
  undefined *puVar2;
  int iVar3;
  int iVar4;
  char cVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  
  *param_1 = 0;
  cVar5 = *param_2;
  if (cVar5 != '\0') {
    puVar2 = param_1 + param_3;
    do {
      uVar7 = 0;
      iVar3 = 2;
      if (cVar5 != '\0') {
        uVar1 = (uint)cVar5;
        uVar8 = 0x10;
        do {
          iVar3 = iVar3 + -1;
          uVar7 = uVar7 | (uVar1 & 0xff) << (uVar8 & 0x1f);
          param_2 = param_2 + 1;
          if (iVar3 < 0) break;
          uVar1 = (uint)*param_2;
          uVar8 = iVar3 * 8;
        } while (uVar1 != 0);
      }
      iVar6 = iVar3 + 1;
      uVar1 = 0x12;
      if (iVar6 < 4) {
        uVar8 = uVar7 >> 0x12;
        iVar4 = iVar6;
        while (param_1 < puVar2) {
          iVar4 = iVar4 + 1;
          *param_1 = (&DAT_004d604c)[uVar8 & 0x3f];
          param_1 = param_1 + 1;
          uVar1 = uVar1 - 6;
          if (3 < iVar4) break;
          uVar8 = uVar7 >> (uVar1 & 0x1f);
        }
      }
      while (iVar4 = iVar3, 0 < iVar6) {
        *param_1 = 0x3d;
        param_1 = param_1 + 1;
        iVar3 = iVar4 + -1;
        iVar6 = iVar4;
      }
      *param_1 = 0;
      cVar5 = *param_2;
    } while (cVar5 != '\0');
  }
  return;
}



undefined4 websReplacePathIntrenal(int param_1)

{
  int *piVar1;
  undefined4 uVar2;
  undefined *puVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  char *local_30 [2];
  
  uVar6 = 0x193;
  strlower(*(undefined4 *)(param_1 + 0x88));
  uVar2 = strdupWithoutNull(*(undefined4 *)(param_1 + 0x88));
  *(undefined4 *)(param_1 + 0x90) = uVar2;
  piVar1 = &websReplacePathList;
  puVar3 = PTR_DAT_004d5a54;
  do {
    if (puVar3 == (undefined *)0x0) {
      iVar5 = *(int *)(param_1 + 0xc4);
joined_r0x004150fc:
      if (iVar5 == 0) {
        iVar4 = param_1 + 0x44;
        iVar5 = webncasestrcmp(iVar4,"text/html");
        if ((((((iVar5 == 0) || (iVar5 = webncasestrcmp(iVar4,"image/gif"), iVar5 == 0)) ||
              ((iVar5 = webncasestrcmp(iVar4,"image/jpeg"), iVar5 == 0 ||
               ((iVar5 = webncasestrcmp(iVar4,"image/png"), iVar5 == 0 ||
                (iVar5 = webncasestrcmp(iVar4,"text/css"), iVar5 == 0)))))) ||
             (iVar5 = webncasestrcmp(iVar4,"application/x-javascript"), iVar5 == 0)) ||
            (iVar5 = webncasestrcmp(iVar4,"image/vnd.microsoft.icon"), iVar5 == 0)) &&
           (allocFmtString(local_30,0x100,&DAT_0048cc18,"/etc_ro/web",
                           *(undefined4 *)(param_1 + 0x90)), local_30[0] != (char *)0x0)) {
          iVar5 = access(local_30[0],4);
          if (iVar5 == 0) {
            uVar6 = 0;
            *(undefined4 *)(param_1 + 0xc4) = 1;
          }
          if (local_30[0] != (char *)0x0) {
            free(local_30[0]);
          }
        }
      }
      return uVar6;
    }
    iVar5 = piVar1[2];
    if (((*(int *)(param_1 + 0x88) != 0) && (puVar3 != (undefined *)0x0)) &&
       (iVar4 = webncasestrcmp(*(int *)(param_1 + 0x88),puVar3), iVar4 == 0)) {
      iVar4 = webncasestrcmp("/NULLVDO.HTM",puVar3);
      if (iVar4 == 0) {
        websSetVar(param_1,"ReplySuccessPage","setvdo.htm");
        websSetVar(param_1,"ReplyErrorPage","errrvdo.htm");
      }
      iVar5 = strdupWithoutNull(iVar5);
      if (iVar5 != 0) {
        if (*(void **)(param_1 + 0x88) == (void *)0x0) {
          *(int *)(param_1 + 0x88) = iVar5;
        }
        else {
          free(*(void **)(param_1 + 0x88));
          *(int *)(param_1 + 0x88) = iVar5;
        }
        iVar5 = *piVar1;
        uVar6 = 0;
        *(int *)(param_1 + 0xc4) = iVar5;
        goto joined_r0x004150fc;
      }
    }
    puVar3 = (undefined *)piVar1[4];
    piVar1 = piVar1 + 3;
  } while( true );
}



void websInternalForwardURL(int param_1)

{
  char *pcVar1;
  int iVar2;
  int iVar3;
  
  pcVar1 = (char *)nvram_bufget(0,"ViewMode");
  iVar2 = atoi(pcVar1);
  iVar3 = webncasestrcmp(*(undefined4 *)(param_1 + 0x88),ForwardHome);
  if (iVar3 == 0) {
    if (iVar2 == 1) {
      pcVar1 = "/aview.htm";
    }
    else if (iVar2 == 2) {
      pcVar1 = "/jview.htm";
    }
    else {
      pcVar1 = "/top.htm";
    }
    iVar2 = strdupWithoutNull(pcVar1);
    if (iVar2 != 0) {
      if (*(void **)(param_1 + 0x88) == (void *)0x0) {
        *(int *)(param_1 + 0x88) = iVar2;
      }
      else {
        free(*(void **)(param_1 + 0x88));
        *(int *)(param_1 + 0x88) = iVar2;
      }
    }
  }
  return;
}



void websKernalParameter(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined **ppuVar1;
  bool bVar2;
  int iVar3;
  undefined *puVar4;
  undefined **ppuVar5;
  undefined *puVar6;
  undefined *puVar7;
  undefined *puVar8;
  
  puVar8 = &_gp;
  ppuVar5 = &websPostCgiList;
  puVar4 = PTR_s__cgi_dbglevel_cgi_004d576c;
  if (PTR_s__cgi_dbglevel_cgi_004d576c != (undefined *)0x0) {
    do {
      puVar6 = *ppuVar5;
      puVar7 = ppuVar5[2];
      bVar2 = false;
      if (*(int *)(param_1 + 0x88) != 0) {
        if (puVar4 == (undefined *)0x0) {
LAB_00415454:
          bVar2 = false;
        }
        else {
          iVar3 = webncasestrcmp();
          bVar2 = false;
          if (iVar3 == 0) {
            if (puVar6 != (undefined *)0x0) {
              iVar3 = websTestVar(param_1,puVar6);
              bVar2 = false;
              if (iVar3 == 0) goto LAB_00415458;
            }
            iVar3 = strdupWithoutNull(puVar7);
            if (iVar3 == 0) goto LAB_00415454;
            websSetVar(param_1,"ReplySuccessPage",*(undefined4 *)(param_1 + 0x88),param_4,puVar8);
            websSetVar(param_1,"ReplyErrorPage",*(undefined4 *)(param_1 + 0x88));
            if (*(void **)(param_1 + 0x88) == (void *)0x0) {
              bVar2 = true;
              *(int *)(param_1 + 0x88) = iVar3;
            }
            else {
              free(*(void **)(param_1 + 0x88));
              bVar2 = true;
              *(int *)(param_1 + 0x88) = iVar3;
            }
          }
        }
      }
LAB_00415458:
    } while ((!bVar2) &&
            (ppuVar1 = ppuVar5 + 4, puVar4 = *ppuVar1, ppuVar5 = ppuVar5 + 3,
            *ppuVar1 != (undefined *)0x0));
  }
  return;
}



undefined4 checkASPFile(char *param_1)

{
  int iVar1;
  
  iVar1 = strcmp(param_1,".asp");
  if ((((iVar1 != 0) && (iVar1 = strcmp(param_1,".htm"), iVar1 != 0)) &&
      (iVar1 = strcmp(param_1,".html"), iVar1 != 0)) && (iVar1 = strcmp(param_1,".cgi"), iVar1 != 0)
     ) {
    iVar1 = strcmp(param_1,".m3u8");
    if (iVar1 != 0) {
      return 0;
    }
    return 1;
  }
  return 1;
}



undefined4 checkPatchFile(int param_1)

{
  bool bVar1;
  undefined4 *puVar2;
  int iVar3;
  
  bVar1 = PTR_s__api_wifisetup_exe_004d575c != (undefined *)0x0;
  puVar2 = &websPathFileList;
  while( true ) {
    if (!bVar1) {
      return 0;
    }
    iVar3 = webncasestrcmp(*(undefined4 *)(param_1 + 0x88));
    if (iVar3 == 0) break;
    bVar1 = puVar2[3] != 0;
    puVar2 = puVar2 + 2;
  }
  *(undefined4 *)(param_1 + 0x114) = *puVar2;
  return 1;
}



undefined4 checkCgiPostRequest(int param_1)

{
  int iVar1;
  undefined **ppuVar2;
  
  ppuVar2 = &websCgiPostRequestList;
  do {
    if (*ppuVar2 == (undefined *)0x0) {
      return 0;
    }
    ppuVar2 = ppuVar2 + 1;
    iVar1 = webncasestrcmp(*(undefined4 *)(param_1 + 0x88));
  } while (iVar1 != 0);
  return 1;
}



undefined4 checkSessionKeyRequest(int param_1)

{
  int iVar1;
  undefined **ppuVar2;
  
  ppuVar2 = &websForceCheckSessionKeyList;
  do {
    if (*ppuVar2 == (undefined *)0x0) {
      return 0;
    }
    ppuVar2 = ppuVar2 + 1;
    iVar1 = webncasestrcmp(*(undefined4 *)(param_1 + 0x90));
  } while (iVar1 != 0);
  return 1;
}



undefined4 websEnableErrorMessage(void)

{
  undefined4 *puVar1;
  FILE *__stream;
  char *pcVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 uVar5;
  char local_220 [512];
  char *local_20 [2];
  
  local_20[0] = (char *)0x0;
  allocFmtString(local_20,0xfe,&DAT_0048cc18,"/etc_ro/web",WebErrMsgFile);
  uVar5 = 1;
  iVar4 = 0;
  if (local_20[0] != (char *)0x0) {
    __stream = fopen(local_20[0],"r");
    if (__stream != (FILE *)0x0) {
      while (pcVar2 = fgets(local_220,0x200,__stream), pcVar2 != (char *)0x0) {
        while (local_220[0] != ';') {
          pcVar2 = fgets(local_220,0x200,__stream);
          iVar4 = iVar4 + 1;
          if (pcVar2 == (char *)0x0) goto LAB_004158d4;
        }
      }
LAB_004158d4:
      fseek(__stream,0,0);
      puVar3 = (undefined4 *)mmalloc(iVar4 << 2);
      puVar1 = puVar3;
      if (puVar3 != (undefined4 *)0x0) {
        while (WebErrMsgList = puVar1, WebErrMsgCount = iVar4,
              pcVar2 = fgets(local_220,0x200,__stream), pcVar2 != (char *)0x0) {
          while (iVar4 = WebErrMsgCount, puVar1 = WebErrMsgList, local_220[0] != ';') {
            uVar5 = strdupWithoutNull(local_220);
            *puVar3 = uVar5;
            pcVar2 = fgets(local_220,0x200,__stream);
            puVar3 = puVar3 + 1;
            if (pcVar2 == (char *)0x0) goto LAB_00415990;
          }
        }
      }
LAB_00415990:
      fclose(__stream);
      uVar5 = 0;
    }
    if (local_20[0] != (char *)0x0) {
      free(local_20[0]);
    }
  }
  return uVar5;
}



void websDisableErrorMessage(void)

{
  void **__ptr;
  void **ppvVar1;
  int iVar2;
  
  __ptr = WebErrMsgList;
  if (WebErrMsgList != (void **)0x0) {
    iVar2 = 0;
    ppvVar1 = WebErrMsgList;
    if (0 < WebErrMsgCount) {
      do {
        while( true ) {
          iVar2 = iVar2 + 1;
          if (*ppvVar1 == (void *)0x0) break;
          free(*ppvVar1);
          *ppvVar1 = (void *)0x0;
          ppvVar1 = ppvVar1 + 1;
          if (WebErrMsgCount <= iVar2) goto LAB_00415a80;
        }
        ppvVar1 = ppvVar1 + 1;
      } while (iVar2 < WebErrMsgCount);
    }
LAB_00415a80:
    if (__ptr != (void **)0x0) {
      free(__ptr);
    }
    WebErrMsgList = (void **)0x0;
    WebErrMsgCount = 0;
  }
  return;
}



undefined * websGetErrorMessage(int param_1)

{
  undefined *puVar1;
  
  puVar1 = &DAT_0049445c;
  if ((-1 < param_1) && (param_1 < WebErrMsgCount)) {
    puVar1 = *(undefined **)(param_1 * 4 + WebErrMsgList);
  }
  return puVar1;
}



undefined4 * umGetUser(char *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = WebAuthUserList;
  while( true ) {
    if (puVar2 == (undefined4 *)0x0) {
      return (undefined4 *)0x0;
    }
    iVar1 = strcmp(param_1,(char *)puVar2[2]);
    if (iVar1 == 0) break;
    puVar2 = (undefined4 *)*puVar2;
  }
  return puVar2;
}



undefined4 umAddUser(char *param_1,undefined4 param_2,int param_3)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  
  puVar2 = WebAuthUserList;
  do {
    if (puVar2 == (undefined4 *)0x0) {
LAB_00415bf4:
      puVar2 = (undefined4 *)mmalloc(0x10);
      uVar3 = 0xffffffff;
      if (puVar2 != (undefined4 *)0x0) {
        puVar2[1] = param_3 + 1;
        uVar3 = strdupWithoutNull(param_1);
        puVar2[2] = uVar3;
        uVar3 = strdupWithoutNull(param_2);
        puVar2[3] = uVar3;
        *puVar2 = WebAuthUserList;
        WebAuthUserList = puVar2;
LAB_00415c54:
        uVar3 = 0;
      }
      return uVar3;
    }
    iVar1 = strcmp(param_1,(char *)puVar2[2]);
    if (iVar1 == 0) {
      if (puVar2 != (undefined4 *)0x0) {
        puVar2[1] = param_3 + 1;
        if ((void *)puVar2[3] != (void *)0x0) {
          free((void *)puVar2[3]);
          puVar2[3] = 0;
        }
        uVar3 = strdupWithoutNull(param_2);
        puVar2[3] = uVar3;
        goto LAB_00415c54;
      }
      goto LAB_00415bf4;
    }
    puVar2 = (undefined4 *)*puVar2;
  } while( true );
}



void umDelUser(char *param_1)

{
  int **ppiVar1;
  int iVar2;
  int **__ptr;
  int *__s2;
  int **ppiVar3;
  
  ppiVar1 = WebAuthUserList;
  ppiVar3 = WebAuthUserList;
  while( true ) {
    __ptr = ppiVar1;
    if (__ptr == (int **)0x0) {
      return;
    }
    __s2 = __ptr[2];
    iVar2 = strcmp(param_1,(char *)__s2);
    if (iVar2 == 0) break;
    ppiVar1 = (int **)*__ptr;
    ppiVar3 = __ptr;
  }
  if (ppiVar3 == WebAuthUserList) {
    WebAuthUserList = (int **)*__ptr;
    __s2 = __ptr[2];
  }
  else {
    *ppiVar3 = *__ptr;
  }
  if (__s2 != (int *)0x0) {
    free(__s2);
    __ptr[2] = (int *)0x0;
  }
  if (__ptr[3] != (int *)0x0) {
    free(__ptr[3]);
    __ptr[3] = (int *)0x0;
  }
  free(__ptr);
  return;
}



void websEnableAllUser(void)

{
  char *__s;
  char *__s_00;
  void *__ptr;
  char *pcVar1;
  int iVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  char acStack_68 [64];
  
  iVar5 = 1;
  do {
    snprintf(acStack_68,0x40,"User%d",iVar5);
    __s = (char *)nvram_bufget(0,acStack_68);
    if ((__s != (char *)0x0) && (*__s != '\0')) {
      __s_00 = strchr(__s,0x2f);
      __ptr = (void *)strdupWithoutNull(__s);
      if (__ptr != (void *)0x0) {
        iVar6 = 0;
        puVar3 = WebAuthUserList;
        if (__s_00 != (char *)0x0) {
          *__s_00 = '\0';
          __s_00 = __s_00 + 1;
          pcVar1 = strrchr(__s_00,0x2f);
          if ((pcVar1 == (char *)0x0) || (*pcVar1 = '\0', pcVar1 == (char *)0xffffffff)) {
            iVar6 = 0;
            puVar3 = WebAuthUserList;
          }
          else {
            iVar6 = pcVar1[1] + -0x30;
            puVar3 = WebAuthUserList;
          }
        }
        for (; puVar3 != (undefined4 *)0x0; puVar3 = (undefined4 *)*puVar3) {
          iVar2 = strcmp(__s,(char *)puVar3[2]);
          if (iVar2 == 0) {
            if (puVar3 != (undefined4 *)0x0) {
              puVar3[1] = iVar6 + 1;
              if ((void *)puVar3[3] != (void *)0x0) {
                free((void *)puVar3[3]);
                puVar3[3] = 0;
              }
              uVar4 = strdupWithoutNull(__s_00);
              puVar3[3] = uVar4;
              goto LAB_00415fc4;
            }
            break;
          }
        }
        puVar3 = (undefined4 *)mmalloc(0x10);
        if (puVar3 != (undefined4 *)0x0) {
          puVar3[1] = iVar6 + 1;
          uVar4 = strdupWithoutNull(__s);
          puVar3[2] = uVar4;
          uVar4 = strdupWithoutNull(__s_00);
          puVar3[3] = uVar4;
          *puVar3 = WebAuthUserList;
          WebAuthUserList = puVar3;
        }
LAB_00415fc4:
        if (__ptr != (void *)0x0) {
          free(__ptr);
        }
      }
    }
    iVar5 = iVar5 + 1;
    if (8 < iVar5) {
      return;
    }
  } while( true );
}



void websDisableAllUser(void)

{
  void *__ptr;
  void **__ptr_00;
  void **ppvVar1;
  
  __ptr_00 = (void **)WebAuthUserList;
  if (WebAuthUserList != (void *)0x0) {
    do {
      while( true ) {
        ppvVar1 = (void **)*__ptr_00;
        if (__ptr_00[2] != (void *)0x0) break;
        __ptr = __ptr_00[3];
        if (__ptr == (void *)0x0) goto LAB_004160cc;
LAB_00416114:
        free(__ptr);
        __ptr_00[3] = (void *)0x0;
        free(__ptr_00);
        __ptr_00 = ppvVar1;
        if (ppvVar1 == (void **)0x0) {
          WebAuthUserList = (void *)0x0;
          return;
        }
      }
      free(__ptr_00[2]);
      __ptr = __ptr_00[3];
      __ptr_00[2] = (void *)0x0;
      if (__ptr != (void *)0x0) goto LAB_00416114;
LAB_004160cc:
      free(__ptr_00);
      __ptr_00 = ppvVar1;
    } while (ppvVar1 != (void **)0x0);
  }
  WebAuthUserList = (void *)0x0;
  return;
}



undefined4 websEnableHtmlFile(void)

{
  FILE *__stream;
  char *pcVar1;
  int iVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 uVar5;
  char cStack_120;
  char local_11f;
  char local_11e;
  char local_11d [253];
  char *local_20 [2];
  
  local_20[0] = (char *)0x0;
  allocFmtString(local_20,0xfe,&DAT_0048cc18,"/etc_ro/web",WebAuthFile);
  uVar5 = 1;
  if (local_20[0] != (char *)0x0) {
    __stream = fopen(local_20[0],"r");
    if (__stream != (FILE *)0x0) {
LAB_0041620c:
      pcVar1 = fgets(&cStack_120,0x100,__stream);
      if (pcVar1 != (char *)0x0) {
        if ((((*(ushort *)(local_11f * 2 + __ctype_b) >> 5 & 1) != 0) &&
            ((*(ushort *)(local_11e * 2 + __ctype_b) >> 3 & 1) != 0)) &&
           ((*(ushort *)(local_11d[0] * 2 + __ctype_b) >> 5 & 1) != 0)) {
          local_11d[0] = '/';
          strtok(local_11d," \r\t\n");
          iVar4 = (int)local_11e;
          for (puVar3 = WebAuthFileList; puVar3 != (undefined4 *)0x0; puVar3 = (undefined4 *)*puVar3
              ) {
            iVar2 = webncasestrcmp(local_11d,puVar3[2]);
            if (iVar2 == 0) {
              if (puVar3 != (undefined4 *)0x0) {
                puVar3[1] = iVar4 + -0x30;
                goto LAB_0041620c;
              }
              break;
            }
          }
          puVar3 = (undefined4 *)mmalloc(0xc);
          if (puVar3 != (undefined4 *)0x0) {
            puVar3[1] = iVar4 + -0x30;
            uVar5 = strdupWithoutNull(local_11d);
            puVar3[2] = uVar5;
            *puVar3 = WebAuthFileList;
            WebAuthFileList = puVar3;
          }
        }
        goto LAB_0041620c;
      }
      fclose(__stream);
      uVar5 = 0;
    }
    if (local_20[0] != (char *)0x0) {
      free(local_20[0]);
    }
  }
  return uVar5;
}



undefined4 websStartAuthentication(void)

{
  FILE *__stream;
  int iVar1;
  undefined4 *puVar2;
  char *pcVar3;
  int iVar4;
  undefined4 uVar5;
  char cStack_120;
  char cStack_11f;
  char cStack_11e;
  char acStack_11d [253];
  char *apcStack_20 [2];
  
  pcVar3 = (char *)nvram_bufget(0,"AccessControlEnable");
  iVar4 = strcmp(pcVar3,"0");
  if (iVar4 == 0) {
    websEnableAllUser();
  }
  apcStack_20[0] = (char *)0x0;
  allocFmtString(apcStack_20,0xfe,&DAT_0048cc18,"/etc_ro/web",WebAuthFile);
  uVar5 = 1;
  if (apcStack_20[0] != (char *)0x0) {
    __stream = fopen(apcStack_20[0],"r");
    if (__stream != (FILE *)0x0) {
LAB_0041620c:
      pcVar3 = fgets(&cStack_120,0x100,__stream);
      if (pcVar3 != (char *)0x0) {
        if ((((*(ushort *)(cStack_11f * 2 + __ctype_b) >> 5 & 1) != 0) &&
            ((*(ushort *)(cStack_11e * 2 + __ctype_b) >> 3 & 1) != 0)) &&
           ((*(ushort *)(acStack_11d[0] * 2 + __ctype_b) >> 5 & 1) != 0)) {
          acStack_11d[0] = '/';
          strtok(acStack_11d," \r\t\n");
          iVar4 = (int)cStack_11e;
          for (puVar2 = WebAuthFileList; puVar2 != (undefined4 *)0x0; puVar2 = (undefined4 *)*puVar2
              ) {
            iVar1 = webncasestrcmp(acStack_11d,puVar2[2]);
            if (iVar1 == 0) {
              if (puVar2 != (undefined4 *)0x0) {
                puVar2[1] = iVar4 + -0x30;
                goto LAB_0041620c;
              }
              break;
            }
          }
          puVar2 = (undefined4 *)mmalloc(0xc);
          if (puVar2 != (undefined4 *)0x0) {
            puVar2[1] = iVar4 + -0x30;
            uVar5 = strdupWithoutNull(acStack_11d);
            puVar2[2] = uVar5;
            *puVar2 = WebAuthFileList;
            WebAuthFileList = puVar2;
          }
        }
        goto LAB_0041620c;
      }
      fclose(__stream);
      uVar5 = 0;
    }
    if (apcStack_20[0] != (char *)0x0) {
      free(apcStack_20[0]);
    }
  }
  return uVar5;
}



void websEndAuthentication(void)

{
  char *__s1;
  int iVar1;
  void *__ptr;
  void **__ptr_00;
  void **ppvVar2;
  void *pvVar3;
  
  __s1 = (char *)nvram_bufget(0,"AccessControlEnable");
  iVar1 = strcmp(__s1,"0");
  ppvVar2 = WebAuthUserList;
  __ptr_00 = WebAuthFileList;
  if (iVar1 == 0) {
    while (ppvVar2 != (void **)0x0) {
      pvVar3 = *ppvVar2;
      if (ppvVar2[2] == (void *)0x0) {
        __ptr = ppvVar2[3];
      }
      else {
        free(ppvVar2[2]);
        __ptr = ppvVar2[3];
        ppvVar2[2] = (void *)0x0;
      }
      if (__ptr != (void *)0x0) {
        free(__ptr);
        ppvVar2[3] = (void *)0x0;
      }
      free(ppvVar2);
      ppvVar2 = (void **)pvVar3;
    }
    WebAuthUserList = (void **)0x0;
    __ptr_00 = WebAuthFileList;
  }
  do {
    if (__ptr_00 == (void **)0x0) {
      WebAuthFileList = (void **)0x0;
      return;
    }
    while( true ) {
      ppvVar2 = (void **)*__ptr_00;
      if (__ptr_00[2] == (void *)0x0) break;
      free(__ptr_00[2]);
      __ptr_00[2] = (void *)0x0;
      free(__ptr_00);
      __ptr_00 = ppvVar2;
      if (ppvVar2 == (void **)0x0) {
        WebAuthFileList = (void **)0x0;
        return;
      }
    }
    free(__ptr_00);
    __ptr_00 = ppvVar2;
  } while( true );
}



uint websGetAuthenticateRealm(int param_1)

{
  uint *puVar1;
  char *__nptr;
  int iVar2;
  int iVar3;
  undefined *puVar4;
  
  __nptr = (char *)nvram_bufget(0,"HTTPAuthentication");
  iVar2 = atoi(__nptr);
  if ((*(int *)(param_1 + 0xc4) != 4) && (*(int *)(param_1 + 0xc4) != 1)) {
    if ((iVar2 == 1) == 0) {
      puVar1 = &websForceAuthenticPathList;
      puVar4 = PTR_s__frame_dgimage_cgi_004d5a24;
      while (puVar4 != (undefined *)0x0) {
        iVar3 = webncasestrcmp(*(undefined4 *)(param_1 + 0x88));
        if (iVar3 == 0) {
          return *puVar1;
        }
        puVar4 = (undefined *)puVar1[3];
        puVar1 = puVar1 + 2;
      }
    }
    return (uint)(iVar2 == 1);
  }
  return 1;
}



undefined4 websCheckRealm(int param_1)

{
  char cVar1;
  uint *puVar2;
  char *pcVar3;
  char *__s;
  char *__s1;
  void *__ptr;
  char *__s2;
  char *__s_00;
  int iVar4;
  char *pcVar5;
  size_t sVar6;
  size_t sVar7;
  uint uVar8;
  undefined *puVar9;
  undefined4 *puVar10;
  int *piVar11;
  int *piVar12;
  undefined4 uVar13;
  int iVar14;
  stat sStack_c8;
  int local_30;
  uint local_2c;
  
  pcVar3 = (char *)nvram_bufget(0,"AdminID");
  __s = (char *)nvram_bufget(0,"AdminPassword");
  __s1 = (char *)nvram_bufget(0,"AccessControlEnable");
  local_30 = 0;
  __ptr = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0x88));
  __s2 = (char *)strdupWithoutNull(*(undefined4 *)(param_1 + 0xac));
  __s_00 = (char *)strdupWithoutNull(*(undefined4 *)(param_1 + 0xa8));
  iVar14 = 3;
  if (((pcVar3 == (char *)0x0) && (__s == (char *)0x0)) ||
     (puVar10 = WebAuthFileList, (*(uint *)(param_1 + 0xe4) >> 2 & 1) != 0)) {
    uVar13 = 0;
    *(undefined4 *)(param_1 + 0xc0) = 3;
    goto LAB_004167c4;
  }
  for (; puVar10 != (undefined4 *)0x0; puVar10 = (undefined4 *)*puVar10) {
    iVar4 = webncasestrcmp(__ptr,puVar10[2]);
    if (iVar4 == 0) {
      if (puVar10 != (undefined4 *)0x0) {
        iVar14 = puVar10[1];
        local_30 = 1;
        goto LAB_004168e4;
      }
      break;
    }
  }
  piVar11 = &websAuthenticationPathList;
  if (PTR_s__dcs932lb2_jpg_004d5844 != (undefined *)0x0) {
    if (__ptr == (void *)0x0) {
      do {
        if (piVar11[3] == 0) break;
        piVar12 = piVar11 + 5;
        piVar11 = piVar11 + 4;
      } while (*piVar12 != 0);
    }
    else {
      piVar12 = piVar11;
      if (PTR_s__dcs932lb2_jpg_004d5844 == (undefined *)0x0) goto LAB_004168d0;
      do {
        iVar4 = webncasestrcmp(__ptr);
        piVar12 = piVar11;
        if (iVar4 == 0) {
          iVar14 = *piVar11;
          local_30 = 1;
          if (iVar14 == 4) {
            pcVar5 = (char *)nvram_bufget(0,"SnapshotURLAuthentication");
            iVar14 = 1;
            if (((pcVar5 != (char *)0x0) && (*pcVar5 != '\0')) &&
               (iVar4 = strcmp(pcVar5,"1"), iVar4 == 0)) {
              iVar14 = 0;
            }
          }
          break;
        }
LAB_004168d0:
        piVar11 = piVar12 + 2;
      } while (piVar12[3] != 0);
    }
  }
LAB_004168e4:
  pcVar5 = (char *)nvram_bufget(0,"HTTPAuthentication");
  iVar4 = atoi(pcVar5);
  local_2c = (uint)(iVar4 == 1);
  if ((*(int *)(param_1 + 0xc4) == 4) || (*(int *)(param_1 + 0xc4) == 1)) {
    local_2c = 1;
  }
  else if (local_2c == 0) {
    puVar2 = &websForceAuthenticPathList;
    puVar9 = PTR_s__frame_dgimage_cgi_004d5a24;
    while (puVar9 != (undefined *)0x0) {
      iVar4 = webncasestrcmp(*(undefined4 *)(param_1 + 0x88));
      if (iVar4 == 0) {
        local_2c = *puVar2;
        break;
      }
      puVar9 = (undefined *)puVar2[3];
      puVar2 = puVar2 + 2;
    }
  }
  if (((pcVar3 != (char *)0x0) && (__s2 != (char *)0x0)) &&
     (iVar4 = strcmp(pcVar3,__s2), iVar4 == 0)) {
    sVar6 = strlen(pcVar3);
    sVar7 = strlen(__s2);
    if (sVar6 == sVar7) {
      if (local_2c == 1) {
        uVar8 = *(uint *)(param_1 + 0xe4);
LAB_00416cc8:
        if ((uVar8 >> 0xd & 1) != 0) {
          uVar13 = strdupWithoutNull(__s);
          *(undefined4 *)(param_1 + 0xa8) = uVar13;
          iVar4 = websCheckDigestRealm(param_1);
          if (iVar4 == 0) goto LAB_00416cb0;
          if (*(void **)(param_1 + 0xa8) != (void *)0x0) {
            free(*(void **)(param_1 + 0xa8));
            *(undefined4 *)(param_1 + 0xa8) = 0;
          }
        }
      }
      else {
        uVar8 = *(uint *)(param_1 + 0xe4);
        if ((uVar8 >> 0xc & 1) == 0) goto LAB_00416cc8;
        if (__s == (char *)0x0) {
          if (__s_00 == (char *)0x0) {
            *(undefined4 *)(param_1 + 0xc0) = 3;
          }
          goto LAB_004169f0;
        }
        if (__s_00 == (char *)0x0) goto LAB_004169f0;
        sVar6 = strlen(__s);
        sVar7 = strlen(__s_00);
        if ((sVar6 != sVar7) || (iVar4 = strcmp(__s,__s_00), iVar4 != 0)) goto LAB_004169f0;
LAB_00416cb0:
        *(undefined4 *)(param_1 + 0xc0) = 3;
      }
    }
  }
LAB_004169f0:
  if (__s1 == (char *)0x0) {
LAB_00416b68:
    uVar13 = 0;
    if (iVar14 < 2) goto LAB_004167c4;
    if (iVar14 <= *(int *)(param_1 + 0xc0)) {
      uVar13 = 0;
      goto LAB_004167c4;
    }
  }
  else {
    iVar4 = strcmp(__s1,"0");
    if (((iVar4 == 0) && (*(int *)(param_1 + 0xc0) == 0)) &&
       (puVar10 = WebAuthUserList, __s2 != (char *)0x0)) {
      for (; puVar10 != (undefined4 *)0x0; puVar10 = (undefined4 *)*puVar10) {
        iVar4 = strcmp(__s2,(char *)puVar10[2]);
        if (iVar4 == 0) {
          if (puVar10 == (undefined4 *)0x0) break;
          if (local_2c == 1) {
            uVar8 = *(uint *)(param_1 + 0xe4);
LAB_00416e50:
            if ((uVar8 >> 0xd & 1) == 0) break;
            uVar13 = strdupWithoutNull(puVar10[3]);
            *(undefined4 *)(param_1 + 0xa8) = uVar13;
            iVar4 = websCheckDigestRealm(param_1);
            if (iVar4 != 0) {
              if (*(void **)(param_1 + 0xa8) != (void *)0x0) {
                free(*(void **)(param_1 + 0xa8));
                *(undefined4 *)(param_1 + 0xa8) = 0;
              }
              break;
            }
          }
          else {
            uVar8 = *(uint *)(param_1 + 0xe4);
            if ((uVar8 >> 0xc & 1) == 0) goto LAB_00416e50;
            if (__s_00 == (char *)0x0) {
              iVar4 = puVar10[3];
            }
            else {
              pcVar3 = (char *)puVar10[3];
              if (pcVar3 == (char *)0x0) break;
              sVar6 = strlen(__s_00);
              sVar7 = strlen(pcVar3);
              if (sVar6 != sVar7) break;
              iVar4 = strcmp(__s_00,pcVar3);
            }
            if (iVar4 != 0) break;
          }
          *(undefined4 *)(param_1 + 0xc0) = puVar10[1];
          break;
        }
      }
    }
    if ((__s1 == (char *)0x0) || (iVar4 = strcmp(__s1,"0"), iVar4 != 0)) goto LAB_00416b68;
    uVar13 = 0;
    if (iVar14 <= *(int *)(param_1 + 0xc0)) goto LAB_004167c4;
  }
  uVar13 = 0x191;
  trace(1,"websCheckRealm=Login(%s,%s,%d,%d,%s)\n",__s2,__s_00,*(undefined4 *)(param_1 + 0xc0),
        iVar14,__ptr);
  if (local_30 == 0) {
    iVar14 = websConnValidateUrl(param_1,__ptr);
    if (iVar14 < 0) {
      uVar13 = 500;
    }
    else {
      pcVar3 = *(char **)(param_1 + 0x94);
      sVar6 = strlen(pcVar3);
      cVar1 = pcVar3[sVar6 - 1];
      if ((cVar1 == '/') || (cVar1 == '\\')) {
        pcVar3[sVar6 - 1] = '\0';
      }
      iVar14 = access(pcVar3,4);
      if (iVar14 == 0) {
        iVar14 = stat(pcVar3,&sStack_c8);
        if (iVar14 < 0) {
          uVar13 = 400;
        }
        else if ((sStack_c8.st_uid & 0xf000) != 0x8000) {
          uVar13 = 0x194;
        }
      }
      else {
        uVar13 = 0x194;
      }
    }
  }
LAB_004167c4:
  if (__ptr != (void *)0x0) {
    free(__ptr);
  }
  if (__s2 != (char *)0x0) {
    free(__s2);
  }
  if (__s_00 != (char *)0x0) {
    free(__s_00);
  }
  return uVar13;
}



void websRefreshCookieDigest(void)

{
  return;
}



int websSocketOpen(void)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 10;
  iVar2 = 0;
  DAT_004d6098 = DAT_004d6098 + 1;
  if (DAT_004d6098 < 2) {
    socketHighestFd = 0xffffffff;
    socketList = 0;
    socketLast = 0xffffffff;
    while ((iVar2 = websSSLOpen(), iVar2 < 0 && (bVar1 = 0 < iVar3, iVar3 = iVar3 + -1, bVar1))) {
      usleep(100000);
    }
  }
  return iVar2;
}



int websSocketGetPtr(int param_1)

{
  int *piVar1;
  int iVar2;
  
  if (-1 < param_1) {
    if (param_1 <= socketLast) {
      iVar2 = *(int *)(param_1 * 4 + socketList);
      if (iVar2 != 0) {
        return iVar2;
      }
    }
  }
  piVar1 = __errno_location();
  *piVar1 = 9;
  return 0;
}



uint websSocketSetBlock(int param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  
  iVar4 = socketLast;
  if (-1 < param_1) {
    if (param_1 <= socketLast) {
      piVar1 = (int *)(param_1 * 4 + socketList);
      iVar2 = *piVar1;
      if (iVar2 != 0) {
        uVar5 = *(uint *)(iVar2 + 0x6c);
        uVar3 = uVar5 & 0xffffffef;
        if (param_2 != 0) {
          uVar3 = uVar3 | 0x10;
        }
        *(uint *)(iVar2 + 0x6c) = uVar3;
        if ((uVar3 >> 4 & 1) == 0) {
          uVar3 = fcntl(*(int *)(iVar2 + 0x70),3,iVar4,piVar1,&_gp);
          iVar4 = *(int *)(iVar2 + 0x70);
          uVar3 = uVar3 | 0x80;
        }
        else {
          uVar3 = fcntl(*(int *)(iVar2 + 0x70),3,iVar4,piVar1,&_gp);
          iVar4 = *(int *)(iVar2 + 0x70);
          uVar3 = uVar3 & 0xffffff7f;
        }
        fcntl(iVar4,4,uVar3);
        return uVar5 & 0x10;
      }
    }
  }
  piVar1 = __errno_location();
  *piVar1 = 9;
  return 0;
}



int websSocketRead(int param_1,int param_2,size_t param_3)

{
  int *piVar1;
  int iVar2;
  size_t sVar3;
  int iVar4;
  int iVar5;
  int local_28;
  
  if (((param_1 < 0) || (socketLast < param_1)) ||
     (iVar5 = *(int *)(param_1 * 4 + socketList), iVar5 == 0)) {
    piVar1 = __errno_location();
    iVar4 = -1;
    *piVar1 = 9;
  }
  else {
    iVar4 = 0;
    if (((*(uint *)(iVar5 + 0x6c) & 1) == 0) && (iVar4 = 0, 0 < (int)param_3)) {
      do {
        iVar2 = memPoolLen(iVar5);
        sVar3 = param_3;
        if (iVar2 < (int)param_3) {
          sVar3 = memPoolLen(iVar5);
        }
        if ((int)sVar3 < 1) {
          if (((*(uint *)(iVar5 + 0x6c) >> 4 & 1) != 0) && (0 < iVar4)) {
            return iVar4;
          }
          memPoolFlush(iVar5);
          sVar3 = memPoolPutMaxBlockSize(iVar5);
          if ((int)param_3 < (int)sVar3) {
            sVar3 = param_3;
          }
          local_28 = 0;
          if (((param_1 < 0) || (socketLast < param_1)) ||
             (iVar2 = *(int *)(param_1 * 4 + socketList), iVar2 == 0)) {
            piVar1 = __errno_location();
            *piVar1 = 9;
          }
          else {
            if ((*(uint *)(iVar2 + 0x6c) & 1) != 0) {
LAB_004174ac:
              if (iVar4 != 0) {
                return iVar4;
              }
              *(uint *)(iVar5 + 0x6c) = *(uint *)(iVar5 + 0x6c) | 1;
              return 0;
            }
            sVar3 = recv(*(int *)(iVar2 + 0x70),*(void **)(iVar5 + 0x14),sVar3,0);
            if (-1 < (int)sVar3) {
              if (sVar3 == 0) goto LAB_004174ac;
              memPoolPutBlockPtrAdj(iVar5,sVar3);
              if ((int)param_3 < (int)sVar3) {
                sVar3 = param_3;
              }
              goto LAB_004172b0;
            }
            piVar1 = __errno_location();
            local_28 = *piVar1;
            if (local_28 == 0x83) {
              *(uint *)(iVar2 + 0x6c) = *(uint *)(iVar2 + 0x6c) | 0x40;
              goto LAB_004174ac;
            }
          }
          if (local_28 != 0xb) {
            return -1;
          }
          if (((*(uint *)(iVar5 + 0x6c) >> 4 & 1) == 0) || (iVar4 != 0)) {
            if (-1 < iVar4) {
              return iVar4;
            }
            return -1;
          }
        }
        else {
LAB_004172b0:
          memcpy((void *)(param_2 + iVar4),*(void **)(iVar5 + 0x10),sVar3);
          memPoolGetBlockPtrAdj(iVar5,sVar3);
          iVar4 = iVar4 + sVar3;
          param_3 = param_3 - sVar3;
        }
      } while (0 < (int)param_3);
    }
  }
  return iVar4;
}



int websSocketGets(int param_1,undefined4 *param_2)

{
  char cVar1;
  int *piVar2;
  int iVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  char local_28 [8];
  
  *param_2 = 0;
  if (((param_1 < 0) || (socketLast < param_1)) ||
     (iVar3 = *(int *)(param_1 * 4 + socketList), iVar3 == 0)) {
    piVar2 = __errno_location();
    iVar5 = -1;
    *piVar2 = 9;
  }
  else {
    iVar6 = iVar3 + 0x38;
LAB_00417598:
    iVar5 = websSocketRead(param_1,local_28,1);
    if (-1 < iVar5) {
      do {
        if (iVar5 == 0) {
          iVar5 = memPoolLen(iVar6);
          if (iVar5 < 1) {
            return -1;
          }
          if ((*(uint *)(iVar3 + 0x6c) & 1) == 0) {
            return -1;
          }
          local_28[0] = '\n';
        }
        cVar1 = local_28[0];
        if (local_28[0] == '\n') {
LAB_00417684:
          iVar5 = memPoolLen(iVar6);
          if (iVar5 < 1) {
            *param_2 = 0;
          }
          else {
            uVar4 = strndupWithoutNull(*(undefined4 *)(iVar3 + 0x48),iVar5);
            *param_2 = uVar4;
          }
          memPoolFlush(iVar6);
          return iVar5;
        }
        if (local_28[0] == '\r') goto LAB_00417598;
        if ((local_28[0] == '\0') &&
           (iVar5 = strcmp(*(char **)(iVar3 + 0x48),"<policy-file-request/>"), iVar5 == 0))
        goto LAB_00417684;
        memPoolPutChar(iVar6,(int)cVar1);
        iVar5 = websSocketRead(param_1,local_28,1);
        if (iVar5 < 0) {
          return iVar5;
        }
      } while( true );
    }
  }
  return iVar5;
}



undefined4 websSocketFlush(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  size_t __n;
  ssize_t sVar4;
  uint uVar5;
  int iVar6;
  
  if (((param_1 < 0) || (socketLast < param_1)) ||
     (iVar2 = *(int *)(param_1 * 4 + socketList), iVar2 == 0)) {
    piVar1 = __errno_location();
    *piVar1 = 9;
  }
  else {
    iVar6 = iVar2 + 0x1c;
    if ((*(uint *)(iVar2 + 0x6c) >> 4 & 1) == 0) {
      *(uint *)(iVar2 + 0x6c) = *(uint *)(iVar2 + 0x6c) | 8;
    }
LAB_004177b0:
    do {
      iVar3 = memPoolLen(iVar6);
      if (iVar3 < 1) {
        iVar3 = memPoolLen(iVar6);
        if (iVar3 == 0) {
          memPoolFlush(iVar6);
        }
        if (-1 < *(int *)(iVar2 + 0x78)) {
          *(int *)(iVar2 + 0x60) = *(int *)(iVar2 + 0x78);
          *(undefined4 *)(iVar2 + 0x78) = 0xffffffff;
        }
        *(uint *)(iVar2 + 0x6c) = *(uint *)(iVar2 + 0x6c) & 0xfffffff7;
        return 0;
      }
      __n = memPoolGetMaxBlockSize();
      sVar4 = send(*(int *)(iVar2 + 0x70),*(void **)(iVar2 + 0x2c),__n,0);
      iVar3 = 0;
      if (sVar4 < 0) {
        piVar1 = __errno_location();
        iVar3 = *piVar1;
      }
      else if ((sVar4 == 0) && (__n != 0)) {
        iVar3 = 0xb;
      }
      else if (-1 < sVar4) {
        memPoolGetBlockPtrAdj(iVar6,sVar4);
        goto LAB_004177b0;
      }
    } while (iVar3 == 4);
    if (iVar3 == 0xb) {
      if (*(int *)(iVar2 + 0x78) < 0) {
        uVar5 = *(uint *)(iVar2 + 0x60);
        *(uint *)(iVar2 + 0x60) = uVar5 | 4;
        *(uint *)(iVar2 + 0x78) = uVar5;
      }
      return 0;
    }
  }
  return 0xffffffff;
}



int websSocketWrite(int param_1,int param_2,int param_3)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  if (((-1 < param_1) && (param_1 <= socketLast)) &&
     (iVar2 = *(int *)(param_1 * 4 + socketList), iVar2 != 0)) {
    iVar5 = iVar2 + 0x1c;
    iVar6 = 0;
    while( true ) {
      while( true ) {
        if (param_3 < 1) {
          return iVar6;
        }
        iVar3 = memPoolPutMaxBlockSize(iVar5);
        if (iVar3 == 0) break;
        iVar4 = param_3;
        if (iVar3 < param_3) {
          iVar4 = iVar3;
        }
        memPoolPutBlock(iVar5,param_2,iVar4);
        param_2 = param_2 + iVar4;
        param_3 = param_3 - iVar4;
        iVar6 = iVar6 + iVar4;
      }
      iVar3 = websSocketFlush(param_1,param_2);
      if (iVar3 < 0) break;
      iVar3 = memPoolPutMaxBlockSize(iVar5);
      if ((iVar3 == 0) && ((*(uint *)(iVar2 + 0x6c) >> 4 & 1) == 0)) {
        return iVar6;
      }
    }
    return -1;
  }
  piVar1 = __errno_location();
  *piVar1 = 9;
  return -1;
}



uint websSocketEof(int param_1)

{
  int *piVar1;
  int iVar2;
  
  if (-1 < param_1) {
    if (param_1 <= socketLast) {
      iVar2 = *(int *)(param_1 * 4 + socketList);
      if (iVar2 != 0) {
        return *(uint *)(iVar2 + 0x6c) & 1;
      }
    }
  }
  piVar1 = __errno_location();
  *piVar1 = 9;
  return 0xffffffff;
}



int websSocketSelect(int param_1,int param_2)

{
  bool bVar1;
  fd_set *__readfds;
  fd_set *__writefds;
  int iVar2;
  int *piVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  timeval local_38;
  uint local_30;
  
  iVar6 = (socketHighestFd + 0x20U >> 5) << 2;
  __readfds = (fd_set *)mmalloc(iVar6);
  __writefds = (fd_set *)mmalloc(iVar6);
  iVar6 = 0;
  if (__readfds != (fd_set *)0x0) {
    if (__writefds != (fd_set *)0x0) {
      local_38.tv_sec = param_2 / 1000;
      local_38.tv_usec = (param_2 % 1000) * 1000;
      bVar1 = param_1 < 0;
      if (bVar1) {
        param_1 = 0;
      }
      local_30 = (uint)bVar1;
      if (param_1 <= socketLast) {
        do {
          iVar6 = *(int *)(param_1 * 4 + socketList);
          if (iVar6 != 0) {
            uVar5 = *(uint *)(iVar6 + 0x60);
            uVar9 = 1 << (*(uint *)(iVar6 + 0x70) & 0x1f);
            uVar8 = *(uint *)(iVar6 + 0x70) >> 5;
            if ((uVar5 >> 1 & 1) != 0) {
              __readfds->fds_bits[uVar8] = __readfds->fds_bits[uVar8] | uVar9;
              if (((param_1 < 0) || (socketLast < param_1)) ||
                 (iVar7 = *(int *)(param_1 * 4 + socketList), iVar7 == 0)) {
                piVar3 = __errno_location();
                *piVar3 = 9;
                uVar5 = *(uint *)(iVar6 + 0x60);
              }
              else {
                if ((*(uint *)(iVar7 + 0x6c) & 1) == 0) {
                  iVar2 = memPoolLen(iVar7 + 0x38);
                  iVar7 = memPoolLen(iVar7);
                  if (0 < iVar2 + iVar7) {
                    local_38.tv_sec = 0;
                    local_38.tv_usec = 0;
                  }
                }
                uVar5 = *(uint *)(iVar6 + 0x60);
              }
            }
            if ((uVar5 >> 2 & 1) != 0) {
              __writefds->fds_bits[uVar8] = __writefds->fds_bits[uVar8] | uVar9;
            }
          }
        } while ((local_30 != 0) && (param_1 = param_1 + 1, param_1 <= socketLast));
      }
      iVar6 = select(socketHighestFd + 1,__readfds,__writefds,(fd_set *)0x0,&local_38);
      if (0 < iVar6) {
        if (local_30 != 0) {
          param_1 = 0;
        }
        if (param_1 <= socketLast) {
          do {
            iVar7 = *(int *)(param_1 * 4 + socketList);
            if (iVar7 != 0) {
              uVar5 = *(uint *)(iVar7 + 0x70) >> 5;
              uVar8 = 1 << (*(uint *)(iVar7 + 0x70) & 0x1f);
              if ((__readfds->fds_bits[uVar5] & uVar8) == 0) {
                if ((param_1 < 0) || (socketLast < param_1)) {
                  piVar3 = __errno_location();
                  *piVar3 = 9;
                }
                else if ((*(uint *)(iVar7 + 0x6c) & 1) == 0) {
                  iVar2 = memPoolLen(iVar7 + 0x38);
                  iVar4 = memPoolLen(iVar7);
                  if (0 < iVar2 + iVar4) goto LAB_00417fe4;
                }
              }
              else {
LAB_00417fe4:
                *(uint *)(iVar7 + 0x74) = *(uint *)(iVar7 + 0x74) | 2;
              }
              if ((__writefds->fds_bits[uVar5] & uVar8) != 0) {
                *(uint *)(iVar7 + 0x74) = *(uint *)(iVar7 + 0x74) | 4;
              }
            }
          } while ((local_30 != 0) && (param_1 = param_1 + 1, param_1 <= socketLast));
        }
      }
    }
    if (__readfds != (fd_set *)0x0) {
      free(__readfds);
    }
  }
  if (__writefds != (fd_set *)0x0) {
    free(__writefds);
  }
  return iVar6;
}



void websSocketCreateEvent(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int *piVar2;
  
  if ((-1 < param_1) && (param_1 <= socketLast)) {
    iVar1 = *(int *)(param_1 * 4 + socketList);
    if (iVar1 != 0) {
      *(undefined4 *)(iVar1 + 0x60) = param_2;
      *(undefined4 *)(iVar1 + 0x58) = param_3;
      *(undefined4 *)(iVar1 + 0x5c) = param_4;
      return;
    }
  }
  piVar2 = __errno_location();
  *piVar2 = 9;
  return;
}



void websSocketDeleteEvent(int param_1)

{
  int iVar1;
  int *piVar2;
  
  if (-1 < param_1) {
    if (param_1 <= socketLast) {
      iVar1 = *(int *)(param_1 * 4 + socketList);
      if (iVar1 != 0) {
        *(undefined4 *)(iVar1 + 0x60) = 0;
        *(undefined4 *)(iVar1 + 0x58) = 0;
        return;
      }
    }
  }
  piVar2 = __errno_location();
  *piVar2 = 9;
  return;
}



void websSocketFree(int param_1)

{
  int *piVar1;
  void *__ptr;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined auStack_110 [256];
  
  if (((param_1 < 0) || (socketLast < param_1)) ||
     (__ptr = (void *)socketList[param_1], __ptr == (void *)0x0)) {
    piVar1 = __errno_location();
    *piVar1 = 9;
  }
  else {
    *(undefined4 *)((int)__ptr + 0x60) = 0;
    if (-1 < *(int *)((int)__ptr + 0x70)) {
      websSocketSetBlock(param_1,0);
      iVar2 = shutdown(*(int *)((int)__ptr + 0x70),1);
      if (-1 < iVar2) {
        recv(*(int *)((int)__ptr + 0x70),auStack_110,0x100,0);
      }
      close(*(int *)((int)__ptr + 0x70));
    }
    socketLast = FreeEntryId(&socketList,param_1);
    memPoolClose(__ptr);
    memPoolClose((int)__ptr + 0x1c);
    memPoolClose((int)__ptr + 0x38);
    if (__ptr != (void *)0x0) {
      free(__ptr);
    }
    socketHighestFd = -1;
    if (-1 < socketLast) {
      iVar2 = socketLast + 1;
      piVar1 = socketList;
      do {
        iVar3 = *piVar1;
        iVar2 = iVar2 + -1;
        piVar1 = piVar1 + 1;
        iVar4 = socketHighestFd;
        if ((iVar3 != 0) && (iVar4 = *(int *)(iVar3 + 0x70), iVar4 < socketHighestFd)) {
          iVar4 = socketHighestFd;
        }
        socketHighestFd = iVar4;
      } while (iVar2 != 0);
      return;
    }
  }
  return;
}



undefined4 FUN_00418360(int param_1)

{
  char *pcVar1;
  int *piVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined auStack_40 [16];
  socklen_t local_30 [2];
  
  uVar4 = *(uint *)(param_1 + 0x74);
  iVar6 = *(int *)(param_1 + 100);
  if ((uVar4 >> 1 & 1) == 0) {
    uVar4 = uVar4 >> 2;
    if ((*(uint *)(param_1 + 0x60) >> 1 & 1) == 0) goto LAB_004183d4;
    if (((iVar6 < 0) || (socketLast < iVar6)) ||
       (iVar3 = *(int *)(iVar6 * 4 + socketList), iVar3 == 0)) {
      piVar2 = __errno_location();
      *piVar2 = 9;
    }
    else if ((*(uint *)(iVar3 + 0x6c) & 1) == 0) {
      iVar5 = memPoolLen(iVar3 + 0x38);
      iVar3 = memPoolLen(iVar3);
      if (0 < iVar5 + iVar3) {
        uVar4 = *(uint *)(param_1 + 0x74) | 2;
        *(uint *)(param_1 + 0x74) = uVar4;
        goto LAB_004183d0;
      }
    }
    uVar4 = *(uint *)(param_1 + 0x74) >> 2;
  }
  else {
    if ((*(uint *)(param_1 + 0x6c) >> 5 & 1) != 0) {
      local_30[0] = 0x10;
      iVar6 = accept(*(int *)(param_1 + 0x70),(sockaddr *)auStack_40,local_30);
      if (-1 < iVar6) {
        uVar9 = *(undefined4 *)(param_1 + 0x68);
        uVar8 = *(undefined4 *)(param_1 + 0x54);
        uVar4 = *(uint *)(param_1 + 0x6c);
        iVar3 = AllocEntry(&socketList,&socketLast,0x80);
        if (iVar3 < 0) {
          shutdown(iVar6,2);
          close(iVar6);
          *(undefined4 *)(param_1 + 0x74) = 0;
          return 1;
        }
        iVar5 = *(int *)(iVar3 * 4 + socketList);
        *(undefined4 *)(iVar5 + 0x78) = 0xffffffff;
        *(uint *)(iVar5 + 0x6c) = uVar4 & 0x30;
        *(undefined4 *)(iVar5 + 0x54) = uVar8;
        *(undefined4 *)(iVar5 + 0x68) = uVar9;
        *(int *)(iVar5 + 100) = iVar3;
        memPoolOpen(iVar5,0x800,0x800);
        memPoolOpen(iVar5 + 0x1c,0x800,0x800);
        memPoolOpen(iVar5 + 0x38,0x200,0);
        iVar7 = *(int *)(iVar3 * 4 + socketList);
        *(int *)(iVar7 + 0x70) = iVar6;
        *(uint *)(iVar7 + 0x6c) = *(uint *)(iVar7 + 0x6c) & 0xffffffdf;
        fcntl(iVar6,2,1);
        iVar5 = iVar6;
        if (iVar6 < socketHighestFd) {
          iVar5 = socketHighestFd;
        }
        socketLastAcceptFd = iVar6;
        socketHighestFd = iVar5;
        websSocketSetBlock(iVar3,*(uint *)(iVar7 + 0x6c) >> 4 & 1);
        if (*(int *)(param_1 + 0x54) != 0) {
          pcVar1 = inet_ntoa((in_addr)auStack_40._4_4_);
          iVar6 = (**(code **)(param_1 + 0x54))
                            (iVar3,pcVar1,
                             (uint)((ushort)auStack_40._2_2_ >> 8) |
                             ((ushort)auStack_40._2_2_ & 0xff) << 8,*(undefined4 *)(param_1 + 100));
          if (iVar6 < 0) {
            websSocketFree(iVar3);
          }
        }
      }
      *(undefined4 *)(param_1 + 0x74) = 0;
      return 1;
    }
LAB_004183d0:
    uVar4 = uVar4 >> 2;
  }
LAB_004183d4:
  if (((uVar4 & 1) != 0) && ((*(uint *)(param_1 + 0x6c) >> 3 & 1) != 0)) {
    iVar3 = memPoolLen(param_1 + 0x1c);
    if (iVar3 < 1) {
      *(uint *)(param_1 + 0x6c) = *(uint *)(param_1 + 0x6c) & 0xfffffff7;
    }
    else {
      websSocketFlush(*(undefined4 *)(param_1 + 100));
    }
  }
  if (((*(code **)(param_1 + 0x58) != (code *)0x0) &&
      (uVar4 = *(uint *)(param_1 + 0x60) & *(uint *)(param_1 + 0x74), uVar4 != 0)) &&
     (((**(code **)(param_1 + 0x58))(iVar6,uVar4,*(undefined4 *)(param_1 + 0x5c)), socketList != 0
      && ((iVar6 <= socketLast && (*(int *)(iVar6 * 4 + socketList) == param_1)))))) {
    *(undefined4 *)(param_1 + 0x74) = 0;
    return 1;
  }
  return 1;
}



void websSocketCloseConnection(int param_1)

{
  void *__ptr;
  int iVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  undefined auStack_110 [256];
  
  if (((param_1 < 0) || (socketLast < param_1)) || (socketList[param_1] == 0)) {
    piVar3 = __errno_location();
    *piVar3 = 9;
    return;
  }
  if (((param_1 < 0) || (socketLast < param_1)) ||
     (__ptr = (void *)socketList[param_1], __ptr == (void *)0x0)) {
    piVar3 = __errno_location();
    *piVar3 = 9;
  }
  else {
    *(undefined4 *)((int)__ptr + 0x60) = 0;
    if (-1 < *(int *)((int)__ptr + 0x70)) {
      websSocketSetBlock(param_1,0);
      iVar1 = shutdown(*(int *)((int)__ptr + 0x70),1);
      if (-1 < iVar1) {
        recv(*(int *)((int)__ptr + 0x70),auStack_110,0x100,0);
      }
      close(*(int *)((int)__ptr + 0x70));
    }
    socketLast = FreeEntryId(&socketList,param_1);
    memPoolClose(__ptr);
    memPoolClose((int)__ptr + 0x1c);
    memPoolClose((int)__ptr + 0x38);
    if (__ptr != (void *)0x0) {
      free(__ptr);
    }
    socketHighestFd = -1;
    if (-1 < socketLast) {
      iVar1 = socketLast + 1;
      piVar3 = socketList;
      do {
        iVar2 = *piVar3;
        iVar1 = iVar1 + -1;
        piVar3 = piVar3 + 1;
        iVar4 = socketHighestFd;
        if ((iVar2 != 0) && (iVar4 = *(int *)(iVar2 + 0x70), iVar4 < socketHighestFd)) {
          iVar4 = socketHighestFd;
        }
        socketHighestFd = iVar4;
      } while (iVar1 != 0);
      return;
    }
  }
  return;
}



void websSocketEventPoll(void)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  iVar5 = 0;
  if (-1 < socketLast) {
    do {
      iVar3 = *(int *)(iVar5 * 4 + socketList);
      if (iVar3 != 0) {
        if ((*(uint *)(iVar3 + 0x6c) >> 6 & 1) != 0) {
          if ((iVar5 < 0) || (socketLast < iVar5)) {
            piVar1 = __errno_location();
            *piVar1 = 9;
          }
          else {
            websSocketFree(iVar5);
          }
          break;
        }
        if ((*(uint *)(iVar3 + 0x74) & *(uint *)(iVar3 + 0x60)) != 0) goto LAB_004189b0;
        if ((*(uint *)(iVar3 + 0x60) >> 1 & 1) != 0) {
          if ((iVar5 < 0) || (socketLast < iVar5)) {
            piVar1 = __errno_location();
            *piVar1 = 9;
          }
          else if ((*(uint *)(iVar3 + 0x6c) & 1) == 0) {
            iVar6 = memPoolLen(iVar3 + 0x38);
            iVar3 = memPoolLen(iVar3);
            if (0 < iVar6 + iVar3) {
              websSocketSelect(iVar5,0);
              goto LAB_004189b0;
            }
          }
        }
      }
      iVar5 = iVar5 + 1;
    } while (iVar5 <= socketLast);
  }
  iVar5 = websSocketSelect(0xffffffff,1000);
  if (iVar5 != 0) {
LAB_004189b0:
    iVar5 = 0;
    if (-1 < socketLast) {
LAB_004189c8:
      do {
        iVar3 = *(int *)(iVar5 * 4 + socketList);
        if (iVar3 != 0) {
          iVar6 = iVar5;
          if (iVar5 < 0) {
            iVar6 = 0;
          }
          if (iVar6 <= socketLast) {
            while (iVar4 = *(int *)(iVar6 * 4 + socketList), iVar4 == 0) {
LAB_00418a90:
              iVar6 = iVar6 + 1;
              if ((iVar5 >= 0) || (socketLast < iVar6)) goto LAB_00418aac;
            }
            if ((*(uint *)(iVar4 + 0x6c) >> 6 & 1) == 0) {
              if ((*(uint *)(iVar4 + 0x74) & *(uint *)(iVar4 + 0x60)) == 0) {
                if ((*(uint *)(iVar4 + 0x60) >> 1 & 1) != 0) {
                  if ((iVar6 < 0) || (socketLast < iVar6)) {
                    piVar1 = __errno_location();
                    *piVar1 = 9;
                  }
                  else if ((*(uint *)(iVar4 + 0x6c) & 1) == 0) {
                    iVar2 = memPoolLen(iVar4 + 0x38);
                    iVar4 = memPoolLen(iVar4);
                    if (0 < iVar2 + iVar4) {
                      websSocketSelect(iVar6,0);
                      goto LAB_00418b50;
                    }
                  }
                }
                goto LAB_00418a90;
              }
LAB_00418b50:
              FUN_00418360(iVar3);
LAB_00418b6c:
              iVar5 = iVar5 + 1;
              if (socketLast < iVar5) {
                return;
              }
              goto LAB_004189c8;
            }
            if ((-1 < iVar6) && (iVar6 <= socketLast)) {
              websSocketFree(iVar6);
              goto LAB_00418b6c;
            }
            piVar1 = __errno_location();
            *piVar1 = 9;
          }
        }
LAB_00418aac:
        iVar5 = iVar5 + 1;
      } while (iVar5 <= socketLast);
    }
  }
  return;
}



void websSocketClose(void)

{
  int *piVar1;
  int iVar2;
  
  DAT_004d6098 = DAT_004d6098 + -1;
  if (0 < DAT_004d6098) {
    return;
  }
  websSSLClose();
  for (iVar2 = socketLast; -1 < iVar2; iVar2 = iVar2 + -1) {
    if ((socketList != 0) && (*(int *)(iVar2 * 4 + socketList) != 0)) {
      if ((iVar2 < 0) || (socketLast < iVar2)) {
        piVar1 = __errno_location();
        *piVar1 = 9;
      }
      else {
        websSocketFree(iVar2);
      }
    }
  }
  DAT_004d6098 = 0;
  return;
}



int websSocketOpenConnection(uint param_1,undefined4 param_2,uint param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  sockaddr local_38;
  undefined4 local_28 [2];
  
  if (((int)param_1 < 0x10000) && (iVar1 = AllocEntry(&socketList,&socketLast,0x80), -1 < iVar1)) {
    iVar2 = *(int *)(iVar1 * 4 + socketList);
    *(undefined4 *)(iVar2 + 0x78) = 0xffffffff;
    *(uint *)(iVar2 + 0x6c) = param_3 & 0x30;
    *(undefined4 *)(iVar2 + 0x54) = param_2;
    *(int *)(iVar2 + 100) = iVar1;
    *(uint *)(iVar2 + 0x68) = param_1;
    memPoolOpen(iVar2,0x800,0x800);
    memPoolOpen(iVar2 + 0x1c,0x800,0x800);
    memPoolOpen(iVar2 + 0x38,0x200,0);
    iVar3 = *(int *)(iVar1 * 4 + socketList);
    local_38.sa_data[6] = '\0';
    local_38.sa_data[7] = '\0';
    local_38.sa_data[8] = '\0';
    local_38.sa_data[9] = '\0';
    local_38.sa_data._0_2_ = (ushort)(param_1 >> 8) & 0xff | (ushort)((param_1 & 0xff) << 8);
    local_38.sa_family = 2;
    local_38.sa_data[10] = '\0';
    local_38.sa_data[11] = '\0';
    local_38.sa_data[12] = '\0';
    local_38.sa_data[13] = '\0';
    local_38.sa_data[2] = '\0';
    local_38.sa_data[3] = '\0';
    local_38.sa_data[4] = '\0';
    local_38.sa_data[5] = '\0';
    iVar2 = socket(2,2,0);
    *(int *)(iVar3 + 0x70) = iVar2;
    if (-1 < iVar2) {
      fcntl(iVar2,2,1);
      iVar2 = *(int *)(iVar3 + 0x70);
      if (*(int *)(iVar3 + 0x70) < socketHighestFd) {
        iVar2 = socketHighestFd;
      }
      local_28[0] = 1;
      socketHighestFd = iVar2;
      setsockopt(*(int *)(iVar3 + 0x70),0xffff,4,local_28,4);
      iVar2 = bind(*(int *)(iVar3 + 0x70),&local_38,0x10);
      if (-1 < iVar2) {
        iVar2 = listen(*(int *)(iVar3 + 0x70),0x80);
        if (-1 < iVar2) {
          *(uint *)(iVar3 + 0x60) = *(uint *)(iVar3 + 0x60) | 2;
          *(uint *)(iVar3 + 0x6c) = *(uint *)(iVar3 + 0x6c) | 0x20;
          websSocketSetBlock(iVar1,(param_3 >> 4 & 1) != 0);
          return iVar1;
        }
      }
    }
    websSocketFree(iVar1);
  }
  return -1;
}



undefined4 websSocketGetPort(int param_1)

{
  int *piVar1;
  int iVar2;
  
  if (-1 < param_1) {
    if (param_1 <= socketLast) {
      iVar2 = *(int *)(param_1 * 4 + socketList);
      if (iVar2 != 0) {
        return *(undefined4 *)(iVar2 + 0x68);
      }
    }
  }
  piVar1 = __errno_location();
  *piVar1 = 9;
  return 0xffffffff;
}



void * mmalloc(size_t param_1)

{
  void *__s;
  int iVar1;
  
  iVar1 = 5;
  do {
    __s = malloc(param_1);
    if (__s == (void *)0x0) {
      trace(0x10,"mmalloc:allocate error(%d,%d)!\n",param_1,iVar1);
    }
    else if (__s != (void *)0x0) {
      memset(__s,0,param_1);
      return __s;
    }
    iVar1 = iVar1 + -1;
  } while (0 < iVar1);
  return __s;
}



int AllocEntryId(int **param_1)

{
  int *__s;
  void *pvVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  __s = *param_1 + -3;
  if (*param_1 == (int *)0x0) {
    iVar5 = 5;
    do {
      __s = (int *)malloc(0x4c);
      if (__s == (int *)0x0) {
        trace(0x10,"mmalloc:allocate error(%d,%d)!\n",0x4c,iVar5);
      }
      else if (__s != (int *)0x0) {
        memset(__s,0,0x4c);
        break;
      }
      iVar5 = iVar5 + -1;
    } while (0 < iVar5);
    if (__s == (int *)0x0) {
      return -1;
    }
    *__s = 0x6678;
    __s[1] = 0x10;
    __s[2] = 0;
    *param_1 = __s + 3;
  }
  if (*__s == 0x6678) {
    iVar3 = __s[1];
    iVar4 = iVar3;
    if ((__s[2] < iVar3) && (iVar4 = 0, 0 < iVar3)) {
      iVar5 = __s[3];
      piVar2 = __s + 4;
      while( true ) {
        if (iVar5 == 0) {
          __s[2] = __s[2] + 1;
          return iVar4;
        }
        iVar4 = iVar4 + 1;
        if (iVar3 <= iVar4) break;
        iVar5 = *piVar2;
        piVar2 = piVar2 + 1;
      }
    }
    iVar5 = -1;
    if (iVar3 < 0x40) {
      pvVar1 = realloc(__s,(iVar3 + 0x10) * 4 + 0xc);
      iVar5 = -1;
      if (pvVar1 != (void *)0x0) {
        *(int *)((int)pvVar1 + 4) = iVar3 + 0x10;
        *param_1 = (int *)((int)pvVar1 + 0xc);
        memset((int *)((int)pvVar1 + 0xc) + iVar3,0,0x40);
        *(int *)((int)pvVar1 + 8) = *(int *)((int)pvVar1 + 8) + 1;
        iVar5 = iVar4;
      }
    }
  }
  else {
    trace(0x10,"Entry magic error(%s)!\n","AllocEntry");
    iVar5 = -1;
  }
  return iVar5;
}



int FreeEntryId(int *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  iVar3 = *param_1;
  iVar1 = -1;
  if (iVar3 != 0) {
    if (*(int *)(iVar3 + -0xc) == 0x6678) {
      *(undefined4 *)(param_2 * 4 + iVar3) = 0;
      iVar1 = *(int *)(iVar3 + -4) + -1;
      *(int *)(iVar3 + -4) = iVar1;
      if (iVar1 == 0) {
        free((void *)(iVar3 + -0xc));
        *param_1 = 0;
      }
      iVar1 = -1;
      if ((*param_1 != 0) && (iVar1 = *(int *)(iVar3 + -8), *(int *)(iVar3 + -4) < iVar1)) {
        iVar1 = iVar1 + -1;
        if (-1 < iVar1) {
          piVar2 = (int *)(iVar1 * 4 + iVar3);
          do {
            iVar3 = *piVar2;
            piVar2 = piVar2 + -1;
            if (iVar3 != 0) {
              return iVar1;
            }
            iVar1 = iVar1 + -1;
          } while (-1 < iVar1);
        }
      }
    }
    else {
      trace(0x10,"Entry magic error(%s)!\n","FreeEntry",param_4,&_gp);
      iVar1 = -1;
    }
  }
  return iVar1;
}



int AllocEntry(int *param_1,int *param_2,size_t param_3)

{
  int iVar1;
  void *__s;
  int *piVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = -1;
  if (0 < (int)param_3) {
    iVar1 = AllocEntryId();
    iVar4 = -1;
    if (-1 < iVar1) {
      iVar4 = 5;
      do {
        __s = malloc(param_3);
        if (__s == (void *)0x0) {
          trace(0x10,"mmalloc:allocate error(%d,%d)!\n",param_3,iVar4);
        }
        else if (__s != (void *)0x0) {
          memset(__s,0,param_3);
          break;
        }
        iVar4 = iVar4 + -1;
      } while (0 < iVar4);
      if (__s == (void *)0x0) {
        iVar3 = *param_1;
        iVar4 = -1;
        if (iVar3 != 0) {
          if (*(int *)(iVar3 + -0xc) == 0x6678) {
            *(undefined4 *)(iVar1 * 4 + iVar3) = 0;
            iVar4 = *(int *)(iVar3 + -4) + -1;
            *(int *)(iVar3 + -4) = iVar4;
            if (iVar4 == 0) {
              free((void *)(iVar3 + -0xc));
              *param_1 = 0;
            }
            iVar4 = -1;
            if (((*param_1 != 0) &&
                (iVar1 = *(int *)(iVar3 + -8) + -1, *(int *)(iVar3 + -4) < *(int *)(iVar3 + -8))) &&
               (-1 < iVar1)) {
              piVar2 = (int *)(iVar1 * 4 + iVar3);
              do {
                iVar4 = *piVar2;
                iVar1 = iVar1 + -1;
                piVar2 = piVar2 + -1;
                if (iVar4 != 0) goto LAB_0041967c;
              } while (-1 < iVar1);
              iVar4 = -1;
            }
          }
          else {
            trace(0x10,"Entry magic error(%s)!\n","FreeEntry");
LAB_0041967c:
            iVar4 = -1;
          }
        }
      }
      else {
        memset(__s,0,param_3);
        *(void **)(iVar1 * 4 + *param_1) = __s;
        iVar4 = iVar1;
        if (*param_2 < iVar1) {
          *param_2 = iVar1;
        }
      }
    }
  }
  return iVar4;
}



int memPoolLen(int *param_1)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  
  uVar3 = param_1[4];
  uVar1 = param_1[5];
  iVar2 = uVar1 - uVar3;
  if (uVar1 < uVar3) {
    iVar2 = (uVar1 + *param_1) - uVar3;
  }
  return iVar2;
}



undefined4 memPoolOpen(size_t *param_1,int param_2,size_t param_3)

{
  bool bVar1;
  undefined *__s;
  undefined4 uVar2;
  size_t __size;
  int iVar3;
  
  __size = 0x100;
  bVar1 = 0x100 < param_2;
  while (iVar3 = 5, bVar1) {
    __size = __size << 1;
    bVar1 = (int)__size < param_2;
  }
  do {
    __s = (undefined *)malloc(__size);
    if (__s == (undefined *)0x0) {
      trace(0x10,"mmalloc:allocate error(%d,%d)!\n",__size,iVar3);
    }
    else if (__s != (undefined *)0x0) {
      memset(__s,0,__size);
      param_1[3] = (size_t)__s;
      goto LAB_004197e0;
    }
    iVar3 = iVar3 + -1;
  } while (0 < iVar3);
  param_1[3] = (size_t)__s;
LAB_004197e0:
  uVar2 = 0xffffffff;
  if (__s != (undefined *)0x0) {
    param_1[6] = (size_t)(__s + __size);
    param_1[1] = param_3;
    uVar2 = 0;
    *__s = 0;
    *param_1 = __size;
    param_1[2] = __size;
    param_1[4] = (size_t)__s;
    param_1[5] = (size_t)__s;
  }
  return uVar2;
}



void memPoolFlush(int param_1)

{
  undefined *puVar1;
  
  puVar1 = *(undefined **)(param_1 + 0xc);
  *(undefined **)(param_1 + 0x14) = puVar1;
  *(undefined **)(param_1 + 0x10) = puVar1;
  if (puVar1 != (undefined *)0x0) {
    *puVar1 = 0;
  }
  return;
}



void memPoolClose(int param_1)

{
  undefined *__ptr;
  
  if (param_1 != 0) {
    __ptr = *(undefined **)(param_1 + 0xc);
    *(undefined **)(param_1 + 0x10) = __ptr;
    *(undefined **)(param_1 + 0x14) = __ptr;
    if (__ptr != (undefined *)0x0) {
      *__ptr = 0;
      __ptr = *(undefined **)(param_1 + 0xc);
    }
    free(__ptr);
    *(undefined4 *)(param_1 + 0xc) = 0;
  }
  return;
}



int memPoolPutMaxBlockSize(int *param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  
  uVar3 = param_1[4];
  uVar2 = param_1[5];
  if (uVar2 < uVar3) {
    iVar1 = *param_1;
    iVar4 = (uVar2 + iVar1) - uVar3;
  }
  else {
    iVar1 = *param_1;
    iVar4 = uVar2 - uVar3;
  }
  iVar1 = (iVar1 - iVar4) + -1;
  if ((int)(param_1[6] - uVar2) < iVar1) {
    iVar1 = param_1[6] - uVar2;
  }
  return iVar1;
}



int memPoolGetMaxBlockSize(int *param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  
  uVar1 = param_1[5];
  uVar2 = param_1[4];
  iVar3 = uVar1 - uVar2;
  if (uVar1 < uVar2) {
    iVar3 = (uVar1 + *param_1) - uVar2;
  }
  if ((int)(param_1[6] - uVar2) < iVar3) {
    iVar3 = param_1[6] - uVar2;
  }
  return iVar3;
}



undefined4 FUN_004199a0(int *param_1)

{
  bool bVar1;
  void *__s;
  undefined4 uVar2;
  int iVar3;
  void *pvVar4;
  void *__src;
  size_t __n;
  void *pvVar5;
  size_t sVar6;
  size_t sVar7;
  void *__dest;
  
  if (param_1[1] < 1) {
    iVar3 = *param_1;
  }
  else {
    iVar3 = *param_1;
    if (param_1[1] <= iVar3) {
      return 0;
    }
  }
  sVar6 = iVar3 + param_1[2];
  iVar3 = 5;
  do {
    __s = malloc(sVar6);
    if (__s == (void *)0x0) {
      trace(0x10,"mmalloc:allocate error(%d,%d)!\n",sVar6,iVar3);
    }
    else if (__s != (void *)0x0) {
      memset(__s,0,sVar6);
      break;
    }
    iVar3 = iVar3 + -1;
  } while (0 < iVar3);
  uVar2 = 0;
  if (__s != (void *)0x0) {
    __src = (void *)param_1[4];
    pvVar4 = (void *)param_1[5];
    iVar3 = -(int)__src;
    if (pvVar4 < __src) {
      iVar3 = *param_1 - (int)__src;
    }
    sVar6 = (int)pvVar4 + iVar3;
    if (0 < (int)sVar6) {
      pvVar5 = (void *)param_1[6];
      bVar1 = pvVar4 < __src;
      sVar7 = sVar6;
      __dest = __s;
      while( true ) {
        iVar3 = -(int)__src;
        if (bVar1) {
          iVar3 = *param_1 - (int)__src;
        }
        __n = (int)pvVar4 + iVar3;
        if ((int)pvVar5 - (int)__src < (int)pvVar4 + iVar3) {
          __n = (int)pvVar5 - (int)__src;
        }
        if ((int)sVar7 < (int)__n) {
          __n = sVar7;
        }
        if ((int)__n < 1) break;
        memcpy(__dest,__src,__n);
        pvVar5 = (void *)param_1[6];
        __src = (void *)(param_1[4] + __n);
        sVar7 = sVar7 - __n;
        __dest = (void *)((int)__dest + __n);
        if (pvVar5 <= __src) {
          __src = (void *)param_1[3];
        }
        param_1[4] = (int)__src;
        if ((int)sVar7 < 1) break;
        pvVar4 = (void *)param_1[5];
        bVar1 = pvVar4 < __src;
      }
    }
    free((void *)param_1[3]);
    param_1[6] = (int)__s + *param_1 + param_1[2];
    param_1[5] = (int)__s + sVar6;
    *param_1 = *param_1 + param_1[2];
    param_1[3] = (int)__s;
    param_1[4] = (int)__s;
    uVar2 = 1;
  }
  return uVar2;
}



int memPoolPutBlock(int *param_1,void *param_2,size_t param_3)

{
  size_t __n;
  void *__dest;
  int iVar1;
  size_t sVar2;
  int iVar3;
  void *pvVar4;
  int iVar5;
  void *pvVar6;
  int iVar7;
  
  iVar7 = 0;
  if (0 < (int)param_3) {
    __dest = (void *)param_1[5];
    pvVar6 = (void *)param_1[6];
    do {
      pvVar4 = (void *)param_1[4];
      if (__dest < pvVar4) {
        iVar5 = *param_1;
        iVar1 = iVar5 - (int)pvVar4;
      }
      else {
        iVar5 = *param_1;
        iVar1 = -(int)pvVar4;
      }
      iVar1 = (iVar5 - ((int)__dest + iVar1)) + -1;
      if ((int)pvVar6 - (int)__dest < iVar1) {
        iVar1 = (int)pvVar6 - (int)__dest;
      }
      __n = param_3;
      if (iVar1 < (int)param_3) {
        iVar1 = -(int)pvVar4;
        if (__dest < pvVar4) {
          iVar1 = iVar5 - (int)pvVar4;
        }
        __n = (iVar5 - ((int)__dest + iVar1)) - 1;
        if ((int)pvVar6 - (int)__dest < (int)__n) {
          __n = (int)pvVar6 - (int)__dest;
        }
      }
      if ((int)__n < 1) {
        iVar1 = FUN_004199a0(param_1);
        if (iVar1 == 0) {
          return iVar7;
        }
        pvVar6 = (void *)param_1[4];
        __dest = (void *)param_1[5];
        if (__dest < pvVar6) {
          iVar5 = *param_1;
          iVar1 = iVar5 - (int)pvVar6;
        }
        else {
          iVar5 = *param_1;
          iVar1 = -(int)pvVar6;
        }
        iVar1 = (iVar5 - ((int)__dest + iVar1)) + -1;
        iVar3 = param_1[6] - (int)__dest;
        if (iVar3 < iVar1) {
          iVar1 = iVar3;
        }
        __n = param_3;
        if (iVar1 < (int)param_3) {
          iVar1 = -(int)pvVar6;
          if (__dest < pvVar6) {
            iVar1 = iVar5 - (int)pvVar6;
          }
          sVar2 = param_1[6] - (int)__dest;
          __n = (iVar5 - ((int)__dest + iVar1)) - 1;
          if ((int)sVar2 < (int)__n) {
            __n = sVar2;
          }
        }
      }
      memcpy(__dest,param_2,__n);
      pvVar6 = (void *)param_1[6];
      __dest = (void *)(param_1[5] + __n);
      iVar7 = iVar7 + __n;
      param_2 = (void *)((int)param_2 + __n);
      param_3 = param_3 - __n;
      if (__dest < pvVar6) {
        param_1[5] = (int)__dest;
      }
      else {
        __dest = (void *)param_1[3];
        param_1[5] = (int)__dest;
      }
    } while (0 < (int)param_3);
  }
  return iVar7;
}



undefined4 memPoolPutChar(int *param_1,undefined param_2)

{
  int iVar1;
  uint uVar2;
  undefined *puVar3;
  int iVar4;
  uint uVar5;
  
  uVar5 = param_1[4];
  uVar2 = param_1[5];
  if (uVar2 < uVar5) {
    iVar1 = *param_1;
    iVar4 = (uVar2 + iVar1) - uVar5;
  }
  else {
    iVar1 = *param_1;
    iVar4 = uVar2 - uVar5;
  }
  puVar3 = (undefined *)param_1[5];
  iVar1 = (iVar1 - iVar4) + -1;
  if (param_1[6] - (int)puVar3 < iVar1) {
    iVar1 = param_1[6] - (int)puVar3;
  }
  if (iVar1 < 1) {
    iVar1 = FUN_004199a0(param_1);
    if (iVar1 == 0) {
      return 0xffffffff;
    }
    puVar3 = (undefined *)param_1[5];
    *puVar3 = param_2;
  }
  else {
    *puVar3 = param_2;
  }
  if (puVar3 + 1 < (undefined *)param_1[6]) {
    param_1[5] = (int)(puVar3 + 1);
  }
  else {
    param_1[5] = param_1[3];
  }
  return 0;
}



void memPoolPutBlockPtrAdj(int *param_1,int param_2)

{
  undefined *puVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = param_1[6];
  uVar2 = param_1[5] + param_2;
  if (uVar3 <= uVar2) {
    uVar2 = uVar2 - *param_1;
  }
  param_1[5] = uVar2;
  if (uVar3 <= uVar2) {
    trace(0x10,"Bad endp pointer",uVar3,0,&_gp);
    puVar1 = (undefined *)param_1[3];
    param_1[5] = (int)puVar1;
    param_1[4] = (int)puVar1;
    if (puVar1 != (undefined *)0x0) {
      *puVar1 = 0;
      return;
    }
  }
  return;
}



void memPoolGetBlockPtrAdj(int *param_1,int param_2)

{
  undefined *puVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = param_1[6];
  uVar2 = param_1[4] + param_2;
  if (uVar3 <= uVar2) {
    uVar2 = uVar2 - *param_1;
  }
  param_1[4] = uVar2;
  if (uVar3 <= uVar2) {
    trace(0x10,"Bad startp pointer",uVar3,0,&_gp);
    puVar1 = (undefined *)param_1[3];
    param_1[5] = (int)puVar1;
    param_1[4] = (int)puVar1;
    if (puVar1 != (undefined *)0x0) {
      *puVar1 = 0;
      return;
    }
  }
  return;
}



void * memsearch(void *param_1,uint param_2,undefined *param_3,uint param_4)

{
  undefined uVar1;
  void *__s1;
  int iVar2;
  void *__s;
  int iVar3;
  
  if (param_4 <= param_2) {
    uVar1 = *param_3;
    iVar3 = 0;
    __s = param_1;
    do {
      __s1 = memchr(__s,(int)uVar1,param_2 - iVar3);
      if (__s1 == (void *)0x0) {
        return (void *)0x0;
      }
      iVar2 = memcmp(__s1,param_3,param_4);
      __s = (void *)((int)__s1 + 1);
      iVar3 = (int)__s - (int)param_1;
      if (iVar2 == 0) {
        return __s1;
      }
    } while (param_4 <= param_2 - iVar3);
  }
  return (void *)0x0;
}



int findStrInFile(char *param_1,int param_2,undefined *param_3,uint param_4)

{
  undefined uVar1;
  FILE *__stream;
  size_t sVar2;
  void *__s1;
  int iVar3;
  undefined *__s;
  int iVar4;
  int iVar5;
  undefined auStack_428 [1024];
  
  iVar5 = 0;
  if ((((int)param_4 < 0x201) && (-1 < param_2)) &&
     (__stream = fopen(param_1,"rb"), __stream != (FILE *)0x0)) {
    rewind(__stream);
    fseek(__stream,param_2,0);
    sVar2 = fread(auStack_428,1,0x400,__stream);
    if (sVar2 != 0) {
      do {
        if (param_4 <= sVar2) {
          uVar1 = *param_3;
          iVar4 = 0;
          __s = auStack_428;
          do {
            __s1 = memchr(__s,(int)uVar1,sVar2 - iVar4);
            if (__s1 == (void *)0x0) break;
            iVar3 = memcmp(__s1,param_3,param_4);
            __s = (undefined *)((int)__s1 + 1);
            iVar4 = (int)__s - (int)auStack_428;
            if (iVar3 == 0) {
              fclose(__stream);
              return (int)__s1 + param_2 + (iVar5 - (int)auStack_428);
            }
          } while (param_4 <= sVar2 - iVar4);
        }
        if (sVar2 != 0x400) break;
        rewind(__stream);
        iVar5 = iVar5 + 0x200;
        fseek(__stream,param_2 + iVar5,0);
        sVar2 = fread(auStack_428,1,0x400,__stream);
      } while (sVar2 != 0);
    }
    fclose(__stream);
  }
  return -1;
}



void * getMemInFile(char *param_1,long param_2,size_t param_3)

{
  FILE *__stream;
  void *__s;
  int iVar1;
  size_t sVar2;
  
  __stream = fopen(param_1,"r");
  sVar2 = param_3 + 1;
  __s = (void *)0x0;
  if (__stream != (FILE *)0x0) {
    fseek(__stream,param_2,0);
    iVar1 = 5;
    do {
      __s = malloc(sVar2);
      if (__s == (void *)0x0) {
        trace(0x10,"mmalloc:allocate error(%d,%d)!\n",sVar2,iVar1);
      }
      else if (__s != (void *)0x0) {
        memset(__s,0,sVar2);
        break;
      }
      iVar1 = iVar1 + -1;
    } while (0 < iVar1);
    if ((__s != (void *)0x0) && (sVar2 = fread(__s,1,param_3,__stream), sVar2 != param_3)) {
      free(__s);
      __s = (void *)0x0;
    }
    fclose(__stream);
  }
  return __s;
}



void FUN_0041a47c(int *param_1,int param_2)

{
  uint uVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  int *piVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  int local_70 [4];
  int local_60;
  int local_5c;
  int local_58;
  int local_54;
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  int local_40;
  int local_3c;
  int local_38;
  int local_34;
  int local_2c;
  
  local_2c = *param_1;
  uVar12 = param_1[1];
  uVar11 = param_1[2];
  uVar10 = param_1[3];
  uVar1 = 0;
  piVar2 = local_70;
  do {
    piVar7 = (int *)(param_2 + uVar1);
    uVar1 = uVar1 + 4;
    *piVar2 = *piVar7;
    piVar2 = piVar2 + 1;
  } while (uVar1 < 0x40);
  uVar1 = (uVar12 & uVar11 | ~uVar12 & uVar10) + local_70[0] + local_2c + 0xd76aa478;
  uVar1 = (uVar1 * 0x80 | uVar1 >> 0x19) + uVar12;
  uVar8 = (uVar1 & uVar12 | ~uVar1 & uVar11) + local_70[1] + uVar10 + 0xe8c7b756;
  uVar9 = (uVar8 * 0x1000 | uVar8 >> 0x14) + uVar1;
  uVar8 = (uVar9 & uVar1 | ~uVar9 & uVar12) + local_70[2] + uVar11 + 0x242070db;
  uVar4 = (uVar8 * 0x20000 | uVar8 >> 0xf) + uVar9;
  uVar8 = (uVar4 & uVar9 | ~uVar4 & uVar1) + local_70[3] + uVar12 + 0xc1bdceee;
  uVar8 = (uVar8 * 0x400000 | uVar8 >> 10) + uVar4;
  uVar1 = (uVar8 & uVar4 | ~uVar8 & uVar9) + local_60 + uVar1 + 0xf57c0faf;
  uVar1 = (uVar1 * 0x80 | uVar1 >> 0x19) + uVar8;
  uVar9 = (uVar1 & uVar8 | ~uVar1 & uVar4) + local_5c + uVar9 + 0x4787c62a;
  uVar9 = (uVar9 * 0x1000 | uVar9 >> 0x14) + uVar1;
  uVar4 = (uVar9 & uVar1 | ~uVar9 & uVar8) + local_58 + uVar4 + 0xa8304613;
  uVar6 = (uVar4 * 0x20000 | uVar4 >> 0xf) + uVar9;
  uVar8 = (uVar6 & uVar9 | ~uVar6 & uVar1) + local_54 + uVar8 + 0xfd469501;
  uVar8 = (uVar8 * 0x400000 | uVar8 >> 10) + uVar6;
  uVar1 = (uVar8 & uVar6 | ~uVar8 & uVar9) + local_50 + uVar1 + 0x698098d8;
  uVar5 = (uVar1 * 0x80 | uVar1 >> 0x19) + uVar8;
  uVar1 = (uVar5 & uVar8 | ~uVar5 & uVar6) + local_4c + uVar9 + 0x8b44f7af;
  uVar4 = (uVar1 * 0x1000 | uVar1 >> 0x14) + uVar5;
  uVar1 = ((uVar4 & uVar5 | ~uVar4 & uVar8) + local_48 + uVar6) - 0xa44f;
  uVar1 = (uVar1 * 0x20000 | uVar1 >> 0xf) + uVar4;
  uVar8 = (uVar1 & uVar4 | ~uVar1 & uVar5) + local_44 + uVar8 + 0x895cd7be;
  uVar8 = (uVar8 * 0x400000 | uVar8 >> 10) + uVar1;
  uVar9 = (uVar8 & uVar1 | ~uVar8 & uVar4) + local_40 + uVar5 + 0x6b901122;
  uVar5 = (uVar9 * 0x80 | uVar9 >> 0x19) + uVar8;
  uVar9 = (uVar5 & uVar8 | ~uVar5 & uVar1) + local_3c + uVar4 + 0xfd987193;
  uVar9 = (uVar9 * 0x1000 | uVar9 >> 0x14) + uVar5;
  uVar1 = (uVar9 & uVar5 | ~uVar9 & uVar8) + local_38 + uVar1 + 0xa679438e;
  uVar4 = (uVar1 * 0x20000 | uVar1 >> 0xf) + uVar9;
  uVar1 = (uVar4 & uVar9 | ~uVar4 & uVar5) + local_34 + uVar8 + 0x49b40821;
  uVar1 = (uVar1 * 0x400000 | uVar1 >> 10) + uVar4;
  uVar8 = (uVar1 & uVar9 | ~uVar9 & uVar4) + local_70[1] + uVar5 + 0xf61e2562;
  uVar8 = (uVar8 * 0x20 | uVar8 >> 0x1b) + uVar1;
  uVar9 = (uVar8 & uVar4 | ~uVar4 & uVar1) + local_58 + uVar9 + 0xc040b340;
  uVar5 = (uVar9 * 0x200 | uVar9 >> 0x17) + uVar8;
  uVar9 = (uVar5 & uVar1 | ~uVar1 & uVar8) + local_44 + uVar4 + 0x265e5a51;
  uVar4 = (uVar9 * 0x4000 | uVar9 >> 0x12) + uVar5;
  uVar1 = (uVar4 & uVar8 | ~uVar8 & uVar5) + local_70[0] + uVar1 + 0xe9b6c7aa;
  uVar9 = (uVar1 * 0x100000 | uVar1 >> 0xc) + uVar4;
  uVar1 = (uVar9 & uVar5 | ~uVar5 & uVar4) + local_5c + uVar8 + 0xd62f105d;
  uVar1 = (uVar1 * 0x20 | uVar1 >> 0x1b) + uVar9;
  uVar8 = (uVar1 & uVar4 | ~uVar4 & uVar9) + local_48 + uVar5 + 0x2441453;
  uVar8 = (uVar8 * 0x200 | uVar8 >> 0x17) + uVar1;
  uVar4 = (uVar8 & uVar9 | ~uVar9 & uVar1) + local_34 + uVar4 + 0xd8a1e681;
  uVar4 = (uVar4 * 0x4000 | uVar4 >> 0x12) + uVar8;
  uVar9 = (uVar4 & uVar1 | ~uVar1 & uVar8) + local_60 + uVar9 + 0xe7d3fbc8;
  uVar9 = (uVar9 * 0x100000 | uVar9 >> 0xc) + uVar4;
  uVar1 = (uVar9 & uVar8 | ~uVar8 & uVar4) + local_4c + uVar1 + 0x21e1cde6;
  uVar5 = (uVar1 * 0x20 | uVar1 >> 0x1b) + uVar9;
  uVar1 = (uVar5 & uVar4 | ~uVar4 & uVar9) + local_38 + uVar8 + 0xc33707d6;
  uVar1 = (uVar1 * 0x200 | uVar1 >> 0x17) + uVar5;
  uVar8 = (uVar1 & uVar9 | ~uVar9 & uVar5) + local_70[3] + uVar4 + 0xf4d50d87;
  uVar8 = (uVar8 * 0x4000 | uVar8 >> 0x12) + uVar1;
  uVar9 = (uVar8 & uVar5 | ~uVar5 & uVar1) + local_50 + uVar9 + 0x455a14ed;
  uVar6 = (uVar9 * 0x100000 | uVar9 >> 0xc) + uVar8;
  uVar9 = (uVar6 & uVar1 | ~uVar1 & uVar8) + local_3c + uVar5 + 0xa9e3e905;
  uVar9 = (uVar9 * 0x20 | uVar9 >> 0x1b) + uVar6;
  uVar1 = (uVar9 & uVar8 | ~uVar8 & uVar6) + local_70[2] + uVar1 + 0xfcefa3f8;
  uVar4 = (uVar1 * 0x200 | uVar1 >> 0x17) + uVar9;
  uVar1 = (uVar4 & uVar6 | ~uVar6 & uVar9) + local_54 + uVar8 + 0x676f02d9;
  uVar5 = (uVar1 * 0x4000 | uVar1 >> 0x12) + uVar4;
  uVar1 = (uVar5 & uVar9 | ~uVar9 & uVar4) + local_40 + uVar6 + 0x8d2a4c8a;
  uVar1 = (uVar1 * 0x100000 | uVar1 >> 0xc) + uVar5;
  uVar8 = ((uVar1 ^ uVar5 ^ uVar4) + local_5c + uVar9) - 0x5c6be;
  uVar8 = (uVar8 * 0x10 | uVar8 >> 0x1c) + uVar1;
  uVar9 = (uVar8 ^ uVar1 ^ uVar5) + local_50 + uVar4 + 0x8771f681;
  uVar9 = (uVar9 * 0x800 | uVar9 >> 0x15) + uVar8;
  uVar4 = (uVar9 ^ uVar8 ^ uVar1) + local_44 + uVar5 + 0x6d9d6122;
  uVar4 = (uVar4 * 0x10000 | uVar4 >> 0x10) + uVar9;
  uVar1 = (uVar4 ^ uVar9 ^ uVar8) + local_38 + uVar1 + 0xfde5380c;
  uVar5 = (uVar1 * 0x800000 | uVar1 >> 9) + uVar4;
  uVar1 = (uVar5 ^ uVar4 ^ uVar9) + local_70[1] + uVar8 + 0xa4beea44;
  uVar1 = (uVar1 * 0x10 | uVar1 >> 0x1c) + uVar5;
  uVar8 = (uVar1 ^ uVar5 ^ uVar4) + local_60 + uVar9 + 0x4bdecfa9;
  uVar8 = (uVar8 * 0x800 | uVar8 >> 0x15) + uVar1;
  uVar9 = (uVar8 ^ uVar1 ^ uVar5) + local_54 + uVar4 + 0xf6bb4b60;
  uVar9 = (uVar9 * 0x10000 | uVar9 >> 0x10) + uVar8;
  uVar4 = (uVar9 ^ uVar8 ^ uVar1) + local_48 + uVar5 + 0xbebfbc70;
  uVar4 = (uVar4 * 0x800000 | uVar4 >> 9) + uVar9;
  uVar1 = (uVar4 ^ uVar9 ^ uVar8) + local_3c + uVar1 + 0x289b7ec6;
  uVar5 = (uVar1 * 0x10 | uVar1 >> 0x1c) + uVar4;
  uVar1 = (uVar5 ^ uVar4 ^ uVar9) + local_70[0] + uVar8 + 0xeaa127fa;
  uVar1 = (uVar1 * 0x800 | uVar1 >> 0x15) + uVar5;
  uVar8 = (uVar1 ^ uVar5 ^ uVar4) + local_70[3] + uVar9 + 0xd4ef3085;
  uVar8 = (uVar8 * 0x10000 | uVar8 >> 0x10) + uVar1;
  uVar9 = (uVar8 ^ uVar1 ^ uVar5) + local_58 + uVar4 + 0x4881d05;
  uVar9 = (uVar9 * 0x800000 | uVar9 >> 9) + uVar8;
  uVar4 = (uVar9 ^ uVar8 ^ uVar1) + local_4c + uVar5 + 0xd9d4d039;
  uVar4 = (uVar4 * 0x10 | uVar4 >> 0x1c) + uVar9;
  uVar1 = (uVar4 ^ uVar9 ^ uVar8) + local_40 + uVar1 + 0xe6db99e5;
  uVar5 = (uVar1 * 0x800 | uVar1 >> 0x15) + uVar4;
  uVar1 = (uVar5 ^ uVar4 ^ uVar9) + local_34 + uVar8 + 0x1fa27cf8;
  uVar6 = (uVar1 * 0x10000 | uVar1 >> 0x10) + uVar5;
  uVar1 = (uVar6 ^ uVar5 ^ uVar4) + local_70[2] + uVar9 + 0xc4ac5665;
  uVar3 = (uVar1 * 0x800000 | uVar1 >> 9) + uVar6;
  uVar1 = ((~uVar5 | uVar3) ^ uVar6) + local_70[0] + uVar4 + 0xf4292244;
  uVar1 = (uVar1 * 0x40 | uVar1 >> 0x1a) + uVar3;
  uVar8 = ((~uVar6 | uVar1) ^ uVar3) + local_54 + uVar5 + 0x432aff97;
  uVar8 = (uVar8 * 0x400 | uVar8 >> 0x16) + uVar1;
  uVar9 = ((~uVar3 | uVar8) ^ uVar1) + local_38 + uVar6 + 0xab9423a7;
  uVar9 = (uVar9 * 0x8000 | uVar9 >> 0x11) + uVar8;
  uVar4 = ((~uVar1 | uVar9) ^ uVar8) + local_5c + uVar3 + 0xfc93a039;
  uVar4 = (uVar4 * 0x200000 | uVar4 >> 0xb) + uVar9;
  uVar1 = ((~uVar8 | uVar4) ^ uVar9) + local_40 + uVar1 + 0x655b59c3;
  uVar1 = (uVar1 * 0x40 | uVar1 >> 0x1a) + uVar4;
  uVar8 = ((~uVar9 | uVar1) ^ uVar4) + local_70[3] + uVar8 + 0x8f0ccc92;
  uVar5 = (uVar8 * 0x400 | uVar8 >> 0x16) + uVar1;
  uVar8 = (((~uVar4 | uVar5) ^ uVar1) + local_48 + uVar9) - 0x100b83;
  uVar6 = (uVar8 * 0x8000 | uVar8 >> 0x11) + uVar5;
  uVar8 = ((~uVar1 | uVar6) ^ uVar5) + local_70[1] + uVar4 + 0x85845dd1;
  uVar8 = (uVar8 * 0x200000 | uVar8 >> 0xb) + uVar6;
  uVar1 = ((~uVar5 | uVar8) ^ uVar6) + local_50 + uVar1 + 0x6fa87e4f;
  uVar9 = (uVar1 * 0x40 | uVar1 >> 0x1a) + uVar8;
  uVar1 = ((~uVar6 | uVar9) ^ uVar8) + local_34 + uVar5 + 0xfe2ce6e0;
  uVar4 = (uVar1 * 0x400 | uVar1 >> 0x16) + uVar9;
  uVar1 = ((~uVar8 | uVar4) ^ uVar9) + local_58 + uVar6 + 0xa3014314;
  uVar5 = (uVar1 * 0x8000 | uVar1 >> 0x11) + uVar4;
  uVar1 = ((~uVar9 | uVar5) ^ uVar4) + local_3c + uVar8 + 0x4e0811a1;
  uVar8 = (uVar1 * 0x200000 | uVar1 >> 0xb) + uVar5;
  uVar1 = ((~uVar4 | uVar8) ^ uVar5) + local_60 + uVar9 + 0xf7537e82;
  uVar6 = (uVar1 * 0x40 | uVar1 >> 0x1a) + uVar8;
  uVar1 = ((~uVar5 | uVar6) ^ uVar8) + local_44 + uVar4 + 0xbd3af235;
  uVar9 = (uVar1 * 0x400 | uVar1 >> 0x16) + uVar6;
  uVar1 = ((~uVar8 | uVar9) ^ uVar6) + local_70[2] + uVar5 + 0x2ad7d2bb;
  uVar4 = (uVar1 * 0x8000 | uVar1 >> 0x11) + uVar9;
  uVar1 = ((~uVar6 | uVar4) ^ uVar9) + local_4c + uVar8 + 0xeb86d391;
  param_1[3] = uVar10 + uVar9;
  *param_1 = local_2c + uVar6;
  param_1[1] = uVar12 + (uVar1 * 0x200000 | uVar1 >> 0xb) + uVar4;
  param_1[2] = uVar11 + uVar4;
  memset(local_70,0,0x40);
  return;
}



void MD5Init(undefined4 *param_1)

{
  param_1[3] = 0x10325476;
  *param_1 = 0x67452301;
  param_1[1] = 0xefcdab89;
  param_1[2] = 0x98badcfe;
  param_1[5] = 0;
  param_1[4] = 0;
  return;
}



void MD5Update(int param_1,void *param_2,uint param_3)

{
  uint uVar1;
  void *__src;
  uint uVar2;
  
  uVar1 = *(uint *)(param_1 + 0x10) + param_3 * 8;
  uVar2 = *(uint *)(param_1 + 0x10) >> 3 & 0x3f;
  *(uint *)(param_1 + 0x10) = uVar1;
  if (uVar1 < param_3 * 8) {
    *(uint *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1 + (param_3 >> 0x1d);
  }
  else {
    *(uint *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + (param_3 >> 0x1d);
  }
  uVar1 = 0x40 - uVar2;
  if (param_3 < uVar1) {
                    // WARNING: Treating indirect jump as call
    memcpy((void *)(param_1 + uVar2 + 0x18),param_2,param_3);
    return;
  }
  memcpy((void *)(param_1 + uVar2 + 0x18),param_2,uVar1);
  __src = (void *)(param_1 + 0x18);
  while( true ) {
    FUN_0041a47c(param_1,__src);
    __src = (void *)((int)param_2 + uVar1);
    if (param_3 <= uVar1 + 0x3f) break;
    uVar1 = uVar1 + 0x40;
  }
                    // WARNING: Treating indirect jump as call
  memcpy((void *)(param_1 + 0x18),__src,param_3 - uVar1);
  return;
}



void MD5Final(undefined4 *param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  undefined4 local_38;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  
  puVar4 = param_2 + 4;
  uVar3 = 0;
  do {
    uVar2 = *puVar4;
    uVar5 = uVar3 + 4;
    *(char *)((int)&local_38 + uVar3 + 3) = (char)((uint)uVar2 >> 0x18);
    *(char *)((int)&local_38 + uVar3 + 1) = (char)((uint)uVar2 >> 8);
    *(char *)((int)&local_38 + uVar3 + 2) = (char)((uint)uVar2 >> 0x10);
    *(char *)((int)&local_38 + uVar3) = (char)uVar2;
    puVar4 = puVar4 + 1;
    uVar3 = uVar5;
  } while (uVar5 < 8);
  uVar3 = param_2[4];
  uVar5 = uVar3 >> 3 & 0x3f;
  iVar1 = 0x38;
  if (0x37 < uVar5) {
    iVar1 = 0x78;
  }
  uVar5 = iVar1 - uVar5;
  uVar6 = uVar3 + uVar5 * 8;
  uVar3 = uVar3 >> 3 & 0x3f;
  param_2[4] = uVar6;
  if (uVar6 < uVar5 * 8) {
    param_2[5] = param_2[5] + 1 + (uVar5 >> 0x1d);
  }
  else {
    param_2[5] = param_2[5] + (uVar5 >> 0x1d);
  }
  uVar6 = 0x40 - uVar3;
  if (uVar5 < uVar6) {
    memcpy((void *)((int)param_2 + uVar3 + 0x18),&DAT_004d609c,uVar5);
    uVar3 = param_2[4];
    uVar5 = uVar3 + 0x40;
    param_2[4] = uVar5;
  }
  else {
    memcpy((void *)((int)param_2 + uVar3 + 0x18),&DAT_004d609c,uVar6);
    puVar4 = param_2 + 6;
    while( true ) {
      FUN_0041a47c(param_2,puVar4);
      puVar4 = (undefined4 *)(&DAT_004d609c + uVar6);
      if (uVar5 <= uVar6 + 0x3f) break;
      uVar6 = uVar6 + 0x40;
    }
    memcpy(param_2 + 6,puVar4,uVar5 - uVar6);
    uVar3 = param_2[4];
    uVar5 = uVar3 + 0x40;
    param_2[4] = uVar5;
  }
  uVar3 = uVar3 >> 3 & 0x3f;
  if (uVar5 < 0x40) {
    param_2[5] = param_2[5] + 1;
  }
  else {
    param_2[5] = param_2[5];
  }
  uVar5 = 0x40 - uVar3;
  uVar6 = 0;
  if (uVar5 < 9) {
    memcpy((void *)((int)param_2 + uVar3 + 0x18),&local_38,uVar5);
    puVar4 = param_2 + 6;
    for (; FUN_0041a47c(param_2,puVar4), uVar5 + 0x3f < 8; uVar5 = uVar5 + 0x40) {
      puVar4 = (undefined4 *)((int)&local_38 + uVar5);
    }
    uVar3 = 0;
    uVar6 = uVar5;
  }
  memcpy((void *)((int)param_2 + uVar3 + 0x18),(void *)((int)&local_38 + uVar6),8 - uVar6);
  puVar4 = param_2;
  uVar3 = 0;
  do {
    uVar2 = *puVar4;
    uVar5 = uVar3 + 4;
    *(char *)((int)&local_30 + uVar3 + 3) = (char)((uint)uVar2 >> 0x18);
    *(char *)((int)&local_30 + uVar3 + 1) = (char)((uint)uVar2 >> 8);
    *(char *)((int)&local_30 + uVar3 + 2) = (char)((uint)uVar2 >> 0x10);
    *(char *)((int)&local_30 + uVar3) = (char)uVar2;
    puVar4 = puVar4 + 1;
    uVar3 = uVar5;
  } while (uVar5 < 0x10);
  memset(param_2,0,0x58);
  *param_1 = local_30;
  param_1[1] = local_2c;
  param_1[2] = local_28;
  param_1[3] = local_24;
  return;
}



void hmac_md5(void *param_1,uint param_2,undefined *param_3,uint param_4,void *param_5)

{
  bool bVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  uint uVar7;
  undefined4 local_178;
  undefined4 local_174;
  undefined4 local_170;
  undefined4 local_16c;
  uint local_168;
  int local_164;
  undefined auStack_160 [64];
  byte local_120 [64];
  undefined auStack_e0 [8];
  byte local_d8 [64];
  undefined auStack_98 [8];
  undefined auStack_90 [16];
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  int local_70;
  uint local_6c;
  undefined auStack_68 [64];
  
  if (0x40 < (int)param_4) {
    local_70 = param_4 << 3;
    local_6c = param_4 >> 0x1d;
    local_80 = 0x67452301;
    local_7c = 0xefcdab89;
    local_78 = 0x98badcfe;
    local_74 = 0x10325476;
    if (param_4 < 0x40) {
      memcpy(auStack_68,param_3,param_4);
      param_3 = auStack_90;
      MD5Final(param_3,&local_80);
      param_4 = 0x10;
    }
    else {
      memcpy(auStack_68,param_3,0x40);
      FUN_0041a47c(&local_80,auStack_68);
      bVar1 = 0x7f < param_4;
      iVar4 = 0x40;
      while (bVar1) {
        FUN_0041a47c(&local_80,param_3 + iVar4);
        bVar1 = iVar4 + 0x7fU < param_4;
        iVar4 = iVar4 + 0x40;
      }
      memcpy(auStack_68,param_3 + iVar4,param_4 - iVar4);
      param_3 = auStack_90;
      MD5Final(param_3,&local_80);
      param_4 = 0x10;
    }
  }
  memset(local_120,0,0x41);
  memset(local_d8,0,0x41);
  memcpy(local_120,param_3,param_4);
  memcpy(local_d8,param_3,param_4);
  iVar4 = 0;
  do {
    iVar5 = iVar4 + 1;
    local_d8[iVar4] = local_d8[iVar4] ^ 0x5c;
    local_120[iVar4] = local_120[iVar4] ^ 0x36;
    iVar4 = iVar5;
  } while (iVar5 < 0x40);
  local_174 = 0xefcdab89;
  local_170 = 0x98badcfe;
  local_16c = 0x10325476;
  local_168 = 0x200;
  local_178 = 0x67452301;
  local_164 = 0;
  memcpy(auStack_160,local_120,0x40);
  FUN_0041a47c(&local_178,auStack_160);
  memcpy(auStack_160,auStack_e0,0);
  uVar2 = local_168 + param_2 * 8;
  uVar3 = local_168 >> 3 & 0x3f;
  if (uVar2 < param_2 * 8) {
    local_164 = local_164 + 1;
  }
  uVar7 = -uVar3 + 0x40;
  local_164 = local_164 + (param_2 >> 0x1d);
  uVar6 = 0;
  local_168 = uVar2;
  if (uVar7 <= param_2) {
    memcpy(auStack_160 + uVar3,param_1,uVar7);
    FUN_0041a47c(&local_178,auStack_160);
    uVar2 = -uVar3;
    while (uVar6 = uVar7, uVar2 + 0x7f < param_2) {
      FUN_0041a47c(&local_178,(int)param_1 + uVar6);
      uVar7 = uVar6 + 0x40;
      uVar2 = uVar6;
    }
    uVar3 = 0;
  }
  memcpy(auStack_160 + uVar3,(void *)((int)param_1 + uVar6),param_2 - uVar6);
  MD5Final(param_5,&local_178);
  local_178 = 0x67452301;
  local_16c = 0x10325476;
  local_168 = 0x200;
  local_174 = 0xefcdab89;
  local_170 = 0x98badcfe;
  local_164 = 0;
  memcpy(auStack_160,local_d8,0x40);
  FUN_0041a47c(&local_178,auStack_160);
  memcpy(auStack_160,auStack_98,0);
  uVar3 = local_168 + 0x80;
  uVar2 = local_168 >> 3 & 0x3f;
  if (uVar3 < 0x80) {
    local_164 = local_164 + 1;
  }
  uVar7 = -uVar2 + 0x40;
  uVar6 = 0;
  local_168 = uVar3;
  if (uVar7 < 0x11) {
    memcpy(auStack_160 + uVar2,param_5,uVar7);
    FUN_0041a47c(&local_178,auStack_160);
    uVar2 = -uVar2;
    while (uVar6 = uVar7, uVar2 + 0x7f < 0x10) {
      FUN_0041a47c(&local_178,(int)param_5 + uVar6);
      uVar7 = uVar6 + 0x40;
      uVar2 = uVar6;
    }
    uVar2 = 0;
  }
  memcpy(auStack_160 + uVar2,(void *)((int)param_5 + uVar6),0x10 - uVar6);
  MD5Final(param_5,&local_178);
  return;
}



undefined4 Sleep(__time_t param_1)

{
  int iVar1;
  int *piVar2;
  timespec local_20;
  timespec local_18;
  
  local_20.tv_nsec = 0;
  local_20.tv_sec = param_1;
  do {
    iVar1 = nanosleep(&local_20,&local_18);
    local_20.tv_sec = local_18.tv_sec;
    local_20.tv_nsec = local_18.tv_nsec;
    if (iVar1 != -1) {
      return 0;
    }
    piVar2 = __errno_location();
  } while (*piVar2 == 4);
  return 0;
}



char * strdupWithoutNull(char *param_1)

{
  size_t sVar1;
  char *__dest;
  
  if (param_1 == (char *)0x0) {
    param_1 = "";
  }
  sVar1 = strlen(param_1);
  __dest = (char *)mmalloc(sVar1 + 1);
  if (__dest != (char *)0x0) {
    strcpy(__dest,param_1);
  }
  return __dest;
}



int vallocFmtString(char **param_1,size_t param_2,char *param_3,__gnuc_va_list param_4)

{
  char *__s;
  int iVar1;
  size_t sVar2;
  char *__dest;
  
  *param_1 = (char *)0x0;
  __s = (char *)mmalloc(param_2);
  if (__s != (char *)0x0) {
    iVar1 = vsnprintf(__s,param_2,param_3,param_4);
    sVar2 = strlen(__s);
    __dest = (char *)mmalloc(sVar2 + 1);
    if (__dest != (char *)0x0) {
      strcpy(__dest,__s);
    }
    *param_1 = __dest;
    free(__s);
    if (*param_1 != (char *)0x0) {
      return iVar1;
    }
  }
  return -1;
}



uint doSystem(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  char *__s;
  int iVar1;
  size_t sVar2;
  char *__dest;
  uint uVar3;
  undefined4 local_res4;
  undefined4 local_res8;
  undefined4 local_resc;
  
  local_res4 = param_2;
  local_res8 = param_3;
  local_resc = param_4;
  __s = (char *)mmalloc(0x400);
  __dest = (char *)0x0;
  uVar3 = 0;
  if (__s != (char *)0x0) {
    iVar1 = vsnprintf(__s,0x400,param_1,&local_res4);
    sVar2 = strlen(__s);
    __dest = (char *)mmalloc(sVar2 + 1);
    if (__dest != (char *)0x0) {
      strcpy(__dest,__s);
    }
    free(__s);
    if (__dest == (char *)0x0) goto LAB_0041bff0;
    if (0x3ff < iVar1) {
      trace(1,"doSystem: lost data, buffer overflow\n");
    }
  }
  if (__dest != (char *)0x0) {
    trace(1,"%s\n",__dest);
    uVar3 = system(__dest);
    free(__dest);
  }
LAB_0041bff0:
  return (uVar3 & 0xff) << 8 | (int)(uVar3 & 0xff00) >> 8;
}



int allocFmtString(char **param_1,size_t param_2,char *param_3,undefined4 param_4)

{
  char *__s;
  int iVar1;
  size_t sVar2;
  char *__dest;
  undefined4 local_resc;
  
  *param_1 = (char *)0x0;
  local_resc = param_4;
  __s = (char *)mmalloc(param_2);
  if (__s != (char *)0x0) {
    iVar1 = vsnprintf(__s,param_2,param_3,&local_resc);
    sVar2 = strlen(__s);
    __dest = (char *)mmalloc(sVar2 + 1);
    if (__dest != (char *)0x0) {
      strcpy(__dest,__s);
    }
    *param_1 = __dest;
    free(__s);
    if (*param_1 != (char *)0x0) {
      return iVar1;
    }
  }
  return -1;
}



void * strndupWithoutNull(void *param_1,size_t param_2)

{
  void *__dest;
  
  __dest = (void *)mmalloc(param_2 + 1);
  if (__dest != (void *)0x0) {
    memcpy(__dest,param_1,param_2);
    *(undefined *)((int)__dest + param_2) = 0;
  }
  return __dest;
}



int webncasestrcmp(char *param_1,char *param_2)

{
  size_t __n;
  size_t sVar1;
  int iVar2;
  
  if ((param_1 != (char *)0x0) && (param_2 != (char *)0x0)) {
    __n = strlen(param_1);
    sVar1 = strlen(param_2);
    if (__n <= sVar1) {
      __n = sVar1;
    }
                    // WARNING: Treating indirect jump as call
    iVar2 = strncasecmp(param_1,param_2,__n);
    return iVar2;
  }
  return 1;
}



char * strlower(char *param_1)

{
  char cVar1;
  char *pcVar2;
  
  pcVar2 = (char *)0x0;
  if (param_1 != (char *)0x0) {
    cVar1 = *param_1;
    pcVar2 = param_1;
    while (cVar1 != '\0') {
      if ((*(ushort *)(cVar1 * 2 + __ctype_b) & 1) != 0) {
        *pcVar2 = (char)*(undefined2 *)(cVar1 * 2 + __ctype_tolower);
      }
      pcVar2 = pcVar2 + 1;
      cVar1 = *pcVar2;
    }
    *pcVar2 = '\0';
    pcVar2 = param_1;
  }
  return pcVar2;
}



char * strupper(char *param_1)

{
  char cVar1;
  char *pcVar2;
  
  pcVar2 = (char *)0x0;
  if (param_1 != (char *)0x0) {
    cVar1 = *param_1;
    pcVar2 = param_1;
    while (cVar1 != '\0') {
      if ((*(ushort *)(cVar1 * 2 + __ctype_b) >> 1 & 1) != 0) {
        *pcVar2 = (char)*(undefined2 *)(cVar1 * 2 + __ctype_toupper);
      }
      pcVar2 = pcVar2 + 1;
      cVar1 = *pcVar2;
    }
    *pcVar2 = '\0';
    pcVar2 = param_1;
  }
  return pcVar2;
}



char * stritoa(int param_1,char *param_2,int param_3,undefined4 param_4)

{
  bool bVar1;
  char *pcVar2;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  int iVar6;
  char acStack_19 [17];
  
  if (param_2 == (char *)0x0) {
    trace(0x10,"stritoa: output buffer is NULL!\n",param_3,param_4,&_gp);
    return (char *)0x0;
  }
  bVar1 = param_1 < 0;
  if (bVar1) {
    param_1 = -param_1;
    param_3 = param_3 + -1;
  }
  pcVar5 = acStack_19 + 1;
  pcVar2 = acStack_19 + param_3;
  pcVar4 = pcVar5;
  if (param_1 < 10) {
LAB_0041c488:
    if (pcVar4 < pcVar2) {
      *pcVar4 = (char)param_1 + '0';
      pcVar4 = pcVar4 + 1;
    }
  }
  else if (pcVar5 < pcVar2) {
    iVar6 = (int)((ulonglong)((longlong)param_1 * 0x66666667) >> 0x20);
    iVar3 = param_1;
    do {
      param_1 = (iVar6 >> 2) - (iVar3 >> 0x1f);
      *pcVar4 = (char)iVar3 + (char)param_1 * -10 + '0';
      pcVar4 = pcVar4 + 1;
      if (param_1 < 10) goto LAB_0041c488;
      iVar6 = (int)((ulonglong)((longlong)param_1 * 0x66666667) >> 0x20);
      iVar3 = param_1;
    } while (pcVar4 < pcVar2);
  }
  pcVar2 = param_2;
  if (bVar1) {
    *param_2 = '-';
    pcVar2 = param_2 + 1;
  }
  while (pcVar5 < pcVar4) {
    pcVar4 = pcVar4 + -1;
    *pcVar2 = *pcVar4;
    pcVar2 = pcVar2 + 1;
  }
  *pcVar2 = '\0';
  return param_2;
}



char * websRemoveDuplicateChars(char *param_1,char param_2)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  char *pcVar5;
  char cVar6;
  char *pcVar4;
  
  if (param_1 != (char *)0x0) {
    cVar6 = *param_1;
    pcVar3 = param_1;
    pcVar5 = param_1;
    cVar2 = cVar6;
    while (cVar2 != '\0') {
      if ((cVar6 == param_2) && (pcVar4 = pcVar3, pcVar3[1] == cVar6)) {
        do {
          pcVar3 = pcVar4 + 1;
          cVar6 = *pcVar3;
          if (cVar6 != param_2) break;
          pcVar1 = pcVar4 + 2;
          pcVar4 = pcVar3;
        } while (*pcVar1 == param_2);
      }
      if (pcVar5 != pcVar3) {
        *pcVar5 = cVar6;
      }
      pcVar3 = pcVar3 + 1;
      cVar6 = *pcVar3;
      pcVar5 = pcVar5 + 1;
      if (cVar6 == '\0') break;
      cVar2 = *pcVar5;
    }
    if (pcVar5 != pcVar3) {
      *pcVar5 = '\0';
    }
  }
  return param_1;
}



void websGetTempFileName(void)

{
                    // WARNING: Treating indirect jump as call
  tempnam("/var","tmp");
  return;
}



void hexarraytohexstring(byte *param_1,char *param_2,uint param_3)

{
  byte *pbVar1;
  uint uVar2;
  char local_20;
  undefined local_1f;
  undefined local_1e;
  
  *param_2 = '\0';
  uVar2 = 0;
  pbVar1 = param_1;
  if (param_3 != 0) {
    do {
      local_20 = (&DAT_004d60dc)[*pbVar1 >> 4];
      local_1f = (&DAT_004d60dc)[*pbVar1 & 0xf];
      local_1e = 0;
      uVar2 = uVar2 + 1;
      strcat(param_2,&local_20);
      pbVar1 = param_1 + uVar2;
    } while (uVar2 < param_3);
  }
  return;
}



uint hexstringtohexarray(char *param_1,int param_2)

{
  char *pcVar1;
  long lVar2;
  char *pcVar3;
  char *pcVar4;
  int iVar5;
  char local_20;
  char local_1f;
  undefined local_1e;
  
  pcVar1 = (char *)strlen(param_1);
  pcVar3 = (char *)0x0;
  if (((uint)pcVar1 & 1) != 0) {
    pcVar3 = "[ERROR] input length error:%u\n";
LAB_0041c800:
    trace(1,pcVar3,pcVar1);
    return 0;
  }
  pcVar4 = param_1;
  if (pcVar1 != (char *)0x0) {
    do {
      iVar5 = (int)*pcVar4;
      pcVar3 = pcVar3 + 1;
      if ((((iVar5 < 0x30) || (iVar5 - 0x3aU < 7)) || (iVar5 - 0x47U < 0x1a)) || (0x66 < iVar5)) {
        pcVar3 = "[ERROR] input string error: %s\n";
        pcVar1 = param_1;
        goto LAB_0041c800;
      }
      pcVar4 = param_1 + (int)pcVar3;
    } while (pcVar3 < pcVar1);
  }
  pcVar3 = (char *)0x0;
  if (pcVar1 != (char *)0x0) {
    do {
      local_1f = (param_1 + (int)pcVar3)[1];
      local_20 = param_1[(int)pcVar3];
      local_1e = 0;
      pcVar4 = pcVar3 + 2;
      lVar2 = strtol(&local_20,(char **)0x0,0x10);
      *(char *)(((uint)pcVar3 >> 1) + param_2) = (char)lVar2;
      if (pcVar1 <= pcVar4) break;
      local_1f = (param_1 + (int)pcVar4)[1];
      local_20 = param_1[(int)pcVar4];
      local_1e = 0;
      pcVar3 = pcVar3 + 4;
      lVar2 = strtol(&local_20,(char **)0x0,0x10);
      *(char *)(((uint)pcVar4 >> 1) + param_2) = (char)lVar2;
    } while (pcVar3 < pcVar1);
  }
  return (uint)pcVar1 >> 1;
}



undefined4 websProcessUrlAndCheckRealm(int param_1)

{
  int iVar1;
  char *__haystack;
  char *pcVar2;
  char *pcVar3;
  undefined4 uVar4;
  
  iVar1 = websGetAntiTblCount(param_1 + 4);
  if (iVar1 < 0x14) {
    websRemoveDuplicateChars(*(undefined4 *)(param_1 + 0x88),0x2f);
    websRemoveDuplicateChars(*(undefined4 *)(param_1 + 0x8c),0x2f);
    iVar1 = *(int *)(param_1 + 0xf4);
    if (((((iVar1 == 1) || (iVar1 == 9)) || (iVar1 == 7)) || (iVar1 == 5)) &&
       (((iVar1 = *(int *)(param_1 + 0xc4), 1 < iVar1 - 2U && (iVar1 != 5)) &&
        ((iVar1 != 6 &&
         (iVar1 = webncasestrcmp(*(undefined4 *)(param_1 + 0x88),WebInteralSnapImgCGI), iVar1 != 0))
        )))) {
      websReplyUnSupportMsg(param_1);
      return 1;
    }
    websInternalForwardURL(param_1);
    if ((((*(uint *)(param_1 + 0xe4) >> 2 & 1) == 0) &&
        (iVar1 = *(int *)(param_1 + 0xc4), iVar1 != 4)) &&
       ((iVar1 != 2 && (((iVar1 != 3 && (iVar1 != 5)) && (iVar1 != 6)))))) {
      if ((*(int *)(param_1 + 0x14c) == 0) || (*(int *)(param_1 + 0x150) == 0)) goto LAB_0041ca8c;
      __haystack = (char *)strdupWithoutNull();
      if (__haystack != (char *)0x0) {
        pcVar2 = strstr(__haystack,"//");
        if (pcVar2 != (char *)0x0) {
          pcVar3 = strchr(pcVar2 + 2,0x2f);
          if (pcVar3 != (char *)0x0) {
            *pcVar3 = '\0';
          }
          iVar1 = webncasestrcmp(pcVar2 + 2,*(undefined4 *)(param_1 + 0x150));
          if (iVar1 != 0) {
            free(__haystack);
            goto LAB_0041ca8c;
          }
        }
        if (__haystack != (char *)0x0) {
          free(__haystack);
        }
      }
    }
    iVar1 = websCheckRealm(param_1);
    if (iVar1 == 0) {
      websAntiTblUnsched(param_1 + 4);
      return 0;
    }
    if (iVar1 == 0x194) {
      websConnError(param_1,0x194,"File Not Found");
    }
    else if (iVar1 == 500) {
      websConnError(param_1,500,"Invalid URL");
    }
    else {
      if (*(int *)(param_1 + 0xa4) != 0) {
        iVar1 = strdupWithoutNull("/antibruteforce");
        if (iVar1 == 0) {
          return 0;
        }
        uVar4 = *(undefined4 *)(param_1 + 0x88);
        *(int *)(param_1 + 0x88) = iVar1;
        *(undefined4 *)(param_1 + 0x148) = uVar4;
        return 0;
      }
      websConnError(param_1,0x191,"Authentication was requested");
    }
  }
  else {
LAB_0041ca8c:
    websConnError(param_1,0x193,"Forbidden");
  }
  return 1;
}



undefined4 websUrlProcessRequest(undefined4 *param_1)

{
  bool bVar1;
  void *pvVar2;
  size_t __n;
  char *pcVar3;
  char *__haystack;
  char *pcVar4;
  char *pcVar5;
  int iVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  code *__s;
  undefined **ppuVar9;
  char *pcVar10;
  void *local_28 [2];
  
  websSocketDeleteEvent(param_1[0x35]);
  websSetEnv(param_1);
  websSetQuery(param_1);
  websKernalParameter(param_1);
  local_28[0] = (void *)0x0;
  pvVar2 = (void *)AllocateMACAddress(0,0);
  if (pvVar2 != (void *)0x0) {
    allocFmtString(local_28,0xfe,"%d:%s",*param_1,param_1[0x24]);
    if (local_28[0] != (void *)0x0) {
      uVar7 = allocEncryptbyKey(local_28[0],pvVar2);
      param_1[0x27] = uVar7;
      if (local_28[0] != (void *)0x0) {
        free(local_28[0]);
        local_28[0] = (void *)0x0;
      }
    }
    if (pvVar2 != (void *)0x0) {
      free(pvVar2);
    }
  }
  iVar6 = param_1[0x31];
  if ((iVar6 == 1) && ((param_1[0x39] & 1) != 0)) {
    iVar6 = websTestVar(param_1,"SessionKey");
    if (iVar6 == 0) {
      iVar6 = checkSessionKeyRequest(param_1);
      if (iVar6 != 0) goto LAB_0041d014;
    }
    else {
      pvVar2 = (void *)AllocateMACAddress(0,0);
      bVar1 = false;
      if (pvVar2 != (void *)0x0) {
        uVar7 = websGetVar(param_1,"SessionKey",&DAT_0049445c);
        pcVar10 = (char *)allocDecryptbyKey(uVar7,pvVar2);
        if (pcVar10 != (char *)0x0) {
          pcVar3 = strstr(pcVar10,":/");
          if (pcVar3 != (char *)0x0) {
            pcVar3 = pcVar3 + 2;
          }
          __haystack = (char *)strdupWithoutNull(param_1[0x53]);
          if (__haystack != (char *)0x0) {
            pcVar4 = strstr(__haystack,"//");
            if (pcVar4 != (char *)0x0) {
              pcVar4 = pcVar4 + 2;
              pcVar5 = strchr(pcVar4,0x2f);
              if (pcVar5 != (char *)0x0) {
                *pcVar5 = '\0';
                pcVar4 = pcVar5 + 1;
              }
              pcVar5 = strchr(pcVar4,0x3f);
              if (pcVar5 != (char *)0x0) {
                *pcVar5 = '\0';
              }
              iVar6 = webncasestrcmp(pcVar3,pcVar4);
              if (iVar6 == 0) {
                bVar1 = true;
              }
            }
            if (__haystack != (char *)0x0) {
              free(__haystack);
            }
          }
          if (pcVar10 != (char *)0x0) {
            free(pcVar10);
          }
        }
        if (pvVar2 != (void *)0x0) {
          free(pvVar2);
        }
      }
      if (!bVar1) {
LAB_0041d014:
        websConnError(param_1,0x193,"Forbidden");
        return 1;
      }
    }
    iVar6 = param_1[0x31];
  }
  if ((((iVar6 == 2) || (iVar6 == 5)) || (iVar6 == 3)) || (iVar6 == 6)) {
    uVar8 = param_1[0x24];
    uVar7 = 0x10;
  }
  else {
    uVar8 = param_1[0x24];
    uVar7 = 1;
  }
  trace(uVar7,"websUrlProcessRequest=%s\n",uVar8);
  ppuVar9 = &PTR_websAntiBruteProcessor_004d6160;
  if (PTR_websAntiBruteProcessor_004d6160 == (undefined *)0x0) {
    websConnError(param_1,500,"This URL was not support!");
  }
  else {
    do {
      __s = ((code **)ppuVar9)[1];
      __n = strlen((char *)__s);
      pcVar10 = (char *)param_1[0x22];
      iVar6 = strncasecmp((char *)__s,pcVar10,__n);
      if ((iVar6 == 0) || (*__s == (code)0x0)) {
        iVar6 = (*(code *)*ppuVar9)(param_1,__s,param_1[0x23],pcVar10,param_1[0x28]);
        if (iVar6 != 0) {
          return 1;
        }
        iVar6 = websConnValid(param_1);
        if (iVar6 == 0) {
          trace(0x10,"handler %s return error value(1) after it called websConnClose!\n",
                ((code **)ppuVar9)[1]);
          return 1;
        }
      }
      ppuVar9 = (code **)ppuVar9 + 2;
    } while ((code *)*ppuVar9 != (code *)0x0);
    websConnError(param_1,500,"This URL was not support!");
  }
  return 0;
}



undefined4 * websSafeUrl(char *param_1)

{
  char *pcVar1;
  size_t sVar2;
  undefined4 *puVar3;
  char *pcVar4;
  undefined4 *puVar5;
  char cVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  
  iVar7 = 0;
  iVar9 = 0;
  pcVar4 = param_1;
  if (param_1 != (char *)0x0) {
    while( true ) {
      pcVar1 = strchr(pcVar4,0x3c);
      pcVar4 = pcVar1 + 1;
      iVar9 = iVar7;
      if (pcVar1 == (char *)0x0) break;
      iVar7 = iVar7 + 1;
    }
  }
  iVar8 = 0;
  iVar7 = 0;
  pcVar4 = param_1;
  if (param_1 != (char *)0x0) {
    while( true ) {
      pcVar1 = strchr(pcVar4,0x3e);
      pcVar4 = pcVar1 + 1;
      iVar7 = iVar8;
      if (pcVar1 == (char *)0x0) break;
      iVar8 = iVar8 + 1;
    }
  }
  puVar3 = (undefined4 *)0x0;
  if (param_1 != (char *)0x0) {
    sVar2 = strlen(param_1);
    if ((iVar9 == 0) && (iVar7 == 0)) {
      puVar3 = (undefined4 *)strdupWithoutNull(param_1);
      return puVar3;
    }
    puVar3 = (undefined4 *)mmalloc(sVar2 + iVar9 * 4 + iVar7 * 4);
    if (puVar3 != (undefined4 *)0x0) {
      cVar6 = *param_1;
      puVar5 = puVar3;
      while (cVar6 != '\0') {
        while (cVar6 != '<') {
          if (cVar6 == '>') {
            *puVar5 = 0x3b746726;
            *(undefined *)(puVar5 + 1) = 0;
            goto LAB_0041d26c;
          }
          *(char *)puVar5 = cVar6;
          param_1 = param_1 + 1;
          cVar6 = *param_1;
          puVar5 = (undefined4 *)((int)puVar5 + 1);
          if (cVar6 == '\0') goto LAB_0041d288;
        }
        *puVar5 = 0x3b746c26;
        *(undefined *)(puVar5 + 1) = 0;
LAB_0041d26c:
        puVar5 = puVar5 + 1;
        param_1 = param_1 + 1;
        cVar6 = *param_1;
      }
LAB_0041d288:
      *(undefined *)puVar5 = 0;
    }
  }
  return puVar3;
}



void websDecodeUrl(char *param_1,char *param_2,int param_3)

{
  int iVar1;
  int iVar2;
  char cVar3;
  int iVar4;
  int iVar5;
  
  cVar3 = *param_2;
  if ((cVar3 != '\0') && (0 < param_3)) {
    do {
      if (cVar3 == '+') {
        *param_1 = ' ';
      }
      else if (((cVar3 == '%') && ((*(ushort *)(param_2[1] * 2 + __ctype_b) >> 4 & 1) != 0)) &&
              (iVar4 = 1, (*(ushort *)(param_2[2] * 2 + __ctype_b) >> 4 & 1) != 0)) {
        iVar1 = 0;
        do {
          param_2 = param_2 + 1;
          iVar5 = (int)*(short *)(*param_2 * 2 + __ctype_tolower);
          iVar2 = iVar1 * 0x10 + iVar5;
          iVar1 = iVar2 + -0x30;
          if (iVar5 - 0x61U < 6) {
            iVar1 = iVar2 + -0x57;
          }
          iVar4 = iVar4 + -1;
        } while (-1 < iVar4);
        *param_1 = (char)iVar1;
      }
      else {
        *param_1 = cVar3;
      }
      param_2 = param_2 + 1;
      cVar3 = *param_2;
      param_3 = param_3 + -1;
      param_1 = param_1 + 1;
    } while ((cVar3 != '\0') && (0 < param_3));
  }
  *param_1 = '\0';
  return;
}



undefined4
websParseUrlInfo(char *param_1,char **param_2,char **param_3,char **param_4,char **param_5,
                undefined4 *param_6,char **param_7)

{
  char cVar1;
  size_t sVar2;
  int iVar3;
  char *__s;
  undefined4 uVar4;
  char *pcVar5;
  char *pcVar6;
  size_t sVar7;
  size_t sVar8;
  int iVar9;
  char *pcVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  char *pcVar14;
  char *local_30;
  
  sVar2 = strlen(param_1);
  iVar3 = sVar2 * 2;
  __s = (char *)mmalloc(iVar3 + 0xd);
  uVar4 = 0xffffffff;
  if (__s != (char *)0x0) {
    cVar1 = *param_1;
    pcVar10 = __s;
    for (; (cVar1 != '\0' && (0 < (int)sVar2)); sVar2 = sVar2 - 1) {
      if (cVar1 == '+') {
        *pcVar10 = ' ';
      }
      else if (((cVar1 == '%') && ((*(ushort *)(param_1[1] * 2 + __ctype_b) >> 4 & 1) != 0)) &&
              ((*(ushort *)(param_1[2] * 2 + __ctype_b) >> 4 & 1) != 0)) {
        iVar11 = 0;
        iVar13 = 1;
        do {
          param_1 = param_1 + 1;
          iVar12 = (int)*(short *)(*param_1 * 2 + __ctype_tolower);
          iVar9 = iVar11 * 0x10 + iVar12;
          iVar11 = iVar9 + -0x57;
          if (5 < iVar12 - 0x61U) {
            iVar11 = iVar9 + -0x30;
          }
          iVar13 = iVar13 + -1;
        } while (-1 < iVar13);
        *pcVar10 = (char)iVar11;
      }
      else {
        *pcVar10 = cVar1;
      }
      param_1 = param_1 + 1;
      cVar1 = *param_1;
      pcVar10 = pcVar10 + 1;
    }
    *pcVar10 = '\0';
    stritoa(websSrvPort,__s + iVar3 + 2,10);
    local_30 = ".htm";
    pcVar5 = strchr(__s,0x3f);
    pcVar10 = __s;
    pcVar14 = "";
    if (pcVar5 != (char *)0x0) {
      pcVar10 = pcVar5 + 1;
      *pcVar5 = '\0';
      pcVar14 = pcVar10;
    }
    pcVar6 = strchr(pcVar10,0x23);
    pcVar5 = __s;
    if ((pcVar6 != (char *)0x0) && (*pcVar6 = '\0', *pcVar14 == '\0')) {
      pcVar5 = pcVar10;
    }
    if ((param_7 != (char **)0x0) && (pcVar10 = strrchr(pcVar5,0x2e), pcVar10 != (char *)0x0)) {
      sVar2 = strcspn(pcVar10,"/\\");
      sVar7 = strspn(pcVar10 + sVar2,"/\\");
      sVar8 = strlen(pcVar10);
      if (sVar2 + sVar7 == sVar8) {
        pcVar10[sVar2] = '\0';
        local_30 = pcVar10;
      }
    }
    if (param_3 != (char **)0x0) {
      *param_3 = pcVar5;
    }
    if (param_4 != (char **)0x0) {
      *param_4 = __s + iVar3 + 2;
    }
    if (param_5 != (char **)0x0) {
      *param_5 = pcVar14;
    }
    if (param_6 != (undefined4 *)0x0) {
      *param_6 = &DAT_0049445c;
    }
    if (param_7 != (char **)0x0) {
      *param_7 = local_30;
    }
    uVar4 = 0;
    *param_2 = __s;
  }
  return uVar4;
}



undefined4 * websGetUrlType(char *param_1,undefined4 *param_2)

{
  int iVar1;
  char *__src;
  undefined **ppuVar2;
  char *__s1;
  char *local_20;
  void *local_1c;
  
  if (((param_1 == (char *)0x0) || (*param_1 == '\0')) ||
     (iVar1 = websParseUrlInfo(param_1,&local_1c,0,0,0,0,&local_20), iVar1 < 0)) {
    *param_2 = 0x74786574;
    param_2[1] = 0x616c702f;
    *(char *)(param_2 + 2) = 'i';
    *(char *)((int)param_2 + 9) = 'n';
    *(char *)((int)param_2 + 10) = '\0';
    return param_2;
  }
  local_20 = (char *)strdupWithoutNull(local_20);
  if (local_20 != (char *)0x0) {
    ppuVar2 = &websMimeList;
    strlower(local_20);
    __s1 = local_20;
    __src = websMimeList;
    while (__src != (char *)0x0) {
      iVar1 = strcmp(__s1,ppuVar2[1]);
      if (iVar1 == 0) {
        strcpy((char *)param_2,__src);
        __s1 = local_20;
        break;
      }
      ppuVar2 = ppuVar2 + 2;
      __src = *ppuVar2;
    }
    if (__s1 != (char *)0x0) {
      free(__s1);
      local_20 = (char *)0x0;
    }
    if ((ppuVar2 != (char **)0x0) && (*ppuVar2 != (char *)0x0)) goto LAB_0041d8ac;
  }
  *param_2 = 0x74786574;
  param_2[1] = 0x616c702f;
  *(char *)(param_2 + 2) = 'i';
  *(char *)((int)param_2 + 9) = 'n';
  *(char *)((int)param_2 + 10) = '\0';
LAB_0041d8ac:
  if (local_1c != (void *)0x0) {
    free(local_1c);
  }
  return param_2;
}



undefined4 websConnValidateUrl(int param_1,undefined4 param_2)

{
  char *__s;
  size_t sVar1;
  int iVar2;
  undefined4 uVar3;
  char cVar4;
  char *pcVar5;
  int iVar6;
  char *pcVar7;
  int iVar8;
  char **ppcVar9;
  int iVar10;
  char *local_128 [64];
  
  __s = (char *)strdupWithoutNull(param_2);
  if (__s == (char *)0x0) {
    return 0xffffffff;
  }
  sVar1 = strlen(__s);
  cVar4 = *__s;
  pcVar5 = __s;
  pcVar7 = __s;
  for (; (cVar4 != '\0' && (0 < (int)sVar1)); sVar1 = sVar1 - 1) {
    if (cVar4 == '+') {
      *pcVar7 = ' ';
    }
    else {
      if (((cVar4 == '%') && ((*(ushort *)(pcVar5[1] * 2 + __ctype_b) >> 4 & 1) != 0)) &&
         ((*(ushort *)(pcVar5[2] * 2 + __ctype_b) >> 4 & 1) != 0)) {
        iVar8 = 0;
        iVar10 = 1;
        do {
          pcVar5 = pcVar5 + 1;
          iVar2 = (int)*(short *)(*pcVar5 * 2 + __ctype_tolower);
          iVar6 = iVar8 * 0x10 + iVar2;
          iVar8 = iVar6 + -0x30;
          if (iVar2 - 0x61U < 6) {
            iVar8 = iVar6 + -0x57;
          }
          cVar4 = (char)iVar8;
          iVar10 = iVar10 + -1;
        } while (-1 < iVar10);
      }
      *pcVar7 = cVar4;
    }
    pcVar5 = pcVar5 + 1;
    cVar4 = *pcVar5;
    pcVar7 = pcVar7 + 1;
  }
  *pcVar7 = '\0';
  local_128[0] = (char *)0x0;
  pcVar5 = strchr(__s,0x5c);
  iVar8 = 0;
  iVar10 = 0;
  for (; pcVar5 != (char *)0x0; pcVar5 = strchr(pcVar5,0x5c)) {
    *pcVar5 = '/';
  }
  pcVar5 = strtok(__s,"/");
  if (pcVar5 != (char *)0x0) {
    do {
      while( true ) {
        if (0x3f < iVar8) goto LAB_0041dde4;
        iVar2 = strcmp(pcVar5,"..");
        if (iVar2 != 0) break;
        if (0 < iVar8) {
          iVar8 = iVar8 + -1;
        }
LAB_0041daf4:
        pcVar5 = strtok((char *)0x0,"/");
        if (pcVar5 == (char *)0x0) goto LAB_0041db94;
      }
      iVar2 = strcmp(pcVar5,".");
      if (iVar2 == 0) goto LAB_0041daf4;
      local_128[iVar8] = pcVar5;
      sVar1 = strlen(pcVar5);
      iVar10 = sVar1 + iVar10 + 1;
      pcVar5 = strtok((char *)0x0,"/");
      iVar8 = iVar8 + 1;
    } while (pcVar5 != (char *)0x0);
LAB_0041db94:
    if (iVar8 != 0) goto LAB_0041dbc8;
  }
  iVar2 = strcmp(__s,"/");
  if ((iVar2 != 0) && (*__s != '\0')) {
LAB_0041dde4:
    free(__s);
    return 0xffffffff;
  }
LAB_0041dbc8:
  pcVar5 = (char *)strdupWithoutNull(PTR_s__etc_ro_web_004d615c);
  if (pcVar5 != (char *)0x0) {
    sVar1 = strlen(pcVar5);
    pcVar7 = (char *)mmalloc(sVar1 + iVar10 + 2);
    if (pcVar7 != (char *)0x0) {
      strcpy(pcVar7,pcVar5);
      if (0 < iVar8) {
        ppcVar9 = local_128;
        do {
          strcat(pcVar7,"/");
          iVar8 = iVar8 + -1;
          strcat(pcVar7,*ppcVar9);
          ppcVar9 = ppcVar9 + 1;
        } while (iVar8 != 0);
      }
      if (*(void **)(param_1 + 0x94) != (void *)0x0) {
        free(*(void **)(param_1 + 0x94));
        *(undefined4 *)(param_1 + 0x94) = 0;
      }
      uVar3 = strdupWithoutNull(pcVar7);
      *(undefined4 *)(param_1 + 0x94) = uVar3;
      websSetVar(param_1,"PATH_TRANSLATED",uVar3);
      if (pcVar7 != (char *)0x0) {
        free(pcVar7);
      }
    }
    if (pcVar5 != (char *)0x0) {
      free(pcVar5);
    }
  }
  free(__s);
  return 0;
}



void websConnValidateUrlPath(int param_1,undefined4 param_2)

{
  char *__s;
  size_t sVar1;
  int iVar2;
  undefined4 uVar3;
  char cVar4;
  char *pcVar5;
  int iVar6;
  char *pcVar7;
  char **ppcVar8;
  int iVar9;
  int iVar10;
  char *local_128 [64];
  
  __s = (char *)strdupWithoutNull(param_2);
  if (__s == (char *)0x0) {
    return;
  }
  sVar1 = strlen(__s);
  cVar4 = *__s;
  pcVar5 = __s;
  pcVar7 = __s;
  for (; (cVar4 != '\0' && (0 < (int)sVar1)); sVar1 = sVar1 - 1) {
    if (cVar4 == '+') {
      *pcVar7 = ' ';
    }
    else {
      if (((cVar4 == '%') && ((*(ushort *)(pcVar5[1] * 2 + __ctype_b) >> 4 & 1) != 0)) &&
         ((*(ushort *)(pcVar5[2] * 2 + __ctype_b) >> 4 & 1) != 0)) {
        iVar9 = 0;
        iVar10 = 1;
        do {
          pcVar5 = pcVar5 + 1;
          iVar2 = (int)*(short *)(*pcVar5 * 2 + __ctype_tolower);
          iVar6 = iVar9 * 0x10 + iVar2;
          iVar9 = iVar6 + -0x30;
          if (iVar2 - 0x61U < 6) {
            iVar9 = iVar6 + -0x57;
          }
          cVar4 = (char)iVar9;
          iVar10 = iVar10 + -1;
        } while (-1 < iVar10);
      }
      *pcVar7 = cVar4;
    }
    pcVar5 = pcVar5 + 1;
    cVar4 = *pcVar5;
    pcVar7 = pcVar7 + 1;
  }
  *pcVar7 = '\0';
  local_128[0] = (char *)0x0;
  pcVar5 = strchr(__s,0x5c);
  iVar9 = 0;
  iVar10 = 0;
  for (; pcVar5 != (char *)0x0; pcVar5 = strchr(pcVar5,0x5c)) {
    *pcVar5 = '/';
  }
  pcVar5 = strtok(__s,"/");
  if (pcVar5 != (char *)0x0) {
    do {
      while( true ) {
        if (0x3f < iVar9) goto LAB_0041e284;
        iVar2 = strcmp(pcVar5,"..");
        if (iVar2 != 0) break;
        if (0 < iVar9) {
          iVar9 = iVar9 + -1;
        }
LAB_0041dfa4:
        pcVar5 = strtok((char *)0x0,"/");
        if (pcVar5 == (char *)0x0) goto LAB_0041e044;
      }
      iVar2 = strcmp(pcVar5,".");
      if (iVar2 == 0) goto LAB_0041dfa4;
      local_128[iVar9] = pcVar5;
      sVar1 = strlen(pcVar5);
      iVar10 = sVar1 + iVar10 + 1;
      pcVar5 = strtok((char *)0x0,"/");
      iVar9 = iVar9 + 1;
    } while (pcVar5 != (char *)0x0);
LAB_0041e044:
    if (iVar9 != 0) goto LAB_0041e078;
  }
  iVar2 = strcmp(__s,"/");
  if ((iVar2 != 0) && (*__s != '\0')) {
LAB_0041e284:
    free(__s);
    return;
  }
LAB_0041e078:
  pcVar5 = (char *)mmalloc(iVar10 + 1);
  if (pcVar5 != (char *)0x0) {
    pcVar5[1] = '\0';
    *pcVar5 = '/';
    iVar10 = 0;
    if (0 < iVar9) {
      ppcVar8 = local_128;
      do {
        while (iVar10 == 0) {
          iVar10 = 1;
          strcat(pcVar5,*ppcVar8);
          ppcVar8 = ppcVar8 + 1;
          if (iVar9 < 2) goto LAB_0041e118;
        }
        iVar10 = iVar10 + 1;
        strcat(pcVar5,"/");
        strcat(pcVar5,*ppcVar8);
        ppcVar8 = ppcVar8 + 1;
      } while (iVar10 < iVar9);
    }
LAB_0041e118:
    if (*(void **)(param_1 + 0x88) != (void *)0x0) {
      free(*(void **)(param_1 + 0x88));
      *(undefined4 *)(param_1 + 0x88) = 0;
    }
    uVar3 = strdupWithoutNull(pcVar5);
    *(undefined4 *)(param_1 + 0x88) = uVar3;
    websSetVar(param_1,"PATH_INFO",uVar3);
  }
  free(__s);
  if (pcVar5 != (char *)0x0) {
    free(pcVar5);
  }
  return;
}



void DigestCalcHA1(undefined4 param_1,char *param_2,char *param_3,char *param_4,char *param_5,
                  char *param_6,int param_7)

{
  byte bVar1;
  size_t sVar2;
  int iVar3;
  byte *pbVar4;
  uint uVar5;
  undefined auStack_90 [88];
  byte local_38 [16];
  
  MD5Init(auStack_90);
  sVar2 = strlen(param_2);
  MD5Update(auStack_90,param_2,sVar2);
  MD5Update(auStack_90,&DAT_0048cfd8,1);
  sVar2 = strlen(param_3);
  MD5Update(auStack_90,param_3,sVar2);
  MD5Update(auStack_90,&DAT_0048cfd8,1);
  sVar2 = strlen(param_4);
  MD5Update(auStack_90,param_4,sVar2);
  MD5Final(local_38,auStack_90);
  iVar3 = webncasestrcmp(param_1,"md5-sess");
  if (iVar3 == 0) {
    MD5Init(auStack_90);
    MD5Update(auStack_90,local_38,0x10);
    MD5Update(auStack_90,&DAT_0048cfd8,1);
    sVar2 = strlen(param_5);
    MD5Update(auStack_90,param_5,sVar2);
    MD5Update(auStack_90,&DAT_0048cfd8,1);
    sVar2 = strlen(param_6);
    MD5Update(auStack_90,param_6,sVar2);
    MD5Final(local_38,auStack_90);
    uVar5 = 0;
  }
  else {
    uVar5 = 0;
  }
  do {
    while( true ) {
      pbVar4 = local_38 + uVar5;
      iVar3 = uVar5 * 2;
      bVar1 = *pbVar4 >> 4;
      if (bVar1 < 10) {
        *(char *)(iVar3 + param_7) = bVar1 + 0x30;
        bVar1 = *pbVar4;
      }
      else {
        *(char *)(iVar3 + param_7) = bVar1 + 0x57;
        bVar1 = *pbVar4;
      }
      bVar1 = bVar1 & 0xf;
      if (bVar1 < 10) break;
      *(byte *)(iVar3 + param_7 + 1) = bVar1 + 0x57;
      uVar5 = uVar5 + 1 & 0xffff;
      if (0xf < uVar5) goto LAB_0041e4a0;
    }
    *(byte *)(iVar3 + param_7 + 1) = bVar1 + 0x30;
    uVar5 = uVar5 + 1 & 0xffff;
  } while (uVar5 < 0x10);
LAB_0041e4a0:
  *(undefined *)(param_7 + 0x20) = 0;
  return;
}



void DigestCalcResponse(undefined4 param_1,char *param_2,char *param_3,char *param_4,char *param_5,
                       char *param_6,char *param_7,undefined4 param_8,int param_9)

{
  size_t sVar1;
  int iVar2;
  char *pcVar3;
  byte *pbVar4;
  uint uVar5;
  byte bVar6;
  undefined auStack_c8 [88];
  byte local_70 [16];
  byte local_60 [16];
  char local_50 [40];
  
  MD5Init(auStack_c8);
  sVar1 = strlen(param_6);
  MD5Update(auStack_c8,param_6,sVar1);
  MD5Update(auStack_c8,&DAT_0048cfd8,1);
  sVar1 = strlen(param_7);
  MD5Update(auStack_c8,param_7,sVar1);
  iVar2 = webncasestrcmp(param_5,"auth-int");
  if (iVar2 == 0) {
    MD5Update(auStack_c8,&DAT_0048cfd8,1);
    MD5Update(auStack_c8,param_8,0x20);
  }
  MD5Final(local_70,auStack_c8);
  uVar5 = 0;
  do {
    while( true ) {
      pbVar4 = local_70 + uVar5;
      iVar2 = uVar5 * 2;
      bVar6 = *pbVar4 >> 4;
      pcVar3 = local_50 + iVar2;
      if (9 < bVar6) break;
      *pcVar3 = bVar6 + 0x30;
      bVar6 = *pbVar4 & 0xf;
      if (bVar6 < 10) goto LAB_0041e6fc;
LAB_0041e758:
      local_50[iVar2 + 1] = bVar6 + 0x57;
      uVar5 = uVar5 + 1 & 0xffff;
      if (0xf < uVar5) goto LAB_0041e770;
    }
    *pcVar3 = bVar6 + 0x57;
    bVar6 = *pbVar4 & 0xf;
    if (9 < bVar6) goto LAB_0041e758;
LAB_0041e6fc:
    local_50[iVar2 + 1] = bVar6 + 0x30;
    uVar5 = uVar5 + 1 & 0xffff;
  } while (uVar5 < 0x10);
LAB_0041e770:
  local_50[32] = 0;
  MD5Init(auStack_c8);
  MD5Update(auStack_c8,param_1,0x20);
  MD5Update(auStack_c8,&DAT_0048cfd8,1);
  sVar1 = strlen(param_2);
  MD5Update(auStack_c8,param_2,sVar1);
  MD5Update(auStack_c8,&DAT_0048cfd8,1);
  if (*param_5 != '\0') {
    sVar1 = strlen(param_3);
    MD5Update(auStack_c8,param_3,sVar1);
    MD5Update(auStack_c8,&DAT_0048cfd8,1);
    sVar1 = strlen(param_4);
    MD5Update(auStack_c8,param_4,sVar1);
    MD5Update(auStack_c8,&DAT_0048cfd8,1);
    sVar1 = strlen(param_5);
    MD5Update(auStack_c8,param_5,sVar1);
    MD5Update(auStack_c8,&DAT_0048cfd8,1);
  }
  MD5Update(auStack_c8,local_50,0x20);
  MD5Final(local_60,auStack_c8);
  uVar5 = 0;
  do {
    while( true ) {
      pbVar4 = local_60 + uVar5;
      iVar2 = uVar5 * 2;
      bVar6 = *pbVar4 >> 4;
      if (9 < bVar6) break;
      *(char *)(iVar2 + param_9) = bVar6 + 0x30;
      bVar6 = *pbVar4 & 0xf;
      if (bVar6 < 10) goto LAB_0041e860;
LAB_0041e8b8:
      uVar5 = uVar5 + 1 & 0xffff;
      *(byte *)(iVar2 + param_9 + 1) = bVar6 + 0x57;
      if (0xf < uVar5) goto LAB_0041e8cc;
    }
    *(char *)(iVar2 + param_9) = bVar6 + 0x57;
    bVar6 = *pbVar4 & 0xf;
    if (9 < bVar6) goto LAB_0041e8b8;
LAB_0041e860:
    uVar5 = uVar5 + 1 & 0xffff;
    *(byte *)(iVar2 + param_9 + 1) = bVar6 + 0x30;
  } while (uVar5 < 0x10);
LAB_0041e8cc:
  *(undefined *)(param_9 + 0x20) = 0;
  return;
}



void websGetDigestNonce(int param_1)

{
  char *pcVar1;
  uint uVar2;
  int iVar3;
  size_t sVar4;
  byte *pbVar5;
  byte bVar6;
  undefined auStack_b8 [88];
  byte local_60 [16];
  char local_50 [40];
  undefined auStack_28 [16];
  char *local_18 [2];
  
  uVar2 = time((time_t *)0x0);
  srand(uVar2);
  iVar3 = rand();
  stritoa(iVar3,auStack_28,0x10);
  allocFmtString(local_18,0x100,"%s:%s",auStack_28,*(undefined4 *)(param_1 + 300));
  if (local_18[0] != (char *)0x0) {
    MD5Init(auStack_b8);
    pcVar1 = local_18[0];
    sVar4 = strlen(local_18[0]);
    MD5Update(auStack_b8,pcVar1,sVar4);
    MD5Final(local_60,auStack_b8);
    uVar2 = 0;
    do {
      while( true ) {
        pbVar5 = local_60 + uVar2;
        iVar3 = uVar2 * 2;
        bVar6 = *pbVar5 >> 4;
        if (9 < bVar6) break;
        local_50[iVar3] = bVar6 + 0x30;
        bVar6 = *pbVar5 & 0xf;
        if (bVar6 < 10) goto LAB_0041eb78;
LAB_0041ebd0:
        uVar2 = uVar2 + 1 & 0xffff;
        local_50[iVar3 + 1] = bVar6 + 0x57;
        if (0xf < uVar2) goto LAB_0041ebe4;
      }
      local_50[iVar3] = bVar6 + 0x57;
      bVar6 = *pbVar5 & 0xf;
      if (9 < bVar6) goto LAB_0041ebd0;
LAB_0041eb78:
      uVar2 = uVar2 + 1 & 0xffff;
      local_50[iVar3 + 1] = bVar6 + 0x30;
    } while (uVar2 < 0x10);
LAB_0041ebe4:
    local_50[32] = 0;
    if (local_18[0] != (char *)0x0) {
      free(local_18[0]);
      local_18[0] = (char *)0x0;
    }
  }
  strdupWithoutNull(local_50);
  return;
}



undefined4 websCheckDigestRealm(int param_1)

{
  char *pcVar1;
  void *__ptr;
  void *__ptr_00;
  char *__s1;
  void *__ptr_01;
  void *__ptr_02;
  int iVar2;
  undefined4 uVar3;
  void *__ptr_03;
  undefined4 uVar4;
  undefined auStack_b0 [40];
  undefined local_88;
  undefined auStack_87 [39];
  undefined auStack_60 [40];
  void *local_38;
  void *local_34;
  void *local_30;
  
  uVar4 = 0xffffffff;
  if (*(int *)(param_1 + 300) == 0) {
    return 0xffffffff;
  }
  if (*(int *)(param_1 + 0x130) == 0) {
    return 0xffffffff;
  }
  if (*(int *)(param_1 + 0x134) == 0) {
    return 0xffffffff;
  }
  if (*(int *)(param_1 + 0x138) == 0) {
    return 0xffffffff;
  }
  if (*(int *)(param_1 + 0x13c) == 0) {
    return 0xffffffff;
  }
  if (*(int *)(param_1 + 0x140) == 0) {
    return 0xffffffff;
  }
  if (*(int *)(param_1 + 0x144) == 0) {
    return 0xffffffff;
  }
  pcVar1 = (char *)websGetRealm();
  __ptr = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0xac));
  __ptr_00 = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0xa8));
  __s1 = (char *)strdupWithoutNull(*(undefined4 *)(param_1 + 300));
  __ptr_01 = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0x130));
  __ptr_02 = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0x138));
  local_38 = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0x13c));
  local_34 = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0x140));
  local_30 = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0x144));
  local_88 = 0;
  memset(auStack_87,0,0x20);
  if (__ptr == (void *)0x0) goto LAB_0041ee4c;
  if ((((__ptr_00 == (void *)0x0) || (__s1 == (char *)0x0)) || (__ptr_01 == (void *)0x0)) ||
     (((__ptr_02 == (void *)0x0 || (local_38 == (void *)0x0)) || (local_34 == (void *)0x0)))) {
LAB_0041ee30:
    if (__ptr == (void *)0x0) goto LAB_0041ee4c;
  }
  else if (local_30 != (void *)0x0) {
    iVar2 = strcmp(__s1,pcVar1);
    if (iVar2 == 0) {
      uVar3 = websGetVar(param_1,"HTTP_REQUEST",0);
      __ptr_03 = (void *)strdupWithoutNull(uVar3);
      if (__ptr_03 != (void *)0x0) {
        DigestCalcHA1(&DAT_0048cffc,__ptr,__s1,__ptr_00,__ptr_01,local_34,auStack_b0);
        DigestCalcResponse(auStack_b0,__ptr_01,local_38,local_34,local_30,__ptr_03,__ptr_02,
                           &local_88,auStack_60);
        pcVar1 = (char *)strdupWithoutNull(auStack_60);
        if (pcVar1 != (char *)0x0) {
          iVar2 = strcmp(*(char **)(param_1 + 0x134),pcVar1);
          if (iVar2 == 0) {
            uVar4 = 0;
          }
          free(pcVar1);
        }
        if (__ptr_03 != (void *)0x0) {
          free(__ptr_03);
        }
      }
    }
    goto LAB_0041ee30;
  }
  free(__ptr);
LAB_0041ee4c:
  if (__ptr_00 != (void *)0x0) {
    free(__ptr_00);
  }
  if (__s1 != (char *)0x0) {
    free(__s1);
  }
  if (__ptr_01 != (void *)0x0) {
    free(__ptr_01);
  }
  if (__ptr_02 != (void *)0x0) {
    free(__ptr_02);
  }
  if (local_38 != (void *)0x0) {
    free(local_38);
  }
  if (local_34 != (void *)0x0) {
    free(local_34);
  }
  if (local_30 != (void *)0x0) {
    free(local_30);
  }
  return uVar4;
}



int websSSLOpen(void)

{
  int iVar1;
  char *__s;
  char *__s_00;
  
  iVar1 = matrixSslOpenWithConfig("YNYYNNNNNYYNY");
  if (iVar1 < 0) {
    return -1;
  }
  iVar1 = matrixSslNewKeys(&DAT_004d6198,0);
  if (iVar1 < 0) {
    return -1;
  }
  __s = (char *)mmalloc(0x24);
  __s_00 = (char *)mmalloc(0x25);
  if (__s != (char *)0x0) {
    if (__s_00 == (char *)0x0) goto LAB_0041f1b0;
    sprintf(__s,"%s/%s","/etc_ro","serverkey.pem");
    sprintf(__s_00,"%s/%s","/etc_ro","servercert.pem");
    iVar1 = matrixSslLoadRsaKeys(DAT_004d6198,__s_00,__s,0,0);
    if (iVar1 < 0) {
      fprintf(stderr,"failed to read certificates in websSSLOpen(%d)!\n",iVar1);
      if (iVar1 == -0x25) {
        nvram_bufset(0,"SSLCertificate1",&DAT_0049445c);
        nvram_bufset(0,"SSLCertificate2",&DAT_0049445c);
        nvram_commit(0);
        nvram_close(0);
        nvram_init(0);
        preparesslkey();
      }
      free(__s_00);
      free(__s);
      matrixSslDeleteKeys(DAT_004d6198);
      matrixSslClose();
      return iVar1;
    }
  }
  if (__s_00 != (char *)0x0) {
    free(__s_00);
  }
LAB_0041f1b0:
  if (__s != (char *)0x0) {
    free(__s);
  }
  DAT_004d619c = websSocketOpenConnection(WebSrv_HTTPS_Port,websSSLAccept,0x10);
  iVar1 = 0;
  if (DAT_004d619c < 0) {
    fprintf(stderr,"SSL: Unable to open SSL socket on port %d!\n",WebSrv_HTTPS_Port);
    matrixSslDeleteKeys(DAT_004d6198);
    matrixSslClose();
    iVar1 = -1;
  }
  return iVar1;
}



undefined4 websSSLAccept(undefined4 param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  size_t sVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  char *__s1;
  
  iVar1 = websConnAlloc();
  if (-1 < iVar1) {
    iVar1 = *(int *)(iVar1 * 4 + websConnList);
    *(undefined4 *)(iVar1 + 0xd8) = param_4;
    sVar2 = strlen(param_2);
    sVar2 = sVar2 + 1;
    __s1 = (char *)(iVar1 + 4);
    if (0x20 < sVar2) {
      sVar2 = 0x20;
    }
    memcpy(__s1,param_2,sVar2);
    iVar3 = strcmp(__s1,"127.0.0.1");
    if (((iVar3 == 0) || (iVar3 = strcmp(__s1,(char *)&websSrvIpAddr), iVar3 == 0)) ||
       (iVar3 = strcmp(__s1,(char *)&websSrvHostName), iVar3 == 0)) {
      uVar4 = *(uint *)(iVar1 + 0xe4) | 4;
    }
    else {
      uVar4 = *(uint *)(iVar1 + 0xe4);
    }
    *(uint *)(iVar1 + 0xe4) = uVar4 | 0x80;
    websSocketCreateEvent(param_1,2,&LAB_0041f7bc,iVar1);
    uVar5 = websTimeoutSched(0x3c,websTimeout,iVar1);
    *(undefined4 *)(iVar1 + 0xec) = uVar5;
    trace(8,"SSL accept request\n");
    return 0;
  }
  return 0xffffffff;
}



int websSSLRead(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  int local_10 [2];
  
  iVar1 = sslRead(*param_1,param_2,param_3,local_10,&_gp);
  if ((iVar1 == 0) && (local_10[0] == 1)) {
    return -1;
  }
  return iVar1;
}



int websSSLGets(undefined4 *param_1,undefined4 *param_2)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  int iVar4;
  char local_28 [4];
  int local_24;
  
  *param_2 = 0;
  iVar1 = websSocketGetPtr(*(undefined4 *)(param_1[1] + 0xd4));
  iVar2 = -1;
  if (iVar1 != 0) {
    iVar4 = iVar1 + 0x38;
LAB_0041f630:
    do {
      iVar2 = sslRead(*param_1,local_28,1,&local_24);
      while (iVar2 != 0) {
        if (iVar2 < 0) {
          return -1;
        }
        if (iVar2 == 0) goto LAB_0041f664;
        if (local_28[0] == '\n') goto LAB_0041f714;
        if (local_28[0] == '\r') goto LAB_0041f630;
        memPoolPutChar(iVar4);
        iVar2 = sslRead(*param_1,local_28,1,&local_24);
      }
      if (local_24 == 1) {
        return -1;
      }
LAB_0041f664:
      iVar2 = memPoolLen(iVar4);
    } while ((iVar2 < 1) || ((*(uint *)(iVar1 + 0x6c) & 1) == 0));
    local_28[0] = '\n';
LAB_0041f714:
    iVar2 = memPoolLen(iVar4);
    if (iVar2 < 1) {
      *param_2 = 0;
    }
    else {
      uVar3 = strndupWithoutNull(*(undefined4 *)(iVar1 + 0x48),iVar2);
      *param_2 = uVar3;
    }
    memPoolFlush(iVar4);
  }
  return iVar2;
}



int websSSLWrite(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined auStack_18 [8];
  
  iVar1 = -1;
  if (param_1 != (undefined4 *)0x0) {
    do {
      iVar1 = sslWrite(*param_1,param_2,param_3,auStack_18);
    } while (iVar1 == 0);
    if (iVar1 < 0) {
      return -1;
    }
  }
  return iVar1;
}



uint websSSLEof(int param_1)

{
  int *piVar1;
  int iVar2;
  
  iVar2 = *(int *)(*(int *)(param_1 + 4) + 0xd4);
  if (((-1 < iVar2) && (iVar2 <= socketLast)) &&
     (iVar2 = *(int *)(iVar2 * 4 + socketList), iVar2 != 0)) {
    return *(uint *)(iVar2 + 0x6c) & 1;
  }
  piVar1 = __errno_location();
  *piVar1 = 9;
  return 0xffffffff;
}



undefined4 websSSLFlush(void)

{
  return 0;
}



undefined4 webssslWriteClosureAlert(undefined4 *param_1)

{
  sslWriteClosureAlert(*param_1);
  return 0;
}



undefined4 websSSLFree(void *param_1)

{
  if (param_1 != (void *)0x0) {
    sslFreeConnection();
    free(param_1);
  }
  return 0;
}



void websSSLClose(void)

{
  matrixSslDeleteKeys(DAT_004d6198);
                    // WARNING: Treating indirect jump as call
  matrixSslClose();
  return;
}



size_t sslRead(int *param_1,void *param_2,size_t param_3,int *param_4)

{
  char cVar1;
  bool bVar2;
  ssize_t sVar3;
  int *piVar4;
  void *pvVar5;
  void *__ptr;
  int iVar6;
  void *pvVar7;
  size_t sVar8;
  uint uVar9;
  uint uVar10;
  char *local_28;
  size_t local_24;
  
  *param_4 = 0;
  iVar6 = *param_1;
  if ((iVar6 != 0) && (0 < (int)param_3)) {
    if ((void *)param_1[1] != (void *)0x0) {
      pvVar7 = (void *)param_1[2];
      sVar8 = (int)(void *)param_1[3] - (int)pvVar7;
      if (pvVar7 < (void *)param_1[3]) {
        if ((int)param_3 < (int)sVar8) {
          sVar8 = param_3;
        }
        memcpy(param_2,pvVar7,sVar8);
        param_1[2] = param_1[2] + sVar8;
        return sVar8;
      }
      free((void *)param_1[1]);
      iVar6 = *param_1;
      param_1[1] = 0;
    }
    uVar9 = 0;
    uVar10 = 0;
LAB_0041fb54:
    bVar2 = true;
    local_24 = matrixSslGetOutdata(iVar6,&local_28);
    while (0 < (int)local_24) {
      usleep(1000);
      sVar3 = send(param_1[5],local_28,local_24,0x40);
      if (sVar3 == 0) {
        uVar9 = uVar9 + 1 & 0xff;
        if (uVar9 == 0) {
          piVar4 = __errno_location();
          *param_4 = *piVar4;
          return 0xffffffff;
        }
LAB_0041fbb8:
        iVar6 = *param_1;
      }
      else if (sVar3 < 0) {
        piVar4 = __errno_location();
        iVar6 = *piVar4;
        *param_4 = iVar6;
        if (iVar6 != 0xb) {
          return 0xffffffff;
        }
        if (uVar9 != 0xff) {
          usleep(uVar9 * 1000);
        }
        uVar9 = uVar9 + 1 & 0xff;
        if (uVar9 == 0) {
          return 0xffffffff;
        }
        iVar6 = *param_1;
      }
      else {
        iVar6 = matrixSslSentData(*param_1,sVar3);
        if (iVar6 < 0) goto LAB_004200e0;
        if (iVar6 == 3) {
LAB_004200ec:
          *param_4 = 1;
          return 0;
        }
        if (iVar6 == 5) {
          bVar2 = true;
        }
        if (((iVar6 != 1) && ((int)local_24 <= sVar3)) || (uVar9 = uVar9 + 1 & 0xff, uVar9 == 0))
        goto LAB_0041fbe0;
        iVar6 = *param_1;
      }
LAB_0041fbbc:
      local_24 = matrixSslGetOutdata(iVar6,&local_28);
    }
    if ((int)local_24 < 0) {
LAB_004200e0:
      *param_4 = 4;
      return 0xffffffff;
    }
LAB_0041fbe0:
    if (!bVar2) {
      return 0;
    }
LAB_0041fbe8:
    do {
      local_24 = matrixSslGetReadbuf(*param_1,&local_28);
      if ((int)local_24 < 1) goto LAB_004200e0;
      usleep(1000);
      sVar3 = recv(param_1[5],local_28,local_24,0x40);
      if (sVar3 == 0) goto LAB_004200ec;
      if (-1 < sVar3) {
        iVar6 = matrixSslReceivedData(*param_1,sVar3,&local_28,&local_24);
        if (-1 < iVar6) {
LAB_0041fc64:
          switch(iVar6) {
          default:
            goto LAB_0041fe80;
          case 1:
            uVar9 = uVar9 + 1 & 0xff;
            bVar2 = false;
            if (uVar9 == 0) {
              return 0;
            }
            iVar6 = *param_1;
            goto LAB_0041fbbc;
          case 2:
            break;
          case 4:
          case 7:
            if (0 < (int)local_24) {
              if (param_1[1] == 0) {
                sVar8 = local_24;
                if ((int)local_24 < 0x5dc) {
                  sVar8 = 0x5dc;
                }
                pvVar7 = (void *)mmalloc(sVar8);
                param_1[1] = (int)pvVar7;
                param_1[3] = (int)pvVar7;
                param_1[2] = (int)pvVar7;
                if (pvVar7 == (void *)0x0) goto LAB_004200e0;
                param_1[4] = sVar8;
              }
              else {
                pvVar7 = (void *)param_1[3];
                __ptr = (void *)param_1[2];
                if ((param_1[1] + param_1[4]) - (int)pvVar7 < (int)local_24) {
                  pvVar5 = realloc(__ptr,param_1[4] + local_24);
                  pvVar7 = (void *)((int)pvVar5 + ((int)pvVar7 - (int)__ptr));
                  param_1[1] = (int)pvVar5;
                  param_1[2] = (int)pvVar5;
                  param_1[3] = (int)pvVar7;
                }
              }
              memcpy(pvVar7,local_28,local_24);
              param_1[3] = param_1[3] + local_24;
            }
            iVar6 = matrixSslProcessedData(*param_1,&local_28,&local_24);
            if (iVar6 == 0) {
              return 0;
            }
            if (0 < iVar6) {
              if (iVar6 != 4) {
                if (iVar6 == 1) goto LAB_0041fbb8;
                if (iVar6 != 2) {
                  if (iVar6 != 6) {
                    return 0;
                  }
                  if (local_28 == (char *)0x0) goto LAB_0041fe80;
                  cVar1 = *local_28;
                  goto LAB_0041fefc;
                }
                goto LAB_0041fbe8;
              }
              goto LAB_0041fc64;
            }
            if (iVar6 < 0) goto LAB_0041fe80;
            break;
          case 5:
            iVar6 = *param_1;
            goto LAB_0041fb54;
          case 6:
            if (local_28 == (char *)0x0) goto LAB_0041fe80;
            cVar1 = *local_28;
LAB_0041fefc:
            if (cVar1 == '\x02') {
LAB_0041fe80:
              *param_4 = 3;
              return 0xffffffff;
            }
            if (local_28[1] == '\0') {
              *param_4 = 2;
              return 0;
            }
            iVar6 = matrixSslProcessedData(*param_1,&local_28,&local_24);
            if (iVar6 == 0) goto LAB_0041fbe8;
            goto LAB_0041fc64;
          }
          uVar10 = uVar10 + 1 & 0xff;
          if (uVar10 == 0) {
            return 0;
          }
          goto LAB_0041fbe8;
        }
        goto LAB_004200e0;
      }
      piVar4 = __errno_location();
      iVar6 = *piVar4;
      *param_4 = iVar6;
      if (iVar6 != 0xb) {
        return 0xffffffff;
      }
      if (uVar10 != 0xff) {
        usleep(uVar10 * 1000);
      }
      uVar10 = uVar10 + 1 & 0xff;
    } while (uVar10 != 0);
  }
  return 0xffffffff;
}



size_t sslWrite(undefined4 *param_1,void *param_2,size_t param_3,int *param_4)

{
  bool bVar1;
  size_t sVar2;
  ssize_t sVar3;
  int *piVar4;
  int iVar5;
  uint uVar6;
  void *local_30 [2];
  
  *param_4 = 0;
  bVar1 = true;
  uVar6 = 0;
LAB_00420158:
  sVar2 = matrixSslGetOutdata(*param_1,local_30);
  do {
    if ((int)sVar2 < 1) {
      if (-1 < (int)sVar2) goto LAB_0042022c;
LAB_004202d0:
      sVar2 = 0xffffffff;
      iVar5 = 4;
LAB_004202d4:
      *param_4 = iVar5;
      return sVar2;
    }
    usleep(1000);
    sVar3 = send(param_1[5],local_30[0],sVar2,0);
    if (sVar3 == 0) {
      uVar6 = uVar6 + 1 & 0xff;
      if (uVar6 == 0) {
        piVar4 = __errno_location();
        *param_4 = *piVar4;
        return 0xffffffff;
      }
      goto LAB_00420158;
    }
    if (sVar3 < 0) {
      piVar4 = __errno_location();
      iVar5 = *piVar4;
      *param_4 = iVar5;
      if (iVar5 == 0xb) {
        if (uVar6 != 0xff) {
          usleep(uVar6 * 1000);
        }
        uVar6 = uVar6 + 1 & 0xff;
        if (uVar6 != 0) goto LAB_00420158;
      }
      return 0xffffffff;
    }
    iVar5 = matrixSslSentData(*param_1,sVar3);
    if (iVar5 < 0) {
      sVar2 = 0xffffffff;
      iVar5 = 3;
      goto LAB_004202d4;
    }
    if (iVar5 == 3) {
      sVar2 = 0;
      iVar5 = 1;
      goto LAB_004202d4;
    }
    if (((iVar5 == 1) || (sVar3 < (int)sVar2)) && (uVar6 = uVar6 + 1 & 0xff, uVar6 != 0))
    goto LAB_00420158;
LAB_0042022c:
    if (!bVar1) {
      return param_3;
    }
    iVar5 = matrixSslGetWritebuf(*param_1,local_30,param_3);
    if ((iVar5 < 0) || (iVar5 < (int)param_3)) goto LAB_004202d0;
    usleep(1000);
    memcpy(local_30[0],param_2,param_3);
    iVar5 = matrixSslEncodeWritebuf(*param_1,param_3);
    if (iVar5 < 0) goto LAB_004202d0;
    sVar2 = matrixSslGetOutdata(*param_1,local_30);
    bVar1 = false;
  } while( true );
}



void sslWriteClosureAlert(undefined4 *param_1)

{
  int iVar1;
  size_t __n;
  ssize_t sVar2;
  void *local_10 [2];
  
  iVar1 = matrixSslEncodeClosureAlert(*param_1);
  if (-1 < iVar1) {
    __n = matrixSslGetOutdata(*param_1,local_10);
    if (0 < (int)__n) {
      sVar2 = send(param_1[5],local_10[0],__n,0x40);
      if (0 < sVar2) {
        matrixSslSentData(*param_1,sVar2);
      }
    }
  }
  return;
}



void sslFreeConnection(undefined4 *param_1)

{
  undefined4 *__ptr;
  
  __ptr = (undefined4 *)*param_1;
  matrixSslDeleteSession(*__ptr);
  *__ptr = 0;
  if ((void *)__ptr[1] == (void *)0x0) {
    free(__ptr);
    *param_1 = 0;
    return;
  }
  free((void *)__ptr[1]);
  __ptr[1] = 0;
  free(__ptr);
  *param_1 = 0;
  return;
}



undefined4 sslAccept(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *__ptr;
  int iVar1;
  undefined auStack_468 [1024];
  undefined auStack_68 [20];
  undefined4 local_54;
  undefined4 local_4c;
  int local_20 [2];
  
  memset(auStack_68,0,0x44);
  local_54 = param_4;
  local_4c = param_3;
  __ptr = (undefined4 *)mmalloc(0x18);
  if (__ptr != (undefined4 *)0x0) {
    __ptr[5] = param_2;
    iVar1 = matrixSslNewServerSession(__ptr,param_3,0,auStack_68);
    if (-1 < iVar1) {
      __ptr[4] = 0;
      __ptr[1] = 0;
      __ptr[3] = 0;
      __ptr[2] = 0;
      *param_1 = __ptr;
      while( true ) {
        iVar1 = sslRead(__ptr,auStack_468,0x400,local_20);
        if (iVar1 != 0) break;
        if (local_20[0] - 1U < 2) goto LAB_0042063c;
        iVar1 = matrixSslHandshakeIsComplete(*__ptr);
        if (iVar1 != 0) {
          *param_1 = __ptr;
          return 0;
        }
      }
      if (0 < iVar1) {
        printf("%s:%d sslAssert(%s)\n",s_sslSocket_c_0048d0f8,0x42,"0");
                    // WARNING: Subroutine does not return
        abort();
      }
    }
LAB_0042063c:
    matrixSslDeleteSession(*__ptr);
    *__ptr = 0;
    if ((void *)__ptr[1] != (void *)0x0) {
      free((void *)__ptr[1]);
      __ptr[1] = 0;
    }
    free(__ptr);
  }
  return 0xffffffff;
}



undefined4 checkrangestring(undefined4 param_1,char *param_2,int param_3,int param_4,int param_5)

{
  byte bVar1;
  byte bVar2;
  size_t sVar3;
  size_t sVar4;
  size_t sVar5;
  char *pcVar6;
  undefined4 uVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  char *pcVar11;
  undefined4 local_40;
  undefined2 local_3c;
  undefined local_3a;
  undefined4 local_38;
  undefined2 local_34;
  undefined local_32;
  undefined4 local_30;
  
  local_3a = 0;
  local_40 = 0x73626e26;
  local_3c = 0x3b70;
  sVar3 = strlen((char *)&local_40);
  local_38 = 0x36312326;
  local_32 = 0;
  local_34 = 0x3b30;
  sVar4 = strlen((char *)&local_38);
  local_30 = 0;
  while( true ) {
    pcVar6 = strstr(param_2,(char *)&local_40);
    pcVar11 = pcVar6 + sVar3;
    if (pcVar6 == (char *)0x0) break;
    *pcVar6 = ' ';
    sVar5 = strlen(pcVar11);
    memcpy(pcVar6 + 1,pcVar11,sVar5);
    sVar5 = strlen(pcVar11);
    (pcVar6 + 1)[sVar5] = '\0';
  }
  while( true ) {
    pcVar6 = strstr(param_2,(char *)&local_38);
    pcVar11 = pcVar6 + sVar4;
    if (pcVar6 == (char *)0x0) break;
    *pcVar6 = ' ';
    sVar3 = strlen(pcVar11);
    memcpy(pcVar6 + 1,pcVar11,sVar3);
    sVar3 = strlen(pcVar11);
    (pcVar6 + 1)[sVar3] = '\0';
  }
  sVar3 = strlen(param_2);
  trace(2,"checkrangestring(length=%d)\n",sVar3);
  if (((int)sVar3 < param_3) || (param_4 < (int)sVar3)) {
    if (0 < param_5) {
      uVar7 = websGetErrorMessage(param_5);
      webAddReplyMessage(param_1,uVar7,1);
    }
    local_30 = 1;
  }
  iVar9 = 0;
  if ((int)sVar3 < 1) {
    return local_30;
  }
LAB_00420960:
  bVar1 = param_2[iVar9];
  iVar10 = 1;
  if (WebCurrentLanguage - 1U < 2) {
    pbVar8 = &_DBCSVector12;
    bVar2 = _DBCSVector12;
    while (bVar2 != 0) {
      if ((bVar2 <= bVar1) && (bVar1 <= pbVar8[1])) goto LAB_00420a68;
      pbVar8 = pbVar8 + 2;
      bVar2 = *pbVar8;
    }
  }
  else {
    for (pbVar8 = &_DBCSVector; *pbVar8 != 0; pbVar8 = pbVar8 + 2) {
      if ((*pbVar8 <= bVar1) && (bVar1 <= pbVar8[1])) goto LAB_00420a68;
    }
  }
  goto LAB_004209c8;
LAB_00420a68:
  iVar10 = 2;
LAB_004209c8:
  if (iVar10 == 1) {
    if (bVar1 == 0xa0) {
      param_2[iVar9] = 0x20;
    }
  }
  else {
    iVar9 = iVar9 + 1;
  }
  iVar9 = iVar9 + 1;
  if ((int)sVar3 <= iVar9) {
    return local_30;
  }
  goto LAB_00420960;
}



undefined4 checkcameraname(undefined4 param_1,char *param_2,int param_3,int param_4,int param_5)

{
  byte bVar1;
  byte bVar2;
  size_t sVar3;
  size_t sVar4;
  size_t sVar5;
  char *pcVar6;
  undefined4 uVar7;
  byte *pbVar8;
  int iVar9;
  int iVar10;
  char *pcVar11;
  undefined4 uStack_40;
  undefined2 uStack_3c;
  undefined uStack_3a;
  undefined4 uStack_38;
  undefined2 uStack_34;
  undefined uStack_32;
  undefined4 uStack_30;
  
  uStack_3a = 0;
  uStack_40 = 0x73626e26;
  uStack_3c = 0x3b70;
  sVar3 = strlen((char *)&uStack_40);
  uStack_38 = 0x36312326;
  uStack_32 = 0;
  uStack_34 = 0x3b30;
  sVar4 = strlen((char *)&uStack_38);
  uStack_30 = 0;
  while( true ) {
    pcVar6 = strstr(param_2,(char *)&uStack_40);
    pcVar11 = pcVar6 + sVar3;
    if (pcVar6 == (char *)0x0) break;
    *pcVar6 = ' ';
    sVar5 = strlen(pcVar11);
    memcpy(pcVar6 + 1,pcVar11,sVar5);
    sVar5 = strlen(pcVar11);
    (pcVar6 + 1)[sVar5] = '\0';
  }
  while( true ) {
    pcVar6 = strstr(param_2,(char *)&uStack_38);
    pcVar11 = pcVar6 + sVar4;
    if (pcVar6 == (char *)0x0) break;
    *pcVar6 = ' ';
    sVar3 = strlen(pcVar11);
    memcpy(pcVar6 + 1,pcVar11,sVar3);
    sVar3 = strlen(pcVar11);
    (pcVar6 + 1)[sVar3] = '\0';
  }
  sVar3 = strlen(param_2);
  trace(2,"checkrangestring(length=%d)\n",sVar3);
  if (((int)sVar3 < param_3) || (param_4 < (int)sVar3)) {
    if (0 < param_5) {
      uVar7 = websGetErrorMessage(param_5);
      webAddReplyMessage(param_1,uVar7,1);
    }
    uStack_30 = 1;
  }
  iVar9 = 0;
  if ((int)sVar3 < 1) {
    return uStack_30;
  }
LAB_00420960:
  bVar1 = param_2[iVar9];
  iVar10 = 1;
  if (WebCurrentLanguage - 1U < 2) {
    pbVar8 = &_DBCSVector12;
    bVar2 = _DBCSVector12;
    while (bVar2 != 0) {
      if ((bVar2 <= bVar1) && (bVar1 <= pbVar8[1])) goto LAB_00420a68;
      pbVar8 = pbVar8 + 2;
      bVar2 = *pbVar8;
    }
  }
  else {
    for (pbVar8 = &_DBCSVector; *pbVar8 != 0; pbVar8 = pbVar8 + 2) {
      if ((*pbVar8 <= bVar1) && (bVar1 <= pbVar8[1])) goto LAB_00420a68;
    }
  }
  goto LAB_004209c8;
LAB_00420a68:
  iVar10 = 2;
LAB_004209c8:
  if (iVar10 == 1) {
    if (bVar1 == 0xa0) {
      param_2[iVar9] = 0x20;
    }
  }
  else {
    iVar9 = iVar9 + 1;
  }
  iVar9 = iVar9 + 1;
  if ((int)sVar3 <= iVar9) {
    return uStack_30;
  }
  goto LAB_00420960;
}



int checkusername(undefined4 param_1,byte *param_2,undefined4 param_3,undefined4 param_4,int param_5
                 )

{
  int iVar1;
  undefined4 uVar2;
  size_t sVar3;
  uint uVar4;
  byte *pbVar5;
  
  iVar1 = checkrangestring();
  if (iVar1 == 0) {
    iVar1 = strcmp((char *)param_2,"admin");
    if (iVar1 != 0) {
      sVar3 = strlen((char *)param_2);
      iVar1 = 0;
      pbVar5 = param_2;
      if ((int)sVar3 < 1) {
        return 0;
      }
      while( true ) {
        uVar4 = (uint)*pbVar5;
        iVar1 = iVar1 + 1;
        if (((((*(ushort *)(uVar4 * 2 + __ctype_b) >> 0xb & 1) == 0) && (uVar4 != 0x2e)) &&
            (uVar4 != 0x5f)) && (uVar4 != 0x2d)) break;
        pbVar5 = param_2 + iVar1;
        if ((int)sVar3 <= iVar1) {
          return 0;
        }
      }
    }
    iVar1 = 1;
    if (0 < param_5) {
      uVar2 = websGetErrorMessage(param_5);
      webAddReplyMessage(param_1,uVar2,1);
    }
  }
  return iVar1;
}



void checkmaxstring(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  checkrangestring(param_1,param_2,0,param_3,param_4);
  return;
}



undefined4 checkwepkey(undefined4 param_1,char *param_2,int param_3,int param_4)

{
  size_t sVar1;
  undefined4 uVar2;
  int iVar3;
  char *pcVar4;
  
  sVar1 = strlen(param_2);
  if (sVar1 == 0) {
    if (param_4 == 0) {
      return 0;
    }
  }
  else {
    param_4 = param_3;
    if ((sVar1 == 10) || (sVar1 == 0x1a)) {
      iVar3 = 0;
      if ((int)sVar1 < 1) {
        return 0;
      }
      while( true ) {
        pcVar4 = param_2 + iVar3;
        iVar3 = iVar3 + 1;
        if ((*(ushort *)(*pcVar4 * 2 + __ctype_b) >> 4 & 1) == 0) break;
        if ((int)sVar1 <= iVar3) {
          return 0;
        }
      }
    }
    else if ((sVar1 == 5) || (sVar1 == 0xd)) {
      return 0;
    }
  }
  uVar2 = websGetErrorMessage(param_4);
  webAddReplyMessage(param_1,uVar2,1);
  return 1;
}



int checkpresharedkey(undefined4 param_1,undefined4 param_2,char *param_3,undefined4 param_4,
                     int param_5)

{
  size_t sVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  char *pcVar5;
  
  sVar1 = strlen(param_3);
  iVar4 = 0;
  if ((param_5 == 0) || (sVar1 != 0)) {
    if (sVar1 == 0x40) {
      iVar3 = 0;
      do {
        pcVar5 = param_3 + iVar3;
        iVar3 = iVar3 + 1;
        if ((*(ushort *)(*pcVar5 * 2 + __ctype_b) >> 4 & 1) == 0) {
          iVar4 = 1;
          break;
        }
      } while (iVar3 < 0x40);
    }
    else if (sVar1 - 8 < 0x38) {
      iVar3 = 0;
      if (0 < (int)sVar1) {
        do {
          pcVar5 = param_3 + iVar3;
          iVar3 = iVar3 + 1;
          if ((*pcVar5 < ' ') || (*pcVar5 == '\x7f')) goto LAB_00420e40;
        } while (iVar3 < (int)sVar1);
      }
    }
    else {
LAB_00420e40:
      iVar4 = 1;
    }
    if (iVar4 == 1) {
      uVar2 = websGetErrorMessage(param_4);
      webAddReplyMessage(param_1,uVar2,1);
      return 1;
    }
  }
  else {
    iVar4 = websTestVar(param_1,"WEPEncryption");
    if (iVar4 == 0) {
      pcVar5 = (char *)nvram_bufget(0,"WEPEncryption");
    }
    else {
      pcVar5 = (char *)websGetVar(param_1,"WEPEncryption",&DAT_0048b544);
    }
    iVar3 = strcmp(pcVar5,"4");
    iVar4 = 0;
    if (iVar3 == 0) {
      uVar2 = websGetErrorMessage(param_5);
      webAddReplyMessage(param_1,uVar2,1);
      iVar4 = 1;
    }
  }
  return iVar4;
}



undefined4 checkdatestring(undefined4 param_1,char *param_2,undefined4 param_3)

{
  size_t sVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  
  sVar1 = strlen(param_2);
  if ((((((sVar1 == 10) && (param_2[4] == '-')) && (param_2[7] == '-')) &&
       ((((*(ushort *)(*param_2 * 2 + __ctype_b) >> 3 & 1) != 0 &&
         ((*(ushort *)(param_2[1] * 2 + __ctype_b) >> 3 & 1) != 0)) &&
        (((*(ushort *)(param_2[2] * 2 + __ctype_b) >> 3 & 1) != 0 &&
         (((*(ushort *)(param_2[3] * 2 + __ctype_b) >> 3 & 1) != 0 &&
          ((*(ushort *)(param_2[5] * 2 + __ctype_b) >> 3 & 1) != 0)))))))) &&
      ((*(ushort *)(param_2[6] * 2 + __ctype_b) >> 3 & 1) != 0)) &&
     (((*(ushort *)(param_2[8] * 2 + __ctype_b) >> 3 & 1) != 0 &&
      ((*(ushort *)(param_2[9] * 2 + __ctype_b) >> 3 & 1) != 0)))) {
    iVar3 = param_2[5] * 10 + (int)param_2[6] + -0x210;
    iVar4 = param_2[8] * 10 + (int)param_2[9] + -0x210;
    if ((((*param_2 * 1000 + param_2[1] * 100 + param_2[2] * 10 + (int)param_2[3]) - 0xd826U < 0xf)
        && (((0 < iVar3 && (iVar3 < 0xd)) && (0 < iVar4)))) && (iVar4 < 0x20)) {
      return 0;
    }
  }
  uVar2 = websGetErrorMessage(param_3);
  webAddReplyMessage(param_1,uVar2,1);
  return 1;
}



undefined4 checktimestring(undefined4 param_1,char *param_2,undefined4 param_3)

{
  size_t sVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  
  sVar1 = strlen(param_2);
  if ((((sVar1 == 8) && (param_2[2] == ':')) && (param_2[5] == ':')) &&
     (((((*(ushort *)(*param_2 * 2 + __ctype_b) >> 3 & 1) != 0 &&
        ((*(ushort *)(param_2[1] * 2 + __ctype_b) >> 3 & 1) != 0)) &&
       (((*(ushort *)(param_2[3] * 2 + __ctype_b) >> 3 & 1) != 0 &&
        (((*(ushort *)(param_2[4] * 2 + __ctype_b) >> 3 & 1) != 0 &&
         ((*(ushort *)(param_2[6] * 2 + __ctype_b) >> 3 & 1) != 0)))))) &&
      ((*(ushort *)(param_2[7] * 2 + __ctype_b) >> 3 & 1) != 0)))) {
    iVar3 = param_2[3] * 10 + (int)param_2[4] + -0x210;
    iVar4 = param_2[6] * 10 + (int)param_2[7] + -0x210;
    if (((((*param_2 * 10 + (int)param_2[1]) - 0x210U < 0x18) && (-1 < iVar3)) && (iVar3 < 0x3c)) &&
       ((-1 < iVar4 && (iVar4 < 0x3c)))) {
      return 0;
    }
  }
  uVar2 = websGetErrorMessage(param_3);
  webAddReplyMessage(param_1,uVar2,1);
  return 1;
}



undefined4 checkhhmmstring(undefined4 param_1,char *param_2,int param_3)

{
  size_t sVar1;
  undefined4 uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  
  sVar1 = strlen(param_2);
  if ((((sVar1 == 5) && (param_2[2] == ':')) &&
      ((*(ushort *)(*param_2 * 2 + __ctype_b) >> 3 & 1) != 0)) &&
     ((((*(ushort *)(param_2[1] * 2 + __ctype_b) >> 3 & 1) != 0 &&
       ((*(ushort *)(param_2[3] * 2 + __ctype_b) >> 3 & 1) != 0)) &&
      ((*(ushort *)(param_2[4] * 2 + __ctype_b) >> 3 & 1) != 0)))) {
    iVar5 = param_2[3] * 10 + (int)param_2[4];
    uVar4 = (*param_2 * 10 + (int)param_2[1]) - 0x210;
    iVar3 = iVar5 + -0x210;
    if ((uVar4 == 0x18) && (iVar5 == 0x210)) {
      return 0;
    }
    if (((uVar4 < 0x18) && (-1 < iVar3)) && (iVar3 < 0x3c)) {
      return 0;
    }
  }
  if (0 < param_3) {
    uVar2 = websGetErrorMessage(param_3);
    webAddReplyMessage(param_1,uVar2,1);
  }
  return 1;
}



undefined4 checkislong(undefined4 param_1,char *param_2,int param_3)

{
  size_t sVar1;
  long lVar2;
  undefined4 uVar3;
  int iVar4;
  char *pcVar5;
  uint uVar6;
  char *local_30 [2];
  
  uVar6 = 0;
  sVar1 = strlen(param_2);
  pcVar5 = param_2;
  if (sVar1 != 0) {
    do {
      if ((uVar6 != 0) || ((*param_2 != '-' && (*param_2 != '+')))) {
        if ((*(ushort *)(*pcVar5 * 2 + __ctype_b) >> 3 & 1) == 0) {
          if (0 < param_3) {
            uVar3 = websGetErrorMessage(param_3);
            webAddReplyMessage(param_1,uVar3,1);
          }
          return 1;
        }
      }
      sVar1 = strlen(param_2);
      uVar6 = uVar6 + 1;
      pcVar5 = param_2 + uVar6;
    } while (uVar6 < sVar1);
  }
  lVar2 = atol(param_2);
  allocFmtString(local_30,0xfe,&DAT_0048bb04,lVar2);
  pcVar5 = local_30[0];
  uVar3 = 0;
  if (local_30[0] != (char *)0x0) {
    iVar4 = strcmp(local_30[0],param_2);
    uVar3 = 0;
    if ((iVar4 != 0) && (uVar3 = 1, 0 < param_3)) {
      uVar3 = websGetErrorMessage(param_3);
      webAddReplyMessage(param_1,uVar3,1);
      uVar3 = 1;
      pcVar5 = local_30[0];
    }
    if (pcVar5 != (char *)0x0) {
      free(pcVar5);
    }
  }
  return uVar3;
}



int checklongrange(undefined4 param_1,char *param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  long lVar2;
  undefined4 uVar3;
  
  iVar1 = checkislong(param_1,param_2,param_5);
  if (iVar1 == 0) {
    lVar2 = atol(param_2);
    if ((param_3 <= lVar2) && (lVar2 <= param_4)) {
      return 0;
    }
    if (0 < param_5) {
      uVar3 = websGetErrorMessage(param_5);
      webAddReplyMessage(param_1,uVar3,1);
    }
    iVar1 = 1;
  }
  return iVar1;
}



int checktimezoneindex(undefined4 param_1,char *param_2,int param_3,int param_4,int param_5)

{
  char cVar1;
  bool bVar2;
  size_t sVar3;
  int iVar4;
  undefined4 uVar5;
  char *pcVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  char acStack_38 [16];
  
  iVar10 = 1;
  if ((((*(ushort *)(*param_2 * 2 + __ctype_b) >> 3 & 1) == 0) ||
      ((*(ushort *)(param_2[1] * 2 + __ctype_b) >> 3 & 1) == 0)) || (param_2[2] != '(')) {
    uVar9 = 0;
    do {
      sVar3 = strlen(param_2);
      bVar2 = sVar3 <= uVar9;
      pcVar6 = param_2 + uVar9;
      uVar9 = uVar9 + 1;
      if (bVar2) {
        iVar4 = atoi(param_2);
        if ((param_3 <= iVar4) && (iVar4 <= param_4)) {
          iVar10 = 0;
          iVar8 = 0;
          if ((iVar4 != 0) && (TimeZoneList != 0)) {
            iVar7 = 0;
            goto LAB_00421bd0;
          }
        }
        break;
      }
    } while ((*(ushort *)(*pcVar6 * 2 + __ctype_b) >> 3 & 1) != 0);
  }
  else {
    iVar4 = *param_2 * 10 + (int)param_2[1] + -0x210;
    if ((param_3 <= iVar4) && (iVar8 = 0, iVar4 <= param_4)) {
      cVar1 = param_2[6];
      iVar10 = 0;
      if ((cVar1 == '+') || (cVar1 == '-')) {
        iVar8 = (param_2[7] * 10 + (int)param_2[8] + -0x210) * 0x3c +
                param_2[10] * 10 + (int)param_2[0xb] + -0x210;
      }
      if (cVar1 == '-') {
        pcVar6 = "-%d";
      }
      else {
        pcVar6 = "%d";
      }
      snprintf(acStack_38,0x10,pcVar6,iVar8);
      websSetVar(param_1,"TimeZone",acStack_38);
    }
  }
  goto LAB_00421a6c;
  while (iVar7 = iVar8 * 8, (&TimeZoneList)[iVar8 * 2] != 0) {
LAB_00421bd0:
    iVar8 = iVar8 + 1;
    if (*(int *)((int)&TimeZoneList + iVar7) == iVar4) {
      trace(2,"(%d)=(%d)\n",*(int *)((int)&TimeZoneList + iVar7),
            *(undefined4 *)((int)&DAT_004d508c + iVar7));
      snprintf(acStack_38,0x10,"%d",*(undefined4 *)((int)&DAT_004d508c + iVar7));
      websSetVar(param_1,"TimeZone",acStack_38);
      break;
    }
  }
LAB_00421a6c:
  if ((iVar10 == 1) && (param_5 != 0)) {
    uVar5 = websGetErrorMessage(param_5);
    webAddReplyMessage(param_1,uVar5,1);
  }
  return iVar10;
}



int checktimezone(undefined4 param_1,char *param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  long lVar2;
  undefined4 uVar3;
  char acStack_30 [16];
  
  iVar1 = checkislong(param_1,param_2,param_5);
  if (iVar1 == 0) {
    lVar2 = atol(param_2);
    if ((lVar2 < param_3) || (param_4 < lVar2)) {
      iVar1 = 1;
      if ((param_3 <= lVar2 / 0x3c) && (lVar2 / 0x3c <= param_4)) {
        iVar1 = 0;
      }
    }
    else {
      snprintf(acStack_30,0x10,"%d",lVar2 * 0x3c);
      websSetVar(param_1,"TimeZone",acStack_30);
    }
    if ((iVar1 == 1) && (param_5 != 0)) {
      uVar3 = websGetErrorMessage(param_5);
      webAddReplyMessage(param_1,uVar3,1);
    }
  }
  return iVar1;
}



bool checkenumrange(undefined4 param_1,char *param_2,char **param_3)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  
  iVar3 = 0;
  iVar4 = 0;
  cVar1 = **param_3;
  while (cVar1 != '\0') {
    iVar2 = strcmp(param_2,*(char **)(iVar4 + (int)param_3));
    iVar3 = iVar3 + 1;
    if (iVar2 == 0) break;
    iVar4 = iVar3 * 4;
    cVar1 = *param_3[iVar3];
  }
  return **(char **)(iVar4 + (int)param_3) == '\0';
}



bool checkMatchValue(undefined4 param_1,undefined4 param_2,char *param_3,char **param_4,
                    char **param_5)

{
  char cVar1;
  int iVar2;
  undefined4 uVar3;
  char **ppcVar4;
  int iVar5;
  int iVar6;
  
  iVar5 = 0;
  iVar6 = 0;
  cVar1 = **param_4;
  while (cVar1 != '\0') {
    iVar2 = strcmp(param_3,*(char **)(iVar6 + (int)param_4));
    iVar5 = iVar5 + 1;
    if (iVar2 == 0) break;
    iVar6 = iVar5 * 4;
    cVar1 = *param_4[iVar5];
  }
  if (**(char **)(iVar6 + (int)param_4) != '\0') {
    websSetVar(param_1,param_2,*(undefined4 *)(iVar6 + (int)param_5));
    uVar3 = websGetVar(param_1,param_2,&DAT_0049445c);
    trace(2,"ChangeVar[%s]=(%s,%s)\n",param_2,*(char **)(iVar6 + (int)param_4),uVar3);
    return false;
  }
  iVar5 = 0;
  iVar6 = 0;
  cVar1 = **param_5;
  ppcVar4 = param_5;
  while (cVar1 != '\0') {
    iVar2 = strcmp(param_3,*ppcVar4);
    iVar5 = iVar5 + 1;
    if (iVar2 == 0) break;
    iVar6 = iVar5 * 4;
    ppcVar4 = param_5 + iVar5;
    cVar1 = *param_5[iVar5];
  }
  return **(char **)(iVar6 + (int)param_4) == '\0';
}



uint CheckVarRange(undefined4 param_1,char *param_2,byte **param_3)

{
  char cVar1;
  int iVar2;
  in_addr_t iVar3;
  undefined4 uVar4;
  int iVar5;
  long lVar6;
  size_t sVar7;
  uint uVar8;
  byte *pbVar9;
  undefined uVar10;
  byte *pbVar11;
  undefined **ppuVar12;
  int iVar13;
  undefined auStack_28 [16];
  
  trace(2,"CheckVarRange(%s=%s)\n",param_2,*param_3);
  iVar2 = strcmp(param_2,"AdminID");
  if (iVar2 == 0) {
    pbVar11 = *param_3;
    uVar8 = checkrangestring(param_1,pbVar11,1,0xc,0x19);
    if ((uVar8 == 0) && (iVar2 = strcmp((char *)pbVar11,"admin"), iVar2 != 0)) {
      uVar4 = websGetErrorMessage(0x19);
      webAddReplyMessage(param_1,uVar4,1);
      uVar8 = 1;
    }
  }
  else {
    iVar2 = strcmp(param_2,"AdminPassword");
    if (iVar2 == 0) {
      pbVar11 = *param_3;
      uVar8 = checkrangestring(param_1,pbVar11,0,0x20,0x1a);
      if (uVar8 == 0) {
        sVar7 = strlen((char *)pbVar11);
        iVar2 = 0;
        pbVar9 = pbVar11;
        if (0 < (int)sVar7) {
          do {
            iVar2 = iVar2 + 1;
            if (0x5d < *pbVar9 - 0x21) {
              uVar4 = websGetErrorMessage(0x1a);
              webAddReplyMessage(param_1,uVar4,1);
              return 1;
            }
            pbVar9 = pbVar11 + iVar2;
          } while (iVar2 < (int)sVar7);
        }
      }
      return uVar8;
    }
    iVar2 = strcmp(param_2,"ConfirmAdminPassword");
    if (iVar2 == 0) {
      pbVar11 = *param_3;
      uVar8 = checkrangestring(param_1,pbVar11,6,0x20,0x1a);
      if (uVar8 == 0) {
        sVar7 = strlen((char *)pbVar11);
        iVar2 = 0;
        pbVar9 = pbVar11;
        if (0 < (int)sVar7) {
          do {
            iVar2 = iVar2 + 1;
            if (0x5d < *pbVar9 - 0x21) {
              uVar4 = websGetErrorMessage(0x1a);
              webAddReplyMessage(param_1,uVar4,1);
              return 1;
            }
            pbVar9 = pbVar11 + iVar2;
          } while (iVar2 < (int)sVar7);
        }
      }
      return uVar8;
    }
    iVar2 = strcmp(param_2,"VerifyAdminPassword");
    if (iVar2 == 0) {
      pbVar11 = *param_3;
      uVar8 = checkrangestring(param_1,pbVar11,0,0x20,0x1b);
      if (uVar8 == 0) {
        sVar7 = strlen((char *)pbVar11);
        iVar2 = 0;
        pbVar9 = pbVar11;
        if (0 < (int)sVar7) {
          do {
            iVar2 = iVar2 + 1;
            if (0x5d < *pbVar9 - 0x21) {
              uVar4 = websGetErrorMessage(0x1b);
              webAddReplyMessage(param_1,uVar4,1);
              return 1;
            }
            pbVar9 = pbVar11 + iVar2;
          } while (iVar2 < (int)sVar7);
        }
      }
      return uVar8;
    }
    iVar2 = strcmp(param_2,"CameraName");
    if (iVar2 == 0) {
      uVar8 = checkrangestring(param_1,*param_3,0,0x20,0x17);
    }
    else {
      iVar2 = strcmp(param_2,"BonjourName");
      if (iVar2 == 0) {
        uVar8 = checkrangestring(param_1,*param_3,0,0x20,0x68);
      }
      else {
        iVar2 = strcmp(param_2,"Location");
        if (iVar2 == 0) {
          uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x18);
        }
        else {
          iVar2 = strcmp(param_2,"UserName");
          if (iVar2 == 0) {
            uVar8 = checkusername(param_1,*param_3,1,0xc,0x2e);
          }
          else {
            iVar2 = strcmp(param_2,"UserPassword");
            if (iVar2 == 0) {
              pbVar11 = *param_3;
              uVar8 = checkrangestring(param_1,pbVar11,0,8,0x2f);
              if (uVar8 == 0) {
                sVar7 = strlen((char *)pbVar11);
                iVar2 = 0;
                pbVar9 = pbVar11;
                if (0 < (int)sVar7) {
                  do {
                    iVar2 = iVar2 + 1;
                    if (0x5d < *pbVar9 - 0x21) {
                      uVar4 = websGetErrorMessage(0x2f);
                      webAddReplyMessage(param_1,uVar4,1);
                      return 1;
                    }
                    pbVar9 = pbVar11 + iVar2;
                  } while (iVar2 < (int)sVar7);
                }
              }
            }
            else {
              iVar2 = strcmp(param_2,"PPPoEUserID");
              if (iVar2 == 0) {
                uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x23);
              }
              else {
                iVar2 = strcmp(param_2,"PPPoEPassword");
                if (iVar2 == 0) {
                  uVar8 = checkrangestring(param_1,*param_3,0,0x20,0x24);
                }
                else {
                  iVar2 = strcmp(param_2,"DDNSHostName");
                  if (iVar2 == 0) {
                    uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x44);
                  }
                  else {
                    iVar2 = strcmp(param_2,"DDNSUserName");
                    if (iVar2 == 0) {
                      uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x45);
                    }
                    else {
                      iVar2 = strcmp(param_2,"DDNSPassword");
                      if (iVar2 == 0) {
                        uVar8 = checkrangestring(param_1,*param_3,0,0x20,0x46);
                      }
                      else {
                        iVar2 = strcmp(param_2,"DDNSTimeout");
                        if (iVar2 == 0) {
                          uVar8 = checklongrange(param_1,*param_3,0xf0,0xffff,0);
                        }
                        else {
                          iVar2 = strcmp(param_2,"FTPHostAddress");
                          if (iVar2 == 0) {
                            uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x38);
                          }
                          else {
                            iVar2 = strcmp(param_2,"FTPUserName");
                            if (iVar2 == 0) {
                              uVar8 = checkrangestring(param_1,*param_3,0,0x20,0x3a);
                            }
                            else {
                              iVar2 = strcmp(param_2,"FTPPassword");
                              if (iVar2 == 0) {
                                uVar8 = checkrangestring(param_1,*param_3,0,0x20,0x3b);
                              }
                              else {
                                iVar2 = strcmp(param_2,"FTPDirectoryPath");
                                if (iVar2 == 0) {
                                  uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x3c);
                                }
                                else {
                                  iVar2 = strcmp(param_2,"FTPScheduleBaseFileName");
                                  if (iVar2 == 0) {
                                    uVar8 = checkrangestring(param_1,*param_3,0,0x20,0x3e);
                                  }
                                  else {
                                    iVar2 = strcmp(param_2,"EmailUserName");
                                    if (iVar2 == 0) {
                                      uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x47);
                                    }
                                    else {
                                      iVar2 = strcmp(param_2,"EmailPassword");
                                      if (iVar2 == 0) {
                                        uVar8 = checkrangestring(param_1,*param_3,0,0x20,0x48);
                                      }
                                      else {
                                        iVar2 = strcmp(param_2,"EmailSMTPServerAddress");
                                        if (iVar2 == 0) {
                                          uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x31);
                                        }
                                        else {
                                          iVar2 = strcmp(param_2,"EmailSenderAddress");
                                          if (iVar2 == 0) {
                                            uVar8 = checkrangestring(param_1,*param_3,0,0x40,0x32);
                                          }
                                          else {
                                            iVar2 = strcmp(param_2,"EmailReceiverAddress");
                                            if (iVar2 == 0) {
                                              uVar8 = checkrangestring(param_1,*param_3,0,0x100,0x33
                                                                      );
                                            }
                                            else {
                                              iVar2 = strcmp(param_2,"TimeServerIPAddress");
                                              if (iVar2 == 0) {
                                                uVar8 = checkrangestring(param_1,*param_3,0,0x40,
                                                                         0x51);
                                              }
                                              else {
                                                iVar2 = strcmp(param_2,"DDNSProvider");
                                                uVar8 = 0;
                                                if (iVar2 != 0) {
                                                  iVar2 = strcmp(param_2,"IPAddress");
                                                  if (iVar2 == 0) {
                                                    iVar3 = inet_addr((char *)*param_3);
                                                    if (iVar3 == 0xffffffff) {
                                                      uVar4 = websGetErrorMessage(0x1c);
                                                      webAddReplyMessage(param_1,uVar4,1);
                                                    }
                                                    uVar8 = (uint)(iVar3 == 0xffffffff);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"SubnetMask");
                                                    if (iVar2 == 0) {
                                                      iVar3 = inet_addr((char *)*param_3);
                                                      if (iVar3 == 0xffffffff) {
                                                        uVar4 = websGetErrorMessage(0x1d);
                                                        webAddReplyMessage(param_1,uVar4,1);
                                                      }
                                                      uVar8 = (uint)(iVar3 == 0xffffffff);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"DefaultGateway");
                                                      if (iVar2 == 0) {
                                                        uVar8 = 0;
                                                        if ((**param_3 != 0) &&
                                                           (iVar3 = inet_addr((char *)*param_3),
                                                           iVar3 == 0xffffffff)) {
                                                          uVar4 = websGetErrorMessage(0x1e);
                                                          webAddReplyMessage(param_1,uVar4,1);
                                                          uVar8 = 1;
                                                        }
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"DNSIPAddress1");
                                                        if (iVar2 == 0) {
                                                          uVar8 = 0;
                                                          if ((**param_3 != 0) &&
                                                             (iVar3 = inet_addr((char *)*param_3),
                                                             iVar3 == 0xffffffff)) {
                                                            uVar4 = websGetErrorMessage(0x1f);
                                                            webAddReplyMessage(param_1,uVar4,1);
                                                            uVar8 = 1;
                                                          }
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"DNSIPAddress2");
                                                          if (iVar2 == 0) {
                                                            uVar8 = 0;
                                                            if ((**param_3 != 0) &&
                                                               (iVar3 = inet_addr((char *)*param_3),
                                                               iVar3 == 0xffffffff)) {
                                                              uVar4 = websGetErrorMessage(0x20);
                                                              webAddReplyMessage(param_1,uVar4,1);
                                                              uVar8 = 1;
                                                            }
                                                          }
                                                          else {
                                                            iVar2 = strcmp(param_2,"Date");
                                                            if (iVar2 == 0) {
                                                              uVar8 = checkdatestring(param_1,*
                                                  param_3,0x52);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"Time");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checktimestring(param_1,*param_3,0x53)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"FTPScheduleTimeStart")
                                                      ;
                                                      if (iVar2 == 0) {
                                                        uVar8 = checktimestring(param_1,*param_3,
                                                                                0x42);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"FTPScheduleTimeStop"
                                                                      );
                                                        if (iVar2 == 0) {
                                                          uVar8 = checktimestring(param_1,*param_3,
                                                                                  0x43);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,
                                                  "EmailScheduleTimeStart");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checktimestring(param_1,*param_3,0x49);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"EmailScheduleTimeStop");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checktimestring(param_1,*param_3,0x4a)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"HTTPAuthentication");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,1,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"DateTimeMode");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 1,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,
                                                  "TimeServerProtocol");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,1,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"AccessControlEnable");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,1,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"UserPrivilege");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,1,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"ViewMode");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 4,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"LightFrequency");
                                                          if (iVar2 == 0) {
                                                            uVar8 = checklongrange(param_1,*param_3,
                                                                                   0,1,0);
                                                          }
                                                          else {
                                                            iVar2 = strcmp(param_2,
                                                  "AntiFlickerEnable");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,1,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"DDNSEnable");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,1,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"UPnPEnable");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,1,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"BonjourEnable");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 1,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,
                                                  "UPnPPortForwarding");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,1,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"EmailScheduleEnable");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,1,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"FTPPassiveMode");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,1,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"FTPScheduleEnable");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 1,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,
                                                  "FTPScheduleVideoFrequencyMode");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,1,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"AudioEnable");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,1,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"SpeakerEnable");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,1,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"EmailMotionMode");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 1,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"LEDControl");
                                                          if (iVar2 == 0) {
                                                            uVar8 = checklongrange(param_1,*param_3,
                                                                                   0,2,0);
                                                          }
                                                          else {
                                                            iVar2 = strcmp(param_2,"VideoResolution"
                                                                          );
                                                            if (iVar2 == 0) {
                                                              uVar8 = checklongrange(param_1,*
                                                  param_3,0,2,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"FTPScheduleFileMode");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,2,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,
                                                  "EmailTLSAuthentication");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,2,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"EmailScheduleMode");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,2,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"FTPScheduleMode");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,2,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"Mirror");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 3,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"CompressionRate");
                                                          if (iVar2 == 0) {
                                                            uVar8 = checklongrange(param_1,*param_3,
                                                                                   0,4,0);
                                                          }
                                                          else {
                                                            iVar2 = strcmp(param_2,
                                                  "EmailScheduleDay");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,0x7f,0
                                                                          );
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"FTPScheduleDay");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,0x7f
                                                                             ,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"BrightnessControl");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,1,
                                                                               0x80,0x35);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"ContrastControl");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 0x80,0x36);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"SaturationControl"
                                                                        );
                                                          if (iVar2 == 0) {
                                                            uVar8 = checklongrange(param_1,*param_3,
                                                                                   0,0x80,0x37);
                                                          }
                                                          else {
                                                            iVar2 = strcmp(param_2,
                                                  "SharpnessControl");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,0xffff
                                                                           ,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"SecondHTTPPort");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,1,
                                                                             0xffff,0x34);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"FTPPortNumber");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,1,
                                                                               0xffff,0x39);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,
                                                  "FTPScheduleSecondPerFrame");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,1,0xffff
                                                                           ,0x3d);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "FTPScheduleMaxFileSequenceNumber");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,1,0xffff
                                                                           ,0x3f);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"FTPCreateFolderInterval"
                                                                  );
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,
                                                                             0x5a0,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"EmailScheduleInterval"
                                                                    );
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,1,
                                                                               0xffff,0x4b);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"TimeZoneIndex");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checktimezoneindex(param_1,*
                                                  param_3,0,0x5c,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"TimeZone");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checktimezone(param_1,*param_3,
                                                                            0xfffffff4,0xd,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"IPAddressMode");
                                                      if (iVar2 == 0) {
                                                        pbVar11 = *param_3;
                                                        iVar2 = 0;
                                                        iVar13 = 0;
                                                        cVar1 = *ipmode_select;
                                                        while (cVar1 != '\0') {
                                                          iVar5 = strcmp((char *)pbVar11,
                                                                         *(char **)((int)&
                                                  ipmode_select + iVar2));
                                                  iVar13 = iVar13 + 1;
                                                  if (iVar5 == 0) break;
                                                  iVar2 = iVar13 * 4;
                                                  cVar1 = *(&ipmode_select)[iVar13];
                                                  }
                                                  uVar8 = (uint)(**(char **)((int)&ipmode_select +
                                                                            iVar2) == '\0');
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"SecondHTTPPortEnable");
                                                    if (iVar2 == 0) {
                                                      ppuVar12 = &secondportenable_value;
                                                      pbVar11 = *param_3;
                                                      iVar2 = 0;
                                                      iVar13 = 0;
                                                      cVar1 = *secondportenable_value;
                                                      while (cVar1 != '\0') {
                                                        iVar5 = strcmp((char *)pbVar11,*ppuVar12);
                                                        iVar2 = iVar2 + 1;
                                                        if (iVar5 == 0) break;
                                                        iVar13 = iVar2 * 4;
                                                        ppuVar12 = &secondportenable_value + iVar2;
                                                        cVar1 = *(&secondportenable_value)[iVar2];
                                                      }
                                                      uVar8 = (uint)(**(char **)((int)&
                                                  secondportenable_value + iVar13) == '\0');
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"AudioVolume");
                                                    if (iVar2 == 0) {
                                                      ppuVar12 = &audiovol_select;
                                                      pbVar11 = *param_3;
                                                      iVar2 = 0;
                                                      iVar13 = 0;
                                                      cVar1 = *audiovol_select;
                                                      while (cVar1 != '\0') {
                                                        iVar5 = strcmp((char *)pbVar11,*ppuVar12);
                                                        iVar2 = iVar2 + 1;
                                                        if (iVar5 == 0) break;
                                                        iVar13 = iVar2 * 4;
                                                        ppuVar12 = &audiovol_select + iVar2;
                                                        cVar1 = *(&audiovol_select)[iVar2];
                                                      }
                                                      uVar8 = (uint)(**(char **)((int)&
                                                  audiovol_select + iVar13) == '\0');
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"SpeakerVolume");
                                                    if (iVar2 == 0) {
                                                      ppuVar12 = &audiovol_select;
                                                      pbVar11 = *param_3;
                                                      iVar2 = 0;
                                                      iVar13 = 0;
                                                      cVar1 = *audiovol_select;
                                                      while (cVar1 != '\0') {
                                                        iVar5 = strcmp((char *)pbVar11,*ppuVar12);
                                                        iVar2 = iVar2 + 1;
                                                        if (iVar5 == 0) break;
                                                        iVar13 = iVar2 * 4;
                                                        ppuVar12 = &audiovol_select + iVar2;
                                                        cVar1 = *(&audiovol_select)[iVar2];
                                                      }
                                                      uVar8 = (uint)(**(char **)((int)&
                                                  audiovol_select + iVar13) == '\0');
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"FrameRate");
                                                    if (iVar2 == 0) {
                                                      pbVar11 = *param_3;
                                                      lVar6 = atol((char *)pbVar11);
                                                      iVar2 = strcmp((char *)pbVar11,"Auto");
                                                      uVar10 = 0;
                                                      if (((((iVar2 != 0) && (lVar6 < 0x24)) &&
                                                           (uVar10 = 0x1e, lVar6 < 0x1e)) &&
                                                          ((uVar10 = 0x14, lVar6 < 0x14 &&
                                                           (uVar10 = 0xf, lVar6 < 0xf)))) &&
                                                         ((uVar10 = 7, lVar6 < 7 &&
                                                          (uVar10 = 5, lVar6 < 5)))) {
                                                        uVar10 = 0 < lVar6;
                                                      }
                                                      stritoa(uVar10,auStack_28,0x10);
                                                      websSetVar(param_1,param_2,auStack_28);
                                                      uVar4 = websGetVar(param_1,param_2,
                                                                         &DAT_0049445c);
                                                      trace(2,"ChangeVar=(%s,%s)\n",param_2,uVar4);
                                                      uVar8 = 0;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,
                                                  "FTPScheduleFramePerSecond");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checkMatchValue(param_1,param_2,*param_3
                                                                            ,frame_select,
                                                                            frame_value);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "EmailMotionFrameInterval");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checkMatchValue(param_1,param_2,*param_3
                                                                            ,motioninterval_select,
                                                                            motioninterval_value);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"DayNightMode");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,4,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"LightSensorControl");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,
                                                                               0xb,0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,
                                                  "IRLedScheduleSunStart");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"IRLedScheduleSunEnd");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"IRLedScheduleMonStart"
                                                                    );
                                                      if (iVar2 == 0) {
                                                        uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"IRLedScheduleMonEnd"
                                                                      );
                                                        if (iVar2 == 0) {
                                                          uVar8 = checkhhmmstring(param_1,*param_3,0
                                                                                 );
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,
                                                  "IRLedScheduleTueStart");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"IRLedScheduleTueEnd");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"IRLedScheduleWedStart"
                                                                    );
                                                      if (iVar2 == 0) {
                                                        uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"IRLedScheduleWedEnd"
                                                                      );
                                                        if (iVar2 == 0) {
                                                          uVar8 = checkhhmmstring(param_1,*param_3,0
                                                                                 );
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,
                                                  "IRLedScheduleThuStart");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"IRLedScheduleThuEnd");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"IRLedScheduleFriStart"
                                                                    );
                                                      if (iVar2 == 0) {
                                                        uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"IRLedScheduleFriEnd"
                                                                      );
                                                        if (iVar2 == 0) {
                                                          uVar8 = checkhhmmstring(param_1,*param_3,0
                                                                                 );
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,
                                                  "IRLedScheduleSatStart");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"IRLedScheduleSatEnd");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checkhhmmstring(param_1,*param_3,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"MotionDetectionEnable"
                                                                    );
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,1,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,
                                                  "MotionDetectionBlockSet");
                                                  if (iVar2 == 0) {
                                                    pbVar11 = *param_3;
                                                    sVar7 = strlen((char *)pbVar11);
                                                    if (sVar7 == 0x19) {
                                                      iVar2 = 0;
                                                      do {
                                                        pbVar9 = pbVar11 + iVar2;
                                                        iVar2 = iVar2 + 1;
                                                        if (1 < (byte)(*pbVar9 - 0x30)) {
                                                          return 2;
                                                        }
                                                      } while (iVar2 < 0x19);
                                                      uVar8 = 0;
                                                    }
                                                    else {
                                                      uVar8 = 1;
                                                    }
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "MotionDetectionSensitivity");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,100,0)
                                                    ;
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "MotionDetectionScheduleTimeStart");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checktimestring(param_1,*param_3,0x72);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "MotionDetectionScheduleTimeStop");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checktimestring(param_1,*param_3,0x73);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "MotionDetectionScheduleMode");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,3,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "MotionDetectionScheduleDay");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,0x7f,0
                                                                          );
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"WirelessDisable");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,1,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"SSID");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checkrangestring(param_1,*param_3,0,
                                                                                 0x20,0x25);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"WirelessChannel");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,1,
                                                                                 0xe,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"TransmissionRate")
                                                          ;
                                                          if (iVar2 == 0) {
                                                            uVar8 = checkMatchValue(param_1,param_2,
                                                                                    *param_3,
                                                  txrate_select,txrate_value);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"ConnectionMode");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,1,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"WEPEncryption");
                                                      if (iVar2 == 0) {
                                                        ppuVar12 = &wepencry_select;
                                                        pbVar11 = *param_3;
                                                        iVar2 = 0;
                                                        iVar13 = 0;
                                                        cVar1 = *wepencry_select;
                                                        while (cVar1 != '\0') {
                                                          iVar5 = strcmp((char *)pbVar11,*ppuVar12);
                                                          iVar2 = iVar2 + 1;
                                                          if (iVar5 == 0) break;
                                                          iVar13 = iVar2 * 4;
                                                          ppuVar12 = &wepencry_select + iVar2;
                                                          cVar1 = *(&wepencry_select)[iVar2];
                                                        }
                                                        uVar8 = (uint)(**(char **)((int)&
                                                  wepencry_select + iVar13) == '\0');
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"WEPKeyFormat");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,1,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"AuthenticationType");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,2,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"TxKey");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,1,
                                                                                 4,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"Key1");
                                                          if (iVar2 == 0) {
                                                            uVar8 = checkwepkey(param_1,*param_3,
                                                                                0x26,0);
                                                          }
                                                          else {
                                                            iVar2 = strcmp(param_2,"Key2");
                                                            if (iVar2 == 0) {
                                                              uVar8 = checkwepkey(param_1,*param_3,
                                                                                  0x27,0);
                                                            }
                                                            else {
                                                              iVar2 = strcmp(param_2,"Key3");
                                                              if (iVar2 == 0) {
                                                                uVar8 = checkwepkey(param_1,*param_3
                                                                                    ,0x28,0);
                                                              }
                                                              else {
                                                                iVar2 = strcmp(param_2,"Key4");
                                                                if (iVar2 == 0) {
                                                                  uVar8 = checkwepkey(param_1,*
                                                  param_3,0x29,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"PreSharedKey");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checkpresharedkey(param_1,param_2,
                                                                                *param_3,0x4d,0x4e);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"BeaconInterval");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,1,
                                                                               0xffff,0x50);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"Preamble");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 1,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,
                                                  "SoundDetectionEnable");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,1,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"SoundDetectionDB");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0x32,
                                                                             0x5a,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,
                                                  "SoundDetectionScheduleTimeStart");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checktimestring(param_1,*param_3,0x74);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "SoundDetectionScheduleTimeStop");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checktimestring(param_1,*param_3,0x75);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "SoundDetectionScheduleMode");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,1,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,
                                                  "SoundDetectionScheduleDay");
                                                  if (iVar2 == 0) {
                                                    uVar8 = checklongrange(param_1,*param_3,0,0x7f,0
                                                                          );
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"DSTEnable");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,1,0)
                                                      ;
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"DSTOffset");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,7,
                                                                               0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"DSTStartMonth");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 0xb,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"DSTStartWeek");
                                                          if (iVar2 == 0) {
                                                            uVar8 = checklongrange(param_1,*param_3,
                                                                                   0,5,0);
                                                          }
                                                          else {
                                                            iVar2 = strcmp(param_2,"DSTStartDay");
                                                            if (iVar2 == 0) {
                                                              uVar8 = checklongrange(param_1,*
                                                  param_3,0,6,0);
                                                  }
                                                  else {
                                                    iVar2 = strcmp(param_2,"DSTStartTime");
                                                    if (iVar2 == 0) {
                                                      uVar8 = checklongrange(param_1,*param_3,0,0x17
                                                                             ,0);
                                                    }
                                                    else {
                                                      iVar2 = strcmp(param_2,"DSTEndMonth");
                                                      if (iVar2 == 0) {
                                                        uVar8 = checklongrange(param_1,*param_3,0,
                                                                               0xb,0);
                                                      }
                                                      else {
                                                        iVar2 = strcmp(param_2,"DSTEndWeek");
                                                        if (iVar2 == 0) {
                                                          uVar8 = checklongrange(param_1,*param_3,0,
                                                                                 5,0);
                                                        }
                                                        else {
                                                          iVar2 = strcmp(param_2,"DSTEndDay");
                                                          if (iVar2 == 0) {
                                                            uVar8 = checklongrange(param_1,*param_3,
                                                                                   0,6,0);
                                                          }
                                                          else {
                                                            iVar2 = strcmp(param_2,"DSTEndTime");
                                                            uVar8 = 0;
                                                            if (iVar2 == 0) {
                                                              uVar8 = checklongrange(param_1,*
                                                  param_3,0,0x17,0);
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return uVar8;
}



int websGetVarCheck(undefined4 param_1,undefined4 param_2,char **param_3)

{
  char *pcVar1;
  char *pcVar2;
  int iVar3;
  
  pcVar1 = (char *)websGetVar(param_1,param_2,WebNotFound);
  *param_3 = pcVar1;
  iVar3 = 0;
  if (pcVar1 == WebNotFound) {
    pcVar1 = (char *)nvram_bufget(0,param_2,param_3);
    pcVar2 = "NulAppendVar=(%s,%s)\n";
  }
  else {
    iVar3 = CheckVarRange(param_1,param_2);
    if (iVar3 == 0) {
      return 0;
    }
    pcVar1 = (char *)nvram_bufget(0,param_2);
    pcVar2 = "ErrAppendVar=(%s,%s)\n";
  }
  *param_3 = pcVar1;
  trace(2,pcVar2,param_2,pcVar1);
  websSetVar(param_1,param_2,*param_3);
  pcVar1 = (char *)websGetVar(param_1,param_2,&DAT_0049445c);
  *param_3 = pcVar1;
  return iVar3;
}



void CheckAuthorizationModeVar
               (undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined auStack_10 [8];
  
  websGetVarCheck(param_1,"HTTPAuthentication",auStack_10,param_4,&_gp);
  return;
}



bool AuthorizationModeChanged(undefined4 param_1)

{
  char *__s1;
  char *__s2;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"HTTPAuthentication");
  __s2 = (char *)websGetVar(param_1,"HTTPAuthentication",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  return iVar1 != 0;
}



undefined4 WriteAuthorizationModeVar(undefined4 param_1)

{
  undefined4 uVar1;
  
  uVar1 = websGetVar(param_1,"HTTPAuthentication",&DAT_0049445c);
  nvram_bufset(0,"HTTPAuthentication",uVar1);
  return 0;
}



uint CheckSystemVar(undefined4 param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  undefined4 uVar9;
  uint uVar10;
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  char *local_30;
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  char *local_20 [2];
  
  iVar1 = websTestVar(param_1,"AdminPassword");
  uVar10 = 0;
  if (iVar1 != 0) {
    uVar9 = websGetVar(param_1,"AdminPassword",&DAT_0049445c);
    websSetVar(param_1,"ConfirmAdminPassword",uVar9);
    uVar10 = websGetVarCheck(param_1,"ConfirmAdminPassword",auStack_40);
  }
  uVar2 = websGetVarCheck(param_1,"CameraName",auStack_3c);
  uVar3 = websGetVarCheck(param_1,"Location",auStack_38);
  uVar4 = websGetVarCheck(param_1,"AdminID",auStack_34);
  uVar5 = websGetVarCheck(param_1,"AdminPassword",&local_30);
  uVar6 = websGetVarCheck(param_1,"LEDControl",auStack_2c);
  uVar7 = websGetVarCheck(param_1,"SnapshotURLAuthentication",auStack_28);
  uVar8 = websGetVarCheck(param_1,"AccessControlEnable",auStack_24);
  uVar8 = uVar10 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8;
  iVar1 = websTestVar(param_1,"VerifyAdminPassword");
  if (iVar1 != 0) {
    uVar10 = websGetVarCheck(param_1,"VerifyAdminPassword",local_20);
    uVar8 = uVar8 | uVar10;
    iVar1 = strcmp(local_30,local_20[0]);
    if (iVar1 != 0) {
      uVar8 = uVar8 | 1;
      uVar9 = websGetErrorMessage(0x1b);
      webAddReplyMessage(param_1,uVar9,1);
    }
  }
  return uVar8;
}



undefined4 WriteSystemVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  char *__s1;
  undefined4 uVar5;
  undefined4 uVar6;
  int iVar7;
  
  uVar1 = websGetVar(param_1,"CameraName",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"Location",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"AdminID",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"AdminPassword",&DAT_0049445c);
  __s1 = (char *)websGetVar(param_1,"LEDControl",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"SnapshotURLAuthentication",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"AccessControlEnable",&DAT_0049445c);
  nvram_bufset(0,"CameraName",uVar1);
  nvram_bufset(0,"Location",uVar2);
  nvram_bufset(0,"AdminID",uVar3);
  nvram_bufset(0,"AdminPassword",uVar4);
  nvram_bufset(0,"LEDControl",__s1);
  nvram_bufset(0,"SnapshotURLAuthentication",uVar5);
  nvram_bufset(0,"AccessControlEnable",uVar6);
  iVar7 = strcmp(__s1,"0");
  if (iVar7 == 0) {
    setSysInfoShort(0x35,0);
  }
  else {
    iVar7 = strcmp(__s1,"1");
    if (iVar7 == 0) {
      setSysInfoShort(0x35,1);
    }
    else {
      iVar7 = strcmp(__s1,"2");
      if (iVar7 != 0) {
        return 0;
      }
      setSysInfoShort(0x35,2);
    }
  }
  return 0;
}



uint CheckNetworkVar(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  undefined auStack_50 [4];
  undefined auStack_4c [4];
  undefined auStack_48 [4];
  undefined auStack_44 [4];
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [8];
  
  uVar1 = websGetVarCheck(param_1,"IPAddressMode",auStack_50);
  uVar2 = websGetVarCheck(param_1,"IPAddress",auStack_4c);
  uVar3 = websGetVarCheck(param_1,"SubnetMask",auStack_48);
  uVar4 = websGetVarCheck(param_1,"DefaultGateway",auStack_44);
  uVar5 = websGetVarCheck(param_1,"PPPoEUserID",auStack_40);
  uVar6 = websGetVarCheck(param_1,"PPPoEPassword",auStack_3c);
  uVar7 = websGetVarCheck(param_1,"DNSIPAddress1",auStack_38);
  uVar8 = websGetVarCheck(param_1,"DNSIPAddress2",auStack_34);
  uVar9 = websGetVarCheck(param_1,"SecondHTTPPortEnable",auStack_30);
  uVar10 = websGetVarCheck(param_1,"SecondHTTPPort",auStack_2c);
  uVar11 = websGetVarCheck(param_1,"UPnPEnable",auStack_28);
  uVar12 = websGetVarCheck(param_1,"UPnPPortForwarding",auStack_24);
  uVar13 = websGetVarCheck(param_1,"BonjourEnable",auStack_20);
  uVar14 = websGetVarCheck(param_1,"BonjourName",auStack_1c);
  uVar15 = websGetVarCheck(param_1,"HTTPAuthentication",auStack_18);
  return uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8 | uVar9 | uVar10 | uVar11 |
         uVar12 | uVar13 | uVar14 | uVar15;
}



undefined4 SystemNetworkChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s1_05;
  char *__s1_06;
  char *__s1_07;
  char *__s1_08;
  char *__s1_09;
  char *__s1_10;
  char *__s1_11;
  char *__s1_12;
  char *__s1_13;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  char *__s2_05;
  char *__s2_06;
  char *__s2_07;
  char *__s2_08;
  char *__s2_09;
  char *__s2_10;
  char *__s2_11;
  char *__s2_12;
  char *__s2_13;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"IPAddressMode");
  __s1_00 = (char *)nvram_bufget(0,"IPAddress");
  __s1_01 = (char *)nvram_bufget(0,"SubnetMask");
  __s1_02 = (char *)nvram_bufget(0,"DefaultGateway");
  __s1_03 = (char *)nvram_bufget(0,"PPPoEUserID");
  __s1_04 = (char *)nvram_bufget(0,"PPPoEPassword");
  __s1_05 = (char *)nvram_bufget(0,"DNSIPAddress1");
  __s1_06 = (char *)nvram_bufget(0,"DNSIPAddress2");
  __s1_07 = (char *)nvram_bufget(0,"SecondHTTPPortEnable");
  __s1_08 = (char *)nvram_bufget(0,"SecondHTTPPort");
  __s1_09 = (char *)nvram_bufget(0,"UPnPEnable");
  __s1_10 = (char *)nvram_bufget(0,"UPnPPortForwarding");
  __s1_11 = (char *)nvram_bufget(0,"BonjourEnable");
  __s1_12 = (char *)nvram_bufget(0,"BonjourName");
  __s1_13 = (char *)nvram_bufget(0,"HTTPAuthentication");
  __s2 = (char *)websGetVar(param_1,"HTTPAuthentication",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"IPAddressMode",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"IPAddress",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"SubnetMask",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"DefaultGateway",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"PPPoEUserID",&DAT_0049445c);
  __s2_05 = (char *)websGetVar(param_1,"PPPoEPassword",&DAT_0049445c);
  __s2_06 = (char *)websGetVar(param_1,"DNSIPAddress1",&DAT_0049445c);
  __s2_07 = (char *)websGetVar(param_1,"DNSIPAddress2",&DAT_0049445c);
  __s2_08 = (char *)websGetVar(param_1,"SecondHTTPPortEnable",&DAT_0049445c);
  __s2_09 = (char *)websGetVar(param_1,"SecondHTTPPort",&DAT_0049445c);
  __s2_10 = (char *)websGetVar(param_1,"UPnPEnable",&DAT_0049445c);
  __s2_11 = (char *)websGetVar(param_1,"UPnPPortForwarding",&DAT_0049445c);
  __s2_12 = (char *)websGetVar(param_1,"BonjourEnable",&DAT_0049445c);
  __s2_13 = (char *)websGetVar(param_1,"BonjourName",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2_00);
  if (((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_01), iVar1 == 0)) &&
       (iVar1 = strcmp(__s1_01,__s2_02), iVar1 == 0)) &&
      (((iVar1 = strcmp(__s1_02,__s2_03), iVar1 == 0 &&
        (iVar1 = strcmp(__s1_03,__s2_04), iVar1 == 0)) &&
       ((iVar1 = strcmp(__s1_04,__s2_05), iVar1 == 0 &&
        ((iVar1 = strcmp(__s1_05,__s2_06), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_06,__s2_07), iVar1 == 0)))))))) &&
     ((iVar1 = strcmp(__s1_07,__s2_08), iVar1 == 0 &&
      (((((iVar1 = strcmp(__s1_08,__s2_09), iVar1 == 0 && (iVar1 = strcmp(__s1_13,__s2), iVar1 == 0)
          ) && (iVar1 = strcmp(__s1_09,__s2_10), iVar1 == 0)) &&
        ((iVar1 = strcmp(__s1_10,__s2_11), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_11,__s2_12), iVar1 == 0)))) &&
       (iVar1 = strcmp(__s1_12,__s2_13), iVar1 == 0)))))) {
    return 0;
  }
  return 1;
}



undefined4 SystemDDNSChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"DDNSEnable");
  __s1_00 = (char *)nvram_bufget(0,"DDNSProvider");
  __s1_01 = (char *)nvram_bufget(0,"DDNSHostName");
  __s1_02 = (char *)nvram_bufget(0,"DDNSUserName");
  __s1_03 = (char *)nvram_bufget(0,"DDNSPassword");
  __s1_04 = (char *)nvram_bufget(0,"DDNSTimeout");
  __s2 = (char *)websGetVar(param_1,"DDNSEnable",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"DDNSProvider",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"DDNSHostName",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"DDNSUserName",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"DDNSPassword",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"DDNSTimeout",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if ((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
      (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)) &&
     (((iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0 && (iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0)
       ) && (iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0)))) {
    return 0;
  }
  return 1;
}



undefined4 WriteNetworkVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  undefined4 uVar19;
  undefined4 uVar20;
  undefined4 uVar21;
  
  uVar1 = websGetVar(param_1,"IPAddressMode",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"IPAddress",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"SubnetMask",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"DefaultGateway",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"PPPoEUserID",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"PPPoEPassword",&DAT_0049445c);
  uVar7 = websGetVar(param_1,"DNSIPAddress1",&DAT_0049445c);
  uVar8 = websGetVar(param_1,"DNSIPAddress2",&DAT_0049445c);
  uVar9 = websGetVar(param_1,"SecondHTTPPortEnable",&DAT_0049445c);
  uVar10 = websGetVar(param_1,"SecondHTTPPort",&DAT_0049445c);
  uVar11 = websGetVar(param_1,"UPnPEnable",&DAT_0049445c);
  uVar12 = websGetVar(param_1,"UPnPPortForwarding",&DAT_0049445c);
  uVar13 = websGetVar(param_1,"BonjourEnable",&DAT_0049445c);
  uVar14 = websGetVar(param_1,"BonjourName",&DAT_0049445c);
  uVar15 = websGetVar(param_1,"DDNSEnable",&DAT_0049445c);
  uVar16 = websGetVar(param_1,"DDNSProvider",&DAT_0049445c);
  uVar17 = websGetVar(param_1,"DDNSHostName",&DAT_0049445c);
  uVar18 = websGetVar(param_1,"DDNSUserName",&DAT_0049445c);
  uVar19 = websGetVar(param_1,"DDNSPassword",&DAT_0049445c);
  uVar20 = websGetVar(param_1,"DDNSTimeout",&DAT_0049445c);
  uVar21 = websGetVar(param_1,"HTTPAuthentication",&DAT_0049445c);
  nvram_bufset(0,"HTTPAuthentication",uVar21);
  nvram_bufset(0,"IPAddressMode",uVar1);
  nvram_bufset(0,"IPAddress",uVar2);
  nvram_bufset(0,"SubnetMask",uVar3);
  nvram_bufset(0,"DefaultGateway",uVar4);
  nvram_bufset(0,"PPPoEUserID",uVar5);
  nvram_bufset(0,"PPPoEPassword",uVar6);
  nvram_bufset(0,"DNSIPAddress1",uVar7);
  nvram_bufset(0,"DNSIPAddress2",uVar8);
  nvram_bufset(0,"SecondHTTPPortEnable",uVar9);
  nvram_bufset(0,"SecondHTTPPort",uVar10);
  nvram_bufset(0,"UPnPEnable",uVar11);
  nvram_bufset(0,"UPnPPortForwarding",uVar12);
  nvram_bufset(0,"BonjourEnable",uVar13);
  nvram_bufset(0,"BonjourName",uVar14);
  nvram_bufset(0,"DDNSEnable",uVar15);
  nvram_bufset(0,"DDNSProvider",uVar16);
  nvram_bufset(0,"DDNSHostName",uVar17);
  nvram_bufset(0,"DDNSUserName",uVar18);
  nvram_bufset(0,"DDNSPassword",uVar19);
  nvram_bufset(0,"DDNSTimeout",uVar20);
  return 0;
}



undefined4 SystemWirelessChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s1_05;
  char *__s1_06;
  char *__s1_07;
  char *__s1_08;
  char *__s1_09;
  char *__s1_10;
  char *__s1_11;
  char *__s1_12;
  char *__s1_13;
  char *__s1_14;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  char *__s2_05;
  char *__s2_06;
  char *__s2_07;
  char *__s2_08;
  char *__s2_09;
  char *__s2_10;
  char *__s2_11;
  char *__s2_12;
  char *__s2_13;
  char *__s2_14;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"WirelessDisable");
  __s1_00 = (char *)nvram_bufget(0,&DAT_0048d85c);
  __s1_01 = (char *)nvram_bufget(0,"WirelessChannel");
  __s1_02 = (char *)nvram_bufget(0,"TransmissionRate");
  __s1_03 = (char *)nvram_bufget(0,"ConnectionMode");
  __s1_04 = (char *)nvram_bufget(0,"WEPEncryption");
  __s1_05 = (char *)nvram_bufget(0,"WEPKeyFormat");
  __s1_06 = (char *)nvram_bufget(0,"BeaconInterval");
  __s1_07 = (char *)nvram_bufget(0,"Preamble");
  __s1_08 = (char *)nvram_bufget(0,"AuthenticationType");
  __s1_09 = (char *)nvram_bufget(0,"TxKey");
  __s1_10 = (char *)nvram_bufget(0,&DAT_0048d888);
  __s1_11 = (char *)nvram_bufget(0,&DAT_0048d890);
  __s1_12 = (char *)nvram_bufget(0,&DAT_0048d898);
  __s1_13 = (char *)nvram_bufget(0,&DAT_0048d8a0);
  __s1_14 = (char *)nvram_bufget(0,"PreSharedKey");
  __s2 = (char *)websGetVar(param_1,"WirelessDisable",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,&DAT_0048d85c,&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"WirelessChannel",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"TransmissionRate",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"ConnectionMode",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"WEPEncryption",&DAT_0049445c);
  __s2_05 = (char *)websGetVar(param_1,"WEPKeyFormat",&DAT_0049445c);
  __s2_06 = (char *)websGetVar(param_1,"BeaconInterval",&DAT_0049445c);
  __s2_07 = (char *)websGetVar(param_1,"Preamble",&DAT_0049445c);
  __s2_08 = (char *)websGetVar(param_1,"AuthenticationType",&DAT_0049445c);
  __s2_09 = (char *)websGetVar(param_1,"TxKey",&DAT_0049445c);
  __s2_10 = (char *)websGetVar(param_1,&DAT_0048d888,&DAT_0049445c);
  __s2_11 = (char *)websGetVar(param_1,&DAT_0048d890,&DAT_0049445c);
  __s2_12 = (char *)websGetVar(param_1,&DAT_0048d898,&DAT_0049445c);
  __s2_13 = (char *)websGetVar(param_1,&DAT_0048d8a0,&DAT_0049445c);
  __s2_14 = (char *)websGetVar(param_1,"PreSharedKey",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if (((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
       (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)) &&
      (((iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0 &&
        (iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0)) &&
       ((iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0 &&
        ((iVar1 = strcmp(__s1_05,__s2_05), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_06,__s2_06), iVar1 == 0)))))))) &&
     ((iVar1 = strcmp(__s1_07,__s2_07), iVar1 == 0 &&
      (((((iVar1 = strcmp(__s1_08,__s2_08), iVar1 == 0 &&
          (iVar1 = strcmp(__s1_09,__s2_09), iVar1 == 0)) &&
         (iVar1 = strcmp(__s1_10,__s2_10), iVar1 == 0)) &&
        ((iVar1 = strcmp(__s1_11,__s2_11), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_12,__s2_12), iVar1 == 0)))) &&
       ((iVar1 = strcmp(__s1_13,__s2_13), iVar1 == 0 &&
        (iVar1 = strcmp(__s1_14,__s2_14), iVar1 == 0)))))))) {
    return 0;
  }
  return 1;
}



uint CheckWirelessVar(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  char *pcVar18;
  undefined auStack_68 [4];
  undefined auStack_64 [4];
  undefined auStack_60 [4];
  undefined auStack_5c [4];
  undefined auStack_58 [4];
  undefined auStack_54 [4];
  undefined auStack_50 [4];
  undefined auStack_4c [4];
  undefined auStack_48 [4];
  undefined auStack_44 [4];
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  
  uVar1 = websGetVarCheck(param_1,"WirelessDisable",auStack_68);
  uVar2 = websGetVarCheck(param_1,&DAT_0048d85c,auStack_64);
  uVar3 = websGetVarCheck(param_1,"WirelessChannel",auStack_60);
  uVar4 = websGetVarCheck(param_1,"TransmissionRate",auStack_5c);
  uVar5 = websGetVarCheck(param_1,"ConnectionMode",auStack_58);
  uVar6 = websGetVarCheck(param_1,"WEPEncryption",auStack_54);
  iVar7 = websTestVarValue(param_1,"WEPEncryption","0");
  if (iVar7 == 0) {
    iVar7 = websTestVarValue(param_1,"WEPEncryption",&DAT_0048b534);
    if ((iVar7 == 0) &&
       (iVar7 = websTestVarValue(param_1,"WEPEncryption",&DAT_0048b53c), iVar7 == 0)) {
      iVar7 = websTestVarValue(param_1,"WEPEncryption",&DAT_0048b544);
      if (iVar7 == 0) goto LAB_00426d7c;
      websDeleteVar(param_1,"WEPKeyFormat");
      websDeleteVar(param_1,"AuthenticationType");
      websDeleteVar(param_1,"TxKey");
      websDeleteVar(param_1,&DAT_0048d888);
      websDeleteVar(param_1,&DAT_0048d890);
      websDeleteVar(param_1,&DAT_0048d898);
      pcVar18 = "Key4";
    }
    else {
      pcVar18 = "PreSharedKey";
    }
  }
  else {
    websDeleteVar(param_1,"WEPKeyFormat");
    websDeleteVar(param_1,"AuthenticationType");
    websDeleteVar(param_1,"TxKey");
    websDeleteVar(param_1,&DAT_0048d888);
    websDeleteVar(param_1,&DAT_0048d890);
    websDeleteVar(param_1,&DAT_0048d898);
    websDeleteVar(param_1,&DAT_0048d8a0);
    pcVar18 = "PreSharedKey";
  }
  websDeleteVar(param_1,pcVar18);
LAB_00426d7c:
  uVar8 = websGetVarCheck(param_1,"WEPKeyFormat",auStack_50);
  uVar9 = websGetVarCheck(param_1,"BeaconInterval",auStack_4c);
  uVar10 = websGetVarCheck(param_1,"Preamble",auStack_48);
  uVar11 = websGetVarCheck(param_1,"AuthenticationType",auStack_44);
  uVar12 = websGetVarCheck(param_1,"TxKey",auStack_40);
  uVar13 = websGetVarCheck(param_1,&DAT_0048d888,auStack_3c);
  uVar14 = websGetVarCheck(param_1,&DAT_0048d890,auStack_38);
  uVar15 = websGetVarCheck(param_1,&DAT_0048d898,auStack_34);
  uVar16 = websGetVarCheck(param_1,&DAT_0048d8a0,auStack_30);
  uVar17 = websGetVarCheck(param_1,"PreSharedKey",auStack_2c);
  return uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar8 | uVar9 | uVar10 | uVar11 | uVar12 |
         uVar13 | uVar14 | uVar15 | uVar16 | uVar17;
}



undefined4 WriteWirelessVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  
  uVar1 = websGetVar(param_1,"WirelessDisable",&DAT_0049445c);
  uVar2 = websGetVar(param_1,&DAT_0048d85c,&DAT_0049445c);
  uVar3 = websGetVar(param_1,"WirelessChannel",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"TransmissionRate",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"ConnectionMode",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"WEPEncryption",&DAT_0049445c);
  uVar7 = websGetVar(param_1,"WEPKeyFormat",&DAT_0049445c);
  uVar8 = websGetVar(param_1,"BeaconInterval",&DAT_0049445c);
  uVar9 = websGetVar(param_1,"Preamble",&DAT_0049445c);
  uVar10 = websGetVar(param_1,"AuthenticationType",&DAT_0049445c);
  uVar11 = websGetVar(param_1,"TxKey",&DAT_0049445c);
  uVar12 = websGetVar(param_1,&DAT_0048d888,&DAT_0049445c);
  uVar13 = websGetVar(param_1,&DAT_0048d890,&DAT_0049445c);
  uVar14 = websGetVar(param_1,&DAT_0048d898,&DAT_0049445c);
  uVar15 = websGetVar(param_1,&DAT_0048d8a0,&DAT_0049445c);
  uVar16 = websGetVar(param_1,"PreSharedKey",&DAT_0049445c);
  nvram_bufset(0,"WirelessDisable",uVar1);
  nvram_bufset(0,&DAT_0048d85c,uVar2);
  nvram_bufset(0,"WirelessChannel",uVar3);
  nvram_bufset(0,"TransmissionRate",uVar4);
  nvram_bufset(0,"ConnectionMode",uVar5);
  nvram_bufset(0,"WEPEncryption",uVar6);
  nvram_bufset(0,"WEPKeyFormat",uVar7);
  nvram_bufset(0,"BeaconInterval",uVar8);
  nvram_bufset(0,"Preamble",uVar9);
  nvram_bufset(0,"AuthenticationType",uVar10);
  nvram_bufset(0,"TxKey",uVar11);
  nvram_bufset(0,&DAT_0048d888,uVar12);
  nvram_bufset(0,&DAT_0048d890,uVar13);
  nvram_bufset(0,&DAT_0048d898,uVar14);
  nvram_bufset(0,&DAT_0048d8a0,uVar15);
  nvram_bufset(0,"PreSharedKey",uVar16);
  return 0;
}



uint CheckStreamVar(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  undefined auStack_48 [4];
  undefined auStack_44 [4];
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [8];
  
  uVar1 = websGetVarCheck(param_1,"BrightnessControl",auStack_48);
  uVar2 = websGetVarCheck(param_1,"ContrastControl",auStack_44);
  uVar3 = websGetVarCheck(param_1,"SaturationControl",auStack_40);
  uVar4 = websGetVarCheck(param_1,"SharpnessControl",auStack_3c);
  uVar5 = websGetVarCheck(param_1,"AntiFlickerEnable",auStack_38);
  uVar6 = websGetVarCheck(param_1,"Mirror",auStack_34);
  uVar7 = websGetVarCheck(param_1,"VideoResolution",auStack_30);
  uVar8 = websGetVarCheck(param_1,"CompressionRate",auStack_2c);
  uVar9 = websGetVarCheck(param_1,"FrameRate",auStack_28);
  uVar10 = websGetVarCheck(param_1,"ViewMode",auStack_24);
  uVar11 = websGetVarCheck(param_1,"LightFrequency",auStack_20);
  uVar12 = websGetVarCheck(param_1,"AudioEnable",auStack_1c);
  uVar13 = websGetVarCheck(param_1,"AudioVolume",auStack_18);
  return uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8 | uVar9 | uVar10 | uVar11 |
         uVar12 | uVar13;
}



undefined4 StreamImageChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"BrightnessControl");
  __s1_00 = (char *)nvram_bufget(0,"ContrastControl");
  __s1_01 = (char *)nvram_bufget(0,"SaturationControl");
  __s1_02 = (char *)nvram_bufget(0,"SharpnessControl");
  __s1_03 = (char *)nvram_bufget(0,"AntiFlickerEnable");
  __s1_04 = (char *)nvram_bufget(0,"Mirror");
  __s2 = (char *)websGetVar(param_1,"BrightnessControl",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"ContrastControl",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"SaturationControl",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"SharpnessControl",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"AntiFlickerEnable",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"Mirror",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if ((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
      (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)) &&
     (((iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0 && (iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0)
       ) && (iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0)))) {
    return 0;
  }
  return 1;
}



undefined4 StreamVideoChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"VideoResolution");
  __s1_00 = (char *)nvram_bufget(0,"CompressionRate");
  __s1_01 = (char *)nvram_bufget(0,"FrameRate");
  __s1_02 = (char *)nvram_bufget(0,"LightFrequency");
  __s2 = (char *)websGetVar(param_1,"LightFrequency",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"VideoResolution",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"CompressionRate",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"FrameRate",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2_00);
  if ((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_01), iVar1 == 0)) &&
      (iVar1 = strcmp(__s1_02,__s2), iVar1 == 0)) && (iVar1 = strcmp(__s1_01,__s2_02), iVar1 == 0))
  {
    return 0;
  }
  return 1;
}



undefined4 StreamAudioChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s2;
  char *__s2_00;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"AudioEnable");
  __s1_00 = (char *)nvram_bufget(0,"AudioVolume");
  __s2 = (char *)websGetVar(param_1,"AudioEnable",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"AudioVolume",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if ((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) {
    return 0;
  }
  return 1;
}



undefined4 WriteStreamVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  
  uVar1 = websGetVar(param_1,"BrightnessControl",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"ContrastControl",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"SaturationControl",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"SharpnessControl",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"AntiFlickerEnable",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"Mirror",&DAT_0049445c);
  uVar7 = websGetVar(param_1,"VideoResolution",&DAT_0049445c);
  uVar8 = websGetVar(param_1,"CompressionRate",&DAT_0049445c);
  uVar9 = websGetVar(param_1,"FrameRate",&DAT_0049445c);
  uVar10 = websGetVar(param_1,"ViewMode",&DAT_0049445c);
  uVar11 = websGetVar(param_1,"LightFrequency",&DAT_0049445c);
  uVar12 = websGetVar(param_1,"AudioEnable",&DAT_0049445c);
  uVar13 = websGetVar(param_1,"AudioVolume",&DAT_0049445c);
  nvram_bufset(0,"BrightnessControl",uVar1);
  nvram_bufset(0,"ContrastControl",uVar2);
  nvram_bufset(0,"SaturationControl",uVar3);
  nvram_bufset(0,"SharpnessControl",uVar4);
  nvram_bufset(0,"AntiFlickerEnable",uVar5);
  nvram_bufset(0,"Mirror",uVar6);
  nvram_bufset(0,"VideoResolution",uVar7);
  nvram_bufset(0,"CompressionRate",uVar8);
  nvram_bufset(0,"FrameRate",uVar9);
  nvram_bufset(0,"ViewMode",uVar10);
  nvram_bufset(0,"LightFrequency",uVar11);
  nvram_bufset(0,"AudioEnable",uVar12);
  nvram_bufset(0,"AudioVolume",uVar13);
  return 0;
}



uint CheckEmailVar(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  undefined auStack_50 [4];
  undefined auStack_4c [4];
  undefined auStack_48 [4];
  undefined auStack_44 [4];
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [8];
  
  uVar1 = websGetVarCheck(param_1,"EmailScheduleEnable",auStack_50);
  uVar2 = websGetVarCheck(param_1,"EmailScheduleDay",auStack_4c);
  uVar3 = websGetVarCheck(param_1,"EmailSMTPServerAddress",auStack_48);
  uVar4 = websGetVarCheck(param_1,"EmailSMTPPortNumber",auStack_44);
  uVar5 = websGetVarCheck(param_1,"EmailSenderAddress",auStack_40);
  uVar6 = websGetVarCheck(param_1,"EmailReceiverAddress",auStack_3c);
  uVar7 = websGetVarCheck(param_1,"EmailUserName",auStack_38);
  uVar8 = websGetVarCheck(param_1,"EmailPassword",auStack_34);
  uVar9 = websGetVarCheck(param_1,"EmailTLSAuthentication",auStack_30);
  uVar10 = websGetVarCheck(param_1,"EmailScheduleMode",auStack_2c);
  uVar11 = websGetVarCheck(param_1,"EmailScheduleTimeStart",auStack_28);
  uVar12 = websGetVarCheck(param_1,"EmailScheduleTimeStop",auStack_24);
  uVar13 = websGetVarCheck(param_1,"EmailScheduleInterval",auStack_20);
  uVar14 = websGetVarCheck(param_1,"EmailMotionMode",auStack_1c);
  uVar15 = websGetVarCheck(param_1,"EmailMotionFrameInterval",auStack_18);
  return uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8 | uVar9 | uVar10 | uVar11 |
         uVar12 | uVar13 | uVar14 | uVar15;
}



undefined4 SystemEmailChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s1_05;
  char *__s1_06;
  char *__s1_07;
  char *__s1_08;
  char *__s1_09;
  char *__s1_10;
  char *__s1_11;
  char *__s1_12;
  char *__s1_13;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  char *__s2_05;
  char *__s2_06;
  char *__s2_07;
  char *__s2_08;
  char *__s2_09;
  char *__s2_10;
  char *__s2_11;
  char *__s2_12;
  char *__s2_13;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"EmailScheduleEnable");
  __s1_00 = (char *)nvram_bufget(0,"EmailScheduleDay");
  __s1_01 = (char *)nvram_bufget(0,"EmailSMTPServerAddress");
  __s1_02 = (char *)nvram_bufget(0,"EmailSMTPPortNumber");
  __s1_03 = (char *)nvram_bufget(0,"EmailSenderAddress");
  __s1_04 = (char *)nvram_bufget(0,"EmailReceiverAddress");
  __s1_05 = (char *)nvram_bufget(0,"EmailUserName");
  __s1_06 = (char *)nvram_bufget(0,"EmailPassword");
  __s1_07 = (char *)nvram_bufget(0,"EmailTLSAuthentication");
  __s1_08 = (char *)nvram_bufget(0,"EmailScheduleMode");
  __s1_09 = (char *)nvram_bufget(0,"EmailScheduleTimeStart");
  __s1_10 = (char *)nvram_bufget(0,"EmailScheduleTimeStop");
  __s1_11 = (char *)nvram_bufget(0,"EmailScheduleInterval");
  __s1_12 = (char *)nvram_bufget(0,"EmailMotionMode");
  __s1_13 = (char *)nvram_bufget(0,"EmailMotionFrameInterval");
  __s2 = (char *)websGetVar(param_1,"EmailScheduleEnable",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"EmailScheduleDay",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"EmailSMTPServerAddress",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"EmailSMTPPortNumber",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"EmailSenderAddress",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"EmailReceiverAddress",&DAT_0049445c);
  __s2_05 = (char *)websGetVar(param_1,"EmailUserName",&DAT_0049445c);
  __s2_06 = (char *)websGetVar(param_1,"EmailPassword",&DAT_0049445c);
  __s2_07 = (char *)websGetVar(param_1,"EmailTLSAuthentication",&DAT_0049445c);
  __s2_08 = (char *)websGetVar(param_1,"EmailScheduleMode",&DAT_0049445c);
  __s2_09 = (char *)websGetVar(param_1,"EmailScheduleTimeStart",&DAT_0049445c);
  __s2_10 = (char *)websGetVar(param_1,"EmailScheduleTimeStop",&DAT_0049445c);
  __s2_11 = (char *)websGetVar(param_1,"EmailScheduleInterval",&DAT_0049445c);
  __s2_12 = (char *)websGetVar(param_1,"EmailMotionMode",&DAT_0049445c);
  __s2_13 = (char *)websGetVar(param_1,"EmailMotionFrameInterval",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if (((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
       (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)) &&
      (((iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0 &&
        (iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0)) &&
       ((iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0 &&
        ((iVar1 = strcmp(__s1_05,__s2_05), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_06,__s2_06), iVar1 == 0)))))))) &&
     ((iVar1 = strcmp(__s1_07,__s2_07), iVar1 == 0 &&
      (((((iVar1 = strcmp(__s1_08,__s2_08), iVar1 == 0 &&
          (iVar1 = strcmp(__s1_09,__s2_09), iVar1 == 0)) &&
         (iVar1 = strcmp(__s1_10,__s2_10), iVar1 == 0)) &&
        ((iVar1 = strcmp(__s1_11,__s2_11), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_12,__s2_12), iVar1 == 0)))) &&
       (iVar1 = strcmp(__s1_13,__s2_13), iVar1 == 0)))))) {
    return 0;
  }
  return 1;
}



undefined4 WriteEmailVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  
  uVar1 = websGetVar(param_1,"EmailScheduleEnable",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"EmailScheduleDay",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"EmailSMTPServerAddress",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"EmailSMTPPortNumber",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"EmailSenderAddress",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"EmailReceiverAddress",&DAT_0049445c);
  uVar7 = websGetVar(param_1,"EmailUserName",&DAT_0049445c);
  uVar8 = websGetVar(param_1,"EmailPassword",&DAT_0049445c);
  uVar9 = websGetVar(param_1,"EmailTLSAuthentication",&DAT_0049445c);
  uVar10 = websGetVar(param_1,"EmailScheduleMode",&DAT_0049445c);
  uVar11 = websGetVar(param_1,"EmailScheduleTimeStart",&DAT_0049445c);
  uVar12 = websGetVar(param_1,"EmailScheduleTimeStop",&DAT_0049445c);
  uVar13 = websGetVar(param_1,"EmailScheduleInterval",&DAT_0049445c);
  uVar14 = websGetVar(param_1,"EmailMotionMode",&DAT_0049445c);
  uVar15 = websGetVar(param_1,"EmailMotionFrameInterval",&DAT_0049445c);
  nvram_bufset(0,"EmailScheduleEnable",uVar1);
  nvram_bufset(0,"EmailScheduleDay",uVar2);
  nvram_bufset(0,"EmailSMTPServerAddress",uVar3);
  nvram_bufset(0,"EmailSMTPPortNumber",uVar4);
  nvram_bufset(0,"EmailSenderAddress",uVar5);
  nvram_bufset(0,"EmailReceiverAddress",uVar6);
  nvram_bufset(0,"EmailUserName",uVar7);
  nvram_bufset(0,"EmailPassword",uVar8);
  nvram_bufset(0,"EmailTLSAuthentication",uVar9);
  nvram_bufset(0,"EmailScheduleMode",uVar10);
  nvram_bufset(0,"EmailScheduleTimeStart",uVar11);
  nvram_bufset(0,"EmailScheduleTimeStop",uVar12);
  nvram_bufset(0,"EmailScheduleInterval",uVar13);
  nvram_bufset(0,"EmailMotionMode",uVar14);
  nvram_bufset(0,"EmailMotionFrameInterval",uVar15);
  return 0;
}



uint CheckFTPVar(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  undefined auStack_58 [4];
  undefined auStack_54 [4];
  undefined auStack_50 [4];
  undefined auStack_4c [4];
  undefined auStack_48 [4];
  undefined auStack_44 [4];
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [4];
  undefined auStack_14 [4];
  
  uVar1 = websGetVarCheck(param_1,"FTPScheduleEnable",auStack_58);
  uVar2 = websGetVarCheck(param_1,"FTPScheduleDay",auStack_54);
  uVar3 = websGetVarCheck(param_1,"FTPHostAddress",auStack_50);
  uVar4 = websGetVarCheck(param_1,"FTPPortNumber",auStack_4c);
  uVar5 = websGetVarCheck(param_1,"FTPUserName",auStack_48);
  uVar6 = websGetVarCheck(param_1,"FTPPassword",auStack_44);
  uVar7 = websGetVarCheck(param_1,"FTPDirectoryPath",auStack_40);
  uVar8 = websGetVarCheck(param_1,"FTPPassiveMode",auStack_3c);
  uVar9 = websGetVarCheck(param_1,"FTPScheduleMode",auStack_38);
  uVar10 = websGetVarCheck(param_1,"FTPScheduleTimeStart",auStack_34);
  uVar11 = websGetVarCheck(param_1,"FTPScheduleTimeStop",auStack_30);
  uVar12 = websGetVarCheck(param_1,"FTPScheduleVideoFrequencyMode",auStack_2c);
  uVar13 = websGetVarCheck(param_1,"FTPScheduleFramePerSecond",auStack_28);
  uVar14 = websGetVarCheck(param_1,"FTPScheduleSecondPerFrame",auStack_24);
  uVar15 = websGetVarCheck(param_1,"FTPScheduleBaseFileName",auStack_20);
  uVar16 = websGetVarCheck(param_1,"FTPScheduleFileMode",auStack_1c);
  uVar17 = websGetVarCheck(param_1,"FTPScheduleMaxFileSequenceNumber",auStack_18);
  uVar18 = websGetVarCheck(param_1,"FTPCreateFolderInterval",auStack_14);
  return uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8 | uVar9 | uVar10 | uVar11 |
         uVar12 | uVar13 | uVar14 | uVar15 | uVar16 | uVar17 | uVar18;
}



undefined4 SystemFTPChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s1_05;
  char *__s1_06;
  char *__s1_07;
  char *__s1_08;
  char *__s1_09;
  char *__s1_10;
  char *__s1_11;
  char *__s1_12;
  char *__s1_13;
  char *__s1_14;
  char *__s1_15;
  char *__s1_16;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  char *__s2_05;
  char *__s2_06;
  char *__s2_07;
  char *__s2_08;
  char *__s2_09;
  char *__s2_10;
  char *__s2_11;
  char *__s2_12;
  char *__s2_13;
  char *__s2_14;
  char *__s2_15;
  char *__s2_16;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"FTPScheduleEnable");
  __s1_00 = (char *)nvram_bufget(0,"FTPScheduleDay");
  __s1_01 = (char *)nvram_bufget(0,"FTPHostAddress");
  __s1_02 = (char *)nvram_bufget(0,"FTPPortNumber");
  __s1_03 = (char *)nvram_bufget(0,"FTPUserName");
  __s1_04 = (char *)nvram_bufget(0,"FTPPassword");
  __s1_05 = (char *)nvram_bufget(0,"FTPDirectoryPath");
  __s1_06 = (char *)nvram_bufget(0,"FTPPassiveMode");
  __s1_07 = (char *)nvram_bufget(0,"FTPScheduleMode");
  __s1_08 = (char *)nvram_bufget(0,"FTPScheduleTimeStart");
  __s1_09 = (char *)nvram_bufget(0,"FTPScheduleTimeStop");
  __s1_10 = (char *)nvram_bufget(0,"FTPScheduleVideoFrequencyMode");
  __s1_11 = (char *)nvram_bufget(0,"FTPScheduleFramePerSecond");
  __s1_12 = (char *)nvram_bufget(0,"FTPScheduleSecondPerFrame");
  __s1_13 = (char *)nvram_bufget(0,"FTPScheduleBaseFileName");
  __s1_14 = (char *)nvram_bufget(0,"FTPScheduleFileMode");
  __s1_15 = (char *)nvram_bufget(0,"FTPScheduleMaxFileSequenceNumber");
  __s1_16 = (char *)nvram_bufget(0,"FTPCreateFolderInterval");
  __s2 = (char *)websGetVar(param_1,"FTPScheduleEnable",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"FTPScheduleDay",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"FTPHostAddress",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"FTPPortNumber",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"FTPUserName",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"FTPPassword",&DAT_0049445c);
  __s2_05 = (char *)websGetVar(param_1,"FTPDirectoryPath",&DAT_0049445c);
  __s2_06 = (char *)websGetVar(param_1,"FTPPassiveMode",&DAT_0049445c);
  __s2_07 = (char *)websGetVar(param_1,"FTPScheduleMode",&DAT_0049445c);
  __s2_08 = (char *)websGetVar(param_1,"FTPScheduleTimeStart",&DAT_0049445c);
  __s2_09 = (char *)websGetVar(param_1,"FTPScheduleTimeStop",&DAT_0049445c);
  __s2_10 = (char *)websGetVar(param_1,"FTPScheduleVideoFrequencyMode",&DAT_0049445c);
  __s2_11 = (char *)websGetVar(param_1,"FTPScheduleFramePerSecond",&DAT_0049445c);
  __s2_12 = (char *)websGetVar(param_1,"FTPScheduleSecondPerFrame",&DAT_0049445c);
  __s2_13 = (char *)websGetVar(param_1,"FTPScheduleBaseFileName",&DAT_0049445c);
  __s2_14 = (char *)websGetVar(param_1,"FTPScheduleFileMode",&DAT_0049445c);
  __s2_15 = (char *)websGetVar(param_1,"FTPScheduleMaxFileSequenceNumber",&DAT_0049445c);
  __s2_16 = (char *)websGetVar(param_1,"FTPCreateFolderInterval",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if (((((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
         (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)) &&
        ((iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0)))) &&
       ((iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0 &&
        ((iVar1 = strcmp(__s1_05,__s2_05), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_06,__s2_06), iVar1 == 0)))))) &&
      (iVar1 = strcmp(__s1_07,__s2_07), iVar1 == 0)) &&
     (((((iVar1 = strcmp(__s1_08,__s2_08), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_09,__s2_09), iVar1 == 0)) &&
        (iVar1 = strcmp(__s1_10,__s2_10), iVar1 == 0)) &&
       (((iVar1 = strcmp(__s1_11,__s2_11), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_12,__s2_12), iVar1 == 0)) &&
        ((iVar1 = strcmp(__s1_13,__s2_13), iVar1 == 0 &&
         ((iVar1 = strcmp(__s1_14,__s2_14), iVar1 == 0 &&
          (iVar1 = strcmp(__s1_15,__s2_15), iVar1 == 0)))))))) &&
      (iVar1 = strcmp(__s1_16,__s2_16), iVar1 == 0)))) {
    return 0;
  }
  return 1;
}



undefined4 WriteFTPVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  undefined4 uVar17;
  undefined4 uVar18;
  
  uVar1 = websGetVar(param_1,"FTPScheduleEnable",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"FTPScheduleDay",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"FTPHostAddress",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"FTPPortNumber",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"FTPUserName",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"FTPPassword",&DAT_0049445c);
  uVar7 = websGetVar(param_1,"FTPDirectoryPath",&DAT_0049445c);
  uVar8 = websGetVar(param_1,"FTPPassiveMode",&DAT_0049445c);
  uVar9 = websGetVar(param_1,"FTPScheduleMode",&DAT_0049445c);
  uVar10 = websGetVar(param_1,"FTPScheduleTimeStart",&DAT_0049445c);
  uVar11 = websGetVar(param_1,"FTPScheduleTimeStop",&DAT_0049445c);
  uVar12 = websGetVar(param_1,"FTPScheduleVideoFrequencyMode",&DAT_0049445c);
  uVar13 = websGetVar(param_1,"FTPScheduleFramePerSecond",&DAT_0049445c);
  uVar14 = websGetVar(param_1,"FTPScheduleSecondPerFrame",&DAT_0049445c);
  uVar15 = websGetVar(param_1,"FTPScheduleBaseFileName",&DAT_0049445c);
  uVar16 = websGetVar(param_1,"FTPScheduleFileMode",&DAT_0049445c);
  uVar17 = websGetVar(param_1,"FTPScheduleMaxFileSequenceNumber",&DAT_0049445c);
  uVar18 = websGetVar(param_1,"FTPCreateFolderInterval",&DAT_0049445c);
  nvram_bufset(0,"FTPScheduleEnable",uVar1);
  nvram_bufset(0,"FTPScheduleDay",uVar2);
  nvram_bufset(0,"FTPHostAddress",uVar3);
  nvram_bufset(0,"FTPPortNumber",uVar4);
  nvram_bufset(0,"FTPUserName",uVar5);
  nvram_bufset(0,"FTPPassword",uVar6);
  nvram_bufset(0,"FTPDirectoryPath",uVar7);
  nvram_bufset(0,"FTPPassiveMode",uVar8);
  nvram_bufset(0,"FTPScheduleMode",uVar9);
  nvram_bufset(0,"FTPScheduleTimeStart",uVar10);
  nvram_bufset(0,"FTPScheduleTimeStop",uVar11);
  nvram_bufset(0,"FTPScheduleVideoFrequencyMode",uVar12);
  nvram_bufset(0,"FTPScheduleFramePerSecond",uVar13);
  nvram_bufset(0,"FTPScheduleSecondPerFrame",uVar14);
  nvram_bufset(0,"FTPScheduleBaseFileName",uVar15);
  nvram_bufset(0,"FTPScheduleFileMode",uVar16);
  nvram_bufset(0,"FTPScheduleMaxFileSequenceNumber",uVar17);
  nvram_bufset(0,"FTPCreateFolderInterval",uVar18);
  return 0;
}



uint CheckDateVar(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  undefined auStack_50 [4];
  undefined auStack_4c [4];
  undefined auStack_48 [4];
  undefined auStack_44 [4];
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [4];
  undefined auStack_14 [4];
  
  uVar1 = websGetVarCheck(param_1,"DateTimeMode",auStack_50);
  uVar2 = websGetVarCheck(param_1,"TimeServerIPAddress",auStack_4c);
  uVar3 = websGetVarCheck(param_1,"Date",auStack_48);
  uVar4 = websGetVarCheck(param_1,"Time",auStack_44);
  uVar5 = websGetVarCheck(param_1,"TimeZoneIndex",auStack_40);
  uVar6 = websGetVarCheck(param_1,"TimeZone",auStack_3c);
  uVar7 = websGetVarCheck(param_1,"DSTEnable",auStack_38);
  uVar8 = websGetVarCheck(param_1,"DSTOffset",auStack_34);
  uVar9 = websGetVarCheck(param_1,"DSTStartMonth",auStack_30);
  uVar10 = websGetVarCheck(param_1,"DSTStartWeek",auStack_2c);
  uVar11 = websGetVarCheck(param_1,"DSTStartDay",auStack_28);
  uVar12 = websGetVarCheck(param_1,"DSTStartTime",auStack_24);
  uVar13 = websGetVarCheck(param_1,"DSTEndMonth",auStack_20);
  uVar14 = websGetVarCheck(param_1,"DSTEndWeek",auStack_1c);
  uVar15 = websGetVarCheck(param_1,"DSTEndDay",auStack_18);
  uVar16 = websGetVarCheck(param_1,"DSTEndTime",auStack_14);
  return uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8 | uVar9 | uVar10 | uVar11 |
         uVar12 | uVar13 | uVar14 | uVar15 | uVar16;
}



undefined4 SystemDateChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  char *__s1_05;
  char *__s1_06;
  char *__s1_07;
  char *__s1_08;
  char *__s1_09;
  char *__s1_10;
  char *__s1_11;
  char *__s1_12;
  char *__s1_13;
  char *__s1_14;
  char *__s2_05;
  char *__s2_06;
  char *__s2_07;
  char *__s2_08;
  char *__s2_09;
  char *__s2_10;
  char *__s2_11;
  char *__s2_12;
  char *__s2_13;
  char *__s2_14;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"DateTimeMode");
  __s1_00 = (char *)nvram_bufget(0,"TimeServerIPAddress");
  __s1_01 = (char *)nvram_bufget(0,"TimeZoneIndex");
  __s1_02 = (char *)nvram_bufget(0,"Date");
  __s1_03 = (char *)nvram_bufget(0,"Time");
  __s1_04 = (char *)nvram_bufget(0,"TimeZone");
  __s2 = (char *)websGetVar(param_1,"DateTimeMode",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"TimeServerIPAddress",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"TimeZoneIndex",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"Date",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"Time",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"TimeZone",&DAT_0049445c);
  __s1_05 = (char *)nvram_bufget(0,"DSTEnable");
  __s1_06 = (char *)nvram_bufget(0,"DSTOffset");
  __s1_07 = (char *)nvram_bufget(0,"DSTStartMonth");
  __s1_08 = (char *)nvram_bufget(0,"DSTStartWeek");
  __s1_09 = (char *)nvram_bufget(0,"DSTStartDay");
  __s1_10 = (char *)nvram_bufget(0,"DSTStartTime");
  __s1_11 = (char *)nvram_bufget(0,"DSTEndMonth");
  __s1_12 = (char *)nvram_bufget(0,"DSTEndWeek");
  __s1_13 = (char *)nvram_bufget(0,"DSTEndDay");
  __s1_14 = (char *)nvram_bufget(0,"DSTEndTime");
  __s2_05 = (char *)websGetVar(param_1,"DSTEnable",&DAT_0049445c);
  __s2_06 = (char *)websGetVar(param_1,"DSTOffset",&DAT_0049445c);
  __s2_07 = (char *)websGetVar(param_1,"DSTStartMonth",&DAT_0049445c);
  __s2_08 = (char *)websGetVar(param_1,"DSTStartWeek",&DAT_0049445c);
  __s2_09 = (char *)websGetVar(param_1,"DSTStartDay",&DAT_0049445c);
  __s2_10 = (char *)websGetVar(param_1,"DSTStartTime",&DAT_0049445c);
  __s2_11 = (char *)websGetVar(param_1,"DSTEndMonth",&DAT_0049445c);
  __s2_12 = (char *)websGetVar(param_1,"DSTEndWeek",&DAT_0049445c);
  __s2_13 = (char *)websGetVar(param_1,"DSTEndDay",&DAT_0049445c);
  __s2_14 = (char *)websGetVar(param_1,"DSTEndTime",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if (((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
       (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)) &&
      (((iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0 &&
        (iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0)) &&
       ((iVar1 = strcmp(__s1_05,__s2_05), iVar1 == 0 &&
        ((iVar1 = strcmp(__s1_06,__s2_06), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_07,__s2_07), iVar1 == 0)))))))) &&
     ((iVar1 = strcmp(__s1_08,__s2_08), iVar1 == 0 &&
      (((((iVar1 = strcmp(__s1_09,__s2_09), iVar1 == 0 &&
          (iVar1 = strcmp(__s1_11,__s2_11), iVar1 == 0)) &&
         (iVar1 = strcmp(__s1_10,__s2_10), iVar1 == 0)) &&
        ((iVar1 = strcmp(__s1_12,__s2_12), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_13,__s2_13), iVar1 == 0)))) &&
       ((iVar1 = strcmp(__s1_14,__s2_14), iVar1 == 0 &&
        (iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0)))))))) {
    return 0;
  }
  return 1;
}



undefined4 WriteDateVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  
  uVar1 = websGetVar(param_1,"DateTimeMode",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"TimeServerIPAddress",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"Date",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"Time",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"TimeZoneIndex",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"TimeZone",&DAT_0049445c);
  nvram_bufset(0,"DateTimeMode",uVar1);
  nvram_bufset(0,"TimeServerIPAddress",uVar2);
  nvram_bufset(0,"Date",uVar3);
  nvram_bufset(0,"Time",uVar4);
  nvram_bufset(0,"TimeZoneIndex",uVar5);
  nvram_bufset(0,"TimeZone",uVar6);
  uVar1 = websGetVar(param_1,"DSTEnable",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"DSTOffset",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"DSTStartMonth",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"DSTStartWeek",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"DSTStartDay",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"DSTStartTime",&DAT_0049445c);
  uVar7 = websGetVar(param_1,"DSTEndMonth",&DAT_0049445c);
  uVar8 = websGetVar(param_1,"DSTEndWeek",&DAT_0049445c);
  uVar9 = websGetVar(param_1,"DSTEndDay",&DAT_0049445c);
  uVar10 = websGetVar(param_1,"DSTEndTime",&DAT_0049445c);
  nvram_bufset(0,"DSTEnable",uVar1);
  nvram_bufset(0,"DSTOffset",uVar2);
  nvram_bufset(0,"DSTStartMonth",uVar3);
  nvram_bufset(0,"DSTStartWeek",uVar4);
  nvram_bufset(0,"DSTStartDay",uVar5);
  nvram_bufset(0,"DSTStartTime",uVar6);
  nvram_bufset(0,"DSTEndMonth",uVar7);
  nvram_bufset(0,"DSTEndWeek",uVar8);
  nvram_bufset(0,"DSTEndDay",uVar9);
  nvram_bufset(0,"DSTEndTime",uVar10);
  return 0;
}



uint CheckMotionVar(undefined4 param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  char *__src;
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [8];
  
  iVar1 = strcmp(s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0,"xxxxxxxxxxxxxxxxxxxxxxxxx");
  if (iVar1 == 0) {
    __src = (char *)nvram_bufget(0,"MotionDetectionBlockSet");
    if ((__src == (char *)0x0) || (*__src == '\0')) {
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[4] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[5] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[6] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[7] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[12] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[13] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[14] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[15] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[24] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[25] = '\0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[8] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[9] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[10] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[11] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[16] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[17] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[18] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[19] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[0] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[1] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[2] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[3] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[20] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[21] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[22] = '0';
      s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0[23] = '0';
      iVar1 = websTestVar(param_1,"MotionDetectionBlockSet");
      goto joined_r0x0042a718;
    }
    strcpy(s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0,__src);
  }
  iVar1 = websTestVar(param_1,"MotionDetectionBlockSet");
joined_r0x0042a718:
  if (iVar1 == 0) {
    websSetVar(param_1,"MotionDetectionBlockSet",s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0);
  }
  uVar2 = websGetVarCheck(param_1,"MotionDetectionEnable",auStack_30);
  uVar3 = websGetVarCheck(param_1,"MotionDetectionBlockSet",auStack_2c);
  uVar4 = websGetVarCheck(param_1,"MotionDetectionSensitivity",auStack_28);
  uVar5 = websGetVarCheck(param_1,"MotionDetectionScheduleDay",auStack_24);
  uVar6 = websGetVarCheck(param_1,"MotionDetectionScheduleMode",auStack_20);
  uVar7 = websGetVarCheck(param_1,"MotionDetectionScheduleTimeStart",auStack_1c);
  uVar8 = websGetVarCheck(param_1,"MotionDetectionScheduleTimeStop",auStack_18);
  return uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8;
}



undefined4 WriteMotionVar(undefined4 param_1)

{
  undefined4 uVar1;
  char *__src;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  
  uVar1 = websGetVar(param_1,"MotionDetectionEnable",&DAT_0049445c);
  __src = (char *)websGetVar(param_1,"MotionDetectionBlockSet",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"MotionDetectionSensitivity",&DAT_0049445c);
  nvram_bufset(0,"MotionDetectionEnable",uVar1);
  nvram_bufset(0,"MotionDetectionBlockSet",__src);
  nvram_bufset(0,"MotionDetectionSensitivity",uVar2);
  strcpy(s_xxxxxxxxxxxxxxxxxxxxxxxxx_004d61b0,__src);
  uVar1 = websGetVar(param_1,"MotionDetectionScheduleDay",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"MotionDetectionScheduleMode",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"MotionDetectionScheduleTimeStart",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"MotionDetectionScheduleTimeStop",&DAT_0049445c);
  nvram_bufset(0,"MotionDetectionScheduleDay",uVar1);
  nvram_bufset(0,"MotionDetectionScheduleMode",uVar2);
  nvram_bufset(0,"MotionDetectionScheduleTimeStart",uVar3);
  nvram_bufset(0,"MotionDetectionScheduleTimeStop",uVar4);
  return 0;
}



undefined4 SystemMotionChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s1_05;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  char *__s2_05;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"MotionDetectionEnable");
  __s1_00 = (char *)nvram_bufget(0,"MotionDetectionBlockSet");
  __s1_01 = (char *)nvram_bufget(0,"MotionDetectionSensitivity");
  __s2 = (char *)websGetVar(param_1,"MotionDetectionEnable",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"MotionDetectionBlockSet",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"MotionDetectionSensitivity",&DAT_0049445c);
  __s1_02 = (char *)nvram_bufget(0,"MotionDetectionScheduleDay");
  __s1_03 = (char *)nvram_bufget(0,"MotionDetectionScheduleMode");
  __s1_04 = (char *)nvram_bufget(0,"MotionDetectionScheduleTimeStart");
  __s1_05 = (char *)nvram_bufget(0,"MotionDetectionScheduleTimeStop");
  __s2_02 = (char *)websGetVar(param_1,"MotionDetectionScheduleDay",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"MotionDetectionScheduleMode",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"MotionDetectionScheduleTimeStart",&DAT_0049445c);
  __s2_05 = (char *)websGetVar(param_1,"MotionDetectionScheduleTimeStop",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if ((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
      (iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0)) &&
     (((iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0 && (iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0)
       ) && ((iVar1 = strcmp(__s1_05,__s2_05), iVar1 == 0 &&
             (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)))))) {
    return 0;
  }
  return 1;
}



uint CheckDayNightVar(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  undefined auStack_50 [4];
  undefined auStack_4c [4];
  undefined auStack_48 [4];
  undefined auStack_44 [4];
  undefined auStack_40 [4];
  undefined auStack_3c [4];
  undefined auStack_38 [4];
  undefined auStack_34 [4];
  undefined auStack_30 [4];
  undefined auStack_2c [4];
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [4];
  undefined auStack_14 [4];
  
  uVar1 = websGetVarCheck(param_1,"DayNightMode",auStack_50);
  uVar2 = websGetVarCheck(param_1,"LightSensorControl",auStack_4c);
  uVar3 = websGetVarCheck(param_1,"IRLedScheduleSunStart",auStack_48);
  uVar4 = websGetVarCheck(param_1,"IRLedScheduleSunEnd",auStack_44);
  uVar5 = websGetVarCheck(param_1,"IRLedScheduleMonStart",auStack_40);
  uVar6 = websGetVarCheck(param_1,"IRLedScheduleMonEnd",auStack_3c);
  uVar7 = websGetVarCheck(param_1,"IRLedScheduleTueStart",auStack_38);
  uVar8 = websGetVarCheck(param_1,"IRLedScheduleTueEnd",auStack_34);
  uVar9 = websGetVarCheck(param_1,"IRLedScheduleWedStart",auStack_30);
  uVar10 = websGetVarCheck(param_1,"IRLedScheduleWedEnd",auStack_2c);
  uVar11 = websGetVarCheck(param_1,"IRLedScheduleThuStart",auStack_28);
  uVar12 = websGetVarCheck(param_1,"IRLedScheduleThuEnd",auStack_24);
  uVar13 = websGetVarCheck(param_1,"IRLedScheduleFriStart",auStack_20);
  uVar14 = websGetVarCheck(param_1,"IRLedScheduleFriEnd",auStack_1c);
  uVar15 = websGetVarCheck(param_1,"IRLedScheduleSatStart",auStack_18);
  uVar16 = websGetVarCheck(param_1,"IRLedScheduleSatEnd",auStack_14);
  return uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6 | uVar7 | uVar8 | uVar9 | uVar10 | uVar11 |
         uVar12 | uVar13 | uVar14 | uVar15 | uVar16;
}



undefined4 SystemDayNightChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s1_05;
  char *__s1_06;
  char *__s1_07;
  char *__s1_08;
  char *__s1_09;
  char *__s1_10;
  char *__s1_11;
  char *__s1_12;
  char *__s1_13;
  char *__s1_14;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  char *__s2_05;
  char *__s2_06;
  char *__s2_07;
  char *__s2_08;
  char *__s2_09;
  char *__s2_10;
  char *__s2_11;
  char *__s2_12;
  char *__s2_13;
  char *__s2_14;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"DayNightMode");
  __s1_00 = (char *)nvram_bufget(0,"LightSensorControl");
  __s1_01 = (char *)nvram_bufget(0,"IRLedScheduleSunStart");
  __s1_02 = (char *)nvram_bufget(0,"IRLedScheduleSunEnd");
  __s1_03 = (char *)nvram_bufget(0,"IRLedScheduleMonStart");
  __s1_04 = (char *)nvram_bufget(0,"IRLedScheduleMonEnd");
  __s1_05 = (char *)nvram_bufget(0,"IRLedScheduleTueStart");
  __s1_06 = (char *)nvram_bufget(0,"IRLedScheduleTueEnd");
  __s1_07 = (char *)nvram_bufget(0,"IRLedScheduleWedStart");
  __s1_08 = (char *)nvram_bufget(0,"IRLedScheduleWedEnd");
  __s1_09 = (char *)nvram_bufget(0,"IRLedScheduleThuStart");
  __s1_10 = (char *)nvram_bufget(0,"IRLedScheduleThuEnd");
  __s1_11 = (char *)nvram_bufget(0,"IRLedScheduleFriStart");
  __s1_12 = (char *)nvram_bufget(0,"IRLedScheduleFriEnd");
  __s1_13 = (char *)nvram_bufget(0,"IRLedScheduleSatStart");
  __s1_14 = (char *)nvram_bufget(0,"IRLedScheduleSatEnd");
  __s2 = (char *)websGetVar(param_1,"DayNightMode",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"LightSensorControl",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"IRLedScheduleSunStart",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"IRLedScheduleSunEnd",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"IRLedScheduleMonStart",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"IRLedScheduleMonEnd",&DAT_0049445c);
  __s2_05 = (char *)websGetVar(param_1,"IRLedScheduleTueStart",&DAT_0049445c);
  __s2_06 = (char *)websGetVar(param_1,"IRLedScheduleTueEnd",&DAT_0049445c);
  __s2_07 = (char *)websGetVar(param_1,"IRLedScheduleWedStart",&DAT_0049445c);
  __s2_08 = (char *)websGetVar(param_1,"IRLedScheduleWedEnd",&DAT_0049445c);
  __s2_09 = (char *)websGetVar(param_1,"IRLedScheduleThuStart",&DAT_0049445c);
  __s2_10 = (char *)websGetVar(param_1,"IRLedScheduleThuEnd",&DAT_0049445c);
  __s2_11 = (char *)websGetVar(param_1,"IRLedScheduleFriStart",&DAT_0049445c);
  __s2_12 = (char *)websGetVar(param_1,"IRLedScheduleFriEnd",&DAT_0049445c);
  __s2_13 = (char *)websGetVar(param_1,"IRLedScheduleSatStart",&DAT_0049445c);
  __s2_14 = (char *)websGetVar(param_1,"IRLedScheduleSatEnd",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if (((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
       (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)) &&
      (((iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0 &&
        (iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0)) &&
       ((iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0 &&
        ((iVar1 = strcmp(__s1_05,__s2_05), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_06,__s2_06), iVar1 == 0)))))))) &&
     ((iVar1 = strcmp(__s1_07,__s2_07), iVar1 == 0 &&
      (((((iVar1 = strcmp(__s1_08,__s2_08), iVar1 == 0 &&
          (iVar1 = strcmp(__s1_09,__s2_09), iVar1 == 0)) &&
         (iVar1 = strcmp(__s1_10,__s2_10), iVar1 == 0)) &&
        ((iVar1 = strcmp(__s1_11,__s2_11), iVar1 == 0 &&
         (iVar1 = strcmp(__s1_12,__s2_12), iVar1 == 0)))) &&
       ((iVar1 = strcmp(__s1_13,__s2_13), iVar1 == 0 &&
        (iVar1 = strcmp(__s1_14,__s2_14), iVar1 == 0)))))))) {
    return 0;
  }
  return 1;
}



undefined4 WriteDayNightVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  
  uVar1 = websGetVar(param_1,"DayNightMode",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"LightSensorControl",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"IRLedScheduleSunStart",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"IRLedScheduleSunEnd",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"IRLedScheduleMonStart",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"IRLedScheduleMonEnd",&DAT_0049445c);
  uVar7 = websGetVar(param_1,"IRLedScheduleTueStart",&DAT_0049445c);
  uVar8 = websGetVar(param_1,"IRLedScheduleTueEnd",&DAT_0049445c);
  uVar9 = websGetVar(param_1,"IRLedScheduleWedStart",&DAT_0049445c);
  uVar10 = websGetVar(param_1,"IRLedScheduleWedEnd",&DAT_0049445c);
  uVar11 = websGetVar(param_1,"IRLedScheduleThuStart",&DAT_0049445c);
  uVar12 = websGetVar(param_1,"IRLedScheduleThuEnd",&DAT_0049445c);
  uVar13 = websGetVar(param_1,"IRLedScheduleFriStart",&DAT_0049445c);
  uVar14 = websGetVar(param_1,"IRLedScheduleFriEnd",&DAT_0049445c);
  uVar15 = websGetVar(param_1,"IRLedScheduleSatStart",&DAT_0049445c);
  uVar16 = websGetVar(param_1,"IRLedScheduleSatEnd",&DAT_0049445c);
  nvram_bufset(0,"DayNightMode",uVar1);
  nvram_bufset(0,"LightSensorControl",uVar2);
  nvram_bufset(0,"IRLedScheduleSunStart",uVar3);
  nvram_bufset(0,"IRLedScheduleSunEnd",uVar4);
  nvram_bufset(0,"IRLedScheduleMonStart",uVar5);
  nvram_bufset(0,"IRLedScheduleMonEnd",uVar6);
  nvram_bufset(0,"IRLedScheduleTueStart",uVar7);
  nvram_bufset(0,"IRLedScheduleTueEnd",uVar8);
  nvram_bufset(0,"IRLedScheduleWedStart",uVar9);
  nvram_bufset(0,"IRLedScheduleWedEnd",uVar10);
  nvram_bufset(0,"IRLedScheduleThuStart",uVar11);
  nvram_bufset(0,"IRLedScheduleThuEnd",uVar12);
  nvram_bufset(0,"IRLedScheduleFriStart",uVar13);
  nvram_bufset(0,"IRLedScheduleFriEnd",uVar14);
  nvram_bufset(0,"IRLedScheduleSatStart",uVar15);
  nvram_bufset(0,"IRLedScheduleSatEnd",uVar16);
  return 0;
}



uint CheckSoundDBVar(undefined4 param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  undefined auStack_28 [4];
  undefined auStack_24 [4];
  undefined auStack_20 [4];
  undefined auStack_1c [4];
  undefined auStack_18 [4];
  undefined auStack_14 [4];
  
  uVar1 = websGetVarCheck(param_1,"SoundDetectionEnable",auStack_28);
  uVar2 = websGetVarCheck(param_1,"SoundDetectionDB",auStack_24);
  uVar3 = websGetVarCheck(param_1,"SoundDetectionScheduleDay",auStack_20);
  uVar4 = websGetVarCheck(param_1,"SoundDetectionScheduleMode",auStack_1c);
  uVar5 = websGetVarCheck(param_1,"SoundDetectionScheduleTimeStart",auStack_18);
  uVar6 = websGetVarCheck(param_1,"SoundDetectionScheduleTimeStop",auStack_14);
  return uVar1 | uVar2 | uVar3 | uVar4 | uVar5 | uVar6;
}



undefined4 SystemSoundDBChanged(undefined4 param_1)

{
  char *__s1;
  char *__s1_00;
  char *__s1_01;
  char *__s1_02;
  char *__s1_03;
  char *__s1_04;
  char *__s2;
  char *__s2_00;
  char *__s2_01;
  char *__s2_02;
  char *__s2_03;
  char *__s2_04;
  int iVar1;
  
  __s1 = (char *)nvram_bufget(0,"SoundDetectionEnable");
  __s1_00 = (char *)nvram_bufget(0,"SoundDetectionDB");
  __s1_01 = (char *)nvram_bufget(0,"SoundDetectionScheduleDay");
  __s1_02 = (char *)nvram_bufget(0,"SoundDetectionScheduleMode");
  __s1_03 = (char *)nvram_bufget(0,"SoundDetectionScheduleTimeStart");
  __s1_04 = (char *)nvram_bufget(0,"SoundDetectionScheduleTimeStop");
  __s2 = (char *)websGetVar(param_1,"SoundDetectionEnable",&DAT_0049445c);
  __s2_00 = (char *)websGetVar(param_1,"SoundDetectionDB",&DAT_0049445c);
  __s2_01 = (char *)websGetVar(param_1,"SoundDetectionScheduleDay",&DAT_0049445c);
  __s2_02 = (char *)websGetVar(param_1,"SoundDetectionScheduleMode",&DAT_0049445c);
  __s2_03 = (char *)websGetVar(param_1,"SoundDetectionScheduleTimeStart",&DAT_0049445c);
  __s2_04 = (char *)websGetVar(param_1,"SoundDetectionScheduleTimeStop",&DAT_0049445c);
  iVar1 = strcmp(__s1,__s2);
  if ((((iVar1 == 0) && (iVar1 = strcmp(__s1_00,__s2_00), iVar1 == 0)) &&
      (iVar1 = strcmp(__s1_01,__s2_01), iVar1 == 0)) &&
     (((iVar1 = strcmp(__s1_02,__s2_02), iVar1 == 0 && (iVar1 = strcmp(__s1_03,__s2_03), iVar1 == 0)
       ) && (iVar1 = strcmp(__s1_04,__s2_04), iVar1 == 0)))) {
    return 0;
  }
  return 1;
}



undefined4 WriteSoundDBVar(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  
  uVar1 = websGetVar(param_1,"SoundDetectionEnable",&DAT_0049445c);
  uVar2 = websGetVar(param_1,"SoundDetectionDB",&DAT_0049445c);
  uVar3 = websGetVar(param_1,"SoundDetectionScheduleDay",&DAT_0049445c);
  uVar4 = websGetVar(param_1,"SoundDetectionScheduleMode",&DAT_0049445c);
  uVar5 = websGetVar(param_1,"SoundDetectionScheduleTimeStart",&DAT_0049445c);
  uVar6 = websGetVar(param_1,"SoundDetectionScheduleTimeStop",&DAT_0049445c);
  nvram_bufset(0,"SoundDetectionEnable",uVar1);
  nvram_bufset(0,"SoundDetectionDB",uVar2);
  nvram_bufset(0,"SoundDetectionScheduleDay",uVar3);
  nvram_bufset(0,"SoundDetectionScheduleMode",uVar4);
  nvram_bufset(0,"SoundDetectionScheduleTimeStart",uVar5);
  nvram_bufset(0,"SoundDetectionScheduleTimeStop",uVar6);
  return 0;
}



void FUN_0042bde8(undefined4 param_1)

{
  int iVar1;
  char *__nptr;
  uint uVar2;
  
  websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
  iVar1 = websTestVar(param_1,"WebDebugLevel");
  if (iVar1 == 0) {
    return;
  }
  __nptr = (char *)websGetVar(param_1,"WebDebugLevel",&DAT_0049445c);
  uVar2 = atoi(__nptr);
  Debug_Trace_Level = uVar2 & 0x1f;
  if (uVar2 == 0) {
    Debug_Trace_Level = 0x10;
  }
  return;
}



void FUN_0042bec0(int param_1)

{
  undefined4 uVar1;
  
  uVar1 = websGetErrorMessage(0);
  webAddReplyMessage(param_1,uVar1,0);
  websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
  *(undefined4 *)(param_1 + 0x120) = 3;
  return;
}



void FUN_0042bf44(int param_1)

{
  undefined4 uVar1;
  
  uVar1 = websGetErrorMessage(1);
  webAddReplyMessage(param_1,uVar1,0);
  websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
  doSystem("ralink_init clear 2860");
  doSystem("ralink_init renew 2860 /etc_ro/Wireless/RT2860AP/RT2860_default_vlan");
  *(undefined4 *)(param_1 + 0x120) = 3;
  *(undefined4 *)(param_1 + 0x128) = 0;
  return;
}



void FUN_0042c004(undefined4 param_1)

{
  int iVar1;
  char *__nptr;
  
  iVar1 = websTestVar(param_1,"ConfigSystemLanguage");
  if (iVar1 == 0) {
                    // WARNING: Treating indirect jump as call
    websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
    return;
  }
  __nptr = (char *)websGetVar(param_1,"WebLanguage","0");
  iVar1 = atoi(__nptr);
  trace(1,"setSystemLanguage: %s!\n",__nptr);
  switch_language(1,iVar1);
                    // WARNING: Treating indirect jump as call
  websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
  return;
}



void FUN_0042c344(undefined4 param_1)

{
  char *pcVar1;
  char *pcVar2;
  char *pcVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  code *pcVar6;
  
  pcVar1 = (char *)nvram_bufget(0,"EmailSMTPServerAddress");
  pcVar2 = (char *)nvram_bufget(0,"EmailSenderAddress");
  pcVar3 = (char *)nvram_bufget(0,"EmailReceiverAddress");
  if ((((pcVar1 == (char *)0x0) || (*pcVar1 == '\0')) || (pcVar2 == (char *)0x0)) ||
     (((*pcVar2 == '\0' || (pcVar3 == (char *)0x0)) || (*pcVar3 == '\0')))) {
    uVar4 = websGetErrorMessage(0xb);
    webAddReplyMessage(param_1,uVar4,0);
    uVar4 = 0x1b;
    pcVar6 = setSysInfoShort;
    uVar5 = 10;
  }
  else {
    uVar4 = websGetErrorMessage(10);
    webAddReplyMessage(param_1,uVar4,0);
    setSysInfoShort(0x1b,1);
    trace(1,"Call test E-Mail function!\n");
    uVar4 = 0x39;
    pcVar6 = setSysInfoLong;
    uVar5 = 0x400;
  }
  (*pcVar6)(uVar4,uVar5);
                    // WARNING: Treating indirect jump as call
  websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
  return;
}



void FUN_0042c90c(undefined4 param_1)

{
  setSysInfoNone(0x2b);
                    // WARNING: Treating indirect jump as call
  websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
  return;
}



void formDefineManagement(void)

{
  websSetFormDefine("setDebugLevel",FUN_0042bde8);
  websSetFormDefine("setSystemReboot",FUN_0042bec0);
  websSetFormDefine("setSystemFactoryReset",FUN_0042bf44);
  websSetFormDefine("setSystemLanguage",FUN_0042c004);
  websSetFormDefine("setAuthorizationMode",&LAB_0042c120);
  websSetFormDefine("setTestEmail",FUN_0042c344);
  websSetFormDefine("setTestFTP",&LAB_0042c4e8);
  websSetFormDefine("setSystemRegion",&LAB_0042c648);
  websSetFormDefine("setSystemAPSelect",&LAB_0042c6d4);
  websSetFormDefine("setSystemAPReScan",FUN_0042c90c);
  websSetFormDefine("setSystemWizard",&LAB_0042c968);
  websSetFormDefine("setSystemAdmin",&LAB_0042d194);
  websSetFormDefine("setSystemControl",&LAB_0042d5d0);
  websSetFormDefine("setSystemAddUser",&LAB_0042d9c4);
  websSetFormDefine("setSystemDeleteUser",&LAB_0042dd3c);
  websSetFormDefine("setSystemNetwork",&LAB_0042df30);
  websSetFormDefine("setSystemWireless",&LAB_0042e3a4);
  websSetFormDefine("setSystemStream",&LAB_0042e968);
  websSetFormDefine("setDayNightStream",&LAB_0042eec8);
  websSetFormDefine("setSystemVideo",&LAB_0042f540);
  websSetFormDefine("setSystemEmail",&LAB_0042f890);
  websSetFormDefine("setSystemFTP",&LAB_0042fca4);
  websSetFormDefine("setSystemDate",&DAT_0042ff54);
  websSetFormDefine("setSystemMotion",&LAB_004303f4);
  websSetFormDefine("setDayNightMode",&LAB_004307a0);
  websSetFormDefine("setSystemSoundDB",&LAB_00430a4c);
                    // WARNING: Treating indirect jump as call
  websSetFormDefine("setSystemUserModify",&UNK_00430d30);
  return;
}



long getMTDPartSize(char *param_1)

{
  FILE *__stream;
  char *pcVar1;
  int iVar2;
  long lVar3;
  char acStack_120 [128];
  char acStack_a0 [32];
  char acStack_80 [32];
  undefined auStack_60 [32];
  undefined auStack_40 [32];
  
  __stream = fopen("/proc/mtd","r");
  lVar3 = 0;
  if (__stream == (FILE *)0x0) {
    fwrite("mtd support not enable?",1,0x17,stderr);
    lVar3 = 0;
  }
  else {
    do {
      pcVar1 = fgets(acStack_120,0x80,__stream);
      if (pcVar1 == (char *)0x0) goto LAB_0043177c;
      iVar2 = sscanf(acStack_120,"%31s %31s %31s %31s",auStack_60,acStack_80,auStack_40,acStack_a0);
    } while ((iVar2 < 0) || (iVar2 = strcmp(acStack_a0,param_1), iVar2 != 0));
    lVar3 = strtol(acStack_80,(char **)0x0,0x10);
LAB_0043177c:
    fclose(__stream);
  }
  return lVar3;
}



undefined4 FUN_004317e8(int param_1)

{
  char cVar1;
  int iVar2;
  size_t sVar3;
  char *__s;
  
  iVar2 = websConnValid();
  if (iVar2 == 0) {
    trace(0x10,"websCgiReplyMessage wp=(%s)!\n","Invalid ptr");
  }
  else {
    iVar2 = websConnValidateUrl(param_1,*(undefined4 *)(param_1 + 0x88));
    if (iVar2 < 0) {
      trace(0x10,"websCgiReplyMessage wp=(%s)!\n","Invalid URL");
      websConnError(param_1,500,"Invalid URL");
    }
    else {
      __s = *(char **)(param_1 + 0x94);
      sVar3 = strlen(__s);
      cVar1 = __s[sVar3 - 1];
      if ((cVar1 == '/') || (cVar1 == '\\')) {
        __s[sVar3 - 1] = '\0';
      }
      iVar2 = open(__s,0);
      *(int *)(param_1 + 0x100) = iVar2;
      if (iVar2 < 0) {
        websConnError(param_1,0x194,"cgibin: Cannot open URL(%s)\n",*(undefined4 *)(param_1 + 0x90))
        ;
      }
      else {
        websWriteActiveHeader(param_1,200,0,param_1 + 0x44,0);
        iVar2 = websParaRequest(param_1,__s);
        if (-1 < iVar2) {
          websConnClose(param_1,200);
        }
      }
    }
  }
  return 1;
}



undefined4
FUN_0043198c(int param_1,int param_2,void *param_3,int *param_4,char *param_5,int param_6,
            uint param_7,int *param_8,char *param_9)

{
  int __fd;
  int iVar1;
  void *__addr;
  size_t sVar2;
  void *__s1;
  int iVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  uint uVar7;
  int *piVar8;
  uint *puVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint *puVar13;
  uint *puVar14;
  double dVar15;
  double dVar16;
  stat sStack_140;
  uint local_a8 [8];
  char acStack_88 [32];
  undefined4 local_68;
  undefined2 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_50;
  undefined4 local_4c;
  char local_48;
  size_t local_40;
  int local_3c;
  int local_38;
  
  local_40 = 0x24;
  if (param_2 != 0) {
    local_68 = 0;
    local_64 = 0;
    getSysInfoBuffer(0x19,&local_68,6);
    if (((char)local_68 == '\0') && (local_68._1_1_ == -1)) {
      *param_4 = 1;
      local_40 = 0x1e;
    }
  }
  if (param_7 < 0x40) {
    pcVar6 = "Bad size: \"%s\" is no valid image\n";
    goto LAB_00431a24;
  }
  __fd = open(param_5,0);
  if (__fd < 0) {
    piVar8 = __errno_location();
    pcVar6 = strerror(*piVar8);
    sprintf(param_9,"Can\'t open %s: %s\n",param_5,pcVar6);
    return 0;
  }
  iVar1 = fstat(__fd,&sStack_140);
  if (iVar1 < 0) {
    close(__fd);
    piVar8 = __errno_location();
    pcVar6 = strerror(*piVar8);
    sprintf(param_9,"Can\'t stat %s: %s\n",param_5,pcVar6);
    return 0;
  }
  __addr = mmap((void *)0x0,sStack_140.st_atim.tv_sec,1,1,__fd,0);
  if (__addr == (void *)0xffffffff) {
    close(__fd);
    piVar8 = __errno_location();
    pcVar6 = strerror(*piVar8);
    sprintf(param_9,"Can\'t mmap %s: %s\n",param_5,pcVar6);
    return 0;
  }
  if (sStack_140.st_atim.tv_sec < param_2) {
    munmap(__addr,sStack_140.st_atim.tv_sec);
    close(__fd);
    pcVar6 = "*** Warning: \"%s\" file size is too small!\n";
    goto LAB_00431a24;
  }
  puVar14 = (uint *)((int)__addr + param_6);
  if (param_2 != 0) {
    local_58._0_1_ = 'e';
    local_58._1_1_ = ':';
    local_58._2_1_ = ' ';
    local_58._3_1_ = '\0';
    local_48 = '\0';
    local_60._0_1_ = 'S';
    local_60._1_1_ = 'i';
    local_60._2_1_ = 'g';
    local_60._3_1_ = 'n';
    local_5c._0_1_ = 'a';
    local_5c._1_1_ = 't';
    local_5c._2_1_ = 'u';
    local_5c._3_1_ = 'r';
    local_4c._0_1_ = 'a';
    local_4c._1_1_ = 's';
    local_4c._2_1_ = 'e';
    local_4c._3_1_ = ' ';
    local_50._0_1_ = 'R';
    local_50._1_1_ = 'e';
    local_50._2_1_ = 'l';
    local_50._3_1_ = 'e';
    sVar2 = strlen((char *)&local_60);
    __s1 = (void *)memsearch((int)puVar14 - param_2,param_2,&local_60,sVar2);
    if (__s1 == (void *)0x0) {
      munmap(__addr,sStack_140.st_atim.tv_sec);
      close(__fd);
      pcVar6 = "*** Warning: \"%s\" has not signature!\n";
      goto LAB_00431a24;
    }
    if (param_1 == 1) {
LAB_00431e4c:
      *param_4 = 1;
    }
    else {
      sVar2 = strlen((char *)&local_50);
      local_3c = memsearch(__s1,0x40,&local_50,sVar2);
      sVar2 = strlen((char *)&local_50);
      local_38 = memsearch(param_3,0x40,&local_50,sVar2);
      if (((local_3c == 0) || (local_38 == 0)) ||
         (iVar1 = memcmp(__s1,param_3,local_40), iVar1 != 0)) {
        munmap(__addr,sStack_140.st_atim.tv_sec);
        close(__fd);
        pcVar6 = "*** Warning: \"%s\" has bad signature!\n";
        goto LAB_00431a24;
      }
      if (*param_4 == 0) {
        sVar2 = strlen((char *)&local_50);
        pcVar6 = (char *)(local_38 + sVar2);
        dVar15 = atof((char *)(local_3c + sVar2));
        dVar16 = atof(pcVar6);
        if ((float)dVar16 < (float)dVar15) goto LAB_00431e4c;
      }
    }
    if (param_2 != 0) {
      iVar1 = 0;
      iVar3 = param_7 + param_2;
      piVar8 = (int *)((int)puVar14 - param_2);
      if (iVar3 < 0) {
        iVar3 = iVar3 + 3;
      }
      for (iVar3 = iVar3 >> 2; iVar3 != 0; iVar3 = iVar3 + -1) {
        iVar4 = *piVar8;
        piVar8 = piVar8 + 1;
        iVar1 = iVar1 + iVar4;
      }
      if (iVar1 != 0x55aa55aa) {
        munmap(__addr,sStack_140.st_atim.tv_sec);
        close(__fd);
        pcVar6 = "*** Warning: \"%s\" has bad checksum!\n";
        goto LAB_00431a24;
      }
    }
  }
  puVar13 = puVar14 + 0x10;
  puVar9 = local_a8;
  do {
    uVar11 = *puVar14;
    uVar10 = puVar14[1];
    uVar5 = puVar14[2];
    uVar7 = puVar14[3];
    puVar14 = puVar14 + 4;
    *puVar9 = uVar11;
    puVar9[1] = uVar10;
    puVar9[2] = uVar5;
    puVar9[3] = uVar7;
    puVar9 = puVar9 + 4;
  } while (puVar14 != puVar13);
  iVar1 = strcmp(acStack_88,"Linux Kernel Image");
  if (iVar1 != 0) {
    munmap(__addr,sStack_140.st_atim.tv_sec);
    close(__fd);
    sprintf(param_9,"Bad Magic Name: \"%s\"\n",acStack_88);
    return 0;
  }
  if ((local_a8[0] >> 0x18 | (local_a8[0] & 0xff0000) >> 8 | (local_a8[0] & 0xff00) << 8 |
      local_a8[0] << 0x18) == 0x27051956) {
    uVar12 = local_a8[1] & 0xff0000;
    uVar7 = local_a8[1] & 0xff00;
    uVar10 = local_a8[1] >> 0x18;
    uVar11 = local_a8[1] << 0x18;
    local_a8[1] = 0;
    uVar5 = crc32(0,local_a8,0x40);
    if (uVar5 == (uVar10 | uVar12 >> 8 | uVar7 << 8 | uVar11)) {
      *param_8 = (local_a8[3] >> 0x18 | (local_a8[3] & 0xff0000) >> 8 | (local_a8[3] & 0xff00) << 8
                 | local_a8[3] << 0x18) + 0x40;
      uVar5 = crc32(0,puVar13);
      if (uVar5 == (local_a8[6] >> 0x18 | (local_a8[6] & 0xff0000) >> 8 |
                    (local_a8[6] & 0xff00) << 8 | local_a8[6] << 0x18)) {
        uVar5 = getMTDPartSize("\"Kernel\"");
        if (uVar5 < param_7) {
          munmap(__addr,sStack_140.st_atim.tv_sec);
          close(__fd);
          sprintf(param_9,"*** Warning: the image file(0x%x) is bigger than Kernel MTD partition.\n"
                  ,param_7);
          return 0;
        }
        munmap(__addr,sStack_140.st_atim.tv_sec);
        close(__fd);
        return 1;
      }
      munmap(__addr,sStack_140.st_atim.tv_sec);
      close(__fd);
      pcVar6 = "*** Warning: \"%s\" has corrupted data!\n";
    }
    else {
      munmap(__addr,sStack_140.st_atim.tv_sec);
      close(__fd);
      pcVar6 = "*** Warning: \"%s\" has bad header checksum!\n";
    }
  }
  else {
    munmap(__addr,sStack_140.st_atim.tv_sec);
    close(__fd);
    pcVar6 = "Bad Magic Number: \"%s\" is no valid image\n";
  }
LAB_00431a24:
  sprintf(param_9,pcVar6,param_5);
  return 0;
}



undefined4 uploadconfig(int param_1)

{
  undefined uVar1;
  char *pcVar2;
  int iVar3;
  undefined4 uVar4;
  FILE *pFVar5;
  size_t sVar6;
  FILE *__stream;
  int iVar7;
  short *__s;
  int iVar8;
  undefined *puVar9;
  short *psVar10;
  char *__filename;
  size_t sVar11;
  short sVar12;
  int iVar13;
  long __off;
  undefined uStack_a079;
  undefined2 local_a078;
  byte local_5078 [20480];
  undefined auStack_78 [64];
  undefined auStack_38 [4];
  char *local_34;
  int local_30;
  
  pcVar2 = (char *)websGetVar(param_1,WebFileMark,&DAT_0049445c);
  iVar3 = strcmp(pcVar2,WebConfigFile);
  if (iVar3 != 0) {
    websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
    uVar4 = websGetErrorMessage(3);
    webAddReplyMessage(param_1,uVar4,0);
    FUN_004317e8(param_1);
    return 0xffffffff;
  }
  sVar11 = *(size_t *)(param_1 + 200);
  if (0x4000 < (int)sVar11) {
    websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
    uVar4 = websGetErrorMessage(8);
    webAddReplyMessage(param_1,uVar4,0);
    FUN_004317e8(param_1,&LAB_00430000);
    return 0xfffffffe;
  }
  pcVar2 = *(char **)(param_1 + 0xb4);
  __off = *(long *)(param_1 + 0xcc);
  iVar3 = 0;
  if (0x4000 < sVar11 - 0x1000) goto LAB_0043233c;
  __s = &local_a078;
  iVar13 = (int)sVar11 / 2;
  memset(__s,0,0x5000);
  memset(local_5078,0,0x5000);
  pFVar5 = fopen(pcVar2,"r+");
  if (pFVar5 == (FILE *)0x0) goto LAB_0043233c;
  fseek(pFVar5,__off,0);
  sVar6 = fread(__s,1,sVar11,pFVar5);
  if (sVar6 != sVar11) {
    fclose(pFVar5);
    goto LAB_0043233c;
  }
  memset(auStack_78,0,0x40);
  getSysInfoBuffer(1,auStack_78,0x40);
  allocFmtString(&local_34,0xfe,&DAT_0048cc18,"Steven Wu",auStack_78);
  pcVar2 = local_34;
  if (local_34 != (char *)0x0) {
    sVar6 = strlen(local_34);
    CBlowfish(pcVar2,sVar6);
    Blowfish_DeCode(__s,local_5078,sVar11);
    if (local_34 != (char *)0x0) {
      free(local_34);
      local_34 = (char *)0x0;
    }
  }
  iVar7 = 0;
  if (0 < (int)sVar11) {
    do {
      iVar8 = iVar7 + 1;
      local_5078[iVar7] = (local_5078[iVar7] + 0x79 ^ 0x5a) + 0x9b;
      iVar7 = iVar8;
    } while (iVar8 < (int)sVar11);
  }
  iVar7 = sVar11 - 1;
  if (-1 < iVar7) {
    puVar9 = (undefined *)(iVar7 + (int)__s);
    iVar8 = iVar7;
    do {
      if (iVar7 == iVar8) {
        local_30 = ((byte)puVar9[0x5000] & 7) << 5;
      }
      if (iVar8 == 0) {
        local_5078[0] = (local_5078[0] >> 3) + (char)local_30;
      }
      else {
        puVar9[0x5000] = ((byte)puVar9[0x5000] >> 3) + puVar9[0x4fff] * ' ';
      }
      iVar8 = iVar8 + -1;
      puVar9 = puVar9 + -1;
    } while (-1 < iVar8);
  }
  iVar7 = 0;
  psVar10 = __s;
  if (0 < iVar13) {
    do {
      uVar1 = *(undefined *)((int)__s + iVar13 + iVar7 + 0x5000);
      iVar8 = iVar7 + 1;
      *(byte *)((int)psVar10 + 1) = local_5078[iVar7];
      *(undefined *)psVar10 = uVar1;
      psVar10 = psVar10 + 1;
      iVar7 = iVar8;
    } while (iVar8 < iVar13);
  }
  sVar12 = 0;
  if (0 < iVar13) {
    do {
      iVar13 = iVar13 + -1;
      sVar12 = sVar12 + *__s;
      __s = __s + 1;
    } while (iVar13 != 0);
  }
  if (sVar12 == 0x5a5a) {
    fseek(pFVar5,__off,0);
    sVar6 = fwrite(&local_a078,1,sVar11,pFVar5);
    if (sVar6 != sVar11) goto LAB_0043269c;
  }
  else {
LAB_0043269c:
    iVar3 = -1;
  }
  if (pFVar5 != (FILE *)0x0) {
    fclose(pFVar5);
  }
  if (iVar3 < 0) {
LAB_0043233c:
    websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
    uVar4 = websGetErrorMessage(8);
    webAddReplyMessage(param_1,uVar4,0);
    FUN_004317e8(param_1);
    return 0xfffffffd;
  }
  LockCriticalCMD = LockCriticalCMD + 1;
  iVar3 = *(int *)(param_1 + 0xcc);
  iVar13 = *(int *)(param_1 + 200);
  __filename = *(char **)(param_1 + 0xb4);
  pcVar2 = (char *)strdupWithoutNull("/var/setrestoreconfig");
  iVar13 = iVar13 + -2;
  if (pcVar2 != (char *)0x0) {
    doSystem("cp %s /var/tmpcgi",__filename);
    pFVar5 = fopen(pcVar2,"w+");
    if (pFVar5 != (FILE *)0x0) {
      __stream = fopen(__filename,"r");
      if (__stream == (FILE *)0x0) {
        fclose(pFVar5);
        remove(pcVar2);
      }
      else {
        iVar3 = fseek(__stream,iVar3 + 2,0);
        if (iVar3 == -1) {
          trace(1,"fseek error\n");
        }
        if (0 < iVar13) {
          do {
            sVar11 = fread(auStack_38,1,1,__stream);
            iVar13 = iVar13 + -1;
            if (sVar11 == 0) break;
            fwrite(auStack_38,1,1,pFVar5);
          } while (0 < iVar13);
        }
        fclose(pFVar5);
        fclose(__stream);
        doSystem("ralink_init clear 2860");
        doSystem("ralink_init renew 2860 %s",pcVar2);
        remove(pcVar2);
        if (pcVar2 == (char *)0x0) goto LAB_00432878;
      }
    }
    free(pcVar2);
  }
LAB_00432878:
  websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
  uVar4 = websGetErrorMessage(7);
  webAddReplyMessage(param_1,uVar4,0);
  FUN_004317e8(param_1,&LAB_00430000);
  iVar3 = getSysInfoShort(0x41);
  if (iVar3 != 2) {
    set_reboot_time(3,1);
    doSystem("sleep 3 && reboot &");
  }
  return 0;
}



undefined4 uploadfirmware(int param_1)

{
  int iVar1;
  char *pcVar2;
  void *__ptr;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  char acStack_1b8 [256];
  undefined auStack_b8 [128];
  int local_38;
  int local_34;
  int local_30;
  
  iVar1 = websTestVar(param_1,"ReplySuccessPage");
  if (iVar1 == 0) {
    websSetVar(param_1,"ReplySuccessPage","/cgi/upgradestatus.cgi");
  }
  iVar1 = websTestVar(param_1,"ReplyErrorPage");
  if (iVar1 == 0) {
    websSetVar(param_1,"ReplyErrorPage","/cgi/upgradestatus.cgi");
  }
  pcVar2 = (char *)websGetVar(param_1,WebFileMark,&DAT_0049445c);
  iVar1 = strcmp(pcVar2,WebDownloadFile);
  if (iVar1 == 0) {
    if (*(int *)(param_1 + 200) < 0x100000) {
      webAddReplyMessage(param_1,acStack_1b8,0);
      websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
      uVar4 = websGetErrorMessage(3);
      webAddReplyMessage(param_1,uVar4,0);
      websSetVar(param_1,"DownloadStatus",&DAT_0048e618);
      nvram_bufset(0,"LastDownloadStatus",&DAT_0048e618);
      nvram_commit(0);
      FUN_004317e8(param_1);
      uVar4 = 0xfffffffe;
    }
    else {
      memset(auStack_b8,0,0x80);
      getSysInfoBuffer(0x40,auStack_b8,0x80);
      pcVar2 = (char *)websGetVar(param_1,"ForceBootCodeUpgrade","0");
      iVar1 = strcmp(pcVar2,"1");
      local_34 = 0;
      local_30 = *(int *)(param_1 + 0xcc);
      local_38 = *(int *)(param_1 + 0xd0);
      __ptr = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0xb4));
      if (__ptr == (void *)0x0) {
        webAddReplyMessage(param_1,acStack_1b8,0);
        websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
        uVar4 = websGetErrorMessage(3);
        webAddReplyMessage(param_1,uVar4,0);
        websSetVar(param_1,"DownloadStatus",&DAT_0048e630);
        nvram_bufset(0,"LastDownloadStatus",&DAT_0048e630);
        nvram_commit(0);
        FUN_004317e8(param_1);
        uVar4 = 0xfffffffc;
      }
      else {
        iVar5 = local_30 + 0x50000;
        local_38 = local_38 - iVar5;
        iVar1 = FUN_0043198c(iVar1 == 0,0x50000,auStack_b8,&local_34,__ptr,iVar5,local_38,&local_38,
                             acStack_1b8);
        if (iVar1 != 0) {
          LockCriticalCMD = LockCriticalCMD + 1;
          websSetVar(param_1,"DownloadTime",&DAT_0048e598);
          webAddReplyMessage(param_1,"Flash Programming...",0);
          websetReplayPage(param_1,0,"ReplySuccessPage","ReplyErrorPage");
          websSetVar(param_1,"DownloadStatus","0");
          nvram_bufset(0,"LastDownloadStatus","1");
          nvram_commit(0);
          FUN_004317e8(param_1);
          setSysInfoShort(0x41,2);
          trace(1,"clear SSL serverkey/serververt key!\n");
          nvram_bufset(0,"SSLCertificate1",&DAT_0049445c);
          nvram_bufset(0,"SSLCertificate2",&DAT_0049445c);
          nvram_commit(0);
          doSystem("sleep 3");
          doSystem("ifconfig br0 0.0.0.0 &");
          if (local_34 == 1) {
            printf("write bootloader");
            doSystem("/bin/mtd_write -o %d -l %d write %s Bootloader",local_30,0x30000,__ptr);
          }
          sprintf(acStack_1b8,"writeimage file(0x%x,0x%x)\n",iVar5,local_38);
          webAddReplyMessage(param_1,acStack_1b8,0);
          uVar3 = doSystem("/bin/mtd_write -o %d -l %d write %s Kernel",iVar5,local_38,__ptr);
          iVar1 = -1;
          if (((uVar3 & 0x7f) == 0) && (iVar1 = 0, (uVar3 & 0xff00) != 0)) {
            iVar1 = -1;
          }
          if (iVar1 == -1) {
            uVar4 = getSysInfoLong(0x1e);
            doSystem("ifconfig br0 %s",uVar4);
            websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
            uVar4 = websGetErrorMessage(5);
            webAddReplyMessage(param_1,uVar4,0);
            websSetVar(param_1,"DownloadStatus",&DAT_0048e62c);
            nvram_bufset(0,"LastDownloadStatus",&DAT_0048e62c);
            nvram_commit(0);
            LockCriticalCMD = LockCriticalCMD + -1;
          }
          else {
            websetReplayPage(param_1,0,"ReplySuccessPage");
            uVar4 = websGetErrorMessage(2);
            webAddReplyMessage(param_1,uVar4,0);
            websSetVar(param_1,"DownloadStatus","0");
            nvram_bufset(0,"LastDownloadStatus","0");
            nvram_commit(0);
            set_reboot_time(3,1);
            doSystem("sleep 3 && reboot &");
          }
          if (__ptr != (void *)0x0) {
            free(__ptr);
          }
          return 0;
        }
        webAddReplyMessage(param_1,acStack_1b8,0);
        websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
        uVar4 = websGetErrorMessage(3);
        webAddReplyMessage(param_1,uVar4,0);
        websSetVar(param_1,"DownloadStatus",&DAT_0048e618);
        nvram_bufset(0,"LastDownloadStatus",&DAT_0048e618);
        nvram_commit(0);
        FUN_004317e8(param_1);
        free(__ptr);
        uVar4 = 0xfffffffd;
      }
    }
  }
  else {
    websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
    uVar4 = websGetErrorMessage(3);
    webAddReplyMessage(param_1,uVar4,0);
    websSetVar(param_1,"DownloadStatus",&DAT_0048e618);
    nvram_bufset(0,"LastDownloadStatus",&DAT_0048e618);
    nvram_commit(0);
    FUN_004317e8(param_1);
    uVar4 = 0xffffffff;
  }
  return uVar4;
}



undefined4 npcuploadfirmware(int param_1)

{
  void *__ptr;
  size_t sVar1;
  uint uVar2;
  undefined *puVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined auStack_1d0 [256];
  undefined auStack_d0 [128];
  undefined2 local_50;
  undefined local_4e;
  undefined4 local_48;
  undefined local_44;
  undefined auStack_43 [27];
  int local_28;
  int local_24;
  
  iVar4 = 0;
  if (*(int *)(param_1 + 200) < 0x100000) {
    nvram_bufset(0,"LastDownloadStatus",&DAT_0048e618);
    iVar4 = -2;
    nvram_commit(0);
  }
  __ptr = (void *)strdupWithoutNull(*(undefined4 *)(param_1 + 0xb4));
  if (__ptr == (void *)0x0) {
    puVar3 = &DAT_0048e630;
LAB_004338f4:
    nvram_bufset(0,"LastDownloadStatus",puVar3);
    nvram_commit(0);
  }
  else if (iVar4 == 0) {
    memset(auStack_d0,0,0x80);
    getSysInfoBuffer(0x40,auStack_d0,0x80);
    iVar7 = *(int *)(param_1 + 0xcc);
    iVar5 = iVar7 + 0x50000;
    iVar6 = *(int *)(param_1 + 0xd0) - iVar5;
    local_24 = 0;
    iVar4 = FUN_0043198c(0,0x50000,auStack_d0,&local_24,__ptr,iVar5,iVar6,&local_28,auStack_1d0);
    if (iVar4 == 0) {
      puVar3 = &DAT_0048e618;
      goto LAB_004338f4;
    }
    LockCriticalCMD = LockCriticalCMD + 1;
    setSysInfoShort(0x41,2);
    trace(1,"clear SSL serverkey/serververt key!\n");
    nvram_bufset(0,"SSLCertificate1",&DAT_0049445c);
    nvram_bufset(0,"SSLCertificate2",&DAT_0049445c);
    nvram_commit(0);
    if (local_24 == 1) {
      printf("write bootloader");
      doSystem("/bin/mtd_write -o %d -l %d write %s Bootloader",iVar7,0x30000,__ptr);
    }
    local_28 = iVar6;
    uVar2 = doSystem("/bin/mtd_write -o %d -l %d write %s Kernel",iVar5,iVar6,__ptr);
    iVar4 = -1;
    if (((uVar2 & 0x7f) == 0) && (iVar4 = 0, (uVar2 & 0xff00) != 0)) {
      iVar4 = -1;
    }
    if (iVar4 != -1) {
      local_4e = 0;
      local_50 = 0x6b6f;
      nvram_bufset(0,"LastDownloadStatus","0");
      nvram_commit(0);
      sVar1 = strlen((char *)&local_50);
      websWriteNormalHeader(param_1,200,sVar1,"application/Dlink-inf",0);
      websWriteFmt(param_1,&local_50);
      websConnClose(param_1,200);
      set_reboot_time(3,1);
      doSystem("sleep 3 && reboot &");
      goto LAB_004335e0;
    }
    nvram_bufset(0,"LastDownloadStatus",&DAT_0048e62c);
    nvram_commit(0);
    LockCriticalCMD = LockCriticalCMD + -1;
  }
  local_44 = 0;
  local_48 = 0x6c696166;
  memset(auStack_43,0,0x1b);
  sVar1 = strlen((char *)&local_48);
  websWriteNormalHeader(param_1,200,sVar1,"application/Dlink-inf",0);
  websWriteFmt(param_1,&local_48);
  websConnClose(param_1,200);
LAB_004335e0:
  if (__ptr != (void *)0x0) {
    free(__ptr);
  }
  return 0;
}



// WARNING: Removing unreachable block (ram,0x00433d4c)

undefined4 websCgibinProcessor(int param_1)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  void *__ptr;
  char *pcVar4;
  size_t __n;
  char *pcVar5;
  int iVar6;
  __pid_t _Var7;
  uint uVar8;
  int *piVar9;
  int iVar10;
  char *__s;
  void *__ptr_00;
  code *pcVar11;
  
  trace(1,"websCgibinProcessor=%s\n",*(undefined4 *)(param_1 + 0x88));
  uVar8 = *(uint *)(param_1 + 0xe4);
  if ((((uVar8 >> 0xf & 1) == 0) && ((uVar8 >> 0x17 & 1) == 0)) && ((uVar8 >> 0xe & 1) == 0)) {
    websConnError(param_1,0x194,"File Not Found");
    return 1;
  }
  if ((uVar8 & 1) == 0) {
    websConnError(param_1,0x195,"Method Not Allowed.");
    return 1;
  }
  iVar2 = findStrInFile(*(undefined4 *)(param_1 + 0xb4),0,&WebCRLF,2);
  bVar1 = false;
  if (iVar2 == -1) {
    iVar2 = -1;
LAB_00433a88:
    doSystem("ls -all /var &");
    iVar3 = websConnValid(param_1);
    if (iVar3 == 0) {
      trace(0x10,"websParseCgiFile wp=(%s)!\n","Invalid ptr");
    }
    if (iVar2 == -1) {
      trace(0x10,"websParseCgiFile err=(%s)!\n","First CRLF not found");
    }
    if (iVar2 == -2) {
      trace(0x10,"websParseCgiFile err=(%s)!\n","Boundary not found");
    }
    if (iVar2 == -3) {
      trace(0x10,"websParseCgiFile err=(%s)!\n","Upload file not found");
    }
    websConnError(param_1,500,"Missing CGI data.");
    return 1;
  }
  __ptr = (void *)getMemInFile(*(undefined4 *)(param_1 + 0xb4),0,iVar2);
  iVar3 = iVar2;
  if (__ptr == (void *)0x0) {
    iVar2 = -2;
    goto LAB_00433a88;
  }
LAB_00433b78:
  iVar10 = iVar3 + 2;
  iVar3 = findStrInFile(*(undefined4 *)(param_1 + 0xb4),iVar10,&WebCRLF,2);
  __ptr_00 = (void *)0x0;
  if ((iVar3 == -1) ||
     (pcVar4 = (char *)getMemInFile(*(undefined4 *)(param_1 + 0xb4),iVar10,iVar3 - iVar10),
     pcVar4 == (char *)0x0)) goto LAB_00433d60;
  __n = strlen(WebMultiParaName);
  iVar10 = strncasecmp(pcVar4,WebMultiParaName,__n);
  __s = pcVar4 + __n;
  if (iVar10 != 0) {
LAB_00433ce0:
    if (pcVar4 != (char *)0x0) {
      free(pcVar4);
    }
    if (__ptr_00 != (void *)0x0) {
      free(__ptr_00);
    }
    goto LAB_00433b78;
  }
  pcVar5 = strchr(__s,0x3b);
  iVar10 = iVar3 + 2;
  if (pcVar5 == (char *)0x0) {
    iVar3 = iVar3 + 4;
    iVar10 = findStrInFile(*(undefined4 *)(param_1 + 0xb4),iVar3,__ptr,iVar2);
    if (iVar10 != -1) {
      pcVar5 = strchr(__s,0x22);
      if (pcVar5 != (char *)0x0) {
        *pcVar5 = '\0';
      }
      __ptr_00 = (void *)getMemInFile(*(undefined4 *)(param_1 + 0xb4),iVar3,(iVar10 - iVar3) + -2);
      websSetVar(param_1,__s,__ptr_00);
    }
    iVar3 = iVar10 + iVar2;
    goto LAB_00433ce0;
  }
  iVar6 = findStrInFile(*(undefined4 *)(param_1 + 0xb4),iVar10,&WebCRLF,2);
  if (iVar6 != -1) {
    pcVar5 = strchr(__s,0x22);
    if (pcVar5 != (char *)0x0) {
      *pcVar5 = '\0';
    }
    websSetVar(param_1,WebFileMark,__s);
    __ptr_00 = (void *)getMemInFile(*(undefined4 *)(param_1 + 0xb4),iVar10,iVar6 - iVar10);
    iVar6 = iVar6 + 4;
    iVar3 = findStrInFile(*(undefined4 *)(param_1 + 0xb4),iVar6,__ptr,iVar2);
    if (iVar3 != -1) {
      *(int *)(param_1 + 0xcc) = iVar6;
      *(int *)(param_1 + 200) = (iVar3 + -2) - iVar6;
      *(int *)(param_1 + 0xd0) = iVar3 + -2;
      bVar1 = true;
    }
    iVar3 = iVar3 + iVar2;
    goto LAB_00433ce0;
  }
  if (pcVar4 != (char *)0x0) {
    free(pcVar4);
  }
LAB_00433d60:
  if (__ptr != (void *)0x0) {
    free(__ptr);
  }
  if (!bVar1) {
    iVar2 = -3;
    goto LAB_00433a88;
  }
  iVar2 = 1;
  _Var7 = fork();
  if (_Var7 != 0) {
    if (_Var7 == -1) {
      trace(0x10,"cgibin fork process failure.\n");
      websConnError(param_1,0x1f5,"Fork process failure.");
      remove(*(char **)(param_1 + 0xb4));
      return 1;
    }
    iVar2 = AllocEntry(&DAT_004d8cd8,&DAT_004d61d0,8);
    if (iVar2 < 0) {
      return 1;
    }
    piVar9 = *(int **)(iVar2 * 4 + DAT_004d8cd8);
    piVar9[1] = _Var7;
    *piVar9 = param_1;
    websTimeoutCancel(param_1);
    return 1;
  }
  pcVar4 = (char *)strdupWithoutNull(*(undefined4 *)(param_1 + 0xb4));
  if (pcVar4 == (char *)0x0) goto LAB_00433fe0;
  iVar2 = 0;
  _Var7 = getpid();
  trace(0x10,"now in the cgibin child process(%d, %s).\n",_Var7,*(undefined4 *)(param_1 + 0x90));
  uVar8 = *(uint *)(param_1 + 0xe4);
  pcVar11 = uploadconfig;
  if ((uVar8 >> 0xf & 1) == 0) {
    pcVar11 = uploadfirmware;
    if ((uVar8 >> 0xe & 1) != 0) goto LAB_00434060;
    if ((uVar8 >> 0x17 & 1) != 0) {
      pcVar11 = npcuploadfirmware;
      goto LAB_00434060;
    }
    trace(0x10,"Function not implement!\n");
    webAddReplyMessage(param_1,"Function not implement!",0);
    websetReplayPage(param_1,1,"ReplySuccessPage","ReplyErrorPage");
    FUN_004317e8(param_1);
  }
  else {
LAB_00434060:
    iVar2 = (*pcVar11)(param_1);
  }
  remove(pcVar4);
  if (pcVar4 != (char *)0x0) {
    free(pcVar4);
                    // WARNING: Subroutine does not return
    exit(iVar2);
  }
LAB_00433fe0:
                    // WARNING: Subroutine does not return
  exit(iVar2);
}



void websCgiReapChildren(void)

{
  int iVar1;
  char *pcVar2;
  uint uVar3;
  int *piVar4;
  int *piVar5;
  int iVar6;
  code *pcVar7;
  uint local_20 [2];
  
  iVar6 = 0;
  if (-1 < DAT_004d61d0) {
    do {
      piVar4 = *(int **)(iVar6 * 4 + DAT_004d8cd8);
      if (piVar4 != (int *)0x0) {
        piVar5 = (int *)*piVar4;
        iVar1 = websReapChildren(piVar4[1],local_20);
        pcVar7 = websRefreshCookieDigest;
        if (iVar1 == 0) {
          websConnClose(piVar5,200);
          pcVar2 = "cgibin child(%d) exited, status=%d\n";
          uVar3 = (local_20[0] & 0xff00) >> 8;
          if ((local_20[0] & 0x7f) == 0) {
LAB_0043421c:
            iVar1 = piVar4[1];
          }
          else {
            pcVar2 = "cgibin child(%d) killed (signal %d)\n";
            uVar3 = local_20[0] & 0x7f;
            if ((local_20[0] & 0xff) != 0x7f) goto LAB_0043421c;
            uVar3 = (local_20[0] & 0xff00) >> 8;
            iVar1 = piVar4[1];
            pcVar2 = "cgibin child(%d) stopped (signal %d)\n";
          }
          trace(0x10,pcVar2,iVar1,uVar3);
          DAT_004d61d0 = FreeEntryId(&DAT_004d8cd8,iVar6);
          pcVar7 = free;
          piVar5 = piVar4;
        }
        (*pcVar7)(piVar5);
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 <= DAT_004d61d0);
  }
  return;
}



void authorizationmode(int param_1)

{
  char *pcVar1;
  int iVar2;
  size_t sVar3;
  
  if (((*(uint *)(param_1 + 0xe4) & 1) == 0) && (**(char **)(param_1 + 0xa0) == '\0')) {
LAB_004342f8:
    pcVar1 = (char *)nvram_bufget(0,"HTTPAuthentication");
    iVar2 = atoi(pcVar1);
    if (iVar2 == 0) {
      pcVar1 = "{\n\"result\" : {\"code\":\"0\"},\n\"mode\":\"basic\"\n}";
      goto LAB_00434344;
    }
    if (iVar2 == 1) {
      pcVar1 = "{\n\"result\" : {\"code\":\"0\"},\n\"mode\":\"digest\"\n}";
      goto LAB_00434344;
    }
  }
  else {
    iVar2 = websTestVar(param_1,&DAT_0048e8ec);
    if (iVar2 != 0) {
      pcVar1 = (char *)websGetVar(param_1,&DAT_0048e8ec,&DAT_0049445c);
      iVar2 = strcmp(pcVar1,"basic");
      if (iVar2 == 0) {
        pcVar1 = "plen == 0";
      }
      else {
        iVar2 = strcmp(pcVar1,"digest");
        if (iVar2 != 0) goto LAB_00434338;
        pcVar1 = "iter == 1";
      }
      websSetVar(param_1,"HTTPAuthentication",pcVar1 + 8);
      iVar2 = CheckAuthorizationModeVar(param_1);
      if (iVar2 == 0) {
        iVar2 = AuthorizationModeChanged(param_1);
        if (iVar2 != 0) {
          WriteAuthorizationModeVar(param_1);
          nvram_commit(0);
        }
        goto LAB_004342f8;
      }
    }
  }
LAB_00434338:
  pcVar1 = "{\n\"result\" : {\"code\":\"-1\",\n\"message\":\"Invalid parameter.\"}\n}";
LAB_00434344:
  pcVar1 = (char *)strdupWithoutNull(pcVar1);
  if (pcVar1 != (char *)0x0) {
    sVar3 = strlen(pcVar1);
    websJsonWriteHeader(param_1,sVar3);
    if (0 < (int)sVar3) {
      websWriteFmt(param_1,pcVar1);
    }
    free(pcVar1);
    websConnClose(param_1,200);
    return;
  }
                    // WARNING: Treating indirect jump as call
  websConnError(param_1,0x1f7,"Insufficient memory");
  return;
}



void iocontrol(int param_1)

{
  char *pcVar1;
  char *__s1;
  char *pcVar2;
  char *__s1_00;
  int iVar3;
  uint uVar4;
  
  pcVar1 = (char *)nvram_bufget(0,"EmailScheduleEnable");
  __s1 = (char *)nvram_bufget(0,"EmailScheduleMode");
  pcVar2 = (char *)nvram_bufget(0,"FTPScheduleEnable");
  __s1_00 = (char *)nvram_bufget(0,"FTPScheduleMode");
  if ((*(uint *)(param_1 + 0xe4) & 1) != 0) {
    iVar3 = strcmp(pcVar2,"1");
    if (iVar3 == 0) {
      iVar3 = strcmp(__s1_00,"3");
      if (iVar3 == 0) {
        iVar3 = websTestVar(param_1,"ImageUpload");
        if (iVar3 != 0) {
          pcVar2 = (char *)websGetVar(param_1,"ImageUpload","0");
          iVar3 = atoi(pcVar2);
          if (iVar3 == 0) {
            setSysInfoLong(0x39,8);
          }
          else if (iVar3 == 1) {
            setSysInfoLong(0x39,4);
          }
        }
      }
    }
    iVar3 = strcmp(pcVar1,"1");
    if (iVar3 == 0) {
      iVar3 = strcmp(__s1,"3");
      if (iVar3 == 0) {
        iVar3 = websTestVar(param_1,"ImageEmail");
        if (iVar3 != 0) {
          pcVar1 = (char *)websGetVar(param_1,"ImageEmail","0");
          iVar3 = atoi(pcVar1);
          if (iVar3 == 0) {
            setSysInfoLong(0x39,0x100000);
          }
          else if (iVar3 == 1) {
            setSysInfoLong(0x39,0x80000);
          }
        }
      }
    }
                    // WARNING: Treating indirect jump as call
    websReplyNoContent(param_1);
    return;
  }
  uVar4 = getSysInfoShort(0x48);
  websWriteNormalHeader(param_1,200,0,"text/html",0);
  websWriteFmt(param_1,"ImageUpload=%d&ImageEmail=%d&CurrentTime=",uVar4 & 1,
               (uVar4 & 0xffff) >> 1 & 1);
  getCurrentTimeString(param_1,"%Y-%m-%d %X\r\n");
  websConnClose(param_1,200);
  return;
}



void snapimage(int param_1)

{
  bool bVar1;
  int iVar2;
  void *__ptr;
  void *pvVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  char *pcVar7;
  code *pcVar8;
  
  iVar2 = getSysInfoLong(0x15);
  iVar6 = 10000;
  if (iVar2 < 1) {
    trace(0x10,"FRAME_IMAGE: service unavailable!\n");
                    // WARNING: Treating indirect jump as call
    websConnError(param_1,0x1f7,"Service Unavailable");
    return;
  }
  pcVar7 = (char *)(iVar2 + 0x24);
  __ptr = (void *)mmalloc(pcVar7);
  if (__ptr == (void *)0x0) {
    trace(0x10,"FRAME_IMAGE: allocate buffer failure!\n");
                    // WARNING: Treating indirect jump as call
    websConnError(param_1,500,"Invalid URL");
    return;
  }
  *(undefined2 *)((int)__ptr + 0x18) = 0;
  *(undefined4 *)((int)__ptr + 0x1c) = 0;
  *(int *)((int)__ptr + 0x20) = iVar2;
  *(undefined2 *)((int)__ptr + 0x12) = 0;
  setSysInfoBuffer(0x13,__ptr,pcVar7);
  iVar4 = *(int *)((int)__ptr + 0x20);
  if (iVar4 == 0) {
    do {
      usleep(1000);
      *(undefined2 *)((int)__ptr + 0x18) = 0;
      *(undefined4 *)((int)__ptr + 0x1c) = 0;
      *(int *)((int)__ptr + 0x20) = iVar2;
      *(undefined2 *)((int)__ptr + 0x12) = 0;
      setSysInfoBuffer(0x13,__ptr,pcVar7);
      iVar4 = *(int *)((int)__ptr + 0x20);
      iVar6 = iVar6 + -1;
      if (iVar4 != 0) goto LAB_00434984;
    } while (0 < iVar6);
    pcVar8 = websConnError;
    pcVar7 = "Invalid URL";
    pvVar3 = (void *)0x1f4;
  }
  else {
LAB_00434984:
    iVar6 = 1000;
    iVar2 = (int)__ptr + 0x24;
    websWriteNormalHeader(param_1,200,iVar4,"image/jpeg",0);
    while (0 < iVar4) {
      while( true ) {
        iVar5 = iVar4;
        if ((*(char *)(param_1 + 0xe4) < '\0') && (0x200 < iVar4)) {
          iVar5 = 0x200;
        }
        iVar5 = websWritePartial(param_1,iVar2,iVar5);
        if (iVar5 < 0) goto LAB_00434ad0;
        if (iVar5 == 0) break;
        iVar2 = iVar2 + iVar5;
        iVar4 = iVar4 - iVar5;
        iVar6 = 1000;
        if (iVar4 < 1) goto LAB_00434ad0;
      }
      bVar1 = iVar6 < 1;
      iVar6 = iVar6 + -1;
      if (bVar1) break;
      usleep(5000);
    }
LAB_00434ad0:
    websConnClose(param_1,200);
    *(undefined2 *)((int)__ptr + 0x12) = 0;
    pcVar8 = setSysInfoBuffer;
    param_1 = 0x14;
    pvVar3 = __ptr;
  }
  (*pcVar8)(param_1,pvVar3,pcVar7);
  if (__ptr != (void *)0x0) {
    free(__ptr);
  }
  return;
}



void resetdevice(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = websTestVar(param_1,"Reset");
  if (iVar1 == 0) {
    iVar1 = websTestVar(param_1,"FactoryReset");
    if (iVar1 != 0) {
      uVar2 = websGetVar(param_1,"FactoryReset",&DAT_0049445c);
      iVar1 = webncasestrcmp(uVar2,&DAT_0048b66c);
      if (iVar1 == 0) {
        if (LockCriticalCMD < 1) {
          LockCriticalCMD = LockCriticalCMD + 1;
          doSystem("ralink_init clear 2860");
          doSystem("ralink_init renew 2860 /etc_ro/Wireless/RT2860AP/RT2860_default_vlan");
          iVar1 = getSysInfoShort(0x41);
          if (iVar1 != 2) {
            doSystem("sleep %d && reboot &",3);
            set_reboot_time(3,0);
          }
        }
        else {
          PendRebootCMD = 3;
          PendRebootMode = 0;
        }
      }
    }
  }
  else {
    uVar2 = websGetVar(param_1,"Reset",&DAT_0049445c);
    iVar1 = webncasestrcmp(uVar2,&DAT_0048b66c);
    if (iVar1 == 0) {
      if (LockCriticalCMD < 1) {
        LockCriticalCMD = LockCriticalCMD + 1;
        iVar1 = getSysInfoShort(0x41);
        if (iVar1 != 2) {
          doSystem("sleep %d && reboot &",3);
          set_reboot_time(3,1);
        }
      }
      else {
        PendRebootCMD = 3;
        PendRebootMode = 1;
      }
    }
  }
  websReplyNoContent(param_1);
  return;
}



void getconfig(int param_1,char *param_2)

{
  bool bVar1;
  char *pcVar2;
  int iVar3;
  short *__s;
  byte *__s_00;
  int __fd;
  size_t sVar4;
  int iVar5;
  int iVar6;
  byte *pbVar7;
  size_t __n;
  short *psVar8;
  byte bVar9;
  short local_110;
  stat sStack_108;
  undefined auStack_70 [64];
  char *local_30 [2];
  
  local_110 = 0;
  bVar9 = 0;
  if (param_2 == (char *)0x0) {
    websConnError(param_1,0x1f7,"Insufficient memory");
    return;
  }
  iVar3 = stat(param_2,&sStack_108);
  if (iVar3 < 0) {
    websConnError(param_1,400,"Cannot stat page for URL");
    return;
  }
  iVar3 = ((int)(sStack_108.st_atim.tv_sec + 1U) / 2) * 2;
  __n = iVar3 + 2;
  __s = (short *)mmalloc(__n);
  __s_00 = (byte *)mmalloc(__n);
  if ((__s == (short *)0x0) || (__s_00 == (byte *)0x0)) {
    trace(1,"getconfig: allocate buffer failure\n");
    websConnError(param_1,0x1f7,"Allocate buffer failure");
    if (__s != (short *)0x0) {
LAB_00434fb8:
      free(__s);
    }
    if (__s_00 != (byte *)0x0) {
      free(__s_00);
    }
  }
  else {
    memset(__s,0,__n);
    memset(__s_00,0,__n);
    __fd = open(param_2,0);
    if (__fd < 0) {
      websConnError(param_1,0x194,"getconfig: Cannot open URL(%s)\n",param_2);
    }
    else {
      sVar4 = read(__fd,__s + 1,sStack_108.st_atim.tv_sec);
      if (sVar4 == sStack_108.st_atim.tv_sec) {
        iVar6 = (int)__n >> 1;
        iVar5 = iVar6;
        psVar8 = __s;
        if (0 < iVar6) {
          do {
            iVar5 = iVar5 + -1;
            local_110 = *psVar8 + local_110;
            psVar8 = psVar8 + 1;
          } while (iVar5 != 0);
        }
        iVar5 = 0;
        *__s = 0x5a5a - local_110;
        psVar8 = __s;
        if (0 < iVar6) {
          do {
            pbVar7 = __s_00 + iVar5;
            *pbVar7 = *(byte *)((int)psVar8 + 1);
            iVar5 = iVar5 + 1;
            pbVar7[iVar6] = *(byte *)psVar8;
            psVar8 = psVar8 + 1;
          } while (iVar5 < iVar6);
        }
        iVar5 = 0;
        if (0 < (int)__n) {
          pbVar7 = __s_00;
          do {
            while( true ) {
              if (iVar5 == 0) {
                bVar9 = *__s_00 >> 5;
              }
              if (iVar3 + 1 != iVar5) break;
              iVar5 = iVar5 + 1;
              *pbVar7 = *pbVar7 * '\b' + bVar9;
              pbVar7 = pbVar7 + 1;
              if ((int)__n <= iVar5) goto LAB_004350f0;
            }
            iVar5 = iVar5 + 1;
            *pbVar7 = *pbVar7 * '\b' + (pbVar7[1] >> 5);
            pbVar7 = pbVar7 + 1;
          } while (iVar5 < (int)__n);
LAB_004350f0:
          iVar3 = 0;
          if (0 < (int)__n) {
            do {
              pbVar7 = __s_00 + iVar3;
              iVar3 = iVar3 + 1;
              *pbVar7 = (*pbVar7 + 0x65 ^ 0x5a) + 0x87;
            } while (iVar3 < (int)__n);
          }
        }
        local_30[0] = (char *)0x0;
        memset(auStack_70,0,0x40);
        getSysInfoBuffer(1,auStack_70,0x40);
        allocFmtString(local_30,0xfe,&DAT_0048cc18,"Steven Wu",auStack_70);
        pcVar2 = local_30[0];
        if (local_30[0] != (char *)0x0) {
          sVar4 = strlen(local_30[0]);
          CBlowfish(pcVar2,sVar4);
          Blowfish_EnCode(__s_00,__s,__n);
          if (local_30[0] != (char *)0x0) {
            free(local_30[0]);
            local_30[0] = (char *)0x0;
          }
        }
        websWriteSpecialHeader
                  (param_1,200,__n,"application/octet-stream",0,
                   "Content-Transfer-Encoding: binary\r\nContent-Disposition: attachment; filename=\"Config.CFG\"\r\n"
                   ,0);
        psVar8 = __s;
        for (; iVar3 = 1000, 0 < (int)__n; __n = __n - iVar5) {
          while( true ) {
            sVar4 = __n;
            if ((*(char *)(param_1 + 0xe4) < '\0') && (0x200 < (int)__n)) {
              sVar4 = 0x200;
            }
            iVar5 = websWritePartial(param_1,psVar8,sVar4);
            if (iVar5 < 0) goto LAB_0043523c;
            if (iVar5 != 0) break;
            bVar1 = iVar3 < 1;
            iVar3 = iVar3 + -1;
            if ((bVar1) || (usleep(5000), (int)__n < 1)) goto LAB_0043523c;
          }
          psVar8 = (short *)((int)psVar8 + iVar5);
        }
LAB_0043523c:
        websConnClose(param_1,200);
        close(__fd);
        goto LAB_00434fb8;
      }
      trace(1,"getconfig: Cannot read URL(%d)\n",sVar4);
      websConnError(param_1,0x194,"Cannot read URL");
      close(__fd);
    }
    free(__s);
    free(__s_00);
  }
  return;
}



void audiodetection(int param_1)

{
  bool bVar1;
  int iVar2;
  char *pcVar3;
  undefined4 uVar4;
  uint uVar5;
  
  trace(1,"audiodetection(wp->query=%s)!\n",*(undefined4 *)(param_1 + 0xa0));
  bVar1 = false;
  if (((*(uint *)(param_1 + 0xe4) & 1) == 0) && (**(char **)(param_1 + 0xa0) == '\0'))
  goto LAB_00435420;
  iVar2 = websTestVar(param_1,"enable");
  if (iVar2 != 0) {
    pcVar3 = (char *)websGetVar(param_1,"enable",&DAT_0048eb44);
    iVar2 = strcmp(pcVar3,"no");
    if (iVar2 == 0) {
      pcVar3 = "plen == 0";
    }
    else {
      iVar2 = strcmp(pcVar3,"yes");
      if (iVar2 != 0) {
        bVar1 = true;
        goto LAB_004353f0;
      }
      pcVar3 = "iter == 1";
    }
    websSetVar(param_1,"SoundDetectionEnable",pcVar3 + 8);
  }
LAB_004353f0:
  iVar2 = websTestVar(param_1,"sounddblevel");
  if (iVar2 != 0) {
    pcVar3 = (char *)websGetVar(param_1,"sounddblevel","0");
    uVar5 = atoi(pcVar3);
    if (uVar5 < 0x65) {
      websSetVar(param_1,"SoundDetectionDB",pcVar3);
    }
    else {
      bVar1 = true;
    }
  }
  if (!bVar1) {
    websSetVar(param_1,"SoundDetectionScheduleMode","0");
    iVar2 = CheckSoundDBVar(param_1);
    if ((iVar2 == 0) && (iVar2 = SystemSoundDBChanged(param_1), iVar2 != 0)) {
      WriteSoundDBVar(param_1);
      nvram_commit(0);
      setSysInfoLong(0x39,0x10000000);
      trace(1,"Sound Detection settings was changed!\n");
    }
  }
LAB_00435420:
  pcVar3 = (char *)nvram_bufget(0,"SoundDetectionEnable");
  uVar4 = nvram_bufget(0,"SoundDetectionDB");
  websWriteNormalHeader(param_1,200,0,"application/Dlink-inf",0);
  iVar2 = atoi(pcVar3);
  if (iVar2 == 0) {
    websWriteFmt(param_1,"enable=no\r\n");
  }
  else {
    if (iVar2 != 1) {
      websWriteFmt(param_1,"sounddblevel=%s\r\n",uVar4);
      websConnClose(param_1,200);
      return;
    }
    websWriteFmt(param_1,"enable=yes\r\n");
  }
  websWriteFmt(param_1,"sounddblevel=%s\r\n",uVar4);
  websConnClose(param_1,200);
  return;
}



void nipcauserverify(int param_1)

{
  size_t sVar1;
  int iVar2;
  char *__format;
  char acStack_50 [64];
  
  memset(acStack_50,0,0x40);
  iVar2 = *(int *)(param_1 + 0xc0);
  __format = "group=Administrator\r\n";
  if ((((iVar2 == 3) || (__format = "group=Controller\r\n", iVar2 == 2)) ||
      (__format = "group=User\r\n", iVar2 == 1)) || (__format = "group=None\r\n", iVar2 == 0)) {
    snprintf(acStack_50,0x40,__format);
  }
  sVar1 = strlen(acStack_50);
  websWriteNormalHeader(param_1,200,sVar1,"application/Dlink-inf",0);
  websWriteFmt(param_1,acStack_50);
  websConnClose(param_1,200);
  return;
}



void nipcacamerainfo(int param_1)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  size_t sVar5;
  char *__s2;
  char *__s1;
  char acStack_420 [1024];
  
  trace(1,"nipcacamerainfo(wp->query=%s)!\n",*(undefined4 *)(param_1 + 0xa0));
  bVar1 = false;
  if (((*(uint *)(param_1 + 0xe4) & 1) == 0) && (**(char **)(param_1 + 0xa0) == '\0'))
  goto LAB_00435944;
  iVar2 = websTestVar(param_1,"name");
  if (iVar2 == 0) {
LAB_00435914:
    iVar2 = websTestVar(param_1,"location");
  }
  else {
    uVar3 = websGetVar(param_1,"name",&DAT_0049445c);
    iVar2 = checkcameraname(param_1,uVar3,1,0x20,0);
    if (iVar2 == 0) {
      websSetVar(param_1,"CameraName",uVar3);
      goto LAB_00435914;
    }
    iVar2 = websTestVar(param_1,"location");
    bVar1 = true;
  }
  if (iVar2 != 0) {
    uVar3 = websGetVar(param_1,"location",&DAT_0049445c);
    trace(1,"nipcacamerainfo(location=%s)!\n",uVar3);
    iVar2 = checkmaxstring(param_1,uVar3,0x40,0);
    if (iVar2 != 0) goto LAB_00435944;
    websSetVar(param_1,"Location",uVar3);
  }
  if ((!bVar1) && (iVar2 = CheckSystemVar(param_1), iVar2 == 0)) {
    uVar3 = nvram_bufget(0,"CameraName");
    __s2 = (char *)websGetVar(param_1,"CameraName",&DAT_0049445c);
    __s1 = (char *)strdupWithoutNull(uVar3);
    WriteSystemVar(param_1);
    nvram_commit(0);
    if (__s1 != (char *)0x0) {
      if (__s2 != (char *)0x0) {
        iVar2 = strcmp(__s1,__s2);
        if (iVar2 != 0) {
          doSystem("cameraname.sh &");
        }
        if (__s1 == (char *)0x0) goto LAB_00435944;
      }
      free(__s1);
    }
  }
LAB_00435944:
  nvram_bufget(0,"Location");
  websGetVar(param_1,"Location",&DAT_0049445c);
  uVar3 = nvram_bufget(0,"CameraName");
  uVar4 = nvram_bufget(0,"Location");
  snprintf(acStack_420,0x400,"name=%s\r\nlocation=%s\r\n",uVar3,uVar4);
  sVar5 = strlen(acStack_420);
  websWriteNormalHeader(param_1,200,sVar5,"application/Dlink-inf",0);
  websWriteFmt(param_1,acStack_420);
  websConnClose(param_1,200);
  return;
}



void nipcarebootdevice(undefined4 param_1)

{
  bool bVar1;
  char *pcVar2;
  int iVar3;
  
  pcVar2 = (char *)websGetVar(param_1,"reboot",&DAT_0049445c);
  iVar3 = strcmp(pcVar2,"go");
  bVar1 = false;
  if (iVar3 == 0) {
    if (LockCriticalCMD < 1) {
      LockCriticalCMD = LockCriticalCMD + 1;
      iVar3 = getSysInfoShort(0x41);
      bVar1 = true;
      if (iVar3 != 2) {
        doSystem("sleep %d && reboot &",3);
        set_reboot_time(3,1);
      }
    }
    else {
      PendRebootCMD = 3;
      PendRebootMode = 1;
    }
  }
  websWriteNormalHeader(param_1,200,0,"application/Dlink-inf",0);
  pcVar2 = "reboot=yes\r\n";
  if (!bVar1) {
    pcVar2 = "reboot=fail\r\n";
  }
  websWriteFmt(param_1,pcVar2);
  websConnClose(param_1,200);
  return;
}



void nipcafactoryreset(undefined4 param_1)

{
  bool bVar1;
  char *pcVar2;
  int iVar3;
  
  pcVar2 = (char *)websGetVar(param_1,"reset",&DAT_0049445c);
  iVar3 = strcmp(pcVar2,"go");
  bVar1 = false;
  if (iVar3 == 0) {
    if (LockCriticalCMD < 1) {
      LockCriticalCMD = LockCriticalCMD + 1;
      doSystem("ralink_init clear 2860");
      bVar1 = true;
      doSystem("ralink_init renew 2860 /etc_ro/Wireless/RT2860AP/RT2860_default_vlan");
      iVar3 = getSysInfoShort(0x41);
      if (iVar3 != 2) {
        doSystem("sleep %d && reboot &",3);
        set_reboot_time(3,0);
      }
    }
    else {
      PendRebootCMD = 3;
      PendRebootMode = 0;
    }
  }
  websWriteNormalHeader(param_1,200,0,"application/Dlink-inf",0);
  pcVar2 = "reset=yes\r\n";
  if (!bVar1) {
    pcVar2 = "reset=fail\r\n";
  }
  websWriteFmt(param_1,pcVar2);
  websConnClose(param_1,200);
  return;
}



void nipcamicrophone(int param_1)

{
  bool bVar1;
  int iVar2;
  char *pcVar3;
  undefined4 uVar4;
  size_t sVar5;
  char acStack_68 [64];
  undefined4 local_28;
  undefined4 local_24;
  
  trace(1,"nipcamicrophone(wp->query=%s)!\n",*(undefined4 *)(param_1 + 0xa0));
  bVar1 = false;
  if (((*(uint *)(param_1 + 0xe4) & 1) == 0) && (**(char **)(param_1 + 0xa0) == '\0')) {
    pcVar3 = (char *)nvram_bufget(0,"AudioEnable");
    uVar4 = nvram_bufget(0,"AudioVolume");
    iVar2 = strcmp(pcVar3,"1");
  }
  else {
    iVar2 = websTestVar(param_1,"enable");
    if (iVar2 != 0) {
      pcVar3 = (char *)websGetVar(param_1,"enable","0");
      iVar2 = strcmp(pcVar3,"no");
      if (iVar2 == 0) {
        websSetVar(param_1,"AudioEnable","0");
      }
      else {
        iVar2 = strcmp(pcVar3,"yes");
        if (iVar2 == 0) {
          websSetVar(param_1,"AudioEnable","1");
        }
        else {
          bVar1 = true;
        }
      }
    }
    iVar2 = websTestVar(param_1,"volume");
    if (iVar2 != 0) {
      uVar4 = websGetVar(param_1,"volume","0");
      iVar2 = checkenumrange(param_1,uVar4,&audiovol_select);
      if (iVar2 == 0) {
        websSetVar(param_1,"AudioVolume",uVar4);
      }
      else {
        bVar1 = true;
      }
    }
    if (((!bVar1) && (iVar2 = CheckStreamVar(param_1), iVar2 == 0)) &&
       (iVar2 = StreamAudioChanged(param_1), iVar2 != 0)) {
      WriteStreamVar(param_1);
      nvram_commit(0);
      local_28 = 0;
      local_24 = 0;
      setSysInfoBuffer(0x5e,&local_28,1);
      setSysInfoLong(0x39,0x20);
      trace(1,"Audio settings was changed!\n");
    }
    pcVar3 = (char *)nvram_bufget(0,"AudioEnable");
    uVar4 = nvram_bufget(0,"AudioVolume");
    iVar2 = strcmp(pcVar3,"1");
  }
  if (iVar2 == 0) {
    pcVar3 = "enable=yes\r\nvolume=%s\r\n";
  }
  else {
    pcVar3 = "enable=no\r\nvolume=%s\r\n";
  }
  snprintf(acStack_68,0x40,pcVar3,uVar4);
  sVar5 = strlen(acStack_68);
  websWriteNormalHeader(param_1,200,sVar5,"application/Dlink-inf",0);
  websWriteFmt(param_1,acStack_68);
  websConnClose(param_1,200);
  return;
}



void nipcaportalinfo(undefined4 param_1)

{
  char *pcVar1;
  undefined4 uVar2;
  char *__s1;
  char *__nptr;
  int iVar3;
  
  pcVar1 = (char *)nvram_bufget(0,"AudioEnable");
  uVar2 = nvram_bufget(0,"AudioVolume");
  __s1 = (char *)nvram_bufget(0,"MotionDetectionEnable");
  __nptr = (char *)nvram_bufget(0,"VideoResolution");
  websWriteNormalHeader(param_1,200,0,"application/Dlink-inf",0);
  iVar3 = strcmp(pcVar1,"1");
  if (iVar3 == 0) {
    pcVar1 = "mic_enable=yes\r\nmic_volume=%s\r\n";
  }
  else {
    pcVar1 = "mic_enable=no\r\nmic_volume=%s\r\n";
  }
  websWriteFmt(param_1,pcVar1,uVar2);
  websWriteFmt(param_1,"spk_enable=NA\r\nspk_volume=NA\r\n");
  pcVar1 = (char *)nvram_bufget(0,"DayNightMode");
  iVar3 = strcmp(pcVar1,"0");
  if (iVar3 == 0) {
    pcVar1 = "icr_mode=auto\r\n";
  }
  else {
    iVar3 = strcmp(pcVar1,"1");
    if (iVar3 == 0) {
      pcVar1 = "icr_mode=manual\r\n";
    }
    else {
      iVar3 = strcmp(pcVar1,"2");
      if (iVar3 == 0) {
        pcVar1 = "icr_mode=day\r\n";
      }
      else {
        iVar3 = strcmp(pcVar1,"3");
        if (iVar3 == 0) {
          pcVar1 = "icr_mode=night\r\n";
        }
        else {
          iVar3 = strcmp(pcVar1,"4");
          if (iVar3 == 0) {
            websWriteFmt(param_1,"icr_mode=schedule\r\n");
            websWriteFmt(param_1,"dgtalkie=no\r\n");
            pcVar1 = (char *)nvram_bufget(0,"SoundDetectionEnable");
            iVar3 = strcmp(pcVar1,"1");
            goto joined_r0x00436690;
          }
          pcVar1 = "icr_mode=invalid\r\n";
        }
      }
    }
  }
  websWriteFmt(param_1,pcVar1);
  websWriteFmt(param_1,"dgtalkie=no\r\n");
  pcVar1 = (char *)nvram_bufget(0,"SoundDetectionEnable");
  iVar3 = strcmp(pcVar1,"1");
joined_r0x00436690:
  if (iVar3 == 0) {
    websWriteFmt(param_1,"adt_enable=yes\r\n");
    iVar3 = strcmp(__s1,"1");
  }
  else {
    websWriteFmt(param_1,"adt_enable=no\r\n");
    iVar3 = strcmp(__s1,"1");
  }
  if (iVar3 == 0) {
    pcVar1 = "md_enable=yes\r\n";
  }
  else {
    pcVar1 = "md_enable=no\r\n";
  }
  websWriteFmt(param_1,pcVar1);
  websWriteFmt(param_1,"sd_status=NA\r\nsd_total=NA\r\nsd_used=NA\r\nsd_free=NA\r\n");
  websWriteFmt(param_1,"rec_enable=NA\r\nrec_type=NA\r\nrec_profileid=NA\r\nrec_file_formate=NA\r\n"
              );
  websWriteFmt(param_1,"vprofilenum=1\r\n");
  websWriteFmt(param_1,"vprofile1=MJPEG\r\n");
  websWriteFmt(param_1,"vprofileurl1=/video.cgi\r\n");
  websWriteFmt(param_1,"vDprofileurl1=/dgvideo.cgi\r\n");
  iVar3 = atoi(__nptr);
  uVar2 = websGetSelectString(resolution_select,iVar3);
  websWriteFmt(param_1,"vprofileres1=%s\r\n",uVar2);
  websConnClose(param_1,200);
  return;
}



undefined4 websFrameProcessor(int param_1)

{
  int iVar1;
  size_t sVar2;
  in_addr_t iVar3;
  char *pcVar4;
  undefined *puVar5;
  int *piVar6;
  int iVar7;
  undefined4 *puVar8;
  int iVar9;
  char *__filename;
  __pid_t _Var10;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  char acStack_60 [64];
  
  puVar8 = &framesupportPathList;
  trace(1,"websFrameProcessor=%s\n",*(undefined4 *)(param_1 + 0x88));
  _Var10 = -2;
  iVar9 = 0;
  __filename = (char *)0x0;
  iVar7 = 0;
  puVar5 = PTR_WebInteralSnapImgCGI_004d61d8;
  while ((puVar5 != (undefined *)0x0 &&
         (iVar1 = webncasestrcmp(*(undefined4 *)(param_1 + 0x88),puVar8[1]), iVar1 != 0))) {
    iVar9 = iVar9 + 1;
    iVar7 = iVar9 * 8;
    puVar5 = (&PTR_WebInteralSnapImgCGI_004d61d8)[iVar9 * 2];
    puVar8 = &framesupportPathList + iVar9 * 2;
  }
  iVar7 = *(int *)((int)&framesupportPathList + iVar7);
  if ((iVar7 == 4) && (__filename = (char *)websGetTempFileName(), __filename != (char *)0x0)) {
    doSystem("echo \"#The following line must not be removed.\" > %s",__filename);
    doSystem("echo \"Restore\" >> %s",__filename);
    doSystem("ralink_init show 2860 >> %s",__filename);
  }
  switch(iVar7) {
  case 0:
    _Var10 = fork();
    if (_Var10 == 0) {
      _Var10 = getpid();
      trace(0x10,"now in the frame child process(%d, %s).\n",_Var10,*(undefined4 *)(param_1 + 0x90))
      ;
      if (iVar7 == 0) {
        snapimage(param_1);
                    // WARNING: Subroutine does not return
        exit(0);
      }
                    // WARNING: Subroutine does not return
      exit(0);
    }
    if (_Var10 == -1) {
      trace(0x10,"\nframe fork process failure.\n");
      pcVar4 = "Fork process failure.";
    }
    else {
      if (_Var10 != -2) {
        iVar1 = AllocEntry(&DAT_004d8cdc,&DAT_004d6264,0x10);
        if (-1 < iVar1) {
          piVar6 = *(int **)(iVar1 * 4 + DAT_004d8cdc);
          piVar6[3] = iVar9;
          *piVar6 = param_1;
          piVar6[1] = _Var10;
          piVar6[2] = iVar7;
          websTimeoutCancel(param_1);
        }
        break;
      }
      trace(0x10,"\ntask busy.\n");
      pcVar4 = "task busy.";
    }
    websConnError(param_1,0x1f5,pcVar4);
    break;
  case 1:
    authorizationmode(param_1);
    break;
  case 2:
    resetdevice(param_1);
    break;
  case 3:
    memset(acStack_60,0,0x40);
    snprintf(acStack_60,0x40,"%s","3.9.3");
    sVar2 = strlen(acStack_60);
    websWriteNormalHeader(param_1,200,sVar2,"text/html",0);
    websWriteFmt(param_1,acStack_60);
    goto LAB_00436bb0;
  case 4:
    getconfig(param_1,__filename);
    break;
  case 5:
    iocontrol(param_1);
    break;
  case 6:
    pcVar4 = (char *)websGetVar(param_1,"AudioMute","0");
    iVar9 = atoi(pcVar4);
    pcVar4 = (char *)websGetVar(param_1,"REMOTE_ADDR",&DAT_0049445c);
    iVar3 = inet_addr(pcVar4);
    if (iVar9 == 0) {
      setSysInfoLong(0x33,iVar3);
    }
    else if (iVar9 == 1) {
      setSysInfoLong(0x34,iVar3);
    }
    goto LAB_00436c90;
  case 7:
    pcVar4 = (char *)nvram_bufget(0,"DayNightMode");
    if ((((*(uint *)(param_1 + 0xe4) & 1) != 0) && (iVar9 = strcmp(pcVar4,"1"), iVar9 == 0)) &&
       (iVar9 = websTestVar(param_1,"IRLed"), iVar9 != 0)) {
      pcVar4 = (char *)websGetVar(param_1,"IRLed","0");
      iVar9 = atoi(pcVar4);
      setSysInfoShort(0x4a,(int)(short)iVar9);
    }
LAB_00436c90:
    websReplyNoContent(param_1);
    break;
  case 8:
    local_70 = 0;
    local_6c = 0;
    local_68 = 0;
    local_64 = 0;
    getSysInfoBuffer(0x5e,&local_70,1);
    iVar9 = (int)(char)local_70;
    websWriteNormalHeader(param_1,200,0,"application/Dlink-inf",0);
    websWriteFmt(param_1,"audio_detect_val=%d\r\n",iVar9);
LAB_00436bb0:
    websConnClose(param_1,200);
    break;
  case 9:
    audiodetection(param_1);
    break;
  case 10:
    nipcauserverify(param_1);
    break;
  case 0xb:
    nipcacamerainfo(param_1);
    break;
  case 0xc:
    nipcarebootdevice(param_1);
    break;
  case 0xd:
    nipcafactoryreset(param_1);
    break;
  case 0xe:
    nipcamicrophone(param_1);
    break;
  case 0xf:
    nipcaportalinfo(param_1);
    break;
  default:
    websConnError(param_1,500,"Not Implemented");
  }
  if (((_Var10 + 2U < 2) && (iVar7 == 4)) && (__filename != (char *)0x0)) {
    remove(__filename);
    free(__filename);
  }
  return 1;
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void websFrameReapChildren(void)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  code *pcVar5;
  undefined auStack_28 [8];
  
  iVar4 = 0;
  if (-1 < _DAT_004d6264) {
    do {
      piVar2 = *(int **)(iVar4 * 4 + DAT_004d8cdc);
      if (piVar2 != (int *)0x0) {
        piVar3 = (int *)*piVar2;
        iVar1 = websReapChildren(piVar2[1],auStack_28);
        pcVar5 = websRefreshCookieDigest;
        if (iVar1 == 0) {
          websConnClose(piVar3,200);
          trace(0x10,"frame child exited(%d)!\n",piVar2[1]);
          _DAT_004d6264 = FreeEntryId(&DAT_004d8cdc,iVar4);
          pcVar5 = free;
          piVar3 = piVar2;
        }
        (*pcVar5)(piVar3);
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 <= _DAT_004d6264);
  }
  return;
}



void imagepush(int param_1,int param_2,char *param_3,char **param_4,char **param_5)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  
  iVar1 = websSocketGetPtr(*(undefined4 *)(param_1 + 0xd4));
  if (iVar1 != 0) {
    if ((param_2 == 0) || (param_2 == 2)) {
      websWriteSpecialHeader
                (param_1,200,0,0,0,"Content-Type: multipart/x-mixed-replace;boundary=%s\r\n",
                 Webboundary);
      fcntl(*(int *)(iVar1 + 0x70),2,0);
      iVar1 = execve(param_3,param_4,param_5);
    }
    else {
      websWriteSpecialHeader
                (param_1,200,0,0,0,"Content-Type: multipart/x-mixed-replace;boundary=%s\r\n",
                 Webboundary + 2);
      fcntl(*(int *)(iVar1 + 0x70),2,0);
      iVar1 = execve(param_3,param_4,param_5);
    }
    if (iVar1 == -1) {
      puts("content-type: text/html\n\nExecution of cgi process failed");
      piVar2 = __errno_location();
      pcVar3 = strerror(*piVar2);
      trace(0x10,"Can\'t execve %s: %s\n",param_3,pcVar3);
      return;
    }
  }
  return;
}



undefined4 websStreamProcessor(int param_1)

{
  int iVar1;
  int iVar2;
  char **__argv;
  char *pcVar3;
  char **ppcVar4;
  undefined *puVar5;
  __pid_t _Var6;
  size_t sVar7;
  char *pcVar8;
  char **ppcVar9;
  int *piVar10;
  int iVar11;
  int *piVar12;
  int iVar13;
  int iVar14;
  char *param_5;
  short local_40;
  short local_3e;
  char *local_38;
  int local_34;
  int local_30;
  int local_2c;
  
  local_38 = (char *)0x0;
  iVar14 = 0;
  iVar1 = websSocketGetPtr(*(undefined4 *)(param_1 + 0xd4));
  trace(1,"websStreamProcessor=%s\n",*(undefined4 *)(param_1 + 0x88));
  local_30 = -2;
  local_2c = 0;
  if (StearmSupportPathList._4_4_ != 0) {
    piVar12 = (int *)(StearmSupportPathList + 4);
    piVar10 = piVar12;
    do {
      iVar2 = webncasestrcmp(*(undefined4 *)(param_1 + 0x88),*piVar12);
      piVar10 = piVar10 + 3;
      if (iVar2 == 0) break;
      iVar14 = iVar14 + 1;
      local_2c = iVar14 * 2;
      piVar12 = piVar12 + 3;
    } while (*piVar10 != 0);
  }
  iVar2 = (local_2c + iVar14) * 4;
  iVar13 = *(int *)(StearmSupportPathList + iVar2);
  if (iVar13 == 0xf) {
    websConnError(param_1,500,"Not Implemented");
    return 1;
  }
  allocFmtString(&local_38,0xfe,"%s",*(undefined4 *)(StearmSupportPathList + iVar2 + 8));
  trace(1,"streamPath=%s\n",local_38);
  if (local_38 == (char *)0x0) {
    websConnError(param_1,0x1f7,"Insufficient memory");
    return 1;
  }
  iVar2 = access(local_38,1);
  if (iVar2 != 0) {
    websConnError(param_1,500,"Stream CGI process file is not executable");
    if (local_38 == (char *)0x0) {
      return 1;
    }
    free(local_38);
    return 1;
  }
  __argv = (char **)mmalloc(0x28);
  local_34 = 10;
  if (__argv != (char **)0x0) {
    *__argv = local_38;
    pcVar3 = strchr(param_5,0x3d);
    iVar2 = 1;
    if (pcVar3 == (char *)0x0) {
      sVar7 = strlen(param_5);
      websDecodeUrl(param_5,param_5,sVar7);
      while (pcVar3 = strtok(param_5," "), pcVar3 != (char *)0x0) {
        __argv[iVar2] = pcVar3;
        if ((local_34 <= iVar2 + 1) &&
           (ppcVar4 = (char **)mmalloc(local_34 << 3), ppcVar4 != (char **)0x0)) {
          memcpy(ppcVar4,__argv,local_34 << 2);
          if (__argv != (char **)0x0) {
            free(__argv);
          }
          local_34 = local_34 << 1;
          __argv = ppcVar4;
        }
        param_5 = (char *)0x0;
        iVar2 = iVar2 + 1;
      }
    }
    __argv[iVar2] = (char *)0x0;
    pcVar3 = *__argv;
    iVar2 = 0;
    ppcVar4 = __argv;
    while (pcVar3 != (char *)0x0) {
      iVar11 = iVar2 + 1;
      trace(1,"Stream argp%2d==>%s\n",iVar2,*ppcVar4);
      ppcVar4 = __argv + iVar11;
      iVar2 = iVar11;
      pcVar3 = __argv[iVar11];
    }
  }
  ppcVar4 = (char **)mmalloc(0x100);
  if (ppcVar4 != (char **)0x0) {
    puVar5 = *(undefined **)(param_1 + 0xac);
    if (puVar5 == (undefined *)0x0) {
      puVar5 = &DAT_0049445c;
    }
    allocFmtString(ppcVar4,0xfe,"%s=%s","REMOTE_USER",puVar5);
    puVar5 = *(undefined **)(param_1 + 0xa4);
    if (puVar5 == (undefined *)0x0) {
      puVar5 = &DAT_0049445c;
    }
    allocFmtString(ppcVar4 + 1,0xfe,"%s=%s","AUTH_TYPE",puVar5);
    if ((*(uint *)(param_1 + 0xe4) & 1) == 0) {
      puVar5 = &DAT_0048a12c;
    }
    else {
      puVar5 = &DAT_0048a130;
    }
    allocFmtString(ppcVar4 + 2,0xfe,"%s=%s","HTTP_REQUEST",puVar5);
    iVar2 = 3;
    if (iVar1 != 0) {
      allocFmtString(ppcVar4 + 3,0xfe,"%s=%d","SOCK_HANDLE",*(undefined4 *)(iVar1 + 0x70));
      allocFmtString(ppcVar4 + 4,0xfe,"%s=%d","SOCK_PORT",*(undefined4 *)(iVar1 + 0x68));
      iVar2 = 5;
    }
    if (((iVar13 == 0) || (iVar13 == 2)) || (iVar13 == 1)) {
      if (iVar13 == 2) {
        pcVar3 = "iter == 1";
      }
      else {
        pcVar3 = "plen == 0";
      }
      allocFmtString(ppcVar4 + iVar2,0xfe,"%s=%s","MOTION_DETECTION",pcVar3 + 8);
      allocFmtString(ppcVar4 + iVar2 + 1,0xfe,"%s=%s","HTTP_BOUNDRY",Webboundary);
      allocFmtString(ppcVar4 + iVar2 + 2,0xfe,"%s=%s","HTTP_CONTENTTYPE",Webcontenttypejpeg);
      if ((iVar13 == 0) || (iVar13 == 2)) {
        pcVar3 = "plen == 0";
      }
      else {
        pcVar3 = "iter == 1";
      }
      allocFmtString(ppcVar4 + iVar2 + 3,0xfe,"%s=%s","MULTI_PART",pcVar3 + 8);
      iVar2 = iVar2 + 4;
    }
    ppcVar4[iVar2] = (char *)0x0;
    pcVar3 = *ppcVar4;
    iVar1 = 0;
    ppcVar9 = ppcVar4;
    while (pcVar3 != (char *)0x0) {
      iVar2 = iVar1 + 1;
      trace(1,"Stream envp%2d==>%s\n",iVar1,*ppcVar9);
      ppcVar9 = ppcVar4 + iVar2;
      iVar1 = iVar2;
      pcVar3 = ppcVar4[iVar2];
    }
  }
  if ((((((iVar13 == 0) || (iVar13 == 2)) ||
        ((iVar13 == 1 || (((iVar13 == 3 || (iVar13 == 5)) || (iVar13 == 6)))))) ||
       ((iVar13 == 9 || (iVar13 == 10)))) || (iVar13 == 0xb)) ||
     (((iVar13 == 0xc || (iVar13 == 0xd)) || ((iVar13 == 4 || (iVar13 == 0xe)))))) {
    getSysInfoBuffer(0x46,&local_40,4);
  }
  if (((((((((iVar13 != 0) && (iVar13 != 2)) && (iVar13 != 1)) && ((iVar13 != 9 && (iVar13 != 10))))
         && ((iVar13 != 0xb && ((iVar13 != 0xc && (iVar13 != 0xd)))))) && (iVar13 != 0xe)) ||
       (9 < local_40)) &&
      ((((((iVar13 != 3 && (iVar13 != 5)) && (iVar13 != 6)) && (iVar13 != 4)) || (9 < local_3e)) &&
       (1 < iVar13 - 7U)))) || (local_30 = fork(), local_30 != 0)) {
    if (1 < local_30 + 2U) {
      iVar1 = AllocEntry(&DAT_004d8ce0,&DAT_004d62ec,0x1c);
      if (-1 < iVar1) {
        piVar10 = *(int **)(iVar1 * 4 + DAT_004d8ce0);
        piVar10[5] = iVar13;
        piVar10[4] = local_30;
        piVar10[6] = iVar14;
        piVar10[2] = (int)__argv;
        piVar10[1] = (int)local_38;
        piVar10[3] = (int)ppcVar4;
        *piVar10 = param_1;
        websTimeoutCancel(param_1);
        return 1;
      }
      if (__argv != (char **)0x0) {
        pcVar3 = *__argv;
        ppcVar9 = __argv;
        while (pcVar3 != (char *)0x0) {
          free(pcVar3);
          *ppcVar9 = (char *)0x0;
          ppcVar9 = ppcVar9 + 1;
          if (ppcVar9 == (char **)0x0) break;
          pcVar3 = *ppcVar9;
        }
      }
      if (ppcVar4 != (char **)0x0) {
        pcVar3 = *ppcVar4;
        ppcVar9 = ppcVar4;
        while (pcVar3 != (char *)0x0) {
          free(pcVar3);
          *ppcVar9 = (char *)0x0;
          ppcVar9 = ppcVar9 + 1;
          if (ppcVar9 == (char **)0x0) break;
          pcVar3 = *ppcVar9;
        }
      }
      if (local_38 != (char *)0x0) {
        free(local_38);
        local_38 = (char *)0x0;
      }
      if (__argv != (char **)0x0) {
        free(__argv);
      }
      if (ppcVar4 == (char **)0x0) {
        return 1;
      }
      free(ppcVar4);
      return 1;
    }
    if (ppcVar4 != (char **)0x0) {
      pcVar3 = *ppcVar4;
      ppcVar9 = ppcVar4;
      while (pcVar3 != (char *)0x0) {
        free(pcVar3);
        *ppcVar9 = (char *)0x0;
        ppcVar9 = ppcVar9 + 1;
        if (ppcVar9 == (char **)0x0) break;
        pcVar3 = *ppcVar9;
      }
    }
    if (local_38 != (char *)0x0) {
      free(local_38);
      local_38 = (char *)0x0;
    }
    if (__argv != (char **)0x0) {
      free(__argv);
    }
    if (ppcVar4 != (char **)0x0) {
      free(ppcVar4);
    }
    if (local_30 == -1) {
      trace(0x10,"\nstream fork process failure.\n");
      pcVar3 = "Fork process failure.";
    }
    else {
      if (local_30 != -2) {
        return 1;
      }
      trace(0x10,"\ntask busy.\n");
      pcVar3 = "task busy.";
    }
    websConnError(param_1,0x1f5,pcVar3);
    return 1;
  }
  _Var6 = getpid();
  trace(0x10,"now in the stream child process(%d, %s, %s).\n",_Var6,*(undefined4 *)(param_1 + 0x90),
        *(undefined4 *)(StearmSupportPathList + (local_2c + iVar14) * 4 + 8));
  pcVar3 = local_38;
  switch(iVar13) {
  case 0:
  case 1:
  case 2:
    imagepush(param_1,iVar13,local_38,__argv,ppcVar4);
    goto LAB_00437e94;
  case 3:
  case 8:
    iVar1 = websSocketGetPtr(*(undefined4 *)(param_1 + 0xd4));
    if (iVar1 == 0) goto switchD_004379c0_caseD_4;
    websWriteNormalHeader(param_1,200,0,"audio/x-wav",0);
    fcntl(*(int *)(iVar1 + 0x70),2,0);
    iVar1 = execve(pcVar3,__argv,ppcVar4);
    if (iVar1 != -1) goto switchD_004379c0_caseD_4;
    puts("content-type: text/html\n\nExecution of cgi process failed");
    piVar10 = __errno_location();
    pcVar8 = strerror(*piVar10);
    break;
  default:
switchD_004379c0_caseD_4:
                    // WARNING: Subroutine does not return
    exit(0);
  case 7:
    iVar1 = websSocketGetPtr(*(undefined4 *)(param_1 + 0xd4));
    if (iVar1 == 0) goto switchD_004379c0_caseD_4;
    if ((*(uint *)(param_1 + 0xe4) & 1) != 0) {
      websConnError(param_1,0x195,"Method Not Allowed.");
      goto LAB_00437e94;
    }
    fcntl(*(int *)(iVar1 + 0x70),2,0);
    iVar1 = execve(pcVar3,__argv,ppcVar4);
    if (iVar1 != -1) goto switchD_004379c0_caseD_4;
    puts("content-type: text/html\n\nExecution of cgi process failed");
    piVar10 = __errno_location();
    pcVar8 = strerror(*piVar10);
  }
  trace(0x10,"Can\'t execve %s: %s\n",pcVar3,pcVar8);
LAB_00437e94:
                    // WARNING: Subroutine does not return
  exit(0);
}



void websStreamReapChildren(void)

{
  int iVar1;
  uint uVar2;
  char *pcVar3;
  undefined4 uVar4;
  void **ppvVar5;
  undefined4 *__ptr;
  int iVar6;
  int iVar7;
  uint local_28 [2];
  
  iVar7 = 0;
  if (-1 < DAT_004d62ec) {
    do {
      __ptr = *(undefined4 **)(iVar7 * 4 + DAT_004d8ce0);
      if (__ptr != (undefined4 *)0x0) {
        uVar4 = *__ptr;
        iVar1 = websReapChildren(__ptr[4],local_28);
        if (iVar1 == 0) {
          iVar6 = __ptr[5];
          iVar1 = __ptr[6];
          websConnClose(uVar4,200);
          if ((((((iVar6 == 0) || (iVar6 == 2)) || (iVar6 == 1)) || ((iVar6 == 3 || (iVar6 == 5))))
              || ((iVar6 == 6 || ((iVar6 == 7 || (iVar6 == 8)))))) ||
             ((iVar6 == 9 ||
              ((((iVar6 == 10 || (iVar6 == 0xb)) || (iVar6 == 0xc)) ||
               ((iVar6 == 0xd || (iVar6 == 4)))))))) {
            if (*(int *)(StearmSupportPathList + iVar1 * 0xc + 8) == 0) {
              trace(0x10,"child exited!\n");
            }
            else {
              uVar2 = local_28[0] & 0x7f;
              if (uVar2 == 0) {
                uVar2 = (int)(local_28[0] & 0xff00) >> 8;
                uVar4 = __ptr[4];
                pcVar3 = "stream child(%d, %s) exited, status=%d\n";
              }
              else if ((local_28[0] & 0xff) == 0x7f) {
                uVar4 = __ptr[4];
                uVar2 = (int)(local_28[0] & 0xff00) >> 8;
                pcVar3 = "stream child(%d, %s) stopped (signal %d)\n";
              }
              else {
                uVar4 = __ptr[4];
                pcVar3 = "stream child(%d, %s) killed (signal %d)\n";
              }
              trace(0x10,pcVar3,uVar4,*(int *)(StearmSupportPathList + iVar1 * 0xc + 8),uVar2);
            }
            DAT_004d62ec = FreeEntryId(&DAT_004d8ce0,iVar7);
            for (ppvVar5 = (void **)__ptr[3]; (ppvVar5 != (void **)0x0 && (*ppvVar5 != (void *)0x0))
                ; ppvVar5 = ppvVar5 + 1) {
              free(*ppvVar5);
              *ppvVar5 = (void *)0x0;
            }
            if ((void *)__ptr[1] != (void *)0x0) {
              free((void *)__ptr[1]);
              __ptr[1] = 0;
            }
            if ((void *)__ptr[2] != (void *)0x0) {
              free((void *)__ptr[2]);
              __ptr[2] = 0;
            }
            if ((void *)__ptr[3] != (void *)0x0) {
              free((void *)__ptr[3]);
              __ptr[3] = 0;
            }
            free(__ptr);
          }
          else {
            trace(0x10,"\nstream child process free.\n");
          }
        }
        else {
          websRefreshCookieDigest(uVar4);
        }
      }
      iVar7 = iVar7 + 1;
    } while (iVar7 <= DAT_004d62ec);
  }
  return;
}



void InitBlowfish(void)

{
  int iVar1;
  undefined4 *puVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  uint uVar6;
  undefined4 uVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  uint *puVar11;
  uint *puVar12;
  
  iVar1 = 0;
  do {
    uVar4 = (&ks0)[iVar1];
    uVar5 = (&ks1)[iVar1];
    uVar7 = (&ks2)[iVar1];
    iVar9 = iVar1 + 1;
    *(undefined4 *)(&DAT_004d9920 + iVar1 * 4) = (&ks3)[iVar1];
    (&c)[iVar1] = uVar4;
    (&DAT_004d9120)[iVar1] = uVar5;
    (&DAT_004d9520)[iVar1] = uVar7;
    iVar1 = iVar9;
  } while (iVar9 < 0x100);
  puVar2 = &DAT_004d9d20;
  iVar1 = 0x11;
  do {
    iVar1 = iVar1 + -1;
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  } while (-1 < iVar1);
  puVar2 = &c;
  uVar6 = 0;
  iVar1 = 0;
  do {
    uVar8 = 0;
    iVar9 = 3;
    do {
      iVar9 = iVar9 + -1;
      uVar8 = uVar8 << 8 | (uint)(byte)(&key)[uVar6];
      uVar6 = uVar6 + 1 & 0xffff;
      uVar3 = keylen;
      if (0x38 < keylen) {
        uVar3 = 0x38;
      }
      if (uVar3 <= uVar6) {
        uVar6 = 0;
      }
    } while (-1 < iVar9);
    iVar1 = iVar1 + 1;
    puVar2[0x400] = puVar2[0x400] ^ uVar8;
    puVar2 = puVar2 + 1;
  } while (iVar1 < 0x12);
  puVar2 = &c;
  iVar1 = 0;
  uVar8 = 0;
  uVar6 = 0;
  do {
    puVar11 = &DAT_004d9d20;
    iVar9 = 0xf;
    do {
      iVar9 = iVar9 + -1;
      uVar3 = uVar8 ^ *puVar11;
      uVar8 = uVar6 ^ ((&c)[uVar3 >> 0x18] + *(int *)((int)&DAT_004d9120 + (uVar3 >> 0xe & 0x3fc)) ^
                      *(uint *)((int)&DAT_004d9520 + (uVar3 >> 6 & 0x3fc))) +
                      *(int *)(&DAT_004d9920 + (uVar3 & 0xff) * 4);
      puVar11 = puVar11 + 1;
      uVar6 = uVar3;
    } while (-1 < iVar9);
    uVar6 = uVar8 ^ DAT_004d9d60;
    uVar8 = uVar3 ^ DAT_004d9d64;
    iVar1 = iVar1 + 2;
    puVar2[0x400] = uVar8;
    puVar2[0x401] = uVar6;
    puVar2 = puVar2 + 2;
  } while (iVar1 < 0x12);
  iVar1 = 0;
  do {
    puVar11 = &c + iVar1 * 0x100;
    iVar9 = 0;
    do {
      puVar12 = &DAT_004d9d20;
      iVar10 = 0xf;
      do {
        iVar10 = iVar10 + -1;
        uVar3 = uVar8 ^ *puVar12;
        uVar8 = uVar6 ^ ((&c)[uVar3 >> 0x18] + *(int *)((int)&DAT_004d9120 + (uVar3 >> 0xe & 0x3fc))
                        ^ *(uint *)((int)&DAT_004d9520 + (uVar3 >> 6 & 0x3fc))) +
                        *(int *)(&DAT_004d9920 + (uVar3 & 0xff) * 4);
        puVar12 = puVar12 + 1;
        uVar6 = uVar3;
      } while (-1 < iVar10);
      uVar6 = uVar8 ^ DAT_004d9d60;
      uVar8 = uVar3 ^ DAT_004d9d64;
      iVar9 = iVar9 + 2;
      *puVar11 = uVar8;
      puVar11[1] = uVar6;
      puVar11 = puVar11 + 2;
    } while (iVar9 < 0x100);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 4);
  return;
}



// WARNING: Heritage AFTER dead removal. Example location: r0x004d8d1c : 0x0043839c
// WARNING: Restarted to delay deadcode elimination for space: ram

void CBlowfish(int param_1,uint param_2)

{
  int iVar1;
  undefined4 *puVar2;
  undefined1 *puVar3;
  uint uVar4;
  uint uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  uint uVar9;
  int iVar10;
  undefined *puVar11;
  int iVar12;
  uint *puVar13;
  uint *puVar14;
  
  if (0x38 < param_2) {
    param_2 = 0x38;
  }
  uVar5 = 0;
  keylen = param_2;
  if (param_2 != 0) {
    do {
      puVar11 = (undefined *)(param_1 + uVar5);
      puVar3 = &key + uVar5;
      uVar5 = uVar5 + 1;
      *puVar3 = *puVar11;
    } while (uVar5 < param_2);
  }
  iVar1 = 0;
  do {
    uVar6 = (&ks0)[iVar1];
    uVar7 = (&ks1)[iVar1];
    uVar8 = (&ks2)[iVar1];
    iVar10 = iVar1 + 1;
    *(undefined4 *)(&DAT_004d9920 + iVar1 * 4) = (&ks3)[iVar1];
    (&c)[iVar1] = uVar6;
    (&DAT_004d9120)[iVar1] = uVar7;
    (&DAT_004d9520)[iVar1] = uVar8;
    iVar1 = iVar10;
  } while (iVar10 < 0x100);
  puVar2 = &DAT_004d9d20;
  iVar1 = 0x11;
  do {
    iVar1 = iVar1 + -1;
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  } while (-1 < iVar1);
  puVar2 = &c;
  uVar5 = 0;
  iVar1 = 0;
  do {
    uVar9 = 0;
    iVar10 = 3;
    do {
      iVar10 = iVar10 + -1;
      uVar9 = uVar9 << 8 | (uint)(byte)(&key)[uVar5];
      uVar5 = uVar5 + 1 & 0xffff;
      uVar4 = keylen;
      if (0x38 < keylen) {
        uVar4 = 0x38;
      }
      if (uVar4 <= uVar5) {
        uVar5 = 0;
      }
    } while (-1 < iVar10);
    iVar1 = iVar1 + 1;
    puVar2[0x400] = puVar2[0x400] ^ uVar9;
    puVar2 = puVar2 + 1;
  } while (iVar1 < 0x12);
  puVar2 = &c;
  iVar1 = 0;
  uVar9 = 0;
  uVar5 = 0;
  do {
    puVar13 = &DAT_004d9d20;
    iVar10 = 0xf;
    do {
      iVar10 = iVar10 + -1;
      uVar4 = uVar9 ^ *puVar13;
      uVar9 = uVar5 ^ ((&c)[uVar4 >> 0x18] + *(int *)((int)&DAT_004d9120 + (uVar4 >> 0xe & 0x3fc)) ^
                      *(uint *)((int)&DAT_004d9520 + (uVar4 >> 6 & 0x3fc))) +
                      *(int *)(&DAT_004d9920 + (uVar4 & 0xff) * 4);
      puVar13 = puVar13 + 1;
      uVar5 = uVar4;
    } while (-1 < iVar10);
    uVar5 = uVar9 ^ DAT_004d9d60;
    uVar9 = uVar4 ^ DAT_004d9d64;
    iVar1 = iVar1 + 2;
    puVar2[0x400] = uVar9;
    puVar2[0x401] = uVar5;
    puVar2 = puVar2 + 2;
  } while (iVar1 < 0x12);
  iVar1 = 0;
  do {
    puVar13 = &c + iVar1 * 0x100;
    iVar10 = 0;
    do {
      puVar14 = &DAT_004d9d20;
      iVar12 = 0xf;
      do {
        iVar12 = iVar12 + -1;
        uVar4 = uVar9 ^ *puVar14;
        uVar9 = uVar5 ^ ((&c)[uVar4 >> 0x18] + *(int *)((int)&DAT_004d9120 + (uVar4 >> 0xe & 0x3fc))
                        ^ *(uint *)((int)&DAT_004d9520 + (uVar4 >> 6 & 0x3fc))) +
                        *(int *)(&DAT_004d9920 + (uVar4 & 0xff) * 4);
        puVar14 = puVar14 + 1;
        uVar5 = uVar4;
      } while (-1 < iVar12);
      uVar5 = uVar9 ^ DAT_004d9d60;
      uVar9 = uVar4 ^ DAT_004d9d64;
      iVar10 = iVar10 + 2;
      *puVar13 = uVar9;
      puVar13[1] = uVar5;
      puVar13 = puVar13 + 2;
    } while (iVar10 < 0x100);
    iVar1 = iVar1 + 1;
  } while (iVar1 < 4);
  return;
}



undefined4 Blowfish_EnCode(int param_1,uint *param_2,uint param_3)

{
  undefined *puVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  undefined *puVar5;
  int iVar6;
  uint *puVar7;
  int iVar8;
  
  uVar3 = 0;
  if (param_3 != 0) {
    do {
      puVar5 = (undefined *)(param_1 + uVar3);
      puVar1 = (undefined *)((int)param_2 + uVar3);
      uVar3 = uVar3 + 1;
      *puVar1 = *puVar5;
    } while (uVar3 < param_3);
  }
  iVar8 = 0;
  if (param_3 >> 3 != 0) {
    do {
      uVar2 = *param_2;
      puVar7 = &DAT_004d9d20;
      iVar6 = 0xf;
      uVar3 = param_2[1];
      do {
        iVar6 = iVar6 + -1;
        uVar4 = uVar2 ^ *puVar7;
        uVar2 = uVar3 ^ ((&c)[uVar4 >> 0x18] + *(int *)((int)&DAT_004d9120 + (uVar4 >> 0xe & 0x3fc))
                        ^ *(uint *)((int)&DAT_004d9520 + (uVar4 >> 6 & 0x3fc))) +
                        *(int *)(&DAT_004d9920 + (uVar4 & 0xff) * 4);
        puVar7 = puVar7 + 1;
        uVar3 = uVar4;
      } while (-1 < iVar6);
      iVar8 = iVar8 + 1;
      uVar2 = uVar2 ^ DAT_004d9d60;
      *param_2 = uVar4 ^ DAT_004d9d64;
      param_2[1] = uVar2;
      param_2 = param_2 + 2;
    } while (iVar8 < (int)(param_3 >> 3));
  }
  return 0;
}



undefined4 Blowfish_DeCode(int param_1,uint *param_2,uint param_3)

{
  undefined *puVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  undefined *puVar5;
  uint *puVar6;
  int iVar7;
  int iVar8;
  
  uVar3 = 0;
  if (param_3 != 0) {
    do {
      puVar5 = (undefined *)(param_1 + uVar3);
      puVar1 = (undefined *)((int)param_2 + uVar3);
      uVar3 = uVar3 + 1;
      *puVar1 = *puVar5;
    } while (uVar3 < param_3);
  }
  iVar8 = 0;
  if (param_3 >> 3 != 0) {
    do {
      uVar2 = *param_2;
      iVar7 = 0x11;
      puVar6 = &DAT_004d9d64;
      uVar3 = param_2[1];
      do {
        iVar7 = iVar7 + -1;
        uVar4 = uVar2 ^ *puVar6;
        uVar2 = uVar3 ^ ((&c)[uVar4 >> 0x18] + *(int *)((int)&DAT_004d9120 + (uVar4 >> 0xe & 0x3fc))
                        ^ *(uint *)((int)&DAT_004d9520 + (uVar4 >> 6 & 0x3fc))) +
                        *(int *)(&DAT_004d9920 + (uVar4 & 0xff) * 4);
        puVar6 = puVar6 + -1;
        uVar3 = uVar4;
      } while (1 < iVar7);
      iVar8 = iVar8 + 1;
      uVar2 = uVar2 ^ DAT_004d9d24;
      *param_2 = uVar4 ^ DAT_004d9d20;
      param_2[1] = uVar2;
      param_2 = param_2 + 2;
    } while (iVar8 < (int)(param_3 >> 3));
  }
  return 0;
}



void FUN_004387f8(int param_1)

{
  bool bVar1;
  void *__buf;
  ssize_t sVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  websSetTimeStamp();
  iVar4 = *(int *)(param_1 + 0x108);
  iVar6 = *(int *)(param_1 + 0x104);
  __buf = (void *)mmalloc(0x200);
  iVar5 = 1000;
  iVar3 = 0;
  if (__buf == (void *)0x0) {
    websConnError(param_1,200,"Can\'t allocate read buffer");
  }
  else {
    do {
      sVar2 = read(*(int *)(param_1 + 0x100),__buf,0x200);
      if ((sVar2 < 1) || (iVar3 = websWritePartial(param_1,__buf,sVar2), iVar3 < 0))
      goto LAB_004388f4;
      iVar4 = iVar4 + iVar3;
      if (iVar3 == 0) {
        bVar1 = iVar5 < 1;
        iVar5 = iVar5 + -1;
        if (bVar1) goto LAB_004388f4;
        usleep(5000);
      }
    } while (iVar3 == sVar2);
    lseek(*(int *)(param_1 + 0x100),iVar3 - sVar2,1);
LAB_004388f4:
    if (sVar2 == 0) {
      iVar4 = iVar6;
    }
    if (__buf != (void *)0x0) {
      free(__buf);
    }
  }
  *(int *)(param_1 + 0x108) = iVar4;
  if (((-1 < iVar3) && (iVar4 < iVar6)) && (iVar5 != 0)) {
    return;
  }
  websConnClose(param_1,200);
  return;
}



undefined4
websGetFileProcessor(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  char cVar1;
  int iVar2;
  size_t sVar3;
  int *piVar4;
  int iVar5;
  char *pcVar6;
  uint uVar7;
  stat sStack_b8;
  
  trace(1,"websGetFileProcessor=%s\n",*(undefined4 *)(param_1 + 0x88));
  uVar7 = *(uint *)(param_1 + 0xe4);
  iVar2 = websConnValidateUrl(param_1,param_4);
  if (iVar2 < 0) {
    websConnError(param_1,500,"Invalid URL");
  }
  else {
    pcVar6 = *(char **)(param_1 + 0x94);
    sVar3 = strlen(pcVar6);
    cVar1 = pcVar6[sVar3 - 1];
    if ((cVar1 == '/') || (cVar1 == '\\')) {
      pcVar6[sVar3 - 1] = '\0';
      iVar2 = open(pcVar6,0);
      *(int *)(param_1 + 0x100) = iVar2;
    }
    else {
      iVar2 = open(pcVar6,0);
      *(int *)(param_1 + 0x100) = iVar2;
    }
    if (iVar2 < 0) {
      piVar4 = __errno_location();
      pcVar6 = strerror(*piVar4);
      websConnError(param_1,0x194,"getfile: Cannot open URL(%s,%s)",*(undefined4 *)(param_1 + 0x90),
                    pcVar6);
    }
    else {
      iVar2 = stat(pcVar6,&sStack_b8);
      if (iVar2 < 0) {
        websConnError(param_1,400,"Cannot stat page for URL(%s)",pcVar6);
      }
      else if ((sStack_b8.st_uid & 0xf000) == 0x8000) {
        iVar2 = param_1 + 0x44;
        if (((uVar7 >> 4 & 1) == 0) ||
           ((websWriteNormalHeader(param_1,200,sStack_b8.st_atim.tv_sec,iVar2,&sStack_b8),
            (uVar7 >> 1 & 1) == 0 && (iVar5 = websPatchRequest(param_1,pcVar6), iVar5 < 0)))) {
          if ((uVar7 >> 3 & 1) == 0) {
            websWriteNormalHeader(param_1,200,sStack_b8.st_atim.tv_sec,iVar2,&sStack_b8);
            if ((uVar7 >> 1 & 1) == 0) {
              if (sStack_b8.st_atim.tv_sec != 0) {
                *(__time_t *)(param_1 + 0x104) = sStack_b8.st_atim.tv_sec;
              }
              if (*(char *)(param_1 + 0xe4) < '\0') {
                FUN_004387f8(param_1);
                return 1;
              }
              *(code **)(param_1 + 0x10c) = FUN_004387f8;
              websSocketCreateEvent(*(undefined4 *)(param_1 + 0xd4),4,websSocketEvent,param_1);
              return 1;
            }
          }
          else {
            websWriteActiveHeader(param_1,200,0,iVar2,&sStack_b8);
            if (((uVar7 >> 1 & 1) == 0) && (iVar2 = websParaRequest(param_1,pcVar6), iVar2 < 0)) {
              return 1;
            }
          }
        }
        websConnClose(param_1,200);
      }
      else {
        websConnError(param_1,0x194,"File Not Found");
      }
    }
  }
  return 1;
}



void FUN_00439cb0(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getRadioConfig(param_1,"SecondHTTPPortEnable",param_2,param_3);
  return;
}



void FUN_00439d98(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getRadioConfig(param_1,"UPnPEnable",param_2,param_3);
  return;
}



void FUN_00439e30(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getRadioConfig(param_1,"UPnPPortForwarding",param_2,param_3);
  return;
}



void FUN_00439ec8(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getRadioConfig(param_1,"BonjourEnable",param_2,param_3);
  return;
}



void formDefineInternet(void)

{
  websParaDefine("Protocol",&LAB_00438d1c);
  websParaDefine("JavaCodeBase",&LAB_00438d64);
  websParaDefine("RemoteHostIPAddress",&LAB_00438fbc);
  websParaDefine("RemoteHostPort",&LAB_00439238);
  websParaDefine("EthernetLink",&LAB_00439394);
  websParaDefine("EthernetSpeed",&LAB_0043941c);
  websParaDefine("EthernetDuplex",&LAB_004394a4);
  websParaDefine("CurrentIPAddress",&LAB_0043952c);
  websParaDefine("CurrentIPAddressPort",&LAB_00439648);
  websParaDefine("CurrentSubnetMask",&LAB_004397fc);
  websParaDefine("CurrentDefaultGateway",&LAB_00439918);
  websParaDefine("CurrentDNSAddress1",&LAB_00439934);
  websParaDefine("CurrentDNSAddress2",&LAB_00439950);
  websParaDefine("GotIPFromUpnp",&LAB_0043996c);
  websParaDefine("IPAddressMode",&LAB_00439988);
  websParaDefine("RadioOfIPAddressMode",&LAB_004399b0);
  websParaDefine("IPAddress",&LAB_004399d8);
  websParaDefine("SubnetMask",&LAB_00439a00);
  websParaDefine("DefaultGateway",&LAB_00439a28);
  websParaDefine("PPPoEUserID",&LAB_00439a50);
  websParaDefine("PPPoEPassword",&LAB_00439a78);
  websParaDefine("DNSIPAddress1",&LAB_00439bec);
  websParaDefine("DNSIPAddress2",&LAB_00439c14);
  websParaDefine("SecondHTTPPortEnable",&LAB_00439c3c);
  websParaDefine("StringOfSecondHTTPPortEnable",&LAB_00439c64);
  websParaDefine("RadioOfSecondHTTPPortEnable",FUN_00439cb0);
  websParaDefine("SecondHTTPPort",&LAB_00439cd8);
  websParaDefine("HTTPAuthentication",&LAB_00439d00);
  websParaDefine("UPnPEnable",&LAB_00439d28);
  websParaDefine("StringOfUPnPEnable",&LAB_00439d50);
  websParaDefine("RadioOfUPnPEnable",FUN_00439d98);
  websParaDefine("UPnPPortForwarding",&LAB_00439dc0);
  websParaDefine("StringOfUPnPPortForwarding",&LAB_00439de8);
  websParaDefine("RadioOfUPnPPortForwarding",FUN_00439e30);
  websParaDefine("BonjourEnable",&LAB_00439e58);
  websParaDefine("StringOfBonjourEnable",&LAB_00439e80);
  websParaDefine("RadioOfBonjourEnable",FUN_00439ec8);
                    // WARNING: Treating indirect jump as call
  websParaDefine("BonjourName",&UNK_00439ef0);
  return;
}



void FUN_0043a47c(undefined4 param_1,undefined4 param_2,char **param_3)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  
  pcVar3 = *param_3;
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  getSysInfoBuffer(0x45,&local_20,1);
  trace(1,"COUNTRY_REGION=%d\n",(int)(char)local_20);
  cVar1 = (char)local_20 + '0';
  local_20 = CONCAT31(local_20._1_3_,cVar1);
  if (cVar1 != '\0') {
    iVar2 = strcmp((char *)&local_20,pcVar3);
    pcVar3 = "checked";
    if (iVar2 == 0) goto LAB_0043a54c;
  }
  pcVar3 = "";
LAB_0043a54c:
  websWriteFmt(param_1,"%s",pcVar3);
  return;
}



void FUN_0043a56c(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  char acStack_18 [16];
  
  iVar1 = getSysInfoShort(0x17);
  strcpy(acStack_18,*(char **)(noyes_select + iVar1 * 4));
  uVar2 = strlower(acStack_18);
  websWriteFmt(param_1,"%s",uVar2);
  return;
}



void FUN_0043a600(undefined4 param_1)

{
  uint uVar1;
  
  uVar1 = getSysInfoShort(0x23);
  if ((uVar1 & 0xffff) < 2) {
                    // WARNING: Treating indirect jump as call
    websWriteFmt(param_1,"%s",*(undefined4 *)(noyes_select + uVar1 * 4));
    return;
  }
                    // WARNING: Treating indirect jump as call
  websWriteFmt(param_1,&DAT_0049445c);
  return;
}



void FUN_0043a738(undefined4 param_1)

{
                    // WARNING: Treating indirect jump as call
  websgetSysInfoShort(param_1,0x26);
  return;
}



void FUN_0043b5fc(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getStringConfig(param_1,"TransmissionRate",param_2,param_3);
  return;
}



void FUN_0043b66c(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  getStringOfMatchValue(param_1,"TransmissionRate",txrate_select,txrate_value,param_2,param_3,&_gp);
  return;
}



void FUN_0043b6b8(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getIntConfig(param_1,"ConnectionMode",param_2,param_3);
  return;
}



void FUN_0043b750(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getIntConfig(param_1,"WEPEncryption",param_2,param_3);
  return;
}



void FUN_0043b7c0(undefined4 param_1,int param_2,char **param_3)

{
  char *__s1;
  int iVar1;
  char *__s1_00;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  
  __s1 = (char *)nvram_bufget(0,"WEPEncryption");
  local_30 = 0;
  local_2c = 0;
  local_28 = 0;
  local_24 = 0;
  __s1_00 = *param_3;
  if (1 < param_2) {
    iVar1 = strcmp(__s1_00,"2");
    if (iVar1 == 0) {
      iVar1 = websTestVar(param_1,"WEPEncryption");
      if (iVar1 == 0) {
        __s1_00 = param_3[1];
      }
      else {
        __s1 = (char *)websGetVar(param_1,"WEPEncryption",&DAT_0049445c);
        __s1_00 = param_3[1];
      }
    }
  }
  if ((__s1 != (char *)0x0) && (*__s1 != '\0')) {
    iVar1 = strcmp(__s1,"3");
    if (iVar1 == 0) {
      local_30 = CONCAT22(local_30._2_2_,0x32);
    }
    else {
      strcpy((char *)&local_30,__s1);
    }
  }
  if ((char)local_30 != '\0') {
    iVar1 = strcmp((char *)&local_30,__s1_00);
    if (iVar1 == 0) {
      websWriteFmt(param_1,"%s","checked");
      return;
    }
  }
  websWriteFmt(param_1,"%s",&DAT_0049445c);
  return;
}



undefined4 FUN_0043bc84(int param_1,int param_2,char **param_3)

{
  int iVar1;
  void *pvVar2;
  undefined4 uVar3;
  char *__s1;
  undefined auStack_110 [256];
  
  if (0 < param_2) {
    __s1 = *param_3;
    iVar1 = strcmp(__s1,"4");
    if (iVar1 == 0) {
      uVar3 = nvram_bufget(0,&DAT_0048d888);
      pvVar2 = (void *)AllocPrintableString(uVar3);
      memset(auStack_110,0,0xff);
      if (pvVar2 != (void *)0x0) {
        websEncode64(auStack_110,pvVar2,0xff);
        free(pvVar2);
      }
      uVar3 = websWriteFmt(param_1,"%s",auStack_110);
      return uVar3;
    }
    iVar1 = strcmp(__s1,"5");
    if (iVar1 == 0) goto LAB_0043bcf4;
  }
  if ((*(uint *)(param_1 + 0xe4) >> 0x16 & 1) == 0) {
    uVar3 = websWritePasswordByName(param_1,&DAT_0048d888);
    return uVar3;
  }
LAB_0043bcf4:
  pvVar2 = (void *)allocEncodePasswordByName(param_1,&DAT_0048d888);
  uVar3 = websWriteFmt(param_1,"%s",pvVar2);
  if (pvVar2 != (void *)0x0) {
    free(pvVar2);
  }
  return uVar3;
}



void formDefineWireless(void)

{
  websParaDefine("WirelessCountry",&LAB_0043a3ec);
  websParaDefine("RadioOfWirelessCountry",FUN_0043a47c);
  websParaDefine("WirelessSupport",FUN_0043a56c);
  websParaDefine("WirelessLink",FUN_0043a600);
  websParaDefine("WirelessCurrentSSID",&LAB_0043a688);
  websParaDefine("WirelessCurrentAPMACAddress",&LAB_0043a6d0);
  websParaDefine("WirelessCurrentChannel",FUN_0043a738);
  websParaDefine("WirelessCurrentTransmissionRate",&LAB_0043a754);
  websParaDefine("WirelessCurrentEncryption",&LAB_0043a770);
  websParaDefine("FoundSSIDList",&LAB_0043a8c8);
  websParaDefine("SiteSurveyList",&LAB_0043b0c0);
  websParaDefine("WirelessDisable",&LAB_0043b4d4);
  websParaDefine("RadioOfWirelessDisable",&LAB_0043b4fc);
  websParaDefine(&DAT_0048d85c,&LAB_0043b524);
  websParaDefine("WirelessChannel",&LAB_0043b58c);
  websParaDefine("SelectOfWirelessChannel",&LAB_0043b5b4);
  websParaDefine("TransmissionRate",FUN_0043b5fc);
  websParaDefine("SelectOfTransmissionRate",&LAB_0043b624);
  websParaDefine("StringOfTransmissionRate",FUN_0043b66c);
  websParaDefine("ConnectionMode",FUN_0043b6b8);
  websParaDefine("RadioOfConnectionMode",&LAB_0043b6e0);
  websParaDefine("StringOfConnectionMode",&LAB_0043b708);
  websParaDefine("WEPEncryption",FUN_0043b750);
  websParaDefine("StringOfEncryption",&LAB_0043b778);
  websParaDefine("RadioOfWEPEncryWay",FUN_0043b7c0);
  websParaDefine("WEPKeyLen",&LAB_0043b9b0);
  websParaDefine("WEPKeyFormat",&LAB_0043bb98);
  websParaDefine("AuthenticationType",&LAB_0043bbc0);
  websParaDefine("RadioOfAuthenticationType",&LAB_0043bbe8);
  websParaDefine("TxKey",&LAB_0043bc10);
  websParaDefine("StringOfTxKey",&LAB_0043bc38);
  websParaDefine(&DAT_0048d888,FUN_0043bc84);
  websParaDefine(&DAT_0048d890,&LAB_0043be54);
  websParaDefine(&DAT_0048d898,&LAB_0043c024);
  websParaDefine(&DAT_0048d8a0,&LAB_0043c1f4);
  websParaDefine("PreSharedKey",&LAB_0043c3c4);
  websParaDefine("BeaconInterval",&LAB_0043c594);
  websParaDefine("Preamble",&LAB_0043c5bc);
                    // WARNING: Treating indirect jump as call
  websParaDefine("RadioOfPreamble",&UNK_0043c5e4);
  return;
}



void FUN_0043cc58(undefined4 param_1)

{
                    // WARNING: Treating indirect jump as call
  getStringVar(param_1,"EntryNo","0");
  return;
}



int FUN_0043cd7c(undefined4 param_1)

{
  int *piVar1;
  undefined *puVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int *piVar8;
  int iVar9;
  char local_58 [64];
  
  memset(local_58,0,0x40);
  getSysInfoBuffer(0x4f,local_58,1);
  iVar9 = (int)local_58[0];
  iVar7 = 0;
  piVar8 = &webMultiLanguageList;
  puVar2 = PTR_s_English_004d56a8;
  while (puVar2 != (undefined *)0x0) {
    iVar6 = *piVar8;
    if (iVar6 == iVar9) goto LAB_0043ce1c;
    puVar2 = (undefined *)piVar8[3];
    piVar8 = piVar8 + 2;
  }
  iVar6 = *piVar8;
LAB_0043ce1c:
  if (iVar6 == -1) {
    iVar9 = 0;
  }
  piVar8 = &webMultiLanguageList;
  puVar2 = PTR_s_English_004d56a8;
  do {
    if (puVar2 == (undefined *)0x0) {
      return iVar7;
    }
    while( true ) {
      iVar6 = *piVar8;
      if (iVar6 != iVar9) break;
      uVar3 = stritoa(iVar6,local_58,0x40);
      iVar6 = websWriteFmt(param_1,WebOptionValueCheck,uVar3);
      iVar4 = websWriteFmt(param_1,"%s",piVar8[1]);
      iVar5 = websWriteFmt(param_1,"%s",WebOptionEnd);
      piVar1 = piVar8 + 3;
      iVar7 = iVar7 + iVar6 + iVar4 + iVar5;
      piVar8 = piVar8 + 2;
      if (*piVar1 == 0) {
        return iVar7;
      }
    }
    uVar3 = stritoa(iVar6,local_58,0x40);
    iVar6 = websWriteFmt(param_1,WebOptionValueStart,uVar3);
    iVar4 = websWriteFmt(param_1,"%s",piVar8[1]);
    iVar5 = websWriteFmt(param_1,"%s",WebOptionEnd);
    puVar2 = (undefined *)piVar8[3];
    iVar7 = iVar7 + iVar6 + iVar4 + iVar5;
    piVar8 = piVar8 + 2;
  } while( true );
}



void FUN_0043e074(undefined4 param_1,int param_2,char **param_3)

{
  undefined2 uVar1;
  int iVar2;
  char *__s1;
  
  if (0 < param_2) {
    __s1 = *param_3;
    iVar2 = strcmp(__s1,"2");
    if (iVar2 == 0) {
      uVar1 = getSysInfoLong(0x3d);
                    // WARNING: Treating indirect jump as call
      websWriteFmt(param_1,&DAT_0048bb04,uVar1);
      return;
    }
    iVar2 = strcmp(__s1,"3");
    if (iVar2 == 0) {
      uVar1 = getSysInfoLong(0x3d);
                    // WARNING: Treating indirect jump as call
      websWriteFmt(param_1,&UNK_0048f8dc,uVar1);
      return;
    }
  }
                    // WARNING: Treating indirect jump as call
  websgetSysInfoString(param_1,3);
  return;
}



void FUN_0043e48c(undefined4 param_1)

{
  undefined4 uVar1;
  undefined4 local_20;
  uint local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  
  uVar1 = getSysInfoLong(8);
  local_10._3_1_ = (char)((uint)uVar1 >> 0x18);
  local_10._2_1_ = (char)((uint)uVar1 >> 0x10);
  local_10._1_1_ = (char)((uint)uVar1 >> 8);
  local_20 = CONCAT22(CONCAT11(local_10._1_1_ + '0',local_10._2_1_ + '0'),
                      CONCAT11(0x2e,local_10._3_1_ + '0'));
  local_1c = (uint)(byte)((char)uVar1 + 0x30);
  local_18 = 0;
  local_14 = 0;
  local_10 = uVar1;
  websWriteFmt(param_1,"%s",&local_20);
  return;
}



void FUN_0043e534(undefined4 param_1)

{
                    // WARNING: Treating indirect jump as call
  websgetSysInfoString(param_1,2);
  return;
}



void FUN_0043e628(undefined4 param_1)

{
  FILE *__stream;
  char *pcVar1;
  int iVar2;
  char *pcVar3;
  char acStack_418 [1024];
  
  __stream = fopen("/mydlink/version","r");
  pcVar3 = (char *)0x0;
  if (__stream == (FILE *)0x0) {
LAB_0043e764:
    websWriteFmt(param_1,"%s",&DAT_0049445c);
    return;
  }
LAB_0043e688:
  pcVar1 = fgets(acStack_418,0x400,__stream);
  do {
    if (pcVar1 == (char *)0x0) {
LAB_0043e710:
      fclose(__stream);
      if (pcVar3 != (char *)0x0) {
        websWriteFmt(param_1,"%s",pcVar3);
        return;
      }
      goto LAB_0043e764;
    }
    pcVar3 = strchr(acStack_418,0x3d);
    if (pcVar3 == (char *)0x0) goto LAB_0043e688;
    *pcVar3 = '\0';
    pcVar3 = pcVar3 + 1;
    iVar2 = strcmp(acStack_418,"VERSION");
    if (iVar2 == 0) goto LAB_0043e710;
    pcVar1 = fgets(acStack_418,0x400,__stream);
    pcVar3 = (char *)0x0;
  } while( true );
}



void FUN_0043e7a4(undefined4 param_1)

{
  uint __seed;
  int iVar1;
  undefined auStack_18 [16];
  
  __seed = time((time_t *)0x0);
  srand(__seed);
  iVar1 = rand();
  stritoa(iVar1,auStack_18,0x10);
  websWriteFmt(param_1,"%s",auStack_18);
  return;
}



void FUN_0043e848(undefined4 param_1)

{
                    // WARNING: Treating indirect jump as call
  websWriteFmt(param_1,"%s","2.1.8");
  return;
}



void formDefineDevice(void)

{
  websParaDefine("WebDebugLevel",&LAB_0043cb00);
  websParaDefine("Message",&LAB_0043cb28);
  websParaDefine("EntryNo",FUN_0043cc58);
  websParaDefine("WebLanguage",&LAB_0043cc7c);
  websParaDefine("SelectOfWebLanguage",FUN_0043cd7c);
  websParaDefine("RebootTime",&LAB_0043cf60);
  websParaDefine("ForceBootCodeUpgrade",&LAB_0043cfc4);
  websParaDefine("DownloadTime",&LAB_0043cfe8);
  websParaDefine("LastDownloadStatus",&LAB_0043d04c);
  websParaDefine("DownloadStatus",&LAB_0043d0f0);
  websParaDefine("Authroized",&LAB_0043d244);
  websParaDefine("AdminLogin",&LAB_0043d3ec);
  websParaDefine("UserName",&LAB_0043d5a4);
  websParaDefine("UserPassword",&LAB_0043d658);
  websParaDefine("ActiveUserTable",&LAB_0043d8c4);
  websParaDefine("ModName",&LAB_0043de38);
  websParaDefine("ModPassword",&LAB_0043de5c);
  websParaDefine("ModGroup",&LAB_0043deb4);
  websParaDefine("TimeStamp",&LAB_0043ded8);
  websParaDefine("SessionKey",&LAB_0043def8);
  websParaDefine("ModelName",&LAB_0043df18);
  websParaDefine("ModelDescription",&LAB_0043df34);
  websParaDefine("ReleaseDate",&LAB_0043df50);
  websParaDefine("ReleaseTime",&LAB_0043df6c);
  websParaDefine("FirmwareVersion",FUN_0043e074);
  websParaDefine("BootCodeVersion",&LAB_0043e17c);
  websParaDefine("HardwareVersion",&LAB_0043e37c);
  websParaDefine("ROMVersion",FUN_0043e48c);
  websParaDefine("Company",FUN_0043e534);
  websParaDefine("CompanyURL",&LAB_0043e550);
  websParaDefine("MACAddress",&LAB_0043e56c);
  websParaDefine("MyDlinkAgentVersion",FUN_0043e628);
  websParaDefine("ReGetIndex",FUN_0043e7a4);
  websParaDefine("CGIVersion",FUN_0043e848);
  websParaDefine("NipcaVersion",&LAB_0043e86c);
  websParaDefine("CameraName",&LAB_0043e890);
  websParaDefine("Location",&LAB_0043e8b8);
  websParaDefine("AdminID",&LAB_0043e8e0);
  websParaDefine("AdminPassword",&LAB_0043e908);
  websParaDefine("LEDControl",&LAB_0043eb00);
  websParaDefine("RadioOfLEDControl",&LAB_0043eb28);
  websParaDefine("SnapshotURLAuthentication",&LAB_0043eb50);
  websParaDefine("RadioOfSnapshotURLAuthentication",&LAB_0043eb78);
  websParaDefine("AccessControlEnable",&LAB_0043eba0);
  websParaDefine("RadioOfAccessControlEnable",&LAB_0043ebc8);
  websParaDefine("UserTable",&LAB_0043ebf0);
  websParaDefine("UserID",&LAB_0043f310);
  websParaDefine("DateTimeMode",&LAB_0043f444);
  websParaDefine("RadioOfDateTimeMode",&LAB_0043f46c);
  websParaDefine("TimeServerIPAddress",&LAB_0043f494);
  websParaDefine("TimeServerProtocol",&LAB_0043f4bc);
  websParaDefine("RadioOfTimeServerProtocol",&LAB_0043f4e4);
  websParaDefine("TimeZone",&LAB_0043f50c);
  websParaDefine("TimeZoneIndex",&LAB_0043f664);
  websParaDefine("CurrentTime",&LAB_0043f8a0);
  websParaDefine("Date",&LAB_0043f8c0);
  websParaDefine("Time",&LAB_0043f8e8);
  websParaDefine("YearOfTime",&LAB_0043f910);
  websParaDefine("MonthOfTime",&LAB_0043f930);
  websParaDefine("DateOfTime",&LAB_0043f950);
  websParaDefine("HourOfTime",&LAB_0043f970);
  websParaDefine("MinuteOfTime",&LAB_0043f990);
  websParaDefine("SecondOfTime",&LAB_0043f9b0);
  websParaDefine("DSTEnable",&LAB_0043f9d0);
  websParaDefine("RadioOfDSTEnable",&LAB_0043f9f8);
  websParaDefine("DSTOffset",&LAB_0043fa20);
  websParaDefine("DSTStartMonth",&LAB_0043fa48);
  websParaDefine("DSTStartWeek",&LAB_0043fa70);
  websParaDefine("DSTStartDay",&LAB_0043fa98);
  websParaDefine("DSTStartTime",&LAB_0043fac0);
  websParaDefine("DSTEndMonth",&LAB_0043fae8);
  websParaDefine("DSTEndWeek",&LAB_0043fb10);
  websParaDefine("DSTEndDay",&LAB_0043fb38);
  websParaDefine("DSTEndTime",&LAB_0043fb60);
                    // WARNING: Treating indirect jump as call
  websParaDefine("DCSAuthentication",&UNK_0043fb88);
  return;
}



void FUN_004408d4(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getPrintableStringConfig(param_1,"DDNSHostName",param_2,param_3);
  return;
}



void FUN_00440f78(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getPrintableStringConfig(param_1,"FTPHostAddress",param_2,param_3);
  return;
}



void FUN_004413e0(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getIntConfig(param_1,"FTPScheduleSecondPerFrame",param_2,param_3);
  return;
}



void formDefineNetworkAPI(void)

{
  websParaDefine("ResultOfFTPServerTest",&LAB_00440520);
  websParaDefine("ResultOfEmailTest",&LAB_00440594);
  websParaDefine("StatusOfUPnPPortForwarding",&LAB_00440608);
  websParaDefine("StatusOfDynamicDNS",&LAB_004406d0);
  websParaDefine("DDNSEnable",&LAB_00440814);
  websParaDefine("RadioOfDDNSEnable",&LAB_0044083c);
  websParaDefine("DDNSProvider",&LAB_00440864);
  websParaDefine("LogoSelectDDNSProvider",&LAB_0044088c);
  websParaDefine("DDNSHostName",FUN_004408d4);
  websParaDefine("DDNSUserName",&LAB_004408fc);
  websParaDefine("DDNSPassword",&LAB_00440924);
  websParaDefine("DDNSTimeout",&LAB_00440a98);
  websParaDefine("EmailSMTPServerAddress",&LAB_00440ac0);
  websParaDefine("EmailSMTPPortNumber",&LAB_00440ae8);
  websParaDefine("EmailSenderAddress",&LAB_00440b10);
  websParaDefine("EmailReceiverAddress",&LAB_00440b38);
  websParaDefine("EmailUserName",&LAB_00440b60);
  websParaDefine("EmailPassword",&LAB_00440b88);
  websParaDefine("EmailTLSAuthentication",&LAB_00440cfc);
  websParaDefine("RadioOfEmailTLSAuthentication",&LAB_00440d24);
  websParaDefine("EmailScheduleEnable",&LAB_00440d4c);
  websParaDefine("CheckOfEmailScheduleEnable",&LAB_00440d74);
  websParaDefine("EmailScheduleDay",&LAB_00440d9c);
  websParaDefine("CheckOfEmailScheduleDay",&LAB_00440dc4);
  websParaDefine("EmailScheduleMode",&LAB_00440dec);
  websParaDefine("RadioOfEmailScheduleMode",&LAB_00440e14);
  websParaDefine("EmailScheduleTimeStart",&LAB_00440e3c);
  websParaDefine("EmailScheduleTimeStop",&LAB_00440e64);
  websParaDefine("EmailScheduleInterval",&LAB_00440e8c);
  websParaDefine("EmailMotionMode",&LAB_00440eb4);
  websParaDefine("RadioOfEmailMotionMode",&LAB_00440edc);
  websParaDefine("EmailMotionFrameInterval",&LAB_00440f04);
  websParaDefine("SelectOfEmailMotionFrameInterval",&LAB_00440f2c);
  websParaDefine("FTPHostAddress",FUN_00440f78);
  websParaDefine("FTPPortNumber",&LAB_00440fa0);
  websParaDefine("FTPUserName",&LAB_00440fc8);
  websParaDefine("FTPPassword",&LAB_00440ff0);
  websParaDefine("FTPDirectoryPath",&LAB_00441164);
  websParaDefine("FTPPassiveMode",&LAB_0044118c);
  websParaDefine("RadioOfFTPPassiveMode",&LAB_004411b4);
  websParaDefine("FTPScheduleEnable",&LAB_004411dc);
  websParaDefine("CheckOfFTPScheduleEnable",&LAB_00441204);
  websParaDefine("FTPScheduleDay",&LAB_0044122c);
  websParaDefine("CheckOfFTPScheduleDay",&LAB_00441254);
  websParaDefine("FTPScheduleMode",&LAB_0044127c);
  websParaDefine("RadioOfFTPScheduleMode",&LAB_004412a4);
  websParaDefine("FTPScheduleTimeStart",&LAB_004412cc);
  websParaDefine("FTPScheduleTimeStop",&LAB_004412f4);
  websParaDefine("FTPScheduleVideoFrequencyMode",&LAB_0044131c);
  websParaDefine("RadioOfFTPScheduleVideoFrequencyMode",&LAB_00441344);
  websParaDefine("FTPScheduleFramePerSecond",&LAB_0044136c);
  websParaDefine("SelectOfFTPScheduleFramePerSecond",&LAB_00441394);
  websParaDefine("FTPScheduleSecondPerFrame",FUN_004413e0);
  websParaDefine("FTPScheduleBaseFileName",&LAB_00441408);
  websParaDefine("FTPScheduleFileMode",&LAB_00441430);
  websParaDefine("RadioOfFTPScheduleFileMode",&LAB_00441458);
  websParaDefine("FTPScheduleMaxFileSequenceNumber",&LAB_00441480);
                    // WARNING: Treating indirect jump as call
  websParaDefine("FTPCreateFolderInterval",&UNK_004414a8);
  return;
}



void FUN_004423d4(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getIntConfig(param_1,"CompressionRate",param_2,param_3);
  return;
}



void FUN_0044246c(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getIntConfig(param_1,"FrameRate",param_2,param_3);
  return;
}



void FUN_00442508(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getIntConfig(param_1,"LightFrequency",param_2,param_3);
  return;
}



void FUN_004425a0(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getIntConfig(param_1,"BrightnessControl",param_2,param_3);
  return;
}



void FUN_00442728(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
                    // WARNING: Treating indirect jump as call
  getIntConfig(param_1,"AudioVolume",param_2,param_3);
  return;
}



void formDefineMedia(void)

{
  websParaDefine("CMSDProject",&LAB_00441c24);
  websParaDefine("CMXJProject",&LAB_00441c44);
  websParaDefine("PTZSupport",&LAB_00441c64);
  websParaDefine("FrameSize",&LAB_00441cc4);
  websParaDefine("CurrentVideoWidth",&LAB_00441ce0);
  websParaDefine("CurrentVideoHeight",&LAB_00441e00);
  websParaDefine("CurrentVideoLimitWidth",&LAB_00441f74);
  websParaDefine("CurrentVideoLimitHeight",&LAB_004420dc);
  websParaDefine("CheckFrameRate",&LAB_00442270);
  websParaDefine("FPSEnable",&LAB_00442294);
  websParaDefine("Profile",&LAB_004422bc);
  websParaDefine("ViewMode",&LAB_00442314);
  websParaDefine("VideoResolution",&LAB_0044233c);
  websParaDefine("RadioOfVideoResolution",&LAB_00442364);
  websParaDefine("StringOfVideoResolution",&LAB_0044238c);
  websParaDefine("CompressionRate",FUN_004423d4);
  websParaDefine("RadioOfCompressionRate",&LAB_004423fc);
  websParaDefine("StringOfCompressionRate",&LAB_00442424);
  websParaDefine("FrameRate",FUN_0044246c);
  websParaDefine("RadioOfFrameRate",&LAB_00442494);
  websParaDefine("StringOfFrameRate",&LAB_004424bc);
  websParaDefine("LightFrequency",FUN_00442508);
  websParaDefine("RadioOfLightFrequency",&LAB_00442530);
  websParaDefine("StringOfLightFrequency",&LAB_00442558);
  websParaDefine("BrightnessControl",FUN_004425a0);
  websParaDefine("ContrastControl",&LAB_004425c8);
  websParaDefine("SaturationControl",&LAB_004425f0);
  websParaDefine("SharpnessControl",&LAB_00442618);
  websParaDefine("AntiFlickerEnable",&LAB_00442640);
  websParaDefine("Mirror",&LAB_00442668);
  websParaDefine("AudioEnable",&LAB_00442690);
  websParaDefine("RadioOfAudioEnable",&LAB_004426b8);
  websParaDefine("StringOfAudioEnable",&LAB_004426e0);
  websParaDefine("AudioVolume",FUN_00442728);
  websParaDefine("AudioCodec",&LAB_00442750);
  websParaDefine("AudioSampleRate",&LAB_00442774);
  websParaDefine("MotionDetectionEnable",&LAB_00442798);
  websParaDefine("RadioOfMotionDetectionEnable",&LAB_004427c0);
  websParaDefine("MotionDetectionBlockSet",&LAB_004427e8);
  websParaDefine("MotionDetectionSensitivity",&LAB_004428fc);
  websParaDefine("MotionDetectionScheduleDay",&LAB_00442924);
  websParaDefine("CheckOfMotionDetectionScheduleDay",&LAB_0044294c);
  websParaDefine("MotionDetectionScheduleMode",&LAB_00442974);
  websParaDefine("RadioOfMotionDetectionScheduleMode",&LAB_0044299c);
  websParaDefine("MotionDetectionScheduleTimeStart",&LAB_004429c4);
  websParaDefine("MotionDetectionScheduleTimeStop",&LAB_004429ec);
  websParaDefine("DayNightMode",&LAB_00442a14);
  websParaDefine("RadioOfDayNightMode",&LAB_00442a3c);
  websParaDefine("LightSensorControl",&LAB_00442a64);
  websParaDefine("IRLedScheduleSunStart",&LAB_00442a8c);
  websParaDefine("IRLedScheduleSunEnd",&LAB_00442ab4);
  websParaDefine("IRLedScheduleMonStart",&LAB_00442adc);
  websParaDefine("IRLedScheduleMonEnd",&LAB_00442b04);
  websParaDefine("IRLedScheduleTueStart",&LAB_00442b2c);
  websParaDefine("IRLedScheduleTueEnd",&LAB_00442b54);
  websParaDefine("IRLedScheduleWedStart",&LAB_00442b7c);
  websParaDefine("IRLedScheduleWedEnd",&LAB_00442ba4);
  websParaDefine("IRLedScheduleThuStart",&LAB_00442bcc);
  websParaDefine("IRLedScheduleThuEnd",&LAB_00442bf4);
  websParaDefine("IRLedScheduleFriStart",&LAB_00442c1c);
  websParaDefine("IRLedScheduleFriEnd",&LAB_00442c44);
  websParaDefine("IRLedScheduleSatStart",&LAB_00442c6c);
  websParaDefine("IRLedScheduleSatEnd",&LAB_00442c94);
  websParaDefine("SoundDetectionEnable",&LAB_00442cbc);
  websParaDefine("RadioOfSoundDetectionEnable",&LAB_00442ce4);
  websParaDefine("SoundDetectionDB",&LAB_00442d0c);
  websParaDefine("SoundDetectionScheduleDay",&LAB_00442d34);
  websParaDefine("CheckOfSoundDetectionScheduleDay",&LAB_00442d5c);
  websParaDefine("SoundDetectionScheduleMode",&LAB_00442d84);
  websParaDefine("RadioOfSoundDetectionScheduleMode",&LAB_00442dac);
  websParaDefine("SoundDetectionScheduleTimeStart",&LAB_00442dd4);
  websParaDefine("SoundDetectionScheduleTimeStop",&LAB_00442dfc);
                    // WARNING: Treating indirect jump as call
  websParaDefine("ThermalSupport",&UNK_00442e24);
  return;
}



undefined4 websGetAntiTblCount(char *param_1)

{
  int iVar1;
  int iVar2;
  char *__s2;
  char **ppcVar3;
  int iVar4;
  
  iVar1 = DAT_004d72f4;
  if ((param_1 != (char *)0x0) && (iVar4 = 0, ppcVar3 = DAT_004d9d6c, -1 < DAT_004d72f4)) {
    do {
      __s2 = *ppcVar3;
      iVar4 = iVar4 + 1;
      if ((__s2 != (char *)0x0) && (iVar2 = strcmp(param_1,__s2), iVar2 == 0)) {
        return *(undefined4 *)(__s2 + 0x20);
      }
      ppcVar3 = ppcVar3 + 1;
    } while (iVar4 <= iVar1);
  }
  return 0;
}



void websAntiTblUnsched(char *param_1)

{
  int iVar1;
  char *__s2;
  int iVar2;
  
  if ((param_1 != (char *)0x0) && (iVar2 = 0, -1 < DAT_004d72f4)) {
    do {
      __s2 = *(char **)(iVar2 * 4 + DAT_004d9d6c);
      if ((__s2 != (char *)0x0) && (iVar1 = strcmp(param_1,__s2), iVar1 == 0)) {
        DAT_004d72f4 = FreeEntryId(&DAT_004d9d6c,iVar2);
        free(__s2);
        return;
      }
      iVar2 = iVar2 + 1;
    } while (iVar2 <= DAT_004d72f4);
  }
  return;
}



undefined4 websAntiBruteProcessor(int param_1)

{
  in_addr_t *piVar1;
  bool bVar2;
  void *__ptr;
  undefined4 uVar3;
  int *piVar4;
  char *pcVar5;
  int iVar6;
  __pid_t _Var7;
  size_t sVar8;
  time_t tVar9;
  int iVar10;
  char **ppcVar11;
  int iVar12;
  char *__s1;
  
  __ptr = (void *)mmalloc(0xa00);
  trace(1,"websAntiBruteProcessor=%s,%s\n",*(undefined4 *)(param_1 + 0x88),
        *(undefined4 *)(param_1 + 0x148));
  bVar2 = false;
  if (*(void **)(param_1 + 0x88) != (void *)0x0) {
    free(*(void **)(param_1 + 0x88));
  }
  uVar3 = *(undefined4 *)(param_1 + 0x148);
  __s1 = (char *)(param_1 + 4);
  *(undefined4 *)(param_1 + 0x148) = 0;
  *(undefined4 *)(param_1 + 0x88) = uVar3;
  if (__ptr != (void *)0x0) {
    piVar4 = (int *)getSysInfoBuffer(0x2f,__ptr,0xa00);
    iVar12 = 0;
    do {
      iVar10 = *piVar4;
      piVar1 = (in_addr_t *)(piVar4 + 2);
      iVar12 = iVar12 + 1;
      piVar4 = piVar4 + 10;
      if (iVar10 != 0) {
        pcVar5 = inet_ntoa((in_addr)*piVar1);
        iVar10 = strcmp(__s1,pcVar5);
        if (iVar10 == 0) {
          bVar2 = true;
          break;
        }
      }
    } while (iVar12 < 0x40);
    if (__ptr != (void *)0x0) {
      free(__ptr);
    }
  }
  iVar12 = DAT_004d72f4;
  if ((__s1 != (char *)0x0) && (iVar10 = 0, ppcVar11 = DAT_004d9d6c, -1 < DAT_004d72f4)) {
    do {
      pcVar5 = *ppcVar11;
      iVar10 = iVar10 + 1;
      if ((pcVar5 != (char *)0x0) && (iVar6 = strcmp(__s1,pcVar5), iVar6 == 0)) break;
      ppcVar11 = ppcVar11 + 1;
    } while (iVar10 <= iVar12);
    if (pcVar5 != (char *)0x0) {
      iVar12 = 1;
      if (!bVar2) {
        iVar12 = *(int *)(pcVar5 + 0x20) + 1;
      }
      *(int *)(pcVar5 + 0x20) = iVar12;
      goto LAB_00443b28;
    }
  }
  iVar12 = AllocEntry(&DAT_004d9d6c,&DAT_004d72f4,0x2c);
  if (-1 < iVar12) {
    pcVar5 = DAT_004d9d6c[iVar12];
    sVar8 = strlen(__s1);
    sVar8 = sVar8 + 1;
    if (0x20 < sVar8) {
      sVar8 = 0x20;
    }
    memcpy(pcVar5,__s1,sVar8);
    *(undefined4 *)(pcVar5 + 0x20) = 1;
    tVar9 = time((time_t *)0x0);
    *(time_t *)(pcVar5 + 0x24) = tVar9;
    tVar9 = time((time_t *)0x0);
    *(time_t *)(pcVar5 + 0x28) = tVar9 + 600;
    if (pcVar5 != (char *)0x0) {
      iVar12 = *(int *)(pcVar5 + 0x20);
      goto LAB_00443b28;
    }
  }
  iVar12 = 0x14;
LAB_00443b28:
  _Var7 = fork();
  if (_Var7 != 0) {
    if (_Var7 == -1) {
      doSystem("sleep %d",iVar12);
      websConnError(param_1,0x191,"Authentication was requested");
    }
    else {
      iVar12 = AllocEntry(&DAT_004d9d68,&DAT_004d72f0,8);
      if (-1 < iVar12) {
        piVar4 = *(int **)(iVar12 * 4 + DAT_004d9d68);
        piVar4[1] = _Var7;
        *piVar4 = param_1;
        websTimeoutCancel(param_1);
      }
    }
    return 1;
  }
  _Var7 = getpid();
  trace(0x10,"now in the antbrute child process(%d, %s).\n",_Var7,*(undefined4 *)(param_1 + 0x90));
  doSystem("sleep %d",iVar12);
  websConnError(param_1,0x191,"Authentication was requested");
                    // WARNING: Subroutine does not return
  exit(0);
}



// WARNING: Globals starting with '_' overlap smaller symbols at the same address

void websAntiBruteReapChildren(void)

{
  time_t tVar1;
  int iVar2;
  char *pcVar3;
  uint uVar4;
  void *__ptr;
  undefined4 uVar5;
  int iVar6;
  undefined4 *__ptr_00;
  uint local_20 [2];
  
  iVar6 = 0;
  if (-1 < DAT_004d72f4) {
    do {
      __ptr = *(void **)(iVar6 * 4 + DAT_004d9d6c);
      if ((__ptr != (void *)0x0) &&
         ((tVar1 = time((time_t *)0x0), tVar1 < *(int *)((int)__ptr + 0x24) ||
          (*(int *)((int)__ptr + 0x28) < tVar1)))) {
        DAT_004d72f4 = FreeEntryId(&DAT_004d9d6c,iVar6);
        free(__ptr);
      }
      iVar6 = iVar6 + 1;
    } while (iVar6 <= DAT_004d72f4);
  }
  iVar6 = 0;
  if (-1 < _DAT_004d72f0) {
    do {
      while( true ) {
        __ptr_00 = *(undefined4 **)(iVar6 * 4 + DAT_004d9d68);
        if (__ptr_00 != (undefined4 *)0x0) break;
LAB_00443e60:
        iVar6 = iVar6 + 1;
        if (_DAT_004d72f0 < iVar6) {
          return;
        }
      }
      uVar5 = *__ptr_00;
      iVar2 = websReapChildren(__ptr_00[1],local_20);
      if (iVar2 != 0) goto LAB_00443e60;
      websConnClose(uVar5,200);
      pcVar3 = "antbrute child(%d) exited, status=%d\n";
      uVar4 = (local_20[0] & 0xff00) >> 8;
      if ((local_20[0] & 0x7f) == 0) {
LAB_00443f04:
        uVar5 = __ptr_00[1];
      }
      else {
        pcVar3 = "antbrute child(%d) killed (signal %d)\n";
        uVar4 = local_20[0] & 0x7f;
        if ((local_20[0] & 0xff) != 0x7f) goto LAB_00443f04;
        uVar4 = (local_20[0] & 0xff00) >> 8;
        uVar5 = __ptr_00[1];
        pcVar3 = "antbrute child(%d) stopped (signal %d)\n";
      }
      trace(0x10,pcVar3,uVar5,uVar4);
      _DAT_004d72f0 = FreeEntryId(&DAT_004d9d68,iVar6);
      free(__ptr_00);
      iVar6 = iVar6 + 1;
    } while (iVar6 <= _DAT_004d72f0);
  }
  return;
}



undefined4 aesencrypt(void *param_1,uint param_2,void *param_3,size_t param_4,undefined4 *param_5)

{
  byte bVar1;
  int iVar2;
  undefined4 *__s;
  byte *pbVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  int iVar7;
  undefined *puVar8;
  byte *pbVar9;
  undefined4 local_98 [16];
  undefined4 local_58 [4];
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  
  __s = local_98;
  memset(__s,0,0x40);
  local_58[0] = 0;
  local_58[1] = 0;
  local_58[2] = 0;
  local_58[3] = 0;
  local_48 = 0;
  local_44 = 0;
  local_40 = 0;
  local_3c = 0;
  if (0x20 < param_2) {
    param_2 = 0x20;
  }
  memcpy(local_58,param_1,param_2);
  if (0x40 < param_4) {
    param_4 = 0x40;
  }
  memcpy(__s,param_3,param_4);
  pbVar3 = &AES_Sbox;
  iVar7 = 0;
  do {
    AES_Sbox_Inv[*pbVar3] = (char)iVar7;
    iVar2 = iVar7 + 1;
    pbVar3 = &DAT_004d72f9 + iVar7;
    iVar7 = iVar2;
  } while (iVar2 < 0x100);
  pbVar3 = &AES_ShiftRowTab;
  iVar7 = 0;
  do {
    (&AES_ShiftRowTab_Inv)[*pbVar3] = (char)iVar7;
    iVar2 = iVar7 + 1;
    pbVar3 = &DAT_004d73f9 + iVar7;
    iVar7 = iVar2;
  } while (iVar2 < 0x10);
  iVar7 = 0;
  do {
    iVar2 = iVar7 + 1;
    bVar1 = (byte)(iVar7 << 1);
    (&DAT_004d9f00)[iVar7] = bVar1 ^ 0x1b;
    (&AES_xtime)[iVar7] = bVar1;
    iVar7 = iVar2;
  } while (iVar2 < 0x80);
  iVar7 = 0;
  puVar4 = __s;
  do {
    iVar2 = 0;
    do {
      pbVar9 = (byte *)((int)puVar4 + iVar2);
      pbVar3 = (byte *)((int)local_58 + iVar2);
      iVar2 = iVar2 + 1;
      *pbVar9 = *pbVar9 ^ *pbVar3;
    } while (iVar2 < 0x10);
    iVar2 = 0;
    do {
      pbVar3 = (byte *)((int)puVar4 + iVar2);
      iVar2 = iVar2 + 1;
      *pbVar3 = (&AES_Sbox)[*pbVar3];
    } while (iVar2 < 0x10);
    local_24 = puVar4[1];
    local_28 = *puVar4;
    local_20 = puVar4[2];
    local_1c = puVar4[3];
    iVar2 = 0;
    do {
      pbVar3 = &AES_ShiftRowTab + iVar2;
      puVar8 = (undefined *)((int)puVar4 + iVar2);
      iVar2 = iVar2 + 1;
      *puVar8 = *(undefined *)((int)&local_28 + (uint)*pbVar3);
    } while (iVar2 < 0x10);
    iVar2 = 0;
    do {
      pbVar9 = (byte *)((int)puVar4 + iVar2);
      pbVar3 = (byte *)((int)&local_48 + iVar2);
      iVar2 = iVar2 + 1;
      *pbVar9 = *pbVar9 ^ *pbVar3;
    } while (iVar2 < 0x10);
    iVar7 = iVar7 + 1;
    puVar4 = puVar4 + 4;
  } while (iVar7 < 4);
  do {
    uVar6 = __s[1];
    *param_5 = *__s;
    uVar5 = __s[2];
    param_5[1] = uVar6;
    uVar6 = __s[3];
    param_5[2] = uVar5;
    __s = __s + 4;
    param_5[3] = uVar6;
    param_5 = param_5 + 4;
  } while (__s != local_58);
  return 1;
}



undefined4 aesdecrypt(void *param_1,uint param_2,void *param_3,size_t param_4,undefined4 *param_5)

{
  byte bVar1;
  int iVar2;
  undefined4 *__s;
  byte *pbVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  int iVar7;
  undefined *puVar8;
  byte *pbVar9;
  undefined4 local_98 [16];
  undefined4 local_58 [4];
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  
  __s = local_98;
  memset(__s,0,0x40);
  local_58[0] = 0;
  local_58[1] = 0;
  local_58[2] = 0;
  local_58[3] = 0;
  local_48 = 0;
  local_44 = 0;
  local_40 = 0;
  local_3c = 0;
  if (0x20 < param_2) {
    param_2 = 0x20;
  }
  memcpy(local_58,param_1,param_2);
  if (0x40 < param_4) {
    param_4 = 0x40;
  }
  memcpy(__s,param_3,param_4);
  pbVar3 = &AES_Sbox;
  iVar7 = 0;
  do {
    AES_Sbox_Inv[*pbVar3] = (char)iVar7;
    iVar2 = iVar7 + 1;
    pbVar3 = &DAT_004d72f9 + iVar7;
    iVar7 = iVar2;
  } while (iVar2 < 0x100);
  pbVar3 = &AES_ShiftRowTab;
  iVar7 = 0;
  do {
    (&AES_ShiftRowTab_Inv)[*pbVar3] = (char)iVar7;
    iVar2 = iVar7 + 1;
    pbVar3 = &DAT_004d73f9 + iVar7;
    iVar7 = iVar2;
  } while (iVar2 < 0x10);
  iVar7 = 0;
  do {
    iVar2 = iVar7 + 1;
    bVar1 = (byte)(iVar7 << 1);
    (&DAT_004d9f00)[iVar7] = bVar1 ^ 0x1b;
    (&AES_xtime)[iVar7] = bVar1;
    iVar7 = iVar2;
  } while (iVar2 < 0x80);
  iVar7 = 0;
  puVar4 = __s;
  do {
    iVar2 = 0;
    do {
      pbVar9 = (byte *)((int)puVar4 + iVar2);
      pbVar3 = (byte *)((int)&local_48 + iVar2);
      iVar2 = iVar2 + 1;
      *pbVar9 = *pbVar9 ^ *pbVar3;
    } while (iVar2 < 0x10);
    local_38 = *puVar4;
    local_34 = puVar4[1];
    local_30 = puVar4[2];
    local_2c = puVar4[3];
    iVar2 = 0;
    do {
      pbVar3 = &AES_ShiftRowTab_Inv + iVar2;
      puVar8 = (undefined *)((int)puVar4 + iVar2);
      iVar2 = iVar2 + 1;
      *puVar8 = *(undefined *)((int)&local_38 + (uint)*pbVar3);
    } while (iVar2 < 0x10);
    iVar2 = 0;
    do {
      pbVar3 = (byte *)((int)puVar4 + iVar2);
      iVar2 = iVar2 + 1;
      *pbVar3 = AES_Sbox_Inv[*pbVar3];
    } while (iVar2 < 0x10);
    iVar2 = 0;
    do {
      pbVar9 = (byte *)((int)puVar4 + iVar2);
      pbVar3 = (byte *)((int)local_58 + iVar2);
      iVar2 = iVar2 + 1;
      *pbVar9 = *pbVar9 ^ *pbVar3;
    } while (iVar2 < 0x10);
    iVar7 = iVar7 + 1;
    puVar4 = puVar4 + 4;
  } while (iVar7 < 4);
  do {
    uVar6 = __s[1];
    *param_5 = *__s;
    uVar5 = __s[2];
    param_5[1] = uVar6;
    uVar6 = __s[3];
    param_5[2] = uVar5;
    __s = __s + 4;
    param_5[3] = uVar6;
    param_5 = param_5 + 4;
  } while (__s != local_58);
  return 1;
}



void allocDecryptbyHexKey(void *param_1,uint param_2,void *param_3,size_t param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined auStack_620 [512];
  undefined auStack_420 [512];
  undefined auStack_220 [512];
  
  memset(auStack_220,0,0x200);
  if (0x1ff < param_4) {
    param_4 = 0x1ff;
  }
  memcpy(auStack_220,param_3,param_4);
  memset(auStack_620,0,0x200);
  uVar1 = hexstringtohexarray(auStack_220,auStack_620);
  memset(auStack_220,0,0x200);
  if (0x1ff < param_2) {
    param_2 = 0x1ff;
  }
  memcpy(auStack_220,param_1,param_2);
  memset(auStack_420,0,0x200);
  uVar2 = hexstringtohexarray(auStack_220,auStack_420);
  memset(auStack_220,0,0x200);
  aesdecrypt(auStack_620,uVar1,auStack_420,uVar2,auStack_220);
  strdupWithoutNull(auStack_220);
  return;
}



void allocEncryptbyHexKey(void *param_1,uint param_2,void *param_3,size_t param_4)

{
  undefined4 uVar1;
  size_t sVar2;
  undefined auStack_620 [512];
  char acStack_420 [512];
  undefined auStack_220 [512];
  
  memset(auStack_220,0,0x200);
  if (0x1ff < param_4) {
    param_4 = 0x1ff;
  }
  memcpy(auStack_220,param_3,param_4);
  memset(auStack_620,0,0x200);
  uVar1 = hexstringtohexarray(auStack_220,auStack_620);
  memset(acStack_420,0,0x200);
  if (0x1ff < param_2) {
    param_2 = 0x1ff;
  }
  memcpy(acStack_420,param_1,param_2);
  sVar2 = strlen(acStack_420);
  memset(auStack_220,0,0x200);
  aesencrypt(auStack_620,uVar1,acStack_420,sVar2,auStack_220);
  memset(acStack_420,0,0x200);
  hexarraytohexstring(auStack_220,acStack_420,0x40);
  strdupWithoutNull(acStack_420);
  return;
}



void allocDecryptbyKey(char *param_1,char *param_2)

{
  size_t sVar1;
  undefined auStack_210 [512];
  
  sVar1 = strlen(param_2);
  hexarraytohexstring(param_2,auStack_210,sVar1);
  sVar1 = strlen(param_1);
  allocDecryptbyHexKey(param_1,sVar1,auStack_210,0x200);
  return;
}



void allocEncryptbyKey(char *param_1,char *param_2)

{
  size_t sVar1;
  undefined auStack_210 [512];
  
  sVar1 = strlen(param_2);
  hexarraytohexstring(param_2,auStack_210,sVar1);
  sVar1 = strlen(param_1);
  allocEncryptbyHexKey(param_1,sVar1,auStack_210,0x200);
  return;
}



int matrixSslOpenWithConfig(char *param_1)

{
  undefined uVar1;
  undefined4 *puVar2;
  int iVar3;
  undefined uVar4;
  undefined uVar5;
  undefined4 *puVar6;
  uint uVar7;
  
  iVar3 = 0;
  if (DAT_004d7408 != 'Y') {
    strncpy(&DAT_004d7408,"YNYYNNNNNYYNY",0x1f);
    iVar3 = strncmp(&DAT_004d7408,param_1,2);
    if (iVar3 == 0) {
      iVar3 = psCryptoOpen(param_1 + 2);
      if (iVar3 < 0) {
        _psTraceStr("psError %s","matrixssl.c");
        _psTraceInt(&DAT_0049016c,0x7a);
        _psError("pscrypto open failure\n");
        iVar3 = -1;
      }
      else {
        memset(&DAT_004d9fb0,0,0xd80);
        uVar7 = 0;
        iVar3 = 0;
        DAT_004dad30 = &DAT_004dad30;
        DAT_004dad34 = &DAT_004dad30;
        do {
          while( true ) {
            puVar2 = DAT_004dad34;
            puVar6 = (undefined4 *)((int)&DAT_004da014 + iVar3);
            uVar4 = (undefined)(uVar7 >> 8);
            uVar5 = (undefined)(uVar7 >> 0x18);
            uVar1 = (undefined)(uVar7 >> 0x10);
            if ((undefined4 **)puVar6 != &DAT_004dad30) break;
            _psTraceStr("psAssert %s","matrixssl.c");
            _psTraceInt(&DAT_0049016c,0x901);
            _psError("(&g_sessionChronList) != (&g_sessionTable[i].chronList)");
            puVar2 = DAT_004dad34;
            DAT_004dad30 = &DAT_004dad30;
            *DAT_004dad34 = &DAT_004dad30;
            DAT_004dad34 = puVar6;
            *(undefined4 **)((int)&DAT_004da018 + iVar3) = puVar2;
            (&DAT_004d9fb0)[iVar3] = (char)uVar7;
            uVar7 = uVar7 + 1;
            (&DAT_004d9fb3)[iVar3] = uVar5;
            (&DAT_004d9fb1)[iVar3] = uVar4;
            (&DAT_004d9fb2)[iVar3] = uVar1;
            iVar3 = iVar3 + 0x6c;
            if (0x1f < uVar7) goto LAB_00444b7c;
          }
          *puVar6 = &DAT_004dad30;
          *DAT_004dad34 = puVar6;
          DAT_004dad34 = puVar6;
          *(undefined4 **)((int)&DAT_004da018 + iVar3) = puVar2;
          (&DAT_004d9fb0)[iVar3] = (char)uVar7;
          uVar7 = uVar7 + 1;
          (&DAT_004d9fb3)[iVar3] = uVar5;
          (&DAT_004d9fb1)[iVar3] = uVar4;
          (&DAT_004d9fb2)[iVar3] = uVar1;
          iVar3 = iVar3 + 0x6c;
        } while (uVar7 < 0x20);
LAB_00444b7c:
        iVar3 = psCreateMutex(&DAT_004d9f80,0);
        if (-1 < iVar3) {
          iVar3 = psCreateMutex(&DAT_004d9f98,0);
          if (-1 < iVar3) {
            iVar3 = dtlsGenCookieSecret();
            if (-1 < iVar3) {
              matrixDtlsSetPmtu(0xffffffff);
              iVar3 = 0;
            }
          }
        }
      }
    }
    else {
      _psTraceStr("psError %s","matrixssl.c");
      _psTraceInt(&DAT_0049016c,0x75);
      _psErrorStr("MatrixSSL config mismatch.\nLibrary: YNYYNNNNNYYNY\nCurrent: %s\n",param_1);
      iVar3 = -1;
    }
  }
  return iVar3;
}



void matrixSslClose(void)

{
  bool bVar1;
  int iVar2;
  
  psLockMutex(&DAT_004d9f80);
  iVar2 = 0x1e;
  do {
    bVar1 = -1 < iVar2;
    iVar2 = iVar2 + -1;
  } while (bVar1);
  memset(&DAT_004d9fb0,0,0xd80);
  psUnlockMutex(&DAT_004d9f80);
  psDestroyMutex((pthread_mutex_t *)&DAT_004d9f80);
  psCryptoClose();
  DAT_004d7408 = 0x4e;
  return;
}



int matrixSslNewKeys(undefined4 *param_1,undefined4 param_2)

{
  undefined4 *__s;
  int iVar1;
  
  __s = (undefined4 *)malloc(0x1bc);
  iVar1 = -8;
  if (__s != (undefined4 *)0x0) {
    memset(__s,0,0x1bc);
    __s[0x24] = param_2;
    *__s = 0;
    iVar1 = psCreateMutex(__s + 0x25,0);
    if (iVar1 < 0) {
      free(__s);
      return iVar1;
    }
    *param_1 = __s;
    iVar1 = 0;
  }
  return iVar1;
}



undefined4 psTestUserEcID(int param_1,uint param_2)

{
  undefined4 uVar1;
  
  if (param_1 == 0x13) {
    param_2 = param_2 & 1;
  }
  else if (param_1 == 0x15) {
    param_2 = param_2 >> 1 & 1;
  }
  else if (param_1 == 0x17) {
    param_2 = param_2 >> 2 & 1;
  }
  else if (param_1 == 0x18) {
    param_2 = param_2 >> 3 & 1;
  }
  else if (param_1 == 0x19) {
    param_2 = param_2 >> 4 & 1;
  }
  else if (param_1 == 0xff) {
    param_2 = param_2 >> 0x10 & 1;
  }
  else if (param_1 == 0x1a) {
    param_2 = param_2 >> 0x11 & 1;
  }
  else if (param_1 == 0x1b) {
    param_2 = param_2 >> 0x12 & 1;
  }
  else {
    if (param_1 != 0x1c) {
      return 0xfffffff6;
    }
    param_2 = param_2 >> 0x13 & 1;
  }
  uVar1 = 0xffffffff;
  if (param_2 != 0) {
    uVar1 = 0;
  }
  return uVar1;
}



int curveIdToFlag(int param_1)

{
  int iVar1;
  
  iVar1 = 1;
  if ((((param_1 != 0x13) && (iVar1 = 2, param_1 != 0x15)) && (iVar1 = 4, param_1 != 0x17)) &&
     (((iVar1 = 8, param_1 != 0x18 && (iVar1 = 0x10, param_1 != 0x19)) &&
      ((iVar1 = 0x10000, param_1 != 0xff && (iVar1 = 0x20000, param_1 != 0x1a)))))) {
    iVar1 = 0x40000;
    if (param_1 != 0x1b) {
      iVar1 = (uint)(param_1 == 0x1c) << 0x13;
    }
  }
  return iVar1;
}



int matrixSslGenEphemeralEcKey(undefined4 *param_1,int param_2,int param_3,undefined4 param_4)

{
  int iVar1;
  ushort uVar2;
  undefined4 local_28;
  undefined4 local_24;
  
  if ((param_1 == (undefined4 *)0x0) || (param_3 == 0)) {
    _psTraceStr("psAssert %s","matrixssl.c");
    _psTraceInt(&DAT_0049016c,0x358);
    _psError("keys && curve");
  }
  psGetTime(&local_28,param_1[0x24]);
  psLockMutex(param_1 + 0x25);
  if (param_1[0x38] == param_3) {
    uVar2 = *(ushort *)(param_1 + 0x4d);
    if (1000 < uVar2) goto LAB_00445040;
    iVar1 = psDiffMsecs(param_1[0x4b],param_1[0x4c],local_28,local_24,param_1[0x24]);
    if (7200000 < iVar1) goto LAB_00445034;
    *(short *)(param_1 + 0x4d) = *(short *)(param_1 + 0x4d) + 1;
  }
  else {
LAB_00445034:
    uVar2 = *(ushort *)(param_1 + 0x4d);
LAB_00445040:
    if (uVar2 != 0) {
      psEccClearKey(param_1 + 0x2b);
      *(undefined2 *)(param_1 + 0x4d) = 0;
    }
    iVar1 = psEccGenKey(*param_1,param_1 + 0x2b,param_3,param_4);
    if (iVar1 < 0) goto LAB_004450a8;
    param_1[0x4b] = local_28;
    *(undefined2 *)(param_1 + 0x4d) = 1;
    param_1[0x4c] = local_24;
  }
  iVar1 = 0;
  if (param_2 != 0) {
    iVar1 = psEccCopyKey(param_2,param_1 + 0x2b);
  }
LAB_004450a8:
  psUnlockMutex(param_1 + 0x25);
  return iVar1;
}



void matrixSslDeleteKeys(void *param_1)

{
  void **__ptr;
  int iVar1;
  void *pvVar2;
  void **ppvVar3;
  void *pvVar4;
  
  if (param_1 == (void *)0x0) {
    return;
  }
  if (*(int *)((int)param_1 + 0x74) == 0) {
    psClearPubKey((int)param_1 + 4);
    iVar1 = *(int *)((int)param_1 + 0x78);
  }
  else {
    psX509FreeCert();
    psClearPubKey((int)param_1 + 4);
    iVar1 = *(int *)((int)param_1 + 0x78);
  }
  if (iVar1 != 0) {
    psX509FreeCert();
  }
  __ptr = *(void ***)((int)param_1 + 0x7c);
  while (__ptr != (void **)0x0) {
    free(*__ptr);
    free(__ptr[2]);
    ppvVar3 = (void **)__ptr[4];
    free(__ptr);
    __ptr = ppvVar3;
  }
  pvVar2 = *(void **)((int)param_1 + 0x80);
  while (pvVar2 != (void *)0x0) {
    pvVar4 = *(void **)((int)pvVar2 + 0x58);
    free(pvVar2);
    pvVar2 = pvVar4;
  }
  psDestroyMutex((pthread_mutex_t *)((int)param_1 + 0x94));
  if (*(short *)((int)param_1 + 0x134) == 0) {
    pvVar2 = *(void **)((int)param_1 + 0x88);
  }
  else {
    psEccClearKey((int)param_1 + 0xac);
    psEccClearKey((int)param_1 + 0xec);
    pvVar2 = *(void **)((int)param_1 + 0x88);
  }
  if (pvVar2 == (void *)0x0) {
    memset_s(param_1,0x1bc,0,0x1bc);
                    // WARNING: Treating indirect jump as call
    free(param_1);
    return;
  }
  free(pvVar2);
  *(undefined2 *)((int)param_1 + 0x8c) = 0;
  memset_s(param_1,0x1bc,0,0x1bc);
                    // WARNING: Treating indirect jump as call
  free(param_1);
  return;
}



int FUN_00445418(undefined4 *param_1,int param_2,int param_3,undefined4 param_4,int param_5,
                int param_6)

{
  int iVar1;
  undefined2 uVar2;
  int iVar3;
  int iVar4;
  char cVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  undefined4 local_30 [2];
  
  if (param_1 == (undefined4 *)0x0) {
    return -6;
  }
  uVar6 = *param_1;
  if (param_2 != 0) {
    if (param_1[0x1d] != 0) {
      return -10;
    }
    iVar3 = psX509ParseCertFile(uVar6,param_2,param_1 + 0x1d,3);
    if (iVar3 < 0) {
      return iVar3;
    }
    iVar3 = param_1[0x1d];
    if (*(int *)(iVar3 + 0x2b4) != 0) {
      if (*(int *)(iVar3 + 0x2b4) != 8) {
        _psTraceStr("psAssert %s","matrixssl.c");
        _psTraceInt(&DAT_0049016c,0x29a);
        _psError("keys->cert->authFailFlags == PS_CERT_AUTH_FAIL_DATE_FLAG");
        iVar3 = param_1[0x1d];
      }
      psX509FreeCert(iVar3);
      param_1[0x1d] = 0;
      return -0x25;
    }
  }
  if (param_3 != 0) {
    if ((*(short *)(param_1 + 0x1c) != 0) && (param_1[0x1d] != 0)) {
      psX509FreeCert();
      param_1[0x1d] = 0;
      return -10;
    }
    puVar7 = param_1 + 1;
    if (param_6 == 1) {
      psInitPubKey(uVar6,puVar7,1);
      iVar3 = psPkcs1ParsePrivFile(uVar6,param_3,param_4,puVar7);
      if (iVar3 < 0) {
        if (param_1[0x1d] == 0) {
          return iVar3;
        }
        psX509FreeCert();
        param_1[0x1d] = 0;
        return iVar3;
      }
      uVar2 = psRsaSize(puVar7);
      *(undefined2 *)(param_1 + 0x1c) = uVar2;
    }
    puVar7 = param_1 + 1;
    if (param_6 == 3) {
      psInitPubKey(uVar6,puVar7,3);
      iVar3 = psEccParsePrivFile(uVar6,param_3,param_4,puVar7);
      if (iVar3 < 0) {
        if (param_1[0x1d] == 0) {
          return iVar3;
        }
        psX509FreeCert();
        param_1[0x1d] = 0;
        return iVar3;
      }
      uVar2 = psEccSize(puVar7);
      *(undefined2 *)(param_1 + 0x1c) = uVar2;
    }
  }
  iVar3 = param_1[0x1d];
  if (iVar3 == 0) {
    cVar5 = *(char *)((int)param_1 + 0x72);
    if (cVar5 == '\0') goto LAB_0044550c;
  }
  else {
    cVar5 = *(char *)((int)param_1 + 0x72);
    if (cVar5 == '\0') goto LAB_004456e8;
  }
  if (cVar5 == '\0') {
    if (iVar3 != 0) goto LAB_004456ac;
  }
  else {
    if (iVar3 == 0) goto LAB_004456e8;
LAB_004456ac:
    if (*(int *)(iVar3 + 0x31c) != 0) {
      local_30[0] = 0;
      psX509AuthenticateCert(uVar6,iVar3,0,local_30,0,param_1[0x24]);
      iVar3 = param_1[0x1d];
      iVar4 = iVar3;
      for (iVar1 = *(int *)(iVar3 + 0x31c); iVar1 != 0; iVar1 = *(int *)(iVar1 + 0x31c)) {
        if (*(int *)(iVar4 + 0x2b0) != 1) goto LAB_004456e8;
        iVar4 = iVar1;
      }
      cVar5 = *(char *)((int)param_1 + 0x72);
    }
  }
  if ((cVar5 != '\x01') || (iVar3 = psRsaCmpPubKey(param_1 + 1,iVar3 + 0x28), -1 < iVar3)) {
LAB_0044550c:
    if (param_5 == 0) {
      return 0;
    }
    iVar3 = -10;
    if (param_1[0x1e] == 0) {
      iVar3 = psX509ParseCertFile(uVar6,param_5,param_1 + 0x1e,2);
      if (-1 < iVar3) {
        iVar4 = param_1[0x1e];
        if (*(int *)(iVar4 + 0x2b4) == 0) {
          return 0;
        }
        if (*(int *)(iVar4 + 0x2b4) != 8) {
          _psTraceStr("psAssert %s","matrixssl.c");
          _psTraceInt(&DAT_0049016c,0x30a);
          _psError("keys->CAcerts->authFailFlags == PS_CERT_AUTH_FAIL_DATE_FLAG");
          iVar4 = param_1[0x1e];
        }
        iVar3 = -0x25;
        psX509FreeCert(iVar4);
        param_1[0x1e] = 0;
      }
      if (param_1[0x1d] != 0) {
        psX509FreeCert();
        param_1[0x1d] = 0;
      }
      psClearPubKey(param_1 + 1);
    }
    return iVar3;
  }
LAB_004456e8:
  psX509FreeCert(param_1[0x1d]);
  psClearPubKey(param_1 + 1);
  param_1[0x1d] = 0;
  return -0x24;
}



// WARNING: Removing unreachable block (ram,0x004457bc)
// WARNING: Removing unreachable block (ram,0x004458cc)
// WARNING: Removing unreachable block (ram,0x004458e4)
// WARNING: Removing unreachable block (ram,0x004458dc)
// WARNING: Removing unreachable block (ram,0x004457f8)

int matrixSslLoadRsaKeys(undefined4 *param_1,int param_2,int param_3,undefined4 param_4,int param_5)

{
  int iVar1;
  undefined2 uVar2;
  int iVar3;
  int iVar4;
  char cVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  undefined4 param_6;
  undefined4 auStack_30 [2];
  
  param_6 = 1;
  if (param_1 == (undefined4 *)0x0) {
    return -6;
  }
  uVar6 = *param_1;
  if (param_2 != 0) {
    if (param_1[0x1d] != 0) {
      return -10;
    }
    iVar3 = psX509ParseCertFile(uVar6,param_2,param_1 + 0x1d,3);
    if (iVar3 < 0) {
      return iVar3;
    }
    iVar3 = param_1[0x1d];
    if (*(int *)(iVar3 + 0x2b4) != 0) {
      if (*(int *)(iVar3 + 0x2b4) != 8) {
        _psTraceStr("psAssert %s","matrixssl.c");
        _psTraceInt(&DAT_0049016c,0x29a);
        _psError("keys->cert->authFailFlags == PS_CERT_AUTH_FAIL_DATE_FLAG");
        iVar3 = param_1[0x1d];
      }
      psX509FreeCert(iVar3);
      param_1[0x1d] = 0;
      return -0x25;
    }
  }
  if (param_3 != 0) {
    if ((*(short *)(param_1 + 0x1c) != 0) && (param_1[0x1d] != 0)) {
      psX509FreeCert();
      param_1[0x1d] = 0;
      return -10;
    }
    puVar7 = param_1 + 1;
    psInitPubKey(uVar6,puVar7,1);
    iVar3 = psPkcs1ParsePrivFile(uVar6,param_3,param_4,puVar7);
    if (iVar3 < 0) {
      if (param_1[0x1d] == 0) {
        return iVar3;
      }
      psX509FreeCert();
      param_1[0x1d] = 0;
      return iVar3;
    }
    uVar2 = psRsaSize(puVar7);
    *(undefined2 *)(param_1 + 0x1c) = uVar2;
  }
  iVar3 = param_1[0x1d];
  if (iVar3 == 0) {
    cVar5 = *(char *)((int)param_1 + 0x72);
    if (cVar5 == '\0') goto LAB_0044550c;
  }
  else {
    cVar5 = *(char *)((int)param_1 + 0x72);
    if (cVar5 == '\0') goto LAB_004456e8;
  }
  if (cVar5 == '\0') {
    if (iVar3 != 0) goto LAB_004456ac;
  }
  else {
    if (iVar3 == 0) goto LAB_004456e8;
LAB_004456ac:
    if (*(int *)(iVar3 + 0x31c) != 0) {
      auStack_30[0] = 0;
      psX509AuthenticateCert(uVar6,iVar3,0,auStack_30,0,param_1[0x24]);
      iVar3 = param_1[0x1d];
      iVar4 = iVar3;
      for (iVar1 = *(int *)(iVar3 + 0x31c); iVar1 != 0; iVar1 = *(int *)(iVar1 + 0x31c)) {
        if (*(int *)(iVar4 + 0x2b0) != 1) goto LAB_004456e8;
        iVar4 = iVar1;
      }
      cVar5 = *(char *)((int)param_1 + 0x72);
    }
  }
  if ((cVar5 != '\x01') || (iVar3 = psRsaCmpPubKey(param_1 + 1,iVar3 + 0x28), -1 < iVar3)) {
LAB_0044550c:
    if (param_5 == 0) {
      return 0;
    }
    iVar3 = -10;
    if (param_1[0x1e] == 0) {
      iVar3 = psX509ParseCertFile(uVar6,param_5,param_1 + 0x1e,2);
      if (-1 < iVar3) {
        iVar4 = param_1[0x1e];
        if (*(int *)(iVar4 + 0x2b4) == 0) {
          return 0;
        }
        if (*(int *)(iVar4 + 0x2b4) != 8) {
          _psTraceStr("psAssert %s","matrixssl.c");
          _psTraceInt(&DAT_0049016c,0x30a);
          _psError("keys->CAcerts->authFailFlags == PS_CERT_AUTH_FAIL_DATE_FLAG");
          iVar4 = param_1[0x1e];
        }
        iVar3 = -0x25;
        psX509FreeCert(iVar4);
        param_1[0x1e] = 0;
      }
      if (param_1[0x1d] != 0) {
        psX509FreeCert();
        param_1[0x1d] = 0;
      }
      psClearPubKey(param_1 + 1);
    }
    return iVar3;
  }
LAB_004456e8:
  psX509FreeCert(param_1[0x1d]);
  psClearPubKey(param_1 + 1);
  param_1[0x1d] = 0;
  return -0x24;
}



undefined4 matrixUpdateSession(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  uint uVar7;
  
  uVar2 = 0xfffffffa;
  if ((*(uint *)(param_1 + 0xd2c) & 1) != 0) {
    uVar2 = 0xfffffff7;
    if (*(char *)(param_1 + 0xc98) != '\0') {
      uVar7 = (uint)*(byte *)(param_1 + 0xc9c) * 0x1000000 +
              (uint)*(byte *)(param_1 + 0xc9b) * 0x10000 + (uint)*(byte *)(param_1 + 0xc9a) * 0x100
              + (uint)*(byte *)(param_1 + 0xc99);
      uVar2 = 0xfffffff7;
      if (uVar7 < 0x20) {
        psLockMutex(&DAT_004d9f80);
        iVar1 = *(int *)(&DAT_004da010 + uVar7 * 0x6c);
        if ((*(uint *)(param_1 + 0xd2c) >> 4 & 1) != 0) {
          iVar1 = iVar1 + -1;
        }
        *(int *)(&DAT_004da010 + uVar7 * 0x6c) = iVar1;
        if (iVar1 == 0) {
          puVar3 = &DAT_004da014 + uVar7 * 0x1b;
          if (puVar3 == &DAT_004dad30) {
            _psTraceStr("psAssert %s","matrixssl.c");
            _psTraceInt(&DAT_0049016c,0xa0a);
            _psError("(&g_sessionChronList) != (&g_sessionTable[i].chronList)");
          }
          puVar4 = DAT_004dad34;
          *puVar3 = &DAT_004dad30;
          *DAT_004dad34 = puVar3;
          DAT_004dad34 = puVar3;
          (&DAT_004da018)[uVar7 * 0x1b] = puVar4;
        }
        if ((*(uint *)(param_1 + 0xd2c) >> 6 & 1) == 0) {
          puVar3 = (undefined4 *)(&DAT_004d9fd0 + uVar7 * 0x6c);
          puVar4 = (undefined4 *)(param_1 + 0x50);
          do {
            uVar2 = puVar4[1];
            uVar6 = puVar4[2];
            uVar5 = puVar4[3];
            *puVar3 = *puVar4;
            puVar3[1] = uVar2;
            puVar3[2] = uVar6;
            puVar4 = puVar4 + 4;
            puVar3[3] = uVar5;
            puVar3 = puVar3 + 4;
          } while (puVar4 != (undefined4 *)(param_1 + 0x80));
          *(undefined4 *)(&DAT_004da000 + uVar7 * 0x6c) = *(undefined4 *)(param_1 + 0xd10);
          psUnlockMutex(&DAT_004d9f80);
          uVar2 = 0;
        }
        else {
          memset(&DAT_004d9fd0 + uVar7 * 0x6c,0,0x30);
          *(undefined4 *)(&DAT_004da000 + uVar7 * 0x6c) = 0;
          psUnlockMutex(&DAT_004d9f80);
          uVar2 = 0xffffffff;
        }
      }
    }
  }
  return uVar2;
}



void matrixSslDeleteSession(void *param_1)

{
  uint uVar1;
  void *__ptr;
  
  if (param_1 == (void *)0x0) {
    return;
  }
  uVar1 = *(uint *)((int)param_1 + 0xd2c);
  *(uint *)((int)param_1 + 0xd2c) = uVar1 | 0x10;
  if ((*(char *)((int)param_1 + 0xc98) != '\0') && ((uVar1 & 1) != 0)) {
    matrixUpdateSession();
    uVar1 = *(uint *)((int)param_1 + 0xd2c);
  }
  if (((uVar1 & 1) != 0) && (*(void **)((int)param_1 + 0xcbc) != (void *)0x0)) {
    free(*(void **)((int)param_1 + 0xcbc));
    *(undefined4 *)((int)param_1 + 0xcbc) = 0;
  }
  *(undefined *)((int)param_1 + 0xc98) = 0;
  if (*(void **)((int)param_1 + 0xcc0) != (void *)0x0) {
    free(*(void **)((int)param_1 + 0xcc0));
  }
  if (*(int *)((int)param_1 + 600) != 0) {
    psX509FreeCert();
    *(undefined4 *)((int)param_1 + 600) = 0;
  }
  if (*(int *)((int)param_1 + 0xc38) != 0) {
    psEccDeleteKey((int)param_1 + 0xc38);
  }
  if (*(int *)((int)param_1 + 0xc34) != 0) {
    psEccDeleteKey((int)param_1 + 0xc34);
  }
  if (*(void **)((int)param_1 + 0x80) != (void *)0x0) {
    free(*(void **)((int)param_1 + 0x80));
  }
  if (*(void **)((int)param_1 + 0xd04) != (void *)0x0) {
    free(*(void **)((int)param_1 + 0xd04));
  }
  if (*(void **)((int)param_1 + 0xd60) != (void *)0x0) {
    free(*(void **)((int)param_1 + 0xd60));
  }
  if (*(void **)((int)param_1 + 0xd6c) != (void *)0x0) {
    free(*(void **)((int)param_1 + 0xd6c));
  }
  dtlsInitFrag(param_1);
  if (*(void **)((int)param_1 + 0x1220) != (void *)0x0) {
    free(*(void **)((int)param_1 + 0x1220));
  }
  if (*(void **)((int)param_1 + 0x1224) == (void *)0x0) {
    __ptr = *(void **)((int)param_1 + 0xc2c);
  }
  else {
    free(*(void **)((int)param_1 + 0x1224));
    __ptr = *(void **)((int)param_1 + 0xc2c);
  }
  if (__ptr != (void *)0x0) {
    free(__ptr);
  }
  memset(*(void **)((int)param_1 + 0xce4),0,*(size_t *)((int)param_1 + 0xcf4));
  memset(*(void **)((int)param_1 + 0xce8),0,*(size_t *)((int)param_1 + 0xcf8));
  free(*(void **)((int)param_1 + 0xce8));
  free(*(void **)((int)param_1 + 0xce4));
  freePkaAfter(param_1);
  clearFlightList(param_1);
  memset(param_1,0,0x1258);
                    // WARNING: Treating indirect jump as call
  free(param_1);
  return;
}



// WARNING: Type propagation algorithm not settling

undefined4 matrixSslNewSession(void **param_1,int param_2,int param_3,int param_4)

{
  byte bVar1;
  short sVar2;
  undefined uVar3;
  void *__s;
  size_t sVar4;
  void *pvVar5;
  undefined4 uVar6;
  int iVar7;
  undefined4 uVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  undefined4 uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  code *pcVar15;
  undefined4 uVar16;
  
  uVar13 = *(uint *)(param_4 + 0x14);
  if ((uVar13 >> 0x1e & 1) != 0) {
    return 0xfffffffa;
  }
  __s = malloc(0x1258);
  if (__s == (void *)0x0) {
    return 0xfffffff8;
  }
  memset(__s,0,0x1258);
  iVar7 = *(int *)(param_4 + 0x28);
  *(undefined4 *)((int)__s + 0x124c) = *(undefined4 *)(param_4 + 0x20);
  if (iVar7 != 0) {
    *(uint *)((int)__s + 0xcfc) = *(uint *)((int)__s + 0xcfc) | 0x10;
  }
  if (*(int *)(param_4 + 0x2c) != 0) {
    *(uint *)((int)__s + 0xcfc) = *(uint *)((int)__s + 0xcfc) | 8;
  }
  if (-1 < *(int *)(param_4 + 0x3c)) {
    *(int *)((int)__s + 0x1248) = *(int *)(param_4 + 0x3c);
  }
  if (*(int *)(param_4 + 0x40) != 0) {
    *(int *)((int)__s + 0x1254) = *(int *)(param_4 + 0x40);
  }
  uVar12 = *(uint *)(param_4 + 0x10);
  if (uVar12 == 0) {
    uVar12 = compiledInEcFlags();
    *(uint *)((int)__s + 0xd48) = *(uint *)((int)__s + 0xd48) & 0xff000000 | uVar12 & 0xffffff;
LAB_0044636c:
    uVar14 = uVar13 >> 0xe;
    sVar4 = 0x5dc;
    uVar12 = uVar14 & 1;
    *(undefined4 *)((int)__s + 0xc88) = *(undefined4 *)(param_4 + 0x24);
    *(undefined4 *)((int)__s + 0xcf8) = 0x5dc;
    if (uVar12 != 0) {
      sVar4 = matrixDtlsGetPmtu();
      *(size_t *)((int)__s + 0xcf8) = sVar4;
    }
    pvVar5 = malloc(sVar4);
    *(void **)((int)__s + 0xce8) = pvVar5;
    if (pvVar5 == (void *)0x0) {
      free(__s);
      return 0xfffffff8;
    }
    sVar4 = 0x5dc;
    *(undefined4 *)((int)__s + 0xcf4) = 0x5dc;
    if (uVar12 != 0) {
      sVar4 = matrixDtlsGetPmtu();
      *(size_t *)((int)__s + 0xcf4) = sVar4;
    }
    pvVar5 = malloc(sVar4);
    *(void **)((int)__s + 0xce4) = pvVar5;
    if (pvVar5 != (void *)0x0) {
      *(int *)((int)__s + 0xc48) = param_2;
      *(undefined4 *)((int)__s + 0xc8c) = 0;
      iVar7 = sslGetCipherSpec(__s,0);
      *(int *)((int)__s + 0xd10) = iVar7;
      if (iVar7 != 0) {
        sslActivateReadCipher(__s);
        sslActivateWriteCipher(__s);
        if (uVar12 == 0) {
          *(undefined4 *)((int)__s + 0x1238) = 4;
          *(undefined4 *)((int)__s + 0x1234) = 5;
        }
        else {
          *(uint *)((int)__s + 0xd2c) = *(uint *)((int)__s + 0xd2c) | 0x4000;
          *(undefined4 *)((int)__s + 0x1234) = 0xd;
          *(undefined4 *)((int)__s + 0x1238) = 0xc;
          uVar6 = matrixDtlsGetPmtu();
          *(undefined4 *)((int)__s + 0xdf8) = uVar6;
          *(undefined4 *)((int)__s + 0xdf4) = 0xffffffff;
          *(undefined4 *)((int)__s + 0xd68) = 0;
          *(undefined2 *)((int)__s + 0xe00) = 0;
          *(undefined2 *)((int)__s + 0xe02) = 0;
          dtlsInitFrag(__s);
        }
        if ((uVar13 & 1) == 0) {
          iVar7 = 0;
          if ((uVar13 >> 10 & 1) != 0) {
            iVar7 = 2;
          }
          if ((uVar13 >> 0xb & 1) != 0) {
            *(undefined *)((int)__s + 0xd3d) = 3;
            *(undefined *)((int)__s + 0xd3e) = 1;
            *(uint *)((int)__s + 0xd2c) = *(uint *)((int)__s + 0xd2c) | 0x800;
            iVar7 = 1;
          }
          if ((uVar13 >> 0xc & 1) != 0) {
            *(undefined *)((int)__s + 0xd3d) = 3;
            *(undefined *)((int)__s + 0xd3e) = 2;
            *(uint *)((int)__s + 0xd2c) = *(uint *)((int)__s + 0xd2c) | 0x1800;
            iVar7 = 1;
          }
          if ((uVar13 >> 0xd & 1) != 0) {
            *(undefined *)((int)__s + 0xd3e) = 3;
            *(uint *)((int)__s + 0xd2c) = *(uint *)((int)__s + 0xd2c) | 0x3800;
            *(undefined *)((int)__s + 0xd3d) = 3;
            iVar7 = 1;
          }
          if (iVar7 != 2) {
            if (iVar7 == 0) {
              *(uint *)((int)__s + 0xd2c) = *(uint *)((int)__s + 0xd2c) | 0x3800;
              if ((uVar14 & 1) == 0) {
                *(undefined *)((int)__s + 0xd3d) = 3;
                *(undefined *)((int)__s + 0xd3e) = 3;
              }
              else {
                *(undefined *)((int)__s + 0xd3d) = 0xfe;
                *(undefined *)((int)__s + 0xd3e) = 0xfd;
              }
            }
            if (((uVar14 & 1) != 0) && (iVar7 == 1)) {
              *(undefined *)((int)__s + 0xd3d) = 0xfe;
              uVar3 = 0xfd;
              if ((*(char *)((int)__s + 0xd3e) != '\x03') &&
                 (uVar3 = 0xff, *(char *)((int)__s + 0xd3e) != '\x02')) goto LAB_00446a68;
              *(undefined *)((int)__s + 0xd3e) = uVar3;
            }
            *(undefined *)((int)__s + 0xd38) = 2;
            if ((param_3 != 0) && (*(uint *)(param_3 + 0x54) != 0)) {
              iVar7 = sslGetCipherSpec(__s,*(uint *)(param_3 + 0x54) & 0xffff);
              *(int *)((int)__s + 0xd10) = iVar7;
              if (iVar7 != 0) {
                puVar10 = (undefined4 *)((int)__s + 0x50);
                puVar9 = (undefined4 *)(param_3 + 0x24);
                do {
                  uVar6 = *puVar9;
                  uVar8 = puVar9[1];
                  uVar11 = puVar9[2];
                  uVar16 = puVar9[3];
                  puVar9 = puVar9 + 4;
                  *puVar10 = uVar6;
                  puVar10[1] = uVar8;
                  puVar10[2] = uVar11;
                  puVar10[3] = uVar16;
                  puVar10 = puVar10 + 4;
                } while (puVar9 != (undefined4 *)(param_3 + 0x54));
                uVar6 = *(undefined4 *)(param_3 + 4);
                *(undefined *)((int)__s + 0xc98) = 0x20;
                uVar8 = *(undefined4 *)(param_3 + 8);
                *(undefined4 *)((int)__s + 0xc99) = uVar6;
                uVar6 = *(undefined4 *)(param_3 + 0xc);
                *(undefined4 *)((int)__s + 0xc9d) = uVar8;
                uVar8 = *(undefined4 *)(param_3 + 0x10);
                *(undefined4 *)((int)__s + 0xca1) = uVar6;
                uVar11 = *(undefined4 *)(param_3 + 0x14);
                *(undefined4 *)((int)__s + 0xca5) = uVar8;
                uVar6 = *(undefined4 *)(param_3 + 0x18);
                uVar8 = *(undefined4 *)(param_3 + 0x1c);
                *(undefined4 *)((int)__s + 0xca9) = uVar11;
                uVar11 = *(undefined4 *)(param_3 + 0x20);
                *(undefined4 *)((int)__s + 0xcad) = uVar6;
                *(undefined4 *)((int)__s + 0xcb1) = uVar8;
                uVar13 = 0;
                *(undefined4 *)((int)__s + 0xcb5) = uVar11;
                do {
                  iVar7 = param_3 + uVar13;
                  uVar13 = uVar13 + 1;
                  if (*(char *)(iVar7 + 4) != '\0') {
                    *(undefined *)((int)__s + 0xc98) = 0x20;
                    goto LAB_00446624;
                  }
                } while (uVar13 < 0x20);
                *(undefined *)((int)__s + 0xc98) = 0;
              }
            }
LAB_00446624:
            *(int *)((int)__s + 0xcbc) = param_3;
LAB_00446628:
            memset(*(void **)((int)__s + 0xce4),0,*(size_t *)((int)__s + 0xcf4));
            memset(*(void **)((int)__s + 0xce8),0,*(size_t *)((int)__s + 0xcf8));
            *param_1 = __s;
            *(undefined4 *)((int)__s + 0xd30) = 0xff;
            *(undefined *)((int)__s + 0xd39) = 0xfe;
            *(undefined *)((int)__s + 0xd3a) = 0xfe;
            return 0;
          }
        }
        else {
          if ((uVar13 >> 7 & 1) == 0) {
            *(uint *)((int)__s + 0xd2c) = *(uint *)((int)__s + 0xd2c) | 1;
          }
          else {
            *(uint *)((int)__s + 0xd2c) = *(uint *)((int)__s + 0xd2c) | 0x81;
          }
          *(undefined *)((int)__s + 0xd38) = 1;
          if ((uVar13 >> 0xb & 1) != 0) {
            *(undefined *)((int)__s + 0xd3d) = 3;
            *(undefined *)((int)__s + 0xd3e) = 1;
          }
          if ((uVar13 >> 0xc & 1) != 0) {
            *(undefined *)((int)__s + 0xd3d) = 3;
            *(undefined *)((int)__s + 0xd3e) = 2;
          }
          if ((uVar13 >> 0xd & 1) != 0) {
            *(undefined *)((int)__s + 0xd3e) = 3;
            *(undefined *)((int)__s + 0xd3d) = 3;
          }
          if ((uVar13 >> 10 & 1) == 0) {
            if (((uVar14 & 1) == 0) || (*(char *)((int)__s + 0xd3d) == '\0')) goto LAB_00446628;
            bVar1 = *(byte *)((int)__s + 0xd3e);
            if (1 < bVar1) {
              *(undefined *)((int)__s + 0xd3d) = 0xfe;
              uVar3 = 0xfd;
              if ((bVar1 == 3) || (uVar3 = 0xff, bVar1 == 2)) {
                *(undefined *)((int)__s + 0xd3e) = uVar3;
                goto LAB_00446628;
              }
            }
          }
        }
LAB_00446a68:
        pcVar15 = matrixSslDeleteSession;
        goto LAB_004461c4;
      }
    }
    free(*(void **)((int)__s + 0xce8));
    free(__s);
    uVar6 = 0xfffffff8;
  }
  else {
    if (*(char *)(param_2 + 0x72) != '\x03') {
LAB_004460c0:
      iVar7 = *(int *)(param_2 + 0x74);
      if (iVar7 != 0) {
        do {
          if (*(char *)(iVar7 + 0x96) == '\x03') {
            sVar2 = *(short *)(*(int *)(iVar7 + 0x5c) + 2);
            if (sVar2 != 0x13) {
              uVar14 = uVar12 >> 1;
              if ((((((sVar2 == 0x15) || (uVar14 = uVar12 >> 2, sVar2 == 0x17)) ||
                    (uVar14 = uVar12 >> 3, sVar2 == 0x18)) ||
                   ((uVar14 = uVar12 >> 4, sVar2 == 0x19 || (uVar14 = uVar12 >> 0x10, sVar2 == 0xff)
                    ))) || ((uVar14 = uVar12 >> 0x11, sVar2 == 0x1a ||
                            ((uVar14 = uVar12 >> 0x12, sVar2 == 0x1b ||
                             (uVar14 = uVar12 >> 0x13, sVar2 == 0x1c)))))) && ((uVar14 & 1) != 0))
              goto LAB_0044613c;
              goto LAB_004461bc;
            }
            if ((uVar12 & 1) == 0) goto LAB_004461bc;
            iVar7 = *(int *)(iVar7 + 0x31c);
          }
          else {
LAB_0044613c:
            iVar7 = *(int *)(iVar7 + 0x31c);
          }
        } while (iVar7 != 0);
      }
      iVar7 = *(int *)(param_2 + 0x78);
      if (iVar7 != 0) {
        do {
          if (*(char *)(iVar7 + 0x96) == '\x03') {
            sVar2 = *(short *)(*(int *)(iVar7 + 0x5c) + 2);
            uVar14 = uVar12;
            if ((((sVar2 != 0x13) && (uVar14 = uVar12 >> 1, sVar2 != 0x15)) &&
                (uVar14 = uVar12 >> 2, sVar2 != 0x17)) && (uVar14 = uVar12 >> 3, sVar2 != 0x18)) {
              if (sVar2 == 0x19) {
                if ((uVar12 >> 4 & 1) != 0) goto LAB_004462b0;
                goto LAB_004461bc;
              }
              uVar14 = uVar12 >> 0x10;
              if (((sVar2 != 0xff) && (uVar14 = uVar12 >> 0x11, sVar2 != 0x1a)) &&
                 ((uVar14 = uVar12 >> 0x12, sVar2 != 0x1b &&
                  (uVar14 = uVar12 >> 0x13, sVar2 != 0x1c)))) goto LAB_004461bc;
            }
            if ((uVar14 & 1) == 0) goto LAB_004461bc;
          }
LAB_004462b0:
          iVar7 = *(int *)(iVar7 + 0x31c);
        } while (iVar7 != 0);
      }
      *(uint *)((int)__s + 0xd48) = *(uint *)((int)__s + 0xd48) & 0xff000000 | uVar12 & 0xffffff;
      goto LAB_0044636c;
    }
    sVar2 = *(short *)(*(int *)(param_2 + 0x38) + 2);
    uVar14 = uVar12 & 1;
    if (sVar2 == 0x13) {
LAB_00446914:
      if (uVar14 != 0) goto LAB_004460c0;
    }
    else {
      if (sVar2 == 0x15) {
        uVar14 = uVar12 >> 1 & 1;
        goto LAB_00446914;
      }
      if (sVar2 == 0x17) {
        uVar14 = uVar12 >> 2 & 1;
        goto LAB_00446914;
      }
      if (sVar2 == 0x18) {
        uVar14 = uVar12 >> 3 & 1;
        goto LAB_00446914;
      }
      if (sVar2 == 0x19) {
        uVar14 = uVar12 >> 4 & 1;
        goto LAB_00446914;
      }
      if (sVar2 == 0xff) {
        uVar14 = uVar12 >> 0x10 & 1;
        goto LAB_00446914;
      }
      if (sVar2 == 0x1a) {
        uVar14 = uVar12 >> 0x11 & 1;
        goto LAB_00446914;
      }
      if (sVar2 == 0x1b) {
        uVar14 = uVar12 >> 0x12 & 1;
        goto LAB_00446914;
      }
      if (sVar2 == 0x1c) {
        uVar14 = uVar12 >> 0x13 & 1;
        goto LAB_00446914;
      }
    }
LAB_004461bc:
    pcVar15 = free;
LAB_004461c4:
    (*pcVar15)(__s);
    uVar6 = 0xfffffffa;
  }
  return uVar6;
}



undefined4 matrixClearSession(int param_1,int param_2)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  uint uVar4;
  int iVar5;
  
  uVar2 = 0xfffffffa;
  if (*(char *)(param_1 + 0xc98) != '\0') {
    uVar4 = (uint)*(byte *)(param_1 + 0xc9c) * 0x1000000 +
            (uint)*(byte *)(param_1 + 0xc9b) * 0x10000 + (uint)*(byte *)(param_1 + 0xc9a) * 0x100 +
            (uint)*(byte *)(param_1 + 0xc99);
    uVar2 = 0xfffffff7;
    if (uVar4 < 0x20) {
      psLockMutex(&DAT_004d9f80);
      iVar5 = *(int *)(&DAT_004da010 + uVar4 * 0x6c);
      puVar3 = &DAT_004da014 + uVar4 * 0x1b;
      *(int *)(&DAT_004da010 + uVar4 * 0x6c) = iVar5 + -1;
      if (iVar5 + -1 == 0) {
        if (puVar3 == &DAT_004dad30) {
          _psTraceStr("psAssert %s","matrixssl.c");
          _psTraceInt(&DAT_0049016c,0x988);
          _psError("(&g_sessionChronList) != (&g_sessionTable[i].chronList)");
        }
        puVar1 = DAT_004dad34;
        *puVar3 = &DAT_004dad30;
        *DAT_004dad34 = puVar3;
        DAT_004dad34 = puVar3;
        (&DAT_004da018)[uVar4 * 0x1b] = puVar1;
      }
      if (param_2 != 0) {
        memset((void *)(param_1 + 0xc99),0,0x20);
        iVar5 = uVar4 * 0x6c;
        *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) & 0xfffffff7;
        *(undefined *)(param_1 + 0xc98) = 0;
        memset(&DAT_004d9fb4 + iVar5,0,0x1c);
        memset(&DAT_004d9fd0 + iVar5,0,0x30);
        *(undefined4 *)(&DAT_004da000 + iVar5) = 0;
        *(undefined2 *)(&DAT_004da006 + iVar5) = 0;
      }
      psUnlockMutex(&DAT_004d9f80);
      uVar2 = 0;
    }
  }
  return uVar2;
}



bool matrixSslHandshakeIsComplete(int param_1)

{
  return *(char *)(param_1 + 0xd38) == -1;
}



void matrixSslSetCertValidator(int param_1,int param_2)

{
  if ((param_1 != 0) && (param_2 != 0)) {
    *(int *)(param_1 + 0x25c) = param_2;
  }
  return;
}



uint matrixRegisterSession(int param_1)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  int iVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  
  uVar1 = 0xffffffff;
  if ((*(uint *)(param_1 + 0xd2c) & 1) != 0) {
    if ((*(int *)(param_1 + 0xcbc) != 0) && (*(short *)(*(int *)(param_1 + 0xcbc) + 0x5c) == 3)) {
      return 0;
    }
    if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (*(char *)(param_1 + 0xc98) != '\0')) {
      return 0;
    }
    psLockMutex(&DAT_004d9f80);
    puVar2 = DAT_004dad30;
    if ((undefined4 **)DAT_004dad30 != &DAT_004dad30) {
      DAT_004dad30 = (undefined4 *)*DAT_004dad30;
      DAT_004dad30[1] = &DAT_004dad30;
      uVar1 = (uint)*(byte *)((int)puVar2 + -0x61) * 0x1000000 +
              (uint)*(byte *)((int)puVar2 + -0x62) * 0x10000 +
              (uint)*(byte *)((int)puVar2 + -99) * 0x100 + (uint)*(byte *)(puVar2 + -0x19);
      if (uVar1 < 0x20) {
        puVar2 = (undefined4 *)(&DAT_004d9fd0 + uVar1 * 0x6c);
        puVar3 = (undefined4 *)(param_1 + 0x50);
        do {
          uVar7 = puVar3[1];
          uVar5 = puVar3[2];
          uVar4 = puVar3[3];
          *puVar2 = *puVar3;
          puVar2[1] = uVar7;
          puVar2[2] = uVar5;
          puVar3 = puVar3 + 4;
          puVar2[3] = uVar4;
          puVar2 = puVar2 + 4;
        } while (puVar3 != (undefined4 *)(param_1 + 0x80));
        iVar9 = uVar1 * 0x6c;
        *(undefined4 *)(&DAT_004da000 + iVar9) = *(undefined4 *)(param_1 + 0xd10);
        *(int *)(&DAT_004da010 + iVar9) = *(int *)(&DAT_004da010 + iVar9) + 1;
        uVar4 = *(undefined4 *)(param_1 + 0x44);
        uVar7 = *(undefined4 *)(param_1 + 0x48);
        uVar10 = *(undefined4 *)(param_1 + 0x40);
        uVar5 = *(undefined4 *)(param_1 + 0x34);
        uVar11 = *(undefined4 *)(param_1 + 0x38);
        uVar8 = *(undefined4 *)(param_1 + 0x3c);
        *(undefined4 *)(&DAT_004d9fb4 + iVar9) = *(undefined4 *)(param_1 + 0x30);
        *(undefined4 *)(&DAT_004d9fb8 + iVar9) = uVar5;
        *(undefined4 *)(&DAT_004d9fbc + iVar9) = uVar11;
        *(undefined4 *)(&DAT_004d9fc0 + iVar9) = uVar8;
        *(undefined4 *)(&DAT_004d9fc4 + iVar9) = uVar10;
        *(undefined4 *)(&DAT_004d9fc8 + iVar9) = uVar4;
        *(undefined4 *)(&DAT_004d9fcc + iVar9) = uVar7;
        *(undefined *)(param_1 + 0xc98) = 0x20;
        uVar8 = *(undefined4 *)(&DAT_004d9fc0 + iVar9);
        uVar10 = *(undefined4 *)(&DAT_004d9fc4 + iVar9);
        uVar6 = *(undefined4 *)(&DAT_004d9fc8 + iVar9);
        uVar11 = *(undefined4 *)(&DAT_004d9fcc + iVar9);
        uVar7 = *(undefined4 *)(&DAT_004d9fbc + iVar9);
        uVar5 = *(undefined4 *)(&DAT_004d9fb8 + iVar9);
        uVar4 = *(undefined4 *)(&DAT_004d9fb4 + iVar9);
        *(undefined4 *)(param_1 + 0xc99) = *(undefined4 *)(&DAT_004d9fb0 + iVar9);
        *(undefined4 *)(param_1 + 0xc9d) = uVar4;
        *(undefined4 *)(param_1 + 0xca1) = uVar5;
        *(undefined4 *)(param_1 + 0xca5) = uVar7;
        *(undefined4 *)(param_1 + 0xca9) = uVar8;
        *(undefined4 *)(param_1 + 0xcad) = uVar10;
        *(undefined4 *)(param_1 + 0xcb1) = uVar6;
        *(undefined4 *)(param_1 + 0xcb5) = uVar11;
        psGetTime(&DAT_004da008 + iVar9,*(undefined4 *)(param_1 + 0x1250));
        (&DAT_004da004)[iVar9] = *(undefined *)(param_1 + 0xd3d);
        (&DAT_004da005)[iVar9] = *(undefined *)(param_1 + 0xd3e);
        *(ushort *)(&DAT_004da006 + iVar9) =
             (ushort)((uint)*(undefined4 *)(param_1 + 0x1230) >> 0x11) & 1;
        psUnlockMutex(&DAT_004d9f80);
        return uVar1;
      }
    }
    psUnlockMutex(&DAT_004d9f80);
    uVar1 = 0xfffffff7;
  }
  return uVar1;
}



undefined4 matrixResumeSession(int param_1)

{
  int iVar1;
  byte bVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  int iVar9;
  uint uVar10;
  undefined4 local_28;
  undefined4 local_24;
  
  uVar3 = 0xfffffffa;
  if (((*(uint *)(param_1 + 0xd2c) & 1) != 0) && (*(char *)(param_1 + 0xc98) != '\0')) {
    uVar10 = (uint)*(byte *)(param_1 + 0xc9c) * 0x1000000 +
             (uint)*(byte *)(param_1 + 0xc9b) * 0x10000 + (uint)*(byte *)(param_1 + 0xc9a) * 0x100 +
             (uint)*(byte *)(param_1 + 0xc99);
    psLockMutex(&DAT_004d9f80);
    if ((uVar10 < 0x20) && (*(int *)(&DAT_004da000 + uVar10 * 0x6c) != 0)) {
      psGetTime(&local_28,*(undefined4 *)(param_1 + 0x1250));
      bVar2 = *(byte *)(param_1 + 0xc98);
      if (0x1f < bVar2) {
        bVar2 = 0x20;
      }
      iVar1 = memcmp(&DAT_004d9fb0 + uVar10 * 0x6c,(void *)(param_1 + 0xc99),(size_t)bVar2);
      if (iVar1 == 0) {
        iVar9 = uVar10 * 0x6c;
        iVar1 = psDiffMsecs(*(undefined4 *)(&DAT_004da008 + iVar9),
                            *(undefined4 *)(&DAT_004da00c + iVar9),local_28,local_24,
                            *(undefined4 *)(param_1 + 0x1250));
        if ((((iVar1 < 0x5265c01) && ((&DAT_004da004)[iVar9] == *(char *)(param_1 + 0xd3d))) &&
            ((&DAT_004da005)[iVar9] == *(char *)(param_1 + 0xd3e))) &&
           (((*(short *)(&DAT_004da006 + iVar9) != 0 ||
             ((*(uint *)(param_1 + 0x1230) >> 0x11 & 1) != 1)) &&
            ((*(short *)(&DAT_004da006 + uVar10 * 0x6c) != 1 ||
             ((*(uint *)(param_1 + 0x1230) >> 0x11 & 1) != 0)))))) {
          puVar7 = (undefined4 *)(&DAT_004d9fd0 + uVar10 * 0x6c);
          puVar8 = (undefined4 *)(param_1 + 0x50);
          do {
            uVar3 = *puVar7;
            uVar4 = puVar7[1];
            uVar5 = puVar7[2];
            uVar6 = puVar7[3];
            puVar7 = puVar7 + 4;
            *puVar8 = uVar3;
            puVar8[1] = uVar4;
            puVar8[2] = uVar5;
            puVar8[3] = uVar6;
            puVar8 = puVar8 + 4;
          } while (puVar7 != (undefined4 *)(&DAT_004da000 + uVar10 * 0x6c));
          iVar1 = uVar10 * 0x6c;
          iVar9 = *(int *)(&DAT_004da010 + iVar1);
          *(undefined4 *)(param_1 + 0xd10) = *(undefined4 *)(&DAT_004da000 + iVar1);
          *(int *)(&DAT_004da010 + iVar1) = iVar9 + 1;
          if (iVar9 + 1 == 1) {
            iVar1 = (&DAT_004da014)[uVar10 * 0x1b];
            *(undefined4 *)(iVar1 + 4) = (&DAT_004da018)[uVar10 * 0x1b];
            *(int *)(&DAT_004da018)[uVar10 * 0x1b] = iVar1;
          }
          psUnlockMutex(&DAT_004d9f80);
          return 0;
        }
      }
      psUnlockMutex(&DAT_004d9f80);
      return 0xffffffff;
    }
    psUnlockMutex(&DAT_004d9f80);
    uVar3 = 0xfffffff7;
  }
  return uVar3;
}



undefined4 matrixSessionTicketLen(void)

{
  return 0x80;
}



int matrixCreateSessionTicket(int param_1,undefined *param_2,int *param_3)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  undefined auStack_208 [8];
  undefined auStack_200 [280];
  undefined auStack_e8 [176];
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  
  iVar3 = -9;
  if (0x85 < *param_3) {
    param_2[1] = 1;
    param_2[2] = 0x51;
    param_2[3] = 0x80;
    param_2[5] = 0x80;
    *param_2 = 0;
    param_2[4] = 0;
    uVar1 = psGetTime(auStack_208,*(undefined4 *)(param_1 + 0x1250));
    psGetPrngLocked(&local_38,0x10,*(undefined4 *)(param_1 + 0x1250));
    psLockMutex(&DAT_004d9f98);
    puVar8 = *(undefined4 **)(*(int *)(param_1 + 0xc48) + 0x80);
    uVar5 = puVar8[1];
    uVar4 = puVar8[2];
    uVar9 = puVar8[3];
    *(undefined4 *)(param_2 + 6) = *puVar8;
    *(undefined4 *)(param_2 + 10) = uVar5;
    *(undefined4 *)(param_2 + 0xe) = uVar4;
    *(undefined4 *)(param_2 + 0x12) = uVar9;
    *(undefined4 *)(param_2 + 0x16) = local_38;
    *(undefined4 *)(param_2 + 0x1a) = local_34;
    *(undefined4 *)(param_2 + 0x1e) = local_30;
    *(undefined4 *)(param_2 + 0x22) = local_2c;
    puVar7 = (undefined4 *)(param_2 + 0x2b);
    param_2[0x26] = *(undefined *)(param_1 + 0xd3d);
    param_2[0x27] = *(undefined *)(param_1 + 0xd3e);
    puVar6 = (undefined4 *)(param_1 + 0x50);
    param_2[0x28] = (char)((ushort)**(undefined2 **)(param_1 + 0xd10) >> 8);
    param_2[0x29] = (char)**(undefined2 **)(param_1 + 0xd10);
    param_2[0x2a] = (byte)(*(uint *)(param_1 + 0x1230) >> 0x11) & 1;
    do {
      uVar5 = puVar6[1];
      uVar4 = puVar6[2];
      uVar9 = puVar6[3];
      *puVar7 = *puVar6;
      puVar7[1] = uVar5;
      puVar7[2] = uVar4;
      puVar6 = puVar6 + 4;
      puVar7[3] = uVar9;
      puVar7 = puVar7 + 4;
    } while (puVar6 != (undefined4 *)(param_1 + 0x80));
    param_2[0x5d] = (char)((uint)uVar1 >> 8);
    param_2[0x5e] = (char)uVar1;
    param_2[0x5b] = (char)((uint)uVar1 >> 0x18);
    param_2[0x5c] = (char)((uint)uVar1 >> 0x10);
    iVar2 = sslWritePad(param_2 + 0x5f,7);
    iVar3 = psAesInitCBC(auStack_200,param_2 + 0x16,puVar8 + 4,*(undefined *)((int)puVar8 + 0x52),1)
    ;
    if (-1 < iVar3) {
      psAesEncryptCBC(auStack_200,param_2 + 0x26,param_2 + 0x26,0x40);
      psAesClearCBC(auStack_200);
      iVar3 = psHmacSha256Init(auStack_e8,puVar8 + 0xc,*(undefined2 *)(puVar8 + 0x15));
      if (-1 < iVar3) {
        psHmacSha256Update(auStack_e8,param_2 + 6,0x60);
        psHmacSha256Final(auStack_e8,param_2 + 0x5f + iVar2);
        iVar3 = 0;
        *param_3 = 0x86;
      }
    }
    memset_s(&local_38,0x10,0,0x10);
    psUnlockMutex(&DAT_004d9f98);
  }
  return iVar3;
}



undefined4 matrixUnlockSessionTicket(int param_1,undefined4 *param_2,int param_3)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  void *__s1;
  undefined4 uVar8;
  void *pvVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  undefined auStack_230 [176];
  undefined auStack_180 [32];
  undefined auStack_160 [280];
  undefined auStack_48 [8];
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  void *local_30;
  
  if (param_3 != 0x80) {
    return 0xffffffff;
  }
  psLockMutex(&DAT_004d9f98);
  local_40 = *param_2;
  local_3c = param_2[1];
  local_38 = param_2[2];
  local_34 = param_2[3];
  iVar11 = *(int *)(param_1 + 0xc48);
  local_30 = (void *)0x0;
  pvVar9 = *(void **)(iVar11 + 0x80);
  iVar12 = 0;
  if (pvVar9 != (void *)0x0) {
    do {
      iVar5 = memcmp(pvVar9,&local_40,0x10);
      if (iVar5 == 0) {
        iVar5 = *(int *)(iVar11 + 0x84);
        *(undefined2 *)((int)pvVar9 + 0x56) = 1;
        iVar12 = 1;
        local_30 = pvVar9;
        if (iVar5 == 0) goto LAB_00447874;
        break;
      }
      pvVar9 = *(void **)((int)pvVar9 + 0x58);
    } while (pvVar9 != (void *)0x0);
  }
  if (*(int *)(iVar11 + 0x84) != 0) {
    psUnlockMutex(&DAT_004d9f98);
    iVar11 = (**(code **)(*(int *)(param_1 + 0xc48) + 0x84))
                       (*(int *)(param_1 + 0xc48),&local_40,iVar12);
    psLockMutex(&DAT_004d9f98);
    if (iVar11 < 0) {
      if (pvVar9 != (void *)0x0) {
        *(undefined2 *)((int)pvVar9 + 0x56) = 0;
      }
    }
    else {
      if (iVar12 != 0) {
LAB_00447874:
        psHmacSha256Init(auStack_230,(int)local_30 + 0x30,*(undefined2 *)((int)local_30 + 0x54));
        psHmacSha256Update(auStack_230,param_2,0x60);
        psHmacSha256Final(auStack_230,auStack_180);
        psAesInitCBC(auStack_160,param_2 + 4,(int)local_30 + 0x10,
                     *(undefined *)((int)local_30 + 0x52),2);
        psAesDecryptCBC(auStack_160,param_2 + 8,param_2 + 8,0x40);
        psAesClearCBC(auStack_160);
        *(undefined2 *)((int)local_30 + 0x56) = 0;
        psUnlockMutex(&DAT_004d9f98);
        iVar11 = memcmp(auStack_180,param_2 + 0x18,0x20);
        if (iVar11 != 0) {
          return 0xffffffff;
        }
        if (*(char *)(param_1 + 0xd3d) != *(char *)(param_2 + 8)) {
          return 0xffffffff;
        }
        if (*(char *)(param_1 + 0xd3e) != *(char *)((int)param_2 + 0x21)) {
          return 0xffffffff;
        }
        uVar10 = (uint)*(byte *)((int)param_2 + 0x22) * 0x100 + (uint)*(byte *)((int)param_2 + 0x23)
        ;
        iVar11 = sslGetCipherSpec(param_1,uVar10 & 0xffff);
        *(int *)(param_1 + 0xd10) = iVar11;
        if (iVar11 == 0) {
          return 0xffffffff;
        }
        if ((*(byte *)(param_2 + 9) == 0) && ((*(uint *)(param_1 + 0x1230) >> 0x16 & 1) == 1)) {
          return 0xffffffff;
        }
        *(uint *)(param_1 + 0x1230) =
             *(uint *)(param_1 + 0x1230) & 0xffbfffff | (*(byte *)(param_2 + 9) & 1) << 0x16;
        puVar7 = (undefined4 *)(*(int *)(param_1 + 0xcbc) + 0x24);
        puVar6 = (undefined4 *)((int)param_2 + 0x25);
        do {
          uVar15 = *puVar6;
          uVar8 = puVar6[1];
          uVar14 = puVar6[2];
          uVar13 = puVar6[3];
          puVar6 = puVar6 + 4;
          *puVar7 = uVar15;
          puVar7[1] = uVar8;
          puVar7[2] = uVar14;
          puVar7[3] = uVar13;
          puVar7 = puVar7 + 4;
        } while (puVar6 != (undefined4 *)((int)param_2 + 0x55));
        bVar1 = *(byte *)(undefined4 *)((int)param_2 + 0x55);
        bVar2 = *(byte *)((int)param_2 + 0x56);
        bVar3 = *(byte *)((int)param_2 + 0x57);
        bVar4 = *(byte *)(param_2 + 0x16);
        iVar11 = psGetTime(auStack_48,*(undefined4 *)(param_1 + 0x1250));
        if (0x15180 < iVar11 - ((uint)bVar1 * 0x1000000 + (uint)bVar2 * 0x10000 +
                                (uint)bVar3 * 0x100 + (uint)bVar4)) {
          return 0xffffffff;
        }
        *(uint *)(*(int *)(param_1 + 0xcbc) + 0x54) = uVar10;
        return 0;
      }
      pvVar9 = *(void **)(*(int *)(param_1 + 0xc48) + 0x80);
      if (pvVar9 != (void *)0x0) {
        do {
          __s1 = pvVar9;
          pvVar9 = *(void **)((int)__s1 + 0x58);
        } while (*(void **)((int)__s1 + 0x58) != (void *)0x0);
        iVar11 = memcmp(__s1,param_2,0x10);
        if (iVar11 == 0) {
          *(undefined2 *)((int)__s1 + 0x56) = 1;
          local_30 = __s1;
          goto LAB_00447874;
        }
      }
    }
  }
  psUnlockMutex(&DAT_004d9f98);
  return 0xffffffff;
}



undefined4 matrixSslGetSessionId(int param_1,int param_2)

{
  ushort *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  
  if (((param_1 == 0) || ((*(uint *)(param_1 + 0xd2c) & 1) != 0)) || (param_2 == 0)) {
    uVar4 = 0xfffffffa;
  }
  else {
    puVar1 = *(ushort **)(param_1 + 0xd10);
    if (puVar1 == (ushort *)0x0) {
      return 0xffffffff;
    }
    if ((*puVar1 == 0) || (*(char *)(param_1 + 0xc98) != ' ')) {
      if (puVar1 == (ushort *)0x0) {
        return 0xffffffff;
      }
      if (*puVar1 == 0) {
        return 0xffffffff;
      }
      if (*(int *)(param_2 + 0x58) == 0) {
        return 0xffffffff;
      }
      puVar3 = (undefined4 *)(param_2 + 0x24);
      if (*(short *)(param_2 + 0x5e) == 0) {
        return 0xffffffff;
      }
      *(uint *)(param_2 + 0x54) = (uint)*puVar1;
      puVar2 = (undefined4 *)(param_1 + 0x50);
      do {
        uVar7 = *puVar2;
        uVar6 = puVar2[1];
        uVar5 = puVar2[2];
        uVar4 = puVar2[3];
        puVar2 = puVar2 + 4;
        *puVar3 = uVar7;
        puVar3[1] = uVar6;
        puVar3[2] = uVar5;
        puVar3[3] = uVar4;
        puVar3 = puVar3 + 4;
      } while (puVar2 != (undefined4 *)(param_1 + 0x80));
      uVar4 = 0;
    }
    else if ((*(int *)(param_2 + 0x58) == 0) || (uVar4 = 0, *(short *)(param_2 + 0x5e) == 0)) {
      *(uint *)(param_2 + 0x54) = (uint)*puVar1;
      memcpy((void *)(param_2 + 4),(void *)(param_1 + 0xc99),(size_t)*(undefined *)(param_1 + 0xc98)
            );
      puVar2 = (undefined4 *)(param_2 + 0x24);
      puVar3 = (undefined4 *)(param_1 + 0x50);
      do {
        uVar7 = *puVar3;
        uVar6 = puVar3[1];
        uVar4 = puVar3[2];
        uVar5 = puVar3[3];
        puVar3 = puVar3 + 4;
        *puVar2 = uVar7;
        puVar2[1] = uVar6;
        puVar2[2] = uVar4;
        puVar2[3] = uVar5;
        puVar2 = puVar2 + 4;
      } while (puVar3 != (undefined4 *)(param_1 + 0x80));
      uVar4 = 0;
    }
  }
  return uVar4;
}



// WARNING: Removing unreachable block (ram,0x00447d54)

undefined4 matrixServerSetKeysSNI(int param_1)

{
  undefined4 uVar1;
  
  uVar1 = 0;
  if (*(code **)(param_1 + 0xcd4) != (code *)0x0) {
    *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x8000;
    (**(code **)(param_1 + 0xcd4))();
    uVar1 = 0xfffffff6;
  }
  return uVar1;
}



void sslResetContext(int param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = *(uint *)(param_1 + 0xd2c);
  uVar2 = uVar1 & 1;
  if (uVar2 == 0) {
    *(undefined4 *)(param_1 + 0xcd8) = *(undefined4 *)(param_1 + 0xc40);
    *(undefined4 *)(param_1 + 0xce0) = *(undefined4 *)(param_1 + 0xcfc);
    *(uint *)(param_1 + 0xcdc) = uVar1;
  }
  *(undefined4 *)(param_1 + 0xc40) = 0;
  if (uVar2 != 0) {
    matrixClearSession(param_1,0,uVar1,uVar2,&_gp);
    uVar1 = *(uint *)(param_1 + 0xd2c);
  }
  *(uint *)(param_1 + 0xd2c) = uVar1 & 0xfff07fff;
  if (((uVar1 & 0xfff07fff) >> 0xe & 1) != 0) {
    *(undefined2 *)(param_1 + 0xe02) = 0;
  }
  *(undefined4 *)(param_1 + 0xcfc) = 0;
  return;
}



int matrixValidateCertsExt
              (undefined4 param_1,int param_2,int param_3,char *param_4,undefined4 *param_5,
              undefined4 param_6,undefined4 param_7,uint *param_8)

{
  bool bVar1;
  ushort uVar2;
  bool bVar3;
  size_t sVar4;
  char *pcVar5;
  uint uVar6;
  char *pcVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  char acStack_38 [15];
  undefined local_29;
  
  iVar11 = 0;
  if (((param_8[2] & 1) != 0) && (2 < *param_8)) {
    return -6;
  }
  if (((param_8[1] & 1) != 0) &&
     ((param_4 != (char *)0x0 && (iVar9 = psX509ValidateGeneralName(param_4), iVar9 < 0)))) {
    return -6;
  }
  *param_5 = 0;
  if (param_3 == 0) {
    iVar11 = psX509AuthenticateCert(param_1,param_2,0,param_5,param_6,param_7);
    return iVar11;
  }
  iVar9 = *(int *)(param_2 + 0x31c);
  iVar10 = param_2;
  if (iVar9 != 0) {
    iVar8 = *(int *)(iVar9 + 0x31c);
    while (iVar8 != 0) {
      iVar8 = psX509AuthenticateCert(param_1,iVar10,iVar9,param_5,param_6,param_7);
      if (iVar8 < 0) {
        return iVar8;
      }
      bVar3 = *(int *)(iVar9 + 0x1d4) < iVar11;
      iVar11 = iVar11 + 1;
      if ((-1 < *(int *)(iVar9 + 0x1d4)) && (bVar3)) goto LAB_0044808c;
      iVar10 = *(int *)(iVar10 + 0x31c);
      iVar9 = *(int *)(iVar10 + 0x31c);
      iVar8 = *(int *)(iVar9 + 0x31c);
    }
    iVar8 = psX509AuthenticateCert(param_1,iVar10,iVar9,param_5,param_6,param_7);
    if (iVar8 < 0) {
      return iVar8;
    }
    if ((-1 < *(int *)(iVar9 + 0x1d4)) && (*(int *)(iVar9 + 0x1d4) < iVar11)) {
LAB_0044808c:
      *(undefined4 *)(iVar10 + 0x2b0) = 0xffffffda;
      return -0x26;
    }
    iVar10 = *(int *)(iVar10 + 0x31c);
    iVar11 = iVar11 + 1;
  }
  *param_5 = 0;
  if (param_3 != 0) {
    do {
      *(undefined4 *)(iVar10 + 0x2b0) = 0;
      iVar9 = psX509AuthenticateCert(param_1,iVar10,param_3,param_5,param_6,param_7);
      if (iVar9 == 0) {
        iVar9 = *(int *)(param_3 + 0x1d4);
        if (-1 < iVar9) {
          if ((uint)*(ushort *)(param_3 + 0x14) == (uint)*(ushort *)(iVar10 + 0x14)) {
            iVar8 = memcmp(*(void **)(param_3 + 0x10),*(void **)(iVar10 + 0x10),
                           (uint)*(ushort *)(param_3 + 0x14));
            bVar3 = iVar9 < iVar11;
            if ((iVar8 == 0) && (bVar1 = 0 < iVar11, iVar11 = iVar11 + -1, bVar1))
            goto LAB_00448148;
          }
          else {
LAB_00448148:
            bVar3 = iVar9 < iVar11;
          }
          if (bVar3) goto LAB_0044808c;
        }
        iVar11 = 0;
        if (((*(uint *)(param_2 + 0x1e0) >> 0xc & 1) != 0) &&
           ((*(uint *)(param_2 + 0x1e8) & 6) == 0)) {
          _psTrace("End-entity certificate not for TLS usage!\n");
          *(undefined4 *)(param_2 + 0x2b0) = 0xffffffdb;
          iVar11 = -0x25;
          *(uint *)(param_2 + 0x2b4) = *(uint *)(param_2 + 0x2b4) | 2;
        }
        if (param_4 == (char *)0x0) {
          return iVar11;
        }
        if ((param_8[1] >> 1 & 1) != 0) {
          return iVar11;
        }
        iVar9 = *(int *)(param_2 + 0x1d8);
        bVar3 = false;
        if (iVar9 == 0) {
          uVar12 = *param_8;
          goto LAB_00448338;
        }
        uVar12 = *param_8;
        goto LAB_004481ec;
      }
      if (iVar9 == -8) {
        return -8;
      }
      param_3 = *(int *)(param_3 + 0x31c);
    } while (param_3 != 0);
  }
  return -0x24;
LAB_004481ec:
  do {
    uVar6 = *(uint *)(iVar9 + 4);
    if (uVar6 == 2) {
      bVar3 = true;
      if ((uVar12 < 2) || (uVar12 == 3)) {
        pcVar7 = *(char **)(iVar9 + 0x38);
        if (*pcVar7 == '*') {
          if (((pcVar7[1] == '.') && (pcVar5 = strchr(param_4,0x40), pcVar5 == (char *)0x0)) &&
             (pcVar5 = strchr(param_4,0x2e), pcVar5 != (char *)0x0)) {
            iVar10 = strcasecmp(pcVar7 + 1,pcVar5);
            goto LAB_00448314;
          }
        }
        else if (*pcVar7 != '.') {
          iVar10 = strcasecmp(pcVar7,param_4);
LAB_00448314:
          bVar3 = true;
          if (iVar10 == 0) {
            return iVar11;
          }
        }
      }
    }
    else if (uVar6 < 3) {
      if ((uVar6 == 1) && ((bVar3 = true, uVar12 == 0 || (uVar12 == 4)))) {
        if ((param_8[2] >> 1 & 1) == 0) {
          uVar6 = (uint)*(ushort *)(iVar9 + 0x3e);
          pcVar7 = *(char **)(iVar9 + 0x38);
          sVar4 = strlen(param_4);
          if (sVar4 == uVar6) {
            sVar4 = 0;
            pcVar5 = pcVar7;
            if (uVar6 != 0) {
              do {
                if (*pcVar5 == '@') break;
                sVar4 = sVar4 + 1;
                pcVar5 = pcVar7 + sVar4;
              } while ((int)sVar4 < (int)uVar6);
            }
            iVar10 = strncmp(pcVar7,param_4,sVar4);
            if (iVar10 == 0) {
              iVar10 = strcasecmp(pcVar7 + sVar4,param_4 + sVar4);
              goto LAB_00448314;
            }
          }
        }
        else {
          uVar2 = *(ushort *)(iVar9 + 0x3e);
          pcVar7 = *(char **)(iVar9 + 0x38);
          sVar4 = strlen(param_4);
          if (sVar4 == uVar2) {
            iVar10 = strcasecmp(pcVar7,param_4);
            goto LAB_00448314;
          }
        }
      }
    }
    else if ((uVar6 == 7) && ((bVar3 = true, uVar12 == 0 || (uVar12 == 5)))) {
      snprintf(acStack_38,0xf,"%u.%u.%u.%u",(uint)**(byte **)(iVar9 + 0x38),
               (uint)(*(byte **)(iVar9 + 0x38))[1],(uint)*(byte *)(*(int *)(iVar9 + 0x38) + 2),
               (uint)*(byte *)(*(int *)(iVar9 + 0x38) + 3));
      local_29 = 0;
      iVar10 = strcmp(acStack_38,param_4);
      if (iVar10 == 0) {
        return iVar11;
      }
      uVar12 = *param_8;
    }
    iVar9 = *(int *)(iVar9 + 0x40);
  } while (iVar9 != 0);
LAB_00448338:
  if ((((uVar12 == 0) || (uVar12 == 2)) || (uVar12 == 1)) && ((!bVar3 || ((param_8[2] & 1) != 0))))
  {
    pcVar7 = *(char **)(param_2 + 0x140);
    if (*pcVar7 == '*') {
      if (((pcVar7[1] != '.') || (pcVar5 = strchr(param_4,0x40), pcVar5 != (char *)0x0)) ||
         (pcVar5 = strchr(param_4,0x2e), pcVar5 == (char *)0x0)) goto LAB_00448350;
      iVar9 = strcasecmp(pcVar7 + 1,pcVar5);
    }
    else {
      if (*pcVar7 == '.') goto LAB_00448350;
      iVar9 = strcasecmp(pcVar7,param_4);
    }
    if (iVar9 == 0) {
      return iVar11;
    }
  }
LAB_00448350:
  *(undefined4 *)(param_2 + 0x2b0) = 0xffffffdb;
  *(uint *)(param_2 + 0x2b4) = *(uint *)(param_2 + 0x2b4) | 4;
  return -0x25;
}



undefined4
matrixUserCertValidator
          (undefined4 param_1,int param_2,undefined4 param_3,code *UNRECOVERED_JUMPTABLE)

{
  undefined4 uVar1;
  int iVar2;
  
  if (UNRECOVERED_JUMPTABLE != (code *)0x0) {
    iVar2 = 0;
    if (param_2 != 0xff) {
      iVar2 = param_2;
    }
                    // WARNING: Could not recover jumptable at 0x00448630. Too many branches
                    // WARNING: Treating indirect jump as call
    uVar1 = (*UNRECOVERED_JUMPTABLE)(param_1,param_3,iVar2);
    return uVar1;
  }
  return 0;
}



undefined4 matrixSslNewServerSession(int *param_1,undefined4 param_2,int param_3,int param_4)

{
  short sVar1;
  undefined4 uVar2;
  uint uVar3;
  int iVar4;
  int local_18 [2];
  
  uVar2 = 0xfffffffa;
  if ((param_1 != (int *)0x0) && (param_4 != 0)) {
    uVar3 = *(uint *)(param_4 + 0x14);
    *param_1 = 0;
    local_18[0] = 0;
    if (param_3 == 0) {
      *(uint *)(param_4 + 0x14) = uVar3 | 1;
      iVar4 = matrixSslNewSession(local_18);
      if (iVar4 < 0) goto LAB_0044875c;
    }
    else {
      *(uint *)(param_4 + 0x14) = uVar3 | 0x81;
      iVar4 = matrixSslNewSession(local_18,param_2,0);
      if (iVar4 < 0) {
LAB_0044875c:
        if (local_18[0] != 0) {
          matrixSslDeleteSession();
        }
        return 0xffffffff;
      }
      matrixSslSetCertValidator(local_18[0],param_3);
    }
    uVar2 = *(undefined4 *)(param_4 + 0x1c);
    sVar1 = *(short *)(param_4 + 2);
    *(uint *)(local_18[0] + 0x1240) = *(uint *)(local_18[0] + 0x1240) | 2;
    *(undefined4 *)(local_18[0] + 0x1250) = uVar2;
    if (sVar1 < 0) {
      *(uint *)(local_18[0] + 0x1230) = *(uint *)(local_18[0] + 0x1230) | 0x2000;
      sVar1 = *(short *)(param_4 + 4);
      *(undefined4 *)(local_18[0] + 0xd00) = 0x4000;
    }
    else {
      sVar1 = *(short *)(param_4 + 4);
      *(undefined4 *)(local_18[0] + 0xd00) = 0x4000;
    }
    if (sVar1 < 0) {
      *(uint *)(local_18[0] + 0x1230) = *(uint *)(local_18[0] + 0x1230) | 0x1000;
    }
    if (0 < *(short *)(param_4 + 6)) {
      *(uint *)(local_18[0] + 0x1230) = *(uint *)(local_18[0] + 0x1230) | 0x400000;
    }
    uVar2 = 0;
    *param_1 = local_18[0];
  }
  return uVar2;
}



int matrixSslGetReadbuf(int param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar1 = -6;
  if ((param_1 != 0) && (param_2 != (int *)0x0)) {
    iVar1 = *(int *)(param_1 + 0xcf4);
    if ((iVar1 < 1) || (iVar2 = *(int *)(param_1 + 0xce4), iVar2 == 0)) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x27f);
      _psError("ssl && ssl->insize > 0 && ssl->inbuf != NULL");
      iVar2 = *(int *)(param_1 + 0xce4);
      iVar1 = *(int *)(param_1 + 0xcf4);
    }
    iVar3 = *(int *)(param_1 + 0xcec);
    *param_2 = iVar2 + iVar3;
    iVar1 = iVar1 - iVar3;
  }
  return iVar1;
}



undefined4 matrixSslGetOutdata(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  uVar1 = 0xfffffffa;
  if (param_1 != 0) {
    if ((*(int *)(param_1 + 0xcf8) < 1) || (*(int *)(param_1 + 0xce8) == 0)) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x2cd);
      _psError("ssl->outsize > 0 && ssl->outbuf != NULL");
    }
    if (param_2 != (undefined4 *)0x0) {
      *param_2 = *(undefined4 *)(param_1 + 0xce8);
    }
    uVar1 = *(undefined4 *)(param_1 + 0xcf0);
  }
  return uVar1;
}



uint matrixSslGetWritebuf(int param_1,int *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  void *pvVar5;
  int iVar6;
  
  if ((param_1 == 0) || (param_2 == (int *)0x0)) {
    return 0xfffffffa;
  }
  if ((*(int *)(param_1 + 0xcf8) < 1) || (*(int *)(param_1 + 0xce8) == 0)) {
    _psTraceStr("psAssert %s","matrixsslApi.c");
    _psTraceInt(&DAT_0049016c,0x2f4);
    _psError("ssl->outsize > 0 && ssl->outbuf != NULL");
  }
  if ((((*(uint *)(param_1 + 0xd2c) & 1) == 0) && (*(char *)(param_1 + 0xd3d) == '\x03')) &&
     (*(byte *)(param_1 + 0xd3e) < 2)) {
    uVar2 = (uint)*(byte *)(param_1 + 0xd27);
    if (((1 < uVar2) && (1 < param_3)) && ((*(uint *)(param_1 + 0xcfc) >> 2 & 1) == 0)) {
      *(uint *)(param_1 + 0xcfc) = *(uint *)(param_1 + 0xcfc) | 4;
    }
  }
  else {
    uVar2 = (uint)*(byte *)(param_1 + 0xd27);
  }
  if (*(uint *)(param_1 + 0xd00) < param_3) {
    param_3 = *(uint *)(param_1 + 0xd00);
  }
  uVar2 = matrixSslGetEncodedSize(param_1,uVar2 + param_3);
  if (uVar2 < param_3) {
    _psTraceStr("psAssert %s","matrixsslApi.c");
    _psTraceInt(&DAT_0049016c,0x31c);
    _psError("requiredLen >= requestedLen");
  }
  iVar6 = uVar2 - param_3;
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (uVar1 = matrixDtlsGetPmtu(), uVar1 < uVar2)
     ) {
    iVar6 = matrixSslGetEncodedSize(param_1,0);
    iVar6 = iVar6 + (uint)*(byte *)(param_1 + 0xd27);
    uVar2 = matrixSslGetEncodedSize(param_1,uVar1 - iVar6);
  }
  iVar3 = *(int *)(param_1 + 0xcf8);
  iVar4 = *(int *)(param_1 + 0xcf0);
  if (iVar4 <= iVar3) {
    uVar1 = iVar3 - iVar4;
    if (uVar1 < uVar2) {
      pvVar5 = realloc(*(void **)(param_1 + 0xce8),iVar3 + (uVar2 - uVar1));
      if (pvVar5 == (void *)0x0) {
        return 0xfffffff8;
      }
      iVar4 = *(int *)(param_1 + 0xcf0);
      iVar3 = *(int *)(param_1 + 0xcf8) + (uVar2 - uVar1);
      *(void **)(param_1 + 0xce8) = pvVar5;
      *(int *)(param_1 + 0xcf8) = iVar3;
      uVar1 = iVar3 - iVar4;
      if (iVar3 < iVar4) {
        return 0xffffffff;
      }
    }
    else {
      pvVar5 = *(void **)(param_1 + 0xce8);
    }
    uVar2 = *(uint *)(param_1 + 0xd00);
    if ((param_3 <= uVar2) && (param_3 = uVar1 - iVar6, uVar2 < uVar1 - iVar6)) {
      param_3 = uVar2;
    }
    uVar2 = *(uint *)(param_1 + 0xd2c);
    if ((((uVar2 >> 2 & 1) == 0) || ((uVar2 >> 0xc & 1) == 0)) || (*(byte *)(param_1 + 0xd27) < 2))
    {
      if ((uVar2 >> 0x14 & 1) == 0) {
        if ((*(uint *)(param_1 + 0xcfc) >> 2 & 1) == 0) {
          *param_2 = (int)pvVar5 + *(int *)(param_1 + 0x1234) + iVar4;
        }
        else {
          uVar2 = (uint)*(byte *)(param_1 + 0xd27);
          if (uVar2 == 0) {
            trap(0x1c00);
          }
          uVar1 = uVar2;
          if ((*(byte *)(param_1 + 0xd24) + 1) % uVar2 == 0) {
            uVar1 = 0;
          }
          if (uVar2 == 0) {
            trap(0x1c00);
          }
          *param_2 = (int)pvVar5 +
                     uVar2 * ((*(byte *)(param_1 + 0xd24) + 1) / uVar2) +
                     uVar1 + *(int *)(param_1 + 0x1234) * 2 + iVar4 + -1;
        }
        return param_3;
      }
      iVar6 = (int)pvVar5 + *(int *)(param_1 + 0x1234) + iVar4;
      if ((uVar2 >> 0x16 & 1) != 0) {
        iVar6 = iVar6 + 8;
      }
    }
    else {
      iVar6 = (int)pvVar5 + (uint)*(byte *)(param_1 + 0xd27) + *(int *)(param_1 + 0x1234) + iVar4;
    }
    *param_2 = iVar6;
    return param_3;
  }
  return 0xffffffff;
}



int matrixSslEncodeWritebuf(int param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  int local_res4 [3];
  
  if ((param_1 == 0) || (param_2 < 0)) {
    return -6;
  }
  if ((*(uint *)(param_1 + 0xcfc) & 1) != 0) {
    return -0xc;
  }
  local_res4[0] = param_2;
  if ((*(int *)(param_1 + 0xcf8) < 1) || (iVar1 = *(int *)(param_1 + 0xce8), iVar1 == 0)) {
    _psTraceStr("psAssert %s","matrixsslApi.c");
    _psTraceInt(&DAT_0049016c,0x3b4);
    _psError("ssl->outsize > 0 && ssl->outbuf != NULL");
    iVar1 = *(int *)(param_1 + 0xce8);
  }
  iVar4 = *(int *)(param_1 + 0xcf0);
  if ((iVar1 != 0) && (local_res4[0] <= *(int *)(param_1 + 0xcf8) - iVar4)) {
    iVar3 = *(int *)(param_1 + 0x1234);
    if ((*(uint *)(param_1 + 0xcfc) >> 2 & 1) != 0) {
      uVar5 = (uint)*(byte *)(param_1 + 0xd27);
      if (uVar5 == 0) {
        trap(0x1c00);
      }
      uVar2 = uVar5;
      if ((*(byte *)(param_1 + 0xd24) + 1) % uVar5 == 0) {
        uVar2 = 0;
      }
      if (uVar5 == 0) {
        trap(0x1c00);
      }
      iVar3 = iVar3 * 2 + uVar2 + uVar5 * ((*(byte *)(param_1 + 0xd24) + 1) / uVar5) + -1;
    }
    uVar5 = *(uint *)(param_1 + 0xd2c);
    if ((((uVar5 >> 2 & 1) != 0) && ((uVar5 >> 0xc & 1) != 0)) && (1 < *(byte *)(param_1 + 0xd27)))
    {
      iVar3 = iVar3 + (uint)*(byte *)(param_1 + 0xd27);
    }
    if (((uVar5 >> 0x14 & 1) != 0) && ((uVar5 >> 0x16 & 1) != 0)) {
      iVar3 = iVar3 + 8;
    }
    iVar1 = matrixSslEncode(param_1,iVar1 + iVar4,*(int *)(param_1 + 0xcf8) - iVar4,
                            iVar1 + iVar4 + iVar3,local_res4);
    if (-1 < iVar1) {
      local_res4[0] = *(int *)(param_1 + 0xcf0) + local_res4[0];
      *(int *)(param_1 + 0xcf0) = local_res4[0];
      return local_res4[0];
    }
    if (iVar1 == -0x32) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x3dc);
      _psError("rc != SSL_FULL");
    }
  }
  return -1;
}



undefined4 matrixSslReceivedData(int param_1,int param_2,void **param_3,size_t *param_4)

{
  void *pvVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  size_t __size;
  int iVar5;
  undefined4 uVar6;
  undefined uStack_40;
  char local_3f [3];
  int local_3c;
  uint local_38;
  undefined4 local_34;
  void *local_30;
  size_t local_2c;
  
  if (((param_1 == 0) || (param_3 == (void **)0x0)) || (param_4 == (size_t *)0x0)) {
    return 0xfffffffa;
  }
  if ((*(int *)(param_1 + 0xcf8) < 1) || (*(int *)(param_1 + 0xce8) == 0)) {
    _psTraceStr("psAssert %s","matrixsslApi.c");
    _psTraceInt(&DAT_0049016c,0x486);
    _psError("ssl->outsize > 0 && ssl->outbuf != NULL");
  }
  if ((*(int *)(param_1 + 0xcf4) < 1) || (*(int *)(param_1 + 0xce4) == 0)) {
    _psTraceStr("psAssert %s","matrixsslApi.c");
    _psTraceInt(&DAT_0049016c,0x487);
    _psError("ssl->insize > 0 && ssl->inbuf != NULL");
  }
  *param_4 = 0;
  iVar4 = *(int *)(param_1 + 0xcec);
  *param_3 = (void *)0x0;
  iVar4 = iVar4 + param_2;
  *(int *)(param_1 + 0xcec) = iVar4;
  if (iVar4 == 0) {
    return 0;
  }
  local_30 = *(void **)(param_1 + 0xce4);
LAB_004491f8:
  iVar4 = matrixSslHandshakeIsComplete(param_1);
  pvVar1 = local_30;
  if (iVar4 == 0) {
    local_2c = *(size_t *)(param_1 + 0xcec);
    iVar4 = (int)local_2c / 9 + ((int)local_2c >> 0x1f);
  }
  else {
    local_2c = *(size_t *)(param_1 + 0xcec);
    iVar4 = (int)local_2c / 0x15 + ((int)local_2c >> 0x1f);
  }
  if (iVar4 - ((int)local_2c >> 0x1f) < 0) {
    return 0xfffffff4;
  }
  iVar4 = matrixSslDecode(param_1,&local_30,&local_2c,
                          *(int *)(param_1 + 0xcf4) - ((int)local_30 - *(int *)(param_1 + 0xce4)),
                          &local_3c,&local_38,&local_34,&uStack_40,local_3f);
  iVar5 = (int)local_30 - (int)pvVar1;
  uVar6 = 0xfffffff4;
  switch(iVar4) {
  case 0:
    iVar5 = *(int *)(param_1 + 0xcec) - iVar5;
    *(int *)(param_1 + 0xcec) = iVar5;
    if (iVar5 < 1) {
      uVar6 = 2;
      if (((*(uint *)(param_1 + 0xcfc) >> 1 & 1) == 0) &&
         (iVar5 = matrixSslHandshakeIsComplete(param_1), iVar5 != 0)) {
        *(uint *)(param_1 + 0xcfc) = *(uint *)(param_1 + 0xcfc) | 2;
        matrixSslGetSessionId(param_1,*(undefined4 *)(param_1 + 0xcbc));
        uVar6 = 5;
      }
      break;
    }
    pvVar1 = *(void **)(param_1 + 0xce4);
    if (local_30 <= pvVar1) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      uVar6 = 0x4b5;
      goto LAB_00449a74;
    }
LAB_004495e8:
    memmove(pvVar1,local_30,*(size_t *)(param_1 + 0xcec));
    local_30 = *(void **)(param_1 + 0xce4);
    goto LAB_004491f8;
  case -0x3d:
    iVar5 = *(int *)(param_1 + 0xcec) - iVar5;
    *(int *)(param_1 + 0xcec) = iVar5;
    if (iVar5 < 1) {
      return 1;
    }
    pvVar1 = *(void **)(param_1 + 0xce4);
    if (local_30 <= pvVar1) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      uVar6 = 0x4e2;
LAB_00449a74:
      _psTraceInt(&DAT_0049016c,uVar6);
      _psError("buf > ssl->inbuf");
      pvVar1 = *(void **)(param_1 + 0xce4);
    }
    goto LAB_004495e8;
  case -0x36:
    if ((((*(uint *)(param_1 + 0xd2c) >> 1 & 1) != 0) &&
        ((*(uint *)(param_1 + 0xd2c) >> 0xc & 1) != 0)) && (1 < *(byte *)(param_1 + 0xd27))) {
      pvVar1 = (void *)((int)pvVar1 + (uint)*(byte *)(param_1 + 0xd27));
    }
    if (local_2c != 2) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x55a);
      _psError("len == 2");
    }
    *param_4 = local_2c;
    iVar4 = *(int *)(param_1 + 0xcec);
    *param_3 = pvVar1;
    *(int *)(param_1 + 0xcec) = iVar4 - iVar5;
    return 6;
  case -0x35:
    if (((*(uint *)(param_1 + 0xcfc) >> 1 & 1) == 0) &&
       (iVar4 = matrixSslHandshakeIsComplete(param_1), iVar4 != 0)) {
      *(uint *)(param_1 + 0xcfc) = *(uint *)(param_1 + 0xcfc) | 2;
      matrixSslGetSessionId(param_1,*(undefined4 *)(param_1 + 0xcbc));
    }
    iVar5 = *(int *)(param_1 + 0xcec) - iVar5;
    *(int *)(param_1 + 0xcec) = iVar5;
    if (iVar5 != local_3c) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x5b3);
      _psError("(uint32) ssl->inlen == start");
    }
    if (*(char *)(param_1 + 0xd27) != *(char *)(param_1 + 0xd2b)) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x5bb);
      _psError("ssl->enBlockSize == ssl->deBlockSize");
    }
    if ((((*(uint *)(param_1 + 0xd2c) >> 1 & 1) == 0) ||
        ((*(uint *)(param_1 + 0xd2c) >> 0xc & 1) == 0)) ||
       (uVar2 = (uint)*(byte *)(param_1 + 0xd2b), uVar2 < 2)) {
      *param_4 = local_2c;
    }
    else {
      pvVar1 = (void *)((int)pvVar1 + uVar2);
      *param_4 = local_2c - uVar2;
    }
    uVar2 = *(uint *)(param_1 + 0xd2c);
    *param_3 = pvVar1;
    if ((uVar2 >> 0xe & 1) != 0) {
      *(undefined2 *)(param_1 + 0xe02) = 1;
    }
    return 4;
  case -0x34:
    *(undefined4 *)(param_1 + 0xcec) = 0;
    if (local_3f[0] != -1) {
      *(uint *)(param_1 + 0xcfc) = *(uint *)(param_1 + 0xcfc) | 1;
    }
    if (pvVar1 != local_30) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x516);
      _psError("prevBuf == buf");
    }
    if (*(int *)(param_1 + 0xcf4) < (int)local_2c) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x517);
      _psError("ssl->insize >= (int32) len");
    }
    if (local_3c != 0) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x518);
      _psError("start == 0");
    }
    if (*(void **)(param_1 + 0xce4) != local_30) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x519);
      _psError("buf == ssl->inbuf");
    }
    iVar5 = *(int *)(param_1 + 0xcf0);
    uVar6 = 1;
    if (iVar5 < 1) {
      local_30 = *(void **)(param_1 + 0xce8);
      uVar3 = *(undefined4 *)(param_1 + 0xcf8);
      *(undefined4 *)(param_1 + 0xce8) = *(undefined4 *)(param_1 + 0xce4);
      *(undefined4 *)(param_1 + 0xcf8) = *(undefined4 *)(param_1 + 0xcf4);
      *(undefined4 *)(param_1 + 0xcf4) = uVar3;
      *(void **)(param_1 + 0xce4) = local_30;
      *(size_t *)(param_1 + 0xcf0) = local_2c;
    }
    else {
      if (*(int *)(param_1 + 0xcf8) < (int)(iVar5 + local_2c)) {
        pvVar1 = realloc(*(void **)(param_1 + 0xce8),iVar5 + local_2c);
        if (pvVar1 == (void *)0x0) {
          return 0xfffffff8;
        }
        iVar5 = *(int *)(param_1 + 0xcf0);
        *(size_t *)(param_1 + 0xcf8) = iVar5 + local_2c;
        *(void **)(param_1 + 0xce8) = pvVar1;
      }
      else {
        pvVar1 = *(void **)(param_1 + 0xce8);
      }
      memcpy((void *)((int)pvVar1 + iVar5),*(void **)(param_1 + 0xce4),local_2c);
      *(size_t *)(param_1 + 0xcf0) = *(int *)(param_1 + 0xcf0) + local_2c;
      uVar6 = 1;
    }
    break;
  case -0x33:
    if (0x4805 < local_38) {
      return 0xfffffff8;
    }
    uVar6 = 2;
    if (*(uint *)(param_1 + 0xcf4) < local_38) {
      local_30 = realloc(*(void **)(param_1 + 0xce4),local_38);
      if (local_30 == (void *)0x0) {
        return 0xfffffff8;
      }
      *(uint *)(param_1 + 0xcf4) = local_38;
      uVar6 = 2;
      *(void **)(param_1 + 0xce4) = local_30;
    }
    break;
  case -0x32:
    goto switchD_004492cc_caseD_ffffffce;
  case -0xc:
    return local_34;
  }
  if ((0 < *(int *)(param_1 + 0xcec)) && (*(void **)(param_1 + 0xce4) != local_30)) {
    _psTraceStr("psAssert %s","matrixsslApi.c");
    _psTraceInt(&DAT_0049016c,0x5de);
    _psError("0");
  }
  if (iVar4 != -0x33) {
    __size = 0x5dc;
    if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
      __size = matrixDtlsGetPmtu();
    }
    if ((((int)__size < *(int *)(param_1 + 0xcf4)) && (*(int *)(param_1 + 0xcec) < (int)__size)) &&
       (pvVar1 = realloc(*(void **)(param_1 + 0xce4),__size), pvVar1 != (void *)0x0)) {
      *(size_t *)(param_1 + 0xcf4) = __size;
      *(void **)(param_1 + 0xce4) = pvVar1;
    }
  }
  return uVar6;
switchD_004492cc_caseD_ffffffce:
  if ((0x4805 < local_38) ||
     (((0x4000 < local_38 && (iVar4 = matrixSslHandshakeIsComplete(param_1), iVar4 == 0)) &&
      (0x4000 < local_38)))) {
    return 0xfffffff8;
  }
  *(undefined4 *)(param_1 + 0xcec) = 0;
  if (local_38 <= *(uint *)(param_1 + 0xcf4)) {
    return 0xfffffff4;
  }
  local_2c = (int)*(void **)(param_1 + 0xce4) - (int)local_30;
  pvVar1 = realloc(*(void **)(param_1 + 0xce4),local_38);
  if (pvVar1 == (void *)0x0) {
    return 0xfffffff8;
  }
  local_30 = (void *)((int)pvVar1 + local_2c);
  *(uint *)(param_1 + 0xcf4) = local_38;
  *(void **)(param_1 + 0xce4) = pvVar1;
  goto LAB_004491f8;
}



// WARNING: Switch with 1 destination removed at 0x00449dd4

undefined4 matrixSslProcessedData(ushort *param_1,uint *param_2,int *param_3)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  undefined4 uVar5;
  int iVar6;
  int iVar7;
  undefined4 uVar8;
  code *pcVar9;
  undefined uStack_40;
  char acStack_3f [3];
  int iStack_3c;
  uint uStack_38;
  undefined4 uStack_34;
  uint uStack_30;
  int aiStack_2c [3];
  undefined *local_20;
  
  local_20 = &_gp;
  if (((param_1 == (ushort *)0x0) || (param_2 == (uint *)0x0)) || (param_3 == (int *)0x0)) {
    return 0xfffffffa;
  }
  *param_3 = 0;
  iVar1 = *(int *)(param_1 + 0x67a);
  *param_2 = 0;
  if ((iVar1 < 1) || (*(int *)(param_1 + 0x672) == 0)) {
    _psTraceStr("psAssert %s","matrixsslApi.c");
    (**(code **)(local_20 + -0x7370))(*(int *)(local_20 + -0x7fe0) + 0x16c,0x606);
    (**(code **)(local_20 + -0x74a8))(*(int *)(local_20 + -0x7fe0) + 0x37c);
  }
  if (0 < *(int *)(param_1 + 0x676)) {
    iVar1 = (uint)*param_1 + *(int *)(param_1 + 0x91a);
    if ((*(uint *)(param_1 + 0x696) >> 0x15 & 1) != 0) {
      iVar6 = 8;
      if ((*(uint *)(*(int *)(param_1 + 0x688) + 4) >> 0xd & 1) == 0) {
        iVar6 = 0x10;
      }
      iVar1 = iVar1 + iVar6;
      if ((*(uint *)(param_1 + 0x696) >> 0x16 & 1) != 0) {
        iVar1 = iVar1 + 8;
      }
    }
    (**(code **)(local_20 + -0x6ee8))(*(int *)(param_1 + 0x672),*(int *)(param_1 + 0x672) + iVar1);
  }
  iVar1 = 0x5dc;
  if ((*(uint *)(param_1 + 0x696) >> 0xe & 1) != 0) {
    iVar1 = (**(code **)(local_20 + -0x76b8))();
  }
  if (iVar1 < *(int *)(param_1 + 0x67a)) {
    iVar6 = *(int *)(param_1 + 0x676);
    if (iVar1 <= iVar6) goto joined_r0x00449e60;
    iVar2 = (**(code **)(local_20 + -0x74d8))(*(undefined4 *)(param_1 + 0x672),iVar1);
    if (iVar2 != 0) {
      iVar6 = *(int *)(param_1 + 0x676);
      *(int *)(param_1 + 0x672) = iVar2;
      *(int *)(param_1 + 0x67a) = iVar1;
      goto joined_r0x00449e60;
    }
  }
  iVar6 = *(int *)(param_1 + 0x676);
joined_r0x00449e60:
  if (iVar6 < 1) {
    return 0;
  }
  iVar1 = *(int *)(local_20 + -0x6fc8);
  if (((param_1 == (ushort *)0x0) || (param_2 == (uint *)0x0)) || (param_3 == (int *)0x0)) {
    return 0xfffffffa;
  }
  if ((*(int *)(param_1 + 0x67c) < 1) || (*(int *)(param_1 + 0x674) == 0)) {
    (**(code **)(iVar1 + 0x8fabc))
              (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
    (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x486);
    (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x328);
  }
  if ((*(int *)(param_1 + 0x67a) < 1) || (*(int *)(param_1 + 0x672) == 0)) {
    (**(code **)(iVar1 + 0x8fabc))
              (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
    (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x487);
    (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x37c);
  }
  *param_3 = 0;
  iVar6 = *(int *)(param_1 + 0x676);
  *param_2 = 0;
  *(int *)(param_1 + 0x676) = iVar6;
  if (iVar6 == 0) {
    return 0;
  }
  uStack_30 = *(uint *)(param_1 + 0x672);
LAB_004491f8:
  iVar6 = (**(code **)(iVar1 + 0x8ee14))(param_1);
  uVar4 = uStack_30;
  if (iVar6 == 0) {
    aiStack_2c[0] = *(int *)(param_1 + 0x676);
    iVar6 = aiStack_2c[0] / 9 + (aiStack_2c[0] >> 0x1f);
  }
  else {
    aiStack_2c[0] = *(int *)(param_1 + 0x676);
    iVar6 = aiStack_2c[0] / 0x15 + (aiStack_2c[0] >> 0x1f);
  }
  if (iVar6 - (aiStack_2c[0] >> 0x1f) < 0) {
    return 0xfffffff4;
  }
  iVar6 = (**(code **)(iVar1 + 0x8f0d4))
                    (param_1,&uStack_30,aiStack_2c,
                     *(int *)(param_1 + 0x67a) - (uStack_30 - *(int *)(param_1 + 0x672)),&iStack_3c,
                     &uStack_38,&uStack_34,&uStack_40,acStack_3f);
  iVar2 = uStack_30 - uVar4;
  uVar8 = 0xfffffff4;
  if (0x3d < iVar6 + 0x3dU) goto switchD_004492cc_caseD_ffffffc4;
  switch(*(int *)((iVar6 + 0x3dU) * 4 + *(int *)(iVar1 + 0x8e970) + 0x460) + iVar1 + 0x96950 &
         0xfffffffe) {
  case 0x449330:
    if ((((*(uint *)(param_1 + 0x696) >> 1 & 1) != 0) &&
        ((*(uint *)(param_1 + 0x696) >> 0xc & 1) != 0)) && (1 < *(byte *)((int)param_1 + 0xd27))) {
      uVar4 = uVar4 + *(byte *)((int)param_1 + 0xd27);
    }
    if (aiStack_2c[0] != 2) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x55a);
      (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x3a4);
    }
    *param_3 = aiStack_2c[0];
    iVar1 = *(int *)(param_1 + 0x676);
    *param_2 = uVar4;
    *(int *)(param_1 + 0x676) = iVar1 - iVar2;
    return 6;
  case 0x4495c0:
    iVar7 = *(int *)(param_1 + 0x676);
    *(int *)(param_1 + 0x676) = iVar7 - iVar2;
    if (iVar7 - iVar2 < 1) {
      uVar8 = 2;
      if (((*(uint *)(param_1 + 0x67e) >> 1 & 1) == 0) &&
         (iVar2 = (**(code **)(iVar1 + 0x8ee14))(param_1), iVar2 != 0)) {
        pcVar9 = *(code **)(iVar1 + 0x8ee2c);
        *(uint *)(param_1 + 0x67e) = *(uint *)(param_1 + 0x67e) | 2;
        (*pcVar9)(param_1,*(undefined4 *)(param_1 + 0x65e));
        uVar8 = 5;
      }
      break;
    }
    uVar4 = *(uint *)(param_1 + 0x672);
    if (uStack_30 <= uVar4) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      uVar8 = 0x4b5;
      iVar6 = *(int *)(iVar1 + 0x8e970);
      pcVar9 = *(code **)(iVar1 + 0x8f5e0);
      goto LAB_00449a74;
    }
LAB_004495e8:
    (**(code **)(iVar1 + 0x8fa68))(uVar4,uStack_30,*(undefined4 *)(param_1 + 0x676));
    uStack_30 = *(uint *)(param_1 + 0x672);
    goto LAB_004491f8;
  case 0x449608:
    return uStack_34;
  case 0x449614:
    goto switchD_004492cc_caseD_ffffffce;
  case 0x449684:
    if (0x4805 < uStack_38) {
      return 0xfffffff8;
    }
    uVar8 = 2;
    if (*(uint *)(param_1 + 0x67a) < uStack_38) {
      uStack_30 = (**(code **)(iVar1 + 0x8f478))(*(undefined4 *)(param_1 + 0x672));
      if (uStack_30 == 0) {
        return 0xfffffff8;
      }
      *(uint *)(param_1 + 0x67a) = uStack_38;
      uVar8 = 2;
      *(uint *)(param_1 + 0x672) = uStack_30;
    }
    break;
  case 0x4496b4:
    *(undefined4 *)(param_1 + 0x676) = 0;
    if (acStack_3f[0] != -1) {
      *(uint *)(param_1 + 0x67e) = *(uint *)(param_1 + 0x67e) | 1;
    }
    if (uVar4 != uStack_30) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x516);
      (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x3b0);
    }
    if (*(int *)(param_1 + 0x67a) < aiStack_2c[0]) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x517);
      (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x43c);
    }
    if (iStack_3c != 0) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x518);
      (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x430);
    }
    if (*(uint *)(param_1 + 0x672) != uStack_30) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x519);
      (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x3c0);
    }
    iVar2 = *(int *)(param_1 + 0x678);
    uVar8 = 1;
    if (iVar2 < 1) {
      uStack_30 = *(uint *)(param_1 + 0x674);
      uVar5 = *(undefined4 *)(param_1 + 0x67c);
      *(undefined4 *)(param_1 + 0x674) = *(undefined4 *)(param_1 + 0x672);
      *(undefined4 *)(param_1 + 0x67c) = *(undefined4 *)(param_1 + 0x67a);
      *(undefined4 *)(param_1 + 0x67a) = uVar5;
      *(uint *)(param_1 + 0x672) = uStack_30;
      *(int *)(param_1 + 0x678) = aiStack_2c[0];
    }
    else {
      if (*(int *)(param_1 + 0x67c) < iVar2 + aiStack_2c[0]) {
        iVar7 = (**(code **)(iVar1 + 0x8f478))(*(undefined4 *)(param_1 + 0x674));
        if (iVar7 == 0) {
          return 0xfffffff8;
        }
        iVar2 = *(int *)(param_1 + 0x678);
        *(int *)(param_1 + 0x67c) = iVar2 + aiStack_2c[0];
        *(int *)(param_1 + 0x674) = iVar7;
      }
      else {
        iVar7 = *(int *)(param_1 + 0x674);
      }
      (**(code **)(iVar1 + 0x8f930))(iVar7 + iVar2,*(undefined4 *)(param_1 + 0x672));
      *(int *)(param_1 + 0x678) = *(int *)(param_1 + 0x678) + aiStack_2c[0];
      uVar8 = 1;
    }
    break;
  case 0x449818:
    if (((*(uint *)(param_1 + 0x67e) >> 1 & 1) == 0) &&
       (iVar6 = (**(code **)(iVar1 + 0x8ee14))(param_1), iVar6 != 0)) {
      pcVar9 = *(code **)(iVar1 + 0x8ee2c);
      *(uint *)(param_1 + 0x67e) = *(uint *)(param_1 + 0x67e) | 2;
      (*pcVar9)(param_1,*(undefined4 *)(param_1 + 0x65e));
    }
    iVar6 = *(int *)(param_1 + 0x676);
    *(int *)(param_1 + 0x676) = iVar6 - iVar2;
    if (iVar6 - iVar2 != iStack_3c) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x5b3);
      (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x3d4);
    }
    if (*(char *)((int)param_1 + 0xd27) != *(char *)((int)param_1 + 0xd2b)) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x5bb);
      (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x3f4);
    }
    if ((((*(uint *)(param_1 + 0x696) >> 1 & 1) == 0) ||
        ((*(uint *)(param_1 + 0x696) >> 0xc & 1) == 0)) ||
       (uVar3 = (uint)*(byte *)((int)param_1 + 0xd2b), uVar3 < 2)) {
      *param_3 = aiStack_2c[0];
    }
    else {
      uVar4 = uVar4 + uVar3;
      *param_3 = aiStack_2c[0] - uVar3;
    }
    uVar3 = *(uint *)(param_1 + 0x696);
    *param_2 = uVar4;
    if ((uVar3 >> 0xe & 1) != 0) {
      param_1[0x701] = 1;
    }
    return 4;
  case 0x449980:
    iVar6 = *(int *)(param_1 + 0x676);
    *(int *)(param_1 + 0x676) = iVar6 - iVar2;
    if (iVar6 - iVar2 < 1) {
      return 1;
    }
    uVar4 = *(uint *)(param_1 + 0x672);
    if (uStack_30 <= uVar4) {
      (**(code **)(iVar1 + 0x8fabc))
                (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
      iVar6 = *(int *)(iVar1 + 0x8e970);
      pcVar9 = *(code **)(iVar1 + 0x8f5e0);
      uVar8 = 0x4e2;
LAB_00449a74:
      (*pcVar9)(iVar6 + 0x16c,uVar8);
      (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x41c);
      uVar4 = *(uint *)(param_1 + 0x672);
    }
    goto LAB_004495e8;
  }
switchD_004492cc_caseD_ffffffc4:
  if ((0 < *(int *)(param_1 + 0x676)) && (*(uint *)(param_1 + 0x672) != uStack_30)) {
    (**(code **)(iVar1 + 0x8fabc))
              (*(int *)(iVar1 + 0x8e970) + 0x160,*(int *)(iVar1 + 0x8e970) + 0x2d0);
    (**(code **)(iVar1 + 0x8f5e0))(*(int *)(iVar1 + 0x8e970) + 0x16c,0x5de);
    (**(code **)(iVar1 + 0x8f4a8))(*(int *)(iVar1 + 0x8e970) + 0x1988);
  }
  if (iVar6 != -0x33) {
    iVar6 = 0x5dc;
    if ((*(uint *)(param_1 + 0x696) >> 0xe & 1) != 0) {
      iVar6 = (**(code **)(iVar1 + 0x8f298))();
    }
    if (((iVar6 < *(int *)(param_1 + 0x67a)) && (*(int *)(param_1 + 0x676) < iVar6)) &&
       (iVar1 = (**(code **)(iVar1 + 0x8f478))(*(undefined4 *)(param_1 + 0x672),iVar6), iVar1 != 0))
    {
      *(int *)(param_1 + 0x67a) = iVar6;
      *(int *)(param_1 + 0x672) = iVar1;
    }
  }
  return uVar8;
switchD_004492cc_caseD_ffffffce:
  if ((0x4805 < uStack_38) ||
     (((0x4000 < uStack_38 && (iVar6 = (**(code **)(iVar1 + 0x8ee14))(param_1), iVar6 == 0)) &&
      (0x4000 < uStack_38)))) {
    return 0xfffffff8;
  }
  *(undefined4 *)(param_1 + 0x676) = 0;
  if (uStack_38 <= *(uint *)(param_1 + 0x67a)) {
    return 0xfffffff4;
  }
  aiStack_2c[0] = *(int *)(param_1 + 0x672) - uStack_30;
  iVar6 = (**(code **)(iVar1 + 0x8f478))();
  if (iVar6 == 0) {
    return 0xfffffff8;
  }
  uStack_30 = iVar6 + aiStack_2c[0];
  *(uint *)(param_1 + 0x67a) = uStack_38;
  *(int *)(param_1 + 0x672) = iVar6;
  goto LAB_004491f8;
}



int matrixSslEncodeClosureAlert(int param_1)

{
  int iVar1;
  size_t __size;
  void *pvVar2;
  size_t sVar3;
  int local_28;
  int local_24;
  int local_20;
  int local_1c;
  int local_18 [2];
  
  iVar1 = -6;
  if (param_1 != 0) {
    if ((*(int *)(param_1 + 0xcf8) < 1) || (*(int *)(param_1 + 0xce8) == 0)) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x630);
      _psError("ssl->outsize > 0 && ssl->outbuf != NULL");
    }
    if ((*(uint *)(param_1 + 0xcfc) & 1) == 0) {
      pvVar2 = *(void **)(param_1 + 0xce8);
      __size = *(size_t *)(param_1 + 0xcf8);
      *(uint *)(param_1 + 0xcfc) = *(uint *)(param_1 + 0xcfc) | 1;
      sVar3 = 0;
      while( true ) {
        local_28 = (int)pvVar2 + *(int *)(param_1 + 0xcf0);
        local_1c = __size - *(int *)(param_1 + 0xcf0);
        local_24 = local_28;
        local_20 = local_28;
        iVar1 = sslEncodeClosureAlert(param_1,&local_28,local_18);
        if ((iVar1 != -0x32) || (sVar3 != 0)) break;
        __size = *(int *)(param_1 + 0xcf0) + local_18[0];
        pvVar2 = realloc(*(void **)(param_1 + 0xce8),__size);
        if (pvVar2 == (void *)0x0) {
          return -8;
        }
        *(void **)(param_1 + 0xce8) = pvVar2;
        *(size_t *)(param_1 + 0xcf8) = __size;
        sVar3 = __size;
      }
      if (iVar1 != 0) {
        return iVar1;
      }
      *(int *)(param_1 + 0xcf0) = *(int *)(param_1 + 0xcf0) + (local_20 - local_24);
    }
    iVar1 = 0;
  }
  return iVar1;
}



uint matrixSslSentData(int param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  void *pvVar3;
  uint uVar4;
  size_t sVar5;
  
  uVar1 = 0xfffffffa;
  if (param_1 != 0) {
    if (param_2 == 0) {
      return (uint)(0 < *(int *)(param_1 + 0xcf0));
    }
    if ((*(int *)(param_1 + 0xcf8) < 1) || (*(int *)(param_1 + 0xce8) == 0)) {
      _psTraceStr("psAssert %s","matrixsslApi.c");
      _psTraceInt(&DAT_0049016c,0x774);
      _psError("ssl->outsize > 0 && ssl->outbuf != NULL");
    }
    uVar1 = 0;
    sVar5 = *(int *)(param_1 + 0xcf0) - param_2;
    *(size_t *)(param_1 + 0xcf0) = sVar5;
    if ((int)sVar5 < 1) {
      if ((sVar5 == 0) && (uVar4 = *(uint *)(param_1 + 0xcfc), (uVar4 & 1) != 0)) {
        uVar1 = 3;
      }
      else {
        sVar5 = 0x5dc;
        if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
          sVar5 = matrixDtlsGetPmtu();
        }
        if ((((int)sVar5 < *(int *)(param_1 + 0xcf8)) && (*(int *)(param_1 + 0xcf0) < (int)sVar5))
           && (pvVar3 = realloc(*(void **)(param_1 + 0xce8),sVar5), pvVar3 != (void *)0x0)) {
          uVar4 = *(uint *)(param_1 + 0xcfc);
          *(void **)(param_1 + 0xce8) = pvVar3;
          *(size_t *)(param_1 + 0xcf8) = sVar5;
        }
        else {
          uVar4 = *(uint *)(param_1 + 0xcfc);
        }
      }
      if (((uVar4 >> 1 & 1) == 0) && (iVar2 = matrixSslHandshakeIsComplete(param_1), iVar2 != 0)) {
        *(uint *)(param_1 + 0xcfc) = *(uint *)(param_1 + 0xcfc) | 2;
        matrixSslGetSessionId(param_1,*(undefined4 *)(param_1 + 0xcbc));
        uVar1 = 5;
      }
      return uVar1;
    }
    memmove(*(void **)(param_1 + 0xce8),(void *)((int)*(void **)(param_1 + 0xce8) + param_2),sVar5);
    uVar1 = 1;
  }
  return uVar1;
}



undefined4
matrixSslDecode(ushort *param_1,byte **param_2,int *param_3,size_t param_4,int *param_5,int *param_6
               ,int *param_7,byte *param_8,byte *param_9)

{
  byte *pbVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  ushort uVar5;
  bool bVar6;
  undefined uVar7;
  void *__dest;
  uint uVar8;
  uint uVar9;
  char cVar10;
  int iVar11;
  byte *pbVar12;
  int iVar13;
  byte *pbVar14;
  byte *pbVar15;
  uint uVar16;
  uint uVar17;
  int iVar18;
  undefined4 uVar19;
  int iVar20;
  int iVar21;
  uint uVar22;
  void *pvVar23;
  uint uVar24;
  undefined4 uVar25;
  size_t __n;
  byte *pbVar26;
  byte *__n_00;
  byte *pbVar27;
  byte *pbVar28;
  undefined4 uVar29;
  code *pcVar30;
  undefined auStack_228 [72];
  byte *local_1e0;
  byte *local_1dc;
  byte *local_1d8;
  size_t local_1d4;
  undefined auStack_1d0 [208];
  undefined auStack_100 [128];
  byte abStack_80 [64];
  int local_40;
  byte *local_3c;
  byte *local_38;
  int local_34;
  int local_30;
  
  *param_7 = 0;
  uVar8 = *(uint *)(param_1 + 0x696);
  if (((uVar8 >> 6 & 1) != 0) || ((uVar8 >> 4 & 1) != 0)) {
LAB_0044a77c:
    *param_7 = -0xc;
    return 0xfffffff4;
  }
  local_1e0 = *param_2;
  uVar24 = 0;
  pbVar26 = local_1e0;
  if ((uVar8 >> 5 & 1) != 0) {
    *(uint *)(param_1 + 0x696) = uVar8 & 0xffffffdf;
LAB_0044acfc:
    if (pbVar26 != local_1e0) {
      _psTraceStr("psAssert %s","sslDecode.c");
      _psTraceInt(&DAT_0049016c,0x65a);
      _psError("origbuf == *buf");
    }
    local_1dc = local_1e0;
    local_1d8 = local_1e0;
    local_1d4 = param_4;
    memset(local_1e0,0,param_4);
    if (*(char *)(param_1 + 0x69c) == '\0') {
      memset(auStack_228,0,0x44);
      iVar20 = matrixSslEncodeClientHello(param_1,&local_1e0,0,0,param_6,0,auStack_228);
    }
    else {
      iVar20 = sslEncodeResponse(param_1,&local_1e0,param_6);
    }
    *param_9 = 0xff;
    if (iVar20 != 0) {
      if (iVar20 != -0x32) {
        if (-1 < iVar20) {
          _psTraceStr("psAssert %s","sslDecode.c");
          _psTraceInt(&DAT_0049016c,0x6b9);
          _psError("rc < 0");
        }
        *param_7 = iVar20;
        return 0xfffffff4;
      }
      *(uint *)(param_1 + 0x696) = *(uint *)(param_1 + 0x696) | 0x20;
      *param_3 = 0;
      return 0xffffffce;
    }
    if (*(int *)(param_1 + 0x698) != 0xff) {
      *(uint *)(param_1 + 0x696) = *(uint *)(param_1 + 0x696) | 0x40;
      if (local_1e0 == local_1d8) {
        *param_7 = -0xc;
        return 0xfffffff4;
      }
      *param_9 = (byte)*(int *)(param_1 + 0x698);
      *param_8 = 2;
    }
    *param_5 = 0;
    *param_3 = (int)local_1d8 - (int)local_1e0;
    return 0xffffffcc;
  }
  *param_6 = 0;
  pbVar28 = local_1e0 + *param_3;
LAB_0044a35c:
  do {
    if (pbVar28 == pbVar26) {
      return 0;
    }
    if ((int)pbVar28 - (int)pbVar26 < 5) {
      iVar20 = 5;
LAB_0044b1dc:
      *param_6 = iVar20;
      return 0xffffffcd;
    }
    if ((*(char *)((int)param_1 + 0xd3d) == '\0') && ((char)*pbVar26 < '\0')) {
LAB_0044af9c:
      *(undefined4 *)(param_1 + 0x698) = 0x2f;
      goto LAB_0044acfc;
    }
    iVar20 = *(int *)(param_1 + 0x91a);
    if ((int)pbVar28 - (int)pbVar26 < iVar20) {
      *param_6 = iVar20;
      return 0xffffffcd;
    }
    bVar2 = *pbVar26;
    uVar8 = *(uint *)(param_1 + 0x696);
    *(byte *)(param_1 + 6) = bVar2;
    bVar3 = pbVar26[1];
    *(byte *)(param_1 + 1) = bVar3;
    bVar4 = pbVar26[2];
    *(byte *)((int)param_1 + 3) = bVar4;
    pbVar12 = pbVar26 + 3;
    if ((uVar8 >> 0xe & 1) == 0) {
      if (bVar3 != 3) {
        *(undefined4 *)(param_1 + 0x698) = 0x46;
        return 0xfffffff4;
      }
    }
    else {
      if ((bVar3 != 0xfe) || (pbVar12 = pbVar26 + 0xb, bVar4 < 0xfd)) goto LAB_0044a77c;
      *(byte *)(param_1 + 2) = pbVar26[3];
      *(byte *)((int)param_1 + 5) = pbVar26[4];
      *(byte *)(param_1 + 3) = pbVar26[5];
      *(byte *)((int)param_1 + 7) = pbVar26[6];
      *(byte *)(param_1 + 4) = pbVar26[7];
      *(byte *)((int)param_1 + 9) = pbVar26[8];
      *(byte *)(param_1 + 5) = pbVar26[9];
      *(byte *)((int)param_1 + 0xb) = pbVar26[10];
    }
    bVar3 = *pbVar12;
    *param_1 = (ushort)bVar3 * 0x100;
    *param_1 = (ushort)bVar3 * 0x100 + (ushort)pbVar12[1];
    pbVar12 = pbVar12 + 2;
    if (3 < bVar2 - 0x14) {
      pbVar26 = *param_2;
      goto LAB_0044b0dc;
    }
    if ((1 < (byte)(*(char *)(param_1 + 0x69c) - 1U)) &&
       ((uint)param_1[1] != (*(uint *)(param_1 + 0x69e) >> 8 & 0xffff))) {
      pbVar26 = *param_2;
      goto LAB_0044af9c;
    }
    uVar16 = (uint)*param_1;
    if (0x47ff < (uVar16 - 1 & 0xffff)) {
LAB_0044b038:
      pbVar26 = *param_2;
      goto LAB_0044af9c;
    }
    if ((int)pbVar28 - (int)pbVar12 < (int)uVar16) {
      iVar20 = uVar16 + iVar20;
      if ((uVar8 >> 0xe & 1) == 0) goto LAB_0044b1dc;
      pbVar26 = *param_2;
      goto LAB_0044af9c;
    }
    if ((uVar8 >> 0xe & 1) == 0) {
LAB_0044a4e4:
      local_38 = local_1e0;
      if ((uVar8 >> 1 & 1) != 0) {
        if ((*(byte *)((int)param_1 + 0xd2b) < 2) || ((uVar8 >> 0x15 & 1) != 0)) goto LAB_0044a538;
        if ((uVar8 >> 0xc & 1) == 0) {
          if (*(byte *)(param_1 + 0x694) + 1 <= uVar16) goto LAB_0044a538;
          pbVar26 = *param_2;
        }
        else {
          if ((uint)*(byte *)(param_1 + 0x694) + (uint)*(byte *)((int)param_1 + 0xd2b) + 1 <= uVar16
             ) goto LAB_0044a538;
LAB_0044b2e8:
          pbVar26 = *param_2;
        }
        *(undefined4 *)(param_1 + 0x698) = 0x14;
        goto LAB_0044acfc;
      }
LAB_0044a538:
      iVar20 = (**(code **)(param_1 + 0x68c))(param_1,pbVar12,local_1e0,uVar16);
      if (iVar20 < 0) {
        pbVar26 = *param_2;
        *(undefined4 *)(param_1 + 0x698) = 0x33;
        goto LAB_0044acfc;
      }
      uVar16 = *(uint *)(param_1 + 0x696);
      uVar17 = (uint)*param_1;
      pbVar26 = pbVar12 + uVar17;
      uVar8 = uVar17;
      if ((uVar16 >> 0x15 & 1) != 0) {
        uVar8 = uVar17 - 8;
        if ((*(uint *)(*(int *)(param_1 + 0x688) + 4) >> 0xd & 1) == 0) {
          uVar8 = uVar17 - 0x10;
        }
        if ((uVar16 >> 0x17 & 1) == 0) {
          *param_1 = (ushort)uVar8;
        }
        else {
          uVar8 = uVar8 - 8;
          *param_1 = (ushort)uVar8;
        }
      }
      if (((uVar16 >> 1 & 1) == 0) || ((uVar16 >> 0x15 & 1) != 0)) {
        pbVar12 = local_1e0 + (uVar8 & 0xffff);
        pbVar27 = pbVar12 + -(int)local_1e0;
        if (*(int *)(param_1 + 0x680) == 0xff) goto LAB_0044a75c;
        bVar6 = *(int *)(param_1 + 0x680) < (int)pbVar27;
LAB_0044a7d8:
        if (bVar6) {
          pbVar26 = *param_2;
          goto LAB_0044a774;
        }
      }
      else {
        uVar17 = (uint)*(byte *)((int)param_1 + 0xd2b);
        iVar20 = 0;
        if (uVar17 < 2) {
          uVar22 = (uint)*(byte *)(param_1 + 0x694);
LAB_0044a5f8:
          pbVar12 = local_1e0 + ((uVar8 & 0xffff) - uVar22);
        }
        else {
          pbVar12 = local_1e0 + (uVar8 & 0xffff);
          uVar24 = (uint)pbVar12[-1];
          if (((*(uint *)(param_1 + 0x69e) & 0xffff00) == 0x300) && (uVar17 <= uVar24)) {
            iVar20 = 1;
          }
          if ((uVar16 >> 0xc & 1) == 0) {
            uVar22 = (uint)*(byte *)(param_1 + 0x694);
            if ((uVar8 & 0xffff) < uVar22 + uVar24 + 1) {
              iVar20 = 3;
              goto LAB_0044a9f0;
            }
LAB_0044abe0:
            uVar9 = 0xff;
            if (iVar20 != 0) goto LAB_0044aa04;
            cVar10 = *(char *)((int)param_1 + 0xd3d);
          }
          else {
            uVar22 = (uint)*(byte *)(param_1 + 0x694);
            if (uVar22 + uVar24 + uVar17 + 1 <= (uVar8 & 0xffff)) goto LAB_0044abe0;
            iVar20 = 2;
LAB_0044a9f0:
            uVar9 = 0xff;
LAB_0044aa04:
            do {
              while ((uVar9 & 0xff) != uVar24) {
                uVar9 = uVar9 - 1;
                if ((int)uVar9 < 0) goto LAB_0044aa1c;
              }
              uVar9 = uVar9 - 1;
              iVar20 = 1;
            } while (-1 < (int)uVar9);
LAB_0044aa1c:
            if (iVar20 != 0) goto LAB_0044a5f8;
            cVar10 = *(char *)((int)param_1 + 0xd3d);
          }
          if ((cVar10 == '\x03') &&
             (iVar18 = (int)pbVar12 - uVar24, *(char *)(param_1 + 0x69f) != '\0')) {
            for (pbVar27 = (byte *)(iVar18 + -1); pbVar27 < pbVar12; pbVar27 = pbVar27 + 1) {
              if (*pbVar27 != uVar24) {
                iVar20 = 1;
              }
            }
            if (iVar20 != 0) {
              uVar9 = 0xff - uVar24;
              while (0 < (int)uVar9) {
                if ((uVar9 & 0xff) == uVar24) {
                  iVar20 = 2;
                  uVar9 = uVar9 - 1;
                }
                else {
                  uVar9 = uVar9 - 1;
                }
              }
              goto LAB_0044aa34;
            }
          }
          else {
LAB_0044aa34:
            if (iVar20 != 0) goto LAB_0044a5f8;
            iVar18 = (int)pbVar12 - uVar24;
          }
          pbVar12 = (byte *)((iVar18 - uVar22) + -1);
          for (iVar18 = 0xff - uVar24; iVar20 = 0, 0 < iVar18; iVar18 = iVar18 + -1) {
          }
        }
        if (((uVar16 >> 0xc & 1) != 0) && (1 < uVar17)) {
          local_38 = local_1e0 + uVar17;
        }
        if (1 < uVar17) {
          uVar8 = uVar8 & 0xffff;
          iVar21 = 0;
          iVar18 = 0;
          if ((uVar16 >> 0xc & 1) != 0) {
            uVar8 = uVar8 - uVar17;
          }
          iVar11 = (uVar8 - uVar22) + 0xd;
          iVar13 = ((uVar8 - uVar24) - uVar22) + 0xc;
          if ((uVar22 == 0x14) || (uVar22 == 0x20)) {
            for (; 0x40 < iVar11; iVar11 = iVar11 + -0x40) {
              iVar18 = iVar18 + 1;
            }
            if (0x38 < iVar11) {
              iVar18 = iVar18 + 1;
            }
            for (; bVar6 = iVar13 < 0x39, 0x40 < iVar13; iVar13 = iVar13 + -0x40) {
              iVar21 = iVar21 + 1;
            }
LAB_0044acd0:
            if (!bVar6) {
              iVar21 = iVar21 + 1;
            }
          }
          else if (uVar22 == 0x30) {
            for (; 0x80 < iVar11; iVar11 = iVar11 + -0x80) {
              iVar18 = iVar18 + 1;
            }
            if (0x70 < iVar11) {
              iVar18 = iVar18 + 1;
            }
            for (; bVar6 = iVar13 < 0x71, 0x80 < iVar13; iVar13 = iVar13 + -0x80) {
              iVar21 = iVar21 + 1;
            }
            goto LAB_0044acd0;
          }
          iVar18 = iVar18 - iVar21;
          if (iVar20 == 0) {
            if (uVar22 == 0x20) {
              psSha256Init(auStack_1d0);
              for (; 0 < iVar18; iVar18 = iVar18 + -1) {
                psSha256Update(auStack_1d0,auStack_100,0x40);
              }
              psSha256Final(auStack_1d0,auStack_100);
            }
            else if (uVar22 < 0x21) {
              if (uVar22 != 0x14) goto LAB_0044a6b0;
              psSha1Init(auStack_1d0);
              for (; 0 < iVar18; iVar18 = iVar18 + -1) {
                psSha1Update(auStack_1d0,auStack_100,0x40);
              }
              psSha1Final(auStack_1d0,auStack_100);
            }
            else if (uVar22 == 0x30) {
              psSha384Init(auStack_1d0);
              for (; 0 < iVar18; iVar18 = iVar18 + -1) {
                psSha384Update(auStack_1d0,auStack_100,0x80);
              }
              psSha384Final(auStack_1d0,auStack_100);
            }
            else {
LAB_0044a6b0:
              _psTraceStr("psAssert %s","sslDecode.c");
              _psTraceInt(&DAT_0049016c,0x3bc);
              _psError("0");
            }
          }
        }
        pbVar27 = pbVar12 + -(int)local_38;
        iVar18 = (**(code **)(param_1 + 0x690))
                           (param_1,*(undefined *)(param_1 + 6),local_38,pbVar27,pbVar12);
        if ((iVar18 < 0) || (iVar20 != 0)) goto LAB_0044b2e8;
        memset(pbVar12,0,(uint)*(byte *)(param_1 + 0x694));
        bVar6 = *(int *)(param_1 + 0x680) < (int)pbVar27;
        if (*(int *)(param_1 + 0x680) != 0xff) goto LAB_0044a7d8;
LAB_0044a75c:
        if (0x4000 < (int)pbVar27) {
          pbVar26 = *param_2;
LAB_0044a774:
          *(undefined4 *)(param_1 + 0x698) = 0x16;
          goto LAB_0044acfc;
        }
      }
      bVar2 = *(byte *)(param_1 + 6);
      if (bVar2 == 0x15) {
        if (1 < (int)pbVar27) {
          *param_8 = *local_38;
          *param_9 = local_38[1];
          *param_3 = 2;
          if (*param_8 == 2) {
            *(uint *)(param_1 + 0x696) = *(uint *)(param_1 + 0x696) | 0x40;
          }
          if (*param_9 == 0) {
            *(uint *)(param_1 + 0x696) = *(uint *)(param_1 + 0x696) | 0x10;
          }
          uVar19 = 0xffffffca;
          uVar7 = 0xfc;
          *param_2 = pbVar26;
          goto LAB_0044b154;
        }
        pbVar26 = *param_2;
        *(undefined4 *)(param_1 + 0x698) = 0x32;
        goto LAB_0044acfc;
      }
      if (0x15 < bVar2) {
        if (bVar2 != 0x16) {
          if (bVar2 != 0x17) goto LAB_0044b15c;
          if (((*(char *)(param_1 + 0x69c) == -1) || (*(char *)(param_1 + 0x69c) == '\x02')) &&
             ((*(uint *)(param_1 + 0x696) >> 1 & 1) != 0)) {
            *param_5 = *param_3 - ((int)pbVar26 - (int)local_1e0);
            *param_2 = pbVar26;
            *param_3 = (int)pbVar12 - (int)local_1e0;
            if (local_38 == pbVar12) {
              iVar20 = *(int *)(param_1 + 0x69a);
              *(int *)(param_1 + 0x69a) = iVar20 + 1;
              if (0x3ff < iVar20) goto LAB_0044b0dc;
            }
            else if (0 < *(int *)(param_1 + 0x69a)) {
              *(int *)(param_1 + 0x69a) = *(int *)(param_1 + 0x69a) + -1;
            }
            uVar19 = 0xffffffcb;
            uVar7 = 0xff;
LAB_0044b154:
            *(undefined *)((int)param_1 + 0xd39) = uVar7;
            return uVar19;
          }
          pbVar26 = *param_2;
LAB_0044b0dc:
          *(undefined4 *)(param_1 + 0x698) = 10;
          goto LAB_0044acfc;
        }
        uVar8 = *(uint *)(param_1 + 0x696);
        local_3c = local_38;
        iVar20 = 0;
        pbVar28 = local_38 + (int)pbVar27;
        local_34 = 0;
        if ((uVar8 >> 0xe & 1) != 0) {
          iVar18 = (int)pbVar28 - (int)local_38;
          goto LAB_0044b7a4;
        }
        iVar18 = (int)pbVar28 - (int)local_38;
        if (*(int *)(param_1 + 0x682) == 0) goto LAB_0044b7a4;
        uVar8 = *(int *)(param_1 + 0x686) - *(int *)(param_1 + 0x684);
        if ((uint)((int)pbVar28 - (int)local_38) < uVar8) {
          uVar8 = (int)pbVar28 - (int)local_38;
        }
        memcpy((void *)(*(int *)(param_1 + 0x682) + *(int *)(param_1 + 0x684)),local_38,uVar8);
        iVar18 = *(int *)(param_1 + 0x684) + uVar8;
        *(int *)(param_1 + 0x684) = iVar18;
        if (iVar18 == *(int *)(param_1 + 0x686)) {
          iVar21 = *(int *)(param_1 + 0x91c);
          pbVar28 = (byte *)(*(int *)(param_1 + 0x682) + iVar18);
          local_3c = (byte *)(*(int *)(param_1 + 0x682) + iVar21);
          pbVar12 = (byte *)(iVar18 - iVar21);
LAB_0044b54c:
          pbVar15 = pbVar12 + iVar21;
          pbVar14 = local_3c + -iVar21;
LAB_0044b560:
          sslUpdateHSHash(param_1,pbVar14,(uint)pbVar15 & 0xffff);
          do {
            switch(*(undefined *)(param_1 + 0x69c)) {
            case 0:
              if (pbVar28 == local_3c) {
                iVar20 = -0x35;
                *(undefined *)((int)param_1 + 0xd39) = 0;
                goto LAB_0044c108;
              }
              goto LAB_0044bd6c;
            case 1:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0x997);
                _psError("rc == 0");
              }
              pbVar15 = local_3c;
              if (local_3c + (int)pbVar12 == pbVar28) {
                iVar20 = parseClientHello(param_1,&local_3c,pbVar28);
                goto LAB_0044c59c;
              }
              goto LAB_0044bf8c;
            case 2:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0x9e1);
                _psError("rc == 0");
              }
              pcVar30 = parseServerHello;
              break;
            case 3:
              pbVar15 = local_3c;
              if ((int)pbVar28 - (int)local_3c < 3) goto LAB_0044bf8c;
              uVar8 = (uint)local_3c[2];
              local_3c = local_3c + 3;
              *(uint *)(param_1 + 0x6b2) = uVar8;
              if (uVar8 == 0) {
LAB_0044c430:
                iVar20 = -0x35;
                *(int *)(param_1 + 0x6b4) = *(int *)(param_1 + 0x6b4) + 1;
                *(undefined *)(param_1 + 0x69c) = 2;
                *(undefined *)((int)param_1 + 0xd39) = 3;
                goto LAB_0044c108;
              }
              pbVar15 = local_3c;
              if ((int)pbVar28 - (int)local_3c < (int)uVar8) goto LAB_0044bf8c;
              if (*(int *)(param_1 + 0x6b4) != 0) {
                iVar20 = memcmpct(*(undefined4 *)(param_1 + 0x6b0));
                if (iVar20 != 0) goto LAB_0044bd6c;
LAB_0044c41c:
                local_3c = local_3c + *(int *)(param_1 + 0x6b2);
                goto LAB_0044c430;
              }
              pvVar23 = malloc(uVar8);
              *(void **)(param_1 + 0x6b0) = pvVar23;
              if (pvVar23 != (void *)0x0) {
                memcpy(pvVar23,local_3c,*(size_t *)(param_1 + 0x6b2));
                goto LAB_0044c41c;
              }
              goto LAB_0044bb50;
            case 4:
              if (pbVar12 < (byte *)0x6) goto LAB_0044bd6c;
              iVar18 = *(int *)(param_1 + 0x65e);
              bVar2 = *local_3c;
              *(uint *)(iVar18 + 0x60) = (uint)bVar2 << 0x18;
              uVar8 = (uint)bVar2 << 0x18 | (uint)local_3c[1] << 0x10;
              *(uint *)(iVar18 + 0x60) = uVar8;
              uVar8 = uVar8 | (uint)local_3c[2] << 8;
              *(uint *)(iVar18 + 0x60) = uVar8;
              *(uint *)(iVar18 + 0x60) = uVar8 | local_3c[3];
              pbVar12 = local_3c + 4;
              pbVar15 = local_3c + 5;
              local_3c = local_3c + 6;
              uVar5 = CONCAT11(*pbVar12,*pbVar15);
              __n = (size_t)uVar5;
              pbVar15 = local_3c;
              if ((uint)((int)pbVar28 - (int)local_3c) < __n) goto LAB_0044bf8c;
              if (*(short *)(iVar18 + 0x5e) == 0) {
                *(ushort *)(iVar18 + 0x5e) = uVar5;
LAB_0044c328:
                pvVar23 = malloc(__n);
                *(void **)(iVar18 + 0x58) = pvVar23;
                if (pvVar23 == (void *)0x0) {
                  iVar18 = *(int *)(param_1 + 0x65e);
                  uVar5 = *(ushort *)(iVar18 + 0x5e);
                  *(undefined2 *)(iVar18 + 0x5e) = 0;
                }
                else {
                  memcpy(*(void **)(*(int *)(param_1 + 0x65e) + 0x58),local_3c,
                         (uint)*(ushort *)(*(int *)(param_1 + 0x65e) + 0x5e));
                  iVar18 = *(int *)(param_1 + 0x65e);
                  uVar5 = *(ushort *)(iVar18 + 0x5e);
                }
                pbVar12 = local_3c + uVar5;
              }
              else {
                if (*(int *)(iVar18 + 0x58) == 0) {
                  _psTraceStr("psAssert %s","sslDecode.c");
                  _psTraceInt(&DAT_0049016c,0xa42);
                  _psError("ssl->sid->sessionTicket");
                  iVar18 = *(int *)(param_1 + 0x65e);
                }
                pbVar12 = local_3c;
                if (*(ushort *)(iVar18 + 0x5e) != __n) {
LAB_0044c304:
                  *(ushort *)(iVar18 + 0x5e) = uVar5;
                  free(*(void **)(iVar18 + 0x58));
                  iVar18 = *(int *)(param_1 + 0x65e);
                  __n = (size_t)*(ushort *)(iVar18 + 0x5e);
                  goto LAB_0044c328;
                }
                iVar21 = memcmp(local_3c,*(void **)(iVar18 + 0x58),__n);
                pbVar12 = pbVar12 + __n;
                if (iVar21 != 0) goto LAB_0044c304;
              }
              *(undefined2 *)(iVar18 + 0x5c) = 0;
              *(undefined *)(param_1 + 0x69c) = 0x14;
              *(undefined *)((int)param_1 + 0xd39) = 4;
              local_3c = pbVar12;
              goto LAB_0044c108;
            default:
              goto switchD_0044b598_caseD_5;
            case 0xb:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0x9f1);
                _psError("rc == 0");
              }
              iVar20 = parseCertificate(param_1,&local_3c,pbVar28);
              goto LAB_0044c0f8;
            case 0xc:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0xa94);
                _psError("rc == 0");
              }
              pcVar30 = parseServerKeyExchange;
              goto LAB_0044c0e8;
            case 0xd:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0xa75);
                _psError("rc == 0");
              }
              pcVar30 = parseCertificateRequest;
              break;
            case 0xe:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0xa67);
                _psError("rc == 0");
              }
              iVar20 = parseServerHelloDone(param_1,pbVar12,&local_3c,pbVar28);
              goto LAB_0044c59c;
            case 0xf:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0xa85);
                _psError("rc == 0");
              }
              pcVar30 = parseCertificateVerify;
LAB_0044c0e8:
              pbVar12 = abStack_80;
              break;
            case 0x10:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0x9a9);
                _psError("rc == 0");
              }
              pcVar30 = parseClientKeyExchange;
              break;
            case 0x14:
              if (iVar20 != 0) {
                _psTraceStr("psAssert %s","sslDecode.c");
                _psTraceInt(&DAT_0049016c,0x9b5);
                _psError("rc == 0");
              }
              iVar20 = parseFinished(param_1,pbVar12,abStack_80,&local_3c,pbVar28);
LAB_0044c59c:
              if ((-1 < iVar20) || (iVar20 == -0x35)) goto LAB_0044c108;
              goto LAB_0044c134;
            case 0x16:
              pcVar30 = parseCertificateStatus;
            }
            iVar20 = (*pcVar30)(param_1,pbVar12,&local_3c,pbVar28);
LAB_0044c0f8:
            if (iVar20 < 0) {
LAB_0044c134:
              pvVar23 = *(void **)(param_1 + 0x682);
              goto LAB_0044b4ac;
            }
LAB_0044c108:
            uVar8 = *(uint *)(param_1 + 0x696);
            if ((uVar8 >> 0xe & 1) != 0) {
              *(int *)(param_1 + 0x6fa) = local_34;
            }
            iVar18 = (int)pbVar28 - (int)local_3c;
            if (pbVar28 <= local_3c) goto LAB_0044c134;
LAB_0044b7a4:
            pbVar14 = local_3c + 1;
            pbVar15 = local_3c;
            if (iVar18 < 1) goto LAB_0044bf8c;
            bVar2 = *local_3c;
            if ((uVar8 & 1) == 0) {
              if (bVar2 != 0) goto LAB_0044b7cc;
LAB_0044be54:
              if (*(char *)(param_1 + 0x69c) != -1) goto LAB_0044b7cc;
              pvVar23 = *(void **)(param_1 + 0x682);
              iVar20 = -0xc;
              uVar19 = 100;
              local_3c = pbVar14;
LAB_0044bc14:
              *(undefined4 *)(param_1 + 0x698) = uVar19;
              goto LAB_0044b4ac;
            }
            if (bVar2 == 1) goto LAB_0044be54;
LAB_0044b7cc:
            pbVar15 = pbVar14;
            if ((uVar8 >> 0xe & 1) != 0) {
              if ((int)pbVar28 - (int)pbVar14 < 5) goto LAB_0044bf8c;
              local_34 = (uint)local_3c[4] * 0x100 + (uint)local_3c[5];
              if (*(int *)(param_1 + 0x6fa) + 1 < local_34) goto LAB_0044bab8;
              if ((local_34 == 0) || (*(int *)(param_1 + 0x6fa) < local_34)) goto LAB_0044b820;
LAB_0044b8e0:
              pvVar23 = *(void **)(param_1 + 0x682);
              iVar20 = -0x3d;
              local_3c = pbVar14;
              goto LAB_0044b4ac;
            }
LAB_0044b820:
            bVar3 = *(byte *)(param_1 + 0x69c);
            if ((bVar3 != bVar2) && ((bVar2 != 1 || (bVar3 != 0xff)))) {
              if ((bVar2 == 0xd) && (bVar3 == 0xe)) {
                *(uint *)(param_1 + 0x696) = uVar8 | 0x80;
                goto LAB_0044b908;
              }
              if (bVar2 != 0) {
LAB_0044b86c:
                if (((bVar2 != 4) || (bVar3 != 0x14)) ||
                   ((*(int *)(param_1 + 0x65e) == 0 ||
                    ((*(short *)(*(int *)(param_1 + 0x65e) + 0x5c) != 3 || ((uVar8 & 1) != 0)))))) {
                  local_3c = pbVar14;
                  if (bVar3 != 0x16) {
                    if ((((uVar8 >> 0x12 & 1) == 0) || (bVar2 != 0xe)) || (bVar3 != 0xc)) {
                      if ((uVar8 >> 0xe & 1) != 0) {
                        if (((bVar2 == 3) && (bVar3 == 2)) && (*(int *)(param_1 + 0x6b4) == 0))
                        goto LAB_0044b908;
                        if ((*(int *)(param_1 + 0x6fa) + 1 != local_34) &&
                           (local_34 <= *(int *)(param_1 + 0x6fa))) goto LAB_0044b8e0;
                      }
                    }
                    else if ((uVar8 >> 0x11 & 1) == 0) {
LAB_0044b908:
                      *(byte *)(param_1 + 0x69c) = bVar2;
                      goto LAB_0044b910;
                    }
                  }
switchD_0044b598_caseD_5:
                  pvVar23 = *(void **)(param_1 + 0x682);
                  iVar20 = -0xc;
                  uVar19 = 10;
                  goto LAB_0044bc14;
                }
                *(undefined *)(param_1 + 0x69c) = 4;
                goto LAB_0044b910;
              }
              if ((bVar3 == 0xff) && ((uVar8 & 1) == 0)) {
                local_3c = pbVar14;
                sslResetContext(param_1);
                *(undefined *)(param_1 + 0x69c) = 0;
                pbVar14 = local_3c;
                goto LAB_0044b910;
              }
              if ((((bVar3 != 2) || ((uVar8 >> 1 & 1) == 0)) || ((uVar8 >> 2 & 1) == 0)) ||
                 ((uVar8 & 1) != 0)) goto LAB_0044b86c;
              if ((int)pbVar28 - (int)pbVar14 < 3) goto LAB_0044bf8c;
              pbVar12 = local_3c + 2;
              pbVar27 = local_3c + 3;
              pbVar14 = local_3c + 4;
              pbVar15 = pbVar14;
              if (((uVar8 >> 0xe & 1) != 0) &&
                 (pbVar15 = local_3c + 0xc, (int)pbVar28 - (int)pbVar14 < 8)) {
                pvVar23 = *(void **)(param_1 + 0x682);
                local_3c = pbVar14;
LAB_0044bc10:
                iVar20 = -0xc;
                uVar19 = 0x32;
                goto LAB_0044bc14;
              }
              local_3c = pbVar15;
              pbVar14 = local_3c;
              if ((uint)*pbVar14 * 0x10000 + (uint)*pbVar12 * 0x100 + (uint)*pbVar27 == 0)
              goto LAB_0044bab8;
              pvVar23 = *(void **)(param_1 + 0x682);
              iVar20 = -0xc;
              goto LAB_0044b4ac;
            }
LAB_0044b910:
            local_3c = pbVar14;
            if (bVar2 == 1) {
              sslInitHSHash(param_1);
              cVar10 = *(char *)(param_1 + 0x69c);
              if (cVar10 == -1) {
                sslResetContext(param_1);
                cVar10 = '\x01';
                *(undefined *)(param_1 + 0x69c) = 1;
              }
            }
            else {
              cVar10 = *(char *)(param_1 + 0x69c);
            }
            if (cVar10 == '\x14') {
              iVar18 = sslSnapshotHSHash(param_1,abStack_80,*(uint *)(param_1 + 0x696) & 1 ^ 1);
              if (0 < iVar18) {
                cVar10 = *(char *)(param_1 + 0x69c);
                goto LAB_0044b930;
              }
LAB_0044bd28:
              pvVar23 = *(void **)(param_1 + 0x682);
LAB_0044bd2c:
              iVar20 = -0xc;
              uVar19 = 0x50;
              goto LAB_0044bc14;
            }
LAB_0044b930:
            if ((cVar10 == '\x0f') &&
               (iVar18 = sslSnapshotHSHash(param_1,abStack_80,0xffffffff), iVar18 < 1))
            goto LAB_0044bd28;
            if (*(byte *)(param_1 + 1) < 3) {
              if (*(byte *)(param_1 + 1) != 2) {
LAB_0044bd6c:
                pvVar23 = *(void **)(param_1 + 0x682);
                iVar20 = -0xc;
LAB_0044bc5c:
                uVar19 = 0x2f;
                goto LAB_0044bc14;
              }
              pbVar12 = pbVar27 + -1;
              pbVar14 = local_38;
              pbVar15 = pbVar27;
              goto LAB_0044b560;
            }
            pbVar15 = local_3c;
            if ((int)pbVar28 - (int)local_3c < 3) {
LAB_0044bf8c:
              local_3c = pbVar15;
              pvVar23 = *(void **)(param_1 + 0x682);
              goto LAB_0044bc10;
            }
            pbVar15 = local_3c + 3;
            pbVar12 = (byte *)((uint)*local_3c * 0x10000 + (uint)local_3c[1] * 0x100 +
                              (uint)local_3c[2]);
            if ((*(uint *)(param_1 + 0x696) >> 0xe & 1) != 0) {
              if ((int)pbVar28 - (int)pbVar15 < 8) goto LAB_0044bf8c;
              pbVar15 = local_3c + 5;
              pbVar14 = local_3c + 6;
              pbVar1 = local_3c + 7;
              __n_00 = (byte *)((uint)local_3c[8] * 0x10000 + (uint)local_3c[9] * 0x100 +
                               (uint)local_3c[10]);
              local_34 = (uint)local_3c[3] * 0x100 + (uint)local_3c[4];
              local_3c = local_3c + 0xb;
              local_30 = (uint)*pbVar15 * 0x10000 + (uint)*pbVar14 * 0x100 + (uint)*pbVar1;
              pbVar15 = local_3c;
              if (__n_00 == pbVar12) goto LAB_0044bbec;
              if (*(int *)(param_1 + 0x686) == 0) {
                if (*(void **)(param_1 + 0x682) != (void *)0x0) {
                  free(*(void **)(param_1 + 0x682));
                  *(undefined4 *)(param_1 + 0x682) = 0;
                }
                pvVar23 = malloc((size_t)pbVar12);
                *(void **)(param_1 + 0x682) = pvVar23;
                if (pvVar23 == (void *)0x0) {
                  iVar20 = -8;
                  pvVar23 = (void *)0x0;
                  goto LAB_0044b4ac;
                }
                *(int *)(param_1 + 0x702) = local_34;
                iVar20 = local_34;
              }
              else {
                iVar20 = *(int *)(param_1 + 0x702);
              }
              pbVar14 = local_3c;
              if ((iVar20 == local_34) &&
                 (iVar20 = dtlsSeenFrag(param_1,local_30,&local_40), iVar18 = local_40,
                 pbVar14 = local_3c, iVar20 != 1)) {
                if (iVar20 == -1) {
                  dtlsInitFrag(param_1);
                  pvVar23 = *(void **)(param_1 + 0x682);
                  if (pvVar23 != (void *)0x0) {
                    free(pvVar23);
                    *(undefined4 *)(param_1 + 0x682) = 0;
                    pvVar23 = (void *)0x0;
                  }
                  iVar20 = -9;
                  goto LAB_0044bc5c;
                }
                pvVar23 = malloc(*(size_t *)(param_1 + 0x91c));
                *(void **)(param_1 + iVar18 * 6 + 0x708) = pvVar23;
                if (*(void **)(param_1 + local_40 * 6 + 0x708) == (void *)0x0) {
                  dtlsInitFrag(param_1);
LAB_0044bb50:
                  pvVar23 = *(void **)(param_1 + 0x682);
                  iVar20 = -8;
                  goto LAB_0044b4ac;
                }
                memcpy(*(void **)(param_1 + local_40 * 6 + 0x708),
                       local_3c + -*(size_t *)(param_1 + 0x91c),*(size_t *)(param_1 + 0x91c));
                *(byte **)(param_1 + local_40 * 6 + 0x706) = __n_00;
                *(int *)(param_1 + local_40 * 6 + 0x704) = local_30;
                *(byte **)(param_1 + 0x686) = __n_00 + *(int *)(param_1 + 0x686);
                memcpy((void *)(*(int *)(param_1 + 0x682) + local_30),local_3c,(size_t)__n_00);
                pbVar14 = local_3c;
                if (*(byte **)(param_1 + 0x686) == pbVar12) {
                  pbVar28 = *(byte **)(param_1 + 0x682) + (int)pbVar12;
                  pbVar15 = *(byte **)(param_1 + 0x682);
                  goto LAB_0044bbec;
                }
              }
LAB_0044bab8:
              local_3c = pbVar14;
              pvVar23 = *(void **)(param_1 + 0x682);
              iVar20 = 0;
              goto LAB_0044b4ac;
            }
LAB_0044bbec:
            local_3c = pbVar15;
            if (pbVar28 + -(int)local_3c < pbVar12) {
              pvVar23 = *(void **)(param_1 + 0x682);
              if (pvVar23 != (void *)0x0) goto LAB_0044bc10;
              *(byte **)(param_1 + 0x686) = pbVar12 + *(int *)(param_1 + 0x91c);
              __dest = malloc((size_t)(pbVar12 + *(int *)(param_1 + 0x91c)));
              *(void **)(param_1 + 0x682) = __dest;
              if (__dest != (void *)0x0) {
                *(byte **)(param_1 + 0x684) = pbVar28 + (*(int *)(param_1 + 0x91c) - (int)local_3c);
                memcpy(__dest,local_3c + -*(int *)(param_1 + 0x91c),
                       (size_t)(pbVar28 + (*(int *)(param_1 + 0x91c) - (int)local_3c)));
                pbVar14 = local_3c;
                goto LAB_0044bab8;
              }
              goto LAB_0044bd2c;
            }
            if ((*(uint *)(param_1 + 0x696) >> 0xe & 1) == 0) {
              iVar21 = *(int *)(param_1 + 0x91c);
              goto LAB_0044b54c;
            }
            if (*(int *)(param_1 + 0x686) == 0) goto LAB_0044bd38;
            dtlsHsHashFragMsg(param_1);
            dtlsInitFrag(param_1);
          } while( true );
        }
        pvVar23 = *(void **)(param_1 + 0x682);
        iVar20 = 0;
        local_3c = local_3c + uVar8;
LAB_0044b4ac:
        if ((pvVar23 != (void *)0x0) && (*(int *)(param_1 + 0x684) == *(int *)(param_1 + 0x686))) {
          free(pvVar23);
          *(undefined4 *)(param_1 + 0x682) = 0;
          *(undefined4 *)(param_1 + 0x686) = 0;
          *(undefined4 *)(param_1 + 0x684) = 0;
        }
        if (iVar20 == -0xc) {
LAB_0044b77c:
          if (*(int *)(param_1 + 0x698) != 0xff) {
            pbVar26 = *param_2;
            goto LAB_0044acfc;
          }
LAB_0044bfcc:
          pbVar26 = *param_2;
        }
        else {
          if (iVar20 < -0xb) {
            if (iVar20 == -0x3d) {
              iVar20 = *param_3;
              *param_2 = pbVar26;
              iVar20 = iVar20 - ((int)pbVar26 - (int)local_1e0);
              *param_5 = iVar20;
              if (iVar20 != 0) {
                return 0;
              }
              return 0xffffffc3;
            }
            if (iVar20 == -0x35) {
              if (((*pbVar26 == 0x17) && (*(char *)(param_1 + 0x69c) == -1)) &&
                 ((*(uint *)(param_1 + 0x696) & 1) != 0)) {
                if (local_1e0 + *param_3 != pbVar26) {
                  _psTraceStr("psAssert %s","sslDecode.c");
                  _psTraceInt(&DAT_0049016c,0x5b4);
                  _psError("origbuf + *len == c");
                }
                *param_2 = local_1e0;
                pbVar26 = local_1e0;
              }
              else {
                if (*pbVar26 == 0x17) {
                  if (*(char *)(param_1 + 0x69c) == '\0') {
                    pbVar28 = local_1e0 + *param_3;
                    if (pbVar26 < local_1e0 + *param_3) {
                      uVar19 = *(undefined4 *)(param_1 + 0x66c);
                      uVar25 = *(undefined4 *)(param_1 + 0x66e);
                      uVar29 = *(undefined4 *)(param_1 + 0x670);
                      *param_2 = pbVar26;
                      *(undefined *)(param_1 + 0x69c) = 0xff;
                      *(undefined4 *)(param_1 + 0x620) = uVar19;
                      *(undefined4 *)(param_1 + 0x696) = uVar25;
                      *(undefined4 *)(param_1 + 0x67e) = uVar29;
                      return 0;
                    }
                  }
                  else {
                    pbVar28 = local_1e0 + *param_3;
                  }
                }
                else {
                  pbVar28 = local_1e0 + *param_3;
                }
                if (pbVar28 != pbVar26) {
                  _psTraceStr("psAssert %s","sslDecode.c");
                  _psTraceInt(&DAT_0049016c,0x5cf);
                  _psError("origbuf + *len == c");
                }
                *param_2 = local_1e0;
                pbVar26 = local_1e0;
              }
              goto LAB_0044acfc;
            }
          }
          else {
            if (iVar20 == -8) goto LAB_0044b77c;
            if (iVar20 == 0) {
              *param_5 = *param_3 - ((int)pbVar26 - (int)local_1e0);
              *param_2 = pbVar26;
              return 0;
            }
          }
          if (*(int *)(param_1 + 0x698) != 0xff) {
            pbVar26 = *param_2;
            goto LAB_0044acfc;
          }
LAB_0044c030:
          pbVar26 = *param_2;
        }
LAB_0044b270:
        *(undefined4 *)(param_1 + 0x698) = 0x50;
        goto LAB_0044acfc;
      }
      if (bVar2 != 0x14) {
LAB_0044b15c:
        *param_7 = -0xc;
        return 0xfffffff4;
      }
      if (((int)pbVar27 < 1) || (*local_38 != 1)) goto LAB_0044b038;
      if ((*(uint *)(param_1 + 0x696) >> 0xe & 1) != 0) {
        if (*(char *)(param_1 + 0x69c) != '\x14') {
          *param_2 = pbVar26;
          goto LAB_0044a35c;
        }
        *(undefined4 *)(param_1 + 0x6f4) = 1;
      }
      incrTwoByte(param_1,(int)param_1 + 0xdcd,0);
      *param_5 = *param_3 - ((int)pbVar26 - (int)local_1e0);
      *param_2 = pbVar26;
      cVar10 = *(char *)(param_1 + 0x69c);
      if (cVar10 == '\x14') {
        iVar20 = sslActivateReadCipher(param_1);
        if (iVar20 < 0) goto LAB_0044bfcc;
      }
      else {
        if (((cVar10 == '\v') && (*(int *)(param_1 + 0x65e) != 0)) &&
           (*(short *)(*(int *)(param_1 + 0x65e) + 0x5c) == 4)) {
          *(uint *)(param_1 + 0x696) = *(uint *)(param_1 + 0x696) | 8;
          iVar20 = sslCreateKeys(param_1);
          if (iVar20 < 0) goto LAB_0044c030;
          *(undefined *)(param_1 + 0x69c) = 0x14;
          iVar20 = sslActivateReadCipher(param_1);
          if (iVar20 < 0) {
            pbVar26 = *param_2;
            goto LAB_0044b270;
          }
        }
        else {
          if (((((*(uint *)(param_1 + 0x696) >> 0x12 & 1) == 0) || (cVar10 != '\f')) ||
              (*(int *)(param_1 + 0x65e) == 0)) ||
             (*(short *)(*(int *)(param_1 + 0x65e) + 0x5c) != 4)) goto LAB_0044b0dc;
          *(uint *)(param_1 + 0x696) = *(uint *)(param_1 + 0x696) | 8;
          iVar20 = sslCreateKeys(param_1);
          if (iVar20 < 0) {
            pbVar26 = *param_2;
            goto LAB_0044b270;
          }
          *(undefined *)(param_1 + 0x69c) = 0x14;
          iVar20 = sslActivateReadCipher(param_1);
          if (iVar20 < 0) goto LAB_0044bfcc;
        }
        *(undefined2 *)(*(int *)(param_1 + 0x65e) + 0x5c) = 0;
      }
      uVar19 = 0;
      uVar7 = 0xfd;
      goto LAB_0044b154;
    }
    iVar20 = dtlsCompareEpoch(param_1 + 2,(int)param_1 + 0xdcd);
    if (((iVar20 == 1) && (*(char *)(param_1 + 6) == '\x16')) &&
       (*(char *)(param_1 + 0x69c) == '\x14')) {
      if (*(int *)(param_1 + 0x6f4) == 0) {
        *param_2 = pbVar12 + *param_1;
        return 0;
      }
      *(undefined *)((int)param_1 + 0xdcd) = *(undefined *)(param_1 + 2);
      *(undefined *)(param_1 + 0x6e7) = *(undefined *)((int)param_1 + 5);
    }
    else if (iVar20 != 0) {
      if (((iVar20 == 1) && (*(char *)(param_1 + 6) == '\x16')) &&
         (*(char *)(param_1 + 0x69c) == -1)) {
        *(undefined *)((int)param_1 + 0xdcd) = *(undefined *)(param_1 + 2);
        *(undefined *)(param_1 + 0x6e7) = *(undefined *)((int)param_1 + 5);
      }
      if (((iVar20 == 1) && (*(char *)(param_1 + 6) == '\x17')) &&
         (*(char *)(param_1 + 0x69c) == -1)) {
        uVar8 = *(uint *)(param_1 + 0x696);
        uVar16 = (uint)*param_1;
        *(undefined *)((int)param_1 + 0xdcd) = *(undefined *)(param_1 + 2);
        *(undefined *)(param_1 + 0x6e7) = *(undefined *)((int)param_1 + 5);
        goto LAB_0044a4e4;
      }
      pbVar26 = pbVar12 + *param_1;
      *param_2 = pbVar26;
      if ((*(char *)(param_1 + 6) == '\x14') && (param_1[0x701] == 0)) {
        if (pbVar28 != pbVar26) {
          if (*pbVar26 != 0x16) {
            _psTraceStr("psAssert %s","sslDecode.c");
            _psTraceInt(&DAT_0049016c,0x254);
            _psError("*c == SSL_RECORD_TYPE_HANDSHAKE");
          }
          *param_2 = pbVar26 + (uint)pbVar26[0xb] * 0x100 + (uint)pbVar26[0xc] + 0xd;
        }
        return 0xffffffc3;
      }
      if ((int)pbVar28 - (int)pbVar26 < 1) {
        if (((iVar20 != 1) || ((*(uint *)(param_1 + 0x696) & 1) == 0)) ||
           (*(char *)(param_1 + 0x69c) != '\x01')) {
          if (iVar20 != -1) {
            return 0;
          }
          return 0xffffffc3;
        }
        *param_2 = local_1e0;
        pbVar26 = local_1e0;
        goto LAB_0044b0dc;
      }
      goto LAB_0044a35c;
    }
    iVar20 = dtlsChkReplayWindow(param_1,param_1 + 3);
    if (iVar20 == 1) {
      uVar8 = *(uint *)(param_1 + 0x696);
      uVar16 = (uint)*param_1;
      goto LAB_0044a4e4;
    }
    pbVar26 = pbVar12 + *param_1;
    *param_2 = pbVar26;
    if ((int)pbVar28 - (int)pbVar26 < 1) {
      return 0;
    }
  } while( true );
LAB_0044bd38:
  pbVar15 = pbVar12 + *(int *)(param_1 + 0x91c);
  pbVar14 = local_3c + -*(int *)(param_1 + 0x91c);
  goto LAB_0044b560;
}



int matrixSslGetEncodedSize(int param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  
  uVar1 = *(uint *)(param_1 + 0xd2c);
  iVar3 = *(int *)(param_1 + 0x1234);
  param_2 = param_2 + iVar3;
  if ((uVar1 >> 2 & 1) != 0) {
    uVar4 = (uint)*(byte *)(param_1 + 0xd24);
    param_2 = param_2 + uVar4;
    if ((uVar1 >> 0xc & 1) == 0) {
      uVar2 = (uint)*(byte *)(param_1 + 0xd27);
    }
    else {
      uVar2 = (uint)*(byte *)(param_1 + 0xd27);
      if (1 < uVar2) {
        param_2 = param_2 + uVar2;
      }
    }
    if ((uVar1 >> 0x14 & 1) != 0) {
      iVar5 = 8;
      if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
        iVar5 = 0x10;
      }
      param_2 = param_2 + iVar5;
      if ((uVar1 >> 0x16 & 1) != 0) {
        param_2 = param_2 + 8;
      }
    }
    if ((*(uint *)(param_1 + 0xcfc) >> 2 & 1) == 0) {
      if (1 < uVar2) {
        uVar4 = param_2 - iVar3;
        goto LAB_0044c958;
      }
    }
    else {
      if (1 < uVar2) {
        param_2 = param_2 + (uVar2 - ((param_2 - iVar3) - 1U & uVar2 - 1) & 0xff);
      }
      param_2 = param_2 + iVar3 + uVar4;
      uVar4 = uVar4 + 1;
      if (1 < uVar2) {
LAB_0044c958:
        return param_2 + (uVar2 - (uVar4 & uVar2 - 1) & 0xff);
      }
    }
  }
  return param_2;
}



undefined4
FUN_0044c97c(int param_1,int param_2,size_t param_3,void *param_4,int param_5,int param_6)

{
  bool bVar1;
  undefined uVar2;
  undefined *puVar3;
  uint uVar4;
  undefined uVar5;
  uint uVar6;
  int iVar7;
  void *__dest;
  int iVar8;
  uint uVar9;
  uint uVar10;
  int *piVar11;
  int iVar12;
  int iVar13;
  size_t __n;
  
  uVar10 = (uint)*(ushort *)(param_2 + 0x10);
  if ((int)param_3 <= (int)uVar10) {
    iVar12 = uVar10 - param_3;
  }
  else {
    iVar12 = param_3 - uVar10;
  }
  bVar1 = (int)param_3 > (int)uVar10;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
    *(size_t *)(param_1 + 0x122c) = param_3 - uVar10;
  }
  if (0xc < iVar12) {
    return 0xfffffff4;
  }
  piVar11 = *(int **)(param_1 + 0xc7c);
  while( true ) {
    if (piVar11 == (int *)0x0) {
      return 0xfffffff4;
    }
    if (piVar11[6] == param_6) break;
    piVar11 = (int *)piVar11[8];
  }
  if (piVar11 == (int *)0x0) {
    return 0xfffffff4;
  }
  iVar13 = iVar12;
  if (((*(uint *)(param_1 + 0xd2c) >> 2 & 1) != 0) &&
     (uVar6 = (uint)*(byte *)(param_1 + 0xd27), 1 < uVar6)) {
    iVar8 = piVar11[4];
    if (!bVar1) {
      iVar13 = -iVar12;
    }
    uVar9 = ((iVar8 - *(int *)(param_1 + 0x1234)) - piVar11[5]) + iVar13;
    uVar4 = 0;
    if (1 < uVar6) {
      uVar4 = uVar6 - (uVar6 - 1 & uVar9) & 0xff;
    }
    piVar11[5] = uVar4;
    iVar7 = uVar9 + *(int *)(param_1 + 0x1234) + uVar4;
    iVar13 = iVar8 - iVar7;
    if (iVar8 < iVar7) {
      iVar13 = iVar7 - iVar8;
    }
  }
  iVar8 = *(int *)(param_2 + 4);
  __n = *(int *)(param_5 + 8) - (iVar8 + uVar10);
  if ((int)__n < 1) {
    _psTraceStr("psAssert %s","sslEncode.c");
    _psTraceInt(&DAT_0049016c,0x1a1);
    _psError("howMuchToMove > 0");
    uVar10 = (uint)*(ushort *)(param_2 + 0x10);
    iVar8 = *(int *)(param_2 + 4);
  }
  iVar7 = -iVar13;
  if ((bVar1) &&
     (iVar7 = iVar13,
     (*(int *)(param_5 + 4) + *(int *)(param_5 + 0xc)) - *(int *)(param_5 + 8) < iVar13)) {
    return 0xfffffff4;
  }
  memmove((void *)((int)(void *)(iVar8 + uVar10) + iVar7),(void *)(iVar8 + uVar10),__n);
  if (bVar1) {
    iVar12 = piVar11[2] + iVar12;
    iVar8 = *(int *)(param_5 + 8) + iVar13;
    iVar7 = piVar11[4] + iVar13;
  }
  else {
    iVar12 = piVar11[2] - iVar12;
    iVar8 = *(int *)(param_5 + 8) - iVar13;
    iVar7 = piVar11[4] - iVar13;
  }
  *(int *)(param_5 + 8) = iVar8;
  piVar11[4] = iVar7;
  __dest = *(void **)(param_2 + 4);
  piVar11[2] = iVar12;
  memcpy(__dest,param_4,param_3);
  uVar10 = *(uint *)(param_1 + 0xd2c);
  iVar12 = piVar11[4] - *(int *)(param_1 + 0x1234);
  puVar3 = (undefined *)(*piVar11 + -2);
  if ((((uVar10 >> 2 & 1) != 0) && ((uVar10 >> 0x14 & 1) != 0)) && ((uVar10 >> 0x16 & 1) != 0)) {
    puVar3 = (undefined *)(*piVar11 + -10);
  }
  puVar3[1] = (char)iVar12;
  *puVar3 = (char)((uint)iVar12 >> 8);
  uVar10 = *(uint *)(param_1 + 0xd2c);
  iVar12 = piVar11[2] - *(int *)(param_1 + 0x1238);
  puVar3 = (undefined *)(*piVar11 + 1);
  if ((((uVar10 >> 2 & 1) != 0) && ((uVar10 >> 0xc & 1) != 0)) &&
     (uVar6 = (uint)*(byte *)(param_1 + 0xd27), 1 < uVar6)) {
    puVar3 = puVar3 + uVar6;
    iVar12 = iVar12 - uVar6;
  }
  if (((uVar10 >> 0xe & 1) != 0) && (iVar8 = memcmp(puVar3,puVar3 + 8,3), iVar8 != 0)) {
    return 0xfffffff4;
  }
  uVar2 = (undefined)((uint)iVar12 >> 0x10);
  *puVar3 = uVar2;
  uVar5 = (undefined)((uint)iVar12 >> 8);
  puVar3[1] = uVar5;
  puVar3[2] = (char)iVar12;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
    puVar3[10] = (char)iVar12;
    puVar3[8] = uVar2;
    puVar3[9] = uVar5;
  }
  piVar11 = (int *)piVar11[8];
  if (piVar11 == (int *)0x0) {
    return 0;
  }
  if (bVar1) {
    do {
      *piVar11 = *piVar11 + iVar13;
      if (piVar11[1] != 0) {
        piVar11[1] = piVar11[1] + iVar13;
      }
      if (piVar11[6] == 0x14) {
        if (bVar1) {
          *(int *)(param_1 + 0xc80) = *(int *)(param_1 + 0xc80) + iVar13;
        }
        else {
          *(int *)(param_1 + 0xc80) = *(int *)(param_1 + 0xc80) - iVar13;
        }
      }
      piVar11 = (int *)piVar11[8];
    } while (piVar11 != (int *)0x0);
  }
  else {
    do {
      *piVar11 = *piVar11 - iVar13;
      if (piVar11[1] != 0) {
        piVar11[1] = piVar11[1] - iVar13;
      }
      if (piVar11[6] == 0x14) {
        if (bVar1) {
          *(int *)(param_1 + 0xc80) = *(int *)(param_1 + 0xc80) + iVar13;
        }
        else {
          *(int *)(param_1 + 0xc80) = *(int *)(param_1 + 0xc80) - iVar13;
        }
        piVar11 = (int *)piVar11[8];
      }
      else {
        piVar11 = (int *)piVar11[8];
      }
    } while (piVar11 != (int *)0x0);
  }
  return 0;
}



int FUN_0044ce84(int param_1,undefined4 param_2)

{
  short sVar1;
  undefined2 uVar2;
  undefined2 uVar3;
  undefined4 uVar4;
  void *pvVar5;
  int iVar6;
  uint __size;
  undefined4 uVar7;
  undefined4 uVar8;
  int iVar9;
  code *pcVar10;
  undefined *puVar11;
  ushort local_20 [4];
  
  puVar11 = &_gp;
  iVar9 = 0;
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdfc) != 0)) {
    return 0;
  }
  sVar1 = *(short *)(param_1 + 0xc5a);
  if ((ushort)(sVar1 - 1U) < 2) {
    if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
      uVar8 = *(undefined4 *)(param_1 + 0xc50);
      iVar9 = *(int *)(param_1 + 0xc48);
      uVar2 = *(undefined2 *)(iVar9 + 0x70);
      uVar7 = *(undefined4 *)(param_1 + 0xc4c);
      uVar3 = *(undefined2 *)(param_1 + 0xc58);
      uVar4 = *(undefined4 *)(param_1 + 0xc54);
      pcVar10 = psRsaEncryptPriv;
    }
    else {
      uVar8 = *(undefined4 *)(param_1 + 0xc50);
      iVar9 = *(int *)(param_1 + 0xc48);
      uVar2 = *(undefined2 *)(iVar9 + 0x70);
      uVar7 = *(undefined4 *)(param_1 + 0xc4c);
      uVar3 = *(undefined2 *)(param_1 + 0xc58);
      uVar4 = *(undefined4 *)(param_1 + 0xc54);
      pcVar10 = privRsaEncryptSignedElement;
    }
    iVar9 = (*pcVar10)(0,iVar9 + 4,uVar7,uVar3,uVar8,uVar2,uVar4);
    if (iVar9 < 0) {
      if (iVar9 != -0xf) {
        return -0xc;
      }
      free(*(void **)(param_1 + 0xc4c));
      *(undefined4 *)(param_1 + 0xc4c) = 0;
      *(undefined2 *)(param_1 + 0xc5a) = 0;
      return -0xf;
    }
    if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdfc) == 0)) {
      __size = (uint)*(ushort *)(*(int *)(param_1 + 0xc48) + 0x70);
      *(uint *)(param_1 + 0x121c) = __size;
      pvVar5 = malloc(__size);
      *(void **)(param_1 + 0x1220) = pvVar5;
      if (pvVar5 == (void *)0x0) {
        return -8;
      }
      memcpy(pvVar5,*(void **)(param_1 + 0xc50),*(size_t *)(param_1 + 0x121c));
    }
    if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
      free(*(void **)(param_1 + 0xc4c));
      *(undefined4 *)(param_1 + 0xc4c) = 0;
    }
    if (*(short *)(param_1 + 0xc72) == 0) {
      *(undefined2 *)(param_1 + 0xc5a) = 0;
      sVar1 = *(short *)(param_1 + 0xc5a);
      *(undefined4 *)(param_1 + 0xc50) = 0;
      *(undefined4 *)(param_1 + 0xc54) = 0;
      *(undefined2 *)(param_1 + 0xc58) = 0;
      *(undefined2 *)(param_1 + 0xc5c) = 0;
    }
    else {
      *(short *)(param_1 + 0xc5a) = *(short *)(param_1 + 0xc72);
      *(undefined2 *)(param_1 + 0xc72) = 0;
      sVar1 = *(short *)(param_1 + 0xc5a);
      *(undefined4 *)(param_1 + 0xc50) = *(undefined4 *)(param_1 + 0xc68);
      *(undefined4 *)(param_1 + 0xc54) = *(undefined4 *)(param_1 + 0xc6c);
      *(undefined2 *)(param_1 + 0xc58) = *(undefined2 *)(param_1 + 0xc70);
      *(undefined2 *)(param_1 + 0xc5c) = *(undefined2 *)(param_1 + 0xc74);
      *(undefined4 *)(param_1 + 0xc68) = 0;
      *(undefined4 *)(param_1 + 0xc6c) = 0;
      *(undefined2 *)(param_1 + 0xc70) = 0;
      *(undefined2 *)(param_1 + 0xc74) = 0;
    }
  }
  if (sVar1 != 3) {
    return iVar9;
  }
  pvVar5 = malloc(*(ushort *)(param_1 + 0xc5c) + 1);
  if (pvVar5 == (void *)0x0) {
    return -8;
  }
  local_20[0] = *(short *)(param_1 + 0xc5c) + 1;
  *(undefined4 *)(param_1 + 0x122c) = 0;
  iVar6 = psEccDsaSign(0,*(int *)(param_1 + 0xc48) + 4,*(undefined4 *)(param_1 + 0xc4c),
                       *(undefined2 *)(param_1 + 0xc58),pvVar5,local_20,1,
                       *(undefined4 *)(param_1 + 0xc54),puVar11);
  if (iVar6 == 0) {
    if ((uint)*(ushort *)(param_1 + 0xc5c) == (uint)local_20[0]) {
      memcpy(*(void **)(param_1 + 0xc50),pvVar5,(uint)*(ushort *)(param_1 + 0xc5c));
    }
    else {
      iVar6 = FUN_0044c97c(param_1,(undefined4 *)(param_1 + 0xc4c),(uint)local_20[0],pvVar5,param_2,
                           0xc);
      if (iVar6 < 0) {
        if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
          free(*(void **)(param_1 + 0xc4c));
          *(undefined4 *)(param_1 + 0xc4c) = 0;
        }
        if (*(short *)(param_1 + 0xc72) == 0) {
          *(undefined2 *)(param_1 + 0xc5a) = 0;
          *(undefined2 *)(param_1 + 0xc5c) = 0;
          *(undefined2 *)(param_1 + 0xc58) = 0;
          *(undefined4 *)(param_1 + 0xc54) = 0;
          *(undefined4 *)(param_1 + 0xc50) = 0;
        }
        else {
          *(short *)(param_1 + 0xc5a) = *(short *)(param_1 + 0xc72);
          *(undefined4 *)(param_1 + 0xc50) = *(undefined4 *)(param_1 + 0xc68);
          *(undefined4 *)(param_1 + 0xc54) = *(undefined4 *)(param_1 + 0xc6c);
          *(undefined2 *)(param_1 + 0xc58) = *(undefined2 *)(param_1 + 0xc70);
          *(undefined2 *)(param_1 + 0xc5c) = *(undefined2 *)(param_1 + 0xc74);
          *(undefined2 *)(param_1 + 0xc74) = 0;
          *(undefined2 *)(param_1 + 0xc72) = 0;
          *(undefined4 *)(param_1 + 0xc68) = 0;
          *(undefined4 *)(param_1 + 0xc6c) = 0;
          *(undefined2 *)(param_1 + 0xc70) = 0;
        }
        goto LAB_0044d214;
      }
    }
    free(pvVar5);
    if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdfc) == 0)) {
      *(uint *)(param_1 + 0x121c) = (uint)local_20[0];
      pvVar5 = malloc((uint)local_20[0]);
      *(void **)(param_1 + 0x1220) = pvVar5;
      if (pvVar5 == (void *)0x0) {
        return -8;
      }
      memcpy(pvVar5,*(void **)(param_1 + 0xc50),*(size_t *)(param_1 + 0x121c));
    }
    if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
      free(*(void **)(param_1 + 0xc4c));
      *(undefined4 *)(param_1 + 0xc4c) = 0;
    }
    if (*(short *)(param_1 + 0xc72) == 0) {
      *(undefined2 *)(param_1 + 0xc5a) = 0;
      *(undefined2 *)(param_1 + 0xc5c) = 0;
      *(undefined2 *)(param_1 + 0xc58) = 0;
      *(undefined4 *)(param_1 + 0xc54) = 0;
      *(undefined4 *)(param_1 + 0xc50) = 0;
    }
    else {
      *(short *)(param_1 + 0xc5a) = *(short *)(param_1 + 0xc72);
      *(undefined4 *)(param_1 + 0xc50) = *(undefined4 *)(param_1 + 0xc68);
      *(undefined4 *)(param_1 + 0xc54) = *(undefined4 *)(param_1 + 0xc6c);
      *(undefined2 *)(param_1 + 0xc58) = *(undefined2 *)(param_1 + 0xc70);
      *(undefined2 *)(param_1 + 0xc5c) = *(undefined2 *)(param_1 + 0xc74);
      *(undefined2 *)(param_1 + 0xc74) = 0;
      *(undefined2 *)(param_1 + 0xc72) = 0;
      *(undefined4 *)(param_1 + 0xc68) = 0;
      *(undefined4 *)(param_1 + 0xc6c) = 0;
      *(undefined2 *)(param_1 + 0xc70) = 0;
    }
  }
  else {
    if (iVar6 == -0xf) {
      free(pvVar5);
      return -0xf;
    }
LAB_0044d214:
    free(pvVar5);
    iVar9 = -0xc;
  }
  return iVar9;
}



int FUN_0044d398(int param_1)

{
  int iVar1;
  undefined *puVar2;
  uint uVar3;
  short sVar4;
  size_t __size;
  void *pvVar5;
  int iVar6;
  
  uVar3 = *(uint *)(param_1 + 0xd2c);
  iVar6 = -1;
  if (((uVar3 >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdfc) != 0)) {
    _psTraceStr("psAssert %s","sslEncode.c");
    _psTraceInt(&DAT_0049016c,0x30d);
    _psError("0");
    return 0;
  }
  if ((uVar3 >> 0x11 & 1) == 0) {
    if ((ushort)(*(short *)(*(int *)(param_1 + 0xd10) + 2) - 8U) < 2) {
      sVar4 = *(short *)(param_1 + 0xc5a);
      if (sVar4 == 5) {
        iVar6 = psEccNewKey(*(undefined4 *)(param_1 + 0xc60),param_1 + 0xc34,
                            *(undefined4 *)(*(int *)(param_1 + 600) + 0x5c));
        if (iVar6 < 0) {
          return -8;
        }
        iVar6 = matrixSslGenEphemeralEcKey
                          (*(undefined4 *)(param_1 + 0xc48),*(undefined4 *)(param_1 + 0xc34),
                           *(undefined4 *)(*(int *)(param_1 + 600) + 0x5c),
                           *(undefined4 *)(param_1 + 0xc54));
        if (iVar6 < 0) {
          if (iVar6 == -0xf) {
            return -0xf;
          }
          psEccDeleteKey(param_1 + 0xc34);
          *(undefined4 *)(param_1 + 0xd30) = 0x50;
          return -0xc;
        }
        iVar1 = psEccX963ExportKey(*(undefined4 *)(param_1 + 0xc90),*(undefined4 *)(param_1 + 0xc34)
                                   ,*(undefined4 *)(param_1 + 0xc50),param_1 + 0xc5c);
        if (iVar1 < 0) {
          return -0xc;
        }
        if (*(ushort *)(param_1 + 0xc5c) != (ushort)*(byte *)(*(int *)(param_1 + 0xc50) + -1)) {
          _psTraceStr("psAssert %s","sslEncode.c");
          _psTraceInt(&DAT_0049016c,0x3ca);
          _psError("pka->user == (int32) * (pka->outbuf - 1)");
        }
        sVar4 = 6;
        if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
          *(undefined2 *)(param_1 + 0xc5a) = 6;
        }
        else {
          __size = *(ushort *)(param_1 + 0xc5c) + 1;
          *(size_t *)(param_1 + 0x121c) = __size;
          puVar2 = (undefined *)malloc(__size);
          *(undefined **)(param_1 + 0x1220) = puVar2;
          if (puVar2 == (undefined *)0x0) {
            return -8;
          }
          iVar1 = *(int *)(param_1 + 0x121c);
          pvVar5 = *(void **)(param_1 + 0xc50);
          *puVar2 = (char)*(undefined2 *)(param_1 + 0xc5c);
          memcpy(puVar2 + 1,pvVar5,iVar1 - 1);
          sVar4 = 6;
          *(undefined2 *)(param_1 + 0xc5a) = 6;
        }
      }
      if ((sVar4 == 6) &&
         (iVar6 = psEccGenSharedSecret
                            (*(undefined4 *)(param_1 + 0xc60),*(undefined4 *)(param_1 + 0xc34),
                             *(int *)(param_1 + 600) + 0x28,*(undefined4 *)(param_1 + 0x80),
                             param_1 + 0x84,*(undefined4 *)(param_1 + 0xc54)), iVar6 < 0))
      goto LAB_0044d860;
      psEccDeleteKey(param_1 + 0xc34);
    }
    else {
      if (*(short *)(param_1 + 0xc5a) != 4) {
        _psTraceStr("psAssert %s","sslEncode.c");
        _psTraceInt(&DAT_0049016c,0x402);
        _psError("pka->type == PKA_AFTER_RSA_ENCRYPT");
      }
      iVar6 = psRsaEncryptPub(*(undefined4 *)(param_1 + 0xc60),*(int *)(param_1 + 600) + 0x28,
                              *(undefined4 *)(param_1 + 0x80),*(undefined2 *)(param_1 + 0x84),
                              *(undefined4 *)(param_1 + 0xc50),*(undefined2 *)(param_1 + 0xc5c),
                              *(undefined4 *)(param_1 + 0xc54));
      if (iVar6 < 0) {
        if (iVar6 == -0xf) {
          return -0xf;
        }
        return -0xc;
      }
      if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
        pvVar5 = malloc((uint)*(ushort *)(param_1 + 0xc5c));
        *(void **)(param_1 + 0x1220) = pvVar5;
        if (pvVar5 == (void *)0x0) {
          return -8;
        }
        *(uint *)(param_1 + 0x121c) = (uint)*(ushort *)(param_1 + 0xc5c);
        memcpy(pvVar5,*(void **)(param_1 + 0xc50),(uint)*(ushort *)(param_1 + 0xc5c));
      }
    }
    if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
      free(*(void **)(param_1 + 0xc4c));
      *(undefined4 *)(param_1 + 0xc4c) = 0;
    }
    if (*(short *)(param_1 + 0xc72) != 0) {
      uVar3 = *(uint *)(param_1 + 0x1230);
      *(short *)(param_1 + 0xc5a) = *(short *)(param_1 + 0xc72);
      *(undefined4 *)(param_1 + 0xc50) = *(undefined4 *)(param_1 + 0xc68);
      *(undefined4 *)(param_1 + 0xc54) = *(undefined4 *)(param_1 + 0xc6c);
      *(undefined2 *)(param_1 + 0xc58) = *(undefined2 *)(param_1 + 0xc70);
      *(undefined2 *)(param_1 + 0xc5c) = *(undefined2 *)(param_1 + 0xc74);
      *(undefined2 *)(param_1 + 0xc72) = 0;
      *(undefined4 *)(param_1 + 0xc68) = 0;
      *(undefined4 *)(param_1 + 0xc6c) = 0;
      *(undefined2 *)(param_1 + 0xc70) = 0;
      *(undefined2 *)(param_1 + 0xc74) = 0;
      goto joined_r0x0044d684;
    }
    *(undefined2 *)(param_1 + 0xc5c) = 0;
    *(undefined2 *)(param_1 + 0xc58) = 0;
    *(undefined4 *)(param_1 + 0xc54) = 0;
    *(undefined4 *)(param_1 + 0xc50) = 0;
    *(undefined2 *)(param_1 + 0xc5a) = 0;
  }
  else if ((uVar3 >> 0x13 & 1) != 0) {
    if (*(int *)(param_1 + 0xc50) != *(int *)(param_1 + 0x80)) {
      _psTraceStr("psAssert %s","sslEncode.c");
      _psTraceInt(&DAT_0049016c,800);
      _psError("pka->outbuf == ssl->sec.premaster");
    }
    if ((*(short *)(param_1 + 0xc5a) == 6) &&
       (iVar6 = psEccGenSharedSecret
                          (*(undefined4 *)(param_1 + 0xc3c),*(undefined4 *)(param_1 + 0xc34),
                           *(undefined4 *)(param_1 + 0xc38),*(undefined4 *)(param_1 + 0x80),
                           param_1 + 0x84,*(undefined4 *)(param_1 + 0xc54)), iVar6 < 0)) {
LAB_0044d860:
      if (iVar6 == -0xf) {
        *(undefined2 *)(param_1 + 0xc5a) = 7;
        return -0xf;
      }
      free(*(void **)(param_1 + 0x80));
      *(undefined4 *)(param_1 + 0x80) = 0;
      return -0xc;
    }
    if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
      free(*(void **)(param_1 + 0xc4c));
      *(undefined4 *)(param_1 + 0xc4c) = 0;
    }
    if (*(short *)(param_1 + 0xc72) == 0) {
      *(undefined2 *)(param_1 + 0xc5c) = 0;
      *(undefined2 *)(param_1 + 0xc58) = 0;
      *(undefined4 *)(param_1 + 0xc54) = 0;
      *(undefined4 *)(param_1 + 0xc50) = 0;
      *(undefined2 *)(param_1 + 0xc5a) = 0;
    }
    else {
      *(short *)(param_1 + 0xc5a) = *(short *)(param_1 + 0xc72);
      *(undefined4 *)(param_1 + 0xc50) = *(undefined4 *)(param_1 + 0xc68);
      *(undefined4 *)(param_1 + 0xc54) = *(undefined4 *)(param_1 + 0xc6c);
      *(undefined2 *)(param_1 + 0xc58) = *(undefined2 *)(param_1 + 0xc70);
      *(undefined2 *)(param_1 + 0xc5c) = *(undefined2 *)(param_1 + 0xc74);
      *(undefined2 *)(param_1 + 0xc72) = 0;
      *(undefined4 *)(param_1 + 0xc68) = 0;
      *(undefined4 *)(param_1 + 0xc6c) = 0;
      *(undefined2 *)(param_1 + 0xc70) = 0;
      *(undefined2 *)(param_1 + 0xc74) = 0;
    }
    psEccDeleteKey(param_1 + 0xc38);
    psEccDeleteKey(param_1 + 0xc34);
  }
  uVar3 = *(uint *)(param_1 + 0x1230);
joined_r0x0044d684:
  if (((((uVar3 >> 0x11 & 1) != 0) || (iVar6 = sslCreateKeys(param_1), -1 < iVar6)) &&
      ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0)) &&
     (((*(uint *)(param_1 + 0xcfc) >> 3 & 1) == 0 && (*(int *)(param_1 + 600) != 0)))) {
    psX509FreeCert();
    *(undefined4 *)(param_1 + 600) = 0;
  }
  return iVar6;
}



void clearFlightList(int param_1)

{
  void *__ptr;
  void *pvVar1;
  
  __ptr = *(void **)(param_1 + 0xc7c);
  while (__ptr != (void *)0x0) {
    pvVar1 = *(void **)((int)__ptr + 0x20);
    free(__ptr);
    __ptr = pvVar1;
  }
  *(undefined4 *)(param_1 + 0xc7c) = 0;
  return;
}



void freePkaAfter(int param_1)

{
  short sVar1;
  undefined2 uVar2;
  undefined2 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  short sVar6;
  
  if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
    free(*(void **)(param_1 + 0xc4c));
    *(undefined4 *)(param_1 + 0xc4c) = 0;
  }
  sVar1 = *(short *)(param_1 + 0xc72);
  uVar5 = 0;
  uVar4 = 0;
  uVar3 = 0;
  uVar2 = 0;
  sVar6 = 0;
  if (sVar1 != 0) {
    uVar5 = *(undefined4 *)(param_1 + 0xc68);
    uVar4 = *(undefined4 *)(param_1 + 0xc6c);
    uVar3 = *(undefined2 *)(param_1 + 0xc70);
    uVar2 = *(undefined2 *)(param_1 + 0xc74);
    *(undefined2 *)(param_1 + 0xc72) = 0;
    *(undefined4 *)(param_1 + 0xc68) = 0;
    *(undefined4 *)(param_1 + 0xc6c) = 0;
    *(undefined2 *)(param_1 + 0xc70) = 0;
    *(undefined2 *)(param_1 + 0xc74) = 0;
    sVar6 = sVar1;
  }
  if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
    *(short *)(param_1 + 0xc5a) = sVar6;
    *(undefined4 *)(param_1 + 0xc50) = uVar5;
    *(undefined4 *)(param_1 + 0xc54) = uVar4;
    *(undefined2 *)(param_1 + 0xc58) = uVar3;
    *(undefined2 *)(param_1 + 0xc5c) = uVar2;
    free(*(void **)(param_1 + 0xc4c));
    *(undefined4 *)(param_1 + 0xc4c) = 0;
  }
  if (*(short *)(param_1 + 0xc72) != 0) {
    *(short *)(param_1 + 0xc5a) = *(short *)(param_1 + 0xc72);
    *(undefined4 *)(param_1 + 0xc50) = *(undefined4 *)(param_1 + 0xc68);
    *(undefined4 *)(param_1 + 0xc54) = *(undefined4 *)(param_1 + 0xc6c);
    *(undefined2 *)(param_1 + 0xc58) = *(undefined2 *)(param_1 + 0xc70);
    *(undefined2 *)(param_1 + 0xc5c) = *(undefined2 *)(param_1 + 0xc74);
    *(undefined2 *)(param_1 + 0xc74) = 0;
    *(undefined2 *)(param_1 + 0xc72) = 0;
    *(undefined4 *)(param_1 + 0xc68) = 0;
    *(undefined4 *)(param_1 + 0xc6c) = 0;
    *(undefined2 *)(param_1 + 0xc70) = 0;
    return;
  }
  *(undefined2 *)(param_1 + 0xc5a) = 0;
  *(undefined2 *)(param_1 + 0xc5c) = 0;
  *(undefined2 *)(param_1 + 0xc58) = 0;
  *(undefined4 *)(param_1 + 0xc54) = 0;
  *(undefined4 *)(param_1 + 0xc50) = 0;
  return;
}



int psWriteRecordInfo(int param_1,char param_2,undefined4 param_3,char *param_4,int param_5)

{
  uint uVar1;
  char *pcVar2;
  
  if (param_2 == '[') {
    param_2 = '\x16';
  }
  *param_4 = param_2;
  param_4[1] = *(char *)(param_1 + 0xd3d);
  param_4[2] = *(char *)(param_1 + 0xd3e);
  pcVar2 = param_4 + 3;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
    *(char **)(param_1 + 0xc84) = pcVar2;
    param_4[3] = *(char *)(param_1 + 0xdc9);
    pcVar2 = param_4 + 0xb;
    param_4[4] = *(char *)(param_1 + 0xdca);
    param_4[5] = *(char *)(param_1 + 0xdd1);
    param_4[6] = *(char *)(param_1 + 0xdd2);
    param_4[7] = *(char *)(param_1 + 0xdd3);
    param_4[8] = *(char *)(param_1 + 0xdd4);
    param_4[9] = *(char *)(param_1 + 0xdd5);
    param_4[10] = *(char *)(param_1 + 0xdd6);
  }
  pcVar2[1] = (char)param_3;
  *pcVar2 = (char)((uint)param_3 >> 8);
  if (param_5 == 0x14) {
    uVar1 = *(uint *)(*(int *)(param_1 + 0xd10) + 4) & 0x1800;
  }
  else {
    uVar1 = *(uint *)(param_1 + 0xd2c) >> 0x16 & 1;
  }
  if (uVar1 != 0) {
    if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
      pcVar2[2] = *(char *)(param_1 + 0xdc9);
      pcVar2[3] = *(char *)(param_1 + 0xdca);
      pcVar2[4] = *(char *)(param_1 + 0xdd1);
      pcVar2[5] = *(char *)(param_1 + 0xdd2);
      pcVar2[6] = *(char *)(param_1 + 0xdd3);
      pcVar2[7] = *(char *)(param_1 + 0xdd4);
      pcVar2[8] = *(char *)(param_1 + 0xdd5);
      pcVar2[9] = *(char *)(param_1 + 0xdd6);
      return *(int *)(param_1 + 0x1234) + 8;
    }
    *(char **)(param_1 + 0xc84) = pcVar2 + 2;
    pcVar2[2] = *(char *)(param_1 + 0x240);
    pcVar2[3] = *(char *)(param_1 + 0x241);
    pcVar2[4] = *(char *)(param_1 + 0x242);
    pcVar2[5] = *(char *)(param_1 + 0x243);
    pcVar2[6] = *(char *)(param_1 + 0x244);
    pcVar2[7] = *(char *)(param_1 + 0x245);
    pcVar2[8] = *(char *)(param_1 + 0x246);
    pcVar2[9] = *(char *)(param_1 + 0x247);
    return *(int *)(param_1 + 0x1234) + 8;
  }
  return *(int *)(param_1 + 0x1234);
}



undefined4
psWriteHandshakeHeader
          (int param_1,undefined param_2,undefined4 param_3,undefined4 param_4,undefined4 param_5,
          undefined4 param_6,undefined *param_7)

{
  param_7[1] = (char)((uint)param_3 >> 0x10);
  param_7[2] = (char)((uint)param_3 >> 8);
  *param_7 = param_2;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
    param_7[0xb] = (char)param_6;
    param_7[3] = (char)param_3;
    param_7[4] = (char)((uint)param_4 >> 8);
    param_7[5] = (char)param_4;
    param_7[6] = (char)((uint)param_5 >> 0x10);
    param_7[7] = (char)((uint)param_5 >> 8);
    param_7[8] = (char)param_5;
    param_7[9] = (char)((uint)param_6 >> 0x10);
    param_7[10] = (char)((uint)param_6 >> 8);
    *(undefined *)(param_1 + 0xd3a) = param_2;
    return *(undefined4 *)(param_1 + 0x1238);
  }
  param_7[3] = (char)param_3;
  *(undefined *)(param_1 + 0xd3a) = param_2;
  return *(undefined4 *)(param_1 + 0x1238);
}



undefined4
FUN_0044decc(int param_1,char param_2,char param_3,ushort *param_4,undefined *param_5,char **param_6
            ,int param_7,char **param_8)

{
  byte bVar1;
  char cVar2;
  char cVar3;
  short sVar4;
  uint uVar5;
  char *pcVar6;
  uint uVar7;
  ushort uVar8;
  char *pcVar9;
  int iVar10;
  ushort uVar11;
  char cVar12;
  char cVar13;
  int iVar14;
  
  iVar14 = (uint)*param_4 - *(int *)(param_1 + 0x1234);
  if (param_2 == '\x16') {
    iVar14 = iVar14 - *(int *)(param_1 + 0x1238);
  }
  if (param_2 == 'Z') {
    iVar14 = iVar14 - *(int *)(param_1 + 0x1238);
    param_2 = '\x16';
    *param_4 = (short)*(undefined4 *)(param_1 + 0xd00) + (short)*(int *)(param_1 + 0x1234);
  }
  if (param_3 == '\x14') {
    uVar5 = *(uint *)(param_1 + 0xd2c);
    if ((uVar5 >> 0xc & 1) == 0) goto LAB_0044df48;
    bVar1 = *(byte *)(*(int *)(param_1 + 0xd10) + 0xb);
    if (1 < bVar1) {
      *param_4 = *param_4 + (ushort)bVar1;
      goto LAB_0044e264;
    }
LAB_0044df58:
    if (param_3 == '\x14') goto LAB_0044e270;
LAB_0044df60:
    if ((uVar5 >> 0x14 & 1) != 0) {
      sVar4 = 8;
      if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
        sVar4 = 0x10;
      }
      if ((uVar5 >> 0x16 & 1) != 0) {
        sVar4 = sVar4 + 8;
      }
      *param_4 = sVar4 + *param_4;
    }
LAB_0044dfb4:
    *param_5 = 0;
    if (param_3 == '\x14') goto LAB_0044e2b4;
LAB_0044dfbc:
    if (((*(uint *)(param_1 + 0xd2c) >> 2 & 1) != 0) &&
       ((*(uint *)(param_1 + 0xd2c) >> 0x14 & 1) == 0)) {
      uVar11 = *param_4 + (ushort)*(byte *)(param_1 + 0xd24);
      *param_4 = uVar11;
      bVar1 = *(byte *)(param_1 + 0xd27);
      uVar8 = 0;
      if (1 < bVar1) {
        uVar8 = (ushort)bVar1 - (uVar11 - (short)*(undefined4 *)(param_1 + 0x1234) & bVar1 - 1);
      }
      *param_5 = (char)uVar8;
      *param_4 = *param_4 + (uVar8 & 0xff);
    }
  }
  else {
    uVar5 = *(uint *)(param_1 + 0xd2c);
LAB_0044df48:
    if ((((uVar5 >> 2 & 1) == 0) || ((uVar5 >> 0xc & 1) == 0)) || (*(byte *)(param_1 + 0xd27) < 2))
    goto LAB_0044df58;
    *param_4 = *param_4 + (ushort)*(byte *)(param_1 + 0xd27);
LAB_0044e264:
    if (param_3 != '\x14') goto LAB_0044df60;
LAB_0044e270:
    uVar5 = *(uint *)(*(int *)(param_1 + 0xd10) + 4);
    if ((uVar5 & 0x1800) == 0) {
      if ((uVar5 >> 6 & 1) == 0) goto LAB_0044dfb4;
      uVar8 = *param_4 + 8;
      if ((uVar5 >> 0xd & 1) != 0) goto LAB_0044e2a4;
      *param_4 = *param_4 + 0x10;
    }
    else {
      uVar8 = *param_4 + 0x10;
      if ((uVar5 >> 0xd & 1) == 0) {
        uVar8 = *param_4 + 0x18;
      }
LAB_0044e2a4:
      *param_4 = uVar8;
    }
    *param_5 = 0;
    if (param_3 != '\x14') goto LAB_0044dfbc;
LAB_0044e2b4:
    iVar10 = *(int *)(param_1 + 0xd10);
    bVar1 = *(byte *)(iVar10 + 8);
    if (bVar1 != 0) {
      if ((*(ushort *)(param_1 + 0x1232) & 1) == 0) {
        *param_4 = *param_4 + (ushort)bVar1;
      }
      else {
        *param_4 = *param_4 + 10;
      }
    }
    bVar1 = *(byte *)(iVar10 + 0xb);
    uVar8 = 0;
    if (1 < bVar1) {
      uVar8 = (ushort)bVar1 -
              ((ushort)*(byte *)param_4 - (short)*(undefined4 *)(param_1 + 0x1234) & bVar1 - 1);
    }
    *param_5 = (char)uVar8;
    *param_4 = *param_4 + (uVar8 & 0xff);
  }
  uVar5 = (uint)*param_4;
  pcVar6 = *param_8;
  if (param_7 - (int)pcVar6 < (int)uVar5) {
    return 0xffffffce;
  }
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdf8) < (int)uVar5)) {
    return 0xffffffc4;
  }
  uVar5 = uVar5 - *(int *)(param_1 + 0x1234);
  cVar3 = param_2;
  if (param_2 == '[') {
    cVar3 = '\x16';
  }
  *pcVar6 = cVar3;
  pcVar6[1] = *(char *)(param_1 + 0xd3d);
  pcVar6[2] = *(char *)(param_1 + 0xd3e);
  pcVar9 = pcVar6 + 3;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
    *(char **)(param_1 + 0xc84) = pcVar9;
    pcVar6[3] = *(char *)(param_1 + 0xdc9);
    pcVar9 = pcVar6 + 0xb;
    pcVar6[4] = *(char *)(param_1 + 0xdca);
    pcVar6[5] = *(char *)(param_1 + 0xdd1);
    pcVar6[6] = *(char *)(param_1 + 0xdd2);
    pcVar6[7] = *(char *)(param_1 + 0xdd3);
    pcVar6[8] = *(char *)(param_1 + 0xdd4);
    pcVar6[9] = *(char *)(param_1 + 0xdd5);
    pcVar6[10] = *(char *)(param_1 + 0xdd6);
  }
  pcVar9[1] = (char)uVar5;
  *pcVar9 = (char)(uVar5 >> 8);
  if (param_3 == '\x14') {
    uVar5 = *(uint *)(*(int *)(param_1 + 0xd10) + 4) & 0x1800;
    if (uVar5 != 0) {
      uVar7 = *(uint *)(param_1 + 0xd2c);
      goto LAB_0044e108;
    }
    uVar7 = *(uint *)(param_1 + 0xd2c);
  }
  else {
    uVar7 = *(uint *)(param_1 + 0xd2c);
    if ((uVar7 >> 0x16 & 1) != 0) {
LAB_0044e108:
      if ((uVar7 >> 0xe & 1) == 0) {
        *(char **)(param_1 + 0xc84) = pcVar9 + 2;
        pcVar9[2] = *(char *)(param_1 + 0x240);
        pcVar9[3] = *(char *)(param_1 + 0x241);
        pcVar9[4] = *(char *)(param_1 + 0x242);
        pcVar9[5] = *(char *)(param_1 + 0x243);
        pcVar9[6] = *(char *)(param_1 + 0x244);
        uVar5 = (uint)*(byte *)(param_1 + 0x245);
        pcVar9[7] = *(byte *)(param_1 + 0x245);
        pcVar9[8] = *(char *)(param_1 + 0x246);
        pcVar9[9] = *(char *)(param_1 + 0x247);
      }
      else {
        pcVar9[2] = *(char *)(param_1 + 0xdc9);
        pcVar9[3] = *(char *)(param_1 + 0xdca);
        pcVar9[4] = *(char *)(param_1 + 0xdd1);
        pcVar9[5] = *(char *)(param_1 + 0xdd2);
        pcVar9[6] = *(char *)(param_1 + 0xdd3);
        pcVar9[7] = *(char *)(param_1 + 0xdd4);
        pcVar9[8] = *(char *)(param_1 + 0xdd5);
        pcVar9[9] = *(char *)(param_1 + 0xdd6);
      }
      iVar10 = *(int *)(param_1 + 0x1234);
      pcVar6 = *param_8;
      *param_8 = pcVar6 + iVar10 + 8;
      uVar7 = *(uint *)(param_1 + 0xd2c);
      *param_6 = pcVar6 + iVar10 + 8;
      goto joined_r0x0044e3fc;
    }
  }
  pcVar6 = *param_8;
  iVar10 = *(int *)(param_1 + 0x1234);
  *param_8 = pcVar6 + iVar10;
  *param_6 = pcVar6 + iVar10;
joined_r0x0044e3fc:
  if (param_3 == '\x14') {
    if (((uVar7 >> 0xc & 1) != 0) && (bVar1 = *(byte *)(*(int *)(param_1 + 0xd10) + 0xb), 1 < bVar1)
       ) {
      psGetPrngLocked(*param_8,bVar1,*(undefined4 *)(param_1 + 0x1250),uVar5,&_gp);
      *param_8 = *param_8 + *(byte *)(*(int *)(param_1 + 0xd10) + 0xb);
    }
  }
  else if ((((uVar7 >> 2 & 1) != 0) && ((uVar7 >> 0xc & 1) != 0)) &&
          (1 < *(byte *)(param_1 + 0xd27))) {
    psGetPrngLocked(*param_8,*(byte *)(param_1 + 0xd27),*(undefined4 *)(param_1 + 0x1250));
    *param_8 = *param_8 + *(byte *)(param_1 + 0xd27);
  }
  iVar10 = 0;
  if (param_2 != '\x16') {
    return 0;
  }
  cVar13 = (char)iVar14;
  cVar2 = (char)((uint)iVar14 >> 8);
  cVar3 = (char)((uint)iVar14 >> 0x10);
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
    pcVar6 = *param_8;
    *pcVar6 = param_3;
    pcVar6[1] = cVar3;
    pcVar6[2] = cVar2;
    uVar5 = *(uint *)(param_1 + 0xd2c);
    cVar12 = '\0';
  }
  else {
    iVar10 = *(int *)(param_1 + 0xdec);
    pcVar6 = *param_8;
    *(int *)(param_1 + 0xdec) = iVar10 + 1;
    *pcVar6 = param_3;
    pcVar6[1] = cVar3;
    pcVar6[2] = cVar2;
    uVar5 = *(uint *)(param_1 + 0xd2c);
    cVar12 = (char)((uint)iVar10 >> 8);
  }
  if ((uVar5 >> 0xe & 1) == 0) {
    pcVar6[3] = cVar13;
  }
  else {
    pcVar6[0xb] = cVar13;
    pcVar6[4] = cVar12;
    pcVar6[5] = (char)iVar10;
    pcVar6[9] = cVar3;
    pcVar6[10] = cVar2;
    pcVar6[3] = cVar13;
    pcVar6[6] = '\0';
    pcVar6[7] = '\0';
    pcVar6[8] = '\0';
  }
  *(char *)(param_1 + 0xd3a) = param_3;
  *param_8 = *param_8 + *(int *)(param_1 + 0x1238);
  return 0;
}



undefined4
FUN_0044e628(int param_1,undefined4 param_2,int param_3,int param_4,int param_5,undefined4 param_6,
            int param_7,int *param_8)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  
  puVar1 = (undefined4 *)malloc(0x24);
  if (puVar1 == (undefined4 *)0x0) {
    return 0xfffffff8;
  }
  iVar2 = *(int *)(param_1 + 0xc7c);
  *puVar1 = 0;
  puVar1[1] = 0;
  puVar1[2] = 0;
  puVar1[3] = 0;
  puVar1[4] = 0;
  puVar1[5] = 0;
  puVar1[6] = 0;
  puVar1[7] = 0;
  puVar1[8] = 0;
  if (iVar2 == 0) {
    iVar2 = *(int *)(param_7 + 8);
    *(undefined4 **)(param_1 + 0xc7c) = puVar1;
    iVar2 = iVar2 + *(int *)(param_1 + 0x1234);
    if (param_3 == 0x14) goto LAB_0044e6d8;
LAB_0044e714:
    if ((*(uint *)(param_1 + 0xd2c) >> 0x14 & 1) == 0) goto LAB_0044e73c;
    uVar3 = *(uint *)(param_1 + 0xd2c) >> 0x16 & 1;
  }
  else {
    do {
      iVar5 = iVar2;
      iVar2 = *(int *)(iVar5 + 0x20);
    } while (iVar2 != 0);
    *(undefined4 **)(iVar5 + 0x20) = puVar1;
    iVar2 = *(int *)(param_7 + 8) + *(int *)(param_1 + 0x1234);
    if (param_3 != 0x14) goto LAB_0044e714;
LAB_0044e6d8:
    uVar3 = *(uint *)(*(int *)(param_1 + 0xd10) + 4) & 0x1800;
  }
  if (uVar3 != 0) {
    iVar2 = iVar2 + 8;
  }
LAB_0044e73c:
  iVar5 = *param_8;
  puVar1[1] = *(undefined4 *)(param_1 + 0xc84);
  puVar1[2] = iVar5 - iVar2;
  *puVar1 = param_6;
  puVar1[3] = param_2;
  puVar1[5] = param_5;
  puVar1[4] = param_4;
  puVar1[6] = param_3;
  if (param_3 == 0x14) {
    if (((*(uint *)(*(int *)(param_1 + 0xd10) + 4) & 0x1840) != 0) ||
       (iVar2 = iVar5 + 10, (*(ushort *)(param_1 + 0x1232) & 1) == 0)) {
      iVar2 = iVar5 + (uint)*(byte *)(*(int *)(param_1 + 0xd10) + 8);
    }
  }
  else {
    iVar2 = iVar5 + (uint)*(byte *)(param_1 + 0xd24);
  }
  iVar2 = iVar2 + param_5;
  iVar5 = iVar2;
  if (param_3 == 0x14) {
    uVar3 = *(uint *)(*(int *)(param_1 + 0xd10) + 4);
    if (((uVar3 & 0x1840) != 0) && (iVar5 = iVar2 + 8, (uVar3 >> 0xd & 1) == 0)) {
      iVar5 = iVar2 + 0x10;
    }
  }
  else if (((*(uint *)(param_1 + 0xd2c) >> 0x14 & 1) != 0) &&
          (iVar5 = iVar2 + 8, (*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0)) {
    iVar5 = iVar2 + 0x10;
  }
  *param_8 = iVar5;
  uVar4 = 0xfffffff4;
  if (iVar5 - *(int *)(param_7 + 8) == param_4) {
    uVar4 = 0;
  }
  return uVar4;
}



int FUN_0044e888(int param_1,int *param_2)

{
  short sVar1;
  ushort uVar2;
  int iVar3;
  int iVar4;
  undefined2 uVar5;
  int iVar6;
  void *__src;
  int iVar7;
  size_t __n;
  uint uVar8;
  undefined4 uVar9;
  undefined local_28 [2];
  short local_26;
  undefined4 local_24;
  undefined *local_20 [2];
  
  local_20[0] = (undefined *)param_2[2];
  uVar9 = *(undefined4 *)(param_1 + 0x1250);
  iVar6 = 0;
  iVar3 = param_1 + 0xc4c;
  do {
    sVar1 = *(short *)(iVar3 + 0xe);
    iVar6 = iVar6 + 1;
    if (((sVar1 == 1) || (sVar1 == 3)) || (sVar1 == 2)) goto LAB_0044e924;
    iVar3 = iVar3 + 0x18;
  } while (iVar6 < 2);
  iVar3 = param_1 + 0xc4c;
  if ((*(short *)(param_1 + 0xc5a) != 0) &&
     (iVar3 = param_1 + 0xc64, *(short *)(param_1 + 0xc72) != 0)) {
    iVar3 = 0;
  }
LAB_0044e924:
  if (iVar3 == 0) {
    return -0xc;
  }
  uVar2 = *(ushort *)(*(int *)(param_1 + 0xc48) + 0x70);
  sVar1 = (short)*(undefined4 *)(param_1 + 0x1234) + (short)*(undefined4 *)(param_1 + 0x1238) +
          uVar2;
  local_26 = sVar1 + 2;
  if (*(int *)(*(int *)(*(int *)(param_1 + 0xc48) + 0x74) + 0x1bc) == 0x206) {
    local_26 = sVar1 + 8;
    if (uVar2 != 0x84) {
      local_26 = sVar1 + 9;
    }
    if (0x7f < uVar2 + 4) {
      local_26 = local_26 + 1;
    }
    uVar8 = *(uint *)(param_1 + 0xd2c) >> 0xd;
    if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) goto LAB_0044e964;
    uVar8 = uVar8 & 1;
    if (*(int *)(param_1 + 0xdfc) == 1) {
      local_26 = (short)*(undefined4 *)(param_1 + 0x122c) + local_26;
    }
  }
  else {
    uVar8 = *(uint *)(param_1 + 0xd2c) >> 0xd;
LAB_0044e964:
    uVar8 = uVar8 & 1;
  }
  if (uVar8 != 0) {
    local_26 = local_26 + 2;
  }
  iVar6 = FUN_0044decc(param_1,0x16,0xf,&local_26,local_28,&local_24,*param_2 + param_2[3],local_20)
  ;
  if (iVar6 < 0) {
    return iVar6;
  }
  iVar6 = *(int *)(param_1 + 0xc48);
  iVar7 = *(int *)(iVar6 + 0x74);
  if (*(int *)(iVar7 + 0x1bc) == 0x206) {
    uVar8 = *(uint *)(param_1 + 0xd2c);
    uVar5 = 0x24;
    if ((uVar8 >> 0xd & 1) != 0) {
      iVar6 = *(int *)(iVar7 + 8);
      if ((iVar6 == 0x208) || (iVar6 == 0x689)) {
        *local_20[0] = 2;
        local_20[0][1] = 3;
        uVar8 = *(uint *)(param_1 + 0xd2c);
        local_20[0] = local_20[0] + 2;
        uVar5 = 0x14;
      }
      else if ((iVar6 == 0x20c) || (iVar6 == 0x68f)) {
        *local_20[0] = 4;
        local_20[0][1] = 3;
        uVar8 = *(uint *)(param_1 + 0xd2c);
        local_20[0] = local_20[0] + 2;
        uVar5 = 0x20;
      }
      else if ((iVar6 == 0x20d) || (iVar6 == 0x690)) {
        *local_20[0] = 5;
        local_20[0][1] = 3;
        uVar8 = *(uint *)(param_1 + 0xd2c);
        local_20[0] = local_20[0] + 2;
        uVar5 = 0x30;
      }
      else {
        if ((iVar6 != 0x20e) && (iVar6 != 0x691)) {
          return -0xc;
        }
        *local_20[0] = 6;
        local_20[0][1] = 3;
        uVar8 = *(uint *)(param_1 + 0xd2c);
        local_20[0] = local_20[0] + 2;
        uVar5 = 0x40;
      }
    }
    if (((uVar8 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) == 0)) {
      *(undefined2 *)(iVar3 + 0xc) = uVar5;
      iVar6 = *(int *)(param_1 + 0xc48);
      *(undefined2 *)(iVar3 + 0xe) = 3;
      uVar8 = (uint)*(ushort *)(iVar6 + 0x70);
      *(undefined4 *)(iVar3 + 8) = uVar9;
      *(undefined **)(iVar3 + 4) = local_20[0];
      iVar6 = uVar8 + 8;
      if (uVar8 != 0x84) {
        iVar6 = uVar8 + 9;
      }
      if (0x7f < iVar6 + -3) {
        iVar6 = iVar6 + 1;
      }
      local_20[0] = local_20[0] + iVar6;
      *(short *)(iVar3 + 0x10) = (short)iVar6;
      goto LAB_0044eb10;
    }
    __src = *(void **)(param_1 + 0x1224);
    __n = *(size_t *)(param_1 + 0x1228);
  }
  else {
    uVar5 = 0x24;
    if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
      *(undefined2 *)(iVar3 + 0xe) = 2;
      *local_20[0] = (char)((ushort)*(undefined2 *)(iVar6 + 0x70) >> 8);
      local_20[0][1] = (char)*(undefined2 *)(*(int *)(param_1 + 0xc48) + 0x70);
      uVar8 = *(uint *)(param_1 + 0xd2c);
      local_20[0] = local_20[0] + 2;
    }
    else {
      iVar4 = *(int *)(iVar7 + 8);
      if (((iVar4 == 0x689) || (iVar4 == 0x288)) || (iVar4 == 0x208)) {
        *local_20[0] = 2;
        local_20[0][1] = 1;
        uVar5 = 0x14;
LAB_0044eddc:
        iVar6 = *(int *)(param_1 + 0xc48);
      }
      else {
        if ((iVar4 == 0x68f) || (iVar4 == 0x20c)) {
          *local_20[0] = 4;
          local_20[0][1] = 1;
          uVar5 = 0x20;
          goto LAB_0044eddc;
        }
        if ((iVar4 == 0x690) || (iVar4 == 0x20d)) {
          *local_20[0] = 5;
          local_20[0][1] = 1;
          uVar5 = 0x30;
          goto LAB_0044eddc;
        }
        if ((iVar4 == 0x691) || (iVar4 == 0x20e)) {
          *local_20[0] = 6;
          local_20[0][1] = 1;
          uVar5 = 0x40;
          goto LAB_0044eddc;
        }
        if (iVar4 != 0x68e) {
          return -0xc;
        }
        if (*(uint *)(iVar7 + 0x18) < 2) {
          *local_20[0] = 2;
          uVar5 = 0x14;
        }
        else {
          iVar6 = *(int *)(*(int *)(iVar6 + 0x74) + 0x18);
          if (iVar6 == 2) {
            uVar5 = 0x20;
            *local_20[0] = 4;
          }
          else if (iVar6 == 3) {
            uVar5 = 0x30;
            *local_20[0] = 5;
          }
          else {
            if (iVar6 != 4) {
              return -0xc;
            }
            uVar5 = 0x40;
            *local_20[0] = 6;
          }
        }
        local_20[0][1] = 1;
        iVar6 = *(int *)(param_1 + 0xc48);
      }
      *(undefined2 *)(iVar3 + 0xe) = 1;
      local_20[0][2] = (char)((ushort)*(undefined2 *)(iVar6 + 0x70) >> 8);
      local_20[0][3] = (char)*(undefined2 *)(*(int *)(param_1 + 0xc48) + 0x70);
      uVar8 = *(uint *)(param_1 + 0xd2c);
      local_20[0] = local_20[0] + 4;
    }
    if (((uVar8 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) == 0)) {
      iVar6 = *(int *)(param_1 + 0xc48);
      *(undefined2 *)(iVar3 + 0xc) = uVar5;
      uVar2 = *(ushort *)(iVar6 + 0x70);
      *(undefined **)(iVar3 + 4) = local_20[0];
      local_20[0] = local_20[0] + uVar2;
      *(undefined4 *)(iVar3 + 8) = uVar9;
      goto LAB_0044eb10;
    }
    __src = *(void **)(param_1 + 0x1224);
    __n = *(size_t *)(param_1 + 0x1228);
    *(undefined2 *)(iVar3 + 0xe) = 0;
  }
  memcpy(local_20[0],__src,__n);
  local_20[0] = local_20[0] + *(int *)(param_1 + 0x1228);
LAB_0044eb10:
  iVar3 = FUN_0044e628(param_1,0x16,0xf,local_26,local_28[0],local_24,param_2,local_20);
  if (-1 < iVar3) {
    iVar3 = 0;
    param_2[2] = (int)local_20[0];
  }
  return iVar3;
}



char sslWritePad(char *param_1,char param_2)

{
  char cVar1;
  
  if (param_2 != '\0') {
    cVar1 = param_2;
    do {
      cVar1 = cVar1 + -1;
      *param_1 = param_2 + -1;
      param_1 = param_1 + 1;
    } while (cVar1 != '\0');
  }
  return param_2;
}



int FUN_0044efd0(int param_1,uint param_2,int param_3,int param_4,uint param_5,void *param_6,
                int param_7,char **param_8)

{
  uint uVar1;
  int iVar2;
  char *pcVar3;
  void *pvVar4;
  char *pcVar5;
  uint uVar6;
  uint uVar7;
  size_t __n;
  void *__dest;
  code *pcVar8;
  
  uVar6 = *(uint *)(param_1 + 0xd2c);
  __dest = (void *)(*(int *)(param_7 + 8) + *(int *)(param_1 + 0x1234));
  if ((uVar6 >> 0x14 & 1) != 0) {
    if ((uVar6 >> 0x16 & 1) != 0) {
      __dest = (void *)((int)__dest + 8);
    }
    *(char *)(param_1 + 0xd40) = (char)param_2;
  }
  pcVar5 = *param_8;
  uVar7 = (int)pcVar5 - (int)__dest;
  pvVar4 = param_6;
  if ((((uVar6 >> 2 & 1) == 0) || ((uVar6 >> 0xc & 1) == 0)) ||
     (uVar6 = (uint)*(byte *)(param_1 + 0xd27), uVar6 < 2)) {
    if (param_2 == 0x16) {
      iVar2 = sslUpdateHSHash(param_1,param_6,uVar7 & 0xffff);
      if (iVar2 < 0) {
        return iVar2;
      }
      if ((param_3 == 0x10) && ((*(uint *)(param_1 + 0x1230) >> 0x11 & 1) == 1)) {
        iVar2 = tlsExtendedDeriveKeys(param_1);
        if (iVar2 < 0) {
          return -0xc;
        }
        pcVar5 = *param_8;
      }
      else {
        pcVar5 = *param_8;
      }
    }
    pcVar8 = *(code **)(param_1 + 0xd1c);
    uVar6 = uVar7;
    if (pcVar8 == (code *)0x0) goto LAB_0044f09c;
  }
  else {
    if (param_2 == 0x16) {
      sslUpdateHSHash(param_1,uVar6 + (int)param_6,uVar7 - uVar6 & 0xffff);
      if ((param_3 == 0x10) && ((*(uint *)(param_1 + 0x1230) >> 0x11 & 1) == 1)) {
        iVar2 = tlsExtendedDeriveKeys(param_1);
        if (iVar2 < 0) {
          return -0xc;
        }
        pcVar5 = *param_8;
        uVar6 = (uint)*(byte *)(param_1 + 0xd27);
      }
      else {
        pcVar5 = *param_8;
        uVar6 = (uint)*(byte *)(param_1 + 0xd27);
      }
    }
    if (param_2 == 0x17) {
      iVar2 = (**(code **)(param_1 + 0xd1c))(param_1,0x17,param_6,uVar7 - uVar6,pcVar5);
      pcVar5 = *param_8 + iVar2;
      *param_8 = pcVar5;
      pvVar4 = __dest;
      if ((void *)((uint)*(byte *)(param_1 + 0xd27) + (int)__dest) != param_6) {
        iVar2 = (**(code **)(param_1 + 0xd14))(param_1,__dest,__dest);
        if (iVar2 < 0) {
          return -0xc;
        }
        pcVar5 = *param_8;
        uVar7 = uVar7 - *(byte *)(param_1 + 0xd27);
        __dest = (void *)((int)__dest + (uint)*(byte *)(param_1 + 0xd27));
        pvVar4 = param_6;
      }
      goto LAB_0044f09c;
    }
    pcVar8 = *(code **)(param_1 + 0xd1c);
    param_6 = (void *)(uVar6 + (int)param_6);
    uVar6 = uVar7 - uVar6;
  }
  iVar2 = (*pcVar8)(param_1,param_2 & 0xff,param_6,uVar6,pcVar5);
  pcVar5 = *param_8 + iVar2;
  *param_8 = pcVar5;
LAB_0044f09c:
  uVar6 = param_5 & 0xff;
  if (uVar6 != 0) {
    uVar1 = uVar6;
    do {
      uVar1 = uVar1 - 1 & 0xff;
      *pcVar5 = (char)uVar6 + -1;
      pcVar5 = pcVar5 + 1;
    } while (uVar1 != 0);
    pcVar5 = *param_8;
  }
  uVar1 = *(uint *)(param_1 + 0xd2c);
  pcVar5 = pcVar5 + uVar6;
  pcVar3 = pcVar5;
  if (((uVar1 >> 0x14 & 1) != 0) &&
     (pcVar3 = pcVar5 + 8, (*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0)) {
    pcVar3 = pcVar5 + 0x10;
  }
  *param_8 = pcVar3;
  if (pvVar4 == __dest) {
    pcVar8 = *(code **)(param_1 + 0xd14);
    iVar2 = (int)pcVar3 - (int)__dest;
    pvVar4 = __dest;
  }
  else if ((uVar1 >> 2 & 1) == 0) {
    pcVar8 = *(code **)(param_1 + 0xd14);
    iVar2 = (int)pcVar3 - (int)__dest;
  }
  else {
    uVar6 = (uint)*(byte *)(*(int *)(param_1 + 0xd10) + 0xb);
    if (uVar6 < 2) {
      uVar6 = uVar7;
      if (((uVar1 >> 0x14 & 1) != 0) &&
         (uVar6 = uVar7 + 8, (*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0)) {
        uVar6 = uVar7 + 0x10;
      }
      __n = 0;
    }
    else {
      uVar6 = uVar6 - 1;
      __n = uVar6 & uVar7;
      uVar6 = ~uVar6 & uVar7;
    }
    if ((0 < (int)uVar6) &&
       (iVar2 = (**(code **)(param_1 + 0xd14))(param_1,pvVar4,__dest,uVar6), iVar2 < 0)) {
      return -0xc;
    }
    __dest = (void *)((int)__dest + uVar6);
    if (0 < (int)__n) {
      memcpy(__dest,(void *)((int)pvVar4 + uVar6),__n);
    }
    pcVar8 = *(code **)(param_1 + 0xd14);
    iVar2 = *(byte *)(param_1 + 0xd24) + __n + param_5;
    pvVar4 = __dest;
  }
  iVar2 = (*pcVar8)(param_1,pvVar4,__dest,iVar2);
  if (-1 < iVar2) {
    if ((int)*param_8 - *(int *)(param_7 + 8) == param_4) {
      if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
        iVar2 = (int)*param_8 - *(int *)(param_7 + 8);
      }
      else {
        dtlsIncrRsn(param_1);
        iVar2 = (int)*param_8 - *(int *)(param_7 + 8);
      }
      if (iVar2 == param_4) {
        return 0;
      }
    }
  }
  return -0xc;
}



int sslEncodeClosureAlert(int param_1,int *param_2,uint *param_3)

{
  int iVar1;
  undefined local_28 [2];
  ushort local_26;
  undefined4 local_24;
  undefined *local_20 [2];
  
  if ((*(uint *)(param_1 + 0xd2c) >> 6 & 1) != 0) {
    return -0xc;
  }
  local_20[0] = (undefined *)param_2[2];
  local_26 = (short)*(undefined4 *)(param_1 + 0x1234) + 2;
  iVar1 = FUN_0044decc(param_1,0x15,0,&local_26,local_28,&local_24,*param_2 + param_2[3],local_20);
  if (-1 < iVar1) {
    *local_20[0] = 1;
    local_20[0][1] = 0;
    local_20[0] = local_20[0] + 2;
    iVar1 = FUN_0044efd0(param_1,0x15,0,local_26,local_28[0],local_24,param_2,local_20);
    if (-1 < iVar1) {
      param_2[2] = (int)local_20[0];
      return 0;
    }
  }
  *param_3 = (uint)local_26;
  return iVar1;
}



uint matrixSslEncode(int param_1,int param_2,int param_3,int param_4,uint *param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  undefined local_40 [2];
  ushort local_3e [3];
  int local_38;
  int local_34;
  int local_30;
  int local_2c;
  int local_28;
  int local_24;
  
  if (((*(uint *)(param_1 + 0xd2c) >> 6 & 1) != 0) || (*(char *)(param_1 + 0xd38) != -1)) {
    return 0xfffffff4;
  }
  if ((*(uint *)(param_1 + 0xd2c) >> 4 & 1) != 0) {
    return 0xfffffff4;
  }
  local_24 = param_2;
  if ((*(uint *)(param_1 + 0xcfc) >> 2 & 1) != 0) {
    local_3e[0] = (short)*(undefined4 *)(param_1 + 0x1234) + 1;
    uVar5 = FUN_0044decc(param_1,0x17,0,local_3e,local_40,&local_28,param_2 + param_3,&local_24);
    if ((int)uVar5 < 0) goto LAB_0044f924;
    if (*(int *)(param_1 + 0x1234) + param_2 != local_28) {
      _psTraceStr("psAssert %s","sslEncode.c");
      _psTraceInt(&DAT_0049016c,0x9d);
      _psError("encryptStart == buf + ssl->recordHeadLen");
    }
    local_24 = local_24 + 1;
    *param_5 = *param_5 - 1;
    local_38 = param_2;
    local_34 = param_2;
    local_30 = param_2;
    local_2c = param_3;
    uVar5 = FUN_0044efd0(param_1,0x17,0,local_3e[0],local_40[0],param_4,&local_38,&local_24);
    if ((int)uVar5 < 0) {
      return uVar5;
    }
    local_30 = local_30 + (local_24 - param_2);
    param_4 = param_4 + 1;
  }
  uVar5 = *(int *)(param_1 + 0x1234) + *param_5;
  local_3e[0] = (ushort)uVar5;
  if (0x4805 < (uVar5 & 0xffff)) {
    return 0xfffffff8;
  }
  uVar5 = FUN_0044decc(param_1,0x17,0,local_3e,local_40,&local_28,param_2 + param_3,&local_24);
  if (-1 < (int)uVar5) {
    local_24 = *param_5 + local_24;
    iVar1 = param_2;
    iVar2 = param_2;
    iVar3 = param_2;
    iVar4 = param_3;
    if ((*(uint *)(param_1 + 0xcfc) >> 2 & 1) != 0) {
      *(uint *)(param_1 + 0xcfc) = *(uint *)(param_1 + 0xcfc) & 0xfffffffb;
      iVar1 = local_38;
      iVar2 = local_34;
      iVar3 = local_30;
      iVar4 = local_2c;
    }
    local_2c = iVar4;
    local_30 = iVar3;
    local_34 = iVar2;
    local_38 = iVar1;
    uVar5 = FUN_0044efd0(param_1,0x17,0,local_3e[0],local_40[0],param_4,&local_38,&local_24);
    if ((int)uVar5 < 0) {
      return uVar5;
    }
    *param_5 = local_24 - param_2;
    return local_24 - param_2;
  }
LAB_0044f924:
  if (uVar5 == 0xffffffce) {
    *param_5 = (uint)local_3e[0];
  }
  return uVar5;
}



int FUN_0044f948(int param_1,int *param_2)

{
  bool bVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  int iVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined *puVar15;
  short local_28;
  undefined local_26 [2];
  undefined4 local_24;
  undefined *local_20 [2];
  
  puVar15 = &_gp;
  uVar6 = *(uint *)(param_1 + 0xd2c);
  iVar5 = *param_2;
  local_20[0] = (undefined *)param_2[2];
  iVar3 = param_2[3];
  iVar12 = 0;
  if ((uVar6 >> 0x13 & 1) != 0) {
    iVar12 = 8;
  }
  if ((*(int *)(param_1 + 0xd00) < 0x4000) && (bVar1 = iVar12 == 0, iVar12 = iVar12 + 5, bVar1)) {
    iVar12 = 7;
  }
  uVar4 = *(uint *)(param_1 + 0x1230);
  if (((uVar4 >> 0x10 & 1) != 0) && (bVar1 = iVar12 == 0, iVar12 = iVar12 + 4, bVar1)) {
    iVar12 = 6;
  }
  if (((uVar4 >> 0x11 & 1) != 0) && (bVar1 = iVar12 == 0, iVar12 = iVar12 + 4, bVar1)) {
    iVar12 = 6;
  }
  if ((*(int *)(param_1 + 0xcbc) != 0) && (*(short *)(*(int *)(param_1 + 0xcbc) + 0x5c) == 3)) {
    if (iVar12 == 0) {
      iVar12 = 2;
    }
    iVar12 = iVar12 + 4;
  }
  if (((uVar4 >> 0xf & 1) != 0) && (bVar1 = iVar12 == 0, iVar12 = iVar12 + 4, bVar1)) {
    iVar12 = 6;
  }
  if (((uVar4 >> 0x14 & 1) != 0) && (bVar1 = iVar12 == 0, iVar12 = iVar12 + 4, bVar1)) {
    iVar12 = 6;
  }
  local_28 = (short)iVar12 +
             (short)*(undefined4 *)(param_1 + 0x1234) + (short)*(undefined4 *)(param_1 + 0x1238) +
             0x46;
  if (((uVar6 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) != 1)) {
    iVar2 = psGetPrngLocked(param_1 + 0x30,0x20,*(undefined4 *)(param_1 + 0x1250));
    if (iVar2 < 0) {
      return -0xc;
    }
    uVar6 = *(uint *)(param_1 + 0xd2c);
  }
  if ((uVar6 >> 3 & 1) == 0) {
    matrixRegisterSession(param_1);
  }
  local_28 = (ushort)*(byte *)(param_1 + 0xc98) + local_28 + -0x20;
  iVar3 = FUN_0044decc(param_1,0x16,2,&local_28,local_26,&local_24,iVar5 + iVar3,local_20,puVar15);
  if (-1 < iVar3) {
    *local_20[0] = *(undefined *)(param_1 + 0xd3d);
    local_20[0][1] = *(undefined *)(param_1 + 0xd3e);
    uVar7 = *(undefined4 *)(param_1 + 0x40);
    uVar8 = *(undefined4 *)(param_1 + 0x44);
    uVar9 = *(undefined4 *)(param_1 + 0x48);
    uVar10 = *(undefined4 *)(param_1 + 0x4c);
    uVar13 = *(undefined4 *)(param_1 + 0x34);
    uVar14 = *(undefined4 *)(param_1 + 0x38);
    uVar11 = *(undefined4 *)(param_1 + 0x3c);
    *(undefined4 *)(local_20[0] + 2) = *(undefined4 *)(param_1 + 0x30);
    *(undefined4 *)(local_20[0] + 6) = uVar13;
    *(undefined4 *)(local_20[0] + 10) = uVar14;
    *(undefined4 *)(local_20[0] + 0xe) = uVar11;
    *(undefined4 *)(local_20[0] + 0x12) = uVar7;
    *(undefined4 *)(local_20[0] + 0x16) = uVar8;
    *(undefined4 *)(local_20[0] + 0x1a) = uVar9;
    *(undefined4 *)(local_20[0] + 0x1e) = uVar10;
    local_20[0][0x22] = *(undefined *)(param_1 + 0xc98);
    local_20[0] = local_20[0] + 0x23;
    if (*(byte *)(param_1 + 0xc98) != 0) {
      memcpy(local_20[0],(void *)(param_1 + 0xc99),(uint)*(byte *)(param_1 + 0xc98));
      local_20[0] = local_20[0] + *(byte *)(param_1 + 0xc98);
    }
    *local_20[0] = (char)((ushort)**(undefined2 **)(param_1 + 0xd10) >> 8);
    local_20[0][1] = (char)**(undefined2 **)(param_1 + 0xd10);
    local_20[0][2] = 0;
    puVar15 = local_20[0] + 3;
    if (iVar12 != 0) {
      local_20[0][3] = (char)((uint)(iVar12 + -2) >> 8);
      local_20[0][4] = (char)(iVar12 + -2);
      puVar15 = local_20[0] + 5;
      if (*(int *)(param_1 + 0xd00) < 0x4000) {
        local_20[0][5] = 0;
        local_20[0][6] = 1;
        local_20[0][7] = 0;
        local_20[0][8] = 1;
        iVar3 = *(int *)(param_1 + 0xd00);
        puVar15 = local_20[0] + 9;
        if (iVar3 == 0x200) {
          local_20[0][9] = 1;
          iVar3 = *(int *)(param_1 + 0xd00);
          puVar15 = local_20[0] + 10;
        }
        local_20[0] = puVar15;
        if (iVar3 == 0x400) {
          *puVar15 = 2;
          iVar3 = *(int *)(param_1 + 0xd00);
          local_20[0] = puVar15 + 1;
        }
        if (iVar3 == 0x800) {
          *local_20[0] = 3;
          iVar3 = *(int *)(param_1 + 0xd00);
          local_20[0] = local_20[0] + 1;
        }
        puVar15 = local_20[0];
        if (iVar3 == 0x1000) {
          *local_20[0] = 4;
          puVar15 = local_20[0] + 1;
        }
      }
      local_20[0] = puVar15;
      uVar6 = *(uint *)(param_1 + 0x1230);
      if ((uVar6 >> 0x10 & 1) != 0) {
        *local_20[0] = 0;
        local_20[0][1] = 4;
        local_20[0][2] = 0;
        local_20[0][3] = 0;
        uVar6 = *(uint *)(param_1 + 0x1230);
        local_20[0] = local_20[0] + 4;
      }
      if ((uVar6 >> 0x11 & 1) != 0) {
        *local_20[0] = 0;
        local_20[0][1] = 0x17;
        local_20[0][2] = 0;
        local_20[0][3] = 0;
        local_20[0] = local_20[0] + 4;
      }
      if ((*(int *)(param_1 + 0xcbc) != 0) && (*(short *)(*(int *)(param_1 + 0xcbc) + 0x5c) == 3)) {
        *local_20[0] = 0;
        local_20[0][1] = 0x23;
        local_20[0][2] = 0;
        local_20[0][3] = 0;
        local_20[0] = local_20[0] + 4;
      }
      uVar6 = *(uint *)(param_1 + 0x1230);
      if ((uVar6 >> 0xf & 1) != 0) {
        *local_20[0] = 0;
        local_20[0][1] = 0;
        local_20[0][2] = 0;
        local_20[0][3] = 0;
        uVar6 = *(uint *)(param_1 + 0x1230);
        local_20[0] = local_20[0] + 4;
      }
      if ((uVar6 >> 0x14 & 1) != 0) {
        *local_20[0] = 0;
        local_20[0][1] = 5;
        local_20[0][2] = 0;
        local_20[0][3] = 0;
        local_20[0] = local_20[0] + 4;
      }
      puVar15 = local_20[0];
      if ((*(uint *)(param_1 + 0xd2c) >> 0x13 & 1) != 0) {
        *local_20[0] = 0;
        local_20[0][1] = 0xb;
        local_20[0][2] = 0;
        local_20[0][3] = 2;
        local_20[0][4] = 1;
        local_20[0][5] = 0;
        puVar15 = local_20[0] + 6;
      }
    }
    local_20[0] = puVar15;
    iVar3 = FUN_0044e628(param_1,0x16,2,local_28,local_26[0],local_24,param_2,local_20);
    if ((-1 < iVar3) &&
       (((*(uint *)(param_1 + 0xd2c) >> 3 & 1) == 0 || (iVar3 = sslCreateKeys(param_1), -1 < iVar3))
       )) {
      iVar3 = 0;
      param_2[2] = (int)local_20[0];
    }
  }
  return iVar3;
}



int FUN_004500f8(int param_1,int *param_2)

{
  ushort uVar1;
  undefined *puVar2;
  undefined uVar3;
  short sVar4;
  undefined2 uVar5;
  int iVar6;
  void *__ptr;
  void **ppvVar7;
  undefined *puVar8;
  uint uVar9;
  undefined2 uVar10;
  void *pvVar11;
  undefined local_108 [2];
  short local_106 [3];
  undefined auStack_100 [208];
  ushort local_30 [2];
  undefined4 local_2c;
  undefined *local_28 [2];
  
  uVar9 = *(uint *)(param_1 + 0xd2c);
  local_28[0] = (undefined *)param_2[2];
  local_106[0] = 0;
  pvVar11 = *(void **)(param_1 + 0x1250);
  if ((uVar9 >> 0x13 & 1) != 0) {
    local_30[0] = (ushort)**(byte **)(*(int *)(param_1 + 0xc34) + 0x34) * 2 + 1;
    if ((uVar9 >> 0xf & 1) == 0) {
      if ((uVar9 >> 0x10 & 1) != 0) {
        uVar1 = *(ushort *)(*(int *)(param_1 + 0xc48) + 0x70);
        sVar4 = local_30[0] +
                (short)*(undefined4 *)(param_1 + 0x1234) + (short)*(undefined4 *)(param_1 + 0x1238);
        local_106[0] = sVar4 + 6;
        if (uVar1 != 0x84) {
          local_106[0] = sVar4 + 7;
        }
        sVar4 = uVar1 + local_106[0];
        local_106[0] = sVar4 + 6;
        if (0x7f < uVar1 + 4) {
          local_106[0] = sVar4 + 7;
        }
        if (((uVar9 >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdfc) == 1)) {
          local_106[0] = (short)*(undefined4 *)(param_1 + 0x122c) + local_106[0];
        }
      }
    }
    else {
      local_106[0] = local_30[0] +
                     (short)*(undefined4 *)(param_1 + 0x1234) +
                     (short)*(undefined4 *)(param_1 + 0x1238) +
                     *(short *)(*(int *)(param_1 + 0xc48) + 0x70) + 6;
    }
  }
  if (local_106[0] == 0) {
    return -0xc;
  }
  if ((uVar9 >> 0xd & 1) != 0) {
    local_106[0] = local_106[0] + 2;
  }
  iVar6 = FUN_0044decc(param_1,0x16,0xc,local_106,local_108,&local_2c,*param_2 + param_2[3],local_28
                      );
  puVar2 = local_28[0];
  if (iVar6 < 0) {
    return iVar6;
  }
  uVar9 = *(uint *)(param_1 + 0xd2c);
  if ((uVar9 >> 0x13 & 1) != 0) {
    *local_28[0] = 3;
    local_28[0][1] =
         (char)((ushort)*(undefined2 *)(*(int *)(*(int *)(param_1 + 0xc34) + 0x34) + 2) >> 8);
    local_28[0][2] = (char)*(undefined2 *)(*(int *)(*(int *)(param_1 + 0xc34) + 0x34) + 2);
    local_28[0][3] = (char)local_30[0];
    local_28[0] = local_28[0] + 4;
    iVar6 = psEccX963ExportKey(*(undefined4 *)(param_1 + 0xc90),*(undefined4 *)(param_1 + 0xc34),
                               local_28[0],local_30);
    if (iVar6 != 0) {
      return -0xc;
    }
    uVar9 = *(uint *)(param_1 + 0xd2c);
    local_28[0] = local_28[0] + local_30[0];
  }
  if ((uVar9 >> 0xf & 1) != 0) {
    __ptr = malloc(0x30);
    if (__ptr == (void *)0x0) {
      return -8;
    }
    if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
      psMd5Sha1Init(auStack_100);
      psMd5Sha1Update(auStack_100,param_1 + 0x10,0x20);
      psMd5Sha1Update(auStack_100,param_1 + 0x30,0x20);
      psMd5Sha1Update(auStack_100,puVar2,(int)local_28[0] - (int)puVar2);
      psMd5Sha1Final(auStack_100,__ptr);
      uVar10 = 0x24;
    }
    else {
      iVar6 = *(int *)(*(int *)(*(int *)(param_1 + 0xc48) + 0x74) + 8);
      if (iVar6 == 0x68f) {
        psSha256Init(auStack_100);
        psSha256Update(auStack_100,param_1 + 0x10,0x20);
        psSha256Update(auStack_100,param_1 + 0x30,0x20);
        psSha256Update(auStack_100,puVar2,(int)local_28[0] - (int)puVar2);
        psSha256Final(auStack_100,__ptr);
        uVar10 = 0x20;
        puVar8 = local_28[0] + 2;
        uVar3 = 4;
      }
      else if (iVar6 == 0x690) {
        psSha384Init(auStack_100);
        psSha384Update(auStack_100,param_1 + 0x10,0x20);
        psSha384Update(auStack_100,param_1 + 0x30,0x20);
        psSha384Update(auStack_100,puVar2,(int)local_28[0] - (int)puVar2);
        psSha384Final(auStack_100,__ptr);
        uVar10 = 0x30;
        puVar8 = local_28[0] + 2;
        uVar3 = 5;
      }
      else {
        if ((iVar6 != 0x689) && (iVar6 != 0x288)) goto LAB_004502f4;
        psSha1Init(auStack_100);
        psSha1Update(auStack_100,param_1 + 0x10,0x20);
        psSha1Update(auStack_100,param_1 + 0x30,0x20);
        psSha1Update(auStack_100,puVar2,(int)local_28[0] - (int)puVar2);
        psSha1Final(auStack_100,__ptr);
        uVar10 = 0x14;
        puVar8 = local_28[0] + 2;
        uVar3 = 2;
      }
      *local_28[0] = uVar3;
      local_28[0][1] = 1;
      local_28[0] = puVar8;
    }
    *local_28[0] = (char)((ushort)*(undefined2 *)(*(int *)(param_1 + 0xc48) + 0x70) >> 8);
    local_28[0][1] = (char)*(undefined2 *)(*(int *)(param_1 + 0xc48) + 0x70);
    uVar9 = *(uint *)(param_1 + 0xd2c);
    local_28[0] = local_28[0] + 2;
    if (((uVar9 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) != 1)) {
      ppvVar7 = (void **)(param_1 + 0xc4c);
      if ((*(short *)(param_1 + 0xc5a) != 0) &&
         (ppvVar7 = (void **)(param_1 + 0xc64), *(short *)(param_1 + 0xc72) != 0)) {
        ppvVar7 = (void **)0x0;
      }
      uVar5 = 2;
      if ((uVar9 >> 0xd & 1) != 0) {
        uVar5 = 1;
      }
      iVar6 = *(int *)(param_1 + 0xc48);
      *(undefined2 *)(ppvVar7 + 3) = uVar10;
      *(undefined2 *)((int)ppvVar7 + 0xe) = uVar5;
      uVar1 = *(ushort *)(iVar6 + 0x70);
      *ppvVar7 = __ptr;
      ppvVar7[1] = local_28[0];
      ppvVar7[2] = pvVar11;
      local_28[0] = local_28[0] + uVar1;
    }
    else {
      free(__ptr);
      memcpy(local_28[0],*(void **)(param_1 + 0x1220),*(size_t *)(param_1 + 0x121c));
      uVar9 = *(uint *)(param_1 + 0xd2c);
      local_28[0] = local_28[0] + *(int *)(param_1 + 0x121c);
    }
  }
  if ((uVar9 >> 0x10 & 1) == 0) goto LAB_0045041c;
  __ptr = malloc(0x30);
  if (__ptr == (void *)0x0) {
    return -8;
  }
  uVar9 = *(uint *)(param_1 + 0xd2c);
  if (((uVar9 >> 0xd & 1) == 0) ||
     (*(int *)(*(int *)(*(int *)(param_1 + 0xc48) + 0x74) + 8) != 0x20c)) {
    if (((uVar9 >> 0xd & 1) != 0) &&
       (*(int *)(*(int *)(*(int *)(param_1 + 0xc48) + 0x74) + 8) == 0x20d)) {
      psSha384Init(auStack_100);
      psSha384Update(auStack_100,param_1 + 0x10,0x20);
      psSha384Update(auStack_100,param_1 + 0x30,0x20);
      psSha384Update(auStack_100,puVar2,(int)local_28[0] - (int)puVar2);
      psSha384Final(auStack_100,__ptr);
      uVar10 = 0x30;
      uVar3 = 5;
      goto LAB_004507a8;
    }
    if (((2 < *(byte *)(param_1 + 0xd3e)) && (*(byte *)(param_1 + 0xd3e) != 0xff)) &&
       (((uVar9 >> 0xd & 1) == 0 ||
        (*(int *)(*(int *)(*(int *)(param_1 + 0xc48) + 0x74) + 8) != 0x208)))) {
LAB_004502f4:
      free(__ptr);
      return -10;
    }
    psSha1Init(auStack_100);
    psSha1Update(auStack_100,param_1 + 0x10,0x20);
    psSha1Update(auStack_100,param_1 + 0x30,0x20);
    psSha1Update(auStack_100,puVar2,(int)local_28[0] - (int)puVar2);
    psSha1Final(auStack_100,__ptr);
    uVar9 = *(uint *)(param_1 + 0xd2c);
    uVar10 = 0x14;
    if ((uVar9 >> 0xd & 1) != 0) {
      *local_28[0] = 2;
      local_28[0][1] = 3;
      local_28[0] = local_28[0] + 2;
      uVar9 = *(uint *)(param_1 + 0xd2c);
    }
  }
  else {
    psSha256Init(auStack_100);
    psSha256Update(auStack_100,param_1 + 0x10,0x20);
    psSha256Update(auStack_100,param_1 + 0x30,0x20);
    psSha256Update(auStack_100,puVar2,(int)local_28[0] - (int)puVar2);
    psSha256Final(auStack_100,__ptr);
    uVar10 = 0x20;
    uVar3 = 4;
LAB_004507a8:
    *local_28[0] = uVar3;
    local_28[0][1] = 3;
    uVar9 = *(uint *)(param_1 + 0xd2c);
    local_28[0] = local_28[0] + 2;
  }
  if (((uVar9 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) != 1)) {
    ppvVar7 = (void **)(param_1 + 0xc4c);
    if (*(short *)(param_1 + 0xc5a) != 0) {
      if (*(short *)(param_1 + 0xc72) != 0) {
        return -7;
      }
      ppvVar7 = (void **)(param_1 + 0xc64);
    }
    if (ppvVar7 == (void **)0x0) {
      return -7;
    }
    iVar6 = *(int *)(param_1 + 0xc48);
    *(undefined2 *)((int)ppvVar7 + 0xe) = 3;
    *(undefined2 *)(ppvVar7 + 3) = uVar10;
    uVar9 = (uint)*(ushort *)(iVar6 + 0x70);
    *ppvVar7 = __ptr;
    ppvVar7[2] = pvVar11;
    ppvVar7[1] = local_28[0];
    iVar6 = uVar9 + 8;
    if (uVar9 != 0x84) {
      iVar6 = uVar9 + 9;
    }
    if (0x7f < iVar6 + -3) {
      iVar6 = iVar6 + 1;
    }
    local_28[0] = local_28[0] + iVar6;
    *(short *)(ppvVar7 + 4) = (short)iVar6;
  }
  else {
    free(__ptr);
    memcpy(local_28[0],*(void **)(param_1 + 0x1220),*(size_t *)(param_1 + 0x121c));
    local_28[0] = local_28[0] + *(int *)(param_1 + 0x121c);
  }
LAB_0045041c:
  iVar6 = FUN_0044e628(param_1,0x16,0xc,local_106[0],local_108[0],local_2c,param_2,local_28);
  if (iVar6 < 0) {
    return iVar6;
  }
  param_2[2] = (int)local_28[0];
  return 0;
}



int FUN_00450b90(int param_1,int *param_2,int param_3)

{
  ushort *puVar1;
  ushort uVar2;
  short sVar3;
  int iVar4;
  undefined *puVar5;
  undefined uVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  int iVar13;
  int iVar14;
  size_t __n;
  uint uVar15;
  uint uVar16;
  undefined local_48 [2];
  short local_46;
  undefined local_44 [2];
  ushort local_42;
  undefined4 local_40;
  undefined *local_3c;
  undefined4 local_38;
  undefined *local_34;
  int local_30;
  int local_2c;
  
  iVar4 = 0;
  if ((*(uint *)(param_1 + 0xd2c) >> 0x12 & 1) == 0) {
    iVar8 = *param_2;
    local_34 = (undefined *)param_2[2];
    iVar7 = param_2[3];
    iVar4 = 0;
    iVar13 = 0;
    if (param_3 != 0) {
      for (iVar10 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74); iVar10 != 0;
          iVar10 = *(int *)(iVar10 + 0x31c)) {
        while (iVar4 = iVar4 + 1, *(int *)(iVar10 + 0x310) == 0) {
          _psTraceStr("psAssert %s","sslEncode.c");
          _psTraceInt(&DAT_0049016c,0x144f);
          _psError("cert->unparsedBin != NULL");
          puVar1 = (ushort *)(iVar10 + 0x314);
          iVar10 = *(int *)(iVar10 + 0x31c);
          iVar13 = iVar13 + (uint)*puVar1;
          if (iVar10 == 0) goto LAB_00450cbc;
        }
        iVar13 = iVar13 + (uint)*(ushort *)(iVar10 + 0x314);
      }
    }
LAB_00450cbc:
    iVar11 = iVar4 * 3 + 3;
    iVar10 = iVar13 + iVar11;
    iVar14 = *(int *)(param_1 + 0xd00);
    sVar3 = (short)*(int *)(param_1 + 0x1238);
    if (iVar14 < iVar10 + *(int *)(param_1 + 0x1238)) {
      __n = 0;
      local_3c = (undefined *)param_2[2];
      local_30 = *param_2 + param_2[3];
      uVar12 = 0;
      local_2c = 0;
      iVar7 = 0;
      if (iVar13 < 1) {
LAB_004513ac:
        iVar4 = 0;
        param_2[2] = (int)local_3c;
      }
      else {
        local_42 = (short)iVar10 + (short)*(undefined4 *)(param_1 + 0x1234) + sVar3;
        iVar4 = FUN_0044decc(param_1,0x5a,0xb,&local_42,local_44,&local_40,local_30,&local_3c);
        if (-1 < iVar4) {
          iVar10 = iVar10 + -3;
          *local_3c = (char)((uint)iVar10 >> 0x10);
          local_3c[1] = (char)((uint)iVar10 >> 8);
          local_3c[2] = (char)iVar10;
          local_3c = local_3c + 3;
          iVar4 = (iVar14 - *(int *)(param_1 + 0x1238)) + -3;
          puVar5 = local_3c;
          if (param_3 != 0) {
            for (iVar7 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74); puVar5 = local_3c, iVar7 != 0;
                iVar7 = *(int *)(iVar7 + 0x31c)) {
              __n = 0;
              if (*(int *)(iVar7 + 0x310) == 0) {
                _psTraceStr("psAssert %s","sslEncode.c");
                _psTraceInt(&DAT_0049016c,0x130e);
                _psError("cert->unparsedBin != NULL");
              }
              uVar2 = *(ushort *)(iVar7 + 0x314);
              uVar12 = (uint)uVar2;
              if (uVar12 != 0) {
                uVar6 = (undefined)(uVar2 >> 8);
                if (iVar4 < 4) {
                  *local_3c = 0;
                  local_2c = 2;
                  puVar5 = local_3c + 1;
                  if (iVar4 != 1) {
                    local_3c[1] = uVar6;
                    local_2c = 1;
                    puVar5 = local_3c + 2;
                    if (iVar4 != 2) {
                      local_3c[2] = (char)uVar2;
                      local_2c = 0;
                      puVar5 = local_3c + 3;
                    }
                  }
                  break;
                }
                uVar15 = iVar4 - 3;
                *local_3c = 0;
                local_3c[1] = uVar6;
                local_3c[2] = (char)uVar2;
                local_3c = local_3c + 3;
                __n = uVar15;
                if (uVar12 < uVar15) {
                  __n = uVar12;
                }
                memcpy(local_3c,*(void **)(iVar7 + 0x310),__n);
                iVar4 = uVar15 - __n;
                local_3c = local_3c + __n;
                uVar12 = uVar12 - __n;
                iVar13 = iVar13 - __n;
                puVar5 = local_3c;
                if (iVar4 == 0) break;
              }
            }
          }
          local_3c = puVar5;
          iVar4 = FUN_0044e628(param_1,0x16,0xb,local_42,local_44[0],local_40,param_2,&local_3c);
          while (-1 < iVar4) {
            if (iVar13 < 1) goto LAB_004513ac;
            param_2[2] = (int)local_3c;
            if (iVar7 == 0) {
              return -1;
            }
            if (local_2c < 1) {
              local_42 = 0;
            }
            else {
              local_42 = (ushort)local_2c;
            }
            uVar9 = *(uint *)(param_1 + 0xd00);
            uVar15 = uVar12 + local_42;
            if (uVar9 < local_42 + uVar12) {
              local_42 = (ushort)uVar9 + local_42;
            }
            else {
              iVar4 = *(int *)(iVar7 + 0x31c);
              local_42 = (ushort)uVar15;
              if (iVar4 != 0) {
                do {
                  uVar16 = uVar15 & 0xffff;
                  uVar15 = *(ushort *)(iVar4 + 0x314) + uVar15 + 3;
                  local_42 = (ushort)uVar9;
                  if (uVar9 < uVar16 + *(ushort *)(iVar4 + 0x314) + 3) goto LAB_0045107c;
                  iVar4 = *(int *)(iVar4 + 0x31c);
                } while (iVar4 != 0);
                local_42 = (ushort)uVar15;
              }
            }
LAB_0045107c:
            uVar15 = (uint)local_42;
            local_42 = (short)*(undefined4 *)(param_1 + 0x1234) + local_42;
            iVar4 = FUN_0044decc(param_1,0x5b,0xb,&local_42,local_44,&local_40,local_30,&local_3c);
            if (iVar4 < 0) {
              return iVar4;
            }
            if (0 < local_2c) {
              if (local_2c == 2) {
                *local_3c = (char)(uVar12 >> 8);
                uVar15 = uVar15 - 2;
                puVar5 = local_3c + 1;
                local_3c[1] = (char)uVar12;
              }
              else {
                uVar15 = uVar15 - 1;
                *local_3c = (char)uVar12;
                puVar5 = local_3c;
              }
              local_3c = puVar5 + 1;
              local_2c = 0;
            }
            if (uVar15 < uVar12) {
              memcpy(local_3c,(void *)(*(int *)(iVar7 + 0x310) + __n),uVar15);
              __n = __n + uVar15;
              local_3c = local_3c + uVar15;
              uVar12 = uVar12 - uVar15;
              iVar13 = iVar13 - uVar15;
            }
            else {
              memcpy(local_3c,(void *)(*(int *)(iVar7 + 0x310) + __n),uVar12);
              iVar4 = uVar15 - uVar12;
              puVar5 = local_3c + uVar12;
              iVar13 = iVar13 - uVar12;
              uVar12 = 0;
              local_3c = puVar5;
              if (0 < iVar4) {
                while( true ) {
                  iVar7 = *(int *)(iVar7 + 0x31c);
                  uVar15 = iVar4 - 3;
                  if (iVar7 == 0) {
                    return -1;
                  }
                  uVar2 = *(ushort *)(iVar7 + 0x314);
                  uVar12 = (uint)uVar2;
                  __n = 0;
                  uVar6 = (undefined)(uVar2 >> 8);
                  if (iVar4 < 4) break;
                  *puVar5 = 0;
                  puVar5[1] = uVar6;
                  puVar5[2] = (char)uVar2;
                  local_3c = puVar5 + 3;
                  __n = uVar15;
                  if (uVar12 < uVar15) {
                    __n = uVar12;
                  }
                  memcpy(local_3c,*(void **)(iVar7 + 0x310),__n);
                  iVar4 = uVar15 - __n;
                  puVar5 = local_3c + __n;
                  uVar12 = uVar12 - __n;
                  iVar13 = iVar13 - __n;
                  local_3c = puVar5;
                  if ((iVar4 == 0) || (iVar4 < 1)) goto LAB_00451154;
                }
                *puVar5 = 0;
                local_3c = puVar5 + 1;
                local_2c = 2;
                if (iVar4 != 1) {
                  puVar5[1] = uVar6;
                  local_3c = puVar5 + 2;
                  local_2c = 1;
                  if (iVar4 != 2) {
                    puVar5[2] = (char)uVar2;
                    local_2c = 0;
                    local_3c = puVar5 + 3;
                  }
                }
              }
            }
LAB_00451154:
            iVar4 = FUN_0044e628(param_1,0x16,0xb,local_42,local_44[0],local_40,param_2,&local_3c);
          }
        }
      }
    }
    else {
      local_46 = (short)*(undefined4 *)(param_1 + 0x1234) + sVar3 + (short)iVar11 + (short)iVar13;
      iVar4 = FUN_0044decc(param_1,0x16,0xb,&local_46,local_48,&local_38,iVar8 + iVar7,&local_34);
      if (iVar4 < 0) {
        if ((((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (iVar4 == -0x3c)) &&
           (iVar4 = dtlsWriteCertificate(param_1,iVar13,iVar11,local_34), -1 < iVar4)) {
          param_2[2] = (int)(local_34 + iVar4);
          iVar4 = 0;
        }
      }
      else {
        iVar10 = iVar10 + -3;
        *local_34 = (char)((uint)iVar10 >> 0x10);
        local_34[1] = (char)((uint)iVar10 >> 8);
        local_34[2] = (char)iVar10;
        local_34 = local_34 + 3;
        if (param_3 != 0) {
          for (iVar4 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74); iVar4 != 0;
              iVar4 = *(int *)(iVar4 + 0x31c)) {
            if (*(int *)(iVar4 + 0x310) == 0) {
              _psTraceStr("psAssert %s","sslEncode.c");
              _psTraceInt(&DAT_0049016c,0x1495);
              _psError("cert->unparsedBin != NULL");
              uVar2 = *(ushort *)(iVar4 + 0x314);
            }
            else {
              uVar2 = *(ushort *)(iVar4 + 0x314);
            }
            uVar12 = (uint)uVar2;
            if (uVar12 != 0) {
              *local_34 = 0;
              local_34[1] = (char)(uVar2 >> 8);
              local_34[2] = (char)uVar2;
              local_34 = local_34 + 3;
              memcpy(local_34,*(void **)(iVar4 + 0x310),uVar12);
              local_34 = local_34 + uVar12;
            }
          }
        }
        iVar4 = FUN_0044e628(param_1,0x16,0xb,local_46,local_48[0],local_38,param_2,&local_34);
        if (-1 < iVar4) {
          iVar4 = 0;
          param_2[2] = (int)local_34;
        }
      }
    }
  }
  return iVar4;
}



int matrixSslEncodeClientHello
              (int param_1,int *param_2,short *param_3,uint param_4,uint *param_5,int param_6,
              short *param_7)

{
  int *piVar1;
  bool bVar2;
  byte bVar3;
  short sVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  char cVar8;
  int iVar9;
  undefined4 uVar10;
  void *pvVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  int iVar15;
  short *psVar16;
  undefined uVar17;
  undefined4 uVar18;
  undefined4 uVar19;
  undefined4 uVar20;
  undefined *puVar21;
  undefined local_80 [2];
  ushort local_7e [3];
  undefined local_78;
  undefined local_77;
  undefined local_76;
  undefined local_75;
  undefined local_74;
  undefined local_73;
  undefined local_72;
  undefined local_71;
  undefined local_70;
  undefined local_6f;
  undefined local_6e;
  undefined local_6d;
  undefined local_6c;
  undefined local_6b;
  undefined local_6a;
  undefined local_69;
  undefined local_68;
  undefined local_67;
  undefined auStack_60 [32];
  byte local_40 [4];
  undefined4 local_3c;
  undefined *local_38;
  uint local_34;
  int local_30;
  undefined *local_2c;
  
  puVar21 = &_gp;
  param_4 = param_4 & 0xff;
  *param_5 = 0;
  local_2c = (undefined *)0x0;
  if ((((param_2 == (int *)0x0) || (*param_2 == 0)) || (param_1 == 0)) || (param_7 == (short *)0x0))
  {
    return -6;
  }
  if (param_4 != 0) {
    if (param_3 == (short *)0x0) {
      return -6;
    }
    if (*param_3 == 0) {
      return -6;
    }
  }
  uVar5 = *(uint *)(param_1 + 0xd2c);
  if (((((uVar5 >> 6 & 1) != 0) || ((uVar5 >> 4 & 1) != 0)) || ((uVar5 & 1) != 0)) ||
     (((cVar8 = *(char *)(param_1 + 0xd38), cVar8 != '\x02' && (cVar8 != -1)) && (cVar8 != '\0'))))
  {
    return -0xc;
  }
  sslInitHSHash(param_1);
  uVar5 = *(uint *)(param_1 + 0xd2c);
  local_34 = 0;
  if ((uVar5 >> 0xe & 1) != 0) {
    local_34 = 1;
    if (*(int *)(param_1 + 0xd68) != 0) {
      local_34 = *(int *)(param_1 + 0xd64) + 1U & 0xffff;
    }
    uVar7 = param_4;
    if (8 < param_4) {
      uVar7 = 8;
    }
    *(char *)(param_1 + 0xdc8) = (char)uVar7;
    iVar9 = 0;
    if (uVar7 != 0) {
      do {
        iVar6 = iVar9 * 2;
        psVar16 = param_3 + iVar9;
        iVar9 = iVar9 + 1;
        *(short *)(iVar6 + param_1 + 0xdb8) = *psVar16;
      } while (iVar9 < (int)uVar7);
    }
  }
  if (*(char *)(param_1 + 0xc98) == '\0') {
    *(uint *)(param_1 + 0xd2c) = uVar5 & 0xfffffff7;
  }
  if (((param_4 == 0) || (param_3 == (short *)0x0)) || (uVar5 = 2, *param_3 == 0)) {
    uVar5 = sslGetCipherSpecListLen(param_1);
    uVar5 = uVar5 & 0xffff;
    if (uVar5 == 2) {
      return -0xc;
    }
  }
  else {
    iVar9 = 0;
    psVar16 = param_3;
    if (param_4 != 0) {
      do {
        iVar6 = sslGetCipherSpec(param_1,*psVar16);
        iVar9 = (iVar9 + 1) * 0x10000 >> 0x10;
        uVar5 = uVar5 + 2 & 0xffff;
        if (iVar6 == 0) {
          return -10;
        }
        psVar16 = psVar16 + 1;
      } while (iVar9 < (int)param_4);
    }
  }
  if (param_7[5] == 0) {
    bVar3 = *(byte *)(param_1 + 0xc98);
    cVar8 = *(char *)(param_1 + 0xd3e);
  }
  else {
    cVar8 = *(char *)(param_1 + 0xd3e);
    if (cVar8 == '\x03') {
      return -0xc;
    }
    if (*(char *)(param_1 + 0xc98) != '\0') {
      return -0xc;
    }
    uVar5 = uVar5 + 2 & 0xffff;
    *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x400;
    bVar3 = 0;
  }
  local_7e[0] = (short)*(undefined4 *)(param_1 + 0x1234) + (short)*(undefined4 *)(param_1 + 0x1238)
                + (ushort)bVar3 + (short)uVar5 + (short)local_34 + 0x25;
  iVar9 = 0;
  if (cVar8 == '\0') {
LAB_00451db4:
    *(undefined4 *)(param_1 + 0xd00) = 0x4000;
  }
  else {
    sVar4 = param_7[1];
    if ((sVar4 < 1) || (0x3fff < sVar4)) goto LAB_00451db4;
    if (((sVar4 != 0x200) && (sVar4 != 0x400)) && ((sVar4 != 0x800 && (sVar4 != 0x1000)))) {
      *(undefined4 *)(param_1 + 0xd00) = 0x4000;
      return -6;
    }
    iVar9 = 7;
    *(uint *)(param_1 + 0xd00) = (int)sVar4 | 0x10000;
  }
  if ((param_7[2] != 0) && (bVar2 = iVar9 == 0, iVar9 = iVar9 + 4, bVar2)) {
    iVar9 = 6;
  }
  if ((-1 < param_7[3]) && (bVar2 = iVar9 == 0, iVar9 = iVar9 + 4, bVar2)) {
    iVar9 = 6;
  }
  local_40[0] = 0;
  iVar6 = eccSuitesSupported(param_1,param_3,param_4);
  if (iVar6 != 0) {
    local_40[0] = 0x20;
    if (*(int *)(param_7 + 8) == 0) {
      psGetEccCurveIdList(auStack_60,local_40);
    }
    else {
      userSuppliedEccList(auStack_60,local_40);
    }
    uVar7 = (uint)local_40[0];
    if (uVar7 != 0) {
      iVar6 = uVar7 + iVar9;
      if (iVar9 == 0) {
        iVar6 = uVar7 + 2;
      }
      iVar9 = iVar6 + 0xc;
    }
  }
  local_30 = 0;
  if (param_7 != (short *)0x0) {
    if (*param_7 == 1) {
      iVar6 = *(int *)(param_1 + 0xcbc);
      local_30 = 1;
      if (iVar6 != 0) {
        if (iVar9 == 0) {
          iVar9 = 2;
        }
        iVar9 = iVar9 + 4;
        if ((*(ushort *)(iVar6 + 0x5e) != 0) && (*(short *)(iVar6 + 0x5c) == 5)) {
          iVar9 = iVar9 + (uint)*(ushort *)(iVar6 + 0x5e);
        }
      }
    }
    if ((param_7 != (short *)0x0) && (param_7[6] == 1)) {
      if (iVar9 == 0) {
        iVar9 = 2;
      }
      iVar9 = iVar9 + 9;
    }
  }
  local_6f = 3;
  local_6e = 4;
  local_6c = 6;
  local_6a = 5;
  local_68 = 2;
  local_67 = 1;
  local_77 = 0x10;
  local_76 = 4;
  local_75 = 3;
  local_74 = 6;
  local_73 = 3;
  local_72 = 5;
  local_71 = 3;
  local_70 = 2;
  local_6d = 1;
  local_6b = 1;
  local_69 = 1;
  local_78 = 0;
  if (iVar9 == 0) {
    iVar9 = 2;
  }
  *(undefined2 *)(param_1 + 0xd4c) = 0x7474;
  iVar9 = iVar9 + 0x16;
  if (param_6 != 0) {
    iVar6 = param_6;
    if (iVar9 == 0) {
      iVar9 = 2;
    }
    do {
      piVar1 = (int *)(iVar6 + 8);
      iVar6 = *(int *)(iVar6 + 0x10);
      iVar9 = *piVar1 + iVar9 + 4;
    } while (iVar6 != 0);
  }
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (0 < *(int *)(param_1 + 0xd70))) {
    iVar9 = *(int *)(param_1 + 0xd70);
  }
  local_38 = (undefined *)param_2[2];
  local_7e[0] = (short)iVar9 + local_7e[0];
  iVar15 = *param_2 + param_2[3];
  iVar6 = FUN_0044decc(param_1,0x16,1,local_7e,local_80,&local_3c,iVar15,&local_38,puVar21);
  if (iVar6 < 0) {
    *param_5 = (uint)local_7e[0];
    return iVar6;
  }
  bVar2 = true;
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xd68) != 0)) {
    bVar2 = false;
  }
  if (((((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) != 1)) &&
      (bVar2)) &&
     (iVar6 = psGetPrngLocked(param_1 + 0x10,0x20,*(undefined4 *)(param_1 + 0x1250)), iVar6 < 0)) {
    return iVar6;
  }
  *local_38 = *(undefined *)(param_1 + 0xd3d);
  local_38[1] = *(undefined *)(param_1 + 0xd3e);
  uVar18 = *(undefined4 *)(param_1 + 0x20);
  uVar14 = *(undefined4 *)(param_1 + 0x24);
  uVar13 = *(undefined4 *)(param_1 + 0x28);
  uVar12 = *(undefined4 *)(param_1 + 0x2c);
  uVar10 = *(undefined4 *)(param_1 + 0x14);
  uVar20 = *(undefined4 *)(param_1 + 0x18);
  uVar19 = *(undefined4 *)(param_1 + 0x1c);
  *(undefined4 *)(local_38 + 2) = *(undefined4 *)(param_1 + 0x10);
  *(undefined4 *)(local_38 + 6) = uVar10;
  *(undefined4 *)(local_38 + 10) = uVar20;
  *(undefined4 *)(local_38 + 0xe) = uVar19;
  *(undefined4 *)(local_38 + 0x12) = uVar18;
  *(undefined4 *)(local_38 + 0x16) = uVar14;
  *(undefined4 *)(local_38 + 0x1a) = uVar13;
  *(undefined4 *)(local_38 + 0x1e) = uVar12;
  local_38[0x22] = *(undefined *)(param_1 + 0xc98);
  local_38 = local_38 + 0x23;
  if (*(byte *)(param_1 + 0xc98) != 0) {
    memcpy(local_38,(void *)(param_1 + 0xc99),(uint)*(byte *)(param_1 + 0xc98));
    local_38 = local_38 + *(byte *)(param_1 + 0xc98);
  }
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
    if (*(int *)(param_1 + 0xd68) == 0) {
      *local_38 = 0;
      local_38 = local_38 + 1;
    }
    else {
      *local_38 = (char)*(undefined4 *)(param_1 + 0xd64);
      local_38 = local_38 + 1;
      memcpy(local_38,*(void **)(param_1 + 0xd60),*(size_t *)(param_1 + 0xd64));
      local_38 = local_38 + *(int *)(param_1 + 0xd64);
    }
  }
  if (((param_4 == 0) || (param_3 == (short *)0x0)) || (*param_3 == 0)) {
    iVar6 = sslGetCipherSpecList(param_1,local_38,iVar15 - (int)local_38,0);
    if (iVar6 < 0) {
      return -0x32;
    }
    local_38 = local_38 + iVar6;
  }
  else {
    if (iVar15 - (int)local_38 < (int)uVar5) {
      return -0x32;
    }
    uVar5 = uVar5 - 2 & 0xffff;
    *local_38 = (char)(uVar5 >> 8);
    iVar6 = 0;
    local_38[1] = (char)uVar5;
    local_38 = local_38 + 2;
    if (param_4 != 0) {
      do {
        *local_38 = (char)((ushort)*param_3 >> 8);
        local_38[1] = (char)*param_3;
        iVar6 = (iVar6 + 1) * 0x10000 >> 0x10;
        local_38 = local_38 + 2;
        param_3 = param_3 + 1;
      } while (iVar6 < (int)param_4);
    }
    if ((*(uint *)(param_1 + 0x1230) >> 10 & 1) != 0) {
      *local_38 = 0x56;
      local_38[1] = 0;
      local_38 = local_38 + 2;
    }
  }
  *local_38 = 1;
  local_38[1] = 0;
  uVar5 = *(uint *)(param_1 + 0xd2c);
  puVar21 = local_38 + 2;
  if ((uVar5 >> 0xe & 1) != 0) {
    local_2c = puVar21;
  }
  if (iVar9 == 0) goto LAB_0045214c;
  iVar9 = iVar9 + -2;
  local_38[2] = (char)((uint)iVar9 >> 8);
  local_38[3] = (char)iVar9;
  puVar21 = local_38 + 4;
  if (param_6 != 0) {
    do {
      iVar6 = *(int *)(param_6 + 4);
      if (iVar6 == 0) {
        *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 1;
        uVar17 = (undefined)((uint)*(undefined4 *)(param_6 + 4) >> 8);
      }
      else if (iVar6 == 0x10) {
        *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x80;
        uVar17 = (undefined)((uint)*(undefined4 *)(param_6 + 4) >> 8);
      }
      else {
        uVar17 = (undefined)((uint)iVar6 >> 8);
      }
      *puVar21 = uVar17;
      puVar21[1] = (char)*(undefined4 *)(param_6 + 4);
      puVar21[2] = *(undefined *)(param_6 + 9);
      puVar21[3] = (char)*(undefined4 *)(param_6 + 8);
      local_38 = puVar21 + 4;
      if (*(size_t *)(param_6 + 8) == 1) {
        pvVar11 = *(void **)(param_6 + 0xc);
        if (pvVar11 != (void *)0x0) goto LAB_00451cd4;
        puVar21[4] = 0;
      }
      else {
        pvVar11 = *(void **)(param_6 + 0xc);
LAB_00451cd4:
        memcpy(local_38,pvVar11,*(size_t *)(param_6 + 8));
      }
      piVar1 = (int *)(param_6 + 8);
      param_6 = *(int *)(param_6 + 0x10);
      puVar21 = local_38 + *piVar1;
    } while (param_6 != 0);
  }
  local_38 = puVar21;
  if ((*(ushort *)(param_1 + 0xd02) & 1) != 0) {
    *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 2;
    *puVar21 = 0;
    puVar21[1] = 1;
    puVar21[2] = 0;
    puVar21[3] = 1;
    sVar4 = param_7[1];
    local_38 = puVar21 + 4;
    if (sVar4 == 0x200) {
      puVar21[4] = 1;
      local_38 = puVar21 + 5;
    }
    else {
      if (sVar4 == 0x400) {
        puVar21[4] = 2;
      }
      else if (sVar4 == 0x800) {
        puVar21[4] = 3;
      }
      else {
        if (sVar4 != 0x1000) goto LAB_00451e68;
        puVar21[4] = 4;
      }
      local_38 = puVar21 + 5;
    }
  }
LAB_00451e68:
  if (local_40[0] != 0) {
    *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x10;
    *local_38 = 0;
    local_38[1] = 10;
    local_38[2] = (char)(local_40[0] + 2 >> 8);
    local_38[3] = local_40[0] + 2;
    local_38[4] = 0;
    local_38[5] = local_40[0];
    local_38 = local_38 + 6;
    memcpy(local_38,auStack_60,(uint)local_40[0]);
    local_38 = local_38 + local_40[0];
    *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x20;
    *local_38 = 0;
    local_38[1] = 0xb;
    local_38[2] = 0;
    local_38[3] = 2;
    local_38[4] = 1;
    local_38[5] = 0;
    local_38 = local_38 + 6;
  }
  *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x40;
  *local_38 = 0;
  local_38[1] = 0xd;
  local_38[2] = 0;
  local_38[3] = 0x12;
  local_38 = local_38 + 4;
  memcpy(local_38,&local_78,0x12);
  puVar21 = local_38 + 0x12;
  if ((local_30 != 0) && (iVar6 = *(int *)(param_1 + 0xcbc), iVar6 != 0)) {
    if ((*(short *)(iVar6 + 0x5e) == 0) || (*(short *)(iVar6 + 0x5c) != 5)) {
      *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x100;
      local_38[0x12] = 0;
      local_38[0x13] = 0x23;
      local_38[0x14] = 0;
      local_38[0x15] = 0;
      puVar21 = local_38 + 0x16;
      *(undefined2 *)(*(int *)(param_1 + 0xcbc) + 0x5c) = 1;
    }
    else {
      *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x100;
      local_38[0x12] = 0;
      local_38[0x13] = 0x23;
      local_38[0x14] = (char)((ushort)*(undefined2 *)(*(int *)(param_1 + 0xcbc) + 0x5e) >> 8);
      local_38[0x15] = (char)*(undefined2 *)(*(int *)(param_1 + 0xcbc) + 0x5e);
      local_38 = local_38 + 0x16;
      memcpy(local_38,*(void **)(*(int *)(param_1 + 0xcbc) + 0x58),
             (uint)*(ushort *)(*(int *)(param_1 + 0xcbc) + 0x5e));
      puVar21 = local_38 + *(ushort *)(*(int *)(param_1 + 0xcbc) + 0x5e);
      *(undefined2 *)(*(int *)(param_1 + 0xcbc) + 0x5c) = 2;
    }
  }
  if (param_7[6] != 0) {
    *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x800;
    *puVar21 = 0;
    puVar21[1] = 5;
    puVar21[2] = 0;
    puVar21[3] = 5;
    puVar21[4] = 1;
    puVar21[5] = 0;
    puVar21[6] = 0;
    puVar21[7] = 0;
    puVar21[8] = 0;
    puVar21 = puVar21 + 9;
  }
  if (param_7[2] != 0) {
    *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 4;
    *puVar21 = 0;
    puVar21[1] = 4;
    puVar21[2] = 0;
    puVar21[3] = 0;
    puVar21 = puVar21 + 4;
  }
  if (param_7[3] < 0) {
    uVar5 = *(uint *)(param_1 + 0xd2c);
  }
  else {
    if (param_7[3] < 1) {
      uVar5 = *(uint *)(param_1 + 0x1230) | 8;
    }
    else {
      uVar5 = *(uint *)(param_1 + 0x1230) | 0x400008;
    }
    *(uint *)(param_1 + 0x1230) = uVar5;
    *puVar21 = 0;
    puVar21[1] = 0x17;
    puVar21[2] = 0;
    puVar21[3] = 0;
    uVar5 = *(uint *)(param_1 + 0xd2c);
    puVar21 = puVar21 + 4;
  }
LAB_0045214c:
  local_38 = puVar21;
  if (((uVar5 >> 0xe & 1) != 0) && (iVar9 != 0)) {
    if (*(size_t *)(param_1 + 0xd70) == 0) {
      *(int *)(param_1 + 0xd70) = (int)puVar21 - (int)local_2c;
      pvVar11 = malloc((int)puVar21 - (int)local_2c);
      *(void **)(param_1 + 0xd6c) = pvVar11;
      if (pvVar11 == (void *)0x0) {
        return -8;
      }
      memcpy(pvVar11,local_2c,*(size_t *)(param_1 + 0xd70));
    }
    else {
      local_38 = local_2c;
      memcpy(local_2c,*(void **)(param_1 + 0xd6c),*(size_t *)(param_1 + 0xd70));
      local_38 = local_38 + *(int *)(param_1 + 0xd70);
    }
  }
  iVar9 = FUN_0044efd0(param_1,0x16,0,local_7e[0],local_80[0],local_3c,param_2,&local_38);
  if (-1 < iVar9) {
    param_2[2] = (int)local_38;
    if (*(char *)(param_1 + 0xd38) == -1) {
      sslResetContext(param_1);
    }
    iVar9 = 0;
    *(undefined *)(param_1 + 0xd38) = 2;
    *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) & 0xffffff7f;
  }
  return iVar9;
}



int FUN_00452718(int param_1,int *param_2)

{
  bool bVar1;
  undefined uVar2;
  byte bVar3;
  int iVar4;
  undefined *puVar5;
  void *pvVar6;
  int iVar7;
  int iVar8;
  size_t __size;
  uint uVar9;
  undefined4 uVar10;
  undefined4 *puVar11;
  undefined4 uVar12;
  undefined local_38 [2];
  ushort local_36;
  short local_34;
  byte local_32 [2];
  void *local_30;
  undefined4 local_2c;
  undefined *local_28;
  void *local_24;
  
  local_28 = (undefined *)param_2[2];
  iVar8 = *param_2;
  iVar4 = param_2[3];
  local_36 = 0;
  local_34 = 0;
  uVar12 = *(undefined4 *)(param_1 + 0x1250);
  puVar11 = (undefined4 *)(param_1 + 0xc4c);
  if ((*(short *)(param_1 + 0xc5a) == 0) ||
     (puVar11 = (undefined4 *)(param_1 + 0xc64), *(short *)(param_1 + 0xc72) == 0)) {
    iVar7 = -7;
    if (puVar11 != (undefined4 *)0x0) {
      uVar9 = *(uint *)(param_1 + 0xd2c);
      if ((uVar9 >> 0x12 & 1) != 0) {
        iVar7 = matrixSslPskGetKeyId
                          (param_1,&local_30,local_32,*(undefined4 *)(param_1 + 0xc2c),
                           *(undefined *)(param_1 + 0xc30));
        if (iVar7 < 0) {
          free(*(void **)(param_1 + 0xc2c));
          *(undefined4 *)(param_1 + 0xc2c) = 0;
          return -0xc;
        }
        uVar9 = *(uint *)(param_1 + 0xd2c);
        if ((uVar9 >> 0xe & 1) == 0) {
          free(*(void **)(param_1 + 0xc2c));
          uVar9 = *(uint *)(param_1 + 0xd2c);
          *(undefined4 *)(param_1 + 0xc2c) = 0;
        }
      }
      if ((uVar9 >> 0x11 & 1) == 0) {
        if ((uVar9 >> 0x12 & 1) == 0) {
          if ((ushort)(*(short *)(*(int *)(param_1 + 0xd10) + 2) - 8U) < 2) {
            local_36 = (ushort)**(byte **)(*(int *)(param_1 + 600) + 0x5c) * 2 + 2;
          }
          else {
            local_36 = *(ushort *)(*(int *)(param_1 + 600) + 0x94);
          }
        }
        else {
          local_34 = (ushort)local_32[0] + local_34;
        }
      }
      else {
        if (((uVar9 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) != 1)) {
          if ((uVar9 >> 0x13 & 1) != 0) {
            local_36 = (ushort)**(byte **)(*(int *)(param_1 + 0xc34) + 0x34) * 2 + 2;
          }
        }
        else {
          local_36 = (ushort)*(undefined4 *)(param_1 + 0x121c);
        }
        if ((uVar9 >> 0x12 & 1) != 0) {
          local_34 = (ushort)local_32[0] + local_34 + 2;
        }
      }
      local_34 = (short)*(undefined4 *)(param_1 + 0x1234) + (short)*(undefined4 *)(param_1 + 0x1238)
                 + local_36 + local_34;
      bVar1 = (uVar9 >> 0xb & 1) != 0;
      if (bVar1) {
        local_34 = local_34 + 2;
      }
      if (((uVar9 >> 0x11 & 1) != 0) && (!bVar1)) {
        bVar1 = true;
        local_34 = local_34 + 2;
      }
      if (((uVar9 >> 0x12 & 1) != 0) && (!bVar1)) {
        bVar1 = true;
        local_34 = local_34 + 2;
      }
      if (((uVar9 >> 0x13 & 1) != 0) && (bVar1)) {
        bVar1 = false;
        local_34 = local_34 + -2;
      }
      iVar7 = FUN_0044decc(param_1,0x16,0x10,&local_34,local_38,&local_2c,iVar8 + iVar4,&local_28);
      if (-1 < iVar7) {
        if (bVar1) {
          if ((*(uint *)(param_1 + 0xd2c) >> 0x12 & 1) != 0) {
            *local_28 = 0;
            local_28[1] = local_32[0];
            local_28 = local_28 + 2;
            memcpy(local_28,local_30,(uint)local_32[0]);
            local_28 = local_28 + local_32[0];
          }
          if (local_36 != 0) {
            *local_28 = (char)(local_36 >> 8);
            local_28[1] = (char)local_36;
            local_28 = local_28 + 2;
          }
        }
        uVar9 = *(uint *)(param_1 + 0xd2c);
        if (((uVar9 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) != 1)) {
          if ((uVar9 >> 0x11 & 1) == 0) {
            if ((uVar9 >> 0x12 & 1) == 0) {
              if ((ushort)(*(short *)(*(int *)(param_1 + 0xd10) + 2) - 8U) < 2) {
                local_36 = local_36 - 1;
                *local_28 = (char)local_36;
                iVar4 = *(int *)(param_1 + 600);
                *(undefined2 *)((int)puVar11 + 0xe) = 5;
                *(ushort *)(puVar11 + 4) = local_36;
                puVar11[1] = local_28 + 1;
                puVar11[2] = uVar12;
                puVar11[5] = 0;
                local_28 = local_28 + 1 + local_36;
                bVar3 = **(byte **)(iVar4 + 0x5c);
                *(ushort *)(param_1 + 0x84) = (ushort)bVar3;
                pvVar6 = malloc((uint)bVar3);
                *(void **)(param_1 + 0x80) = pvVar6;
                if (pvVar6 == (void *)0x0) {
                  return -8;
                }
              }
              else {
                *(undefined2 *)(param_1 + 0x84) = 0x30;
                puVar5 = (undefined *)malloc(0x30);
                *(undefined **)(param_1 + 0x80) = puVar5;
                if (puVar5 == (undefined *)0x0) {
                  return -8;
                }
                uVar2 = *(undefined *)(param_1 + 0xd3c);
                uVar10 = *(undefined4 *)(param_1 + 0x1250);
                *puVar5 = *(undefined *)(param_1 + 0xd3b);
                puVar5[1] = uVar2;
                iVar4 = psGetPrngLocked(puVar5 + 2,0x2e,uVar10);
                if (iVar4 < 0) {
                  return -0xc;
                }
                puVar11[1] = local_28;
                *(undefined2 *)((int)puVar11 + 0xe) = 4;
                puVar11[2] = uVar12;
                *(ushort *)(puVar11 + 4) = local_36;
                puVar11[5] = 0;
                local_28 = local_28 + local_36;
              }
            }
            else {
              matrixSslPskGetKey(param_1,local_30,local_32[0],&local_24,local_32);
              if (local_24 == (void *)0x0) {
                return -0xc;
              }
              __size = (uint)local_32[0] * 2 + 4;
              *(short *)(param_1 + 0x84) = (short)__size;
              pvVar6 = malloc(__size);
              *(void **)(param_1 + 0x80) = pvVar6;
              if (pvVar6 == (void *)0x0) {
                return -8;
              }
              memset(pvVar6,0,(uint)*(ushort *)(param_1 + 0x84));
              **(undefined **)(param_1 + 0x80) = 0;
              *(byte *)(*(int *)(param_1 + 0x80) + 1) = local_32[0];
              *(undefined *)(*(int *)(param_1 + 0x80) + (uint)local_32[0] + 2) = 0;
              *(byte *)(*(int *)(param_1 + 0x80) + (uint)local_32[0] + 3) = local_32[0];
              memcpy((void *)(*(int *)(param_1 + 0x80) + (uint)local_32[0] + 4),local_24,
                     (uint)local_32[0]);
              if (((*(uint *)(param_1 + 0x1230) >> 0x11 & 1) == 0) &&
                 (iVar4 = sslCreateKeys(param_1), iVar4 < 0)) {
                return iVar4;
              }
            }
          }
          else if ((uVar9 >> 0x13 & 1) != 0) {
            local_36 = local_36 - 1;
            *local_28 = (char)local_36;
            local_28 = local_28 + 1;
            iVar4 = psEccX963ExportKey(*(undefined4 *)(param_1 + 0xc90),
                                       *(undefined4 *)(param_1 + 0xc34),local_28,&local_36);
            if (iVar4 < 0) {
              return -0xc;
            }
            uVar9 = (uint)local_36;
            if ((byte)local_28[-1] != uVar9) {
              _psTraceStr("psAssert %s","sslEncode.c");
              _psTraceInt(&DAT_0049016c,0x19dd);
              _psError("keyLen == (uint32) * (c - 1)");
              uVar9 = (uint)local_36;
            }
            if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
              *(uint *)(param_1 + 0x121c) = uVar9 + 1;
              pvVar6 = malloc(uVar9 + 1);
              *(void **)(param_1 + 0x1220) = pvVar6;
              if (pvVar6 == (void *)0x0) {
                return -8;
              }
              memcpy(pvVar6,local_28 + -1,*(size_t *)(param_1 + 0x121c));
              uVar9 = (uint)local_36;
            }
            bVar3 = **(byte **)(*(int *)(param_1 + 0xc34) + 0x34);
            local_28 = local_28 + uVar9;
            *(ushort *)(param_1 + 0x84) = (ushort)bVar3;
            pvVar6 = malloc((uint)bVar3);
            *(void **)(param_1 + 0x80) = pvVar6;
            if (pvVar6 == (void *)0x0) {
              return -8;
            }
            *puVar11 = 0;
            uVar10 = *(undefined4 *)(param_1 + 0x80);
            puVar11[2] = uVar12;
            *(undefined2 *)((int)puVar11 + 0xe) = 6;
            puVar11[1] = uVar10;
            *(undefined2 *)(puVar11 + 3) = 0;
          }
        }
        else {
          memcpy(local_28,*(void **)(param_1 + 0x1220),*(size_t *)(param_1 + 0x121c));
          local_28 = local_28 + *(int *)(param_1 + 0x121c);
        }
        iVar7 = FUN_0044e628(param_1,0x16,0x10,local_34,local_38[0],local_2c,param_2,&local_28);
        if (-1 < iVar7) {
          param_2[2] = (int)local_28;
          return 0;
        }
      }
    }
  }
  else {
    iVar7 = -7;
  }
  return iVar7;
}



int FUN_00452f90(int param_1,int *param_2)

{
  ushort uVar1;
  undefined2 uVar2;
  void *pvVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int *__ptr;
  uint uVar6;
  undefined *puVar7;
  undefined2 uVar8;
  int iVar9;
  int *piVar10;
  void *pvVar11;
  int iVar12;
  code *pcVar13;
  int local_90;
  int local_8c;
  int local_88;
  int local_80;
  int local_7c;
  int local_78;
  int local_74;
  undefined auStack_70 [16];
  undefined auStack_60 [48];
  ushort local_30 [2];
  int local_2c;
  
  __ptr = *(int **)(param_1 + 0xc7c);
  iVar12 = *param_2;
  if (__ptr != (int *)0x0) {
    do {
      local_2c = *__ptr + __ptr[2];
      if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
        if (__ptr[6] == 0x14) {
          incrTwoByte(param_1,param_1 + 0xdc9,1);
          zeroSixByte(param_1 + 0xdd1);
        }
        *(undefined *)__ptr[1] = *(undefined *)(param_1 + 0xdc9);
        iVar9 = __ptr[1];
        __ptr[1] = iVar9 + 1;
        *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdca);
        iVar9 = __ptr[1];
        __ptr[1] = iVar9 + 1;
        *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd1);
        iVar9 = __ptr[1];
        __ptr[1] = iVar9 + 1;
        *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd2);
        iVar9 = __ptr[1];
        __ptr[1] = iVar9 + 1;
        *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd3);
        iVar9 = __ptr[1];
        __ptr[1] = iVar9 + 1;
        *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd4);
        iVar9 = __ptr[1];
        __ptr[1] = iVar9 + 1;
        *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd5);
        iVar9 = __ptr[1];
        __ptr[1] = iVar9 + 1;
        *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd6);
        __ptr[1] = __ptr[1] + 3;
      }
      if (__ptr[6] == 0x14) {
        iVar9 = sslActivateWriteCipher(param_1);
        if (iVar9 < 0) {
          pvVar3 = *(void **)(param_1 + 0xc7c);
          if (*(void **)(param_1 + 0xc7c) != (void *)0x0) {
            do {
              pvVar11 = *(void **)((int)pvVar3 + 0x20);
              free(pvVar3);
              pvVar3 = pvVar11;
            } while (pvVar11 != (void *)0x0);
            *(undefined4 *)(param_1 + 0xc7c) = 0;
            return iVar9;
          }
          goto LAB_0045377c;
        }
        iVar9 = sslSnapshotHSHash(param_1,*(undefined4 *)(param_1 + 0xc80),
                                  *(uint *)(param_1 + 0xd2c) & 1);
        if (iVar9 < 1) {
          pvVar3 = *(void **)(param_1 + 0xc7c);
          while (pvVar3 != (void *)0x0) {
            pvVar11 = *(void **)((int)pvVar3 + 0x20);
            free(pvVar3);
            pvVar3 = pvVar11;
          }
          goto LAB_0045377c;
        }
      }
      uVar6 = *(uint *)(param_1 + 0xd2c);
      if ((uVar6 >> 0x16 & 1) == 0) {
        local_88 = *__ptr - *(int *)(param_1 + 0x1234);
        if (__ptr[6] != 0xf) goto LAB_0045310c;
LAB_004532e0:
        local_74 = *(int *)(param_1 + 0xcf4) - (iVar12 - local_88);
        local_80 = local_88;
        local_7c = local_88;
        local_78 = iVar12;
        if (((uVar6 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) == 0)) {
          local_90 = local_88;
          local_8c = local_88;
          iVar9 = sslSnapshotHSHash(param_1,auStack_70,0xffffffff);
          if (iVar9 < 1) {
            return -0xc;
          }
          if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) goto LAB_00453378;
          uVar1 = *(ushort *)(param_1 + 0xc58);
          if (uVar1 == 0x30) {
            pcVar13 = sslSha384SnapshotHSHash;
LAB_004539d8:
            (*pcVar13)(param_1,auStack_70);
          }
          else if (uVar1 < 0x31) {
            if (uVar1 == 0x14) {
              pcVar13 = sslSha1SnapshotHSHash;
              goto LAB_004539d8;
            }
          }
          else if (uVar1 == 0x40) {
            pcVar13 = sslSha512SnapshotHSHash;
            goto LAB_004539d8;
          }
LAB_00453378:
          uVar1 = *(ushort *)(param_1 + 0xc5a);
          if (uVar1 == 0) {
            return -0xc;
          }
          if (uVar1 < 3) {
            if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
              uVar5 = *(undefined4 *)(param_1 + 0xc50);
              iVar9 = *(int *)(param_1 + 0xc48);
              uVar8 = *(undefined2 *)(iVar9 + 0x70);
              uVar2 = *(undefined2 *)(param_1 + 0xc58);
              uVar4 = *(undefined4 *)(param_1 + 0xc54);
              pcVar13 = psRsaEncryptPriv;
            }
            else {
              uVar5 = *(undefined4 *)(param_1 + 0xc50);
              iVar9 = *(int *)(param_1 + 0xc48);
              uVar8 = *(undefined2 *)(iVar9 + 0x70);
              uVar2 = *(undefined2 *)(param_1 + 0xc58);
              uVar4 = *(undefined4 *)(param_1 + 0xc54);
              pcVar13 = privRsaEncryptSignedElement;
            }
            iVar9 = (*pcVar13)(0,iVar9 + 4,auStack_70,uVar2,uVar5,uVar8,uVar4);
            if ((-1 < iVar9) && ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0)) {
              uVar6 = (uint)*(ushort *)(*(int *)(param_1 + 0xc48) + 0x70);
              *(uint *)(param_1 + 0x1228) = uVar6;
              pvVar3 = malloc(uVar6);
              *(void **)(param_1 + 0x1224) = pvVar3;
              if (pvVar3 != (void *)0x0) {
                memcpy(pvVar3,*(void **)(param_1 + 0xc50),uVar6);
              }
            }
            if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
              free(*(void **)(param_1 + 0xc4c));
              *(undefined4 *)(param_1 + 0xc4c) = 0;
            }
            if (*(short *)(param_1 + 0xc72) == 0) {
              *(undefined2 *)(param_1 + 0xc5c) = 0;
              *(undefined2 *)(param_1 + 0xc58) = 0;
              *(undefined4 *)(param_1 + 0xc54) = 0;
              *(undefined4 *)(param_1 + 0xc50) = 0;
              *(undefined2 *)(param_1 + 0xc5a) = 0;
            }
            else {
              *(short *)(param_1 + 0xc5a) = *(short *)(param_1 + 0xc72);
              *(undefined4 *)(param_1 + 0xc50) = *(undefined4 *)(param_1 + 0xc68);
              *(undefined4 *)(param_1 + 0xc54) = *(undefined4 *)(param_1 + 0xc6c);
              *(undefined2 *)(param_1 + 0xc58) = *(undefined2 *)(param_1 + 0xc70);
              *(undefined2 *)(param_1 + 0xc5c) = *(undefined2 *)(param_1 + 0xc74);
              *(undefined2 *)(param_1 + 0xc72) = 0;
              *(undefined4 *)(param_1 + 0xc68) = 0;
              *(undefined4 *)(param_1 + 0xc6c) = 0;
              *(undefined2 *)(param_1 + 0xc70) = 0;
              *(undefined2 *)(param_1 + 0xc74) = 0;
            }
          }
          else {
            if (uVar1 != 3) {
              return -0xc;
            }
            pvVar3 = malloc(*(ushort *)(param_1 + 0xc5c) + 1);
            iVar9 = -8;
            if (pvVar3 != (void *)0x0) {
              if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
                uVar8 = 0x14;
                puVar7 = auStack_60;
              }
              else {
                uVar8 = *(undefined2 *)(param_1 + 0xc58);
                puVar7 = auStack_70;
              }
              local_30[0] = *(short *)(param_1 + 0xc5c) + 1;
              *(undefined4 *)(param_1 + 0x122c) = 0;
              iVar9 = psEccDsaSign(0,*(int *)(param_1 + 0xc48) + 4,puVar7,uVar8,pvVar3,local_30,1,
                                   *(undefined4 *)(param_1 + 0xc54));
              if (iVar9 == 0) {
                uVar6 = (uint)local_30[0];
                if (*(ushort *)(param_1 + 0xc5c) == uVar6) {
                  memcpy(*(void **)(param_1 + 0xc50),pvVar3,uVar6);
                }
                else {
                  iVar9 = FUN_0044c97c(param_1,param_1 + 0xc4c,uVar6,pvVar3,&local_80,0xf);
                  if (iVar9 < 0) goto LAB_00453484;
                }
                if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
                  uVar6 = (uint)local_30[0];
                  *(uint *)(param_1 + 0x1228) = uVar6;
                  pvVar11 = malloc(uVar6);
                  *(void **)(param_1 + 0x1224) = pvVar11;
                  if (pvVar11 == (void *)0x0) {
                    iVar9 = -8;
                  }
                  else {
                    memcpy(pvVar11,*(void **)(param_1 + 0xc50),uVar6);
                  }
                }
              }
LAB_00453484:
              free(pvVar3);
              if (*(void **)(param_1 + 0xc4c) != (void *)0x0) {
                free(*(void **)(param_1 + 0xc4c));
                *(undefined4 *)(param_1 + 0xc4c) = 0;
              }
              if (*(short *)(param_1 + 0xc72) == 0) {
                *(undefined2 *)(param_1 + 0xc5c) = 0;
                *(undefined2 *)(param_1 + 0xc58) = 0;
                *(undefined4 *)(param_1 + 0xc54) = 0;
                *(undefined4 *)(param_1 + 0xc50) = 0;
                *(undefined2 *)(param_1 + 0xc5a) = 0;
              }
              else {
                *(short *)(param_1 + 0xc5a) = *(short *)(param_1 + 0xc72);
                *(undefined4 *)(param_1 + 0xc50) = *(undefined4 *)(param_1 + 0xc68);
                *(undefined4 *)(param_1 + 0xc54) = *(undefined4 *)(param_1 + 0xc6c);
                *(undefined2 *)(param_1 + 0xc58) = *(undefined2 *)(param_1 + 0xc70);
                *(undefined2 *)(param_1 + 0xc5c) = *(undefined2 *)(param_1 + 0xc74);
                *(undefined2 *)(param_1 + 0xc72) = 0;
                *(undefined4 *)(param_1 + 0xc68) = 0;
                *(undefined4 *)(param_1 + 0xc6c) = 0;
                *(undefined2 *)(param_1 + 0xc70) = 0;
                *(undefined2 *)(param_1 + 0xc74) = 0;
              }
            }
            if (iVar9 < 0) {
              return iVar9;
            }
          }
        }
        uVar6 = *(uint *)(param_1 + 0xd2c);
        local_88 = *__ptr;
        local_2c = local_88 + __ptr[2];
        if ((uVar6 >> 0x14 & 1) == 0) {
          local_88 = local_88 - *(int *)(param_1 + 0x1234);
          goto LAB_0045310c;
        }
        local_88 = local_88 - *(int *)(param_1 + 0x1234);
        if ((uVar6 >> 0x16 & 1) != 0) {
          local_88 = local_88 + -8;
        }
        if ((uVar6 >> 0xe & 1) != 0) goto LAB_0045311c;
LAB_00453560:
        local_90 = local_88;
        local_8c = local_88;
        iVar9 = FUN_0044efd0(param_1,__ptr[3],__ptr[6],__ptr[4],__ptr[5],*__ptr,&local_90,&local_2c)
        ;
      }
      else {
        local_88 = (*__ptr - *(int *)(param_1 + 0x1234)) + -8;
        if ((uVar6 >> 0xe & 1) == 0) {
          *(undefined *)__ptr[1] = *(undefined *)(param_1 + 0x240);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0x241);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0x242);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0x243);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0x244);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0x245);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0x246);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0x247);
          uVar6 = *(uint *)(param_1 + 0xd2c);
        }
        else {
          *(undefined *)__ptr[1] = *(undefined *)(param_1 + 0xdc9);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdca);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd1);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd2);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd3);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd4);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd5);
          iVar9 = __ptr[1];
          __ptr[1] = iVar9 + 1;
          *(undefined *)(iVar9 + 1) = *(undefined *)(param_1 + 0xdd6);
          uVar6 = *(uint *)(param_1 + 0xd2c);
          __ptr[1] = __ptr[1] + 1;
        }
        if (__ptr[6] == 0xf) goto LAB_004532e0;
LAB_0045310c:
        if ((uVar6 >> 0xe & 1) == 0) goto LAB_00453560;
LAB_0045311c:
        if (__ptr[7] < 1) goto LAB_00453560;
        local_90 = local_88;
        local_8c = local_88;
        iVar9 = dtlsEncryptFragRecord(param_1,__ptr,&local_90,&local_2c);
      }
      *param_2 = local_2c;
      if (iVar9 == -0xf) {
        iVar12 = (*__ptr + __ptr[4]) - *(int *)(param_1 + 0x1234);
        if ((*(uint *)(param_1 + 0xd2c) >> 0x14 & 1) == 0) {
          *param_2 = iVar12;
        }
        else {
          if ((*(uint *)(param_1 + 0xd2c) >> 0x16 & 1) != 0) {
            iVar12 = iVar12 + -8;
          }
          *param_2 = iVar12;
        }
        *(int *)(param_1 + 0xc7c) = __ptr[8];
        free(__ptr);
        return -0xf;
      }
      if (iVar9 < 0) {
        pvVar3 = *(void **)(param_1 + 0xc7c);
        goto joined_r0x00453a34;
      }
      piVar10 = (int *)__ptr[8];
      *(int **)(param_1 + 0xc7c) = piVar10;
      free(__ptr);
      __ptr = piVar10;
    } while (piVar10 != (int *)0x0);
    __ptr = *(int **)(param_1 + 0xc7c);
  }
  if (__ptr == (int *)0x0) {
LAB_00453694:
    *(undefined4 *)(param_1 + 0xc7c) = 0;
  }
  else {
    do {
      pvVar3 = (void *)__ptr[8];
      free(__ptr);
      if (pvVar3 == (void *)0x0) goto LAB_00453694;
      __ptr = *(int **)((int)pvVar3 + 0x20);
      free(pvVar3);
    } while (__ptr != (int *)0x0);
    *(undefined4 *)(param_1 + 0xc7c) = 0;
  }
  return 0;
joined_r0x00453a34:
  if (pvVar3 == (void *)0x0) {
LAB_0045377c:
    *(undefined4 *)(param_1 + 0xc7c) = 0;
    return iVar9;
  }
  pvVar11 = *(void **)((int)pvVar3 + 0x20);
  free(pvVar3);
  if (pvVar11 == (void *)0x0) goto LAB_0045377c;
  pvVar3 = *(void **)((int)pvVar11 + 0x20);
  free(pvVar11);
  goto joined_r0x00453a34;
}



int FUN_00453af4(int param_1,int *param_2,int param_3,int param_4)

{
  ushort *puVar1;
  ushort uVar2;
  bool bVar3;
  short sVar4;
  undefined uVar5;
  uint uVar6;
  undefined *puVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  size_t sVar12;
  size_t __n;
  int iVar13;
  size_t __n_00;
  int iVar14;
  undefined local_48 [2];
  ushort local_46;
  undefined local_44 [2];
  ushort local_42;
  undefined4 local_40;
  undefined *local_3c;
  undefined4 local_38;
  undefined *local_34;
  int local_30;
  int local_2c;
  
  iVar9 = *(int *)(param_1 + 0x1234);
  local_3c = (undefined *)param_2[2];
  iVar13 = param_4 * 2;
  sVar4 = (short)iVar9 + (short)*(undefined4 *)(param_1 + 0x1238) + (short)iVar13 + (short)param_3;
  local_30 = *param_2 + param_2[3];
  iVar14 = 0;
  local_46 = sVar4 + 5;
  local_34 = local_3c;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
    iVar11 = *(int *)(param_1 + 0xd00);
    if ((int)((uint)local_46 - iVar9) <= iVar11) goto LAB_00453db8;
  }
  else {
    local_46 = sVar4 + 0x13;
    iVar11 = *(int *)(param_1 + 0xd00);
    iVar14 = 0xe;
    if ((int)((uint)local_46 - iVar9) <= iVar11) {
LAB_00453db8:
      iVar9 = FUN_0044decc(param_1,0x16,0xd,&local_46,local_48,&local_38,local_30,&local_34);
      if (iVar9 < 0) {
        if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
          return iVar9;
        }
        if (iVar9 != -0x3c) {
          return iVar9;
        }
        iVar9 = dtlsWriteCertificateRequest
                          (*(undefined4 *)(param_1 + 0xc90),param_1,param_3,param_4,iVar14,local_34)
        ;
        if (iVar9 < 0) {
          return iVar9;
        }
        param_2[2] = (int)(local_34 + iVar9);
        return 0;
      }
      local_34[1] = 0x40;
      *local_34 = 2;
      local_34[2] = 1;
      puVar7 = local_34 + 3;
      if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) != 0) {
        puVar7 = local_34 + 0x11;
        local_34[4] = (char)iVar14 + -2;
        local_34[10] = 3;
        local_34[0xb] = 5;
        local_34[0xd] = 4;
        local_34[0xf] = 2;
        local_34[0x10] = 1;
        local_34[3] = 0;
        local_34[5] = 5;
        local_34[6] = 3;
        local_34[7] = 4;
        local_34[8] = 3;
        local_34[9] = 2;
        local_34[0xc] = 1;
        local_34[0xe] = 1;
      }
      iVar9 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
      if (iVar9 == 0) {
        local_34 = puVar7 + 2;
        *puVar7 = 0;
        puVar7[1] = 0;
      }
      else {
        *puVar7 = (char)((uint)(iVar13 + param_3) >> 8);
        puVar7[1] = (char)(iVar13 + param_3);
        local_34 = puVar7 + 2;
        do {
          if (*(int *)(iVar9 + 0x188) == 0) {
            return -1;
          }
          *local_34 = (char)((ushort)*(undefined2 *)(iVar9 + 0x18c) >> 8);
          local_34[1] = (char)*(undefined2 *)(iVar9 + 0x18c);
          local_34 = local_34 + 2;
          memcpy(local_34,*(void **)(iVar9 + 0x188),(size_t)*(undefined2 *)(iVar9 + 0x18c));
          puVar1 = (ushort *)(iVar9 + 0x18c);
          iVar9 = *(int *)(iVar9 + 0x31c);
          local_34 = local_34 + *puVar1;
        } while (iVar9 != 0);
      }
      iVar9 = FUN_0044e628(param_1,0x16,0xd,local_46,local_48[0],local_38,param_2,&local_34);
      if (iVar9 < 0) {
        return iVar9;
      }
      param_2[2] = (int)local_34;
      return 0;
    }
  }
  __n = 0;
  __n_00 = 0;
  local_2c = 0;
  if (0 < param_3) {
    local_42 = (short)*(undefined4 *)(param_1 + 0x1234) + (short)*(undefined4 *)(param_1 + 0x1238) +
               (short)iVar13 + (short)param_3 + (short)iVar14 + 5;
    iVar9 = FUN_0044decc(param_1,0x5a,0xd,&local_42,local_44,&local_40,local_30,&local_3c);
    if (-1 < iVar9) {
      local_3c[1] = 0x40;
      *local_3c = 2;
      local_3c[2] = 1;
      puVar7 = local_3c + 3;
      iVar11 = iVar11 + -3;
      if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) != 0) {
        puVar7 = local_3c + 0x11;
        local_3c[4] = (char)iVar14 + -2;
        local_3c[10] = 3;
        local_3c[0xb] = 5;
        local_3c[0xd] = 4;
        local_3c[0xf] = 2;
        local_3c[0x10] = 1;
        local_3c[3] = 0;
        local_3c[5] = 5;
        local_3c[6] = 3;
        local_3c[7] = 4;
        local_3c[8] = 3;
        local_3c[9] = 2;
        local_3c[0xc] = 1;
        local_3c[0xe] = 1;
        iVar11 = iVar11 - iVar14;
      }
      iVar14 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
      *puVar7 = (char)((uint)(iVar13 + param_3) >> 8);
      puVar7[1] = (char)(iVar13 + param_3);
      puVar7 = puVar7 + 2;
      iVar9 = (iVar11 - *(int *)(param_1 + 0x1238)) + -2;
      local_3c = puVar7;
      for (; sVar12 = iVar9 - 2, iVar14 != 0; iVar14 = *(int *)(iVar14 + 0x31c)) {
        if (*(int *)(iVar14 + 0x188) == 0) {
          return -1;
        }
        __n = (size_t)*(ushort *)(iVar14 + 0x18c);
        __n_00 = 0;
        if (__n != 0) {
          uVar5 = (undefined)(*(ushort *)(iVar14 + 0x18c) >> 8);
          if (iVar9 < 2) {
            *puVar7 = uVar5;
            local_3c = local_3c + 1;
            local_2c = 1;
            break;
          }
          *puVar7 = uVar5;
          local_3c[1] = (char)*(undefined2 *)(iVar14 + 0x18c);
          local_3c = local_3c + 2;
          __n_00 = __n;
          if ((int)sVar12 < (int)__n) {
            __n_00 = sVar12;
          }
          memcpy(local_3c,*(void **)(iVar14 + 0x188),__n_00);
          puVar7 = local_3c + __n_00;
          iVar9 = sVar12 - __n_00;
          __n = __n - __n_00 & 0xffff;
          param_3 = param_3 - __n_00;
          local_3c = puVar7;
          if (iVar9 == 0) break;
        }
      }
      iVar9 = FUN_0044e628(param_1,0x16,0xd,local_42,local_44[0],local_40,param_2,&local_3c);
      while (-1 < iVar9) {
        if (param_3 < 1) goto LAB_00453fb8;
        param_2[2] = (int)local_3c;
        if ((iVar14 == 0) || (*(int *)(iVar14 + 0x188) == 0)) {
          return -1;
        }
        if (local_2c < 1) {
          local_42 = 0;
        }
        else {
          local_42 = (ushort)local_2c;
        }
        uVar8 = *(uint *)(param_1 + 0xd00);
        uVar6 = __n + local_42;
        if ((int)uVar8 < (int)((uint)local_42 + param_3)) {
          local_42 = (ushort)uVar8 + local_42;
        }
        else {
          iVar9 = *(int *)(iVar14 + 0x31c);
          local_42 = (ushort)uVar6;
          if (iVar9 != 0) {
            do {
              uVar10 = uVar6 & 0xffff;
              uVar6 = *(ushort *)(iVar9 + 0x18c) + uVar6 + 2;
              local_42 = (ushort)uVar8;
              if (uVar8 < uVar10 + *(ushort *)(iVar9 + 0x18c) + 2) goto LAB_00454128;
              iVar9 = *(int *)(iVar9 + 0x31c);
            } while (iVar9 != 0);
            local_42 = (ushort)uVar6;
          }
        }
LAB_00454128:
        uVar6 = (uint)local_42;
        local_42 = (short)*(undefined4 *)(param_1 + 0x1234) + local_42;
        iVar9 = FUN_0044decc(param_1,0x5b,0xd,&local_42,local_44,&local_40,local_30,&local_3c);
        if (iVar9 < 0) {
          return iVar9;
        }
        if (local_2c < 1) {
          bVar3 = uVar6 < __n;
        }
        else {
          uVar6 = uVar6 - 1;
          *local_3c = (char)__n;
          local_3c = local_3c + 1;
          bVar3 = (int)uVar6 < (int)__n;
        }
        local_2c = 0;
        if (bVar3) {
          memcpy(local_3c,(void *)(*(int *)(iVar14 + 0x188) + __n_00),uVar6);
          local_3c = local_3c + uVar6;
          __n_00 = __n_00 + uVar6;
          __n = __n - uVar6 & 0xffff;
          param_3 = param_3 - uVar6;
        }
        else {
          memcpy(local_3c,(void *)(*(int *)(iVar14 + 0x188) + __n_00),__n);
          local_3c = local_3c + __n;
          iVar9 = uVar6 - __n;
          param_3 = param_3 - __n;
          __n = 0;
          do {
            sVar12 = iVar9 - 2;
            if (iVar9 < 1) break;
            iVar14 = *(int *)(iVar14 + 0x31c);
            if (iVar14 == 0) {
              return -1;
            }
            __n_00 = 0;
            if (*(int *)(iVar14 + 0x188) == 0) {
              return -1;
            }
            uVar2 = *(ushort *)(iVar14 + 0x18c);
            __n = (size_t)uVar2;
            uVar5 = (undefined)(uVar2 >> 8);
            if (iVar9 < 2) {
              *local_3c = uVar5;
              local_3c = local_3c + 1;
              local_2c = 1;
              break;
            }
            *local_3c = uVar5;
            local_3c[1] = (char)uVar2;
            local_3c = local_3c + 2;
            __n_00 = __n;
            if ((int)sVar12 < (int)__n) {
              __n_00 = sVar12;
            }
            memcpy(local_3c,*(void **)(iVar14 + 0x188),__n_00);
            local_3c = local_3c + __n_00;
            iVar9 = sVar12 - __n_00;
            __n = __n - __n_00 & 0xffff;
            param_3 = param_3 - __n_00;
          } while (iVar9 != 0);
        }
        iVar9 = FUN_0044e628(param_1,0x16,0xd,local_42,local_44[0],local_40,param_2,&local_3c);
      }
    }
    return iVar9;
  }
LAB_00453fb8:
  param_2[2] = (int)local_3c;
  return 0;
}



int sslEncodeResponse(int param_1,int *param_2,uint *param_3)

{
  ushort *puVar1;
  byte bVar2;
  ushort uVar3;
  short sVar4;
  undefined4 uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  uint uVar14;
  int iVar15;
  int iVar16;
  uint uVar17;
  undefined uVar18;
  int iVar19;
  undefined4 uVar20;
  int iVar21;
  undefined auStack_130 [72];
  undefined local_e8 [2];
  ushort local_e6;
  undefined local_e4 [2];
  short local_e2;
  short local_e0;
  undefined local_de;
  byte local_dd;
  undefined local_dc [2];
  short local_da;
  undefined local_d8 [2];
  short local_d6;
  undefined local_d4 [2];
  short local_d2;
  undefined local_d0 [2];
  short local_ce;
  undefined local_cc [2];
  short local_ca;
  undefined local_c8 [2];
  short local_c6;
  undefined local_c4 [2];
  short local_c2;
  undefined local_c0 [2];
  short local_be;
  undefined local_bc [2];
  ushort local_ba;
  undefined local_b8 [2];
  short local_b6;
  undefined local_b4 [2];
  short local_b2;
  undefined4 local_b0;
  undefined *local_ac;
  undefined4 local_a8;
  undefined *local_a4;
  void *local_a0;
  undefined4 local_9c;
  undefined *local_98;
  undefined4 local_94;
  undefined *local_90;
  undefined4 local_8c;
  int local_88;
  int local_84;
  undefined4 local_80;
  undefined *local_7c;
  undefined4 local_78;
  int local_74;
  int local_70;
  undefined4 local_6c;
  undefined *local_68;
  undefined4 local_64;
  int local_60;
  undefined4 local_5c;
  undefined *local_58;
  undefined4 local_54;
  int local_50;
  undefined4 local_4c;
  undefined *local_48;
  undefined4 local_44;
  undefined *local_40;
  undefined4 local_3c;
  int local_38;
  int local_34;
  int local_30;
  
  memset(auStack_130,0,0x44);
  iVar11 = -0xc;
  local_34 = 0;
  iVar19 = 0;
  local_30 = 0;
  if (*(uint *)(param_1 + 0xd30) != 0xff) {
    iVar19 = *param_2;
    local_ac = (undefined *)param_2[2];
    iVar11 = param_2[3];
    local_e6 = (short)*(undefined4 *)(param_1 + 0x1234) + 2;
    uVar17 = *(uint *)(param_1 + 0xd30) & 0xff;
    uVar18 = 2;
    if (uVar17 == 100) {
      uVar18 = 1;
      *(undefined4 *)(param_1 + 0xd30) = 0xff;
    }
    iVar11 = FUN_0044decc(param_1,0x15,0,&local_e6,local_e8,&local_b0,iVar19 + iVar11,&local_ac);
    if (iVar11 < 0) {
      *param_3 = (uint)local_e6;
    }
    else {
      *local_ac = uVar18;
      local_ac[1] = (char)uVar17;
      local_ac = local_ac + 2;
      iVar11 = FUN_0044efd0(param_1,0x15,0,local_e6,local_e8[0],local_b0,param_2,&local_ac);
      if (iVar11 < 0) {
        *param_3 = (uint)local_e6;
      }
      else {
        iVar11 = 0;
        param_2[2] = (int)local_ac;
      }
    }
    if (iVar11 == -0xc) {
      uVar17 = *(uint *)(param_1 + 0xd2c);
      *(uint *)(param_1 + 0xd2c) = uVar17 | 0x40;
    }
    else {
      uVar17 = *(uint *)(param_1 + 0xd2c);
    }
    if ((uVar17 & 1) != 0) {
      matrixClearSession(param_1,1);
    }
    return iVar11;
  }
  uVar17 = *(uint *)(param_1 + 0xd2c);
  if ((uVar17 >> 0xe & 1) != 0) {
    *(undefined4 *)(param_1 + 0xdf0) = *(undefined4 *)(param_1 + 0xdec);
    *(undefined *)(param_1 + 0xdcb) = *(undefined *)(param_1 + 0xdc9);
    *(undefined *)(param_1 + 0xdcc) = *(undefined *)(param_1 + 0xdca);
  }
  bVar2 = *(byte *)(param_1 + 0xd38);
  uVar14 = 0xb;
  if (bVar2 == 0xb) {
LAB_00454b18:
    if ((uVar17 >> 7 & 1) != 0) {
      iVar11 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
      local_30 = 0;
      iVar19 = 0;
      local_34 = 0;
      if ((uVar17 >> 0xd & 1) != 0) {
        iVar19 = 0xe;
      }
      if (iVar11 == 0) {
        return -0xc;
      }
      iVar19 = *(int *)(param_1 + 0x1234) + *(int *)(param_1 + 0x1238) + iVar19 + 5;
      do {
        puVar1 = (ushort *)(iVar11 + 0x18c);
        iVar11 = *(int *)(iVar11 + 0x31c);
        local_30 = local_30 + (uint)*puVar1;
        local_34 = local_34 + 1;
        iVar19 = iVar19 + 2;
      } while (iVar11 != 0);
    }
    iVar11 = 0;
    if ((uVar17 >> 0x11 & 1) == 0) {
      iVar11 = 0;
      if ((uVar17 >> 0x12 & 1) == 0) {
        iVar21 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74);
        iVar6 = 0;
        if (iVar21 != 0) {
          do {
            iVar6 = iVar6 + 1;
            if (*(int *)(iVar21 + 0x310) == 0) {
              _psTraceStr("psAssert %s","sslEncode.c");
              _psTraceInt(&DAT_0049016c,0x623);
              _psError("cert->unparsedBin != NULL");
            }
            puVar1 = (ushort *)(iVar21 + 0x314);
            iVar21 = *(int *)(iVar21 + 0x31c);
            iVar11 = iVar11 + (uint)*puVar1;
          } while (iVar21 != 0);
          uVar17 = *(uint *)(param_1 + 0xd2c);
        }
        iVar21 = *(int *)(param_1 + 0x1238);
        uVar10 = *(uint *)(param_1 + 0xd00);
        uVar14 = iVar6 * 3 + iVar11 + iVar21 + 3;
        if ((int)uVar10 < (int)uVar14) {
          *(uint *)(param_1 + 0xd0c) = uVar14;
          *(undefined4 *)(param_1 + 0xd08) = 0;
          iVar13 = 0;
          if (uVar14 == 0) {
            iVar9 = *(int *)(param_1 + 0x1234);
          }
          else {
            iVar9 = *(int *)(param_1 + 0x1234);
            do {
              if (*(int *)(param_1 + 0xd08) == 0) {
                *(uint *)(param_1 + 0xd0c) = uVar14 - uVar10;
                *(undefined4 *)(param_1 + 0xd08) = 1;
              }
              else {
                iVar16 = 0;
                if ((uVar17 >> 2 & 1) != 0) {
                  uVar7 = (uint)*(byte *)(param_1 + 0xd27);
                  iVar16 = *(byte *)(param_1 + 0xd24) + uVar7;
                  if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar7)) {
                    iVar16 = iVar16 + uVar7;
                  }
                  if ((uVar17 >> 0x14 & 1) != 0) {
                    iVar12 = 8;
                    if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
                      iVar12 = 0x10;
                    }
                    if ((uVar17 >> 0x16 & 1) == 0) {
                      iVar16 = iVar16 + iVar12;
                    }
                    else {
                      iVar16 = iVar16 + iVar12 + 8;
                    }
                  }
                }
                iVar13 = iVar13 + iVar16 + iVar9;
                if (uVar10 < uVar14) {
                  *(uint *)(param_1 + 0xd0c) = uVar14 - uVar10;
                }
                else {
                  *(undefined4 *)(param_1 + 0xd0c) = 0;
                }
              }
              uVar14 = *(uint *)(param_1 + 0xd0c);
            } while (uVar14 != 0);
          }
          iVar11 = iVar11 + iVar13;
        }
        else {
          iVar9 = *(int *)(param_1 + 0x1234);
        }
        iVar11 = (iVar9 + iVar21 + iVar6) * 3 + iVar11 + 0x49;
      }
      else {
        iVar9 = *(int *)(param_1 + 0x1234);
        iVar21 = *(int *)(param_1 + 0x1238);
        uVar10 = *(uint *)(param_1 + 0xd00);
        iVar11 = (iVar9 + iVar21) * 3 + 0x68;
      }
      if ((uVar17 >> 7 & 1) != 0) {
        uVar14 = iVar19 + local_30;
        if ((int)uVar10 < (int)uVar14) {
          *(uint *)(param_1 + 0xd0c) = uVar14;
          *(undefined4 *)(param_1 + 0xd08) = 0;
          iVar6 = 0;
          if (uVar14 != 0) {
            do {
              if (*(int *)(param_1 + 0xd08) == 0) {
                *(uint *)(param_1 + 0xd0c) = uVar14 - uVar10;
                *(undefined4 *)(param_1 + 0xd08) = 1;
              }
              else {
                iVar13 = 0;
                if ((uVar17 >> 2 & 1) != 0) {
                  uVar7 = (uint)*(byte *)(param_1 + 0xd27);
                  iVar13 = *(byte *)(param_1 + 0xd24) + uVar7;
                  if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar7)) {
                    iVar13 = iVar13 + uVar7;
                  }
                  if ((uVar17 >> 0x14 & 1) != 0) {
                    iVar16 = 8;
                    if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
                      iVar16 = 0x10;
                    }
                    if ((uVar17 >> 0x16 & 1) == 0) {
                      iVar13 = iVar13 + iVar16;
                    }
                    else {
                      iVar13 = iVar13 + iVar16 + 8;
                    }
                  }
                }
                iVar6 = iVar6 + iVar13 + iVar9;
                if (uVar10 < uVar14) {
                  *(uint *)(param_1 + 0xd0c) = uVar14 - uVar10;
                }
                else {
                  *(undefined4 *)(param_1 + 0xd0c) = 0;
                }
              }
              uVar14 = *(uint *)(param_1 + 0xd0c);
            } while (uVar14 != 0);
          }
          uVar14 = iVar19 + iVar6 + local_30;
        }
        iVar19 = 0;
        if ((uVar17 >> 2 & 1) != 0) {
          uVar7 = (uint)*(byte *)(param_1 + 0xd27);
          iVar19 = *(byte *)(param_1 + 0xd24) + uVar7;
          if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar7)) {
            iVar19 = iVar19 + uVar7;
          }
          if ((uVar17 >> 0x14 & 1) != 0) {
            iVar6 = 8;
            if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
              iVar6 = 0x10;
            }
            if ((uVar17 >> 0x16 & 1) == 0) {
              iVar19 = iVar19 + iVar6;
            }
            else {
              iVar19 = iVar19 + iVar6 + 8;
            }
          }
        }
        iVar11 = iVar11 + uVar14 + iVar19;
        if (((uVar17 >> 0xe & 1) != 0) &&
           (iVar11 = iVar11 + (iVar9 + iVar21) * 0xf, (uVar17 >> 2 & 1) != 0)) {
          uVar14 = (uint)*(byte *)(param_1 + 0xd27);
          iVar19 = (*(byte *)(param_1 + 0xd24) + uVar14) * 0xf;
          if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
            iVar19 = iVar19 + uVar14 * 0xf;
          }
          if ((uVar17 >> 0x14 & 1) != 0) {
            iVar6 = 8;
            if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
              iVar6 = 0x10;
            }
            if ((uVar17 >> 0x16 & 1) != 0) {
              iVar6 = iVar6 + 8;
            }
            iVar19 = iVar19 + iVar6 * 0xf;
          }
          iVar11 = iVar11 + iVar19;
        }
      }
      iVar19 = 0;
      if ((uVar17 >> 2 & 1) != 0) {
        uVar14 = (uint)*(byte *)(param_1 + 0xd27);
        iVar19 = (*(byte *)(param_1 + 0xd24) + uVar14) * 3;
        if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
          iVar19 = iVar19 + uVar14 * 3;
        }
        if ((uVar17 >> 0x14 & 1) != 0) {
          iVar6 = 8;
          if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
            iVar6 = 0x10;
          }
          if ((uVar17 >> 0x16 & 1) != 0) {
            iVar6 = iVar6 + 8;
          }
          iVar6 = iVar6 * 3;
          goto LAB_004550b0;
        }
      }
    }
    else {
      if ((uVar17 >> 0x13 & 1) == 0) {
        iVar21 = *(int *)(param_1 + 0xc48);
      }
      else {
        if ((uVar17 >> 0xf & 1) == 0) {
          if ((uVar17 >> 0x10 & 1) == 0) {
            iVar21 = *(int *)(param_1 + 0xc48);
          }
          else {
            iVar21 = *(int *)(param_1 + 0xc48);
            iVar6 = (uint)**(byte **)(*(int *)(param_1 + 0xc34) + 0x34) * 2 +
                    (uint)*(ushort *)(iVar21 + 0x70);
            iVar11 = iVar6 + 0xd;
            if (0x7f < *(ushort *)(iVar21 + 0x70)) {
              iVar11 = iVar6 + 0xe;
            }
            iVar11 = iVar11 + 2;
          }
        }
        else {
          iVar21 = *(int *)(param_1 + 0xc48);
          iVar11 = (uint)**(byte **)(*(int *)(param_1 + 0xc34) + 0x34) * 2 +
                   (uint)*(ushort *)(iVar21 + 0x70) + 7;
        }
        if ((uVar17 >> 0xd & 1) != 0) {
          iVar11 = iVar11 + 2;
        }
      }
      iVar6 = 0;
      iVar13 = 0;
      for (iVar21 = *(int *)(iVar21 + 0x74); iVar21 != 0; iVar21 = *(int *)(iVar21 + 0x31c)) {
        iVar13 = iVar13 + (uint)*(ushort *)(iVar21 + 0x314);
        iVar6 = iVar6 + 1;
      }
      iVar21 = *(int *)(param_1 + 0x1238);
      uVar10 = *(uint *)(param_1 + 0xd00);
      uVar14 = iVar6 * 3 + iVar13 + iVar21 + 3;
      if ((int)uVar10 < (int)uVar14) {
        *(uint *)(param_1 + 0xd0c) = uVar14;
        *(undefined4 *)(param_1 + 0xd08) = 0;
        iVar16 = 0;
        if (uVar14 == 0) {
          iVar9 = *(int *)(param_1 + 0x1234);
        }
        else {
          iVar9 = *(int *)(param_1 + 0x1234);
          do {
            if (*(int *)(param_1 + 0xd08) == 0) {
              *(uint *)(param_1 + 0xd0c) = uVar14 - uVar10;
              *(undefined4 *)(param_1 + 0xd08) = 1;
            }
            else {
              iVar12 = 0;
              if ((uVar17 >> 2 & 1) != 0) {
                uVar7 = (uint)*(byte *)(param_1 + 0xd27);
                iVar12 = *(byte *)(param_1 + 0xd24) + uVar7;
                if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar7)) {
                  iVar12 = iVar12 + uVar7;
                }
                if ((uVar17 >> 0x14 & 1) != 0) {
                  iVar15 = 8;
                  if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
                    iVar15 = 0x10;
                  }
                  if ((uVar17 >> 0x16 & 1) == 0) {
                    iVar12 = iVar12 + iVar15;
                  }
                  else {
                    iVar12 = iVar12 + iVar15 + 8;
                  }
                }
              }
              iVar16 = iVar16 + iVar12 + iVar9;
              if (uVar10 < uVar14) {
                *(uint *)(param_1 + 0xd0c) = uVar14 - uVar10;
              }
              else {
                *(undefined4 *)(param_1 + 0xd0c) = 0;
              }
            }
            uVar14 = *(uint *)(param_1 + 0xd0c);
          } while (uVar14 != 0);
        }
        iVar13 = iVar13 + iVar16;
      }
      else {
        iVar9 = *(int *)(param_1 + 0x1234);
      }
      iVar11 = (iVar9 + iVar21) * 4 + iVar6 * 3 + iVar11 + iVar13 + 0x49;
      if ((uVar17 >> 7 & 1) != 0) {
        uVar14 = iVar19 + local_30;
        if ((int)uVar10 < (int)uVar14) {
          *(uint *)(param_1 + 0xd0c) = uVar14;
          *(undefined4 *)(param_1 + 0xd08) = 0;
          iVar6 = 0;
          if (uVar14 != 0) {
            do {
              if (*(int *)(param_1 + 0xd08) == 0) {
                *(uint *)(param_1 + 0xd0c) = uVar14 - uVar10;
                *(undefined4 *)(param_1 + 0xd08) = 1;
              }
              else {
                iVar13 = 0;
                if ((uVar17 >> 2 & 1) != 0) {
                  uVar7 = (uint)*(byte *)(param_1 + 0xd27);
                  iVar13 = *(byte *)(param_1 + 0xd24) + uVar7;
                  if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar7)) {
                    iVar13 = iVar13 + uVar7;
                  }
                  if ((uVar17 >> 0x14 & 1) != 0) {
                    iVar16 = 8;
                    if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
                      iVar16 = 0x10;
                    }
                    if ((uVar17 >> 0x16 & 1) == 0) {
                      iVar13 = iVar13 + iVar16;
                    }
                    else {
                      iVar13 = iVar13 + iVar16 + 8;
                    }
                  }
                }
                iVar6 = iVar6 + iVar13 + iVar9;
                if (uVar10 < uVar14) {
                  *(uint *)(param_1 + 0xd0c) = uVar14 - uVar10;
                }
                else {
                  *(undefined4 *)(param_1 + 0xd0c) = 0;
                }
              }
              uVar14 = *(uint *)(param_1 + 0xd0c);
            } while (uVar14 != 0);
          }
          uVar14 = iVar19 + iVar6 + local_30;
        }
        iVar19 = 0;
        if ((uVar17 >> 2 & 1) != 0) {
          uVar7 = (uint)*(byte *)(param_1 + 0xd27);
          iVar19 = *(byte *)(param_1 + 0xd24) + uVar7;
          if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar7)) {
            iVar19 = iVar19 + uVar7;
          }
          if ((uVar17 >> 0x14 & 1) != 0) {
            iVar6 = 8;
            if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
              iVar6 = 0x10;
            }
            if ((uVar17 >> 0x16 & 1) == 0) {
              iVar11 = iVar11 + uVar14 + iVar19 + iVar6;
              goto LAB_00455ea4;
            }
            iVar19 = iVar19 + iVar6 + 8;
          }
        }
        iVar11 = iVar11 + uVar14 + iVar19;
      }
LAB_00455ea4:
      iVar19 = 0;
      if ((uVar17 >> 2 & 1) != 0) {
        uVar14 = (uint)*(byte *)(param_1 + 0xd27);
        iVar19 = (*(byte *)(param_1 + 0xd24) + uVar14) * 4;
        if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
          iVar19 = iVar19 + uVar14 * 4;
        }
        if ((uVar17 >> 0x14 & 1) != 0) {
          iVar6 = 8;
          if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
            iVar6 = 0x10;
          }
          if ((uVar17 >> 0x16 & 1) == 0) {
            iVar6 = iVar6 << 2;
          }
          else {
            iVar6 = (iVar6 + 8) * 4;
          }
LAB_004550b0:
          iVar19 = iVar19 + iVar6;
        }
      }
    }
    iVar11 = iVar11 + iVar19;
    if (((uVar17 >> 0xe & 1) != 0) &&
       (iVar11 = iVar11 + (iVar9 + iVar21) * 0xf, (uVar17 >> 2 & 1) != 0)) {
      uVar14 = (uint)*(byte *)(param_1 + 0xd27);
      iVar19 = (*(byte *)(param_1 + 0xd24) + uVar14) * 0xf;
      if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
        iVar19 = iVar19 + uVar14 * 0xf;
      }
      if ((uVar17 >> 0x14 & 1) != 0) {
        iVar6 = 8;
        if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
          iVar6 = 0x10;
        }
        if ((uVar17 >> 0x16 & 1) != 0) {
          iVar6 = iVar6 + 8;
        }
        iVar19 = iVar19 + iVar6 * 0xf;
      }
      iVar11 = iVar11 + iVar19;
    }
    iVar19 = 0;
    if ((int)uVar10 < 0x4000) {
      iVar11 = iVar11 + 5;
      iVar19 = 2;
    }
    uVar14 = *(uint *)(param_1 + 0x1230);
    if ((uVar14 >> 0x10 & 1) != 0) {
      iVar11 = iVar11 + 4;
      iVar19 = 2;
    }
    if ((uVar14 >> 0x11 & 1) != 0) {
      iVar11 = iVar11 + 4;
      iVar19 = 2;
    }
    if ((uVar14 >> 0x14 & 1) != 0) {
      iVar19 = 2;
      iVar6 = 0;
      if ((uVar17 >> 2 & 1) != 0) {
        uVar10 = (uint)*(byte *)(param_1 + 0xd27);
        iVar6 = *(byte *)(param_1 + 0xd24) + uVar10;
        if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar10)) {
          iVar6 = iVar6 + uVar10;
        }
        if ((uVar17 >> 0x14 & 1) != 0) {
          iVar13 = 8;
          if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
            iVar13 = 0x10;
          }
          if ((uVar17 >> 0x16 & 1) == 0) {
            iVar6 = iVar6 + iVar13;
          }
          else {
            iVar6 = iVar6 + iVar13 + 8;
          }
        }
      }
      iVar11 = iVar11 + iVar21 + iVar9 + (uint)*(ushort *)(*(int *)(param_1 + 0xc48) + 0x8c) + 8 +
               iVar6;
    }
    if ((*(int *)(param_1 + 0xcbc) != 0) && (*(short *)(*(int *)(param_1 + 0xcbc) + 0x5c) == 3)) {
      iVar11 = iVar11 + 4;
      iVar19 = 2;
    }
    if ((uVar14 >> 0xf & 1) != 0) {
      iVar11 = iVar11 + 4;
      iVar19 = 2;
    }
    if ((uVar17 >> 0x13 & 1) != 0) {
      iVar11 = iVar11 + 6;
      iVar19 = 2;
    }
    if ((*param_2 + param_2[3]) - param_2[2] < iVar11 + iVar19) {
      *param_3 = iVar11 + iVar19;
      return -0x32;
    }
    iVar11 = FUN_0044f948(param_1,param_2);
    uVar17 = *(uint *)(param_1 + 0xd2c);
    if ((uVar17 >> 0x11 & 1) == 0) {
      if ((uVar17 >> 0x12 & 1) == 0) {
        uVar14 = uVar17 >> 7;
        if (iVar11 == 0) {
          iVar11 = FUN_00450b90(param_1,param_2,1);
          if (iVar11 != 0) goto LAB_004564c0;
          iVar11 = 0;
          if ((*(uint *)(param_1 + 0x1230) >> 0x14 & 1) != 0) {
            uVar3 = *(ushort *)(*(int *)(param_1 + 0xc48) + 0x8c);
            local_90 = (undefined *)param_2[2];
            local_da = (short)*(undefined4 *)(param_1 + 0x1234) +
                       (short)*(undefined4 *)(param_1 + 0x1238) + uVar3 + 4;
            iVar11 = FUN_0044decc(param_1,0x16,0x16,&local_da,local_dc,&local_94,
                                  *param_2 + param_2[3],&local_90);
            if (-1 < iVar11) {
              *local_90 = 1;
              local_90[1] = 0;
              local_90[2] = (char)(uVar3 >> 8);
              local_90[3] = (char)uVar3;
              local_90 = local_90 + 4;
              memcpy(local_90,*(void **)(*(int *)(param_1 + 0xc48) + 0x88),(uint)uVar3);
              local_90 = local_90 + uVar3;
              iVar11 = FUN_0044e628(param_1,0x16,0x16,local_da,local_dc[0],local_94,param_2,
                                    &local_90);
              if (-1 < iVar11) {
                param_2[2] = (int)local_90;
                goto LAB_004555a0;
              }
            }
          }
          goto LAB_00455488;
        }
      }
      else {
        uVar14 = uVar17 >> 7;
        if (iVar11 == 0) {
          iVar19 = matrixPskGetHint(param_1,&local_a0,&local_dd);
          iVar11 = -0xc;
          if ((-1 < iVar19) && (iVar11 = 0, local_a0 != (void *)0x0)) {
            if (local_dd == 0) {
              iVar11 = 0;
            }
            else {
              local_98 = (undefined *)param_2[2];
              local_e0 = (short)*(undefined4 *)(param_1 + 0x1234) +
                         (short)*(undefined4 *)(param_1 + 0x1238) + (ushort)local_dd + 2;
              iVar11 = FUN_0044decc(param_1,0x16,0xc,&local_e0,&local_de,&local_9c,
                                    *param_2 + param_2[3],&local_98);
              if (-1 < iVar11) {
                *local_98 = 0;
                local_98[1] = local_dd;
                local_98 = local_98 + 2;
                memcpy(local_98,local_a0,(size_t)local_dd);
                local_98 = local_98 + local_dd;
                iVar11 = FUN_0044e628(param_1,0x16,0xc,local_e0,local_de,local_9c,param_2,&local_98)
                ;
                if (-1 < iVar11) {
                  param_2[2] = (int)local_98;
LAB_004555a0:
                  uVar17 = *(uint *)(param_1 + 0xd2c);
                  iVar11 = 0;
                  goto LAB_00455330;
                }
              }
            }
          }
LAB_00455488:
          uVar17 = *(uint *)(param_1 + 0xd2c);
          goto LAB_00455330;
        }
      }
    }
    else {
      if (((uVar17 >> 0xf & 1) == 0) && ((uVar17 >> 0x10 & 1) == 0)) {
LAB_0045647c:
        uVar14 = uVar17 >> 7;
        if ((iVar11 != 0) || ((uVar17 >> 0x13 & 1) == 0)) goto LAB_00455338;
        iVar11 = FUN_004500f8(param_1,param_2,0,0,0,0);
      }
      else {
        if (iVar11 != 0) {
LAB_00455330:
          uVar14 = uVar17 >> 7;
          goto LAB_00455338;
        }
        iVar11 = FUN_00450b90(param_1,param_2,1);
        if (iVar11 == 0) {
          iVar11 = 0;
          if ((*(uint *)(param_1 + 0x1230) >> 0x14 & 1) != 0) {
            uVar3 = *(ushort *)(*(int *)(param_1 + 0xc48) + 0x8c);
            local_a4 = (undefined *)param_2[2];
            local_e2 = (short)*(undefined4 *)(param_1 + 0x1234) +
                       (short)*(undefined4 *)(param_1 + 0x1238) + uVar3 + 4;
            iVar11 = FUN_0044decc(param_1,0x16,0x16,&local_e2,local_e4,&local_a8,
                                  *param_2 + param_2[3],&local_a4);
            if (-1 < iVar11) {
              *local_a4 = 1;
              local_a4[1] = 0;
              local_a4[2] = (char)(uVar3 >> 8);
              local_a4[3] = (char)uVar3;
              local_a4 = local_a4 + 4;
              memcpy(local_a4,*(void **)(*(int *)(param_1 + 0xc48) + 0x88),(uint)uVar3);
              local_a4 = local_a4 + uVar3;
              iVar11 = FUN_0044e628(param_1,0x16,0x16,local_e2,local_e4[0],local_a8,param_2,
                                    &local_a4);
              if (-1 < iVar11) {
                iVar11 = 0;
                param_2[2] = (int)local_a4;
              }
            }
          }
          uVar17 = *(uint *)(param_1 + 0xd2c);
          goto LAB_0045647c;
        }
      }
LAB_004564c0:
      uVar14 = *(uint *)(param_1 + 0xd2c) >> 7;
    }
LAB_00455338:
    if ((uVar14 & 1) != 0) {
      if (iVar11 != 0) goto LAB_00454a80;
      iVar11 = FUN_00453af4(param_1,param_2,local_30,local_34);
    }
    if (iVar11 == 0) {
      local_88 = param_2[2];
      local_d6 = (short)*(undefined4 *)(param_1 + 0x1234) + (short)*(undefined4 *)(param_1 + 0x1238)
      ;
      iVar11 = FUN_0044decc(param_1,0x16,0xe,&local_d6,local_d8,&local_8c,*param_2 + param_2[3],
                            &local_88);
      if ((-1 < iVar11) &&
         (iVar11 = FUN_0044e628(param_1,0x16,0xe,local_d6,local_d8[0],local_8c,param_2,&local_88),
         -1 < iVar11)) {
        iVar11 = 0;
        param_2[2] = local_88;
      }
    }
    goto LAB_00454a80;
  }
  if (bVar2 < 0xc) {
    if (bVar2 == 1) {
      iVar11 = 0;
      if ((uVar17 >> 2 & 1) != 0) {
        uVar10 = (uint)*(byte *)(param_1 + 0xd27);
        iVar11 = *(byte *)(param_1 + 0xd24) + uVar10;
        if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar10)) {
          iVar11 = iVar11 + uVar10;
        }
        if ((uVar17 >> 0x14 & 1) != 0) {
          uVar14 = *(uint *)(param_1 + 0xd10);
          iVar19 = 8;
          if ((*(uint *)(uVar14 + 4) >> 0xd & 1) == 0) {
            iVar19 = 0x10;
          }
          if ((uVar17 >> 0x16 & 1) == 0) {
            iVar11 = iVar11 + iVar19;
          }
          else {
            iVar11 = iVar11 + iVar19 + 8;
          }
        }
      }
      iVar19 = *param_2;
      iVar21 = param_2[3];
      local_7c = (undefined *)param_2[2];
      uVar17 = *(int *)(param_1 + 0x1234) + *(int *)(param_1 + 0x1238) + 0x13 + iVar11;
      if ((iVar19 + iVar21) - (int)local_7c < (int)uVar17) {
        *param_3 = uVar17;
        return -0x32;
      }
      local_d2 = (short)*(int *)(param_1 + 0x1234) + (short)*(int *)(param_1 + 0x1238) + 0x13;
      *(undefined4 *)(param_1 + 0xdec) = 0;
      iVar11 = FUN_0044decc(param_1,0x16,3,&local_d2,local_d4,&local_80,iVar19 + iVar21,&local_7c);
      if (-1 < iVar11) {
        *local_7c = *(undefined *)(param_1 + 2);
        local_7c[1] = *(undefined *)(param_1 + 3);
        local_7c[2] = 0x10;
        uVar17 = param_1 + 0xd55U & 3;
        iVar11 = *(int *)((param_1 + 0xd55U) - uVar17);
        uVar20 = *(undefined4 *)(param_1 + 0xd5a);
        uVar5 = *(undefined4 *)(param_1 + 0xd56);
        uVar10 = param_1 + 0xd52U & 3;
        uVar7 = *(uint *)((param_1 + 0xd52U) - uVar10);
        *(undefined4 *)(local_7c + 3) = *(undefined4 *)(param_1 + 0xd4e);
        *(uint *)(local_7c + 7) =
             (iVar11 << (3 - uVar17) * 8 | uVar14 & 0xffffffffU >> (uVar17 + 1) * 8) &
             -1 << (4 - uVar10) * 8 | uVar7 >> uVar10 * 8;
        *(undefined4 *)(local_7c + 0xb) = uVar5;
        *(undefined4 *)(local_7c + 0xf) = uVar20;
        local_7c = local_7c + 0x13;
        iVar11 = FUN_0044e628(param_1,0x16,3,local_d2,local_d4[0],local_80,param_2,&local_7c);
        if (-1 < iVar11) {
          iVar11 = 0;
          param_2[2] = (int)local_7c;
        }
      }
    }
    else {
      if (bVar2 != 2) goto LAB_0045463c;
      iVar11 = matrixSslEncodeClientHello
                         (param_1,param_2,param_1 + 0xdb8,*(undefined *)(param_1 + 0xdc8),param_3,0,
                          auStack_130);
    }
LAB_00454a88:
    if (-1 < iVar11) goto LAB_00454a90;
  }
  else {
    if (bVar2 == 0x14) {
      uVar14 = uVar17 & 1;
      if ((uVar17 & 1) != 0) {
        iVar11 = 0;
        if ((uVar17 >> 2 & 1) == 0) {
LAB_00456548:
          iVar19 = *(int *)(param_1 + 0xd10);
        }
        else {
          uVar14 = (uint)*(byte *)(param_1 + 0xd27);
          iVar11 = (*(byte *)(param_1 + 0xd24) + uVar14) * 2;
          if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
            iVar11 = iVar11 + uVar14 * 2;
          }
          if ((uVar17 >> 0x14 & 1) == 0) goto LAB_00456548;
          iVar19 = *(int *)(param_1 + 0xd10);
          iVar21 = 8;
          if ((*(uint *)(iVar19 + 4) >> 0xd & 1) == 0) {
            iVar21 = 0x10;
          }
          iVar6 = iVar21 << 1;
          if ((uVar17 >> 0x16 & 1) != 0) {
            iVar6 = (iVar21 + 8) * 2;
          }
          iVar11 = iVar11 + iVar6;
        }
        uVar14 = *(int *)(param_1 + 0x1234) * 3 + *(int *)(param_1 + 0x1238) * 2 + 0x6b + iVar11 +
                 (uint)*(byte *)(iVar19 + 8) + (uint)*(byte *)(iVar19 + 0xb);
        if ((uVar17 >> 0x13 & 1) != 0) {
          uVar14 = uVar14 + 8;
        }
        if ((uVar17 >> 0xb & 1) != 0) {
          uVar14 = uVar14 - 0x18;
        }
        if ((uVar17 >> 0xc & 1) != 0) {
          uVar17 = *(uint *)(iVar19 + 4);
          if ((uVar17 & 0x1800) == 0) {
            if ((uVar17 >> 6 & 1) == 0) {
              uVar14 = uVar14 + *(byte *)(iVar19 + 0xb);
            }
            else {
              if ((uVar17 >> 0xd & 1) == 0) goto LAB_00456bec;
              uVar14 = uVar14 + 9;
            }
          }
          else if ((uVar17 >> 0xd & 1) == 0) {
            uVar14 = uVar14 + 0x19;
          }
          else {
LAB_00456bec:
            uVar14 = uVar14 + 0x11;
          }
        }
        if ((*param_2 + param_2[3]) - param_2[2] < (int)uVar14) {
          *param_3 = uVar14;
          return -0x32;
        }
        iVar11 = FUN_0044f948(param_1,param_2);
        if (iVar11 == 0) {
          local_58 = (undefined *)param_2[2];
          local_c2 = (short)*(undefined4 *)(param_1 + 0x1234) + 1;
          iVar11 = FUN_0044decc(param_1,0x14,0,&local_c2,local_c4,&local_5c,*param_2 + param_2[3],
                                &local_58);
          if (iVar11 < 0) {
LAB_00456c78:
            if (iVar11 != 0) goto LAB_00455718;
          }
          else {
            *local_58 = 1;
            local_58 = local_58 + 1;
            iVar11 = FUN_0044e628(param_1,0x14,0,local_c2,local_c4[0],local_5c,param_2,&local_58);
            if (iVar11 < 0) goto LAB_00456c78;
            param_2[2] = (int)local_58;
          }
          local_50 = param_2[2];
          local_be = 0x24;
          if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) != 0) {
            local_be = 0xc;
          }
          local_be = (short)*(undefined4 *)(param_1 + 0x1234) +
                     (short)*(undefined4 *)(param_1 + 0x1238) + local_be;
          iVar11 = FUN_0044decc(param_1,0x16,0x14,&local_be,local_c0,&local_54,*param_2 + param_2[3]
                                ,&local_50);
          if (-1 < iVar11) {
            *(int *)(param_1 + 0xc80) = local_50;
            iVar11 = 0xc;
            if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) == 0) {
              iVar11 = 0x24;
            }
            local_50 = iVar11 + local_50;
            iVar11 = FUN_0044e628(param_1,0x16,0x14,local_be,local_c0[0],local_54,param_2,&local_50)
            ;
            if (-1 < iVar11) {
              uVar17 = *(uint *)(param_1 + 0xd2c);
              param_2[2] = local_50;
              iVar11 = 0;
              if ((uVar17 >> 0xe & 1) == 0) {
                if (*(short *)(param_1 + 0xc5a) != 0) goto LAB_00455720;
                uVar14 = uVar17 & 1;
                if ((*(uint *)(param_1 + 0xcfc) >> 3 & 1) != 0) goto LAB_00455724;
                if (*(int *)(param_1 + 600) != 0) {
                  psX509FreeCert();
                  uVar17 = *(uint *)(param_1 + 0xd2c);
                  *(undefined4 *)(param_1 + 600) = 0;
                }
              }
              iVar11 = 0;
              goto LAB_00455720;
            }
          }
          uVar17 = *(uint *)(param_1 + 0xd2c);
        }
        else {
LAB_00455718:
          uVar17 = *(uint *)(param_1 + 0xd2c);
        }
LAB_00455720:
        uVar14 = uVar17 & 1;
      }
LAB_00455724:
      if (uVar14 == 0) {
        uVar14 = 0;
        if ((uVar17 >> 0x11 & 1) == 0) {
          uVar14 = 0x82;
          if ((uVar17 >> 0x12 & 1) == 0) {
            iVar11 = *(int *)(param_1 + 0xd10);
            if ((ushort)(*(short *)(iVar11 + 2) - 8U) < 2) {
              uVar14 = (uint)**(byte **)(*(int *)(param_1 + 600) + 0x5c) * 2 + 2;
            }
            else {
              if (*(int *)(param_1 + 600) == 0) {
                *(uint *)(param_1 + 0xd2c) = uVar17 | 0x40;
                return -0xc;
              }
              uVar14 = (uint)*(ushort *)(*(int *)(param_1 + 600) + 0x94);
            }
          }
          else {
            iVar11 = *(int *)(param_1 + 0xd10);
          }
        }
        else {
          if (((uVar17 >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) != 1)) {
            if ((uVar17 >> 0x13 & 1) != 0) {
              uVar14 = (uint)**(byte **)(*(int *)(param_1 + 0xc34) + 0x34) * 2 + 2;
            }
          }
          else {
            uVar14 = *(uint *)(param_1 + 0x121c);
          }
          if ((uVar17 >> 0x12 & 1) == 0) {
            iVar11 = *(int *)(param_1 + 0xd10);
          }
          else {
            iVar11 = *(int *)(param_1 + 0xd10);
            uVar14 = uVar14 + 0x82;
          }
        }
        iVar19 = 0;
        if ((uVar17 >> 7 & 1) == 0) {
          iVar6 = *(int *)(param_1 + 0x1234);
          iVar21 = *(int *)(param_1 + 0x1238);
        }
        else {
          iVar19 = 0;
          if (*(int *)(param_1 + 0x260) < 1) {
            if ((*(uint *)(param_1 + 0xd3c) & 0xffff00) == 0x300) {
              iVar6 = *(int *)(param_1 + 0x1234);
              iVar21 = *(int *)(param_1 + 0x1238);
              iVar19 = iVar6 + 2;
            }
            else {
              iVar6 = *(int *)(param_1 + 0x1234);
              iVar21 = *(int *)(param_1 + 0x1238);
              iVar19 = iVar6 + iVar21 + 3;
            }
          }
          else {
            iVar13 = *(int *)(param_1 + 0xc48);
            iVar9 = 0;
            for (iVar21 = *(int *)(iVar13 + 0x74); iVar21 != 0; iVar21 = *(int *)(iVar21 + 0x31c)) {
              iVar19 = iVar19 + (uint)*(ushort *)(iVar21 + 0x314);
              iVar9 = iVar9 + 1;
            }
            iVar21 = *(int *)(param_1 + 0x1238);
            uVar7 = *(uint *)(param_1 + 0xd00);
            uVar10 = iVar9 * 3 + iVar19 + iVar21 + 3;
            if ((int)uVar7 < (int)uVar10) {
              *(uint *)(param_1 + 0xd0c) = uVar10;
              *(undefined4 *)(param_1 + 0xd08) = 0;
              iVar16 = 0;
              if (uVar10 == 0) {
                iVar6 = *(int *)(param_1 + 0x1234);
              }
              else {
                iVar6 = *(int *)(param_1 + 0x1234);
                do {
                  if (*(int *)(param_1 + 0xd08) == 0) {
                    *(uint *)(param_1 + 0xd0c) = uVar10 - uVar7;
                    *(undefined4 *)(param_1 + 0xd08) = 1;
                  }
                  else {
                    iVar12 = 0;
                    if ((uVar17 >> 2 & 1) != 0) {
                      uVar8 = (uint)*(byte *)(param_1 + 0xd27);
                      iVar12 = *(byte *)(param_1 + 0xd24) + uVar8;
                      if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar8)) {
                        iVar12 = iVar12 + uVar8;
                      }
                      if ((uVar17 >> 0x14 & 1) != 0) {
                        iVar15 = 8;
                        if ((*(uint *)(iVar11 + 4) >> 0xd & 1) == 0) {
                          iVar15 = 0x10;
                        }
                        if ((uVar17 >> 0x16 & 1) == 0) {
                          iVar12 = iVar12 + iVar15;
                        }
                        else {
                          iVar12 = iVar12 + iVar15 + 8;
                        }
                      }
                    }
                    iVar16 = iVar16 + iVar12 + iVar6;
                    if (uVar7 < uVar10) {
                      *(uint *)(param_1 + 0xd0c) = uVar10 - uVar7;
                    }
                    else {
                      *(undefined4 *)(param_1 + 0xd0c) = 0;
                    }
                  }
                  uVar10 = *(uint *)(param_1 + 0xd0c);
                } while (uVar10 != 0);
              }
              iVar19 = iVar19 + iVar16;
            }
            else {
              iVar6 = *(int *)(param_1 + 0x1234);
            }
            iVar9 = iVar6 * 2 + iVar9 * 3 + iVar21 * 2 + iVar19 + (uint)*(ushort *)(iVar13 + 0x70);
            iVar19 = iVar9 + 5;
            if ((*(int *)(*(int *)(iVar13 + 0x74) + 0x1bc) == 0x206) &&
               (iVar19 = iVar9 + 0xd, 0x7f < *(ushort *)(iVar13 + 0x70))) {
              iVar19 = iVar9 + 0xe;
            }
          }
        }
        iVar19 = iVar6 * 3 + iVar21 * 2 + uVar14 + (uint)*(byte *)(iVar11 + 8) +
                 (uint)*(byte *)(iVar11 + 0xb) + iVar19;
        iVar9 = iVar19 + 0x25;
        if ((uVar17 >> 0xb & 1) != 0) {
          iVar9 = iVar19 + 0xf;
        }
        if ((uVar17 >> 7 & 1) == 0) {
          iVar19 = 0;
          if ((uVar17 >> 2 & 1) != 0) {
            uVar14 = (uint)*(byte *)(param_1 + 0xd27);
            iVar19 = (*(byte *)(param_1 + 0xd24) + uVar14) * 2;
            if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
              iVar19 = iVar19 + uVar14 * 2;
            }
            if ((uVar17 >> 0x14 & 1) != 0) {
              iVar13 = 8;
              if ((*(uint *)(iVar11 + 4) >> 0xd & 1) == 0) {
                iVar13 = 0x10;
              }
              if ((uVar17 >> 0x16 & 1) == 0) {
                iVar13 = iVar13 << 1;
              }
              else {
                iVar13 = (iVar13 + 8) * 2;
              }
LAB_004566b8:
              iVar19 = iVar19 + iVar13;
            }
          }
        }
        else if (*(int *)(param_1 + 0x260) < 1) {
          iVar19 = 0;
          if ((uVar17 >> 2 & 1) != 0) {
            uVar14 = (uint)*(byte *)(param_1 + 0xd27);
            iVar19 = (*(byte *)(param_1 + 0xd24) + uVar14) * 3;
            if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
              iVar19 = iVar19 + uVar14 * 3;
            }
            if ((uVar17 >> 0x14 & 1) != 0) {
              iVar13 = 8;
              if ((*(uint *)(iVar11 + 4) >> 0xd & 1) == 0) {
                iVar13 = 0x10;
              }
              if ((uVar17 >> 0x16 & 1) != 0) {
                iVar13 = iVar13 + 8;
              }
              iVar19 = iVar19 + iVar13 * 3;
            }
          }
        }
        else {
          if ((uVar17 >> 0xd & 1) != 0) {
            iVar9 = iVar9 + 2;
          }
          iVar19 = 0;
          if ((uVar17 >> 2 & 1) != 0) {
            uVar14 = (uint)*(byte *)(param_1 + 0xd27);
            iVar19 = (*(byte *)(param_1 + 0xd24) + uVar14) * 4;
            if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
              iVar19 = iVar19 + uVar14 * 4;
            }
            if ((uVar17 >> 0x14 & 1) != 0) {
              iVar16 = 8;
              if ((*(uint *)(iVar11 + 4) >> 0xd & 1) == 0) {
                iVar16 = 0x10;
              }
              iVar13 = iVar16 << 2;
              if ((uVar17 >> 0x16 & 1) != 0) {
                iVar13 = (iVar16 + 8) * 4;
              }
              goto LAB_004566b8;
            }
          }
        }
        uVar14 = iVar9 + iVar19;
        if (((uVar17 >> 0xe & 1) != 0) &&
           (uVar14 = uVar14 + (iVar6 + iVar21) * 0xf, (uVar17 >> 2 & 1) != 0)) {
          uVar10 = (uint)*(byte *)(param_1 + 0xd27);
          iVar19 = (*(byte *)(param_1 + 0xd24) + uVar10) * 0xf;
          if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar10)) {
            iVar19 = iVar19 + uVar10 * 0xf;
          }
          if ((uVar17 >> 0x14 & 1) != 0) {
            iVar21 = 8;
            if ((*(uint *)(iVar11 + 4) >> 0xd & 1) == 0) {
              iVar21 = 0x10;
            }
            if ((uVar17 >> 0x16 & 1) != 0) {
              iVar21 = iVar21 + 8;
            }
            iVar19 = iVar19 + iVar21 * 0xf;
          }
          uVar14 = uVar14 + iVar19;
        }
        if ((uVar17 >> 0xc & 1) != 0) {
          uVar10 = *(uint *)(iVar11 + 4);
          if ((uVar10 & 0x1800) == 0) {
            if ((uVar10 >> 6 & 1) == 0) {
              uVar14 = uVar14 + *(byte *)(iVar11 + 0xb);
            }
            else {
              if ((uVar10 >> 0xd & 1) == 0) goto LAB_00456c4c;
              uVar14 = uVar14 + 9;
            }
          }
          else if ((uVar10 >> 0xd & 1) == 0) {
            uVar14 = uVar14 + 0x19;
          }
          else {
LAB_00456c4c:
            uVar14 = uVar14 + 0x11;
          }
        }
        if ((*param_2 + param_2[3]) - (int)(undefined *)param_2[2] < (int)uVar14) {
          *param_3 = uVar14;
          return -0x32;
        }
        if ((uVar17 >> 7 & 1) == 0) {
LAB_0045682c:
          iVar11 = FUN_00452718(param_1,param_2);
        }
        else {
          if ((*(int *)(param_1 + 0x260) == 0) && ((*(uint *)(param_1 + 0xd3c) & 0xffff00) == 0x300)
             ) {
            local_ba = (short)iVar6 + 2;
            local_48 = (undefined *)param_2[2];
            iVar11 = FUN_0044decc(param_1,0x15,0,&local_ba,local_bc,&local_4c,*param_2 + param_2[3],
                                  &local_48);
            if (-1 < iVar11) {
              *local_48 = 1;
              local_48[1] = 0x29;
              local_48 = local_48 + 2;
              iVar11 = FUN_0044efd0(param_1,0x15,0,local_ba,local_bc[0],local_4c,param_2,&local_48);
              if (-1 < iVar11) {
                iVar11 = 0;
                param_2[2] = (int)local_48;
                goto LAB_00456824;
              }
            }
            *param_3 = (uint)local_ba;
          }
          else {
            iVar11 = FUN_00450b90(param_1,param_2);
          }
LAB_00456824:
          if (iVar11 == 0) goto LAB_0045682c;
        }
        if (*(char *)(param_1 + 0xd2c) < '\0') {
          if (iVar11 == 0) {
            if (0 < *(int *)(param_1 + 0x260)) {
              iVar11 = FUN_0044e888(param_1,param_2);
              goto LAB_00456890;
            }
            goto LAB_00456898;
          }
        }
        else {
LAB_00456890:
          if (iVar11 == 0) {
LAB_00456898:
            local_40 = (undefined *)param_2[2];
            local_b6 = (short)*(undefined4 *)(param_1 + 0x1234) + 1;
            iVar11 = FUN_0044decc(param_1,0x14,0,&local_b6,local_b8,&local_44,*param_2 + param_2[3],
                                  &local_40);
            if (iVar11 < 0) {
LAB_00456bc8:
              if (iVar11 != 0) goto LAB_00454a80;
            }
            else {
              *local_40 = 1;
              local_40 = local_40 + 1;
              iVar11 = FUN_0044e628(param_1,0x14,0,local_b6,local_b8[0],local_44,param_2,&local_40);
              if (iVar11 < 0) goto LAB_00456bc8;
              param_2[2] = (int)local_40;
            }
            local_38 = param_2[2];
            local_b2 = 0x24;
            if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) != 0) {
              local_b2 = 0xc;
            }
            local_b2 = (short)*(undefined4 *)(param_1 + 0x1234) +
                       (short)*(undefined4 *)(param_1 + 0x1238) + local_b2;
            iVar11 = FUN_0044decc(param_1,0x16,0x14,&local_b2,local_b4,&local_3c,
                                  *param_2 + param_2[3],&local_38);
            if (-1 < iVar11) {
              *(int *)(param_1 + 0xc80) = local_38;
              iVar11 = 0xc;
              if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) == 0) {
                iVar11 = 0x24;
              }
              local_38 = iVar11 + local_38;
              iVar11 = FUN_0044e628(param_1,0x16,0x14,local_b2,local_b4[0],local_3c,param_2,
                                    &local_38);
              if (-1 < iVar11) {
                uVar17 = *(uint *)(param_1 + 0xd2c);
                iVar11 = local_38;
                goto LAB_00454a34;
              }
            }
          }
        }
      }
LAB_00454a80:
      if (iVar11 == -0x32) {
        *(undefined4 *)(param_1 + 0xd30) = 0x50;
        local_84 = param_2[3];
        param_2[2] = param_2[1];
        goto LAB_00454668;
      }
      goto LAB_00454a88;
    }
    if (bVar2 < 0x15) {
      if (bVar2 == 0x10) goto LAB_00454b18;
    }
    else if (bVar2 == 0xff) {
      iVar19 = *(int *)(param_1 + 0x1234);
      iVar21 = *(int *)(param_1 + 0x1238);
      iVar11 = 0;
      if ((uVar17 >> 2 & 1) == 0) {
LAB_0045659c:
        iVar6 = *(int *)(param_1 + 0xd10);
      }
      else {
        uVar14 = (uint)*(byte *)(param_1 + 0xd27);
        iVar11 = *(byte *)(param_1 + 0xd24) + uVar14;
        if (((uVar17 >> 0xc & 1) != 0) && (1 < uVar14)) {
          iVar11 = iVar11 + uVar14;
        }
        if ((uVar17 >> 0x14 & 1) == 0) goto LAB_0045659c;
        iVar6 = *(int *)(param_1 + 0xd10);
        iVar9 = 8;
        if ((*(uint *)(iVar6 + 4) >> 0xd & 1) == 0) {
          iVar9 = 0x10;
        }
        if ((uVar17 >> 0x16 & 1) == 0) {
          iVar11 = iVar11 + iVar9;
        }
        else {
          iVar11 = iVar11 + iVar9 + 8;
        }
      }
      uVar14 = iVar19 * 2 + iVar21 + 0x25 + iVar11 +
               (uint)*(byte *)(iVar6 + 8) + (uint)*(byte *)(iVar6 + 0xb);
      if ((((uVar17 & 1) != 0) && (*(int *)(param_1 + 0xcbc) != 0)) &&
         (*(short *)(*(int *)(param_1 + 0xcbc) + 0x5c) == 3)) {
        iVar11 = matrixSessionTicketLen();
        uVar17 = *(uint *)(param_1 + 0xd2c);
        uVar14 = iVar19 + iVar21 + iVar11 + uVar14 + 6;
      }
      if ((uVar17 >> 0xb & 1) != 0) {
        uVar14 = uVar14 - 0x18;
      }
      if ((uVar17 >> 0xc & 1) != 0) {
        if ((uVar17 >> 0x14 & 1) == 0) {
          uVar14 = uVar14 + *(byte *)(*(int *)(param_1 + 0xd10) + 0xb);
        }
        else {
          iVar11 = 8;
          if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
            iVar11 = 0x10;
          }
          if ((uVar17 >> 0x16 & 1) == 0) {
            uVar14 = iVar11 + uVar14 + 1;
          }
          else {
            uVar14 = iVar11 + uVar14 + 9;
          }
        }
      }
      iVar19 = *param_2 + param_2[3];
      if (iVar19 - param_2[2] < (int)uVar14) {
        *param_3 = uVar14;
        return -0x32;
      }
      if ((((uVar17 & 1) != 0) && (*(int *)(param_1 + 0xcbc) != 0)) &&
         (*(short *)(*(int *)(param_1 + 0xcbc) + 0x5c) == 3)) {
        uVar20 = *(undefined4 *)(param_1 + 0x1238);
        uVar5 = *(undefined4 *)(param_1 + 0x1234);
        local_74 = param_2[2];
        sVar4 = matrixSessionTicketLen();
        local_ce = (short)uVar5 + (short)uVar20 + sVar4 + 6;
        local_70 = FUN_0044decc(param_1,0x16,4,&local_ce,local_d0,&local_78,iVar19,&local_74);
        iVar11 = local_70;
        if (-1 < local_70) {
          local_70 = iVar19 - local_74;
          iVar19 = matrixCreateSessionTicket(param_1,local_74,&local_70);
          iVar11 = -0xc;
          if (-1 < iVar19) {
            local_74 = local_74 + local_70;
            local_70 = FUN_0044e628(param_1,0x16,4,local_ce,local_d0[0],local_78,param_2,&local_74);
            iVar11 = local_70;
            if (-1 < local_70) {
              *(undefined2 *)(*(int *)(param_1 + 0xcbc) + 0x5c) = 5;
              param_2[2] = local_74;
              iVar11 = 0;
            }
          }
        }
        if (iVar11 != 0) goto LAB_00454a80;
      }
      local_68 = (undefined *)param_2[2];
      local_ca = (short)*(undefined4 *)(param_1 + 0x1234) + 1;
      iVar11 = FUN_0044decc(param_1,0x14,0,&local_ca,local_cc,&local_6c,*param_2 + param_2[3],
                            &local_68);
      if (iVar11 < 0) {
LAB_00456afc:
        if (iVar11 != 0) goto LAB_00454a80;
      }
      else {
        *local_68 = 1;
        local_68 = local_68 + 1;
        iVar11 = FUN_0044e628(param_1,0x14,0,local_ca,local_cc[0],local_6c,param_2,&local_68);
        if (iVar11 < 0) goto LAB_00456afc;
        param_2[2] = (int)local_68;
      }
      local_60 = param_2[2];
      local_c6 = 0x24;
      if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) != 0) {
        local_c6 = 0xc;
      }
      local_c6 = (short)*(undefined4 *)(param_1 + 0x1234) + (short)*(undefined4 *)(param_1 + 0x1238)
                 + local_c6;
      iVar11 = FUN_0044decc(param_1,0x16,0x14,&local_c6,local_c8,&local_64,*param_2 + param_2[3],
                            &local_60);
      if (iVar11 < 0) goto LAB_00454a80;
      *(int *)(param_1 + 0xc80) = local_60;
      iVar11 = 0xc;
      if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) == 0) {
        iVar11 = 0x24;
      }
      local_60 = iVar11 + local_60;
      iVar11 = FUN_0044e628(param_1,0x16,0x14,local_c6,local_c8[0],local_64,param_2,&local_60);
      if (iVar11 < 0) goto LAB_00454a80;
      uVar17 = *(uint *)(param_1 + 0xd2c);
      iVar11 = local_60;
LAB_00454a34:
      param_2[2] = iVar11;
      iVar11 = 0;
      if ((((uVar17 >> 0xe & 1) == 0) && (iVar11 = 0, *(short *)(param_1 + 0xc5a) == 0)) &&
         (((*(uint *)(param_1 + 0xcfc) >> 3 & 1) == 0 && (iVar11 = 0, *(int *)(param_1 + 600) != 0))
         )) {
        psX509FreeCert();
        iVar11 = 0;
        *(undefined4 *)(param_1 + 600) = 0;
      }
      goto LAB_00454a80;
    }
  }
LAB_0045463c:
  if (iVar11 != -0x32) {
    uVar5 = 0x28;
    if (iVar11 != -10) {
      uVar5 = 0x50;
    }
    *(undefined4 *)(param_1 + 0xd30) = uVar5;
    local_84 = param_2[3];
    param_2[2] = param_2[1];
LAB_00454668:
    iVar11 = sslEncodeResponse(param_1,param_2,&local_84);
    return iVar11;
  }
LAB_00454a90:
  uVar17 = *(uint *)(param_1 + 0xd2c) & 1;
  if (((*(uint *)(param_1 + 0xd2c) & 1) != 0) && (*(short *)(param_1 + 0xc5a) != 0)) {
    iVar11 = FUN_0044ce84(param_1,param_2);
    if (iVar11 < 0) {
      return iVar11;
    }
    uVar17 = *(uint *)(param_1 + 0xd2c) & 1;
  }
  if (((uVar17 == 0) && (*(short *)(param_1 + 0xc5a) != 0)) &&
     (iVar11 = FUN_0044d398(param_1), iVar11 < 0)) {
    return iVar11;
  }
  if ((*(int *)(param_1 + 0xc7c) != 0) && (iVar11 = FUN_00452f90(param_1,param_2 + 2), iVar11 < 0))
  {
    return iVar11;
  }
  return iVar11;
}



int FUN_00457028(int param_1)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  char local_54;
  undefined4 local_53;
  undefined4 local_4f;
  undefined4 local_4b;
  undefined4 local_47;
  undefined4 local_43;
  undefined4 local_3f;
  undefined4 local_3b;
  undefined4 local_37;
  undefined4 local_33;
  undefined4 local_2f;
  undefined4 local_2b;
  undefined4 local_27;
  undefined4 local_23;
  undefined4 local_1f;
  undefined4 local_1b;
  undefined4 local_17;
  
  local_53 = *(undefined4 *)(param_1 + 0x30);
  local_54 = 'n';
  local_60._0_1_ = 'k';
  local_60._1_1_ = 'e';
  local_60._2_1_ = 'y';
  local_60._3_1_ = ' ';
  local_5c._0_1_ = 'e';
  local_5c._1_1_ = 'x';
  local_5c._2_1_ = 'p';
  local_5c._3_1_ = 'a';
  local_58._0_1_ = 'n';
  local_58._1_1_ = 's';
  local_58._2_1_ = 'i';
  local_58._3_1_ = 'o';
  local_4f = *(undefined4 *)(param_1 + 0x34);
  local_4b = *(undefined4 *)(param_1 + 0x38);
  local_47 = *(undefined4 *)(param_1 + 0x3c);
  local_43 = *(undefined4 *)(param_1 + 0x40);
  local_37 = *(undefined4 *)(param_1 + 0x4c);
  local_3f = *(undefined4 *)(param_1 + 0x44);
  local_3b = *(undefined4 *)(param_1 + 0x48);
  local_33 = *(undefined4 *)(param_1 + 0x10);
  local_2f = *(undefined4 *)(param_1 + 0x14);
  local_2b = *(undefined4 *)(param_1 + 0x18);
  local_27 = *(undefined4 *)(param_1 + 0x1c);
  local_23 = *(undefined4 *)(param_1 + 0x20);
  local_1f = *(undefined4 *)(param_1 + 0x24);
  local_1b = *(undefined4 *)(param_1 + 0x28);
  local_17 = *(undefined4 *)(param_1 + 0x2c);
  iVar2 = *(int *)(param_1 + 0xd10);
  uVar1 = ((uint)*(byte *)(iVar2 + 8) + (uint)*(byte *)(iVar2 + 9) + (uint)*(byte *)(iVar2 + 10)) *
          2;
  iVar3 = -8;
  if (uVar1 < 0xe1) {
    iVar4 = param_1 + 0x86;
    if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
      iVar3 = prf(param_1 + 0x50,0x30,&local_60,0x4d,iVar4,uVar1);
    }
    else {
      iVar3 = prf2(param_1 + 0x50,0x30,&local_60,0x4d,iVar4,uVar1,*(undefined4 *)(iVar2 + 4));
    }
    if (-1 < iVar3) {
      if ((*(uint *)(param_1 + 0xd2c) & 1) == 0) {
        iVar3 = *(int *)(param_1 + 0xd10);
        *(int *)(param_1 + 0x168) = iVar4;
        iVar4 = iVar4 + (uint)*(byte *)(iVar3 + 8);
        *(int *)(param_1 + 0x16c) = iVar4;
        iVar4 = iVar4 + (uint)*(byte *)(iVar3 + 8);
        *(int *)(param_1 + 0x170) = iVar4;
        iVar4 = iVar4 + (uint)*(byte *)(iVar3 + 9);
        *(int *)(param_1 + 0x174) = iVar4;
        iVar4 = iVar4 + (uint)*(byte *)(iVar3 + 9);
        *(int *)(param_1 + 0x218) = iVar4;
        *(uint *)(param_1 + 0x21c) = iVar4 + (uint)*(byte *)(iVar3 + 10);
      }
      else {
        iVar3 = *(int *)(param_1 + 0xd10);
        *(int *)(param_1 + 0x16c) = iVar4;
        iVar4 = iVar4 + (uint)*(byte *)(iVar3 + 8);
        *(int *)(param_1 + 0x168) = iVar4;
        iVar4 = iVar4 + (uint)*(byte *)(iVar3 + 8);
        *(int *)(param_1 + 0x174) = iVar4;
        iVar4 = iVar4 + (uint)*(byte *)(iVar3 + 9);
        *(int *)(param_1 + 0x170) = iVar4;
        iVar4 = iVar4 + (uint)*(byte *)(iVar3 + 9);
        *(int *)(param_1 + 0x21c) = iVar4;
        *(uint *)(param_1 + 0x218) = iVar4 + (uint)*(byte *)(iVar3 + 10);
      }
      iVar3 = 0x30;
    }
  }
  memset_s(&local_60,0x4d,0,0x4d);
  if (-1 < iVar3) {
    return iVar3;
  }
  memset_s(param_1 + 0x50,0x30,0,0x30);
  memset_s(param_1 + 0x86,0xe0,0,0xe0);
  return iVar3;
}



int tlsDeriveKeys(int param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  char local_4c;
  undefined4 local_4b;
  undefined4 local_47;
  undefined4 local_43;
  undefined4 local_3f;
  undefined4 local_3b;
  undefined4 local_37;
  undefined4 local_33;
  undefined4 local_2f;
  undefined4 local_2b;
  undefined4 local_27;
  undefined4 local_23;
  undefined4 local_1f;
  undefined4 local_1b;
  undefined4 local_17;
  undefined4 local_13;
  undefined4 local_f;
  
  uVar2 = *(uint *)(param_1 + 0xd2c);
  if (((uVar2 >> 0xe & 1) == 0) || (iVar1 = 0x30, *(int *)(param_1 + 0xdfc) != 1)) {
    if ((uVar2 >> 3 & 1) == 0) {
      local_4b = *(undefined4 *)(param_1 + 0x10);
      local_4c = 't';
      local_58._0_1_ = 'm';
      local_58._1_1_ = 'a';
      local_58._2_1_ = 's';
      local_58._3_1_ = 't';
      local_54._0_1_ = 'e';
      local_54._1_1_ = 'r';
      local_54._2_1_ = ' ';
      local_54._3_1_ = 's';
      local_50._0_1_ = 'e';
      local_50._1_1_ = 'c';
      local_50._2_1_ = 'r';
      local_50._3_1_ = 'e';
      local_47 = *(undefined4 *)(param_1 + 0x14);
      local_43 = *(undefined4 *)(param_1 + 0x18);
      local_3f = *(undefined4 *)(param_1 + 0x1c);
      local_3b = *(undefined4 *)(param_1 + 0x20);
      local_37 = *(undefined4 *)(param_1 + 0x24);
      local_33 = *(undefined4 *)(param_1 + 0x28);
      local_2f = *(undefined4 *)(param_1 + 0x2c);
      local_2b = *(undefined4 *)(param_1 + 0x30);
      local_27 = *(undefined4 *)(param_1 + 0x34);
      local_23 = *(undefined4 *)(param_1 + 0x38);
      local_1f = *(undefined4 *)(param_1 + 0x3c);
      local_1b = *(undefined4 *)(param_1 + 0x40);
      local_17 = *(undefined4 *)(param_1 + 0x44);
      local_13 = *(undefined4 *)(param_1 + 0x48);
      local_f = *(undefined4 *)(param_1 + 0x4c);
      if ((uVar2 >> 0xd & 1) == 0) {
        iVar1 = prf(*(undefined4 *)(param_1 + 0x80),*(undefined2 *)(param_1 + 0x84),&local_58,0x4d,
                    param_1 + 0x50,0x30);
      }
      else {
        iVar1 = prf2(*(undefined4 *)(param_1 + 0x80),*(undefined2 *)(param_1 + 0x84),&local_58,0x4d,
                     param_1 + 0x50,0x30,*(undefined4 *)(*(int *)(param_1 + 0xd10) + 4));
      }
      if (iVar1 < 0) {
        return iVar1;
      }
      if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
        free(*(void **)(param_1 + 0x80));
        *(undefined4 *)(param_1 + 0x80) = 0;
        *(undefined2 *)(param_1 + 0x84) = 0;
      }
    }
    iVar1 = FUN_00457028(param_1);
  }
  return iVar1;
}



int tlsExtendedDeriveKeys(int param_1)

{
  int iVar1;
  undefined4 local_90;
  undefined4 local_8c;
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined2 local_7c;
  undefined auStack_7a [50];
  undefined auStack_48 [48];
  size_t local_18 [2];
  
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdfc) == 1)) {
    return 0x30;
  }
  if (((*(uint *)(param_1 + 0x1230) >> 0x11 & 1) == 0) ||
     ((*(uint *)(param_1 + 0xd2c) >> 3 & 1) != 0)) {
    iVar1 = -1;
  }
  else {
    extMasterSecretSnapshotHSHash(param_1,auStack_48,local_18);
    local_90._0_1_ = 'e';
    local_90._1_1_ = 'x';
    local_90._2_1_ = 't';
    local_90._3_1_ = 'e';
    local_7c._0_1_ = 'e';
    local_7c._1_1_ = 't';
    local_8c._0_1_ = 'n';
    local_8c._1_1_ = 'd';
    local_8c._2_1_ = 'e';
    local_8c._3_1_ = 'd';
    local_88._0_1_ = ' ';
    local_88._1_1_ = 'm';
    local_88._2_1_ = 'a';
    local_88._3_1_ = 's';
    local_84._0_1_ = 't';
    local_84._1_1_ = 'e';
    local_84._2_1_ = 'r';
    local_84._3_1_ = ' ';
    local_80._0_1_ = 's';
    local_80._1_1_ = 'e';
    local_80._2_1_ = 'c';
    local_80._3_1_ = 'r';
    memcpy(auStack_7a,auStack_48,local_18[0]);
    if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
      iVar1 = prf(*(undefined4 *)(param_1 + 0x80),*(undefined2 *)(param_1 + 0x84),&local_90,
                  local_18[0] + 0x16 & 0xffff,param_1 + 0x50,0x30);
    }
    else {
      iVar1 = prf2(*(undefined4 *)(param_1 + 0x80),*(undefined2 *)(param_1 + 0x84),&local_90,
                   local_18[0] + 0x16 & 0xffff,param_1 + 0x50,0x30,
                   *(undefined4 *)(*(int *)(param_1 + 0xd10) + 4));
    }
    if (-1 < iVar1) {
      if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
        free(*(void **)(param_1 + 0x80));
        *(undefined4 *)(param_1 + 0x80) = 0;
        *(undefined2 *)(param_1 + 0x84) = 0;
      }
      iVar1 = FUN_00457028(param_1);
      return iVar1;
    }
  }
  return iVar1;
}



undefined4
tlsHMACSha1(int param_1,int param_2,undefined param_3,undefined4 param_4,undefined4 param_5,
           undefined4 param_6)

{
  undefined4 uVar1;
  int iVar2;
  char *pcVar3;
  char cVar4;
  undefined2 *puVar5;
  undefined auStack_c0 [160];
  undefined local_20;
  undefined local_1f;
  undefined local_1e;
  undefined local_1d;
  undefined local_1c;
  undefined2 local_18;
  undefined4 local_16;
  undefined2 local_12;
  
  local_1f = *(undefined *)(param_1 + 0xd3d);
  local_1e = *(undefined *)(param_1 + 0xd3e);
  if (param_2 == 1) {
    iVar2 = param_1 + 0x178;
    puVar5 = (undefined2 *)(param_1 + 0x240);
  }
  else {
    iVar2 = param_1 + 0x1a8;
    puVar5 = (undefined2 *)(param_1 + 0x248);
  }
  uVar1 = 0xffffffff;
  if (iVar2 != 0) {
    if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
      if (param_2 == 1) {
        local_16 = *(undefined4 *)(param_1 + 0xdd1);
        local_18 = *(undefined2 *)(param_1 + 0xdc9);
        local_12 = *(undefined2 *)(param_1 + 0xdd5);
        puVar5 = &local_18;
      }
      else {
        local_12 = *(undefined2 *)(param_1 + 10);
        local_18 = *(undefined2 *)(param_1 + 4);
        local_16 = *(undefined4 *)(param_1 + 6);
        puVar5 = &local_18;
      }
    }
    local_1d = (undefined)((uint)param_5 >> 8);
    local_1c = (undefined)param_5;
    local_20 = param_3;
    iVar2 = psHmacSha1Init(auStack_c0,iVar2,0x14);
    uVar1 = 0xffffffff;
    if (-1 < iVar2) {
      psHmacSha1Update(auStack_c0,puVar5,8);
      psHmacSha1Update(auStack_c0,&local_20,5);
      psHmacSha1Update(auStack_c0,param_4,param_5);
      psHmacSha1Final(auStack_c0,param_6);
      iVar2 = 7;
      do {
        pcVar3 = (char *)((int)puVar5 + iVar2);
        iVar2 = iVar2 + -1;
        cVar4 = *pcVar3 + '\x01';
        *pcVar3 = cVar4;
        if (cVar4 != '\0') break;
      } while (-1 < iVar2);
      uVar1 = 0;
    }
  }
  return uVar1;
}



undefined4
tlsHMACSha2(int param_1,int param_2,undefined param_3,undefined4 param_4,undefined4 param_5,
           undefined4 param_6,int param_7)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 uVar3;
  char *pcVar4;
  char cVar5;
  undefined2 *puVar6;
  undefined auStack_178 [344];
  undefined local_20;
  undefined local_1f;
  undefined local_1e;
  undefined local_1d;
  undefined local_1c;
  undefined2 local_18;
  undefined4 local_16;
  undefined2 local_12;
  
  local_1f = *(undefined *)(param_1 + 0xd3d);
  local_1e = *(undefined *)(param_1 + 0xd3e);
  if (param_2 == 1) {
    iVar2 = param_1 + 0x178;
    puVar6 = (undefined2 *)(param_1 + 0x240);
  }
  else {
    iVar2 = param_1 + 0x1a8;
    puVar6 = (undefined2 *)(param_1 + 0x248);
  }
  if (iVar2 == 0) {
    return 0xffffffff;
  }
  local_1c = (undefined)param_5;
  local_1d = (undefined)((uint)param_5 >> 8);
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) {
    if (param_2 == 1) {
      local_18 = *(undefined2 *)(param_1 + 0xdc9);
      local_16 = *(undefined4 *)(param_1 + 0xdd1);
      local_12 = *(undefined2 *)(param_1 + 0xdd5);
      puVar6 = &local_18;
    }
    else {
      local_12 = *(undefined2 *)(param_1 + 10);
      local_18 = *(undefined2 *)(param_1 + 4);
      local_16 = *(undefined4 *)(param_1 + 6);
      puVar6 = &local_18;
    }
  }
  if (param_7 == 0x20) {
    uVar1 = 0x14;
    uVar3 = 0x20;
  }
  else {
    if (param_7 != 0x30) {
      return 0xffffffff;
    }
    uVar1 = 0x15;
    uVar3 = 0x30;
  }
  local_20 = param_3;
  iVar2 = psHmacInit(auStack_178,uVar1,iVar2,uVar3);
  uVar1 = 0xffffffff;
  if (-1 < iVar2) {
    psHmacUpdate(auStack_178,puVar6,8);
    psHmacUpdate(auStack_178,&local_20,5);
    psHmacUpdate(auStack_178,param_4,param_5);
    psHmacFinal(auStack_178,param_6);
    iVar2 = 7;
    do {
      pcVar4 = (char *)((int)puVar6 + iVar2);
      iVar2 = iVar2 + -1;
      cVar5 = *pcVar4 + '\x01';
      *pcVar4 = cVar5;
      if (cVar5 != '\0') break;
    } while (-1 < iVar2);
    uVar1 = 0;
  }
  return uVar1;
}



int sslCreateKeys(int param_1)

{
  int iVar1;
  uint uVar2;
  undefined4 uStack_58;
  undefined4 uStack_54;
  undefined4 uStack_50;
  char cStack_4c;
  undefined4 uStack_4b;
  undefined4 uStack_47;
  undefined4 uStack_43;
  undefined4 uStack_3f;
  undefined4 uStack_3b;
  undefined4 uStack_37;
  undefined4 uStack_33;
  undefined4 uStack_2f;
  undefined4 uStack_2b;
  undefined4 uStack_27;
  undefined4 uStack_23;
  undefined4 uStack_1f;
  undefined4 uStack_1b;
  undefined4 uStack_17;
  undefined4 uStack_13;
  undefined4 uStack_f;
  
  if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) == 0) {
    return -6;
  }
  uVar2 = *(uint *)(param_1 + 0xd2c);
  if (((uVar2 >> 0xe & 1) == 0) || (iVar1 = 0x30, *(int *)(param_1 + 0xdfc) != 1)) {
    if ((uVar2 >> 3 & 1) == 0) {
      uStack_4b = *(undefined4 *)(param_1 + 0x10);
      cStack_4c = 't';
      uStack_58._0_1_ = 'm';
      uStack_58._1_1_ = 'a';
      uStack_58._2_1_ = 's';
      uStack_58._3_1_ = 't';
      uStack_54._0_1_ = 'e';
      uStack_54._1_1_ = 'r';
      uStack_54._2_1_ = ' ';
      uStack_54._3_1_ = 's';
      uStack_50._0_1_ = 'e';
      uStack_50._1_1_ = 'c';
      uStack_50._2_1_ = 'r';
      uStack_50._3_1_ = 'e';
      uStack_47 = *(undefined4 *)(param_1 + 0x14);
      uStack_43 = *(undefined4 *)(param_1 + 0x18);
      uStack_3f = *(undefined4 *)(param_1 + 0x1c);
      uStack_3b = *(undefined4 *)(param_1 + 0x20);
      uStack_37 = *(undefined4 *)(param_1 + 0x24);
      uStack_33 = *(undefined4 *)(param_1 + 0x28);
      uStack_2f = *(undefined4 *)(param_1 + 0x2c);
      uStack_2b = *(undefined4 *)(param_1 + 0x30);
      uStack_27 = *(undefined4 *)(param_1 + 0x34);
      uStack_23 = *(undefined4 *)(param_1 + 0x38);
      uStack_1f = *(undefined4 *)(param_1 + 0x3c);
      uStack_1b = *(undefined4 *)(param_1 + 0x40);
      uStack_17 = *(undefined4 *)(param_1 + 0x44);
      uStack_13 = *(undefined4 *)(param_1 + 0x48);
      uStack_f = *(undefined4 *)(param_1 + 0x4c);
      if ((uVar2 >> 0xd & 1) == 0) {
        iVar1 = prf(*(undefined4 *)(param_1 + 0x80),*(undefined2 *)(param_1 + 0x84),&uStack_58,0x4d,
                    param_1 + 0x50,0x30);
      }
      else {
        iVar1 = prf2(*(undefined4 *)(param_1 + 0x80),*(undefined2 *)(param_1 + 0x84),&uStack_58,0x4d
                     ,param_1 + 0x50,0x30,*(undefined4 *)(*(int *)(param_1 + 0xd10) + 4));
      }
      if (iVar1 < 0) {
        return iVar1;
      }
      if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
        free(*(void **)(param_1 + 0x80));
        *(undefined4 *)(param_1 + 0x80) = 0;
        *(undefined2 *)(param_1 + 0x84) = 0;
      }
    }
    iVar1 = FUN_00457028(param_1);
  }
  return iVar1;
}



undefined4 sslActivateReadCipher(int param_1)

{
  undefined uVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  char cVar5;
  short *psVar6;
  uint uVar7;
  code *pcVar8;
  
  psVar6 = *(short **)(param_1 + 0xd10);
  uVar4 = *(undefined4 *)(psVar6 + 0xe);
  *(undefined4 *)(param_1 + 0xd18) = *(undefined4 *)(psVar6 + 10);
  *(undefined4 *)(param_1 + 0xd20) = uVar4;
  *(undefined *)(param_1 + 0xd29) = *(undefined *)(psVar6 + 4);
  if ((*(ushort *)(param_1 + 0x1232) & 1) == 0) {
    cVar5 = *(char *)(psVar6 + 4);
LAB_00457c0c:
    *(char *)(param_1 + 0xd28) = cVar5;
    *(undefined *)(param_1 + 0xd2b) = *(undefined *)((int)psVar6 + 0xb);
    uVar1 = *(undefined *)(psVar6 + 5);
    *(undefined4 *)(param_1 + 0x248) = 0;
    *(undefined *)(param_1 + 0xd2a) = uVar1;
    *(undefined4 *)(param_1 + 0x24c) = 0;
    if (*psVar6 == 0) {
      return 0;
    }
  }
  else {
    cVar5 = '\n';
    if (*(char *)(psVar6 + 4) != '\0') goto LAB_00457c0c;
    *(undefined *)(param_1 + 0xd28) = 0;
    *(undefined *)(param_1 + 0xd2b) = *(undefined *)((int)psVar6 + 0xb);
    uVar1 = *(undefined *)(psVar6 + 5);
    *(undefined4 *)(param_1 + 0x248) = 0;
    *(undefined *)(param_1 + 0xd2a) = uVar1;
    *(undefined4 *)(param_1 + 0x24c) = 0;
    cVar5 = '\0';
    if (*psVar6 == 0) {
      return 0;
    }
  }
  if (*(void **)(param_1 + 0x16c) == (void *)0x0) {
    return 0xffffffff;
  }
  uVar7 = *(uint *)(param_1 + 0xd2c);
  if (cVar5 == '\0') {
    uVar3 = uVar7 | 0x200002;
    *(uint *)(param_1 + 0xd2c) = uVar3;
    if ((*(uint *)(psVar6 + 2) >> 6 & 1) == 0) {
      uVar7 = uVar7 | 0xa00002;
      goto LAB_00457c8c;
    }
    uVar7 = 0xff7fffff;
  }
  else {
    uVar7 = uVar7 & 0xffdfffff | 2;
    uVar3 = 0xff7fffff;
  }
  uVar7 = uVar7 & uVar3;
LAB_00457c8c:
  *(uint *)(param_1 + 0xd2c) = uVar7;
  memcpy((void *)(param_1 + 0x1a8),*(void **)(param_1 + 0x16c),(size_t)cVar5);
  memcpy((void *)(param_1 + 0x1f8),*(void **)(param_1 + 0x174),
         (size_t)*(undefined *)(*(int *)(param_1 + 0xd10) + 9));
  memcpy((void *)(param_1 + 0x230),*(void **)(param_1 + 0x21c),
         (size_t)*(undefined *)(*(int *)(param_1 + 0xd10) + 10));
  pcVar8 = *(code **)(*(int *)(param_1 + 0xd10) + 0xc);
  if (pcVar8 == (code *)0x0) {
    return 0;
  }
  iVar2 = (*pcVar8)(param_1 + 0x10,1,*(undefined *)(*(int *)(param_1 + 0xd10) + 9));
  if (-1 < iVar2) {
    return 0;
  }
  return 0xffffffff;
}



undefined4 sslActivateWriteCipher(int param_1)

{
  undefined uVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  short *psVar5;
  char cVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  undefined4 *puVar10;
  uint uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  code *pcVar14;
  
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdfc) == 0)) {
    *(undefined *)(param_1 + 0xed3) = *(undefined *)(param_1 + 0xd27);
    *(undefined *)(param_1 + 0xed2) = *(undefined *)(param_1 + 0xd26);
    *(undefined *)(param_1 + 0xed0) = *(undefined *)(param_1 + 0xd24);
    *(undefined4 *)(param_1 + 0xec8) = *(undefined4 *)(param_1 + 0xd14);
    *(undefined4 *)(param_1 + 0xecc) = *(undefined4 *)(param_1 + 0xd1c);
    *(undefined *)(param_1 + 0xed1) = *(undefined *)(param_1 + 0xd25);
    memcpy((void *)(param_1 + 0xee4),(void *)(param_1 + 0x178),
           (size_t)*(undefined *)(param_1 + 0xd24));
    puVar8 = (undefined4 *)(param_1 + 0x264);
    puVar2 = (undefined4 *)(param_1 + 0xf14);
    do {
      puVar10 = puVar2;
      puVar7 = puVar8;
      uVar13 = puVar7[1];
      uVar12 = puVar7[2];
      uVar9 = puVar7[3];
      puVar8 = puVar7 + 4;
      *puVar10 = *puVar7;
      puVar10[1] = uVar13;
      puVar10[2] = uVar12;
      puVar10[3] = uVar9;
      puVar2 = puVar10 + 4;
    } while (puVar8 != (undefined4 *)(param_1 + 0x564));
    uVar9 = *puVar8;
    puVar10[5] = puVar7[5];
    puVar10[4] = uVar9;
    memcpy((void *)(param_1 + 0xed4),(void *)(param_1 + 0x220),
           (size_t)*(undefined *)(*(int *)(param_1 + 0xd10) + 10));
  }
  psVar5 = *(short **)(param_1 + 0xd10);
  uVar9 = *(undefined4 *)(psVar5 + 0xc);
  *(undefined4 *)(param_1 + 0xd14) = *(undefined4 *)(psVar5 + 8);
  *(undefined4 *)(param_1 + 0xd1c) = uVar9;
  *(undefined *)(param_1 + 0xd25) = *(undefined *)(psVar5 + 4);
  if ((*(ushort *)(param_1 + 0x1232) & 1) == 0) {
    cVar6 = *(char *)(psVar5 + 4);
LAB_00457e08:
    *(char *)(param_1 + 0xd24) = cVar6;
    *(undefined *)(param_1 + 0xd27) = *(undefined *)((int)psVar5 + 0xb);
    uVar1 = *(undefined *)(psVar5 + 5);
    *(undefined4 *)(param_1 + 0x240) = 0;
    *(undefined *)(param_1 + 0xd26) = uVar1;
    *(undefined4 *)(param_1 + 0x244) = 0;
    if (*psVar5 == 0) {
      return 0;
    }
  }
  else {
    cVar6 = '\n';
    if (*(char *)(psVar5 + 4) != '\0') goto LAB_00457e08;
    *(undefined *)(param_1 + 0xd24) = 0;
    *(undefined *)(param_1 + 0xd27) = *(undefined *)((int)psVar5 + 0xb);
    uVar1 = *(undefined *)(psVar5 + 5);
    *(undefined4 *)(param_1 + 0x240) = 0;
    *(undefined *)(param_1 + 0xd26) = uVar1;
    *(undefined4 *)(param_1 + 0x244) = 0;
    cVar6 = '\0';
    if (*psVar5 == 0) {
      return 0;
    }
  }
  uVar11 = *(uint *)(param_1 + 0xd2c);
  if (cVar6 == '\0') {
    uVar4 = uVar11 | 0x100004;
    *(uint *)(param_1 + 0xd2c) = uVar4;
    if ((*(uint *)(psVar5 + 2) >> 6 & 1) == 0) {
      uVar11 = uVar11 | 0x500004;
      goto LAB_00457e78;
    }
    uVar11 = 0xffbfffff;
  }
  else {
    uVar11 = uVar11 & 0xffefffff | 4;
    uVar4 = 0xffbfffff;
  }
  uVar11 = uVar11 & uVar4;
LAB_00457e78:
  *(uint *)(param_1 + 0xd2c) = uVar11;
  memcpy((void *)(param_1 + 0x178),*(void **)(param_1 + 0x168),(size_t)cVar6);
  memcpy((void *)(param_1 + 0x1d8),*(void **)(param_1 + 0x170),
         (size_t)*(undefined *)(*(int *)(param_1 + 0xd10) + 9));
  memcpy((void *)(param_1 + 0x220),*(void **)(param_1 + 0x218),
         (size_t)*(undefined *)(*(int *)(param_1 + 0xd10) + 10));
  pcVar14 = *(code **)(*(int *)(param_1 + 0xd10) + 0xc);
  if (pcVar14 == (code *)0x0) {
    return 0;
  }
  iVar3 = (*pcVar14)(param_1 + 0x10,0,*(undefined *)(*(int *)(param_1 + 0xd10) + 9));
  if (-1 < iVar3) {
    return 0;
  }
  return 0xffffffff;
}



int csAesGcmInit(int param_1,int param_2,undefined param_3,undefined4 param_4)

{
  int iVar1;
  void *__s;
  undefined *puVar2;
  
  puVar2 = &_gp;
  __s = (void *)(param_1 + 0x55c);
  if (param_2 == 0) {
    memset((void *)(param_1 + 0x254),0,0x1fc);
    iVar1 = param_1 + 0x1c8;
    __s = (void *)(param_1 + 0x254);
  }
  else {
    memset(__s,0,0x1fc);
    iVar1 = param_1 + 0x1e8;
  }
  iVar1 = psAesInitGCM(__s,iVar1,param_3,param_4,puVar2);
  if (-1 < iVar1) {
    iVar1 = 0;
  }
  return iVar1;
}



uint csAesGcmEncrypt(int param_1,undefined4 param_2,int param_3,uint param_4)

{
  char cVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  undefined4 local_40;
  undefined local_3c;
  undefined uStack_3b;
  undefined2 uStack_3a;
  undefined2 uStack_38;
  undefined uStack_36;
  undefined uStack_35;
  undefined local_30;
  undefined uStack_2f;
  undefined2 uStack_2e;
  undefined2 uStack_2c;
  undefined uStack_2a;
  undefined uStack_29;
  undefined local_28;
  undefined local_27;
  undefined local_26;
  undefined local_25;
  undefined local_24;
  
  uVar2 = 0;
  if ((param_4 != 0) && (uVar2 = 0xfffffff7, 0x10 < param_4)) {
    local_40 = *(undefined4 *)(param_1 + 0x220);
    iVar5 = param_4 - 0x10;
    iVar6 = param_1 + 0x264;
    if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
      uVar4 = *(undefined4 *)(param_1 + 0x240);
      uVar3 = *(undefined4 *)(param_1 + 0x244);
      local_30 = (undefined)uVar4;
      uStack_2f = (undefined)((uint)uVar4 >> 8);
      uStack_2e = (undefined2)((uint)uVar4 >> 0x10);
      uStack_2c = (undefined2)uVar3;
      uStack_2a = (undefined)((uint)uVar3 >> 0x10);
      uStack_29 = (undefined)((uint)uVar3 >> 0x18);
      uStack_3a = uStack_2e;
      uStack_38 = uStack_2c;
    }
    else {
      local_30 = *(undefined *)(param_1 + 0xdc9);
      uStack_2f = *(undefined *)(param_1 + 0xdca);
      uStack_2a = *(undefined *)(param_1 + 0xdd5);
      uStack_29 = *(undefined *)(param_1 + 0xdd6);
      uStack_3a = (undefined2)*(undefined4 *)(param_1 + 0xdd1);
      uStack_38 = (undefined2)((uint)*(undefined4 *)(param_1 + 0xdd1) >> 0x10);
      uStack_2e = (undefined2)*(undefined4 *)(param_1 + 0xdd1);
      uStack_2c = (undefined2)((uint)*(undefined4 *)(param_1 + 0xdd1) >> 0x10);
    }
    local_27 = *(undefined *)(param_1 + 0xd3d);
    local_26 = *(undefined *)(param_1 + 0xd3e);
    local_28 = *(undefined *)(param_1 + 0xd40);
    local_25 = (undefined)((uint)iVar5 >> 8);
    local_24 = (undefined)iVar5;
    local_3c = local_30;
    uStack_3b = uStack_2f;
    uStack_36 = uStack_2a;
    uStack_35 = uStack_29;
    psAesReadyGCM(iVar6,&local_40,&local_30,0xd);
    psAesEncryptGCM(iVar6,param_2,param_3,iVar5);
    psAesGetGCMTag(iVar6,0x10,param_3 + iVar5);
    uVar2 = param_4;
    if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
      iVar5 = 7;
      iVar6 = param_1 + 7;
      do {
        iVar5 = iVar5 + -1;
        cVar1 = *(char *)(iVar6 + 0x240) + '\x01';
        *(char *)(iVar6 + 0x240) = cVar1;
        if (cVar1 != '\0') {
          return param_4;
        }
        iVar6 = iVar5 + param_1;
      } while (-1 < iVar5);
    }
  }
  return uVar2;
}



int csAesGcmDecrypt(int param_1,undefined4 *param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  char cVar5;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_30;
  undefined4 local_2c;
  undefined local_28;
  undefined local_27;
  undefined local_26;
  undefined local_25;
  undefined local_24;
  
  local_3c = *param_2;
  local_38 = param_2[1];
  local_40 = *(undefined4 *)(param_1 + 0x230);
  if ((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) {
    local_30 = *(undefined4 *)(param_1 + 0x248);
    local_2c = *(undefined4 *)(param_1 + 0x24c);
  }
  else {
    local_30 = *(undefined4 *)(param_1 + 4);
    local_2c = *(undefined4 *)(param_1 + 8);
  }
  local_28 = *(undefined *)(param_1 + 0xc);
  local_27 = *(undefined *)(param_1 + 0xd3d);
  local_26 = *(undefined *)(param_1 + 0xd3e);
  iVar3 = param_4 + -0x18;
  local_25 = (undefined)((uint)iVar3 >> 8);
  local_24 = (undefined)iVar3;
  psAesReadyGCM(param_1 + 0x56c,&local_40,&local_30,0xd);
  iVar1 = psAesDecryptGCM(param_1 + 0x56c,param_2 + 2,param_4 + -8,param_3,iVar3);
  iVar3 = -1;
  if (-1 < iVar1) {
    iVar2 = 7;
    iVar4 = param_1 + 7;
    do {
      iVar2 = iVar2 + -1;
      cVar5 = *(char *)(iVar4 + 0x248) + '\x01';
      *(char *)(iVar4 + 0x248) = cVar5;
      if (cVar5 != '\0') {
        return iVar1;
      }
      iVar4 = iVar2 + param_1;
      iVar3 = iVar1;
    } while (-1 < iVar2);
  }
  return iVar3;
}



int csAesInit(int param_1,int param_2,undefined param_3)

{
  int iVar1;
  int iVar2;
  void *__s;
  undefined4 uVar3;
  
  __s = (void *)(param_1 + 0x55c);
  if (param_2 == 0) {
    memset((void *)(param_1 + 0x254),0,0x114);
    uVar3 = 1;
    iVar2 = param_1 + 0x1c8;
    iVar1 = param_1 + 0x210;
    __s = (void *)(param_1 + 0x254);
  }
  else {
    memset(__s,0,0x114);
    iVar2 = param_1 + 0x1e8;
    iVar1 = param_1 + 0x220;
    uVar3 = 2;
  }
  iVar1 = psAesInitCBC(__s,iVar1,iVar2,param_3,uVar3);
  if (-1 < iVar1) {
    iVar1 = 0;
  }
  return iVar1;
}



undefined4 csAesEncrypt(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  psAesEncryptCBC(param_1 + 0x264);
  return param_4;
}



undefined4 csAesDecrypt(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  psAesDecryptCBC(param_1 + 0x56c);
  return param_4;
}



size_t FUN_00458510(undefined4 param_1,void *param_2,void *param_3,size_t param_4)

{
  if (param_3 != param_2) {
    memcpy(param_3,param_2,param_4);
  }
  return param_4;
}



size_t FUN_00458564(undefined4 param_1,void *param_2,void *param_3,size_t param_4)

{
  if (param_3 != param_2) {
    memmove(param_3,param_2,param_4);
  }
  return param_4;
}



uint FUN_004585c8(int param_1,undefined param_2,undefined4 param_3,undefined4 param_4,void *param_5)

{
  char cVar1;
  uint uVar2;
  undefined auStack_50 [64];
  
  uVar2 = 0xfffffffa;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) != 0) {
    cVar1 = *(char *)(param_1 + 0xd25);
    if ((cVar1 == ' ') || (cVar1 == '0')) {
      tlsHMACSha2(param_1,1,param_2,param_3,param_4,auStack_50,cVar1);
    }
    else {
      tlsHMACSha1();
    }
    memcpy(param_5,auStack_50,(size_t)*(undefined *)(param_1 + 0xd24));
    uVar2 = (uint)*(byte *)(param_1 + 0xd24);
  }
  return uVar2;
}



undefined4 haveKeyMaterial(int param_1,int param_2,short param_3)

{
  int iVar1;
  
  if ((*(int *)(param_1 + 0xcd4) == 0) || (param_3 != 0)) {
    if ((param_2 - 1U < 2) ||
       ((((param_2 == 7 || (param_2 == 9)) || (param_2 == 6)) || (param_2 == 8)))) {
      if ((*(uint *)(param_1 + 0xd2c) & 1) == 0) {
        if (*(int *)(param_1 + 0xc48) == 0) {
          return 0xffffffff;
        }
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
      }
      else {
        if (*(int *)(param_1 + 0xc48) == 0) {
          return 0xffffffff;
        }
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74);
      }
      if (iVar1 == 0) {
        return 0xffffffff;
      }
    }
    if (param_2 == 1) {
      if ((*(uint *)(param_1 + 0xd2c) & 1) == 0) {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
        while( true ) {
          if (iVar1 == 0) {
            return 0xffffffff;
          }
          if (*(int *)(iVar1 + 0x1bc) == 0x285) break;
          iVar1 = *(int *)(iVar1 + 0x31c);
        }
      }
      else {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74);
        if (iVar1 == 0) {
          return 0xffffffff;
        }
        if (*(int *)(iVar1 + 0x1bc) != 0x285) {
          return 0xffffffff;
        }
        iVar1 = *(int *)(iVar1 + 8);
        if ((((iVar1 != 0x689) && (iVar1 != 0x68f)) &&
            ((iVar1 != 0x690 && ((iVar1 != 0x691 && (iVar1 != 0x288)))))) &&
           ((iVar1 != 0x686 && (iVar1 != 0x68e)))) {
          return 0xffffffff;
        }
      }
    }
    if (param_2 == 2) {
      if ((*(uint *)(param_1 + 0xd2c) & 1) == 0) {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
        while( true ) {
          if (iVar1 == 0) {
            return 0xffffffff;
          }
          if (*(int *)(iVar1 + 0x1bc) == 0x285) break;
          iVar1 = *(int *)(iVar1 + 0x31c);
        }
      }
      else {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74);
        if (iVar1 == 0) {
          return 0xffffffff;
        }
        if (*(int *)(iVar1 + 0x1bc) != 0x285) {
          return 0xffffffff;
        }
      }
    }
    if ((param_2 == 4) && ((*(uint *)(param_1 + 0xd2c) & 1) == 0)) {
      if (*(int *)(param_1 + 0xc48) == 0) {
        return 0xffffffff;
      }
      if (*(int *)(*(int *)(param_1 + 0xc48) + 0x7c) == 0) {
        return 0xffffffff;
      }
    }
    if (param_2 == 7) {
      if ((*(uint *)(param_1 + 0xd2c) & 1) == 0) {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
        while( true ) {
          if (iVar1 == 0) {
            return 0xffffffff;
          }
          if (*(int *)(iVar1 + 0x1bc) == 0x285) break;
          iVar1 = *(int *)(iVar1 + 0x31c);
        }
      }
      else {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74);
        if (iVar1 == 0) {
          return 0xffffffff;
        }
        if (*(int *)(iVar1 + 0x1bc) != 0x285) {
          return 0xffffffff;
        }
        iVar1 = *(int *)(iVar1 + 8);
        if ((((iVar1 != 0x689) && (iVar1 != 0x68f)) && (iVar1 != 0x690)) &&
           (((iVar1 != 0x691 && (iVar1 != 0x288)) && ((iVar1 != 0x686 && (iVar1 != 0x68e)))))) {
          return 0xffffffff;
        }
      }
    }
    if (param_2 == 9) {
      if ((*(uint *)(param_1 + 0xd2c) & 1) == 0) {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
        while( true ) {
          if (iVar1 == 0) {
            return 0xffffffff;
          }
          if (*(int *)(iVar1 + 0x1bc) == 0x285) break;
          iVar1 = *(int *)(iVar1 + 0x31c);
        }
      }
      else {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74);
        if (iVar1 == 0) {
          return 0xffffffff;
        }
        if (*(int *)(iVar1 + 0x1bc) != 0x206) {
          return 0xffffffff;
        }
        iVar1 = *(int *)(iVar1 + 8);
        if (((iVar1 != 0x689) && (iVar1 != 0x68f)) &&
           (((iVar1 != 0x690 && (((iVar1 != 0x691 && (iVar1 != 0x288)) && (iVar1 != 0x686)))) &&
            (iVar1 != 0x68e)))) {
          return 0xffffffff;
        }
      }
    }
    if ((param_2 == 6) || (param_2 == 8)) {
      if ((*(uint *)(param_1 + 0xd2c) & 1) == 0) {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x78);
        while( true ) {
          if (iVar1 == 0) {
            return 0xffffffff;
          }
          if (*(int *)(iVar1 + 0x1bc) == 0x206) break;
          iVar1 = *(int *)(iVar1 + 0x31c);
        }
      }
      else {
        iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74);
        if (iVar1 == 0) {
          return 0xffffffff;
        }
        if (*(int *)(iVar1 + 0x1bc) != 0x206) {
          return 0xffffffff;
        }
        iVar1 = *(int *)(iVar1 + 8);
        if (((iVar1 != 0x208) && (iVar1 != 0x20b)) &&
           ((iVar1 != 0x20c && ((iVar1 != 0x20d && (iVar1 != 0x20e)))))) {
          return 0xffffffff;
        }
      }
    }
    if ((param_2 == 5) &&
       ((*(int *)(param_1 + 0xc48) == 0 || (*(int *)(*(int *)(param_1 + 0xc48) + 0x7c) == 0)))) {
      return 0xffffffff;
    }
  }
  return 0;
}



undefined2 * sslGetCipherSpec(int param_1,short param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  
  uVar2 = 0;
  do {
    if ((&DAT_004d7428)[uVar2 * 0x10] == param_2) {
      if (((&DAT_004d742c)[uVar2 * 8] & 0x6000000) != 0) {
        return (undefined2 *)0x0;
      }
      if (((&DAT_004d7888)[uVar2 >> 5] & 1 << (uVar2 & 0x1f)) != 0) {
        return (undefined2 *)0x0;
      }
      if (param_2 != 0) {
        uVar1 = 0;
        iVar3 = 0;
        do {
          uVar1 = uVar1 + 1 & 0xff;
          if (*(short *)(iVar3 + param_1 + 0xcc4) == param_2) {
            return (undefined2 *)0x0;
          }
          iVar3 = uVar1 << 1;
        } while (uVar1 < 8);
      }
      if ((*(char *)(param_1 + 0xd3d) == -2) && (*(char *)(param_1 + 0xd3e) != -3)) {
        if (((uint)(&DAT_004d742c)[uVar2 * 8] >> 10 & 1) != 0) {
          return (undefined2 *)0x0;
        }
        if (((uint)(&DAT_004d742c)[uVar2 * 8] >> 9 & 1) != 0) {
          return (undefined2 *)0x0;
        }
      }
      uVar1 = *(uint *)(param_1 + 0xd2c);
      if ((uVar1 >> 0xe & 1) == 0) {
        if (*(byte *)(param_1 + 0xd3e) < 3) {
          if (((uint)(&DAT_004d742c)[uVar2 * 8] >> 10 & 1) != 0) {
            return (undefined2 *)0x0;
          }
          if (((uint)(&DAT_004d742c)[uVar2 * 8] >> 9 & 1) != 0) {
            return (undefined2 *)0x0;
          }
        }
        if ((*(byte *)(param_1 + 0xd3e) == 3) &&
           (((uint)(&DAT_004d742c)[uVar2 * 8] >> 0xe & 1) != 0)) {
          return (undefined2 *)0x0;
        }
      }
      if ((uVar1 >> 0x18 & 1) != 0) {
        if ((((uint)(&DAT_004d742c)[uVar2 * 8] >> 0xb & 1) == 0) &&
           (((uint)(&DAT_004d742c)[uVar2 * 8] >> 6 & 1) == 0)) {
          return (undefined2 *)0x0;
        }
        if (7 < (ushort)(&DAT_004d742a)[uVar2 * 0x10]) {
          return (undefined2 *)0x0;
        }
        if ((1 << ((ushort)(&DAT_004d742a)[uVar2 * 0x10] & 0x1f) & 0xc4U) == 0) {
          return (undefined2 *)0x0;
        }
      }
      if ((*(int *)(param_1 + 0xc48) == 0) || (((uVar1 ^ 1) & 1) != 0)) {
        return &DAT_004d7428 + uVar2 * 0x10;
      }
      iVar3 = haveKeyMaterial(param_1,(&DAT_004d742a)[uVar2 * 0x10],0);
      if (iVar3 == 0) {
        return &DAT_004d7428 + uVar2 * 0x10;
      }
    }
    iVar3 = uVar2 * 0x10;
    uVar2 = uVar2 + 1 & 0xff;
    if ((&DAT_004d7428)[iVar3] == 0) {
      return (undefined2 *)0x0;
    }
  } while( true );
}



undefined4 chooseCipherSuite(int param_1,byte *param_2,int param_3)

{
  undefined2 uVar1;
  ushort uVar2;
  short sVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  size_t sVar7;
  int iVar8;
  char *__s;
  byte *pbVar9;
  short local_30;
  undefined2 local_2e;
  undefined2 local_2c;
  short local_2a;
  undefined4 local_28;
  
  pbVar9 = param_2 + param_3;
  iVar6 = 0;
  if (pbVar9 <= param_2) {
    return 0xfffffff6;
  }
LAB_00458fa8:
  if (*(byte *)(param_1 + 2) < 3) {
    sVar3 = (ushort)param_2[1] * 0x100 + (ushort)param_2[2];
    param_2 = param_2 + 3;
  }
  else {
    sVar3 = (ushort)*param_2 * 0x100 + (ushort)param_2[1];
    param_2 = param_2 + 2;
  }
  iVar4 = sslGetCipherSpec(param_1,sVar3);
  iVar5 = iVar6;
  if (iVar4 != 0) {
    iVar5 = *(int *)(param_1 + 0xc48);
    if (iVar5 != 0) {
      __s = *(char **)(param_1 + 0xcc0);
      if (__s != (char *)0x0) {
        sVar7 = strlen(__s);
        iVar5 = matrixServerSetKeysSNI(param_1,__s,sVar7);
        if (iVar5 < 0) {
          *(undefined4 *)(param_1 + 0xd30) = 0x70;
          return 0xfffffff4;
        }
        iVar8 = haveKeyMaterial(param_1,*(undefined2 *)(iVar4 + 2),1);
        iVar5 = iVar6;
        if (iVar8 < 0) goto LAB_004591f8;
        iVar5 = *(int *)(param_1 + 0xc48);
      }
LAB_004590b0:
      sVar3 = *(short *)(iVar4 + 2);
      if (((2 < (ushort)(sVar3 - 3U)) && ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) != 0)) &&
         (iVar6 = *(int *)(iVar5 + 0x74), iVar6 != 0)) {
        do {
          if (((sVar3 == 2) || (sVar3 == 7)) || (sVar3 == 6)) {
            if (((*(int *)(iVar6 + 0x1bc) == 0x285) &&
                (uVar2 = *(ushort *)(param_1 + 0xd4c), (uVar2 >> 2 & 1) == 0)) &&
               (((uVar2 >> 5 & 1) == 0 && (((uVar2 >> 6 & 1) == 0 && ((uVar2 >> 4 & 1) == 0)))))) {
              iVar5 = 0;
              goto LAB_004591f8;
            }
            if (*(int *)(iVar6 + 0x1bc) != 0x206) goto LAB_004591a0;
            uVar2 = *(ushort *)(param_1 + 0xd4c);
            if ((((uVar2 >> 10 & 1) != 0) || ((uVar2 >> 0xd & 1) != 0)) || ((uVar2 >> 0xe & 1) != 0)
               ) goto LAB_004591a0;
            if ((uVar2 >> 0xc & 1) == 0) goto LAB_004591f0;
            iVar8 = *(int *)(iVar6 + 8);
            if (iVar8 == 0x20d) goto LAB_0045939c;
LAB_004591b0:
            if (iVar8 < 0x20e) {
              if (iVar8 == 0x208) {
                uVar2 = *(ushort *)(param_1 + 0xd4c) >> 10;
              }
              else {
                if (iVar8 != 0x20c) goto LAB_004591f0;
                uVar2 = *(ushort *)(param_1 + 0xd4c) >> 0xc;
              }
            }
            else if (iVar8 == 0x68f) {
              uVar2 = *(ushort *)(param_1 + 0xd4c) >> 4;
            }
            else if (iVar8 < 0x690) {
              if (iVar8 != 0x689) goto LAB_004591f0;
              uVar2 = *(ushort *)(param_1 + 0xd4c) >> 2;
            }
            else {
              if (iVar8 != 0x690) goto LAB_004591f0;
              uVar2 = *(ushort *)(param_1 + 0xd4c) >> 5;
            }
          }
          else {
LAB_004591a0:
            iVar8 = *(int *)(iVar6 + 8);
            if (iVar8 != 0x20d) goto LAB_004591b0;
LAB_0045939c:
            uVar2 = *(ushort *)(param_1 + 0xd4c) >> 0xd;
          }
          if (((uVar2 & 1) == 0) ||
             (((ushort)(sVar3 - 8U) < 2 &&
              (((*(uint *)(param_1 + 0xd48) & 0xffffff) == 0 ||
               (iVar8 = psTestUserEcID(*(undefined2 *)(*(int *)(iVar6 + 0x5c) + 2)), iVar8 < 0))))))
          goto LAB_004591f0;
          iVar6 = *(int *)(iVar6 + 0x31c);
          if (iVar6 == 0) break;
          sVar3 = *(short *)(iVar4 + 2);
        } while( true );
      }
      *(int *)(param_1 + 0xc48) = iVar5;
LAB_0045940c:
      *(int *)(param_1 + 0xd10) = iVar4;
      return 0;
    }
    local_2a = 0;
    switch(*(undefined2 *)(iVar4 + 2)) {
    default:
      local_30 = 0;
      break;
    case 1:
      local_30 = 5;
      break;
    case 2:
      local_30 = 5;
      local_2a = 1;
      break;
    case 3:
    case 4:
      local_30 = 0;
      local_2a = 1;
      break;
    case 6:
    case 8:
      local_30 = 6;
      break;
    case 7:
    case 9:
      local_30 = 5;
    }
    if ((local_30 == 0) && (local_2a == 0)) goto LAB_0045940c;
    local_2e = *(undefined2 *)(param_1 + 0xd4c);
    local_28 = *(undefined4 *)(param_1 + 0xcc0);
    local_2c = (undefined2)*(undefined4 *)(param_1 + 0xd48);
    iVar5 = (**(code **)(param_1 + 0x254))(param_1,&local_30);
    if (iVar5 != 0) {
      uVar1 = *(undefined2 *)(iVar4 + 2);
      *(int *)(param_1 + 0xc48) = iVar5;
      iVar6 = haveKeyMaterial(param_1,uVar1,1);
      if (-1 < iVar6) {
        *(undefined4 *)(param_1 + 0xc48) = 0;
        goto LAB_004590b0;
      }
      *(undefined4 *)(param_1 + 0xc48) = 0;
    }
  }
  goto LAB_004591f8;
LAB_004591f0:
  iVar5 = 0;
LAB_004591f8:
  iVar6 = iVar5;
  if (pbVar9 <= param_2) {
    if (iVar5 == 0) {
      return 0xfffffff6;
    }
    _psTraceStr("psAssert %s","cipherSuite.c");
    _psTraceInt(&DAT_0049016c,0x9d9);
    _psError("givenKey == NULL");
    return 0xfffffff6;
  }
  goto LAB_00458fa8;
}



undefined4 eccSuitesSupported(undefined4 param_1,short *param_2,uint param_3)

{
  short sVar1;
  int iVar2;
  
  param_3 = param_3 & 0xff;
  iVar2 = 0;
  if (param_3 == 0) {
    iVar2 = sslGetCipherSpec(param_1,0xc00a);
    if (((((((iVar2 != 0) || (iVar2 = sslGetCipherSpec(param_1,0xc009), iVar2 != 0)) ||
           (iVar2 = sslGetCipherSpec(param_1,0xc014), iVar2 != 0)) ||
          ((iVar2 = sslGetCipherSpec(param_1,0xc013), iVar2 != 0 ||
           (iVar2 = sslGetCipherSpec(param_1,0xc012), iVar2 != 0)))) ||
         (iVar2 = sslGetCipherSpec(param_1,0xc004), iVar2 != 0)) ||
        (((((iVar2 = sslGetCipherSpec(param_1,0xc005), iVar2 != 0 ||
            (iVar2 = sslGetCipherSpec(param_1,0xc00f), iVar2 != 0)) ||
           ((iVar2 = sslGetCipherSpec(param_1,0xc023), iVar2 != 0 ||
            (((iVar2 = sslGetCipherSpec(param_1,0xc024), iVar2 != 0 ||
              (iVar2 = sslGetCipherSpec(param_1,0xc025), iVar2 != 0)) ||
             (iVar2 = sslGetCipherSpec(param_1,0xc026), iVar2 != 0)))))) ||
          (((iVar2 = sslGetCipherSpec(param_1,0xc02d), iVar2 != 0 ||
            (iVar2 = sslGetCipherSpec(param_1,0xc02e), iVar2 != 0)) ||
           ((iVar2 = sslGetCipherSpec(param_1,0xc02b), iVar2 != 0 ||
            ((((iVar2 = sslGetCipherSpec(param_1,0xc02c), iVar2 != 0 ||
               (iVar2 = sslGetCipherSpec(param_1,0xc027), iVar2 != 0)) ||
              ((iVar2 = sslGetCipherSpec(param_1,0xc028), iVar2 != 0 ||
               (((iVar2 = sslGetCipherSpec(param_1,0xc02f), iVar2 != 0 ||
                 (iVar2 = sslGetCipherSpec(param_1,0xc030), iVar2 != 0)) ||
                (iVar2 = sslGetCipherSpec(param_1,0xc029), iVar2 != 0)))))) ||
             ((iVar2 = sslGetCipherSpec(param_1,0xc02a), iVar2 != 0 ||
              (iVar2 = sslGetCipherSpec(param_1,0xc031), iVar2 != 0)))))))))) ||
         (iVar2 = sslGetCipherSpec(param_1,0xc032), iVar2 != 0)))) ||
       (((iVar2 = sslGetCipherSpec(param_1,0xcca9), iVar2 != 0 ||
         (iVar2 = sslGetCipherSpec(param_1,0xcca8), iVar2 != 0)) ||
        (iVar2 = sslGetCipherSpec(param_1,0xc00e), iVar2 != 0)))) {
      return 1;
    }
  }
  else if (param_3 != 0) {
    do {
      sVar1 = *param_2;
      if ((ushort)(sVar1 + 0x3ff7U) < 2) {
        return 1;
      }
      if (sVar1 == -0x3fec) {
        return 1;
      }
      if (sVar1 == -0x3fed) {
        return 1;
      }
      if (sVar1 == -0x3fee) {
        return 1;
      }
      if (sVar1 == -0x3ffc) {
        return 1;
      }
      if (sVar1 == -0x3ffb) {
        return 1;
      }
      if (sVar1 == -0x3ff1) {
        return 1;
      }
      if (sVar1 == -0x3fdd) {
        return 1;
      }
      if (sVar1 == -0x3fdc) {
        return 1;
      }
      if (sVar1 == -0x3fdb) {
        return 1;
      }
      if (sVar1 == -0x3fda) {
        return 1;
      }
      if (sVar1 == -0x3fd3) {
        return 1;
      }
      if (sVar1 == -0x3fd2) {
        return 1;
      }
      if (sVar1 == -0x3fd5) {
        return 1;
      }
      if (sVar1 == -0x3fd4) {
        return 1;
      }
      if (sVar1 == -0x3fd9) {
        return 1;
      }
      if (sVar1 == -0x3fd8) {
        return 1;
      }
      if (sVar1 == -0x3fd1) {
        return 1;
      }
      if (sVar1 == -0x3fd0) {
        return 1;
      }
      if (sVar1 == -0x3fd7) {
        return 1;
      }
      if (sVar1 == -0x3fd6) {
        return 1;
      }
      if (sVar1 == -0x3fcf) {
        return 1;
      }
      if (sVar1 == -0x3fce) {
        return 1;
      }
      if (sVar1 == -0x3357) {
        return 1;
      }
      if (sVar1 == -0x3358) {
        return 1;
      }
      iVar2 = iVar2 + 1;
      if (sVar1 == -0x3ff2) {
        return 1;
      }
      param_2 = param_2 + 1;
    } while (iVar2 < (int)param_3);
  }
  return 0;
}



undefined4 csCheckCertAgainstCipherSuite(int param_1,int param_2)

{
  if (param_1 == 1) {
    if (param_2 - 1U < 2) {
      return 1;
    }
    if (param_2 == 7) {
      return 1;
    }
  }
  if ((param_1 == 3) && (((param_2 == 6 || (param_2 == 8)) || (param_2 == 9)))) {
    return 1;
  }
  return 0;
}



int sslGetCipherSpecList(int param_1,undefined *param_2,int param_3)

{
  undefined2 uVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  undefined *puVar6;
  
  iVar3 = -1;
  if (3 < param_3) {
    puVar6 = param_2 + 2;
    iVar3 = 0;
    uVar5 = 0;
    if (DAT_004d7428 != 0) {
      do {
        if ((int)(param_2 + (param_3 - (int)puVar6)) < 2) {
          return -8;
        }
        iVar4 = uVar5 * 0x20;
        if (*(char *)(param_1 + 0xd3d) == -2) {
          if (*(char *)(param_1 + 0xd3e) == -3) {
            iVar4 = uVar5 << 5;
            goto LAB_00459a74;
          }
          if (((uint)(&DAT_004d742c)[uVar5 * 8] >> 10 & 1) == 0) {
            if (((uint)(&DAT_004d742c)[uVar5 * 8] >> 9 & 1) == 0) goto LAB_00459a74;
            iVar3 = iVar3 + 2;
            goto LAB_00459ab8;
          }
LAB_00459ab4:
          iVar3 = iVar3 + 2;
        }
        else {
LAB_00459a74:
          if ((((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) &&
              (*(char *)(param_1 + 0xd3e) != '\x03')) &&
             (((*(uint *)((int)&DAT_004d742c + iVar4) >> 10 & 1) != 0 ||
              ((*(uint *)((int)&DAT_004d742c + iVar4) >> 9 & 1) != 0)))) goto LAB_00459ab4;
          iVar2 = haveKeyMaterial(param_1,*(undefined2 *)((int)&DAT_004d742a + iVar4),0);
          if (iVar2 != 0) goto LAB_00459ab4;
          uVar1 = *(undefined2 *)((int)&DAT_004d7428 + iVar4);
          *puVar6 = (char)((ushort)uVar1 >> 8);
          puVar6[1] = (char)uVar1;
          puVar6 = puVar6 + 2;
        }
LAB_00459ab8:
        uVar5 = uVar5 + 1 & 0xffff;
      } while ((&DAT_004d7428)[uVar5 * 0x10] != 0);
    }
    uVar5 = uVar5 * 2 - iVar3 & 0xffff;
    if ((*(uint *)(param_1 + 0x1230) >> 10 & 1) != 0) {
      if ((int)(param_2 + (param_3 - (int)puVar6)) < 2) {
        return -8;
      }
      *puVar6 = 0x56;
      puVar6[1] = 0;
      uVar5 = uVar5 + 2 & 0xffff;
    }
    *param_2 = (char)(uVar5 >> 8);
    param_2[1] = (char)uVar5;
    iVar3 = uVar5 + 2;
  }
  return iVar3;
}



int sslGetCipherSpecListLen(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 0;
  iVar2 = 0;
  if (DAT_004d7428 != 0) {
    iVar1 = 0;
    do {
      if ((((*(char *)(param_1 + 0xd3d) == -2) && (*(char *)(param_1 + 0xd3e) != -3)) &&
          (((*(uint *)((int)&DAT_004d742c + iVar1) >> 10 & 1) != 0 ||
           ((*(uint *)((int)&DAT_004d742c + iVar1) >> 9 & 1) != 0)))) ||
         ((((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0 && (*(char *)(param_1 + 0xd3e) != '\x03'))
          && (((*(uint *)((int)&DAT_004d742c + iVar1) >> 10 & 1) != 0 ||
              ((*(uint *)((int)&DAT_004d742c + iVar1) >> 9 & 1) != 0)))))) {
        iVar3 = iVar3 + 2;
      }
      else {
        iVar1 = haveKeyMaterial(param_1,*(undefined2 *)((int)&DAT_004d742a + iVar1),0);
        if (iVar1 != 0) {
          iVar3 = iVar3 + 2;
        }
      }
      iVar2 = iVar2 + 1;
      iVar1 = iVar2 * 0x20;
    } while ((&DAT_004d7428)[iVar2 * 0x10] != 0);
  }
  return (iVar2 * 2 - iVar3) + 2;
}



void matrixSslSetKexFlags(int param_1)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = *(int *)(param_1 + 0xd10);
  if (*(short *)(iVar1 + 2) == 2) {
    *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) | 0x28000;
  }
  if (*(short *)(iVar1 + 2) == 4) {
    uVar2 = *(uint *)(param_1 + 0xd2c);
    if (((uVar2 & 1) == 0) || ((uVar2 & 0x80) == 0)) {
      *(uint *)(param_1 + 0xd2c) = uVar2 | 0x60100;
    }
    else {
      *(uint *)(param_1 + 0xd2c) = uVar2 & 0xffffff7f | 0x60100;
    }
  }
  if (*(short *)(iVar1 + 2) == 7) {
    *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) | 0xa8000;
  }
  if (*(short *)(iVar1 + 2) == 6) {
    *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) | 0xb0000;
  }
  if (*(short *)(iVar1 + 2) == 8) {
    *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) | 0x80000;
  }
  if (*(short *)(iVar1 + 2) == 9) {
    *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) | 0x80000;
  }
  if (*(short *)(iVar1 + 2) != 5) {
    return;
  }
  uVar2 = *(uint *)(param_1 + 0xd2c);
  if ((uVar2 & 1) == 0) {
    *(uint *)(param_1 + 0xd2c) = uVar2 | 0x40000;
    return;
  }
  if ((uVar2 & 0x80) != 0) {
    *(uint *)(param_1 + 0xd2c) = uVar2 & 0xffffff7f | 0x40000;
    return;
  }
  *(uint *)(param_1 + 0xd2c) = uVar2 | 0x40000;
  return;
}



undefined4 dtlsGenCookieSecret(void)

{
  undefined4 uVar1;
  int iVar2;
  
  iVar2 = 0;
  do {
    uVar1 = psGetPrngLocked(&DAT_004d78a8,0x20,0);
    iVar2 = iVar2 + 1;
    if ((byte)(DAT_004d78a8 | DAT_004d78a9 | DAT_004d78aa | DAT_004d78ab) != 0) {
      return uVar1;
    }
  } while (iVar2 < 4);
  return 0xffffffff;
}



int dtlsComputeCookie(int param_1,undefined4 param_2,undefined4 param_3)

{
  int iVar1;
  undefined auStack_58 [32];
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined auStack_18 [8];
  
  iVar1 = -1;
  if ((byte)(DAT_004d78a8 | DAT_004d78a9 | DAT_004d78aa | DAT_004d78ab) != 0) {
    iVar1 = psHmacSha256(&DAT_004d78a8,0x20,param_2,param_3,&local_38,auStack_58,auStack_18);
    if (-1 < iVar1) {
      *(undefined4 *)(param_1 + 0xd4e) = local_38;
      *(undefined4 *)(param_1 + 0xd52) = local_34;
      *(undefined4 *)(param_1 + 0xd56) = local_30;
      *(undefined4 *)(param_1 + 0xd5a) = local_2c;
    }
    memset_s(&local_38,0x10,0,0x10);
  }
  return iVar1;
}



int matrixDtlsSetPmtu(int param_1)

{
  DAT_004dad38 = param_1;
  if (param_1 < 0) {
    DAT_004dad38 = 0x5dc;
  }
  if (DAT_004dad38 < 0x100) {
    DAT_004dad38 = 0x100;
  }
  return DAT_004dad38;
}



undefined4 matrixDtlsGetPmtu(void)

{
  return DAT_004dad38;
}



int FUN_0045a144(int param_1,void *param_2,size_t param_3,uint param_4,int param_5)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  size_t __n;
  uint uVar9;
  uint uVar10;
  size_t sVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  uint local_34;
  
  iVar2 = param_5;
  uVar9 = *(uint *)(param_1 + 0xd2c);
  iVar6 = *(int *)(param_1 + 0x1234) + *(int *)(param_1 + 0x1238);
  iVar14 = 0;
  local_34 = 0;
  iVar12 = 0;
  iVar13 = 0;
  if (((uVar9 >> 2 & 1) != 0) && (1 < *(byte *)(param_1 + 0xd27))) {
    iVar14 = (uint)*(byte *)(param_1 + 0xd24) + (uint)*(byte *)(param_1 + 0xd27) * 2;
  }
  if ((uVar9 >> 0x14 & 1) != 0) {
    iVar7 = 8;
    if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0) {
      iVar7 = 0x10;
    }
    iVar14 = iVar14 + iVar7;
    if ((uVar9 >> 0x16 & 1) != 0) {
      iVar14 = iVar14 + 8;
    }
  }
  if (0 < (int)param_3) {
    iVar7 = *(int *)(param_1 + 0xdf8);
    __n = (iVar7 - iVar6) - iVar14;
    sVar11 = param_3;
    if ((int)param_3 < (int)__n) goto LAB_0045a488;
    do {
      iVar7 = iVar7 - *(int *)(param_1 + 0x1234);
      while( true ) {
        if ((uVar9 >> 2 & 1) != 0) {
          uVar8 = (uint)*(byte *)(param_1 + 0xd27);
          if (1 < uVar8) {
            uVar10 = *(int *)(param_1 + 0x1238) + __n + (uint)*(byte *)(param_1 + 0xd24) + uVar8;
            local_34 = uVar8 - (uVar8 - 1 & uVar10) & 0xff;
            iVar7 = uVar10 + local_34;
          }
        }
        if ((uVar9 >> 0x14 & 1) != 0) {
          iVar7 = *(int *)(param_1 + 0x1238) + __n + iVar14;
        }
        iVar7 = psWriteRecordInfo(param_1,0x16,iVar7,param_5,param_4);
        iVar7 = iVar7 + param_5;
        param_5 = iVar7;
        if (((*(uint *)(param_1 + 0xd2c) >> 2 & 1) != 0) && (1 < *(byte *)(param_1 + 0xd27))) {
          psGetPrngLocked(iVar7,*(byte *)(param_1 + 0xd27),*(undefined4 *)(param_1 + 0x1250));
          param_5 = (uint)*(byte *)(param_1 + 0xd27) + iVar7;
        }
        iVar3 = psWriteHandshakeHeader
                          (param_1,param_4 & 0xff,param_3,*(undefined4 *)(param_1 + 0xdec),iVar13,
                           __n,param_5);
        memcpy((void *)(iVar3 + param_5),param_2,__n);
        param_5 = (int)(void *)(iVar3 + param_5) + __n;
        piVar4 = (int *)malloc(0x24);
        param_2 = (void *)((int)param_2 + __n);
        iVar13 = iVar13 + __n;
        sVar11 = sVar11 - __n;
        if (piVar4 != (int *)0x0) {
          iVar3 = *(int *)(param_1 + 0xc7c);
          *piVar4 = 0;
          piVar4[1] = 0;
          piVar4[2] = 0;
          piVar4[3] = 0;
          piVar4[4] = 0;
          piVar4[5] = 0;
          piVar4[6] = 0;
          piVar4[7] = 0;
          piVar4[8] = 0;
          if (iVar3 == 0) {
            bVar1 = *(byte *)(param_1 + 0xd24);
            iVar3 = *(int *)(param_1 + 0xc84);
            *piVar4 = iVar7;
            piVar4[2] = __n;
            piVar4[3] = 0x16;
            piVar4[7] = iVar12 + 1;
            piVar4[5] = local_34;
            *(int **)(param_1 + 0xc7c) = piVar4;
            piVar4[1] = iVar3;
            piVar4[4] = param_3;
            piVar4[6] = param_4;
          }
          else {
            do {
              iVar5 = iVar3;
              iVar3 = *(int *)(iVar5 + 0x20);
            } while (iVar3 != 0);
            *(int **)(iVar5 + 0x20) = piVar4;
            bVar1 = *(byte *)(param_1 + 0xd24);
            iVar3 = *(int *)(param_1 + 0xc84);
            *piVar4 = iVar7;
            piVar4[2] = __n;
            piVar4[3] = 0x16;
            piVar4[7] = iVar12 + 1;
            piVar4[5] = local_34;
            piVar4[1] = iVar3;
            piVar4[4] = param_3;
            piVar4[6] = param_4;
          }
          iVar7 = param_5 + (uint)bVar1 + local_34;
          param_5 = iVar7;
          if (param_4 == 0x14) {
            uVar9 = *(uint *)(*(int *)(param_1 + 0xd10) + 4);
            if (((uVar9 & 0x1840) != 0) && (param_5 = iVar7 + 8, (uVar9 >> 0xd & 1) == 0)) {
              param_5 = iVar7 + 0x10;
            }
          }
          else if (((*(uint *)(param_1 + 0xd2c) >> 0x14 & 1) != 0) &&
                  (param_5 = iVar7 + 8, (*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0))
          {
            param_5 = iVar7 + 0x10;
          }
        }
        if ((int)sVar11 < 1) goto LAB_0045a534;
        iVar12 = iVar12 + 1;
        iVar7 = *(int *)(param_1 + 0xdf8);
        __n = (iVar7 - iVar6) - iVar14;
        uVar9 = *(uint *)(param_1 + 0xd2c);
        if ((int)__n <= (int)sVar11) break;
LAB_0045a488:
        __n = sVar11;
        iVar7 = *(int *)(param_1 + 0x1238) + __n;
        sVar11 = __n;
      }
    } while( true );
  }
LAB_0045a534:
  *(int *)(param_1 + 0xdec) = *(int *)(param_1 + 0xdec) + 1;
  return param_5 - iVar2;
}



undefined4
dtlsWriteCertificateRequest
          (undefined4 param_1,int param_2,int param_3,int param_4,int param_5,undefined4 param_6)

{
  ushort *puVar1;
  undefined *__ptr;
  undefined4 uVar2;
  uint uVar3;
  undefined *puVar4;
  int iVar5;
  size_t __size;
  
  param_3 = param_4 * 2 + param_3;
  __size = param_3 + param_5 + 5;
  __ptr = (undefined *)malloc(__size);
  uVar2 = 0xfffffff8;
  if (__ptr != (undefined *)0x0) {
    uVar3 = *(uint *)(param_2 + 0xd2c);
    __ptr[1] = 0x40;
    *__ptr = 2;
    __ptr[2] = 1;
    puVar4 = __ptr + 3;
    if ((uVar3 >> 0xd & 1) == 0) {
      iVar5 = *(int *)(*(int *)(param_2 + 0xc48) + 0x78);
    }
    else {
      __ptr[4] = (char)param_5 + -2;
      __ptr[10] = 3;
      __ptr[0xb] = 5;
      __ptr[0xd] = 4;
      __ptr[0xf] = 2;
      __ptr[0x10] = 1;
      __ptr[3] = 0;
      __ptr[5] = 5;
      __ptr[6] = 3;
      __ptr[7] = 4;
      __ptr[8] = 3;
      __ptr[9] = 2;
      __ptr[0xc] = 1;
      __ptr[0xe] = 1;
      iVar5 = *(int *)(*(int *)(param_2 + 0xc48) + 0x78);
      puVar4 = __ptr + 0x11;
    }
    if (iVar5 == 0) {
      puVar4[1] = 0;
      *puVar4 = 0;
      uVar2 = FUN_0045a144(param_2,__ptr,__size,0xd,param_6);
      free(__ptr);
    }
    else {
      *puVar4 = (char)((uint)param_3 >> 8);
      puVar4[1] = (char)param_3;
      puVar4 = puVar4 + 2;
      do {
        *puVar4 = (char)((ushort)*(undefined2 *)(iVar5 + 0x18c) >> 8);
        puVar4[1] = (char)*(undefined2 *)(iVar5 + 0x18c);
        memcpy(puVar4 + 2,*(void **)(iVar5 + 0x188),(size_t)*(undefined2 *)(iVar5 + 0x18c));
        puVar1 = (ushort *)(iVar5 + 0x18c);
        iVar5 = *(int *)(iVar5 + 0x31c);
        puVar4 = puVar4 + 2 + *puVar1;
      } while (iVar5 != 0);
      uVar2 = FUN_0045a144(param_2,__ptr,__size,0xd,param_6);
      free(__ptr);
    }
  }
  return uVar2;
}



undefined4 dtlsWriteCertificate(int param_1,int param_2,int param_3,undefined4 param_4)

{
  ushort uVar1;
  undefined *__ptr;
  undefined4 uVar2;
  int iVar3;
  undefined *puVar4;
  uint __n;
  size_t __size;
  
  __size = param_2 + param_3;
  __ptr = (undefined *)malloc(__size);
  uVar2 = 0xfffffff8;
  if (__ptr != (undefined *)0x0) {
    iVar3 = __size - 3;
    *__ptr = (char)((uint)iVar3 >> 0x10);
    __ptr[1] = (char)((uint)iVar3 >> 8);
    __ptr[2] = (char)iVar3;
    puVar4 = __ptr + 3;
    if (0 < param_2) {
      for (iVar3 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74); iVar3 != 0;
          iVar3 = *(int *)(iVar3 + 0x31c)) {
        uVar1 = *(ushort *)(iVar3 + 0x314);
        __n = (uint)uVar1;
        if (__n != 0) {
          puVar4[1] = (char)(uVar1 >> 8);
          *puVar4 = 0;
          puVar4[2] = (char)uVar1;
          memcpy(puVar4 + 3,*(void **)(iVar3 + 0x310),__n);
          puVar4 = puVar4 + 3 + __n;
        }
      }
    }
    uVar2 = FUN_0045a144(param_1,__ptr,__size,0xb,param_4);
    free(__ptr);
  }
  return uVar2;
}



void dtlsIncrRsn(int param_1)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = 5;
  do {
    iVar2 = iVar3 + param_1;
    iVar3 = iVar3 + -1;
    if (*(char *)(iVar2 + 0xdd1) != -1) {
      bVar1 = *(char *)(iVar2 + 0xdd1) + 1;
      *(byte *)(iVar2 + 0xdd1) = bVar1;
      if (bVar1 <= *(byte *)(iVar2 + 0xdd7)) {
        return;
      }
      *(byte *)(iVar2 + 0xdd7) = bVar1;
      return;
    }
    *(undefined *)(iVar2 + 0xdd1) = 0;
  } while (-1 < iVar3);
  return;
}



undefined4 dtlsEncryptFragRecord(int param_1,void **param_2,int param_3,int *param_4)

{
  undefined uVar1;
  int iVar2;
  uint uVar3;
  undefined4 uVar4;
  int iVar5;
  byte bVar6;
  void *pvVar7;
  void *__src;
  int iVar8;
  code *pcVar9;
  undefined auStack_33 [19];
  
  iVar8 = *(int *)(param_3 + 8) + *(int *)(param_1 + 0x1234);
  __src = *param_2;
  if (((*(uint *)(param_1 + 0xd2c) >> 2 & 1) == 0) ||
     (uVar3 = (uint)*(byte *)(param_1 + 0xd27), uVar3 < 2)) {
    pvVar7 = param_2[7];
  }
  else {
    pvVar7 = param_2[7];
    __src = (void *)((int)__src + uVar3);
    *param_4 = *param_4 + uVar3;
  }
  if (pvVar7 == (void *)0x1) {
    memcpy(auStack_33 + 3,__src,*(size_t *)(param_1 + 0x1238));
    uVar3 = *(uint *)(param_1 + 0x1238);
    pvVar7 = param_2[4];
    uVar1 = *(undefined *)((int)param_2 + 0x12);
    auStack_33[uVar3 + 2] = (char)pvVar7;
    auStack_33[uVar3] = uVar1;
    auStack_33[uVar3 + 1] = (char)((uint)pvVar7 >> 8);
    sslUpdateHSHash(param_1,auStack_33 + 3,uVar3 & 0xffff);
  }
  sslUpdateHSHash(param_1,*(int *)(param_1 + 0x1238) + (int)__src,*(undefined2 *)(param_2 + 2));
  uVar3 = *(uint *)(param_1 + 0xd2c);
  iVar5 = *param_4 + *(int *)(param_1 + 0x1238);
  *param_4 = iVar5;
  if ((uVar3 >> 0x14 & 1) != 0) {
    if ((uVar3 >> 0x16 & 1) != 0) {
      iVar8 = iVar8 + 8;
    }
    *(char *)(param_1 + 0xd40) = (char)param_2[3];
    iVar5 = *param_4;
  }
  if ((uVar3 >> 2 & 1) != 0) {
    uVar3 = (uint)*(byte *)(param_1 + 0xd27);
    if (1 < uVar3) {
      iVar5 = (**(code **)(param_1 + 0xd1c))
                        (param_1,*(undefined *)(param_2 + 3),uVar3 + iVar8,(iVar5 - iVar8) - uVar3,
                         iVar5);
      iVar5 = *param_4 + iVar5;
      *param_4 = iVar5;
    }
  }
  iVar2 = sslWritePad(iVar5,*(undefined *)(param_2 + 5));
  iVar2 = *param_4 + iVar2;
  iVar5 = iVar2;
  if (((*(uint *)(param_1 + 0xd2c) >> 0x14 & 1) != 0) &&
     (iVar5 = iVar2 + 8, (*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 0xd & 1) == 0)) {
    iVar5 = iVar2 + 0x10;
  }
  pcVar9 = *(code **)(param_1 + 0xd14);
  *param_4 = iVar5;
  iVar8 = (*pcVar9)(param_1,iVar8,iVar8,iVar5 - iVar8);
  uVar4 = 0xffffffff;
  if (-1 < iVar8) {
    iVar8 = 5;
    do {
      iVar5 = iVar8 + param_1;
      iVar8 = iVar8 + -1;
      if (*(char *)(iVar5 + 0xdd1) != -1) {
        bVar6 = *(char *)(iVar5 + 0xdd1) + 1;
        *(byte *)(iVar5 + 0xdd1) = bVar6;
        if (*(byte *)(iVar5 + 0xdd7) < bVar6) {
          *(byte *)(iVar5 + 0xdd7) = bVar6;
        }
        break;
      }
      *(undefined *)(iVar5 + 0xdd1) = 0;
    } while (-1 < iVar8);
    uVar4 = 0;
  }
  return uVar4;
}



undefined4 dtlsHsHashFragMsg(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined uStack_28;
  byte local_27;
  byte local_26;
  byte local_25;
  byte local_1f;
  byte local_1e;
  byte local_1d;
  
  iVar5 = 0;
  iVar4 = 0;
  do {
    iVar2 = 0;
    while( true ) {
      iVar3 = iVar2 * 0xc + param_1;
      iVar1 = *(int *)(iVar3 + 0xe08);
      iVar2 = iVar2 + 1;
      if (iVar1 == iVar4) break;
      if (((iVar4 != 0) && (iVar4 == iVar5)) || (0xf < iVar2)) {
        return 0;
      }
    }
    if (iVar4 == 0) {
      memcpy(&uStack_28,*(void **)(iVar3 + 0xe10),0xc);
      local_1f = local_27;
      local_1e = local_26;
      local_1d = local_25;
      sslUpdateHSHash(param_1,&uStack_28,0xc);
      iVar1 = *(int *)(iVar3 + 0xe08);
      iVar5 = (uint)local_27 * 0x10000 + (uint)local_26 * 0x100 + (uint)local_25;
    }
    sslUpdateHSHash(param_1,*(int *)(param_1 + 0xd04) + iVar1,*(undefined2 *)(iVar3 + 0xe0c));
    iVar4 = iVar4 + *(int *)(iVar3 + 0xe0c);
  } while( true );
}



undefined4 dtlsCompareEpoch(int param_1,int param_2)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  
  iVar3 = 0;
  while( true ) {
    pbVar1 = (byte *)(param_1 + iVar3);
    pbVar2 = (byte *)(param_2 + iVar3);
    iVar3 = iVar3 + 1;
    if (*pbVar1 < *pbVar2) {
      return 0xffffffff;
    }
    if (*pbVar2 < *pbVar1) break;
    if (1 < iVar3) {
      return 0;
    }
  }
  return 1;
}



undefined4 dtlsChkReplayWindow(int param_1,undefined4 *param_2)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  byte *pbVar6;
  
  uVar2 = (uint)*(byte *)((int)param_2 + 2) * 0x1000000 +
          (uint)*(byte *)((int)param_2 + 3) * 0x10000 + (uint)*(byte *)(param_2 + 1) * 0x100 +
          (uint)*(byte *)((int)param_2 + 5);
  uVar5 = (uint)*(byte *)(param_1 + 0xddf) * 0x1000000 + (uint)*(byte *)(param_1 + 0xde0) * 0x10000
          + (uint)*(byte *)(param_1 + 0xde1) * 0x100 + (uint)*(byte *)(param_1 + 0xde2);
  if (uVar2 != 0) {
    if (uVar5 < uVar2) {
      if (uVar2 - uVar5 < 0x20) {
        *(uint *)(param_1 + 0xde4) = *(int *)(param_1 + 0xde4) << (uVar2 - uVar5 & 0x1f) | 1;
      }
      else {
        *(undefined *)(param_1 + 0xddd) = 1;
      }
      *(undefined4 *)(param_1 + 0xddd) = *param_2;
      *(undefined *)(param_1 + 0xde1) = *(undefined *)(param_2 + 1);
      *(undefined *)(param_1 + 0xde2) = *(undefined *)((int)param_2 + 5);
      return 1;
    }
    if (uVar5 - uVar2 < 0x20) {
      uVar2 = 1 << (uVar5 - uVar2 & 0x1f);
      if ((*(uint *)(param_1 + 0xde4) & uVar2) == 0) {
        *(uint *)(param_1 + 0xde4) = *(uint *)(param_1 + 0xde4) | uVar2;
        return 1;
      }
    }
    return 0;
  }
  if ((uVar5 != 0) || (*(short *)(param_1 + 4) != 0)) {
    iVar4 = 0;
    pbVar6 = (byte *)(param_1 + 4);
    do {
      bVar1 = *(byte *)(param_1 + 0xdcb + iVar4);
      iVar4 = iVar4 + 1;
      if (*pbVar6 < bVar1) {
        iVar3 = -1;
        break;
      }
      if (bVar1 < *pbVar6) {
        iVar3 = 1;
        break;
      }
      pbVar6 = (byte *)(param_1 + 4) + iVar4;
      iVar3 = 0;
    } while (iVar4 < 2);
    if ((iVar3 == 1) && (uVar5 != 0)) {
      *(undefined4 *)(param_1 + 0xde4) = 0;
      return 1;
    }
    if (uVar5 != 0xfffffff) {
      return 0;
    }
  }
  *(undefined4 *)(param_1 + 0xde4) = 0;
  return 1;
}



void dtlsInitFrag(int param_1)

{
  int iVar1;
  
  iVar1 = 0xf;
  *(undefined4 *)(param_1 + 0xd0c) = 0;
  do {
    while( true ) {
      iVar1 = iVar1 + -1;
      *(undefined4 *)(param_1 + 0xe08) = 0xffffffff;
      if (*(void **)(param_1 + 0xe10) != (void *)0x0) break;
      param_1 = param_1 + 0xc;
      if (iVar1 < 0) {
        return;
      }
    }
    free(*(void **)(param_1 + 0xe10));
    *(undefined4 *)(param_1 + 0xe10) = 0;
    param_1 = param_1 + 0xc;
  } while (-1 < iVar1);
  return;
}



undefined4 dtlsSeenFrag(int param_1,int param_2,int *param_3)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  
  piVar2 = (int *)(param_1 + 0xe08);
  iVar3 = 0;
  while( true ) {
    iVar1 = *piVar2;
    piVar2 = piVar2 + 3;
    if (iVar1 == -1) {
      *param_3 = iVar3;
      return 0;
    }
    iVar3 = iVar3 + 1;
    if (iVar1 == param_2) break;
    if (0xf < iVar3) {
      return 0xffffffff;
    }
  }
  return 1;
}



void incrTwoByte(int param_1,undefined *param_2,int param_3)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  
  iVar3 = 1;
  if (param_3 != 0) {
    *param_2 = *(undefined *)(param_1 + 0xdcf);
    param_2[1] = *(undefined *)(param_1 + 0xdd0);
  }
  while( true ) {
    pbVar2 = param_2 + iVar3;
    if (*pbVar2 != 0xff) break;
    iVar3 = iVar3 + -1;
    *pbVar2 = 0;
    if (iVar3 < 0) {
      return;
    }
  }
  bVar1 = *pbVar2 + 1;
  *pbVar2 = bVar1;
  if (param_3 == 0) {
    return;
  }
  if (bVar1 <= *(byte *)(iVar3 + param_1 + 0xdcf)) {
    return;
  }
  *(byte *)(iVar3 + param_1 + 0xdcf) = bVar1;
  return;
}



void zeroSixByte(int param_1)

{
  undefined *puVar1;
  int iVar2;
  
  iVar2 = 5;
  do {
    puVar1 = (undefined *)(param_1 + iVar2);
    iVar2 = iVar2 + -1;
    *puVar1 = 0;
  } while (-1 < iVar2);
  return;
}



int parseClientHello(int param_1,byte **param_2,byte *param_3)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  uint uVar28;
  uint uVar29;
  uint uVar30;
  uint uVar31;
  int iVar32;
  undefined4 uVar33;
  byte bVar34;
  byte *pbVar35;
  uint uVar36;
  byte bVar37;
  int iVar38;
  undefined uVar39;
  bool bVar40;
  uint uVar41;
  byte *pbVar42;
  uint uVar43;
  uint uVar44;
  byte *pbVar45;
  byte bVar46;
  uint in_t8;
  undefined4 uVar47;
  byte *local_30;
  undefined4 local_2c;
  
  pbVar35 = *param_2;
  uVar47 = *(undefined4 *)(param_1 + 0x1250);
  if ((int)param_3 - (int)pbVar35 < 2) goto LAB_0045b4f8;
  bVar34 = *pbVar35;
  *(byte *)(param_1 + 0xd3b) = bVar34;
  bVar37 = pbVar35[1];
  pbVar42 = pbVar35 + 2;
  *(byte *)(param_1 + 0xd3c) = bVar37;
  if ((bVar34 == 3) || (bVar34 == 0xfe)) {
    bVar2 = *(byte *)(param_1 + 0xd3d);
    bVar46 = 3;
    if ((((bVar2 == 0) ||
         ((bVar46 = *(byte *)(param_1 + 0xd3e), bVar46 <= bVar37 &&
          ((bVar40 = bVar37 <= bVar46, bVar34 = bVar2, bVar37 = bVar46,
           (*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0 || (bVar40)))))) && (2 < bVar34)) &&
       (*(byte *)(param_1 + 0xd3d) = bVar34, bVar37 != 0)) {
      uVar39 = 1;
      uVar41 = *(uint *)(param_1 + 0xd2c) | 0x800;
      if (bVar37 < 2 == 0) {
        uVar41 = *(uint *)(param_1 + 0xd2c) | 0x1800;
        uVar39 = 2;
      }
      uVar36 = 3;
      if (bVar37 == 3) {
        uVar41 = uVar41 | 0x3800;
        uVar39 = 3;
      }
      uVar44 = uVar41 >> 0xe;
      uVar43 = uVar44 & 1;
      if ((uVar43 == 0) || (in_t8 = 0xfffffffd, bVar37 != 0xfd)) {
        *(undefined *)(param_1 + 0xd3e) = uVar39;
      }
      else {
        *(undefined *)(param_1 + 0xd3e) = 0xfd;
      }
      bVar34 = *(byte *)(param_1 + 0xd3e);
      uVar31 = uVar41 >> 0xe;
      if (bVar34 == 0) {
LAB_0045b554:
        *(undefined4 *)(param_1 + 0xd30) = 0x46;
        *(uint *)(param_1 + 0xd2c) = uVar41;
        return -0xc;
      }
      if ((uVar31 & 1) == 0) {
        *(uint *)(param_1 + 0xd2c) = uVar41;
      }
      else {
        if (bVar37 < 0xfd) goto LAB_0045b554;
        uVar36 = 0xffffffff;
        if (bVar37 == 0xfd) {
          uVar41 = uVar41 | 0x3800;
          uVar36 = 0xfffffffd;
        }
        *(uint *)(param_1 + 0xd2c) = uVar41;
        if (((uVar41 >> 0xe & 1) == 0) || (bVar37 != 0xfd)) {
          *(char *)(param_1 + 0xd3e) = (char)uVar36;
        }
        else {
          *(undefined *)(param_1 + 0xd3e) = 0xfd;
        }
      }
      if ((*(byte *)(param_1 + 2) < 3) || ((int)param_3 - (int)pbVar42 < 0x21)) {
LAB_0045b3c0:
        iVar38 = -0xc;
        uVar33 = 0x2f;
        goto LAB_0045b264;
      }
      uVar3 = (uint)(pbVar35 + 5) & 3;
      uVar4 = (uint)(pbVar35 + 9) & 3;
      iVar32 = *(int *)(pbVar35 + 9 + -uVar4);
      uVar5 = (uint)(pbVar35 + 0xd) & 3;
      iVar38 = *(int *)(pbVar35 + 0xd + -uVar5);
      uVar6 = (uint)(pbVar35 + 0x11) & 3;
      iVar11 = *(int *)(pbVar35 + 0x11 + -uVar6);
      uVar7 = (uint)(pbVar35 + 0x15) & 3;
      iVar12 = *(int *)(pbVar35 + 0x15 + -uVar7);
      uVar8 = (uint)(pbVar35 + 0x19) & 3;
      iVar13 = *(int *)(pbVar35 + 0x19 + -uVar8);
      uVar9 = (uint)(pbVar35 + 0x1d) & 3;
      iVar14 = *(int *)(pbVar35 + 0x1d + -uVar9);
      uVar10 = (uint)(pbVar35 + 0x21) & 3;
      iVar15 = *(int *)(pbVar35 + 0x21 + -uVar10);
      uVar16 = (uint)(pbVar35 + 10) & 3;
      uVar24 = *(uint *)(pbVar35 + 10 + -uVar16);
      uVar17 = (uint)(pbVar35 + 0xe) & 3;
      uVar25 = *(uint *)(pbVar35 + 0xe + -uVar17);
      uVar18 = (uint)(pbVar35 + 0x12) & 3;
      uVar26 = *(uint *)(pbVar35 + 0x12 + -uVar18);
      uVar19 = (uint)(pbVar35 + 0x16) & 3;
      uVar27 = *(uint *)(pbVar35 + 0x16 + -uVar19);
      uVar20 = (uint)(pbVar35 + 0x1a) & 3;
      uVar28 = *(uint *)(pbVar35 + 0x1a + -uVar20);
      uVar21 = (uint)(pbVar35 + 0x1e) & 3;
      uVar29 = *(uint *)(pbVar35 + 0x1e + -uVar21);
      uVar22 = (uint)pbVar42 & 3;
      uVar23 = (uint)(pbVar35 + 6) & 3;
      uVar30 = *(uint *)(pbVar35 + 6 + -uVar23);
      *(uint *)(param_1 + 0x10) =
           (*(int *)(pbVar35 + 5 + -uVar3) << (3 - uVar3) * 8 |
           uVar36 & 0xffffffffU >> (uVar3 + 1) * 8) & -1 << (4 - uVar22) * 8 |
           *(uint *)(pbVar42 + -uVar22) >> uVar22 * 8;
      *(uint *)(param_1 + 0x14) =
           (iVar32 << (3 - uVar4) * 8 | uVar31 & 0xffffffffU >> (uVar4 + 1) * 8) &
           -1 << (4 - uVar23) * 8 | uVar30 >> uVar23 * 8;
      *(uint *)(param_1 + 0x18) =
           (iVar38 << (3 - uVar5) * 8 | (uint)bVar34 & 0xffffffffU >> (uVar5 + 1) * 8) &
           -1 << (4 - uVar16) * 8 | uVar24 >> uVar16 * 8;
      *(uint *)(param_1 + 0x1c) =
           (iVar11 << (3 - uVar6) * 8 | in_t8 & 0xffffffffU >> (uVar6 + 1) * 8) &
           -1 << (4 - uVar17) * 8 | uVar25 >> uVar17 * 8;
      *(uint *)(param_1 + 0x20) =
           (iVar12 << (3 - uVar7) * 8 | 0xffffffffU >> (uVar7 + 1) * 8 & 0xfd) &
           -1 << (4 - uVar18) * 8 | uVar26 >> uVar18 * 8;
      *(uint *)(param_1 + 0x24) =
           (iVar13 << (3 - uVar8) * 8 | uVar44 & 0xffffffffU >> (uVar8 + 1) * 8) &
           -1 << (4 - uVar19) * 8 | uVar27 >> uVar19 * 8;
      *(uint *)(param_1 + 0x28) =
           (iVar14 << (3 - uVar9) * 8 | uVar43 & 0xffffffffU >> (uVar9 + 1) * 8) &
           -1 << (4 - uVar20) * 8 | uVar28 >> uVar20 * 8;
      *(uint *)(param_1 + 0x2c) =
           (iVar15 << (3 - uVar10) * 8 | (uint)(bVar37 < 2) & 0xffffffffU >> (uVar10 + 1) * 8) &
           -1 << (4 - uVar21) * 8 | uVar29 >> uVar21 * 8;
      uVar36 = (uint)pbVar35[0x22];
      local_30 = pbVar35 + 0x23;
      *(byte *)(param_1 + 0xc98) = pbVar35[0x22];
      if (uVar36 == 0) {
        uVar41 = uVar41 & 0xfffffff7;
        *(uint *)(param_1 + 0xd2c) = uVar41;
      }
      else {
        if ((0x20 < uVar36) || ((int)param_3 - (int)local_30 < (int)uVar36)) goto LAB_0045b3c0;
        memcpy((void *)(param_1 + 0xc99),local_30,uVar36);
        uVar41 = *(uint *)(param_1 + 0xd2c);
        local_30 = local_30 + *(byte *)(param_1 + 0xc98);
      }
      if ((uVar41 >> 0xe & 1) == 0) {
LAB_0045b444:
        if (1 < (int)param_3 - (int)local_30) {
          pbVar35 = local_30 + 2;
          uVar41 = (uint)*local_30 * 0x100 + (uint)local_30[1];
          if (((uVar41 != 0) && ((uVar41 & 1) == 0)) &&
             (pbVar45 = pbVar35 + uVar41, pbVar42 = pbVar35,
             uVar41 <= (uint)((int)param_3 - (int)pbVar35))) {
            do {
              if (pbVar45 <= pbVar42) {
                local_30 = pbVar42 + 1;
                if (((int)param_3 - (int)pbVar42 < 1) ||
                   (uVar36 = (uint)*pbVar42, (uint)((int)param_3 - (int)local_30) < uVar36))
                goto LAB_0045b4f8;
                uVar43 = 0;
                pbVar42 = local_30;
                if (uVar36 != 0) goto LAB_0045b5b0;
                goto LAB_0045b5d0;
              }
              bVar34 = *pbVar42;
              pbVar1 = pbVar42 + 1;
              pbVar42 = pbVar42 + 2;
            } while (((uint)bVar34 * 0x100 + (uint)*pbVar1 != 0x5600) ||
                    (uVar33 = 0x56, bVar46 <= *(byte *)(param_1 + 0xd3c)));
            iVar38 = -0xc;
            goto LAB_0045b264;
          }
        }
        goto LAB_0045b4f8;
      }
      if ((int)param_3 - (int)local_30 < 1) goto LAB_0045b4f8;
      iVar32 = dtlsComputeCookie(param_1,(int)local_30 - (*(byte *)(param_1 + 0xc98) + 0x23));
      iVar38 = -0xc;
      if (-1 < iVar32) {
        uVar41 = (uint)*local_30;
        local_30 = local_30 + 1;
        if (uVar41 == 0) {
          uVar41 = *(uint *)(param_1 + 0xd2c);
          if ((uVar41 >> 1 & 1) == 0) {
            *(undefined *)(param_1 + 0xd38) = 1;
            *param_2 = param_3;
            if ((uVar41 >> 3 & 1) == 0) {
              return -0x35;
            }
            local_30 = param_3;
            matrixClearSession(param_1,0);
            return -0x35;
          }
        }
        else {
          if ((((int)param_3 - (int)local_30 < (int)uVar41) || (uVar41 != 0x10)) ||
             (iVar32 = memcmpct(local_30,param_1 + 0xd4e,0x10), iVar32 != 0)) goto LAB_0045b3c0;
          local_30 = local_30 + 0x10;
        }
        goto LAB_0045b444;
      }
LAB_0045b8f0:
      uVar33 = 0x50;
      goto LAB_0045b264;
    }
  }
  iVar38 = -0xc;
  uVar33 = 0x46;
  goto LAB_0045b264;
  while( true ) {
    uVar43 = uVar43 + 1;
    pbVar42 = local_30 + uVar43;
    if ((int)uVar36 <= (int)uVar43) break;
LAB_0045b5b0:
    if (*pbVar42 == 0) break;
  }
LAB_0045b5d0:
  if (uVar36 == uVar43) {
LAB_0045b4f8:
    iVar38 = -0xc;
    uVar33 = 0x32;
    goto LAB_0045b264;
  }
  local_30 = local_30 + uVar36;
  iVar32 = parseClientHelloExtensions(param_1,&local_30,(int)param_3 - (int)local_30 & 0xffff);
  if (iVar32 < 0) {
    return iVar32;
  }
  if (local_30 != param_3) goto LAB_0045b3c0;
  if (*(char *)(param_1 + 0xc98) == '\0') {
    uVar36 = *(uint *)(param_1 + 0xd2c) >> 3;
  }
  else if ((((*(uint *)(param_1 + 0xd2c) >> 3 & 1) == 0) || (*(int *)(param_1 + 0xcbc) == 0)) ||
          (uVar36 = *(uint *)(param_1 + 0xd2c) >> 3,
          *(short *)(*(int *)(param_1 + 0xcbc) + 0x5c) != 5)) {
    iVar32 = matrixResumeSession(param_1);
    if (iVar32 < 0) {
      uVar36 = *(uint *)(param_1 + 0xd2c) & 0xfffffff7;
      *(uint *)(param_1 + 0xd2c) = uVar36;
      if ((*(int *)(param_1 + 0xcbc) == 0) || (*(short *)(*(int *)(param_1 + 0xcbc) + 0x5c) == 0)) {
        memset((void *)(param_1 + 0xc99),0,0x20);
        uVar36 = *(uint *)(param_1 + 0xd2c);
        *(undefined *)(param_1 + 0xc98) = 0;
      }
      else {
        *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x40000;
      }
    }
    else {
      uVar36 = *(uint *)(param_1 + 0xd2c) & 0xffffff7f | 8;
      *(uint *)(param_1 + 0xd2c) = uVar36;
    }
    uVar36 = uVar36 >> 3;
  }
  if ((uVar36 & 1) == 0) {
    iVar32 = chooseCipherSuite(param_1,pbVar35,uVar41);
    if (iVar32 < 0) {
      uVar47 = sslGetCipherSpec(param_1,0);
      *(undefined4 *)(param_1 + 0xd10) = uVar47;
      if (*(int *)(param_1 + 0xd30) != 0x70) {
        *(undefined4 *)(param_1 + 0xd30) = 0x28;
      }
      return -0xc;
    }
    if (**(short **)(param_1 + 0xd10) != 0) goto LAB_0045b700;
LAB_0045b844:
    iVar38 = -0xc;
    uVar33 = 0x28;
LAB_0045b264:
    *(undefined4 *)(param_1 + 0xd30) = uVar33;
    return iVar38;
  }
  bVar40 = false;
  if (pbVar45 <= pbVar35) {
LAB_0045b850:
    uVar47 = sslGetCipherSpec(param_1,0);
    *(undefined4 *)(param_1 + 0xd30) = 0x28;
    *(undefined4 *)(param_1 + 0xd10) = uVar47;
    return -0xc;
  }
  iVar38 = -0xc;
  if (*(byte *)(param_1 + 2) < 3) {
    uVar33 = 0x28;
    goto LAB_0045b264;
  }
  do {
    bVar34 = *pbVar35;
    pbVar42 = pbVar35 + 1;
    pbVar35 = pbVar35 + 2;
    if ((uint)**(ushort **)(param_1 + 0xd10) == (uint)bVar34 * 0x100 + (uint)*pbVar42) {
      bVar40 = true;
    }
  } while (pbVar35 < pbVar45);
  if (!bVar40) goto LAB_0045b850;
LAB_0045b700:
  matrixSslSetKexFlags(param_1);
  uVar41 = *(uint *)(param_1 + 0xd2c);
  if ((uVar41 >> 3 & 1) != 0) {
    uVar39 = 0x14;
    goto LAB_0045b7e8;
  }
  if (((uVar41 >> 0x11 & 1) != 0) && ((uVar41 >> 0x13 & 1) != 0)) {
    if ((*(char *)(param_1 + 0xd4b) == '\0') && ((*(uint *)(param_1 + 0xd48) >> 0x17 & 1) != 0))
    goto LAB_0045b844;
    iVar32 = getEccParamById(*(undefined *)(param_1 + 0xd4b),&local_2c);
    if (iVar32 < 0) {
      return -0xc;
    }
    iVar32 = psEccNewKey(*(undefined4 *)(param_1 + 0xc90),param_1 + 0xc34,local_2c);
    if (iVar32 < 0) {
      return -8;
    }
    iVar38 = matrixSslGenEphemeralEcKey
                       (*(undefined4 *)(param_1 + 0xc48),*(undefined4 *)(param_1 + 0xc34),local_2c,
                        uVar47);
    if (iVar38 < 0) {
      psEccDeleteKey(param_1 + 0xc34);
      goto LAB_0045b8f0;
    }
    uVar41 = *(uint *)(param_1 + 0xd2c);
  }
  uVar39 = 0x10;
  if ((uVar41 >> 7 & 1) != 0) {
    uVar39 = 0xb;
  }
LAB_0045b7e8:
  *(undefined *)(param_1 + 0xd38) = uVar39;
  *param_2 = local_30;
  *(undefined *)(param_1 + 0xd39) = 1;
  return -0x35;
}



undefined4 parseClientKeyExchange(int param_1,uint param_2,byte **param_3,int param_4)

{
  byte bVar1;
  int iVar2;
  void *pvVar3;
  size_t __size;
  byte *pbVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  uint uVar9;
  int iVar10;
  byte *pbVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  undefined4 local_58 [7];
  undefined local_3c [4];
  undefined4 auStack_38 [4];
  byte local_28 [4];
  void *local_24;
  
  pbVar11 = *param_3;
  iVar10 = param_4 - (int)pbVar11;
  local_24 = (void *)0x0;
  uVar12 = *(undefined4 *)(param_1 + 0x1250);
  if (iVar10 < (int)param_2) goto LAB_0045bb9c;
  if ((*(byte *)(param_1 + 0xd3d) < 3) || (*(char *)(param_1 + 0xd3e) == '\0')) {
    uVar9 = *(uint *)(param_1 + 0xd2c);
  }
  else {
    if (iVar10 < 2) goto LAB_0045bb9c;
    uVar9 = *(uint *)(param_1 + 0xd2c);
    if ((uVar9 >> 0x13 & 1) == 0) {
      param_2 = (uint)*pbVar11 * 0x100 + (uint)pbVar11[1];
      pbVar11 = pbVar11 + 2;
    }
    else {
      param_2 = (uint)*pbVar11;
      pbVar11 = pbVar11 + 1;
    }
    iVar10 = param_4 - (int)pbVar11;
    if (iVar10 < (int)param_2) goto LAB_0045bb9c;
  }
  if ((uVar9 >> 0x11 & 1) == 0) {
    if ((uVar9 >> 0x12 & 1) == 0) {
      if ((ushort)(*(short *)(*(int *)(param_1 + 0xd10) + 2) - 8U) < 2) {
        if ((*(uint *)(param_1 + 0xd3c) & 0xffff00) == 0x300) {
          param_2 = (uint)*pbVar11;
          pbVar11 = pbVar11 + 1;
        }
        if (*(int *)(param_1 + 0xc48) == 0) goto LAB_0045c218;
        iVar10 = psEccNewKey(*(undefined4 *)(param_1 + 0xc90),param_1 + 0xc38,
                             *(undefined4 *)(*(int *)(param_1 + 0xc48) + 0x38));
        if (iVar10 < 0) {
          return 0xfffffff8;
        }
        iVar10 = psEccX963ImportKey(*(undefined4 *)(param_1 + 0xc90),pbVar11,param_2 & 0xffff,
                                    *(undefined4 *)(param_1 + 0xc38),
                                    *(undefined4 *)(*(int *)(param_1 + 0xc48) + 0x38));
        if (iVar10 < 0) goto LAB_0045bb9c;
        bVar1 = **(byte **)(*(int *)(param_1 + 0xc48) + 0x38);
        *(ushort *)(param_1 + 0x84) = (ushort)bVar1;
        pvVar3 = malloc((uint)bVar1);
        *(void **)(param_1 + 0x80) = pvVar3;
        if (pvVar3 == (void *)0x0) {
          return 0xfffffff8;
        }
        iVar10 = psEccGenSharedSecret
                           (*(undefined4 *)(param_1 + 0xc90),*(int *)(param_1 + 0xc48) + 4,
                            *(undefined4 *)(param_1 + 0xc38),pvVar3,param_1 + 0x84,uVar12);
        if (iVar10 < 0) goto LAB_0045c2ac;
        psEccDeleteKey(param_1 + 0xc38);
      }
      else {
        if (*(int *)(param_1 + 0xc48) == 0) goto LAB_0045c218;
        *(undefined2 *)(param_1 + 0x84) = 0x30;
        pvVar3 = malloc(0x30);
        *(void **)(param_1 + 0x80) = pvVar3;
        if (pvVar3 == (void *)0x0) {
          return 0xfffffff8;
        }
        iVar10 = psRsaDecryptPriv(0,*(int *)(param_1 + 0xc48) + 4,pbVar11,param_2 & 0xffff,pvVar3,
                                  *(undefined2 *)(param_1 + 0x84),uVar12);
        iVar2 = psGetPrngLocked(local_58,0x2e,*(undefined4 *)(param_1 + 0x1250));
        if (iVar2 < 0) goto LAB_0045c218;
        **(undefined **)(param_1 + 0x80) = *(undefined *)(param_1 + 0xd3b);
        *(undefined *)(*(int *)(param_1 + 0x80) + 1) = *(undefined *)(param_1 + 0xd3c);
        if (iVar10 < 0) {
          puVar5 = (undefined4 *)(*(int *)(param_1 + 0x80) + 2);
          puVar8 = local_58;
          do {
            puVar7 = puVar8;
            puVar6 = puVar5;
            uVar14 = puVar7[1];
            uVar13 = puVar7[2];
            uVar12 = puVar7[3];
            *puVar6 = *puVar7;
            puVar6[1] = uVar14;
            puVar6[2] = uVar13;
            puVar8 = puVar7 + 4;
            puVar6[3] = uVar12;
            puVar5 = puVar6 + 4;
          } while (puVar8 != (undefined4 *)(local_3c + 4));
          uVar13 = puVar7[5];
          uVar12 = puVar7[6];
          puVar6[4] = *puVar8;
          puVar6[5] = uVar13;
          puVar6[6] = uVar12;
          *(undefined *)(puVar6 + 7) = *(undefined *)(puVar7 + 7);
          *(undefined *)((int)puVar6 + 0x1d) = *(undefined *)((int)puVar7 + 0x1d);
        }
        else {
          iVar10 = *(int *)(param_1 + 0x80);
          puVar5 = (undefined4 *)(iVar10 + 2);
          puVar8 = local_58;
          do {
            puVar7 = puVar8;
            puVar6 = puVar5;
            uVar13 = puVar6[1];
            uVar12 = puVar6[2];
            uVar14 = puVar6[3];
            puVar5 = puVar6 + 4;
            *puVar7 = *puVar6;
            puVar7[1] = uVar13;
            puVar7[2] = uVar12;
            puVar7[3] = uVar14;
            puVar8 = puVar7 + 4;
          } while (puVar5 != (undefined4 *)(iVar10 + 0x22));
          uVar13 = puVar6[5];
          uVar12 = puVar6[6];
          puVar7[4] = *puVar5;
          puVar7[5] = uVar13;
          puVar7[6] = uVar12;
          *(undefined *)(puVar7 + 7) = *(undefined *)(puVar6 + 7);
          *(undefined *)((int)puVar7 + 0x1d) = *(undefined *)((int)puVar6 + 0x1d);
        }
        memset_s(local_58,0x2e,0,0x2e);
      }
    }
    else {
      if ((*(uint *)(param_1 + 0xd3c) & 0xffff00) == 0x300) {
        param_2 = (uint)*pbVar11 * 0x100 + (uint)pbVar11[1];
        pbVar11 = pbVar11 + 2;
      }
      if ((*(int *)(param_1 + 0xc48) == 0) || (*(int *)(*(int *)(param_1 + 0xc48) + 0x7c) == 0)) {
        if ((*(code **)(param_1 + 0x250) != (code *)0x0) &&
           (iVar10 = (**(code **)(param_1 + 0x250))
                               (param_1,pbVar11,param_2 & 0xff,&local_24,local_28), iVar10 < 0))
        goto LAB_0045c1b0;
      }
      else {
        matrixSslPskGetKey(param_1,pbVar11,param_2 & 0xff,&local_24,local_28);
      }
      if (local_24 == (void *)0x0) {
LAB_0045c1b0:
        *(undefined4 *)(param_1 + 0xd30) = 0x73;
        return 0xfffffff4;
      }
      __size = (uint)local_28[0] * 2 + 4;
      *(short *)(param_1 + 0x84) = (short)__size;
      pvVar3 = malloc(__size);
      *(void **)(param_1 + 0x80) = pvVar3;
      if (pvVar3 == (void *)0x0) {
        return 0xfffffff8;
      }
      memset(pvVar3,0,(uint)*(ushort *)(param_1 + 0x84));
      **(undefined **)(param_1 + 0x80) = 0;
      *(byte *)(*(int *)(param_1 + 0x80) + 1) = local_28[0];
      *(undefined *)(*(int *)(param_1 + 0x80) + (uint)local_28[0] + 2) = 0;
      *(byte *)(*(int *)(param_1 + 0x80) + (uint)local_28[0] + 3) = local_28[0];
      memcpy((void *)(*(int *)(param_1 + 0x80) + (uint)local_28[0] + 4),local_24,(uint)local_28[0]);
    }
LAB_0045bcc8:
    uVar9 = *(uint *)(param_1 + 0x1230);
  }
  else {
    if ((*(uint *)(param_1 + 0xd3c) & 0xffff00) == 0x300) {
      if ((uVar9 >> 0x13 & 1) == 0) {
        if (iVar10 < 2) goto LAB_0045bb9c;
        bVar1 = *pbVar11;
        pbVar4 = pbVar11 + 1;
        pbVar11 = pbVar11 + 2;
        param_2 = (uint)bVar1 * 0x100 + (uint)*pbVar4;
        if (param_4 - (int)pbVar11 < (int)param_2) goto LAB_0045bb9c;
      }
      else {
        param_2 = (uint)*pbVar11;
        pbVar11 = pbVar11 + 1;
      }
    }
    if ((uVar9 >> 0x12 & 1) != 0) {
      if ((uint)(param_4 - (int)pbVar11) < param_2) goto LAB_0045bb9c;
      if ((*(int *)(param_1 + 0xc48) == 0) || (*(int *)(*(int *)(param_1 + 0xc48) + 0x7c) == 0)) {
        if (*(code **)(param_1 + 0x250) != (code *)0x0) {
          (**(code **)(param_1 + 0x250))(param_1,pbVar11,param_2 & 0xff,&local_24,local_28);
        }
      }
      else {
        matrixSslPskGetKey(param_1,pbVar11,param_2 & 0xff,&local_24,local_28);
      }
      pbVar4 = pbVar11 + param_2;
      if (local_24 == (void *)0x0) goto LAB_0045c1b0;
      pbVar11 = pbVar4 + 2;
      param_2 = (uint)*pbVar4 * 0x100 + (uint)pbVar4[1];
      if ((uint)(param_4 - (int)pbVar11) < param_2) goto LAB_0045bb9c;
      uVar9 = *(uint *)(param_1 + 0xd2c);
    }
    if ((uVar9 >> 0x13 & 1) != 0) {
      iVar10 = psEccNewKey(*(undefined4 *)(param_1 + 0xc90),param_1 + 0xc38,
                           *(undefined4 *)(*(int *)(param_1 + 0xc34) + 0x34));
      if (iVar10 < 0) {
        return 0xfffffff8;
      }
      iVar10 = psEccX963ImportKey(*(undefined4 *)(param_1 + 0xc90),pbVar11,param_2 & 0xffff,
                                  *(undefined4 *)(param_1 + 0xc38),
                                  *(undefined4 *)(*(int *)(param_1 + 0xc34) + 0x34));
      if (iVar10 < 0) {
LAB_0045bb9c:
        *(undefined4 *)(param_1 + 0xd30) = 0x32;
        return 0xfffffff4;
      }
      bVar1 = **(byte **)(*(int *)(param_1 + 0xc34) + 0x34);
      *(ushort *)(param_1 + 0x84) = (ushort)bVar1;
      pvVar3 = malloc((uint)bVar1);
      *(void **)(param_1 + 0x80) = pvVar3;
      if (pvVar3 == (void *)0x0) {
        return 0xfffffff8;
      }
      iVar10 = psEccGenSharedSecret
                         (*(undefined4 *)(param_1 + 0xc90),*(undefined4 *)(param_1 + 0xc34),
                          *(undefined4 *)(param_1 + 0xc38),pvVar3,param_1 + 0x84,uVar12);
      if (iVar10 < 0) {
LAB_0045c2ac:
        *(undefined4 *)(param_1 + 0xd30) = 0x50;
        free(*(void **)(param_1 + 0x80));
        *(undefined4 *)(param_1 + 0x80) = 0;
        return 0xfffffff4;
      }
      psEccDeleteKey(param_1 + 0xc38);
      psEccDeleteKey(param_1 + 0xc34);
      goto LAB_0045bcc8;
    }
    uVar9 = *(uint *)(param_1 + 0x1230);
  }
  if ((uVar9 >> 0x11 & 1) == 1) {
    iVar10 = tlsExtendedDeriveKeys(param_1);
    if (iVar10 < 0) {
      return 0xfffffff4;
    }
    matrixUpdateSession(param_1);
    pvVar3 = *(void **)(param_1 + 0x80);
    *(undefined *)(param_1 + 0xd38) = 0x14;
  }
  else {
    iVar10 = sslCreateKeys(param_1);
    if (iVar10 < 0) {
LAB_0045c218:
      *(undefined4 *)(param_1 + 0xd30) = 0x50;
      return 0xfffffff4;
    }
    matrixUpdateSession(param_1);
    pvVar3 = *(void **)(param_1 + 0x80);
    *(undefined *)(param_1 + 0xd38) = 0x14;
  }
  if (pvVar3 != (void *)0x0) {
    free(pvVar3);
    *(undefined4 *)(param_1 + 0x80) = 0;
    *(undefined2 *)(param_1 + 0x84) = 0;
  }
  uVar9 = *(uint *)(param_1 + 0xd2c);
  if ((uVar9 >> 7 & 1) == 0) {
    if (*(void **)(param_1 + 600) != (void *)0x0) {
      free(*(void **)(param_1 + 600));
      *(undefined4 *)(param_1 + 600) = 0;
    }
    if (*(void **)(param_1 + 0x1220) != (void *)0x0) {
      free(*(void **)(param_1 + 0x1220));
      *(undefined4 *)(param_1 + 0x1220) = 0;
    }
    uVar9 = *(uint *)(param_1 + 0xd2c);
    *(undefined4 *)(param_1 + 0xc90) = 0;
  }
  if ((uVar9 >> 7 & 1) != 0) {
    *(undefined *)(param_1 + 0xd38) = 0xf;
  }
  *param_3 = pbVar11 + param_2;
  *(undefined *)(param_1 + 0xd39) = 0x10;
  return 0;
}



undefined4 parseCertificateVerify(int param_1,int param_2,byte **param_3,int param_4)

{
  uint uVar1;
  int iVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  code *pcVar8;
  undefined auStack_70 [64];
  int local_30 [2];
  
  local_30[0] = 0;
  uVar7 = *(undefined4 *)(param_1 + 0x1250);
  pbVar4 = *param_3;
  uVar6 = 0x24;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) != 0) {
    if ((uint)(param_4 - (int)pbVar4) < 2) goto LAB_0045c3b0;
    uVar3 = (uint)*pbVar4;
    uVar1 = 1 << (uVar3 & 7) & 0xff;
    if (pbVar4[1] != 1) {
      uVar1 = uVar1 << 8;
    }
    if ((*(ushort *)(param_1 + 0xd4c) & uVar1) == 0) goto LAB_0045c3b0;
    if (uVar3 == 4) {
      uVar6 = 0x20;
      pbVar4 = pbVar4 + 2;
    }
    else if (uVar3 < 5) {
      if (uVar3 != 2) goto LAB_0045c3b0;
      sslSha1RetrieveHSHash(param_1,param_2);
      uVar6 = 0x14;
      pbVar4 = pbVar4 + 2;
    }
    else if (uVar3 == 5) {
      sslSha384RetrieveHSHash(param_1,param_2);
      uVar6 = 0x30;
      pbVar4 = pbVar4 + 2;
    }
    else {
      if (uVar3 != 6) goto LAB_0045c3b0;
      sslSha512RetrieveHSHash(param_1,param_2);
      uVar6 = 0x40;
      pbVar4 = pbVar4 + 2;
    }
  }
  pbVar5 = pbVar4 + 2;
  if ((1 < (uint)(param_4 - (int)pbVar4)) &&
     (uVar1 = (uint)CONCAT11(*pbVar4,pbVar4[1]), uVar1 <= (uint)(param_4 - (int)pbVar5))) {
    iVar2 = *(int *)(param_1 + 600);
    if (*(int *)(iVar2 + 0x1bc) == 0x206) {
      local_30[0] = 0;
      if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
        param_2 = param_2 + 0x10;
        uVar6 = 0x14;
      }
      iVar2 = psEccDsaVerify(0,iVar2 + 0x28,param_2,uVar6,pbVar5,uVar1,local_30,uVar7);
      if ((iVar2 != 0) || (local_30[0] != 1)) {
        *(undefined4 *)(param_1 + 0xd30) = 0x2a;
        return 0xfffffff4;
      }
    }
    else {
      pcVar8 = pubRsaDecryptSignedElement;
      if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
        pcVar8 = psRsaDecryptPub;
      }
      iVar2 = (*pcVar8)(0,iVar2 + 0x28,pbVar5,uVar1,auStack_70,uVar6,uVar7);
      if (iVar2 < 0) {
        return 0xfffffff4;
      }
      iVar2 = memcmpct(auStack_70,param_2,uVar6);
      if (iVar2 != 0) {
        return 0xfffffff4;
      }
    }
    *(undefined *)(param_1 + 0xd38) = 0x14;
    *param_3 = pbVar5 + uVar1;
    *(undefined *)(param_1 + 0xd39) = 0xf;
    return 0;
  }
LAB_0045c3b0:
  *(undefined4 *)(param_1 + 0xd30) = 0x32;
  return 0xfffffff4;
}



int parseServerHello(int param_1,int param_2,byte **param_3,byte *param_4)

{
  byte bVar1;
  byte bVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  undefined uVar22;
  byte *pbVar23;
  ushort *puVar24;
  uint uVar25;
  int iVar26;
  uint uVar27;
  uint uVar28;
  uint uVar29;
  byte *pbVar30;
  undefined4 uVar31;
  undefined4 uVar32;
  uint unaff_s4;
  uint in_t8;
  code *pcVar33;
  uint unaff_retaddr;
  byte *local_30 [2];
  
  pcVar33 = parseServerHello;
  pbVar23 = *param_3;
  local_30[0] = pbVar23;
  if (*(void **)(param_1 + 0xd60) != (void *)0x0) {
    pcVar33 = free;
    unaff_retaddr = 0x45c78c;
    free(*(void **)(param_1 + 0xd60));
    *(undefined4 *)(param_1 + 0xd60) = 0;
    *(undefined4 *)(param_1 + 0xd64) = 0;
    *(undefined4 *)(param_1 + 0xd68) = 0;
  }
  if (*(void **)(param_1 + 0xd6c) != (void *)0x0) {
    pcVar33 = free;
    unaff_retaddr = 0x45c76c;
    free(*(void **)(param_1 + 0xd6c));
    *(undefined4 *)(param_1 + 0xd6c) = 0;
    *(undefined4 *)(param_1 + 0xd70) = 0;
  }
  if (1 < (int)param_4 - (int)local_30[0]) {
    uVar29 = (uint)*local_30[0];
    pbVar30 = local_30[0] + 2;
    *(byte *)(param_1 + 0xd3b) = *local_30[0];
    bVar1 = local_30[0][1];
    uVar25 = (uint)bVar1;
    if (uVar29 != *(byte *)(param_1 + 0xd3d)) {
LAB_0045c71c:
      *(undefined4 *)(param_1 + 0xd30) = 0x46;
      *(byte *)(param_1 + 0xd3c) = bVar1;
      return -0xc;
    }
    bVar2 = *(byte *)(param_1 + 0xd3e);
    uVar28 = (uint)bVar2;
    if (uVar25 == uVar28) {
      *(byte *)(param_1 + 0xd3c) = bVar1;
    }
    else {
      if ((*(char *)(param_1 + 0xd3f) != '\0') || ((uVar25 == 0 && (uVar28 != 0))))
      goto LAB_0045c71c;
      if (uVar25 < 3) {
        uVar27 = *(uint *)(param_1 + 0xd2c);
        if ((uVar27 >> 0xd & 1) != 0) {
          uVar27 = uVar27 & 0xffffdfff;
          *(uint *)(param_1 + 0xd2c) = uVar27;
          if (uVar25 == 2) {
            *(byte *)(param_1 + 0xd3c) = bVar2;
            *(byte *)(param_1 + 0xd3e) = bVar1;
            goto LAB_0045c824;
          }
        }
      }
      else {
        uVar27 = *(uint *)(param_1 + 0xd2c);
      }
      unaff_s4 = (uint)(uVar28 < 4);
      if ((uVar25 == 1) && (pcVar33 = (code *)(uVar27 >> 0xe), unaff_s4 != 0)) {
        unaff_retaddr = 0xffffefff;
        in_t8 = uVar27 & 0xffffefff;
        *(byte *)(param_1 + 0xd3c) = bVar2;
        *(byte *)(param_1 + 0xd3e) = bVar1;
        *(uint *)(param_1 + 0xd2c) = in_t8;
      }
      else {
        pcVar33 = (code *)(uVar27 >> 0xe);
        *(byte *)(param_1 + 0xd3c) = bVar1;
        if ((((uint)pcVar33 & 1) == 0) ||
           (uVar25 = 0xfd00ff, (*(uint *)(param_1 + 0xd3c) & 0xff00ff) != 0xfd00ff)) {
          uVar31 = 0x46;
          goto LAB_0045c7ec;
        }
        *(byte *)(param_1 + 0xd3c) = bVar2;
        *(undefined *)(param_1 + 0xd3e) = 0xff;
        *(uint *)(param_1 + 0xd2c) = uVar27 & 0xffffdfff;
        uVar29 = 0xfd00ff;
      }
    }
LAB_0045c824:
    if (0x20 < (int)param_4 - (int)pbVar30) {
      uVar28 = (uint)(local_30[0] + 5) & 3;
      uVar27 = (uint)(local_30[0] + 9) & 3;
      iVar26 = *(int *)(local_30[0] + 9 + -uVar27);
      uVar3 = (uint)(local_30[0] + 0xd) & 3;
      iVar7 = *(int *)(local_30[0] + 0xd + -uVar3);
      uVar4 = (uint)(local_30[0] + 0x11) & 3;
      iVar8 = *(int *)(local_30[0] + 0x11 + -uVar4);
      uVar5 = (uint)(local_30[0] + 0x15) & 3;
      iVar9 = *(int *)(local_30[0] + 0x15 + -uVar5);
      uVar6 = (uint)(local_30[0] + 0x19) & 3;
      iVar10 = *(int *)(local_30[0] + 0x19 + -uVar6);
      uVar32 = *(undefined4 *)(local_30[0] + 0x1a);
      uVar31 = *(undefined4 *)(local_30[0] + 0x1e);
      uVar11 = (uint)(local_30[0] + 10) & 3;
      uVar17 = *(uint *)(local_30[0] + 10 + -uVar11);
      uVar12 = (uint)(local_30[0] + 0xe) & 3;
      uVar18 = *(uint *)(local_30[0] + 0xe + -uVar12);
      uVar13 = (uint)(local_30[0] + 0x12) & 3;
      uVar19 = *(uint *)(local_30[0] + 0x12 + -uVar13);
      uVar14 = (uint)(local_30[0] + 0x16) & 3;
      uVar20 = *(uint *)(local_30[0] + 0x16 + -uVar14);
      uVar15 = (uint)pbVar30 & 3;
      uVar16 = (uint)(local_30[0] + 6) & 3;
      uVar21 = *(uint *)(local_30[0] + 6 + -uVar16);
      *(uint *)(param_1 + 0x30) =
           (*(int *)(local_30[0] + 5 + -uVar28) << (3 - uVar28) * 8 |
           uVar25 & 0xffffffffU >> (uVar28 + 1) * 8) & -1 << (4 - uVar15) * 8 |
           *(uint *)(pbVar30 + -uVar15) >> uVar15 * 8;
      *(uint *)(param_1 + 0x34) =
           (iVar26 << (3 - uVar27) * 8 | uVar29 & 0xffffffffU >> (uVar27 + 1) * 8) &
           -1 << (4 - uVar16) * 8 | uVar21 >> uVar16 * 8;
      *(undefined4 *)(param_1 + 0x4c) = uVar31;
      *(uint *)(param_1 + 0x38) =
           (iVar7 << (3 - uVar3) * 8 | (uint)pcVar33 & 0xffffffffU >> (uVar3 + 1) * 8) &
           -1 << (4 - uVar11) * 8 | uVar17 >> uVar11 * 8;
      *(uint *)(param_1 + 0x3c) =
           (iVar8 << (3 - uVar4) * 8 | unaff_retaddr & 0xffffffffU >> (uVar4 + 1) * 8) &
           -1 << (4 - uVar12) * 8 | uVar18 >> uVar12 * 8;
      *(uint *)(param_1 + 0x40) =
           (iVar9 << (3 - uVar5) * 8 | in_t8 & 0xffffffffU >> (uVar5 + 1) * 8) &
           -1 << (4 - uVar13) * 8 | uVar19 >> uVar13 * 8;
      *(uint *)(param_1 + 0x44) =
           (iVar10 << (3 - uVar6) * 8 | unaff_s4 & 0xffffffffU >> (uVar6 + 1) * 8) &
           -1 << (4 - uVar14) * 8 | uVar20 >> uVar14 * 8;
      *(undefined4 *)(param_1 + 0x48) = uVar32;
      bVar1 = local_30[0][0x22];
      uVar29 = (uint)bVar1;
      pbVar30 = local_30[0] + 0x23;
      if ((uVar29 < 0x21) && (uVar29 <= (uint)((int)param_4 - (int)pbVar30))) {
        local_30[0] = pbVar30;
        if (uVar29 == 0) {
          if (*(char *)(param_1 + 0xc98) != '\0') {
            uVar31 = sslGetCipherSpec(param_1,0);
            *(undefined4 *)(param_1 + 0xd10) = uVar31;
            *(undefined4 *)(param_1 + 0x50) = 0;
            *(undefined4 *)(param_1 + 0x54) = 0;
            *(undefined4 *)(param_1 + 0x58) = 0;
            *(undefined4 *)(param_1 + 0x5c) = 0;
            *(undefined4 *)(param_1 + 0x60) = 0;
            *(undefined4 *)(param_1 + 100) = 0;
            *(undefined4 *)(param_1 + 0x68) = 0;
            *(undefined4 *)(param_1 + 0x6c) = 0;
            *(undefined4 *)(param_1 + 0x70) = 0;
            *(undefined4 *)(param_1 + 0x74) = 0;
            *(undefined4 *)(param_1 + 0x78) = 0;
            *(undefined4 *)(param_1 + 0x7c) = 0;
            *(undefined *)(param_1 + 0xc98) = 0;
            memset((void *)(param_1 + 0xc99),0,0x20);
            *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) & 0xfffffff7;
          }
        }
        else if (*(char *)(param_1 + 0xc98) == '\0') {
          *(byte *)(param_1 + 0xc98) = bVar1;
          memcpy((void *)(param_1 + 0xc99),pbVar30,uVar29);
          local_30[0] = local_30[0] + uVar29;
        }
        else {
          iVar26 = memcmp((void *)(param_1 + 0xc99),pbVar30,uVar29);
          if (iVar26 == 0) {
            local_30[0] = pbVar30 + uVar29;
            *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) | 8;
          }
          else {
            uVar31 = sslGetCipherSpec(param_1,0);
            *(undefined4 *)(param_1 + 0xd10) = uVar31;
            *(undefined4 *)(param_1 + 0x50) = 0;
            *(undefined4 *)(param_1 + 0x54) = 0;
            *(undefined4 *)(param_1 + 0x58) = 0;
            *(undefined4 *)(param_1 + 0x5c) = 0;
            *(undefined4 *)(param_1 + 0x60) = 0;
            *(undefined4 *)(param_1 + 100) = 0;
            *(undefined4 *)(param_1 + 0x68) = 0;
            *(undefined4 *)(param_1 + 0x6c) = 0;
            *(undefined4 *)(param_1 + 0x70) = 0;
            *(undefined4 *)(param_1 + 0x74) = 0;
            *(undefined4 *)(param_1 + 0x78) = 0;
            *(undefined4 *)(param_1 + 0x7c) = 0;
            *(byte *)(param_1 + 0xc98) = bVar1;
            memcpy((void *)(param_1 + 0xc99),local_30[0],uVar29);
            local_30[0] = local_30[0] + uVar29;
            *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) & 0xfffffff7;
          }
        }
        pbVar30 = local_30[0] + 2;
        if (1 < (int)param_4 - (int)local_30[0]) {
          uVar29 = (uint)*local_30[0] * 0x100 + (uint)local_30[0][1];
          local_30[0] = pbVar30;
          if ((*(uint *)(param_1 + 0xd2c) >> 3 & 1) == 0) {
            iVar26 = sslGetCipherSpec(param_1,uVar29 & 0xffff);
            *(int *)(param_1 + 0xd10) = iVar26;
            if (iVar26 == 0) goto LAB_0045cafc;
          }
          else {
            puVar24 = *(ushort **)(param_1 + 0xd10);
            if (puVar24 == (ushort *)0x0) {
              _psTraceStr("psAssert %s","hsDecode.c");
              _psTraceInt(&DAT_0049016c,0x705);
              _psError("ssl->cipher != NULL");
              puVar24 = *(ushort **)(param_1 + 0xd10);
            }
            if (*puVar24 != uVar29) {
LAB_0045cafc:
              uVar31 = 0x28;
              goto LAB_0045c7ec;
            }
          }
          matrixSslSetKexFlags(param_1);
          if ((int)param_4 - (int)local_30[0] < 1) {
            uVar31 = 0x2f;
            goto LAB_0045c7ec;
          }
          bVar1 = *local_30[0];
          local_30[0] = local_30[0] + 1;
          if (bVar1 == 0) {
            if (((local_30[0] != param_4) && ((int)local_30[0] - (int)pbVar23 < param_2)) &&
               (iVar26 = parseServerHelloExtensions
                                   (param_1,param_2,pbVar23,local_30,
                                    (int)local_30[0] - (int)param_4 & 0xffff), iVar26 < 0)) {
              return iVar26;
            }
            uVar29 = *(uint *)(param_1 + 0x1230);
            if (((uVar29 >> 0xb & 1) != 1) || (uVar31 = 0x28, (uVar29 >> 0x14 & 1) != 0)) {
              if (((*(ushort *)(param_1 + 0xd02) & 1) != 0) || ((uVar29 >> 1 & 1) != 0)) {
                *(undefined4 *)(param_1 + 0xd00) = 0x4000;
              }
              iVar26 = *(int *)(param_1 + 0xcbc);
              if ((iVar26 != 0) && (*(short *)(iVar26 + 0x5c) == 2)) {
                *(undefined2 *)(iVar26 + 0x5c) = 4;
              }
              if ((*(uint *)(param_1 + 0xd2c) >> 3 & 1) == 0) {
                uVar22 = 0xb;
                if ((*(uint *)(param_1 + 0xd2c) >> 0x12 & 1) != 0) {
                  uVar22 = 0xc;
                }
              }
              else {
                iVar26 = sslCreateKeys(param_1);
                if (iVar26 < 0) {
                  uVar31 = 0x50;
                  goto LAB_0045c7ec;
                }
                uVar22 = 0x14;
              }
              *(undefined *)(param_1 + 0xd38) = uVar22;
              *param_3 = local_30[0];
              *(undefined *)(param_1 + 0xd39) = 2;
              return 0;
            }
            goto LAB_0045c7ec;
          }
        }
      }
    }
  }
  uVar31 = 0x32;
LAB_0045c7ec:
  *(undefined4 *)(param_1 + 0xd30) = uVar31;
  return -0xc;
}



undefined4 parseServerKeyExchange(int param_1,undefined4 param_2,char **param_3,int param_4)

{
  byte *pbVar1;
  char cVar2;
  int iVar3;
  void *pvVar4;
  int iVar5;
  uint uVar6;
  char *__src;
  char *pcVar7;
  char *pcVar8;
  uint uVar9;
  char *pcVar10;
  code *pcVar11;
  undefined4 uVar12;
  undefined auStack_140 [208];
  undefined auStack_70 [64];
  undefined4 local_30;
  uint local_2c;
  
  uVar6 = *(uint *)(param_1 + 0xd2c);
  uVar12 = *(undefined4 *)(param_1 + 0x1250);
  __src = *param_3;
  if ((uVar6 >> 0x11 & 1) != 0) {
    if ((uVar6 >> 0x12 & 1) != 0) {
      if (param_4 - (int)__src < 2) goto LAB_0045d2dc;
      *(undefined *)(param_1 + 0xc30) = 0;
      pbVar1 = (byte *)(__src + 1);
      __src = __src + 2;
      uVar9 = (uint)*pbVar1;
      *(byte *)(param_1 + 0xc30) = *pbVar1;
      if (uVar9 != 0) {
        if ((param_4 - (int)__src & 0xffffU) < uVar9) goto LAB_0045d2dc;
        pvVar4 = malloc(uVar9);
        *(void **)(param_1 + 0xc2c) = pvVar4;
        if (pvVar4 == (void *)0x0) {
          return 0xfffffff8;
        }
        memcpy(pvVar4,__src,(uint)*(byte *)(param_1 + 0xc30));
        uVar6 = *(uint *)(param_1 + 0xd2c);
        __src = __src + *(byte *)(param_1 + 0xc30);
      }
    }
    pcVar7 = __src;
    pcVar8 = (char *)0x0;
    pcVar10 = (char *)0x0;
    if ((uVar6 >> 0x13 & 1) != 0) {
      if (param_4 - (int)__src < 4) goto LAB_0045d2dc;
      if (*__src != '\x03') {
LAB_0045d380:
        *(undefined4 *)(param_1 + 0xd30) = 0x2f;
        return 0xfffffff4;
      }
      local_2c = (uint)CONCAT11(__src[1],__src[2]);
      iVar3 = getEccParamById(local_2c,&local_30);
      pcVar7 = __src + 4;
      if (iVar3 < 0) goto LAB_0045d380;
      local_2c = (uint)(byte)__src[3];
      if (param_4 - (int)pcVar7 < (int)local_2c) goto LAB_0045d2dc;
      iVar3 = psEccNewKey(*(undefined4 *)(param_1 + 0xc90),param_1 + 0xc38,local_30);
      if (iVar3 < 0) {
        return 0xfffffff8;
      }
      iVar3 = psEccX963ImportKey(*(undefined4 *)(param_1 + 0xc90),pcVar7,local_2c & 0xffff,
                                 *(undefined4 *)(param_1 + 0xc38),local_30);
      if (iVar3 < 0) goto LAB_0045d2dc;
      pcVar7 = pcVar7 + local_2c;
      pcVar8 = __src;
      pcVar10 = pcVar7;
    }
    if (param_4 - (int)pcVar7 < 2) goto LAB_0045d2dc;
    uVar6 = *(uint *)(param_1 + 0xd2c);
    iVar3 = 0;
    if ((uVar6 >> 0xd & 1) != 0) {
      cVar2 = *pcVar7;
      pcVar7 = pcVar7 + 2;
      iVar3 = 0x20;
      if ((((cVar2 != '\x04') && (iVar3 = 0x30, cVar2 != '\x05')) && (iVar3 = 0x40, cVar2 != '\x06')
          ) && (iVar3 = 0x14, cVar2 != '\x02')) {
        return 0xfffffff4;
      }
    }
    __src = pcVar7 + 2;
    uVar9 = (uint)CONCAT11(*pcVar7,pcVar7[1]);
    if ((uint)(param_4 - (int)__src) < uVar9) goto LAB_0045d2dc;
    if ((uVar6 >> 0xf & 1) != 0) {
      if ((uVar6 >> 0xd & 1) == 0) {
        psMd5Sha1Init(auStack_140);
        psMd5Sha1Update(auStack_140,param_1 + 0x10,0x20);
        psMd5Sha1Update(auStack_140,param_1 + 0x30,0x20);
        psMd5Sha1Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
        pcVar11 = psMd5Sha1Final;
      }
      else if (iVar3 == 0x20) {
        psSha256Init(auStack_140);
        psSha256Update(auStack_140,param_1 + 0x10,0x20);
        psSha256Update(auStack_140,param_1 + 0x30,0x20);
        psSha256Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
        pcVar11 = psSha256Final;
      }
      else if (iVar3 == 0x30) {
        psSha384Init(auStack_140);
        psSha384Update(auStack_140,param_1 + 0x10,0x20);
        psSha384Update(auStack_140,param_1 + 0x30,0x20);
        psSha384Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
        pcVar11 = psSha384Final;
      }
      else if (iVar3 == 0x40) {
        psSha512Init(auStack_140);
        psSha512Update(auStack_140,param_1 + 0x10,0x20);
        psSha512Update(auStack_140,param_1 + 0x30,0x20);
        psSha512Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
        pcVar11 = psSha512Final;
      }
      else {
        if (iVar3 != 0x14) {
          return 0xfffffff4;
        }
        psSha1Init(auStack_140);
        psSha1Update(auStack_140,param_1 + 0x10,0x20);
        psSha1Update(auStack_140,param_1 + 0x30,0x20);
        psSha1Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
        pcVar11 = psSha1Final;
      }
      (*pcVar11)(auStack_140,param_2);
      if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
        iVar5 = *(int *)(param_1 + 600);
        pcVar11 = psRsaDecryptPub;
        iVar3 = 0x24;
      }
      else {
        iVar5 = *(int *)(param_1 + 600);
        pcVar11 = pubRsaDecryptSignedElement;
      }
      local_2c = (*pcVar11)(0,iVar5 + 0x28,__src,uVar9,auStack_70,iVar3,uVar12);
      if ((int)local_2c < 0) goto LAB_0045d390;
      iVar5 = memcmpct(auStack_70,param_2,iVar3);
      __src = __src + uVar9;
      if (iVar5 != 0) goto LAB_0045d390;
      uVar6 = *(uint *)(param_1 + 0xd2c);
    }
    if ((uVar6 >> 0x10 & 1) != 0) {
      if (((uVar6 >> 0xd & 1) == 0) || (iVar3 != 0x20)) {
        if (((uVar6 >> 0xd & 1) == 0) || (iVar3 != 0x30)) {
          if (iVar3 == 0x40) {
            psSha512Init(auStack_140);
            psSha512Update(auStack_140,param_1 + 0x10,0x20);
            psSha512Update(auStack_140,param_1 + 0x30,0x20);
            psSha512Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
            pcVar11 = psSha512Final;
          }
          else {
            if (((2 < *(byte *)(param_1 + 0xd3e)) && (*(byte *)(param_1 + 0xd3e) != 0xff)) &&
               (((uVar6 >> 0xd & 1) == 0 || (iVar3 != 0x14)))) {
              return 0xfffffff4;
            }
            psSha1Init(auStack_140);
            psSha1Update(auStack_140,param_1 + 0x10,0x20);
            psSha1Update(auStack_140,param_1 + 0x30,0x20);
            psSha1Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
            pcVar11 = psSha1Final;
            iVar3 = 0x14;
          }
        }
        else {
          psSha384Init(auStack_140);
          psSha384Update(auStack_140,param_1 + 0x10,0x20);
          psSha384Update(auStack_140,param_1 + 0x30,0x20);
          psSha384Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
          pcVar11 = psSha384Final;
        }
      }
      else {
        psSha256Init(auStack_140);
        psSha256Update(auStack_140,param_1 + 0x10,0x20);
        psSha256Update(auStack_140,param_1 + 0x30,0x20);
        psSha256Update(auStack_140,pcVar8,(int)pcVar10 - (int)pcVar8);
        pcVar11 = psSha256Final;
      }
      (*pcVar11)(auStack_140,param_2);
      local_2c = 0;
      iVar3 = psEccDsaVerify(0,*(int *)(param_1 + 600) + 0x28,param_2,iVar3,__src,uVar9,&local_2c,
                             uVar12);
      if ((iVar3 != 0) || (__src = __src + uVar9, local_2c != 1)) {
LAB_0045d390:
        *(undefined4 *)(param_1 + 0xd30) = 0x2a;
        return 0xfffffff4;
      }
      uVar6 = *(uint *)(param_1 + 0xd2c);
    }
    *(undefined *)(param_1 + 0xd38) = 0xe;
  }
  if ((uVar6 >> 0x12 & 1) == 0) {
LAB_0045d1a8:
    *param_3 = __src;
    *(undefined *)(param_1 + 0xd39) = 0xc;
    return 0;
  }
  if (1 < param_4 - (int)__src) {
    *(undefined *)(param_1 + 0xc30) = 0;
    pbVar1 = (byte *)(__src + 1);
    uVar6 = (uint)*pbVar1;
    __src = __src + 2;
    *(byte *)(param_1 + 0xc30) = *pbVar1;
    if (uVar6 <= (uint)(param_4 - (int)__src)) {
      if (uVar6 == 0) {
        *(undefined *)(param_1 + 0xd38) = 0xe;
      }
      else {
        pvVar4 = malloc(uVar6);
        *(void **)(param_1 + 0xc2c) = pvVar4;
        if (pvVar4 == (void *)0x0) {
          return 0xfffffff8;
        }
        memcpy(pvVar4,__src,(uint)*(byte *)(param_1 + 0xc30));
        __src = __src + *(byte *)(param_1 + 0xc30);
        *(undefined *)(param_1 + 0xd38) = 0xe;
      }
      goto LAB_0045d1a8;
    }
  }
LAB_0045d2dc:
  *(undefined4 *)(param_1 + 0xd30) = 0x32;
  return 0xfffffff4;
}



undefined4 parseCertificateStatus(int param_1,undefined4 param_2,char **param_3,int param_4)

{
  undefined uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  char *pcVar6;
  uint uVar7;
  undefined auStack_138 [248];
  undefined4 local_40;
  char *local_20 [2];
  
  pcVar6 = *param_3;
  if (3 < param_4 - (int)pcVar6) {
    if (*pcVar6 != '\x01') {
      *(undefined4 *)(param_1 + 0xd30) = 0x2f;
      return 0xfffffff4;
    }
    local_20[0] = pcVar6 + 4;
    uVar7 = (uint)(byte)pcVar6[1] << 0x10 | (uint)(byte)pcVar6[2] << 8 | (uint)(byte)pcVar6[3];
    if ((int)uVar7 <= param_4 - (int)local_20[0]) {
      memset(auStack_138,0,0x114);
      iVar2 = psOcspParseResponse(*(undefined4 *)(param_1 + 0xc90),uVar7,local_20,param_4,
                                  auStack_138);
      if (-1 < iVar2) {
        uVar4 = *(undefined4 *)(*(int *)(param_1 + 0xc48) + 0x78);
        uVar3 = *(undefined4 *)(param_1 + 0xc90);
        uVar5 = *(undefined4 *)(param_1 + 600);
        *param_3 = local_20[0];
        iVar2 = psOcspResponseValidateOld(uVar3,uVar4,uVar5,auStack_138);
        if (-1 < iVar2) {
          psX509FreeCert(local_40);
          uVar1 = 0xe;
          if ((*(uint *)(param_1 + 0xd2c) >> 0x11 & 1) != 0) {
            uVar1 = 0xc;
          }
          *(undefined *)(param_1 + 0xd38) = uVar1;
          *(undefined *)(param_1 + 0xd39) = 0x16;
          return 0;
        }
      }
      psX509FreeCert(local_40);
      *(undefined4 *)(param_1 + 0xd30) = 0x71;
      return 0xfffffff4;
    }
  }
  *(undefined4 *)(param_1 + 0xd30) = 0x32;
  return 0xfffffff4;
}



undefined4 parseServerHelloDone(int param_1,int param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  
  uVar4 = *param_3;
  uVar3 = *(undefined4 *)(param_1 + 0x1250);
  uVar1 = 0x2f;
  if (param_2 == 0) {
    if (((*(uint *)(param_1 + 0xd2c) >> 0x11 & 1) != 0) &&
       ((*(uint *)(param_1 + 0xd2c) >> 0x13 & 1) != 0)) {
      iVar2 = psEccNewKey(*(undefined4 *)(param_1 + 0xc3c),param_1 + 0xc34,
                          *(undefined4 *)(*(int *)(param_1 + 0xc38) + 0x34));
      if (iVar2 < 0) {
        return 0xfffffff8;
      }
      iVar2 = matrixSslGenEphemeralEcKey
                        (*(undefined4 *)(param_1 + 0xc48),*(undefined4 *)(param_1 + 0xc34),
                         *(undefined4 *)(*(int *)(param_1 + 0xc38) + 0x34),uVar3);
      if (iVar2 < 0) {
        psEccDeleteKey(param_1 + 0xc34);
        uVar1 = 0x50;
        goto LAB_0045d914;
      }
    }
    *(undefined *)(param_1 + 0xd38) = 0x14;
    uVar3 = 0xffffffcb;
    *param_3 = uVar4;
    *(undefined *)(param_1 + 0xd39) = 0xe;
  }
  else {
LAB_0045d914:
    uVar3 = 0xfffffff4;
    *(undefined4 *)(param_1 + 0xd30) = uVar1;
  }
  return uVar3;
}



undefined4 parseCertificateRequest(int param_1,int param_2,byte **param_3,int param_4)

{
  byte bVar1;
  bool bVar2;
  bool bVar3;
  uint uVar4;
  uint uVar5;
  byte *pbVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  byte *pbVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  int iVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  
  if (param_2 < 4) {
    *(undefined4 *)(param_1 + 0xd30) = 0x2f;
    return 0xfffffff4;
  }
  pbVar6 = *param_3 + 1;
  uVar9 = (uint)**param_3;
  pbVar10 = pbVar6 + uVar9;
  if (param_4 - (int)pbVar6 < (int)uVar9) goto LAB_0045dd20;
  uVar9 = *(uint *)(param_1 + 0xd2c);
  bVar3 = false;
  if ((uVar9 >> 0xd & 1) != 0) {
    if (param_4 - (int)pbVar10 < 2) goto LAB_0045dd20;
    pbVar6 = pbVar10 + 2;
    uVar12 = (uint)CONCAT11(*pbVar10,pbVar10[1]);
    if (param_4 - (int)pbVar6 < (int)uVar12) goto LAB_0045dd20;
    uVar4 = 0;
    if (1 < uVar12) {
      do {
        pbVar10 = pbVar6 + 1;
        uVar12 = uVar12 - 2;
        uVar5 = 1 << (*pbVar6 & 7) & 0xff;
        pbVar6 = pbVar6 + 2;
        if (*pbVar10 != 1) {
          uVar5 = uVar5 << 8;
        }
        if ((*(ushort *)(param_1 + 0xd4c) & uVar5) != 0) {
          uVar4 = uVar4 | uVar5;
        }
      } while (1 < (int)uVar12);
    }
    bVar3 = true;
    if (*(int *)(param_1 + 0xc48) == 0) {
LAB_0045dd64:
      bVar3 = false;
    }
    else {
      iVar14 = *(int *)(*(int *)(param_1 + 0xc48) + 0x74);
      if (iVar14 == 0) goto LAB_0045dd64;
      uVar15 = uVar4 >> 0xc & 1;
      uVar8 = uVar4 >> 4 & 1;
      uVar5 = uVar4 >> 2 & 1;
      uVar16 = uVar4 >> 5 & 1;
      uVar17 = uVar4 >> 0xe & 1;
      uVar11 = uVar4 >> 10 & 1;
      uVar13 = uVar4 >> 0xd & 1;
      do {
        if ((((*(int *)(iVar14 + 0x1bc) == 0x285) && (uVar5 == 0)) && (uVar16 == 0)) &&
           ((uVar8 == 0 && ((uVar4 >> 1 & 1) == 0)))) {
          bVar3 = false;
        }
        iVar7 = *(int *)(iVar14 + 8);
        if (((iVar7 == 0x689) || (iVar7 == 0x288)) && (uVar5 == 0)) {
          bVar3 = false;
        }
        if ((iVar7 == 0x68f) && (uVar8 == 0)) {
          bVar3 = false;
        }
        if ((iVar7 == 0x690) && (uVar16 == 0)) {
          bVar3 = false;
        }
        if ((iVar7 == 0x691) && ((uVar4 >> 6 & 1) == 0)) {
          bVar3 = false;
        }
        if ((((*(int *)(iVar14 + 0x1bc) == 0x206) && (uVar11 == 0)) && (uVar13 == 0)) &&
           ((uVar17 == 0 && (uVar15 == 0)))) {
          bVar3 = false;
        }
        if ((iVar7 == 0x208) && (uVar11 == 0)) {
          bVar3 = false;
        }
        if ((iVar7 == 0x20c) && (uVar15 == 0)) {
          bVar3 = false;
        }
        if ((iVar7 == 0x20d) && (uVar13 == 0)) {
          bVar3 = false;
        }
        if ((iVar7 == 0x20e) && (uVar17 == 0)) {
          bVar3 = false;
        }
        iVar14 = *(int *)(iVar14 + 0x31c);
      } while (iVar14 != 0);
    }
    pbVar10 = pbVar6 + uVar12;
  }
  uVar12 = 0;
  if (1 < param_4 - (int)pbVar10) {
    bVar1 = *pbVar10;
    pbVar6 = pbVar10 + 1;
    pbVar10 = pbVar10 + 2;
    uVar12 = (uint)CONCAT11(bVar1,*pbVar6);
    if (param_4 - (int)pbVar10 < (int)uVar12) {
LAB_0045dd20:
      *(undefined4 *)(param_1 + 0xd30) = 0x32;
      return 0xfffffff4;
    }
  }
  iVar14 = *(int *)(param_1 + 0xc48);
  if ((iVar14 == 0) || (*(int *)(iVar14 + 0x74) == 0)) {
    *(undefined4 *)(param_1 + 0x260) = 0;
  }
  else {
    *(undefined4 *)(param_1 + 0x260) = 0xfe;
  }
  if (2 < uVar12) {
    if (iVar14 == 0) {
      do {
        pbVar6 = pbVar10 + 2;
        uVar4 = (uint)CONCAT11(*pbVar10,pbVar10[1]);
        bVar2 = (int)uVar12 < (int)uVar4;
        uVar12 = (uVar12 - 2) - uVar4;
        pbVar10 = pbVar6 + uVar4;
        if ((((uint)(param_4 - (int)pbVar6) < uVar4) || (uVar4 == 0)) || (bVar2)) goto LAB_0045dd20;
      } while (2 < (int)uVar12);
    }
    else {
      do {
        pbVar6 = pbVar10 + 2;
        uVar4 = (uint)CONCAT11(*pbVar10,pbVar10[1]);
        if ((((uint)(param_4 - (int)pbVar6) < uVar4) || (uVar4 == 0)) || ((int)uVar12 < (int)uVar4))
        goto LAB_0045dd20;
        iVar7 = *(int *)(iVar14 + 0x74);
        if ((iVar7 == 0) || (*(ushort *)(iVar7 + 0x108) != uVar4)) {
          uVar12 = (uVar12 - 2) - uVar4;
        }
        else {
          iVar7 = memcmp(*(void **)(iVar7 + 0x104),pbVar6,uVar4);
          uVar12 = (uVar12 - 2) - uVar4;
          if (iVar7 == 0) {
            *(undefined4 *)(param_1 + 0x260) = 1;
          }
        }
        pbVar10 = pbVar6 + uVar4;
      } while (2 < (int)uVar12);
    }
  }
  if (((uVar9 >> 0xd & 1) != 0) && (!bVar3)) {
    *(undefined4 *)(param_1 + 0x260) = 0;
  }
  *(undefined *)(param_1 + 0xd38) = 0xe;
  *param_3 = pbVar10;
  *(undefined *)(param_1 + 0xd39) = 0xd;
  return 0;
}



undefined4 parseFinished(int param_1,int param_2,undefined4 param_3,int *param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  
  iVar3 = *param_4;
  uVar4 = 0;
  if (0x30 < param_2) {
    _psTraceStr("psAssert %s","hsDecode.c");
    _psTraceInt(&DAT_0049016c,0xc24);
    _psError("hsLen <= SHA384_HASH_SIZE");
  }
  if ((*(uint *)(param_1 + 0xd2c) >> 1 & 1) == 0) {
    *(undefined4 *)(param_1 + 0xd30) = 10;
    return 0xfffffff4;
  }
  iVar1 = 0xc;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xb & 1) == 0) {
    iVar1 = 0x24;
  }
  if ((param_2 != iVar1) || (param_5 - iVar3 < param_2)) {
    *(undefined4 *)(param_1 + 0xd30) = 0x32;
    return 0xfffffff4;
  }
  iVar1 = memcmpct(iVar3,param_3,param_2);
  if (iVar1 != 0) {
    *(undefined4 *)(param_1 + 0xd30) = 0x33;
    return 0xfffffff4;
  }
  uVar2 = *(uint *)(param_1 + 0xd2c);
  *(undefined *)(param_1 + 0xd38) = 0xff;
  if ((uVar2 & 1) == 0) {
    iVar1 = *(int *)(param_1 + 0xcbc);
    if ((iVar1 != 0) && (*(short *)(iVar1 + 0x5e) != 0)) {
      *(undefined2 *)(iVar1 + 0x5c) = 5;
    }
    if ((uVar2 >> 3 & 1) == 0) goto LAB_0045df58;
  }
  else if ((uVar2 >> 3 & 1) != 0) goto LAB_0045df58;
  uVar4 = 0xffffffcb;
LAB_0045df58:
  if (((*(uint *)(param_1 + 0xcfc) >> 3 & 1) == 0) && (*(int *)(param_1 + 600) != 0)) {
    psX509FreeCert();
    uVar2 = *(uint *)(param_1 + 0xd2c);
    *(undefined4 *)(param_1 + 600) = 0;
  }
  if ((uVar2 >> 0xe & 1) != 0) {
    zeroSixByte(param_1 + 0xddd);
    *(undefined4 *)(param_1 + 0xde8) = 1;
    if (*(void **)(param_1 + 0xd04) != (void *)0x0) {
      free(*(void **)(param_1 + 0xd04));
      *(undefined4 *)(param_1 + 0xd04) = 0;
    }
  }
  if (*(void **)(param_1 + 0x80) != (void *)0x0) {
    free(*(void **)(param_1 + 0x80));
    *(undefined4 *)(param_1 + 0x80) = 0;
  }
  if (*(void **)(param_1 + 0x1220) != (void *)0x0) {
    free(*(void **)(param_1 + 0x1220));
    *(undefined4 *)(param_1 + 0x1220) = 0;
  }
  if (*(void **)(param_1 + 0x1224) != (void *)0x0) {
    free(*(void **)(param_1 + 0x1224));
    *(undefined4 *)(param_1 + 0x1224) = 0;
  }
  if (*(void **)(param_1 + 0xc2c) != (void *)0x0) {
    free(*(void **)(param_1 + 0xc2c));
    *(undefined4 *)(param_1 + 0xc2c) = 0;
  }
  *param_4 = iVar3 + param_2;
  *(undefined *)(param_1 + 0xd39) = 0x14;
  *(undefined4 *)(param_1 + 0xc90) = 0;
  return uVar4;
}



undefined4 parseCertificate(int param_1,byte **param_2,int param_3)

{
  undefined uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  byte *pbVar6;
  byte *pbVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  undefined4 uVar11;
  int local_30;
  undefined auStack_2c [4];
  
  pbVar6 = *param_2;
  uVar11 = *(undefined4 *)(param_1 + 0x1250);
  if (param_3 - (int)pbVar6 < 3) {
LAB_0045e50c:
    uVar11 = 0x32;
    goto LAB_0045e510;
  }
  uVar4 = (uint)*pbVar6 << 0x10 | (uint)pbVar6[1] << 8 | (uint)pbVar6[2];
  pbVar6 = pbVar6 + 3;
  if (uVar4 == 0) {
    if ((*(uint *)(param_1 + 0xd3c) & 0xffff00) == 0x300) {
      *(undefined4 *)(param_1 + 0xd30) = 0x29;
      return 0xfffffff4;
    }
    goto LAB_0045e708;
  }
  if (param_3 - (int)pbVar6 < 3) goto LAB_0045e50c;
  iVar9 = 0;
  iVar3 = 0;
  if (2 < uVar4) {
    do {
      pbVar7 = pbVar6 + 3;
      uVar8 = (uint)*pbVar6 << 0x10 | (uint)pbVar6[1] << 8 | (uint)pbVar6[2];
      if (((uint)(param_3 - (int)pbVar7) < uVar8) || ((int)(uVar4 - 3) < (int)uVar8))
      goto LAB_0045e50c;
      iVar2 = psX509ParseCert(*(undefined4 *)(param_1 + 0xc90),pbVar7,uVar8,&local_30,
                              (*(uint *)(param_1 + 0xcfc) >> 4 & 1) != 0);
      if (iVar2 < 0) {
        psX509FreeCert(local_30);
        if (iVar2 == -8) {
          *(undefined4 *)(param_1 + 0xd30) = 0x50;
          return 0xfffffff4;
        }
        goto LAB_0045e708;
      }
      iVar9 = iVar9 + 1;
      pbVar6 = pbVar7 + iVar2;
      if (iVar9 == 1) {
        *(int *)(param_1 + 600) = local_30;
      }
      else {
        *(int *)(iVar3 + 0x31c) = local_30;
      }
      uVar4 = (uVar4 - 3) - uVar8;
      iVar3 = local_30;
    } while (2 < (int)uVar4);
  }
  if (((*(uint *)(param_1 + 0xd2c) & 1) == 0) &&
     (iVar3 = csCheckCertAgainstCipherSuite
                        (*(undefined *)(*(int *)(param_1 + 600) + 0x96),
                         *(undefined2 *)(*(int *)(param_1 + 0xd10) + 2)), iVar3 == 0)) {
    uVar11 = 0x2b;
    goto LAB_0045e510;
  }
  uVar5 = 0;
  if (*(int *)(param_1 + 0xc48) != 0) {
    uVar5 = *(undefined4 *)(*(int *)(param_1 + 0xc48) + 0x78);
  }
  iVar3 = matrixValidateCertsExt
                    (*(undefined4 *)(param_1 + 0xc90),*(undefined4 *)(param_1 + 600),uVar5,
                     *(undefined4 *)(param_1 + 0xcc0),auStack_2c,uVar11,
                     *(undefined4 *)(param_1 + 0x124c),param_1 + 0x123c);
  if (iVar3 == -8) {
LAB_0045e754:
    uVar11 = 0x50;
LAB_0045e510:
    *(undefined4 *)(param_1 + 0xd30) = uVar11;
    return 0xfffffff4;
  }
  local_30 = *(int *)(param_1 + 600);
  iVar9 = 0;
  if (local_30 == 0) {
    iVar2 = *(int *)(param_1 + 0xd30);
LAB_0045e54c:
    if (iVar2 == 0xff) goto LAB_0045e444;
LAB_0045e558:
    if (iVar3 < 0) goto LAB_0045e46c;
    iVar3 = *(int *)(param_1 + 0x25c);
  }
  else {
    do {
      iVar2 = *(int *)(param_1 + 0x1248);
      iVar9 = iVar9 + 1;
      if ((0 < iVar2) &&
         ((iVar2 < iVar9 ||
          ((iVar2 == iVar9 && (iVar2 = memcmpct(local_30 + 0x128,local_30 + 0xa4,0x84), iVar2 != 0))
          )))) {
        *(undefined4 *)(param_1 + 0xd30) = 0x30;
        *(uint *)(local_30 + 0x2b4) = *(uint *)(local_30 + 0x2b4) | 0x10;
        *(uint *)(local_30 + 0x2b0) = *(uint *)(local_30 + 0x2b0) | 0xffffffda;
      }
      iVar2 = *(int *)(param_1 + 0xd30);
      if (iVar2 != 0xff) goto LAB_0045e54c;
      switch(*(undefined4 *)(local_30 + 0x2b0)) {
      case 0xffffffdb:
        iVar2 = 0x2d;
        if (((*(uint *)(local_30 + 0x2b4) >> 3 & 1) == 0) &&
           (iVar2 = 0x2e, (*(uint *)(local_30 + 0x2b4) >> 2 & 1) == 0)) {
          iVar10 = *(int *)(local_30 + 0x31c);
          iVar2 = 0x2f;
          goto joined_r0x0045e680;
        }
        goto LAB_0045e420;
      default:
        break;
      case 0xffffffdd:
        iVar2 = 0x2c;
LAB_0045e420:
        *(int *)(param_1 + 0xd30) = iVar2;
        break;
      case 0xffffffdf:
      case 0xffffffe0:
        iVar10 = *(int *)(local_30 + 0x31c);
        iVar2 = 0x30;
joined_r0x0045e680:
        if (iVar10 == 0) goto LAB_0045e420;
      case 0xffffffd9:
      case 0xffffffda:
      case 0xffffffde:
        iVar2 = 0x2a;
        *(undefined4 *)(param_1 + 0xd30) = 0x2a;
      }
      local_30 = *(int *)(local_30 + 0x31c);
    } while (local_30 != 0);
    if (iVar2 != 0xff) goto LAB_0045e558;
LAB_0045e444:
    if ((*(int *)(param_1 + 0xc48) != 0) && (*(int *)(*(int *)(param_1 + 0xc48) + 0x78) != 0))
    goto LAB_0045e558;
    iVar2 = 0x30;
    *(undefined4 *)(param_1 + 0xd30) = 0x30;
LAB_0045e46c:
    iVar3 = *(int *)(param_1 + 0x25c);
    if (iVar3 == 0) {
      if (iVar2 != 0xff) {
        return 0xfffffff4;
      }
LAB_0045e708:
      *(undefined4 *)(param_1 + 0xd30) = 0x2a;
      return 0xfffffff4;
    }
  }
  iVar3 = matrixUserCertValidator(param_1,iVar2,*(undefined4 *)(param_1 + 600),iVar3);
  if (iVar3 == 0xfe) {
    *(undefined4 *)(param_1 + 0xc40) = 1;
  }
  else {
    *(undefined4 *)(param_1 + 0xc40) = 0;
    if (0 < iVar3) {
      *(int *)(param_1 + 0xd30) = iVar3;
      return 0xfffffff4;
    }
    if (iVar3 < 0) goto LAB_0045e754;
  }
  if (*(int *)(param_1 + 0xd30) != 0xff) {
    *(undefined4 *)(param_1 + 0xd30) = 0xff;
  }
  if ((*(uint *)(param_1 + 0xd2c) & 1) == 0) {
    uVar1 = 0xe;
    if ((*(uint *)(param_1 + 0xd2c) >> 0x11 & 1) == 0) {
      uVar4 = *(uint *)(param_1 + 0x1230);
    }
    else {
      uVar4 = *(uint *)(param_1 + 0x1230);
      uVar1 = 0xc;
    }
    if ((uVar4 & 0x300000) == 0) {
      *(undefined *)(param_1 + 0xd38) = uVar1;
      goto LAB_0045e5c4;
    }
    uVar1 = 0x16;
  }
  else {
    uVar1 = 0x10;
  }
  *(undefined *)(param_1 + 0xd38) = uVar1;
LAB_0045e5c4:
  *param_2 = pbVar6;
  *(undefined *)(param_1 + 0xd39) = 0xb;
  return 0;
}



undefined4 sslInitHSHash(int param_1)

{
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) == 0)) {
    psMd5Sha1Init(param_1 + 0x878);
    psSha256Init(param_1 + 0x938);
    psSha1Init(param_1 + 0x9a8);
    psSha384Init(param_1 + 0xa08);
    psSha512Init(param_1 + 0xad8);
  }
  return 0;
}



undefined4 sslUpdateHSHash(int param_1,undefined4 param_2,undefined2 param_3)

{
  if (((*(uint *)(param_1 + 0xd2c) >> 0xe & 1) == 0) || (*(int *)(param_1 + 0xdfc) == 0)) {
    if (((*(uint *)(param_1 + 0xd3c) & 0xffff00) == 0) ||
       ((*(char *)(param_1 + 0xd3e) == -3 || (*(char *)(param_1 + 0xd3e) == '\x03')))) {
      psSha256Update(param_1 + 0x938,param_2,param_3);
      psSha1Update(param_1 + 0x9a8,param_2,param_3);
      psSha384Update(param_1 + 0xa08,param_2,param_3);
      psSha512Update(param_1 + 0xad8,param_2,param_3);
    }
    psMd5Sha1Update(param_1 + 0x878,param_2,param_3);
  }
  return 0;
}



undefined4 sslSha1RetrieveHSHash(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  
  uVar1 = *(undefined4 *)(param_1 + 0xbac);
  uVar4 = *(undefined4 *)(param_1 + 3000);
  uVar2 = *(undefined4 *)(param_1 + 0xbb0);
  uVar3 = *(undefined4 *)(param_1 + 0xbb4);
  *param_2 = *(undefined4 *)(param_1 + 0xba8);
  param_2[1] = uVar1;
  param_2[2] = uVar2;
  param_2[3] = uVar3;
  param_2[4] = uVar4;
  return 0x14;
}



undefined4 sslSha384RetrieveHSHash(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  
  puVar4 = (undefined4 *)(param_1 + 0xbbc);
  do {
    uVar1 = puVar4[1];
    uVar2 = puVar4[2];
    uVar3 = puVar4[3];
    *param_2 = *puVar4;
    param_2[1] = uVar1;
    param_2[2] = uVar2;
    puVar4 = puVar4 + 4;
    param_2[3] = uVar3;
    param_2 = param_2 + 4;
  } while (puVar4 != (undefined4 *)(param_1 + 0xbec));
  return 0x30;
}



undefined4 sslSha512RetrieveHSHash(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  
  puVar4 = (undefined4 *)(param_1 + 0xbec);
  do {
    uVar1 = puVar4[1];
    uVar2 = puVar4[2];
    uVar3 = puVar4[3];
    *param_2 = *puVar4;
    param_2[1] = uVar1;
    param_2[2] = uVar2;
    puVar4 = puVar4 + 4;
    param_2[3] = uVar3;
    param_2 = param_2 + 4;
  } while (puVar4 != (undefined4 *)(param_1 + 0xc2c));
  return 0x40;
}



void sslSha1SnapshotHSHash(int param_1,int param_2)

{
  uint *__s;
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined *puVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  
  __s = (uint *)(param_1 + 0x9a8);
  iVar2 = *(int *)(param_1 + 0x9c4);
  uVar6 = *__s + iVar2 * 8;
  uVar5 = iVar2 + 1;
  iVar7 = *(int *)(param_1 + 0x9ac) + (uint)(uVar6 < (uint)(iVar2 * 8));
  *(undefined *)((int)__s + iVar2 + 0x20) = 0x80;
  *__s = uVar6;
  *(int *)(param_1 + 0x9ac) = iVar7;
  *(uint *)(param_1 + 0x9c4) = uVar5;
  if (0x38 < uVar5) {
    if (uVar5 < 0x40) {
      do {
        uVar6 = uVar5 + 1;
        *(undefined *)((int)__s + uVar5 + 0x20) = 0;
        uVar5 = uVar6;
      } while (uVar6 < 0x40);
      *(uint *)(param_1 + 0x9c4) = uVar6;
    }
    FUN_00461f78(__s);
    psBurnStack(0x15c);
    uVar6 = *__s;
    iVar7 = *(int *)(param_1 + 0x9ac);
    *(undefined4 *)(param_1 + 0x9c4) = 0;
  }
  uVar5 = *(uint *)(param_1 + 0x9c4);
  if (*(uint *)(param_1 + 0x9c4) < 0x38) {
    do {
      uVar1 = uVar5 + 1;
      *(undefined *)((int)__s + uVar5 + 0x20) = 0;
      uVar5 = uVar1;
    } while (uVar1 < 0x38);
    *(uint *)(param_1 + 0x9c4) = uVar1;
  }
  *(char *)(param_1 + 0xa04) = (char)(uVar6 >> 0x18);
  *(char *)(param_1 + 0xa00) = (char)((uint)iVar7 >> 0x18);
  *(char *)(param_1 + 0xa01) = (char)((uint)iVar7 >> 0x10);
  *(char *)(param_1 + 0xa02) = (char)((uint)iVar7 >> 8);
  *(char *)(param_1 + 0xa03) = (char)iVar7;
  *(char *)(param_1 + 0xa05) = (char)(uVar6 >> 0x10);
  *(char *)(param_1 + 0xa06) = (char)(uVar6 >> 8);
  *(undefined *)(param_1 + 0xa07) = *(undefined *)__s;
  FUN_00461f78(__s);
  psBurnStack(0x15c);
  iVar2 = 0;
  do {
    iVar7 = iVar2 * 4;
    puVar4 = (undefined *)(iVar7 + param_2);
    *puVar4 = *(undefined *)((int)__s + iVar7 + 0xb);
    iVar3 = iVar2 + 1;
    puVar4[1] = (char)*(undefined2 *)((int)__s + iVar7 + 10);
    puVar4[2] = (char)(__s[iVar2 + 2] >> 8);
    puVar4[3] = (char)__s[iVar2 + 2];
    iVar2 = iVar3;
  } while (iVar3 < 5);
  memset(__s,0,0x60);
  return;
}



void sslSha384SnapshotHSHash(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 local_d8 [52];
  
  puVar5 = (undefined4 *)(param_1 + 0xa08);
  puVar6 = local_d8;
  do {
    uVar1 = *puVar5;
    uVar2 = puVar5[1];
    uVar3 = puVar5[2];
    uVar4 = puVar5[3];
    puVar5 = puVar5 + 4;
    *puVar6 = uVar1;
    puVar6[1] = uVar2;
    puVar6[2] = uVar3;
    puVar6[3] = uVar4;
    puVar6 = puVar6 + 4;
  } while (puVar5 != (undefined4 *)(param_1 + 0xad8));
  psSha384Final(local_d8,param_2);
  return;
}



void sslSha512SnapshotHSHash(int param_1,undefined4 param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 local_d8 [52];
  
  puVar5 = (undefined4 *)(param_1 + 0xad8);
  puVar6 = local_d8;
  do {
    uVar1 = *puVar5;
    uVar2 = puVar5[1];
    uVar3 = puVar5[2];
    uVar4 = puVar5[3];
    puVar5 = puVar5 + 4;
    *puVar6 = uVar1;
    puVar6[1] = uVar2;
    puVar6[2] = uVar3;
    puVar6[3] = uVar4;
    puVar6 = puVar6 + 4;
  } while (puVar5 != (undefined4 *)(param_1 + 0xba8));
  psSha512Final(local_d8,param_2);
  return;
}



undefined4 extMasterSecretSnapshotHSHash(int param_1,undefined4 param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 local_208 [48];
  undefined4 local_148 [28];
  undefined4 local_d8 [52];
  
  *param_3 = 0;
  if ((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) == 0) {
    puVar3 = (undefined4 *)(param_1 + 0x878);
    puVar2 = local_208;
    do {
      uVar1 = *puVar3;
      uVar4 = puVar3[1];
      uVar6 = puVar3[2];
      uVar5 = puVar3[3];
      puVar3 = puVar3 + 4;
      *puVar2 = uVar1;
      puVar2[1] = uVar4;
      puVar2[2] = uVar6;
      puVar2[3] = uVar5;
      puVar2 = puVar2 + 4;
    } while (puVar3 != (undefined4 *)(param_1 + 0x938));
    psMd5Sha1Final(local_208,param_2);
    *param_3 = 0x24;
    return *param_3;
  }
  if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 10 & 1) != 0) {
    puVar2 = (undefined4 *)(param_1 + 0xa08);
    puVar3 = local_d8;
    do {
      uVar6 = *puVar2;
      uVar5 = puVar2[1];
      uVar1 = puVar2[2];
      uVar4 = puVar2[3];
      puVar2 = puVar2 + 4;
      *puVar3 = uVar6;
      puVar3[1] = uVar5;
      puVar3[2] = uVar1;
      puVar3[3] = uVar4;
      puVar3 = puVar3 + 4;
    } while (puVar2 != (undefined4 *)(param_1 + 0xad8));
    psSha384Final(local_d8,param_2);
    *param_3 = 0x30;
    return *param_3;
  }
  puVar2 = (undefined4 *)(param_1 + 0x938);
  puVar3 = local_148;
  do {
    uVar6 = *puVar2;
    uVar5 = puVar2[1];
    uVar4 = puVar2[2];
    uVar1 = puVar2[3];
    puVar2 = puVar2 + 4;
    *puVar3 = uVar6;
    puVar3[1] = uVar5;
    puVar3[2] = uVar4;
    puVar3[3] = uVar1;
    puVar3 = puVar3 + 4;
  } while (puVar2 != (undefined4 *)(param_1 + 0x9a8));
  psSha256Final(local_148,param_2);
  *param_3 = 0x20;
  return *param_3;
}



size_t sslSnapshotHSHash(int param_1,void *param_2,uint param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  uint uVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  size_t __n;
  int iVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 local_390;
  undefined4 local_38c;
  undefined4 local_388;
  char local_384;
  char local_383;
  char local_382;
  undefined auStack_381 [49];
  undefined4 local_350 [48];
  undefined4 local_290 [24];
  undefined4 local_230 [28];
  undefined4 local_1c0 [52];
  undefined4 local_f0 [52];
  
  uVar3 = *(uint *)(param_1 + 0xd2c);
  __n = 0xffffffff;
  if (((uVar3 >> 0xe & 1) != 0) && (*(int *)(param_1 + 0xdfc) != 0)) {
    memcpy(param_2,(void *)(param_1 + 0xd74),*(size_t *)(param_1 + 0xdb4));
    return *(size_t *)(param_1 + 0xdb4);
  }
  puVar6 = (undefined4 *)(param_1 + 0x878);
  if ((uVar3 >> 0xb & 1) != 0) {
    puVar8 = (undefined4 *)(param_1 + 0x9a8);
    puVar5 = (undefined4 *)(param_1 + 0x938);
    puVar10 = (undefined4 *)(param_1 + 0xa08);
    puVar9 = (undefined4 *)(param_1 + 0xad8);
    iVar7 = param_1 + 0x50;
    if ((int)param_3 < 0) {
      puVar4 = local_350;
      if ((uVar3 >> 0xd & 1) == 0) {
        do {
          uVar1 = *puVar6;
          uVar2 = puVar6[1];
          uVar11 = puVar6[2];
          uVar12 = puVar6[3];
          puVar6 = puVar6 + 4;
          *puVar4 = uVar1;
          puVar4[1] = uVar2;
          puVar4[2] = uVar11;
          puVar4[3] = uVar12;
          puVar4 = puVar4 + 4;
        } while (puVar6 != puVar5);
        psMd5Sha1Final(local_350,param_2);
        uVar3 = *(uint *)(param_1 + 0xd2c);
        __n = 0x24;
      }
      else {
        puVar6 = local_230;
        do {
          uVar1 = *puVar5;
          uVar2 = puVar5[1];
          uVar11 = puVar5[2];
          uVar12 = puVar5[3];
          puVar5 = puVar5 + 4;
          *puVar6 = uVar1;
          puVar6[1] = uVar2;
          puVar6[2] = uVar11;
          puVar6[3] = uVar12;
          puVar6 = puVar6 + 4;
        } while (puVar5 != puVar8);
        psSha256Final(local_230,param_2);
        uVar3 = *(uint *)(param_1 + 0xd2c);
        if ((uVar3 & 1) != 0) {
          puVar6 = local_1c0;
          do {
            uVar11 = *puVar10;
            uVar2 = puVar10[1];
            uVar1 = puVar10[2];
            uVar12 = puVar10[3];
            puVar10 = puVar10 + 4;
            *puVar6 = uVar11;
            puVar6[1] = uVar2;
            puVar6[2] = uVar1;
            puVar6[3] = uVar12;
            puVar6 = puVar6 + 4;
          } while (puVar10 != (undefined4 *)(param_1 + 0xad8));
          psSha384Final(local_1c0,param_1 + 0xbbc);
          puVar6 = local_f0;
          do {
            uVar12 = *puVar9;
            uVar11 = puVar9[1];
            uVar2 = puVar9[2];
            uVar1 = puVar9[3];
            puVar9 = puVar9 + 4;
            *puVar6 = uVar12;
            puVar6[1] = uVar11;
            puVar6[2] = uVar2;
            puVar6[3] = uVar1;
            puVar6 = puVar6 + 4;
          } while (puVar9 != (undefined4 *)(param_1 + 0xba8));
          psSha512Final(local_f0,param_1 + 0xbec);
          puVar6 = local_290;
          do {
            uVar12 = *puVar8;
            uVar1 = puVar8[1];
            uVar11 = puVar8[2];
            uVar2 = puVar8[3];
            puVar8 = puVar8 + 4;
            *puVar6 = uVar12;
            puVar6[1] = uVar1;
            puVar6[2] = uVar11;
            puVar6[3] = uVar2;
            puVar6 = puVar6 + 4;
          } while (puVar8 != (undefined4 *)(param_1 + 0xa08));
          psSha1Final(local_290,param_1 + 0xba8);
          uVar3 = *(uint *)(param_1 + 0xd2c);
        }
        __n = 0x20;
      }
    }
    else {
      if ((param_3 & 1) == 0) {
        local_390._0_1_ = 'c';
        local_390._1_1_ = 'l';
        local_390._2_1_ = 'i';
        local_390._3_1_ = 'e';
        local_38c._0_1_ = 'n';
        local_38c._1_1_ = 't';
        local_38c._2_1_ = ' ';
        local_38c._3_1_ = 'f';
      }
      else {
        local_390._0_1_ = 's';
        local_390._1_1_ = 'e';
        local_390._2_1_ = 'r';
        local_390._3_1_ = 'v';
        local_38c._0_1_ = 'e';
        local_38c._1_1_ = 'r';
        local_38c._2_1_ = ' ';
        local_38c._3_1_ = 'f';
      }
      local_382 = 'd';
      local_383 = 'e';
      local_384 = 'h';
      local_388._0_1_ = 'i';
      local_388._1_1_ = 'n';
      local_388._2_1_ = 'i';
      local_388._3_1_ = 's';
      if ((uVar3 >> 0xd & 1) == 0) {
        local_388._0_1_ = 'i';
        local_388._1_1_ = 'n';
        local_388._2_1_ = 'i';
        local_388._3_1_ = 's';
        local_384 = 'h';
        local_383 = 'e';
        local_382 = 'd';
        puVar10 = local_350;
        do {
          uVar12 = *puVar6;
          uVar11 = puVar6[1];
          uVar2 = puVar6[2];
          uVar1 = puVar6[3];
          puVar6 = puVar6 + 4;
          *puVar10 = uVar12;
          puVar10[1] = uVar11;
          puVar10[2] = uVar2;
          puVar10[3] = uVar1;
          puVar10 = puVar10 + 4;
        } while (puVar6 != (undefined4 *)(param_1 + 0x938));
        psMd5Sha1Final(local_350,auStack_381);
        __n = prf(iVar7,0x30,&local_390,0x33,param_2,0xc);
        uVar3 = *(uint *)(param_1 + 0xd2c);
      }
      else {
        if ((*(uint *)(*(int *)(param_1 + 0xd10) + 4) >> 10 & 1) == 0) {
          puVar6 = local_230;
          do {
            uVar12 = *puVar5;
            uVar11 = puVar5[1];
            uVar2 = puVar5[2];
            uVar1 = puVar5[3];
            puVar5 = puVar5 + 4;
            *puVar6 = uVar12;
            puVar6[1] = uVar11;
            puVar6[2] = uVar2;
            puVar6[3] = uVar1;
            puVar6 = puVar6 + 4;
          } while (puVar5 != (undefined4 *)(param_1 + 0x9a8));
          psSha256Final(local_230,auStack_381);
          __n = prf2(iVar7,0x30,&local_390,0x2f,param_2,0xc,0x200);
        }
        else {
          puVar6 = local_1c0;
          do {
            uVar2 = *puVar10;
            uVar12 = puVar10[1];
            uVar1 = puVar10[2];
            uVar11 = puVar10[3];
            puVar10 = puVar10 + 4;
            *puVar6 = uVar2;
            puVar6[1] = uVar12;
            puVar6[2] = uVar1;
            puVar6[3] = uVar11;
            puVar6 = puVar6 + 4;
          } while (puVar10 != (undefined4 *)(param_1 + 0xad8));
          psSha384Final(local_1c0,auStack_381);
          __n = prf2(iVar7,0x30,&local_390,0x3f,param_2,0xc,0x400);
        }
        uVar3 = *(uint *)(param_1 + 0xd2c);
      }
    }
  }
  if (((uVar3 >> 0xe & 1) != 0) && (0 < (int)__n)) {
    memcpy((void *)(param_1 + 0xd74),param_2,__n);
    *(size_t *)(param_1 + 0xdb4) = __n;
  }
  return __n;
}



uint prf(undefined *param_1,uint param_2,undefined4 param_3,uint param_4,int param_5,ushort param_6)

{
  byte *pbVar1;
  bool bVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  undefined *puVar12;
  byte *pbVar13;
  uint uVar14;
  byte *pbVar15;
  undefined4 local_3b8 [56];
  undefined4 local_2d8 [56];
  undefined auStack_1f8 [160];
  undefined auStack_158 [16];
  undefined4 local_148;
  undefined4 local_144;
  undefined4 local_140;
  undefined4 local_13c;
  undefined auStack_138 [16];
  ushort local_128 [4];
  undefined auStack_120 [160];
  undefined auStack_80 [24];
  undefined4 local_68;
  undefined4 local_64;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined auStack_50 [24];
  ushort local_38 [2];
  uint local_34;
  undefined *local_30;
  
  uVar11 = (uint)param_6;
  local_34 = param_4 & 0xffff;
  if (0xe0 < uVar11) {
    _psTraceStr("psAssert %s","prf.c");
    _psTraceInt(&DAT_0049016c,0xdd);
    _psError("outLen <= SSL_MAX_KEY_BLOCK_SIZE");
  }
  uVar7 = (param_2 & 0xffff) >> 1;
  uVar14 = uVar7 + (param_2 & 1);
  local_30 = param_1 + uVar7;
  uVar7 = 1;
  if (0x10 < uVar11) {
    uVar8 = 2;
    do {
      uVar7 = uVar8 & 0xffff;
      uVar10 = uVar8 & 0xfff;
      uVar8 = uVar7 + 1;
    } while (uVar10 << 4 < uVar11);
  }
  uVar8 = psHmacMd5(param_1,uVar14,param_3,local_34,auStack_158,auStack_138,local_128);
  if (-1 < (int)uVar8) {
    uVar8 = (uint)local_128[0];
    uVar10 = uVar14;
    if (uVar8 != uVar14) {
      if (uVar14 < 0x41) {
        _psTraceStr("psAssert %s","prf.c");
        _psTraceInt(&DAT_0049016c,0x5f);
        _psError("keyLen > 64");
        uVar8 = (uint)local_128[0];
      }
      param_1 = auStack_138;
      uVar10 = uVar8;
    }
    uVar9 = 0;
    if (uVar7 == 0) {
LAB_0045f454:
      uVar8 = 0;
    }
    else {
      do {
        while( true ) {
          uVar8 = psHmacMd5Init(auStack_1f8,param_1,uVar10);
          if ((int)uVar8 < 0) goto LAB_0045f458;
          psHmacMd5Update(auStack_1f8,auStack_158,0x10);
          psHmacMd5Update(auStack_1f8,param_3,local_34);
          psHmacMd5Final(auStack_1f8,&local_148);
          uVar5 = local_13c;
          uVar4 = local_140;
          uVar3 = local_144;
          if (uVar9 != uVar7 - 1) break;
          memcpy(local_3b8 + uVar9 * 4,&local_148,uVar11 + uVar9 * -0x10);
          uVar9 = uVar9 + 1 & 0xffff;
          if (uVar7 <= uVar9) goto LAB_0045f454;
        }
        local_3b8[uVar9 * 4] = local_148;
        local_3b8[uVar9 * 4 + 1] = uVar3;
        local_3b8[uVar9 * 4 + 2] = uVar4;
        local_3b8[uVar9 * 4 + 3] = uVar5;
        uVar8 = psHmacMd5(param_1,uVar10,auStack_158,0x10,auStack_158,auStack_138,local_128);
        if ((int)uVar8 < 0) break;
        uVar9 = uVar9 + 1 & 0xffff;
        uVar8 = 0;
      } while (uVar9 < uVar7);
    }
  }
LAB_0045f458:
  memset_s(auStack_158,0x10,0,0x10);
  memset_s(&local_148,0x10,0,0x10);
  memset_s(auStack_138,0x10,0,0x10);
  puVar12 = local_30;
  if ((int)uVar8 < 0) {
    memset_s(local_3b8,uVar11,0,uVar11);
    uVar11 = uVar8;
  }
  else {
    bVar2 = 0x14 < uVar11;
    uVar7 = 1;
    while (bVar2) {
      uVar7 = uVar7 + 1 & 0xffff;
      bVar2 = (uVar7 * 0x14 & 0xffff) < uVar11;
    }
    uVar8 = psHmacSha1(local_30,uVar14,param_3,local_34,auStack_80,auStack_50,local_38);
    if (-1 < (int)uVar8) {
      uVar8 = (uint)local_38[0];
      if (uVar8 != uVar14) {
        if (uVar14 < 0x41) {
          _psTraceStr("psAssert %s","prf.c");
          _psTraceInt(&DAT_0049016c,0xa6);
          _psError("keyLen > 64");
          uVar8 = (uint)local_38[0];
        }
        puVar12 = auStack_50;
        uVar14 = uVar8;
      }
      uVar10 = 0;
      if (uVar7 == 0) {
LAB_0045f6ac:
        uVar8 = 0;
      }
      else {
        do {
          while( true ) {
            uVar8 = psHmacSha1Init(auStack_120,puVar12,uVar14);
            if ((int)uVar8 < 0) goto LAB_0045f6b0;
            psHmacSha1Update(auStack_120,auStack_80,0x14);
            psHmacSha1Update(auStack_120,param_3,local_34);
            psHmacSha1Final(auStack_120,&local_68);
            uVar6 = local_58;
            uVar5 = local_5c;
            uVar4 = local_60;
            uVar3 = local_64;
            if (uVar10 != uVar7 - 1) break;
            memcpy(local_2d8 + uVar10 * 5,&local_68,uVar11 + uVar10 * -0x14);
            uVar10 = uVar10 + 1 & 0xffff;
            if (uVar7 <= uVar10) goto LAB_0045f6ac;
          }
          local_2d8[uVar10 * 5] = local_68;
          local_2d8[uVar10 * 5 + 1] = uVar3;
          local_2d8[uVar10 * 5 + 2] = uVar4;
          local_2d8[uVar10 * 5 + 3] = uVar5;
          local_2d8[uVar10 * 5 + 4] = uVar6;
          uVar8 = psHmacSha1(puVar12,uVar14,auStack_80,0x14,auStack_80,auStack_50,local_38);
          if ((int)uVar8 < 0) break;
          uVar10 = uVar10 + 1 & 0xffff;
          uVar8 = 0;
        } while (uVar10 < uVar7);
      }
    }
LAB_0045f6b0:
    memset_s(auStack_80,0x14,0,0x14);
    memset_s(&local_68,0x14,0,0x14);
    memset_s(auStack_50,0x14,0,0x14);
    if ((int)uVar8 < 0) {
      memset_s(local_2d8,uVar11,0,uVar11);
      uVar11 = uVar8;
    }
    else {
      uVar14 = 0;
      if (uVar11 != 0) {
        do {
          pbVar13 = (byte *)((int)local_3b8 + uVar14);
          pbVar1 = (byte *)((int)local_2d8 + uVar14);
          pbVar15 = (byte *)(uVar14 + param_5);
          uVar14 = uVar14 + 1 & 0xffff;
          *pbVar15 = *pbVar13 ^ *pbVar1;
        } while (uVar14 < uVar11);
      }
    }
  }
  memset_s(local_3b8,0xe0,0,0xe0);
  memset_s(local_2d8,0xe0,0,0xe0);
  return uVar11;
}



uint prf2(undefined *param_1,ushort param_2,undefined4 param_3,uint param_4,int param_5,
         ushort param_6,uint param_7)

{
  bool bVar1;
  uint uVar2;
  size_t __n;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  undefined *puVar6;
  code *pcVar7;
  uint uVar8;
  undefined *puVar9;
  int iVar10;
  undefined local_2f0 [224];
  undefined auStack_210 [336];
  undefined auStack_c0 [48];
  undefined auStack_90 [48];
  undefined auStack_60 [48];
  ushort local_30 [2];
  uint local_2c;
  
  uVar4 = (uint)param_6;
  local_2c = param_4 & 0xffff;
  if (0xe0 < uVar4) {
    _psTraceStr("psAssert %s","prf.c");
    _psTraceInt(&DAT_0049016c,0x17f);
    _psError("outLen <= SSL_MAX_KEY_BLOCK_SIZE");
  }
  if ((param_7 >> 10 & 1) == 0) {
    uVar2 = psHmacSha256(param_1,param_2,param_3,local_2c,auStack_c0,auStack_60,local_30);
    __n = 0x20;
  }
  else {
    uVar2 = psHmacSha384(param_1,param_2,param_3,local_2c,auStack_c0,auStack_60,local_30);
    __n = 0x30;
  }
  if (-1 < (int)uVar2) {
    uVar5 = 1;
    uVar2 = __n;
    while (uVar2 < uVar4) {
      uVar5 = uVar5 + 1 & 0xffff;
      uVar2 = __n * uVar5 & 0xffff;
    }
    if (local_30[0] != param_2) {
      bVar1 = param_2 < 0x41;
      param_2 = local_30[0];
      if (bVar1) {
        _psTraceStr("psAssert %s","prf.c");
        _psTraceInt(&DAT_0049016c,0x12e);
        _psError("keyLen > 64");
        param_2 = local_30[0];
      }
      param_1 = auStack_60;
    }
    uVar3 = 0;
    if (uVar5 != 0) {
      uVar8 = param_7 >> 10 & 1;
      do {
        while (uVar8 != 0) {
          uVar2 = psHmacSha384Init(auStack_210,param_1,param_2);
          if ((int)uVar2 < 0) goto LAB_0045fbc8;
          psHmacSha384Update(auStack_210,auStack_c0,__n);
          psHmacSha384Update(auStack_210,param_3,local_2c);
          psHmacSha384Final(auStack_210,auStack_90);
          if (uVar3 == uVar5 - 1) goto LAB_0045fb90;
LAB_0045faa0:
          memcpy(local_2f0 + __n * uVar3,auStack_90,__n);
          if (uVar8 == 0) {
            pcVar7 = psHmacSha256;
          }
          else {
            pcVar7 = psHmacSha384;
          }
          uVar2 = (*pcVar7)(param_1,param_2,auStack_c0,__n,auStack_c0,auStack_60,local_30);
          if ((int)uVar2 < 0) goto LAB_0045fbc8;
          uVar3 = uVar3 + 1 & 0xffff;
          uVar2 = 0;
          if (uVar5 <= uVar3) goto LAB_0045fbc8;
        }
        uVar2 = psHmacSha256Init(auStack_210,param_1,param_2);
        if ((int)uVar2 < 0) goto LAB_0045fbc8;
        psHmacSha256Update(auStack_210,auStack_c0,__n);
        psHmacSha256Update(auStack_210,param_3,local_2c);
        psHmacSha256Final(auStack_210,auStack_90);
        if (uVar3 != uVar5 - 1) goto LAB_0045faa0;
LAB_0045fb90:
        iVar10 = __n * uVar3;
        uVar3 = uVar3 + 1 & 0xffff;
        memcpy(local_2f0 + iVar10,auStack_90,uVar4 - iVar10);
      } while (uVar3 < uVar5);
    }
    uVar2 = 0;
  }
LAB_0045fbc8:
  memset_s(auStack_c0,0x30,0,0x30);
  memset_s(auStack_90,0x30,0,0x30);
  memset_s(auStack_60,0x30,0,0x30);
  if ((int)uVar2 < 0) {
    memset_s(local_2f0,uVar4,0,uVar4);
    return uVar2;
  }
  uVar2 = 0;
  if (uVar4 != 0) {
    do {
      puVar9 = local_2f0 + uVar2;
      puVar6 = (undefined *)(uVar2 + param_5);
      uVar2 = uVar2 + 1 & 0xffff;
      *puVar6 = *puVar9;
    } while (uVar2 < uVar4);
  }
  memset_s(local_2f0,0xe0,0,0xe0);
  return uVar4;
}



undefined4 matrixPskGetHint(undefined4 param_1,undefined4 *param_2,undefined *param_3)

{
  *param_2 = 0;
  *param_3 = 0;
  return 0;
}



undefined4 matrixSslPskGetKeyId(int param_1,undefined4 *param_2,undefined *param_3)

{
  int iVar1;
  undefined4 uVar2;
  
  iVar1 = *(int *)(*(int *)(param_1 + 0xc48) + 0x7c);
  uVar2 = 0xffffffff;
  if (iVar1 != 0) {
    uVar2 = 0;
    *param_2 = *(undefined4 *)(iVar1 + 8);
    *param_3 = *(undefined *)(iVar1 + 0xc);
  }
  return uVar2;
}



undefined4
matrixSslPskGetKey(int param_1,void *param_2,char param_3,undefined4 *param_4,undefined *param_5)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  
  puVar3 = *(undefined4 **)(*(int *)(param_1 + 0xc48) + 0x7c);
  *param_4 = 0;
  uVar2 = 0xffffffff;
  if ((puVar3 != (undefined4 *)0x0) && (uVar2 = 0xfffffffa, param_3 != '\0')) {
    while ((*(char *)(puVar3 + 3) != param_3 ||
           (iVar1 = memcmp((void *)puVar3[2],param_2,(size_t)param_3), iVar1 != 0))) {
      puVar3 = (undefined4 *)puVar3[4];
      if (puVar3 == (undefined4 *)0x0) {
        return 0;
      }
    }
    *param_4 = *puVar3;
    *param_5 = *(undefined *)(puVar3 + 1);
    return 0;
  }
  return uVar2;
}



undefined4 parseClientHelloExtensions(int param_1,byte **param_2,uint param_3)

{
  byte bVar1;
  ushort uVar2;
  undefined4 uVar4;
  uint uVar5;
  int iVar6;
  void *pvVar7;
  undefined4 *puVar8;
  uint uVar9;
  byte *pbVar10;
  uint uVar11;
  undefined4 *puVar12;
  undefined4 uVar13;
  short sVar14;
  undefined4 uVar15;
  undefined4 uVar16;
  byte *pbVar17;
  byte *pbVar18;
  uint uVar19;
  byte *pbVar20;
  uint uVar3;
  
  pbVar17 = *param_2;
  uVar9 = *(uint *)(param_1 + 0x1230) & 0xffe07fff;
  pbVar20 = pbVar17 + (param_3 & 0xffff);
  *(uint *)(param_1 + 0x1230) = uVar9;
  if (pbVar17 == pbVar20) goto LAB_00460190;
  if ((int)pbVar20 - (int)pbVar17 < 2) {
LAB_004600a4:
    uVar4 = 0x32;
    goto LAB_004600a8;
  }
  bVar1 = *pbVar17;
  pbVar18 = pbVar17 + 1;
  pbVar17 = pbVar17 + 2;
  if (((int)pbVar20 - (int)pbVar17 != ((uint)bVar1 * 0x100 + (uint)*pbVar18 & 0xffff)) ||
     ((uint)((int)pbVar20 - (int)pbVar17) < 4)) goto LAB_004600a4;
  *(undefined2 *)(param_1 + 0xd4c) = 0;
  if (pbVar17 == pbVar20) goto LAB_00460190;
LAB_00460028:
  if ((int)pbVar20 - (int)(pbVar17 + 2) < 2) goto LAB_004600a4;
  uVar9 = (uint)pbVar17[2] * 0x100 + (uint)pbVar17[3];
  pbVar18 = pbVar17 + 4;
  uVar19 = uVar9 & 0xffff;
  if ((uint)((int)pbVar20 - (int)pbVar18) < uVar19) goto LAB_004600a4;
  switch((ushort)*pbVar17 * 0x100 + (ushort)pbVar17[1]) {
  case 0:
    if ((4 < uVar19) && (pbVar17[6] == 0)) {
      uVar9 = (uint)pbVar17[7] * 0x100 + (uint)pbVar17[8];
      if ((uVar19 - 5 & 0xffff) < uVar9) goto LAB_00460790;
      uVar4 = 0x2f;
      if ((uVar9 < 0x100) && (uVar9 != 0)) {
        if (*(void **)(param_1 + 0xcc0) != (void *)0x0) {
          free(*(void **)(param_1 + 0xcc0));
        }
        pvVar7 = malloc(uVar9 + 1);
        *(void **)(param_1 + 0xcc0) = pvVar7;
        if (pvVar7 != (void *)0x0) {
          memcpy(pvVar7,pbVar17 + 9,uVar9);
          *(undefined *)(*(int *)(param_1 + 0xcc0) + uVar9) = 0;
          break;
        }
        goto LAB_004603a8;
      }
      goto LAB_004600a8;
    }
    goto LAB_00460790;
  case 1:
    if (uVar19 == 1) {
      if ((*(uint *)(param_1 + 0x1230) >> 0xd & 1) == 0) {
        bVar1 = *pbVar18;
        uVar4 = 0x200;
        if (bVar1 == 1) {
LAB_00460540:
          *(undefined4 *)(param_1 + 0xd00) = uVar4;
        }
        else if (bVar1 == 2) {
          *(undefined4 *)(param_1 + 0xd00) = 0x400;
        }
        else {
          if (bVar1 != 3) {
            if (bVar1 != 4) goto LAB_00460790;
            uVar4 = 0x1000;
            goto LAB_00460540;
          }
          *(undefined4 *)(param_1 + 0xd00) = 0x800;
        }
      }
      break;
    }
    goto LAB_00460790;
  case 4:
    if (uVar19 != 0) goto LAB_004603a8;
    if ((*(uint *)(param_1 + 0x1230) >> 0xc & 1) == 0) {
      *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x10000;
    }
    break;
  case 5:
    if ((4 < uVar19) && (*pbVar18 == 1)) {
      uVar9 = (uint)pbVar17[5] * 0x100 + (uint)pbVar17[6] & 0xffff;
      uVar11 = uVar19 - 3 & 0xffff;
      if ((uVar9 + 2 <= uVar11) &&
         (((uint)pbVar17[uVar9 + 7] * 0x100 + (uint)(pbVar17 + uVar9 + 7)[1] & 0xffff) <=
          (uVar11 - 2 & 0xffff))) {
        if ((*(short *)(*(int *)(param_1 + 0xc48) + 0x8c) != 0) &&
           (*(int *)(*(int *)(param_1 + 0xc48) + 0x88) != 0)) {
          *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x100000;
        }
        break;
      }
    }
LAB_00460790:
    uVar4 = 0x2f;
    goto LAB_004600a8;
  case 10:
    if (uVar19 < 4) goto LAB_004603a8;
    uVar3 = (uint)*pbVar18 * 0x100 + (uint)pbVar17[5];
    uVar9 = uVar3 & 0xffff;
    uVar11 = uVar19 - 2 & 0xffff;
    pbVar17 = pbVar17 + 6;
    if ((uVar11 < uVar9) || (uVar9 < 2)) goto LAB_004603a8;
    uVar4 = 0x28;
    if ((uVar3 & 1) != 0) goto LAB_004600a8;
    *(undefined *)(param_1 + 0xd4b) = 0;
    uVar3 = 0x800000;
    do {
      if (uVar11 < 2) break;
      sVar14 = (ushort)*pbVar17 * 0x100 + (ushort)pbVar17[1];
      uVar9 = uVar9 - 2 & 0xffff;
      uVar11 = uVar11 - 2 & 0xffff;
      iVar6 = psTestUserEcID(sVar14,*(uint *)(param_1 + 0xd48) & 0xffffff);
      pbVar17 = pbVar17 + 2;
      if (iVar6 == 0) {
        if (uVar3 == 0x800000) {
          *(char *)(param_1 + 0xd4b) = (char)sVar14;
        }
        uVar5 = curveIdToFlag(sVar14);
        uVar3 = uVar3 | uVar5;
      }
    } while (1 < uVar9);
    *(uint *)(param_1 + 0xd48) = *(uint *)(param_1 + 0xd48) & 0xff000000 | uVar3 & 0xffffff;
    break;
  case 0xb:
    if (uVar19 == 0) goto LAB_004603a8;
    uVar9 = (uint)*pbVar18;
    if ((((uVar19 - 1 & 0xffff) < uVar9) || (uVar9 == 0)) ||
       (pvVar7 = memchr(pbVar17 + 5,0,uVar9), pvVar7 == (void *)0x0)) goto LAB_004603a8;
    break;
  case 0xd:
    if ((0x1e < uVar19 - 4) || ((uVar9 & 1) != 0)) goto LAB_004603a8;
    uVar9 = (uint)CONCAT11(*pbVar18,pbVar17[5]);
    uVar11 = uVar19 - 2 & 0xffff;
    pbVar10 = pbVar17 + 6;
    if ((uVar11 < uVar9) || ((uVar9 < 2 || ((pbVar17[5] & 1) != 0)))) goto LAB_004603a8;
    do {
      if (uVar11 < 2) break;
      uVar3 = 1 << (*pbVar10 & 7) & 0xff;
      uVar2 = (ushort)uVar3;
      if (pbVar10[1] != 1) {
        uVar2 = (ushort)(uVar3 << 8);
      }
      uVar9 = uVar9 - 2 & 0xffff;
      *(ushort *)(param_1 + 0xd4c) = uVar2 | *(ushort *)(param_1 + 0xd4c);
      pbVar10 = pbVar10 + 2;
      uVar11 = uVar11 - 2 & 0xffff;
    } while (1 < uVar9);
    break;
  case 0x17:
    if (uVar19 != 0) goto LAB_004603a8;
    *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x20000;
    break;
  case 0x23:
    puVar8 = *(undefined4 **)(param_1 + 0xcbc);
    if (puVar8 == (undefined4 *)0x0) {
      pvVar7 = malloc(100);
      *(void **)(param_1 + 0xcbc) = pvVar7;
      if (pvVar7 == (void *)0x0) {
        uVar4 = 0x50;
        goto LAB_004600a8;
      }
      memset(pvVar7,0,100);
      puVar8 = *(undefined4 **)(param_1 + 0xcbc);
      *puVar8 = *(undefined4 *)(param_1 + 0xc8c);
    }
    if (uVar19 == 0) {
      if ((*(int *)(param_1 + 0xc48) == 0) || (*(int *)(*(int *)(param_1 + 0xc48) + 0x80) == 0)) {
        *(undefined2 *)(puVar8 + 0x17) = 0;
      }
      else {
        *(undefined2 *)(puVar8 + 0x17) = 3;
      }
    }
    else {
      *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x80000;
      iVar6 = matrixUnlockSessionTicket(param_1,pbVar18,uVar19);
      if (iVar6 == 0) {
        iVar6 = *(int *)(param_1 + 0xcbc);
        *(uint *)(param_1 + 0xd2c) = *(uint *)(param_1 + 0xd2c) | 8;
        *(undefined2 *)(iVar6 + 0x5c) = 5;
        puVar8 = (undefined4 *)(iVar6 + 0x24);
        puVar12 = (undefined4 *)(param_1 + 0x50);
        do {
          uVar16 = *puVar8;
          uVar15 = puVar8[1];
          uVar4 = puVar8[2];
          uVar13 = puVar8[3];
          puVar8 = puVar8 + 4;
          *puVar12 = uVar16;
          puVar12[1] = uVar15;
          puVar12[2] = uVar4;
          puVar12[3] = uVar13;
          puVar12 = puVar12 + 4;
        } while (puVar8 != (undefined4 *)(iVar6 + 0x54));
      }
      else {
        if (*(char *)(param_1 + 0xc98) != '\0') {
          memset((void *)(param_1 + 0xc99),0,0x20);
          *(undefined *)(param_1 + 0xc98) = 0;
        }
        if ((*(int *)(param_1 + 0xc48) == 0) || (*(int *)(*(int *)(param_1 + 0xc48) + 0x80) == 0)) {
          *(undefined2 *)(*(int *)(param_1 + 0xcbc) + 0x5c) = 0;
        }
        else {
          *(undefined2 *)(*(int *)(param_1 + 0xcbc) + 0x5c) = 3;
        }
      }
    }
  }
  pbVar17 = pbVar18 + uVar19;
  if (pbVar17 == pbVar20) goto LAB_0046018c;
  goto LAB_00460028;
LAB_0046018c:
  pbVar17 = pbVar18 + uVar19;
  uVar9 = *(uint *)(param_1 + 0x1230);
LAB_00460190:
  if ((uVar9 & 0x420000) != 0x400000) {
    if (((*(uint *)(param_1 + 0xd2c) >> 0xd & 1) != 0) && (*(ushort *)(param_1 + 0xd4c) == 0)) {
      *(ushort *)(param_1 + 0xd4c) = *(ushort *)(param_1 + 0xd4c) | 0x404;
    }
    if ((*(uint *)(param_1 + 0x1230) >> 0x12 & 1) == 1) {
      memset((void *)(param_1 + 0xc99),0,0x20);
      uVar9 = *(uint *)(param_1 + 0x1230);
      *(undefined *)(param_1 + 0xc98) = 0;
    }
    *(uint *)(param_1 + 0x1230) = uVar9 & 0xfff3ffff;
    *param_2 = pbVar17;
    return 0;
  }
LAB_004603a8:
  uVar4 = 0x28;
LAB_004600a8:
  *(undefined4 *)(param_1 + 0xd30) = uVar4;
  return 0xfffffff4;
}



int parseServerHelloExtensions(int param_1,int param_2,int param_3,byte **param_4,ushort param_5)

{
  byte bVar1;
  uint uVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  short sVar9;
  byte *pbVar10;
  code *pcVar11;
  
  uVar2 = (uint)param_5;
  pbVar5 = *param_4;
  iVar7 = 0;
  if (1 < uVar2) {
    pbVar4 = pbVar5 + 2;
    iVar8 = (int)pbVar4 - param_3;
    if ((byte *)((uint)*pbVar5 * 0x100 + (uint)pbVar5[1] & 0xffff) <= pbVar5 + (uVar2 - (int)pbVar4)
       ) {
      do {
        if (param_2 <= iVar8) {
          uVar2 = *(uint *)(param_1 + 0x1230);
          if ((((uVar2 >> 3 & 1) != 1) || ((uVar2 >> 0x16 & 1) != 1)) &&
             (((uVar2 >> 0xb & 1) != 1 || ((uVar2 >> 0x14 & 1) != 0)))) {
            *param_4 = pbVar4;
            return iVar7;
          }
LAB_0046096c:
          *(undefined4 *)(param_1 + 0xd30) = 0x28;
          return -0xc;
        }
        sVar9 = (ushort)*pbVar4 * 0x100 + (ushort)pbVar4[1];
        if ((int)(pbVar5 + (uVar2 - (int)(pbVar4 + 2))) < 2) break;
        pbVar3 = (byte *)((uint)pbVar4[2] * 0x100 + (uint)pbVar4[3]);
        pbVar4 = pbVar4 + 4;
        pbVar10 = (byte *)((uint)pbVar3 & 0xffff);
        if (pbVar5 + (uVar2 - (int)pbVar4) < pbVar10) break;
        iVar7 = -1;
        switch(sVar9) {
        case 0:
          if ((*(uint *)(param_1 + 0x1230) & 1) == 0) goto switchD_004608a4_caseD_a;
          pcVar11 = *(code **)(param_1 + 0xd44);
          uVar6 = *(uint *)(param_1 + 0x1230) & 0xfffffffe;
          goto LAB_00460a1c;
        case 1:
          if ((*(uint *)(param_1 + 0x1230) >> 1 & 1) != 0) {
            *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) & 0xfffffffd;
            iVar7 = 0;
          }
          uVar6 = *(uint *)(param_1 + 0xd00);
          if (((uVar6 >> 0x10 & 1) == 0) || (pbVar10 != (byte *)0x1)) {
LAB_00460c48:
            *(undefined4 *)(param_1 + 0xd30) = 0x2f;
            return -0xc;
          }
          bVar1 = *pbVar4;
          if ((bVar1 == 1) && ((uVar6 >> 9 & 1) != 0)) {
            *(undefined4 *)(param_1 + 0xd00) = 0x200;
          }
          else if ((bVar1 == 2) && ((uVar6 >> 10 & 1) != 0)) {
            *(undefined4 *)(param_1 + 0xd00) = 0x400;
          }
          else if ((bVar1 == 3) && ((uVar6 >> 0xb & 1) != 0)) {
            *(undefined4 *)(param_1 + 0xd00) = 0x800;
          }
          else {
            if ((bVar1 != 4) || ((uVar6 >> 0xc & 1) == 0)) goto LAB_00460c48;
            *(undefined4 *)(param_1 + 0xd00) = 0x1000;
          }
          break;
        default:
          pcVar11 = *(code **)(param_1 + 0xd44);
          if (pcVar11 == (code *)0x0) goto switchD_004608a4_caseD_a;
          goto LAB_004608bc;
        case 4:
          if ((*(uint *)(param_1 + 0x1230) >> 2 & 1) != 0) {
            *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) & 0xfffffffb;
            iVar7 = 0;
          }
          if (pbVar10 != (byte *)0x0) goto LAB_00460c48;
          *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x10000;
          break;
        case 5:
          if ((*(uint *)(param_1 + 0x1230) >> 0xb & 1) == 0) goto switchD_004608a4_caseD_a;
          iVar7 = 0;
          *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x100000;
          goto LAB_004608d8;
        case 10:
        case 0xd:
          goto switchD_004608a4_caseD_a;
        case 0xb:
          if ((*(uint *)(param_1 + 0x1230) >> 5 & 1) != 0) {
            *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) & 0xffffffdf;
            iVar7 = 0;
          }
          if ((byte *)(uint)*pbVar4 != pbVar10 + -1) goto LAB_0046096c;
          break;
        case 0x10:
          if ((*(uint *)(param_1 + 0x1230) >> 7 & 1) == 0) goto switchD_004608a4_caseD_a;
          pcVar11 = *(code **)(param_1 + 0xd44);
          uVar6 = *(uint *)(param_1 + 0x1230) & 0xffffff7f;
LAB_00460a1c:
          *(uint *)(param_1 + 0x1230) = uVar6;
          iVar7 = 0;
          pbVar3 = pbVar10;
          if (pcVar11 != (code *)0x0) {
LAB_004608bc:
            iVar7 = (*pcVar11)(param_1,sVar9,(uint)pbVar3 & 0xff,pbVar4);
            break;
          }
          goto LAB_004608d8;
        case 0x17:
          if ((*(uint *)(param_1 + 0x1230) >> 3 & 1) != 0) {
            *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) & 0xfffffff7;
            iVar7 = 0;
          }
          if (pbVar10 != (byte *)0x0) goto LAB_00460c48;
          *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) | 0x20000;
          break;
        case 0x23:
          if ((*(uint *)(param_1 + 0x1230) >> 8 & 1) != 0) {
            *(uint *)(param_1 + 0x1230) = *(uint *)(param_1 + 0x1230) & 0xfffffeff;
            iVar7 = 0;
          }
          iVar8 = *(int *)(param_1 + 0xcbc);
          if ((iVar8 == 0) || ((*(short *)(iVar8 + 0x5c) != 1 && (*(short *)(iVar8 + 0x5c) != 2))))
          goto LAB_00460c48;
          *(undefined2 *)(iVar8 + 0x5c) = 3;
        }
        if (iVar7 < 0) {
switchD_004608a4_caseD_a:
          if (*(byte *)(param_1 + 0xd3e) < 3) {
            *(undefined4 *)(param_1 + 0xd30) = 0x2f;
          }
          else {
            *(undefined4 *)(param_1 + 0xd30) = 0x6e;
          }
          return -0xc;
        }
LAB_004608d8:
        if (iVar7 < 0) {
          return iVar7;
        }
        pbVar4 = pbVar4 + (int)pbVar10;
        iVar8 = (int)pbVar4 - param_3;
      } while( true );
    }
  }
  *(undefined4 *)(param_1 + 0xd30) = 0x32;
  return -0xc;
}



void psAesClearCBC(undefined4 param_1)

{
                    // WARNING: Treating indirect jump as call
  memset_s(param_1,0x114,0,0x114);
  return;
}



int psAesInitCBC(int param_1,int param_2,undefined4 param_3,undefined param_4,undefined4 param_5)

{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  
  iVar1 = psAesInitBlockKey(param_1,param_3,param_4,param_5,&_gp);
  if (iVar1 == 0) {
    iVar1 = 0;
    do {
      puVar3 = (undefined *)(param_2 + iVar1);
      iVar2 = iVar1 + param_1;
      iVar1 = iVar1 + 1;
      *(undefined *)(iVar2 + 0x104) = *puVar3;
    } while (iVar1 < 0x10);
    iVar1 = 0;
  }
  return iVar1;
}



void psAesEncryptCBC(int param_1,int param_2,int param_3,uint param_4)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  byte *pbVar4;
  undefined *puVar5;
  uint uVar6;
  byte local_30 [16];
  
  uVar6 = 0;
  if (param_4 != 0) {
    do {
      uVar3 = 0;
      do {
        pbVar4 = (byte *)(param_2 + uVar3);
        iVar1 = uVar3 + param_1;
        pbVar2 = local_30 + uVar3;
        uVar3 = uVar3 + 1;
        *pbVar2 = *pbVar4 ^ *(byte *)(iVar1 + 0x104);
      } while (uVar3 < 0x10);
      psAesEncryptBlock(param_1,local_30,param_3);
      uVar3 = 0;
      do {
        puVar5 = (undefined *)(param_3 + uVar3);
        iVar1 = uVar3 + param_1;
        uVar3 = uVar3 + 1;
        *(undefined *)(iVar1 + 0x104) = *puVar5;
      } while (uVar3 < 0x10);
      uVar6 = uVar6 + 0x10;
      param_3 = param_3 + 0x10;
      param_2 = param_2 + 0x10;
    } while (uVar6 < param_4);
  }
  memset_s(local_30,0x10,0,0x10);
  return;
}



void psAesDecryptCBC(int param_1,int param_2,int param_3,uint param_4)

{
  undefined *puVar1;
  undefined uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  byte local_40 [16];
  undefined local_30 [16];
  
  uVar6 = 0;
  if (param_4 != 0) {
    do {
      psAesDecryptBlock(param_1,param_2,local_40);
      uVar3 = 0;
      do {
        uVar2 = *(undefined *)(param_2 + uVar3);
        uVar4 = uVar3 + 1;
        *(byte *)(param_3 + uVar3) = local_40[uVar3] ^ *(byte *)(uVar3 + param_1 + 0x104);
        local_30[uVar3] = uVar2;
        uVar3 = uVar4;
      } while (uVar4 < 0x10);
      uVar3 = 0;
      do {
        iVar5 = uVar3 + param_1;
        puVar1 = local_30 + uVar3;
        uVar3 = uVar3 + 1;
        *(undefined *)(iVar5 + 0x104) = *puVar1;
      } while (uVar3 < 0x10);
      uVar6 = uVar6 + 0x10;
      param_2 = param_2 + 0x10;
      param_3 = param_3 + 0x10;
    } while (uVar6 < param_4);
  }
  memset_s(local_40,0x10,0,0x10);
  memset_s(local_30,0x10,0,0x10);
  return;
}



int psAesInitGCM(void *param_1,undefined4 param_2,undefined param_3)

{
  int iVar1;
  undefined4 local_20;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  
  local_20 = 0;
  local_1c = 0;
  local_18 = 0;
  local_14 = 0;
  memset(param_1,0,0x1fc);
  iVar1 = psAesInitBlockKey(param_1,param_2,param_3,1);
  if (-1 < iVar1) {
    psAesEncryptBlock(param_1,&local_20,(int)param_1 + 0x134);
    iVar1 = 0;
  }
  return iVar1;
}



void FUN_00461024(int param_1,byte *param_2,uint *param_3)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar7 = *param_3 ^
          ((uint)*param_2 << 0x18 | (uint)param_2[1] << 0x10 | (uint)param_2[2] << 8 |
          (uint)param_2[3]);
  *param_3 = uVar7;
  uVar6 = param_3[1] ^
          ((uint)param_2[4] << 0x18 | (uint)param_2[5] << 0x10 | (uint)param_2[6] << 8 |
          (uint)param_2[7]);
  param_3[1] = uVar6;
  uVar4 = param_3[2] ^
          ((uint)param_2[8] << 0x18 | (uint)param_2[9] << 0x10 | (uint)param_2[10] << 8 |
          (uint)param_2[0xb]);
  param_3[2] = uVar4;
  uVar5 = param_3[3] ^
          ((uint)param_2[0xc] << 0x18 | (uint)param_2[0xd] << 0x10 | (uint)param_2[0xe] << 8 |
          (uint)param_2[0xf]);
  iVar3 = 0;
  param_3[3] = 0;
  param_3[2] = 0;
  param_3[1] = 0;
  *param_3 = 0;
  do {
    uVar2 = 0x1f - iVar3;
    uVar9 = uVar7 >> 1;
    uVar8 = uVar5 & 1;
    iVar1 = iVar3;
    if (iVar3 < 0) {
      iVar1 = iVar3 + 0x1f;
    }
    iVar3 = iVar3 + 1;
    if ((*(uint *)((iVar1 >> 5) * 4 + param_1) & 1 << (uVar2 & 0x1f)) != 0) {
      *param_3 = *param_3 ^ uVar7;
      param_3[1] = param_3[1] ^ uVar6;
      param_3[2] = param_3[2] ^ uVar4;
      param_3[3] = param_3[3] ^ uVar5;
    }
    uVar5 = uVar5 >> 1 | uVar4 << 0x1f;
    uVar4 = uVar4 >> 1 | uVar6 << 0x1f;
    uVar6 = uVar6 >> 1 | uVar7 << 0x1f;
    if (uVar8 != 0) {
      uVar9 = uVar9 ^ 0xe1000000;
    }
    uVar7 = uVar9;
  } while (iVar3 < 0x80);
  return;
}



void FUN_00461208(int param_1,byte *param_2,byte *param_3,uint param_4,char param_5)

{
  undefined *puVar1;
  char cVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  uint __n;
  byte *pbVar7;
  
  if (param_5 == '\0') {
    iVar6 = *(int *)(param_1 + 0x16c);
    iVar4 = iVar6 + (param_4 & 0xfffffff) * 8;
    *(int *)(param_1 + 0x16c) = iVar4;
    if (iVar4 < iVar6) {
      *(int *)(param_1 + 0x170) = *(int *)(param_1 + 0x170) + 1;
    }
    uVar5 = param_4 & 0xfffffff;
    if (0xfffffff < uVar5) {
      do {
        iVar6 = *(int *)(param_1 + 0x16c);
        uVar5 = uVar5 + 0xf0000000;
        iVar4 = iVar6 + -0x80000000;
        *(int *)(param_1 + 0x16c) = iVar4;
        if (iVar4 < iVar6) {
          *(int *)(param_1 + 0x170) = *(int *)(param_1 + 0x170) + 1;
        }
      } while (0xfffffff < (int)uVar5);
    }
    if (param_4 == 0) goto LAB_00461484;
    uVar5 = param_4;
    pbVar7 = param_2;
    do {
      puVar1 = PTR_FUN_004d4a7c;
      uVar3 = *(uint *)(param_1 + 0x174);
      if (uVar3 == 0x80) {
        iVar4 = param_1 + 0x17c;
        iVar6 = 0x80;
        do {
          iVar6 = iVar6 + -0x10;
          (*(code *)puVar1)(param_1 + 0x154,iVar4,param_1 + 0x144);
          iVar4 = iVar4 + 0x10;
        } while (0xf < iVar6);
        uVar3 = 0;
        *(undefined4 *)(param_1 + 0x174) = 0;
LAB_00461310:
        __n = 0x80 - uVar3;
        if (uVar5 < 0x80 - uVar3) {
          __n = uVar5;
        }
        memcpy((void *)(uVar3 + param_1 + 0x17c),pbVar7,__n);
        pbVar7 = pbVar7 + __n;
        *(uint *)(param_1 + 0x174) = *(int *)(param_1 + 0x174) + __n;
        uVar5 = uVar5 - __n;
      }
      else if (uVar3 < 0x80) goto LAB_00461310;
    } while (uVar5 != 0);
  }
  if (param_4 != 0) {
    iVar4 = *(int *)(param_1 + 0x178);
    uVar5 = param_4;
    pbVar7 = param_3;
    do {
      while (iVar4 != 0) {
        uVar5 = uVar5 - 1;
        *pbVar7 = *param_2 ^ *(byte *)((param_1 - iVar4) + 0x134);
        param_2 = param_2 + 1;
        iVar4 = *(int *)(param_1 + 0x178) + -1;
        pbVar7 = pbVar7 + 1;
        *(int *)(param_1 + 0x178) = iVar4;
        if (uVar5 == 0) goto LAB_00461484;
      }
      *(undefined4 *)(param_1 + 0x178) = 0x10;
      psAesEncryptBlock(param_1,param_1 + 0x114,param_1 + 0x124);
      iVar4 = 0xf;
      do {
        iVar6 = iVar4 + param_1;
        iVar4 = iVar4 + -1;
        cVar2 = *(char *)(iVar6 + 0x114) + '\x01';
        *(char *)(iVar6 + 0x114) = cVar2;
        if (cVar2 != '\0') break;
      } while (-1 < iVar4);
      uVar5 = uVar5 - 1;
      *pbVar7 = *param_2 ^ *(byte *)((param_1 - *(int *)(param_1 + 0x178)) + 0x134);
      param_2 = param_2 + 1;
      iVar4 = *(int *)(param_1 + 0x178) + -1;
      pbVar7 = pbVar7 + 1;
      *(int *)(param_1 + 0x178) = iVar4;
    } while (uVar5 != 0);
  }
LAB_00461484:
  if (param_5 == '\x01') {
    iVar6 = *(int *)(param_1 + 0x16c);
    iVar4 = iVar6 + (param_4 & 0xfffffff) * 8;
    *(int *)(param_1 + 0x16c) = iVar4;
    if (iVar4 < iVar6) {
      *(int *)(param_1 + 0x170) = *(int *)(param_1 + 0x170) + 1;
    }
    uVar5 = param_4 & 0xfffffff;
    if (0xfffffff < uVar5) {
      do {
        iVar6 = *(int *)(param_1 + 0x16c);
        uVar5 = uVar5 + 0xf0000000;
        iVar4 = iVar6 + -0x80000000;
        *(int *)(param_1 + 0x16c) = iVar4;
        if (iVar4 < iVar6) {
          *(int *)(param_1 + 0x170) = *(int *)(param_1 + 0x170) + 1;
        }
      } while (0xfffffff < (int)uVar5);
    }
    if (param_4 != 0) {
      do {
        puVar1 = PTR_FUN_004d4a7c;
        uVar5 = *(uint *)(param_1 + 0x174);
        if (uVar5 == 0x80) {
          iVar4 = param_1 + 0x17c;
          iVar6 = 0x80;
          do {
            iVar6 = iVar6 + -0x10;
            (*(code *)puVar1)(param_1 + 0x154,iVar4,param_1 + 0x144);
            iVar4 = iVar4 + 0x10;
          } while (0xf < iVar6);
          uVar5 = 0;
          *(undefined4 *)(param_1 + 0x174) = 0;
LAB_00461584:
          uVar3 = 0x80 - uVar5;
          if (param_4 < 0x80 - uVar5) {
            uVar3 = param_4;
          }
          memcpy((void *)(uVar5 + param_1 + 0x17c),param_3,uVar3);
          param_3 = param_3 + uVar3;
          *(uint *)(param_1 + 0x174) = *(int *)(param_1 + 0x174) + uVar3;
          param_4 = param_4 - uVar3;
        }
        else if (uVar5 < 0x80) goto LAB_00461584;
      } while (param_4 != 0);
    }
  }
  return;
}



void psAesEncryptGCM(void)

{
  FUN_00461208();
  return;
}



void psAesReadyGCM(int param_1,undefined4 *param_2,void *param_3,uint param_4)

{
  uint uVar1;
  uint uVar2;
  undefined *puVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  uint uVar11;
  int iVar12;
  uint uVar13;
  undefined *puVar14;
  undefined local_30 [8];
  
  *(undefined4 *)(param_1 + 0x164) = 0;
  *(undefined4 *)(param_1 + 0x168) = 0;
  *(undefined4 *)(param_1 + 0x16c) = 0;
  *(undefined4 *)(param_1 + 0x170) = 0;
  *(undefined4 *)(param_1 + 0x174) = 0;
  *(uint *)(param_1 + 0x154) =
       (uint)*(byte *)(param_1 + 0x134) << 0x18 | (uint)*(byte *)(param_1 + 0x135) << 0x10 |
       (uint)*(byte *)(param_1 + 0x136) << 8 | (uint)*(byte *)(param_1 + 0x137);
  *(uint *)(param_1 + 0x158) =
       (uint)*(byte *)(param_1 + 0x138) << 0x18 | (uint)*(byte *)(param_1 + 0x139) << 0x10 |
       (uint)*(byte *)(param_1 + 0x13a) << 8 | (uint)*(byte *)(param_1 + 0x13b);
  uVar7 = (uint)*(byte *)(param_1 + 0x13c) << 0x18 | (uint)*(byte *)(param_1 + 0x13d) << 0x10;
  uVar5 = uVar7 | (uint)*(byte *)(param_1 + 0x13e) << 8;
  *(uint *)(param_1 + 0x15c) = uVar5 | *(byte *)(param_1 + 0x13f);
  *(uint *)(param_1 + 0x160) =
       (uint)*(byte *)(param_1 + 0x140) << 0x18 | (uint)*(byte *)(param_1 + 0x141) << 0x10 |
       (uint)*(byte *)(param_1 + 0x142) << 8 | (uint)*(byte *)(param_1 + 0x143);
  *(undefined4 *)(param_1 + 0x144) = 0;
  *(undefined4 *)(param_1 + 0x148) = 0;
  *(undefined4 *)(param_1 + 0x14c) = 0;
  *(undefined4 *)(param_1 + 0x150) = 0;
  *(undefined4 *)(param_1 + 0x104) = 0;
  *(undefined4 *)(param_1 + 0x108) = 0;
  *(undefined4 *)(param_1 + 0x10c) = 0;
  *(undefined4 *)(param_1 + 0x110) = 0;
  uVar10 = param_2[1];
  uVar9 = param_2[2];
  *(undefined4 *)(param_1 + 0x104) = *param_2;
  *(undefined *)(param_1 + 0x113) = 1;
  *(undefined4 *)(param_1 + 0x114) = 0;
  *(undefined4 *)(param_1 + 0x118) = 0;
  *(undefined4 *)(param_1 + 0x11c) = 0;
  *(undefined4 *)(param_1 + 0x120) = 0;
  *(undefined4 *)(param_1 + 0x108) = uVar10;
  *(undefined4 *)(param_1 + 0x10c) = uVar9;
  uVar6 = (int)param_2 + 3U & 3;
  uVar13 = (int)param_2 + 7U & 3;
  iVar12 = *(int *)(((int)param_2 + 7U) - uVar13);
  iVar8 = *(int *)(param_1 + 0x164);
  param_4 = param_4 & 0xffff;
  uVar9 = param_2[2];
  uVar11 = (uint)param_2 & 3;
  uVar1 = (uint)(param_2 + 1) & 3;
  uVar2 = *(uint *)((int)(param_2 + 1) - uVar1);
  iVar4 = iVar8 + param_4 * 8;
  *(uint *)(param_1 + 0x114) =
       (*(int *)(((int)param_2 + 3U) - uVar6) << (3 - uVar6) * 8 |
       uVar7 & 0xffffffffU >> (uVar6 + 1) * 8) & -1 << (4 - uVar11) * 8 |
       *(uint *)((int)param_2 - uVar11) >> uVar11 * 8;
  *(uint *)(param_1 + 0x118) =
       (iVar12 << (3 - uVar13) * 8 | uVar5 & 0xffffffffU >> (uVar13 + 1) * 8) &
       -1 << (4 - uVar1) * 8 | uVar2 >> uVar1 * 8;
  *(undefined4 *)(param_1 + 0x11c) = uVar9;
  *(undefined *)(param_1 + 0x123) = 2;
  *(int *)(param_1 + 0x164) = iVar4;
  if (iVar4 < iVar8) {
    *(int *)(param_1 + 0x168) = *(int *)(param_1 + 0x168) + 1;
  }
  uVar6 = param_4;
  if (0xfffffff < param_4) {
    do {
      iVar4 = *(int *)(param_1 + 0x164);
      uVar6 = uVar6 + 0xf0000000;
      iVar12 = iVar4 + -0x80000000;
      *(int *)(param_1 + 0x164) = iVar12;
      if (iVar12 < iVar4) {
        *(int *)(param_1 + 0x168) = *(int *)(param_1 + 0x168) + 1;
      }
    } while (0xfffffff < (int)uVar6);
  }
  if (param_4 == 0) {
    uVar6 = *(uint *)(param_1 + 0x174);
  }
  else {
    uVar6 = *(uint *)(param_1 + 0x174);
    do {
      puVar14 = PTR_FUN_004d4a80;
      if (uVar6 == 0x80) {
        iVar12 = param_1 + 0x17c;
        iVar4 = 0x80;
        do {
          iVar4 = iVar4 + -0x10;
          (*(code *)puVar14)(param_1 + 0x154,iVar12,param_1 + 0x144);
          iVar12 = iVar12 + 0x10;
        } while (0xf < iVar4);
        uVar6 = 0;
        *(undefined4 *)(param_1 + 0x174) = 0;
LAB_004618bc:
        uVar13 = 0x80 - uVar6;
        if (param_4 < 0x80 - uVar6) {
          uVar13 = param_4;
        }
        memcpy((void *)(uVar6 + param_1 + 0x17c),param_3,uVar13);
        uVar6 = *(int *)(param_1 + 0x174) + uVar13;
        param_3 = (void *)((int)param_3 + uVar13);
        param_4 = param_4 - uVar13;
        *(uint *)(param_1 + 0x174) = uVar6;
      }
      else if (uVar6 < 0x80) goto LAB_004618bc;
    } while (param_4 != 0);
  }
  if ((uVar6 & 0xf) != 0) {
    do {
      puVar14 = local_30;
      uVar13 = 1;
      local_30[0] = 0;
      do {
        puVar3 = PTR_FUN_004d4a80;
        if (uVar6 == 0x80) {
          iVar12 = param_1 + 0x17c;
          iVar4 = 0x80;
          do {
            iVar4 = iVar4 + -0x10;
            (*(code *)puVar3)(param_1 + 0x154,iVar12,param_1 + 0x144);
            iVar12 = iVar12 + 0x10;
          } while (0xf < iVar4);
          uVar6 = 0;
          *(undefined4 *)(param_1 + 0x174) = 0;
LAB_00461988:
          uVar11 = 0x80 - uVar6;
          if (uVar13 < 0x80 - uVar6) {
            uVar11 = uVar13;
          }
          memcpy((void *)(uVar6 + param_1 + 0x17c),puVar14,uVar11);
          uVar6 = *(int *)(param_1 + 0x174) + uVar11;
          puVar14 = puVar14 + uVar11;
          uVar13 = uVar13 - uVar11;
          *(uint *)(param_1 + 0x174) = uVar6;
        }
        else if (uVar6 < 0x80) goto LAB_00461988;
      } while (uVar13 != 0);
    } while ((uVar6 & 0xf) != 0);
  }
  return;
}



void FUN_00461a60(int param_1)

{
  undefined *puVar1;
  uint uVar2;
  uint *puVar3;
  uint *puVar4;
  uint __n;
  int iVar5;
  int iVar6;
  uint uVar7;
  undefined *__src;
  undefined local_30 [4];
  int local_2c;
  
  uVar2 = *(uint *)(param_1 + 0x174);
  if ((uVar2 & 0xf) == 0) {
    local_2c = param_1 + 0x17c;
  }
  else {
    local_2c = param_1 + 0x17c;
    do {
      __src = local_30;
      uVar7 = 1;
      local_30[0] = 0;
      do {
        puVar1 = PTR_FUN_004d4a84;
        if (uVar2 == 0x80) {
          iVar6 = 0x80;
          iVar5 = local_2c;
          do {
            iVar6 = iVar6 + -0x10;
            (*(code *)puVar1)(param_1 + 0x154,iVar5,param_1 + 0x144);
            iVar5 = iVar5 + 0x10;
          } while (0xf < iVar6);
          uVar2 = 0;
          *(undefined4 *)(param_1 + 0x174) = 0;
LAB_00461adc:
          __n = 0x80 - uVar2;
          if (uVar7 < 0x80 - uVar2) {
            __n = uVar7;
          }
          memcpy((void *)(uVar2 + param_1 + 0x17c),__src,__n);
          uVar2 = *(int *)(param_1 + 0x174) + __n;
          __src = __src + __n;
          uVar7 = uVar7 - __n;
          *(uint *)(param_1 + 0x174) = uVar2;
        }
        else if (uVar2 < 0x80) goto LAB_00461adc;
      } while (uVar7 != 0);
    } while ((uVar2 & 0xf) != 0);
  }
  iVar5 = 2;
  puVar4 = (uint *)(param_1 + 0x174);
  do {
    puVar3 = puVar4 + -2;
    uVar7 = (*puVar3 & 0xff00ff00) >> 8 | (*puVar3 & 0xff00ff) << 8;
    uVar2 = (puVar4[-1] & 0xff00ff00) >> 8 | (puVar4[-1] & 0xff00ff) << 8;
    iVar5 = iVar5 + -1;
    *puVar3 = uVar2 << 0x10 | uVar2 >> 0x10;
    puVar4[-1] = uVar7 << 0x10 | uVar7 >> 0x10;
    puVar4 = puVar3;
  } while (iVar5 != 0);
  iVar6 = local_2c;
  for (iVar5 = *(int *)(param_1 + 0x174); 0xf < iVar5; iVar5 = iVar5 + -0x10) {
    FUN_00461024(param_1 + 0x154,iVar6,param_1 + 0x144);
    iVar6 = iVar6 + 0x10;
  }
  *(undefined4 *)(param_1 + 0x174) = 0;
  FUN_00461024(param_1 + 0x154,param_1 + 0x164,param_1 + 0x144);
  puVar4 = (uint *)(param_1 + 0x154);
  iVar5 = 4;
  do {
    puVar4 = puVar4 + -1;
    iVar5 = iVar5 + -1;
    uVar2 = (*puVar4 & 0xff00ff00) >> 8 | (*puVar4 & 0xff00ff) << 8;
    *puVar4 = uVar2 << 0x10 | uVar2 >> 0x10;
  } while (iVar5 != 0);
  return;
}



void psAesGetGCMTag(int param_1,char param_2,byte *param_3)

{
  byte *pbVar1;
  
  FUN_00461a60();
  *(undefined4 *)(param_1 + 0x178) = 0;
  pbVar1 = (byte *)(param_1 + 0x144);
  if (param_2 != '\0') {
    do {
      while( true ) {
        if (*(int *)(param_1 + 0x178) != 0) break;
        *(undefined4 *)(param_1 + 0x178) = 0x10;
        psAesEncryptBlock(param_1,param_1 + 0x104,param_1 + 0x124);
        param_2 = param_2 + -1;
        *param_3 = *pbVar1 ^ *(byte *)((param_1 - *(int *)(param_1 + 0x178)) + 0x134);
        pbVar1 = pbVar1 + 1;
        *(int *)(param_1 + 0x178) = *(int *)(param_1 + 0x178) + -1;
        param_3 = param_3 + 1;
        if (param_2 == '\0') {
          return;
        }
      }
      param_2 = param_2 + -1;
      *param_3 = *pbVar1 ^ *(byte *)((param_1 - *(int *)(param_1 + 0x178)) + 0x134);
      pbVar1 = pbVar1 + 1;
      *(int *)(param_1 + 0x178) = *(int *)(param_1 + 0x178) + -1;
      param_3 = param_3 + 1;
    } while (param_2 != '\0');
  }
  return;
}



undefined4 psAesDecryptGCM(int param_1,int param_2,uint param_3,undefined4 param_4,uint param_5)

{
  undefined4 uVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  uint uVar5;
  byte local_30 [16];
  
  uVar1 = 0xfffffffa;
  if (param_5 < param_3) {
    param_3 = param_3 - param_5;
    uVar5 = param_3 & 0xffff;
    FUN_00461208(param_1,param_2,param_4,param_5,0);
    pbVar4 = local_30;
    FUN_00461a60(param_1);
    pbVar3 = (byte *)(param_1 + 0x144);
    *(undefined4 *)(param_1 + 0x178) = 0;
    while( true ) {
      if ((param_3 & 0xff) == 0) break;
      iVar2 = *(int *)(param_1 + 0x178);
      if (iVar2 == 0) {
        *(undefined4 *)(param_1 + 0x178) = 0x10;
        psAesEncryptBlock(param_1,param_1 + 0x104,param_1 + 0x124);
        iVar2 = *(int *)(param_1 + 0x178);
      }
      param_3 = (param_3 & 0xff) - 1;
      *pbVar4 = *pbVar3 ^ *(byte *)((param_1 - iVar2) + 0x134);
      pbVar3 = pbVar3 + 1;
      *(int *)(param_1 + 0x178) = iVar2 + -1;
      pbVar4 = pbVar4 + 1;
    }
    iVar2 = memcmpct(local_30,param_2 + param_5,uVar5);
    uVar1 = 0xffffffd7;
    if (iVar2 == 0) {
      uVar1 = 0;
    }
  }
  return uVar1;
}



void FUN_00461f78(int param_1)

{
  uint uVar1;
  int *piVar2;
  uint *puVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint local_150 [20];
  int local_100 [60];
  
  uVar14 = 0;
  do {
    iVar12 = uVar14 * 4 + param_1;
    uVar5 = uVar14 + 1;
    local_150[uVar14] =
         (uint)*(byte *)(iVar12 + 0x20) << 0x18 | (uint)*(byte *)(iVar12 + 0x21) << 0x10 |
         (uint)*(byte *)(iVar12 + 0x22) << 8 | (uint)*(byte *)(iVar12 + 0x23);
    uVar14 = uVar5;
  } while (uVar5 < 0x10);
  uVar17 = *(uint *)(param_1 + 8);
  uVar14 = *(uint *)(param_1 + 0xc);
  uVar5 = *(uint *)(param_1 + 0x10);
  uVar15 = *(uint *)(param_1 + 0x14);
  uVar16 = *(uint *)(param_1 + 0x18);
  puVar3 = local_150 + 0x10;
  iVar12 = 0x3f;
  do {
    uVar1 = puVar3[-3] ^ puVar3[-8] ^ puVar3[-0xe] ^ puVar3[-0x10];
    iVar12 = iVar12 + -1;
    *puVar3 = uVar1 << 1 | uVar1 >> 0x1f;
    puVar3 = puVar3 + 1;
  } while (-1 < iVar12);
  iVar12 = 0x13;
  puVar3 = local_150;
  uVar1 = uVar15;
  uVar7 = uVar14;
  uVar11 = uVar5;
  uVar6 = uVar17;
  uVar4 = uVar16;
  do {
    uVar8 = uVar6;
    uVar10 = uVar11;
    uVar13 = uVar1;
    uVar6 = (uVar8 << 5 | uVar8 >> 0x1b) + ((uVar10 ^ uVar13) & uVar7 ^ uVar13) + uVar4 + *puVar3 +
            0x5a827999;
    iVar12 = iVar12 + -1;
    puVar3 = puVar3 + 1;
    uVar11 = uVar7 << 0x1e | uVar7 >> 2;
    uVar1 = uVar10;
    uVar7 = uVar8;
    uVar4 = uVar13;
  } while (-1 < iVar12);
  piVar2 = local_100;
  uVar1 = 0x14;
  do {
    uVar4 = uVar11;
    uVar9 = uVar6;
    uVar7 = uVar10;
    uVar1 = uVar1 + 1;
    uVar6 = (uVar9 << 5 | uVar9 >> 0x1b) + (uVar8 ^ uVar4 ^ uVar7) + uVar13 + *piVar2 + 0x6ed9eba1;
    piVar2 = piVar2 + 1;
    uVar11 = uVar8 << 0x1e | uVar8 >> 2;
    uVar10 = uVar4;
    uVar8 = uVar9;
    uVar13 = uVar7;
  } while (uVar1 < 0x28);
  if (uVar1 < 0x3c) {
    puVar3 = local_150 + uVar1;
    do {
      uVar4 = uVar11;
      uVar9 = uVar6;
      uVar7 = uVar10;
      uVar1 = uVar1 + 1;
      uVar6 = (uVar9 << 5 | uVar9 >> 0x1b) + (uVar8 & uVar4 | (uVar8 | uVar4) & uVar7) + uVar13 +
              *puVar3 + 0x8f1bbcdc;
      puVar3 = puVar3 + 1;
      uVar11 = uVar8 << 0x1e | uVar8 >> 2;
      uVar10 = uVar4;
      uVar8 = uVar9;
      uVar13 = uVar7;
    } while (uVar1 < 0x3c);
  }
  if (uVar1 < 0x50) {
    puVar3 = local_150 + uVar1;
    uVar10 = uVar4;
    uVar8 = uVar9;
    uVar13 = uVar7;
    do {
      uVar9 = uVar6;
      uVar4 = uVar11;
      uVar7 = uVar10;
      uVar1 = uVar1 + 1;
      uVar6 = (uVar9 << 5 | uVar9 >> 0x1b) + (uVar8 ^ uVar4 ^ uVar7) + uVar13 + *puVar3 + 0xca62c1d6
      ;
      puVar3 = puVar3 + 1;
      uVar11 = uVar8 << 0x1e | uVar8 >> 2;
      uVar10 = uVar4;
      uVar8 = uVar9;
      uVar13 = uVar7;
    } while (uVar1 < 0x50);
  }
  *(uint *)(param_1 + 0x18) = uVar16 + uVar7;
  *(uint *)(param_1 + 8) = uVar17 + uVar6;
  *(uint *)(param_1 + 0xc) = uVar14 + uVar9;
  *(uint *)(param_1 + 0x10) = uVar5 + uVar11;
  *(uint *)(param_1 + 0x14) = uVar15 + uVar4;
  return;
}



undefined4 psSha1Init(undefined4 *param_1)

{
  *param_1 = 0;
  param_1[2] = 0x67452301;
  param_1[3] = 0xefcdab89;
  param_1[4] = 0x98badcfe;
  param_1[5] = 0x10325476;
  param_1[6] = 0xc3d2e1f0;
  param_1[1] = 0;
  param_1[7] = 0;
  return 0;
}



void psSha1Update(uint *param_1,void *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  
  if (param_3 != 0) {
    do {
      while( true ) {
        uVar2 = 0x40 - param_1[7];
        if (param_3 < uVar2) {
          uVar2 = param_3;
        }
        memcpy((void *)((int)param_1 + param_1[7] + 0x20),param_2,uVar2);
        uVar1 = param_1[7];
        param_3 = param_3 - uVar2;
        param_2 = (void *)((int)param_2 + uVar2);
        param_1[7] = uVar1 + uVar2;
        if (uVar1 + uVar2 != 0x40) break;
        FUN_00461f78(param_1);
        psBurnStack(0x15c);
        uVar2 = *param_1;
        param_1[7] = 0;
        *param_1 = uVar2 + 0x200;
        param_1[1] = param_1[1] + (uint)(uVar2 + 0x200 < 0x200);
        if (param_3 == 0) {
          return;
        }
      }
    } while (param_3 != 0);
  }
  return;
}



void psSha1Final(uint *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined *puVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  
  uVar2 = param_1[7];
  uVar7 = *param_1 + uVar2 * 8;
  uVar6 = uVar2 + 1;
  uVar8 = param_1[1] + (uint)(uVar7 < uVar2 * 8);
  *(undefined *)((int)param_1 + uVar2 + 0x20) = 0x80;
  *param_1 = uVar7;
  param_1[1] = uVar8;
  param_1[7] = uVar6;
  if (0x38 < uVar6) {
    if (uVar6 < 0x40) {
      do {
        uVar2 = uVar6 + 1;
        *(undefined *)((int)param_1 + uVar6 + 0x20) = 0;
        uVar6 = uVar2;
      } while (uVar2 < 0x40);
      param_1[7] = uVar2;
    }
    FUN_00461f78(param_1);
    psBurnStack(0x15c);
    uVar7 = *param_1;
    uVar8 = param_1[1];
    param_1[7] = 0;
  }
  uVar6 = param_1[7];
  if (param_1[7] < 0x38) {
    do {
      uVar2 = uVar6 + 1;
      *(undefined *)((int)param_1 + uVar6 + 0x20) = 0;
      uVar6 = uVar2;
    } while (uVar2 < 0x38);
    param_1[7] = uVar2;
  }
  *(char *)(param_1 + 0x17) = (char)(uVar7 >> 0x18);
  *(char *)(param_1 + 0x16) = (char)(uVar8 >> 0x18);
  *(char *)((int)param_1 + 0x59) = (char)(uVar8 >> 0x10);
  *(char *)((int)param_1 + 0x5a) = (char)(uVar8 >> 8);
  *(char *)((int)param_1 + 0x5b) = (char)uVar8;
  *(char *)((int)param_1 + 0x5d) = (char)(uVar7 >> 0x10);
  *(char *)((int)param_1 + 0x5e) = (char)(uVar7 >> 8);
  *(undefined *)((int)param_1 + 0x5f) = *(undefined *)param_1;
  FUN_00461f78(param_1);
  psBurnStack(0x15c);
  iVar3 = 0;
  do {
    iVar1 = iVar3 * 4;
    puVar5 = (undefined *)(iVar1 + param_2);
    *puVar5 = *(undefined *)((int)param_1 + iVar1 + 0xb);
    iVar4 = iVar3 + 1;
    puVar5[1] = (char)*(undefined2 *)((int)param_1 + iVar1 + 10);
    puVar5[2] = (char)(param_1[iVar3 + 2] >> 8);
    puVar5[3] = (char)param_1[iVar3 + 2];
    iVar3 = iVar4;
  } while (iVar4 < 5);
  memset(param_1,0,0x60);
  return;
}



void FUN_004625a4(int param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  undefined *puVar3;
  int iVar4;
  uint *puVar5;
  uint uVar6;
  byte *pbVar7;
  uint uVar8;
  uint local_130 [8];
  uint local_110 [8];
  undefined auStack_f0 [4];
  int local_ec [5];
  uint local_d8 [50];
  
  iVar4 = 0;
  do {
    iVar2 = iVar4 + 1;
    local_130[iVar4] = *(uint *)(iVar4 * 4 + param_1 + 8);
    iVar4 = iVar2;
  } while (iVar2 < 8);
  iVar4 = 0;
  do {
    pbVar7 = (byte *)(iVar4 * 4 + param_2);
    iVar2 = iVar4 + 1;
    local_110[iVar4] =
         (uint)*pbVar7 << 0x18 | (uint)pbVar7[1] << 0x10 | (uint)pbVar7[2] << 8 | (uint)pbVar7[3];
    iVar4 = iVar2;
  } while (iVar2 < 0x10);
  puVar3 = auStack_f0;
  iVar4 = 0x2f;
  do {
    uVar1 = *(uint *)(puVar3 + 0x18);
    uVar6 = *(uint *)(puVar3 + -0x1c);
    iVar4 = iVar4 + -1;
    *(uint *)(puVar3 + 0x20) =
         ((uVar1 << 0xf | uVar1 >> 0x11) ^ (uVar1 << 0xd | uVar1 >> 0x13) ^ uVar1 >> 10) +
         *(int *)(puVar3 + 4) +
         ((uVar6 << 0x19 | uVar6 >> 7) ^ (uVar6 << 0xe | uVar6 >> 0x12) ^ uVar6 >> 3) +
         *(int *)(puVar3 + -0x20);
    puVar3 = puVar3 + 4;
  } while (-1 < iVar4);
  iVar4 = 0;
  do {
    uVar8 = local_130[5];
    uVar6 = local_130[2];
    local_130[2] = local_130[1];
    uVar1 = local_130[6];
    local_130[5] = local_130[4];
    local_130[1] = local_130[0];
    iVar2 = local_130[7] +
            ((local_130[5] << 0x1a | local_130[5] >> 6) ^
             (local_130[5] << 0x15 | local_130[5] >> 0xb) ^
            (local_130[5] << 7 | local_130[5] >> 0x19)) + (uVar1 ^ local_130[5] & (uVar8 ^ uVar1)) +
            (&DAT_004909b0)[iVar4] + local_110[iVar4];
    iVar4 = iVar4 + 1;
    local_130[0] = iVar2 + ((local_130[1] << 0x1e | local_130[1] >> 2) ^
                            (local_130[1] << 0x13 | local_130[1] >> 0xd) ^
                           (local_130[1] << 10 | local_130[1] >> 0x16)) +
                           ((local_130[1] | local_130[2]) & uVar6 | local_130[1] & local_130[2]);
    local_130[4] = local_130[3] + iVar2;
    local_130[7] = uVar1;
    local_130[6] = uVar8;
    local_130[3] = uVar6;
  } while (iVar4 < 0x40);
  iVar4 = 0;
  do {
    iVar2 = iVar4 * 4 + param_1;
    puVar5 = local_130 + iVar4;
    iVar4 = iVar4 + 1;
    *(uint *)(iVar2 + 8) = *(int *)(iVar2 + 8) + *puVar5;
  } while (iVar4 < 8);
  return;
}



undefined4 psSha256Init(undefined4 *param_1)

{
  param_1[2] = 0x6a09e667;
  *param_1 = 0;
  param_1[3] = 0xbb67ae85;
  param_1[4] = 0x3c6ef372;
  param_1[5] = 0xa54ff53a;
  param_1[6] = 0x510e527f;
  param_1[7] = 0x9b05688c;
  param_1[8] = 0x1f83d9ab;
  param_1[9] = 0x5be0cd19;
  param_1[1] = 0;
  param_1[10] = 0;
  return 0;
}



void psSha256Update(uint *param_1,void *param_2,uint param_3)

{
  uint uVar1;
  uint __n;
  
  if (param_3 != 0) {
    do {
      while( true ) {
        uVar1 = param_1[10];
        if ((uVar1 != 0) || (param_3 < 0x40)) break;
        FUN_004625a4(param_1);
        param_2 = (void *)((int)param_2 + 0x40);
        psBurnStack(0x128);
        uVar1 = *param_1;
        param_3 = param_3 - 0x40;
        *param_1 = uVar1 + 0x200;
        param_1[1] = param_1[1] + (uint)(uVar1 + 0x200 < 0x200);
LAB_00462994:
        if (param_3 == 0) {
          return;
        }
      }
      __n = 0x40 - uVar1;
      if (param_3 < 0x40 - uVar1) {
        __n = param_3;
      }
      memcpy((void *)((int)param_1 + uVar1 + 0x2c),param_2,__n);
      uVar1 = param_1[10];
      param_3 = param_3 - __n;
      param_2 = (void *)((int)param_2 + __n);
      param_1[10] = uVar1 + __n;
      if (uVar1 + __n == 0x40) {
        FUN_004625a4(param_1,param_1 + 0xb);
        psBurnStack(0x128);
        uVar1 = *param_1;
        param_1[10] = 0;
        *param_1 = uVar1 + 0x200;
        param_1[1] = param_1[1] + (uint)(uVar1 + 0x200 < 0x200);
        goto LAB_00462994;
      }
    } while (param_3 != 0);
  }
  return;
}



void psSha256Final(uint *param_1,int param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  undefined *puVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  
  uVar1 = param_1[10];
  uVar6 = *param_1 + uVar1 * 8;
  uVar4 = uVar1 + 1;
  uVar7 = param_1[1] + (uint)(uVar6 < uVar1 * 8);
  *(undefined *)((int)param_1 + uVar1 + 0x2c) = 0x80;
  *param_1 = uVar6;
  param_1[1] = uVar7;
  param_1[10] = uVar4;
  if (0x38 < uVar4) {
    if (uVar4 < 0x40) {
      do {
        uVar1 = uVar4 + 1;
        *(undefined *)((int)param_1 + uVar4 + 0x2c) = 0;
        uVar4 = uVar1;
      } while (uVar1 < 0x40);
      param_1[10] = uVar1;
    }
    FUN_004625a4(param_1,param_1 + 0xb);
    psBurnStack(0x128);
    uVar6 = *param_1;
    uVar7 = param_1[1];
    param_1[10] = 0;
  }
  uVar4 = param_1[10];
  if (param_1[10] < 0x38) {
    do {
      uVar1 = uVar4 + 1;
      *(undefined *)((int)param_1 + uVar4 + 0x2c) = 0;
      uVar4 = uVar1;
    } while (uVar1 < 0x38);
    param_1[10] = uVar1;
  }
  *(char *)(param_1 + 0x1a) = (char)(uVar6 >> 0x18);
  *(char *)(param_1 + 0x19) = (char)(uVar7 >> 0x18);
  *(char *)((int)param_1 + 0x65) = (char)(uVar7 >> 0x10);
  *(char *)((int)param_1 + 0x66) = (char)(uVar7 >> 8);
  *(char *)((int)param_1 + 0x67) = (char)uVar7;
  *(char *)((int)param_1 + 0x69) = (char)(uVar6 >> 0x10);
  *(char *)((int)param_1 + 0x6a) = (char)(uVar6 >> 8);
  *(undefined *)((int)param_1 + 0x6b) = *(undefined *)param_1;
  FUN_004625a4(param_1,param_1 + 0xb);
  psBurnStack(0x128);
  iVar2 = 0;
  do {
    iVar8 = iVar2 * 4;
    puVar5 = (undefined *)(iVar8 + param_2);
    *puVar5 = *(undefined *)((int)param_1 + iVar8 + 0xb);
    iVar3 = iVar2 + 1;
    puVar5[1] = (char)*(undefined2 *)((int)param_1 + iVar8 + 10);
    puVar5[2] = (char)(param_1[iVar2 + 2] >> 8);
    puVar5[3] = (char)param_1[iVar2 + 2];
    iVar2 = iVar3;
  } while (iVar3 < 8);
  memset(param_1,0,0x70);
  return;
}



void FUN_00462c2c(int param_1,int param_2)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  undefined *puVar12;
  int iVar13;
  uint uVar14;
  uint uVar15;
  byte *pbVar16;
  uint uVar17;
  uint local_318 [32];
  undefined auStack_298 [8];
  uint local_290 [10];
  uint local_268 [132];
  uint local_58;
  uint local_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  uint local_40;
  uint local_3c;
  uint local_38;
  uint local_34;
  uint local_30;
  uint local_2c;
  
  iVar13 = 0;
  do {
    iVar8 = iVar13 * 8 + param_1;
    uVar5 = *(uint *)(iVar8 + 0xc);
    iVar6 = iVar13 + 1;
    local_318[iVar13 * 2] = *(uint *)(iVar8 + 8);
    local_318[iVar13 * 2 + 1] = uVar5;
    iVar13 = iVar6;
  } while (iVar6 < 8);
  iVar13 = 0;
  do {
    pbVar16 = (byte *)(iVar13 * 8 + param_2);
    bVar1 = *pbVar16;
    bVar2 = pbVar16[1];
    bVar3 = pbVar16[2];
    bVar4 = pbVar16[3];
    iVar6 = iVar13 + 1;
    local_318[iVar13 * 2 + 0x10] =
         (uint)pbVar16[4] << 0x18 | (uint)pbVar16[5] << 0x10 | (uint)pbVar16[6] << 8 |
         (uint)pbVar16[7];
    local_318[iVar13 * 2 + 0x11] =
         (uint)bVar1 << 0x18 | (uint)bVar2 << 0x10 | (uint)bVar3 << 8 | (uint)bVar4;
    iVar13 = iVar6;
  } while (iVar6 < 0x10);
  puVar12 = auStack_298;
  iVar13 = 0x3f;
  do {
    uVar17 = *(uint *)(puVar12 + 0x34);
    uVar10 = *(uint *)(puVar12 + -0x34);
    uVar9 = *(uint *)(puVar12 + 0x30);
    uVar15 = *(uint *)(puVar12 + -0x38);
    uVar5 = ((uVar17 << 0xd | uVar9 >> 0x13) ^ (uVar17 >> 0x1d | uVar9 << 3) ^
            (uVar9 >> 6 | uVar17 << 0x1a)) + *(uint *)(puVar12 + 8);
    uVar7 = (uVar10 << 0x1f | uVar15 >> 1) ^ (uVar10 << 0x18 | uVar15 >> 8) ^
            (uVar15 >> 7 | uVar10 << 0x19);
    uVar14 = uVar5 + uVar7;
    uVar11 = uVar14 + *(uint *)(puVar12 + -0x40);
    iVar13 = iVar13 + -1;
    *(uint *)(puVar12 + 0x40) = uVar11;
    *(uint *)(puVar12 + 0x44) =
         ((uVar9 << 0xd | uVar17 >> 0x13) ^ (uVar9 >> 0x1d | uVar17 << 3) ^ uVar17 >> 6) +
         *(int *)(puVar12 + 0xc) + (uint)(uVar5 < *(uint *)(puVar12 + 8)) +
         ((uVar15 << 0x1f | uVar10 >> 1) ^ (uVar15 << 0x18 | uVar10 >> 8) ^ uVar10 >> 7) +
         (uint)(uVar14 < uVar7) + *(int *)(puVar12 + -0x3c) +
         (uint)(uVar11 < *(uint *)(puVar12 + -0x40));
    puVar12 = puVar12 + 8;
  } while (-1 < iVar13);
  local_44 = local_318[13];
  local_30 = local_318[4];
  local_40 = local_318[14];
  local_3c = local_318[15];
  local_50 = local_318[10];
  local_4c = local_318[11];
  local_48 = local_318[12];
  local_38 = local_318[2];
  local_34 = local_318[3];
  local_2c = local_318[5];
  local_58 = local_318[6];
  local_54 = local_318[7];
  iVar13 = 0;
  do {
    local_318[3] = local_318[1];
    local_318[2] = local_318[0];
    local_318[11] = local_318[9];
    local_318[10] = local_318[8];
    local_318[7] = local_2c;
    local_318[6] = local_30;
    local_318[5] = local_34;
    local_318[4] = local_38;
    local_318[15] = local_44;
    local_318[14] = local_48;
    local_318[13] = local_4c;
    local_318[12] = local_50;
    uVar7 = (local_318[11] << 0x12 | local_318[10] >> 0xe) ^
            (local_318[11] << 0xe | local_318[10] >> 0x12) ^
            (local_318[11] >> 9 | local_318[10] << 0x17);
    local_40 = local_40 + uVar7;
    uVar11 = local_48 ^ local_318[10] & (local_50 ^ local_48);
    uVar9 = local_40 + uVar11;
    uVar5 = (local_318[2] | local_38) & local_30 | local_318[2] & local_38;
    uVar14 = uVar9 + (&DAT_00490ab0)[iVar13 * 2];
    uVar10 = uVar14 + local_318[iVar13 * 2 + 0x10];
    uVar15 = ((local_318[3] << 4 | local_318[2] >> 0x1c) ^
              (local_318[3] >> 2 | local_318[2] << 0x1e) ^
             (local_318[3] >> 7 | local_318[2] << 0x19)) + uVar5;
    local_318[0] = uVar10 + uVar15;
    iVar6 = local_3c +
            ((local_318[10] << 0x12 | local_318[11] >> 0xe) ^
             (local_318[10] << 0xe | local_318[11] >> 0x12) ^
            (local_318[10] >> 9 | local_318[11] << 0x17)) + (uint)(local_40 < uVar7) +
            (local_44 ^ local_318[11] & (local_4c ^ local_44)) + (uint)(uVar9 < uVar11) +
            (&DAT_00490ab4)[iVar13 * 2] + (uint)(uVar14 < (uint)(&DAT_00490ab0)[iVar13 * 2]) +
            local_318[iVar13 * 2 + 0x11] + (uint)(uVar10 < local_318[iVar13 * 2 + 0x10]);
    local_318[8] = local_58 + uVar10;
    local_318[1] = iVar6 + ((local_318[2] << 4 | local_318[3] >> 0x1c) ^
                            (local_318[2] >> 2 | local_318[3] << 0x1e) ^
                           (local_318[2] >> 7 | local_318[3] << 0x19)) +
                           ((local_318[3] | local_34) & local_2c | local_318[3] & local_34) +
                           (uint)(uVar15 < uVar5) + (uint)(local_318[0] < uVar15);
    iVar13 = iVar13 + 1;
    local_318[9] = local_54 + iVar6 + (uint)(local_318[8] < uVar10);
    local_40 = local_48;
    local_3c = local_44;
    local_58 = local_30;
    local_54 = local_2c;
    local_48 = local_50;
    local_44 = local_4c;
    local_30 = local_38;
    local_50 = local_318[10];
    local_4c = local_318[11];
    local_38 = local_318[2];
    local_34 = local_318[3];
    local_2c = local_318[5];
  } while (iVar13 < 0x50);
  iVar13 = 0;
  do {
    iVar6 = iVar13 * 8 + param_1;
    uVar9 = local_318[iVar13 * 2];
    uVar7 = local_318[iVar13 * 2 + 1];
    uVar5 = *(int *)(iVar6 + 8) + uVar9;
    iVar13 = iVar13 + 1;
    *(uint *)(iVar6 + 8) = uVar5;
    *(uint *)(iVar6 + 0xc) = *(int *)(iVar6 + 0xc) + uVar7 + (uint)(uVar5 < uVar9);
  } while (iVar13 < 8);
  return;
}



undefined4 psSha512Init(undefined4 *param_1)

{
  param_1[0x10] = 0x137e2179;
  param_1[0x11] = 0x5be0cd19;
  param_1[2] = 0xf3bcc908;
  param_1[4] = 0x84caa73b;
  param_1[7] = 0x3c6ef372;
  param_1[8] = 0x5f1d36f1;
  param_1[3] = 0x6a09e667;
  param_1[5] = 0xbb67ae85;
  param_1[6] = 0xfe94f82b;
  *param_1 = 0;
  param_1[9] = 0xa54ff53a;
  param_1[10] = 0xade682d1;
  param_1[0xb] = 0x510e527f;
  param_1[0xc] = 0x2b3e6c1f;
  param_1[0xd] = 0x9b05688c;
  param_1[0xe] = 0xfb41bd6b;
  param_1[0xf] = 0x1f83d9ab;
  param_1[0x12] = 0;
  param_1[1] = 0;
  return 0;
}



void psSha512Update(uint *param_1,void *param_2,uint param_3)

{
  uint uVar1;
  uint __n;
  
  if (param_1 == (uint *)0x0) {
    _psTraceStr("psAssert %s","digest/sha512.c");
    _psTraceInt(&DAT_0049016c,0xd1);
    _psError("sha512 != NULL");
  }
  if (param_2 == (void *)0x0) {
    _psTraceStr("psAssert %s","digest/sha512.c");
    _psTraceInt(&DAT_0049016c,0xd2);
    _psError("buf != NULL");
  }
  if (param_3 != 0) {
    do {
      while( true ) {
        uVar1 = param_1[0x12];
        if ((uVar1 != 0) || (param_3 < 0x80)) break;
        FUN_00462c2c(param_1);
        param_2 = (void *)((int)param_2 + 0x80);
        psBurnStack(0x2d4);
        uVar1 = *param_1;
        param_3 = param_3 - 0x80;
        *param_1 = uVar1 + 0x400;
        param_1[1] = param_1[1] + (uint)(uVar1 + 0x400 < 0x400);
LAB_0046340c:
        if (param_3 == 0) {
          return;
        }
      }
      __n = 0x80 - uVar1;
      if (param_3 < 0x80 - uVar1) {
        __n = param_3;
      }
      memcpy((void *)((int)param_1 + uVar1 + 0x4c),param_2,__n);
      uVar1 = param_1[0x12];
      param_3 = param_3 - __n;
      param_2 = (void *)((int)param_2 + __n);
      param_1[0x12] = uVar1 + __n;
      if (uVar1 + __n == 0x80) {
        FUN_00462c2c(param_1,param_1 + 0x13);
        psBurnStack(0x2d4);
        uVar1 = *param_1;
        param_1[0x12] = 0;
        *param_1 = uVar1 + 0x400;
        param_1[1] = param_1[1] + (uint)(uVar1 + 0x400 < 0x400);
        goto LAB_0046340c;
      }
    } while (param_3 != 0);
  }
  return;
}



void psSha512Final(uint *param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  undefined *puVar6;
  uint uVar7;
  
  uVar2 = param_1[0x12] * 8;
  uVar7 = *param_1 + uVar2;
  uVar5 = param_1[0x12] + 1;
  uVar2 = param_1[1] + (param_1[0x12] >> 0x1d) + (uint)(uVar7 < uVar2);
  *(undefined *)((int)param_1 + param_1[0x12] + 0x4c) = 0x80;
  *param_1 = uVar7;
  param_1[1] = uVar2;
  param_1[0x12] = uVar5;
  if (0x70 < uVar5) {
    if (uVar5 < 0x80) {
      do {
        uVar2 = uVar5 + 1;
        *(undefined *)((int)param_1 + uVar5 + 0x4c) = 0;
        uVar5 = uVar2;
      } while (uVar2 < 0x80);
      param_1[0x12] = uVar2;
    }
    FUN_00462c2c(param_1,param_1 + 0x13);
    psBurnStack(0x2d4);
    uVar7 = *param_1;
    uVar2 = param_1[1];
    param_1[0x12] = 0;
  }
  uVar5 = param_1[0x12];
  if (param_1[0x12] < 0x78) {
    do {
      uVar1 = uVar5 + 1;
      *(undefined *)((int)param_1 + uVar5 + 0x4c) = 0;
      uVar5 = uVar1;
    } while (uVar1 < 0x78);
    param_1[0x12] = uVar1;
  }
  *(char *)((int)param_1 + 0xca) = (char)(uVar7 >> 8);
  *(char *)(param_1 + 0x31) = (char)(uVar2 >> 0x18);
  *(char *)((int)param_1 + 0xc5) = (char)(uVar2 >> 0x10);
  *(char *)((int)param_1 + 0xc6) = (char)(uVar2 >> 8);
  *(char *)((int)param_1 + 199) = (char)uVar2;
  *(char *)(param_1 + 0x32) = (char)(uVar7 >> 0x18);
  *(char *)((int)param_1 + 0xc9) = (char)(uVar7 >> 0x10);
  *(undefined *)((int)param_1 + 0xcb) = *(undefined *)param_1;
  FUN_00462c2c(param_1,param_1 + 0x13);
  psBurnStack(0x2d4);
  iVar3 = 0;
  do {
    puVar6 = (undefined *)(iVar3 * 8 + param_2);
    *puVar6 = (char)(param_1[iVar3 * 2 + 3] >> 0x18);
    iVar4 = iVar3 + 1;
    puVar6[1] = (char)(param_1[iVar3 * 2 + 3] >> 0x10);
    puVar6[2] = (char)(param_1[iVar3 * 2 + 3] >> 8);
    puVar6[3] = (char)param_1[iVar3 * 2 + 3];
    puVar6[4] = (char)(param_1[iVar3 * 2 + 2] >> 0x18);
    puVar6[5] = (char)(param_1[iVar3 * 2 + 2] >> 0x10);
    puVar6[6] = (char)(param_1[iVar3 * 2 + 2] >> 8);
    puVar6[7] = *(undefined *)(param_1 + iVar3 * 2 + 2);
    iVar3 = iVar4;
  } while (iVar4 < 8);
  psBurnStack(0xd0);
  return;
}



undefined4 psSha384Init(undefined4 *param_1)

{
  param_1[0x10] = 0xbefa4fa4;
  param_1[0x11] = 0x47b5481d;
  param_1[2] = 0xc1059ed8;
  param_1[4] = 0x367cd507;
  param_1[7] = 0x9159015a;
  param_1[8] = 0xf70e5939;
  param_1[3] = 0xcbbb9d5d;
  param_1[5] = 0x629a292a;
  param_1[6] = 0x3070dd17;
  *param_1 = 0;
  param_1[9] = 0x152fecd8;
  param_1[10] = 0xffc00b31;
  param_1[0xb] = 0x67332667;
  param_1[0xc] = 0x68581511;
  param_1[0xd] = 0x8eb44a87;
  param_1[0xe] = 0x64f98fa7;
  param_1[0xf] = 0xdb0c2e0d;
  param_1[0x12] = 0;
  param_1[1] = 0;
  return 0;
}



void psSha384Update(uint *param_1,void *param_2,uint param_3)

{
  uint uVar1;
  uint __n;
  
  if (param_1 == (uint *)0x0) {
    _psTraceStr("psAssert %s","digest/sha512.c");
    _psTraceInt(&DAT_0049016c,0xd1);
    _psError("sha512 != NULL");
  }
  if (param_2 == (void *)0x0) {
    _psTraceStr("psAssert %s","digest/sha512.c");
    _psTraceInt(&DAT_0049016c,0xd2);
    _psError("buf != NULL");
  }
  if (param_3 != 0) {
    do {
      while( true ) {
        uVar1 = param_1[0x12];
        if ((uVar1 != 0) || (param_3 < 0x80)) break;
        FUN_00462c2c(param_1);
        param_2 = (void *)((int)param_2 + 0x80);
        psBurnStack(0x2d4);
        uVar1 = *param_1;
        param_3 = param_3 - 0x80;
        *param_1 = uVar1 + 0x400;
        param_1[1] = param_1[1] + (uint)(uVar1 + 0x400 < 0x400);
LAB_0046340c:
        if (param_3 == 0) {
          return;
        }
      }
      __n = 0x80 - uVar1;
      if (param_3 < 0x80 - uVar1) {
        __n = param_3;
      }
      memcpy((void *)((int)param_1 + uVar1 + 0x4c),param_2,__n);
      uVar1 = param_1[0x12];
      param_3 = param_3 - __n;
      param_2 = (void *)((int)param_2 + __n);
      param_1[0x12] = uVar1 + __n;
      if (uVar1 + __n == 0x80) {
        FUN_00462c2c(param_1,param_1 + 0x13);
        psBurnStack(0x2d4);
        uVar1 = *param_1;
        param_1[0x12] = 0;
        *param_1 = uVar1 + 0x400;
        param_1[1] = param_1[1] + (uint)(uVar1 + 0x400 < 0x400);
        goto LAB_0046340c;
      }
    } while (param_3 != 0);
  }
  return;
}



void psSha384Final(undefined4 param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 local_48 [16];
  
  psSha512Final(param_1,local_48);
  puVar2 = local_48;
  do {
    uVar3 = puVar2[1];
    *param_2 = *puVar2;
    uVar1 = puVar2[2];
    param_2[1] = uVar3;
    uVar3 = puVar2[3];
    param_2[2] = uVar1;
    puVar2 = puVar2 + 4;
    param_2[3] = uVar3;
    param_2 = param_2 + 4;
  } while (puVar2 != local_48 + 0xc);
  psBurnStack(0x40);
  return;
}



int psMd5Sha1Init(int param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = psMd5Init();
  if (-1 < iVar1) {
    iVar2 = psSha1Init(param_1 + 0x60);
    iVar1 = 0;
    if (iVar2 < 0) {
      psMd5Final(param_1,0);
      iVar1 = iVar2;
    }
  }
  return iVar1;
}



void psMd5Sha1Update(int param_1,void *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  
  psMd5Update();
  puVar1 = (uint *)(param_1 + 0x60);
  if (param_3 != 0) {
    do {
      while( true ) {
        uVar3 = 0x40 - *(int *)(param_1 + 0x7c);
        if (param_3 < uVar3) {
          uVar3 = param_3;
        }
        memcpy((void *)((int)puVar1 + *(int *)(param_1 + 0x7c) + 0x20),param_2,uVar3);
        param_3 = param_3 - uVar3;
        iVar2 = *(int *)(param_1 + 0x7c) + uVar3;
        param_2 = (void *)((int)param_2 + uVar3);
        *(int *)(param_1 + 0x7c) = iVar2;
        if (iVar2 != 0x40) break;
        FUN_00461f78(puVar1);
        psBurnStack(0x15c);
        uVar3 = *puVar1;
        *(undefined4 *)(param_1 + 0x7c) = 0;
        *puVar1 = uVar3 + 0x200;
        *(uint *)(param_1 + 100) = *(int *)(param_1 + 100) + (uint)(uVar3 + 0x200 < 0x200);
        if (param_3 == 0) {
          return;
        }
      }
    } while (param_3 != 0);
  }
  return;
}



// WARNING: Switch with 1 destination removed at 0x00463a98

void psMd5Sha1Final(int param_1,int param_2)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  undefined *puVar9;
  
  puVar9 = &_gp;
  psMd5Final();
  puVar1 = (uint *)(param_1 + 0x60);
  iVar8 = *(int *)(puVar9 + -0x722c);
  iVar3 = *(int *)(param_1 + 0x7c);
  uVar6 = *puVar1 + iVar3 * 8;
  uVar5 = iVar3 + 1;
  iVar7 = *(int *)(param_1 + 100) + (uint)(uVar6 < (uint)(iVar3 * 8));
  *(undefined *)((int)puVar1 + iVar3 + 0x20) = 0x80;
  *puVar1 = uVar6;
  *(int *)(param_1 + 100) = iVar7;
  iVar3 = *(int *)(iVar8 + 0x756cc);
  *(uint *)(param_1 + 0x7c) = uVar5;
  if (0x38 < uVar5) {
    if (uVar5 < 0x40) {
      do {
        uVar6 = uVar5 + 1;
        *(undefined *)((int)puVar1 + uVar5 + 0x20) = 0;
        uVar5 = uVar6;
      } while (uVar6 < 0x40);
      *(uint *)(param_1 + 0x7c) = uVar6;
      iVar3 = *(int *)(iVar8 + 0x756cc);
    }
    (*(code *)(iVar3 + 0x1f78))(puVar1);
    (**(code **)(iVar8 + 0x75ce0))(0x15c);
    uVar6 = *puVar1;
    iVar7 = *(int *)(param_1 + 100);
    *(undefined4 *)(param_1 + 0x7c) = 0;
  }
  uVar5 = *(uint *)(param_1 + 0x7c);
  if (*(uint *)(param_1 + 0x7c) < 0x38) {
    do {
      uVar2 = uVar5 + 1;
      *(undefined *)((int)puVar1 + uVar5 + 0x20) = 0;
      uVar5 = uVar2;
    } while (uVar2 < 0x38);
    *(uint *)(param_1 + 0x7c) = uVar2;
  }
  *(char *)(param_1 + 0xbc) = (char)(uVar6 >> 0x18);
  *(char *)(param_1 + 0xb8) = (char)((uint)iVar7 >> 0x18);
  *(char *)(param_1 + 0xb9) = (char)((uint)iVar7 >> 0x10);
  *(char *)(param_1 + 0xba) = (char)((uint)iVar7 >> 8);
  *(char *)(param_1 + 0xbb) = (char)iVar7;
  *(char *)(param_1 + 0xbd) = (char)(uVar6 >> 0x10);
  *(char *)(param_1 + 0xbe) = (char)(uVar6 >> 8);
  *(undefined *)(param_1 + 0xbf) = *(undefined *)puVar1;
  (*(code *)(iVar3 + 0x1f78))(puVar1);
  (**(code **)(iVar8 + 0x75ce0))(0x15c);
  iVar3 = 0;
  do {
    iVar7 = iVar3 * 4;
    puVar9 = (undefined *)(iVar7 + param_2 + 0x10);
    *puVar9 = *(undefined *)((int)puVar1 + iVar7 + 0xb);
    iVar4 = iVar3 + 1;
    puVar9[1] = (char)*(undefined2 *)((int)puVar1 + iVar7 + 10);
    puVar9[2] = (char)(puVar1[iVar3 + 2] >> 8);
    puVar9[3] = (char)puVar1[iVar3 + 2];
    iVar3 = iVar4;
  } while (iVar4 < 5);
  (**(code **)(iVar8 + 0x760a0))(puVar1,0,0x60);
  return;
}



undefined4 psMd5Init(undefined4 *param_1)

{
  *param_1 = 0;
  param_1[2] = 0x67452301;
  param_1[3] = 0xefcdab89;
  param_1[4] = 0x98badcfe;
  param_1[5] = 0x10325476;
  param_1[1] = 0;
  param_1[6] = 0;
  return 0;
}



void FUN_00463aec(int param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int *piVar9;
  int local_58 [16];
  
  uVar1 = 0;
  do {
    uVar2 = uVar1 + 1;
    local_58[uVar1] = *(int *)(uVar1 * 4 + param_1 + 0x1c);
    uVar1 = uVar2;
  } while (uVar2 < 0x10);
  piVar9 = &DAT_00490d90;
  uVar8 = 0;
  uVar1 = *(uint *)(param_1 + 0xc);
  uVar2 = *(uint *)(param_1 + 0x14);
  uVar4 = *(uint *)(param_1 + 0x10);
  uVar7 = *(uint *)(param_1 + 8);
  do {
    uVar3 = uVar4;
    uVar6 = uVar2;
    uVar4 = uVar1;
    pbVar5 = &DAT_00490d50 + uVar8;
    uVar1 = ((uVar3 ^ uVar6) & uVar4 ^ uVar6) + uVar7 + local_58[(byte)(&DAT_00490ea0)[uVar8]] +
            *piVar9;
    uVar8 = uVar8 + 1;
    piVar9 = piVar9 + 1;
    uVar1 = (uVar1 << (*pbVar5 & 0x1f) | uVar1 >> (0x20 - (*pbVar5 & 0x1f) & 0x1f)) + uVar4;
    uVar2 = uVar3;
    uVar7 = uVar6;
  } while (uVar8 < 0x10);
  piVar9 = &DAT_00490dd0;
  uVar2 = 0x10;
  do {
    uVar8 = uVar4;
    uVar7 = uVar3;
    uVar4 = uVar1;
    pbVar5 = &DAT_00490d50 + uVar2;
    uVar1 = ((uVar8 ^ uVar4) & uVar7 ^ uVar8) + uVar6 + local_58[(byte)(&DAT_00490ea0)[uVar2]] +
            *piVar9;
    uVar2 = uVar2 + 1;
    piVar9 = piVar9 + 1;
    uVar1 = (uVar1 << (*pbVar5 & 0x1f) | uVar1 >> (0x20 - (*pbVar5 & 0x1f) & 0x1f)) + uVar4;
    uVar3 = uVar8;
    uVar6 = uVar7;
  } while (uVar2 < 0x20);
  if (uVar2 < 0x30) {
    piVar9 = &DAT_00490d90 + uVar2;
    do {
      uVar8 = uVar4;
      uVar7 = uVar3;
      uVar4 = uVar1;
      pbVar5 = &DAT_00490d50 + uVar2;
      uVar1 = (uVar4 ^ uVar8 ^ uVar7) + uVar6 + local_58[(byte)(&DAT_00490ea0)[uVar2]] + *piVar9;
      uVar2 = uVar2 + 1;
      piVar9 = piVar9 + 1;
      uVar1 = (uVar1 << (*pbVar5 & 0x1f) | uVar1 >> (0x20 - (*pbVar5 & 0x1f) & 0x1f)) + uVar4;
      uVar3 = uVar8;
      uVar6 = uVar7;
    } while (uVar2 < 0x30);
  }
  if (uVar2 < 0x40) {
    piVar9 = &DAT_00490d90 + uVar2;
    uVar3 = uVar8;
    uVar6 = uVar7;
    do {
      uVar8 = uVar4;
      uVar7 = uVar3;
      uVar4 = uVar1;
      pbVar5 = &DAT_00490d50 + uVar2;
      uVar1 = ((~uVar7 | uVar4) ^ uVar8) + uVar6 + local_58[(byte)(&DAT_00490ea0)[uVar2]] + *piVar9;
      uVar2 = uVar2 + 1;
      piVar9 = piVar9 + 1;
      uVar1 = (uVar1 << (*pbVar5 & 0x1f) | uVar1 >> (0x20 - (*pbVar5 & 0x1f) & 0x1f)) + uVar4;
      uVar3 = uVar8;
      uVar6 = uVar7;
    } while (uVar2 < 0x40);
  }
  *(uint *)(param_1 + 0x14) = *(uint *)(param_1 + 0x14) + uVar8;
  *(uint *)(param_1 + 0xc) = *(uint *)(param_1 + 0xc) + uVar1;
  *(uint *)(param_1 + 8) = *(uint *)(param_1 + 8) + uVar7;
  *(uint *)(param_1 + 0x10) = *(uint *)(param_1 + 0x10) + uVar4;
  return;
}



void psMd5Final(uint *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  
  if (param_2 != 0) {
    uVar3 = param_1[6];
    uVar6 = *param_1 + uVar3 * 8;
    uVar5 = uVar3 + 1;
    uVar7 = param_1[1] + (uint)(uVar6 < uVar3 * 8);
    *(undefined *)((int)param_1 + uVar3 + 0x1c) = 0x80;
    *param_1 = uVar6;
    param_1[1] = uVar7;
    param_1[6] = uVar5;
    if (0x38 < uVar5) {
      if (uVar5 < 0x40) {
        do {
          uVar3 = uVar5 + 1;
          *(undefined *)((int)param_1 + uVar5 + 0x1c) = 0;
          uVar5 = uVar3;
        } while (uVar3 < 0x40);
        param_1[6] = uVar3;
      }
      FUN_00463aec(param_1);
      psBurnStack(0x54);
      uVar6 = *param_1;
      uVar7 = param_1[1];
      param_1[6] = 0;
    }
    uVar5 = param_1[6];
    if (param_1[6] < 0x38) {
      do {
        uVar3 = uVar5 + 1;
        *(undefined *)((int)param_1 + uVar5 + 0x1c) = 0;
        uVar5 = uVar3;
      } while (uVar3 < 0x38);
      param_1[6] = uVar3;
    }
    *(char *)((int)param_1 + 0x57) = (char)(uVar6 >> 0x18);
    *(char *)((int)param_1 + 0x5b) = (char)(uVar7 >> 0x18);
    *(char *)((int)param_1 + 0x5a) = (char)(uVar7 >> 0x10);
    *(char *)((int)param_1 + 0x59) = (char)(uVar7 >> 8);
    *(char *)(param_1 + 0x16) = (char)uVar7;
    *(char *)((int)param_1 + 0x56) = (char)(uVar6 >> 0x10);
    *(char *)((int)param_1 + 0x55) = (char)(uVar6 >> 8);
    *(undefined *)(param_1 + 0x15) = *(undefined *)param_1;
    FUN_00463aec(param_1);
    psBurnStack(0x54);
    iVar2 = 0;
    do {
      iVar4 = iVar2 * 4;
      iVar1 = iVar2 + 2;
      iVar2 = iVar2 + 1;
      *(uint *)(iVar4 + param_2) = param_1[iVar1];
    } while (iVar2 < 4);
  }
  memset(param_1,0,0x60);
  return;
}



void psMd5Update(uint *param_1,void *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  
  if (param_3 != 0) {
    do {
      while( true ) {
        uVar2 = 0x40 - param_1[6];
        if (param_3 < uVar2) {
          uVar2 = param_3;
        }
        memcpy((void *)((int)param_1 + param_1[6] + 0x1c),param_2,uVar2);
        uVar1 = param_1[6];
        param_3 = param_3 - uVar2;
        param_2 = (void *)((int)param_2 + uVar2);
        param_1[6] = uVar1 + uVar2;
        if (uVar1 + uVar2 != 0x40) break;
        FUN_00463aec(param_1);
        psBurnStack(0x54);
        uVar2 = *param_1;
        param_1[6] = 0;
        *param_1 = uVar2 + 0x200;
        param_1[1] = param_1[1] + (uint)(uVar2 + 0x200 < 0x200);
        if (param_3 == 0) {
          return;
        }
      }
    } while (param_3 != 0);
  }
  return;
}



void psHmacMd5Update(int param_1,void *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  
  puVar1 = (uint *)(param_1 + 0x40);
  if (param_3 != 0) {
    do {
      while( true ) {
        uVar3 = 0x40 - *(int *)(param_1 + 0x58);
        if (param_3 < uVar3) {
          uVar3 = param_3;
        }
        memcpy((void *)((int)puVar1 + *(int *)(param_1 + 0x58) + 0x1c),param_2,uVar3);
        param_3 = param_3 - uVar3;
        iVar2 = *(int *)(param_1 + 0x58) + uVar3;
        param_2 = (void *)((int)param_2 + uVar3);
        *(int *)(param_1 + 0x58) = iVar2;
        if (iVar2 != 0x40) break;
        FUN_00463aec(puVar1);
        psBurnStack(0x54);
        uVar3 = *puVar1;
        *(undefined4 *)(param_1 + 0x58) = 0;
        *puVar1 = uVar3 + 0x200;
        *(uint *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + (uint)(uVar3 + 0x200 < 0x200);
        if (param_3 == 0) {
          return;
        }
      }
    } while (param_3 != 0);
  }
  return;
}



int psHmacMd5Init(int param_1,int param_2,uint param_3)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  undefined *puVar6;
  
  param_3 = param_3 & 0xffff;
  uVar4 = 0;
  if (param_3 != 0) {
    do {
      pbVar5 = (byte *)(param_2 + uVar4);
      pbVar2 = (byte *)(param_1 + uVar4);
      uVar4 = uVar4 + 1;
      *pbVar2 = *pbVar5 ^ 0x36;
    } while (uVar4 < param_3);
  }
  uVar4 = param_3;
  if (param_3 < 0x40) {
    do {
      uVar3 = uVar4 + 1;
      *(undefined *)(param_1 + uVar4) = 0x36;
      uVar4 = uVar3;
    } while ((int)uVar3 < 0x40);
  }
  iVar1 = psMd5Init(param_1 + 0x40);
  if (-1 < iVar1) {
    psMd5Update(param_1 + 0x40,param_1,0x40);
    uVar4 = 0;
    if (param_3 != 0) {
      do {
        pbVar5 = (byte *)(param_2 + uVar4);
        pbVar2 = (byte *)(param_1 + uVar4);
        uVar4 = uVar4 + 1;
        *pbVar2 = *pbVar5 ^ 0x5c;
      } while (uVar4 < param_3);
    }
    if (param_3 < 0x40) {
      do {
        puVar6 = (undefined *)(param_1 + param_3);
        param_3 = param_3 + 1;
        *puVar6 = 0x5c;
      } while ((int)param_3 < 0x40);
    }
    iVar1 = 0;
  }
  return iVar1;
}



void psHmacMd5Final(void *param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = (int)param_1 + 0x40;
  psMd5Final(iVar2);
  iVar1 = psMd5Init(iVar2);
  if (-1 < iVar1) {
    psMd5Update(iVar2,param_1);
    psMd5Update(iVar2,param_2,0x10);
    psMd5Final(iVar2,param_2);
    memset(param_1,0,0x40);
    return;
  }
  _psTraceStr("psAssert %s","digest/hmac.c",0x40);
  _psTraceInt(&DAT_0049016c,0xf9);
                    // WARNING: Treating indirect jump as call
  _psError("rc >= 0");
  return;
}



int psHmacMd5(void *param_1,ushort param_2,undefined4 param_3,undefined4 param_4,void *param_5,
             void *param_6,ushort *param_7)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  uint uVar6;
  byte local_c8 [64];
  undefined auStack_88 [96];
  
  if (param_2 < 0x41) {
    *param_7 = param_2;
  }
  else {
    iVar1 = psMd5Init(local_c8);
    if (iVar1 < 0) {
      return iVar1;
    }
    psMd5Update(local_c8,param_1,param_2);
    psMd5Final(local_c8,param_5);
    *param_7 = 0x10;
    memcpy(param_6,param_5,0x10);
    param_1 = param_6;
  }
  uVar6 = (uint)*param_7;
  uVar4 = 0;
  if (uVar6 != 0) {
    do {
      pbVar5 = (byte *)((int)param_1 + uVar4);
      pbVar2 = local_c8 + uVar4;
      uVar4 = uVar4 + 1;
      *pbVar2 = *pbVar5 ^ 0x36;
    } while (uVar4 < uVar6);
  }
  uVar4 = uVar6;
  if (uVar6 < 0x40) {
    do {
      uVar3 = uVar4 + 1;
      local_c8[uVar4] = 0x36;
      uVar4 = uVar3;
    } while ((int)uVar3 < 0x40);
  }
  iVar1 = psMd5Init(auStack_88);
  if (-1 < iVar1) {
    psMd5Update(auStack_88,local_c8,0x40);
    uVar4 = 0;
    if (uVar6 != 0) {
      do {
        pbVar5 = (byte *)((int)param_1 + uVar4);
        pbVar2 = local_c8 + uVar4;
        uVar4 = uVar4 + 1;
        *pbVar2 = *pbVar5 ^ 0x5c;
      } while (uVar4 < uVar6);
    }
    if (uVar6 < 0x40) {
      do {
        pbVar2 = local_c8 + uVar6;
        uVar6 = uVar6 + 1;
        *pbVar2 = 0x5c;
      } while ((int)uVar6 < 0x40);
    }
    psMd5Update(auStack_88,param_3,param_4);
    psHmacMd5Final(local_c8,param_5);
    iVar1 = 0;
  }
  return iVar1;
}



void psHmacSha1Update(int param_1,void *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  
  puVar1 = (uint *)(param_1 + 0x40);
  if (param_3 != 0) {
    do {
      while( true ) {
        uVar3 = 0x40 - *(int *)(param_1 + 0x5c);
        if (param_3 < uVar3) {
          uVar3 = param_3;
        }
        memcpy((void *)((int)puVar1 + *(int *)(param_1 + 0x5c) + 0x20),param_2,uVar3);
        param_3 = param_3 - uVar3;
        iVar2 = *(int *)(param_1 + 0x5c) + uVar3;
        param_2 = (void *)((int)param_2 + uVar3);
        *(int *)(param_1 + 0x5c) = iVar2;
        if (iVar2 != 0x40) break;
        FUN_00461f78(puVar1);
        psBurnStack(0x15c);
        uVar3 = *puVar1;
        *(undefined4 *)(param_1 + 0x5c) = 0;
        *puVar1 = uVar3 + 0x200;
        *(uint *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + (uint)(uVar3 + 0x200 < 0x200);
        if (param_3 == 0) {
          return;
        }
      }
    } while (param_3 != 0);
  }
  return;
}



int psHmacSha1Init(int param_1,int param_2,uint param_3)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  undefined *puVar6;
  
  param_3 = param_3 & 0xffff;
  uVar3 = 0;
  uVar4 = param_3;
  if (param_3 != 0) {
    do {
      pbVar5 = (byte *)(param_2 + uVar3);
      pbVar2 = (byte *)(param_1 + uVar3);
      uVar3 = uVar3 + 1;
      *pbVar2 = *pbVar5 ^ 0x36;
    } while (uVar3 < param_3);
  }
  for (; uVar4 < 0x40; uVar4 = uVar4 + 1) {
    *(undefined *)(param_1 + uVar4) = 0x36;
  }
  iVar1 = psSha1Init(param_1 + 0x40);
  if (-1 < iVar1) {
    psSha1Update(param_1 + 0x40,param_1,0x40);
    uVar4 = 0;
    if (param_3 != 0) {
      do {
        pbVar5 = (byte *)(param_2 + uVar4);
        pbVar2 = (byte *)(param_1 + uVar4);
        uVar4 = uVar4 + 1;
        *pbVar2 = *pbVar5 ^ 0x5c;
      } while (uVar4 < param_3);
    }
    if (param_3 < 0x40) {
      do {
        puVar6 = (undefined *)(param_1 + param_3);
        param_3 = param_3 + 1;
        *puVar6 = 0x5c;
      } while ((int)param_3 < 0x40);
    }
    iVar1 = 0;
  }
  return iVar1;
}



void psHmacSha1Final(void *param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = (int)param_1 + 0x40;
  psSha1Final(iVar2);
  iVar1 = psSha1Init(iVar2);
  if (-1 < iVar1) {
    psSha1Update(iVar2,param_1);
    psSha1Update(iVar2,param_2,0x14);
    psSha1Final(iVar2,param_2);
    memset(param_1,0,0x40);
    return;
  }
  _psTraceStr("psAssert %s","digest/hmac.c",0x40);
  _psTraceInt(&DAT_0049016c,0x175);
                    // WARNING: Treating indirect jump as call
  _psError("rc >= 0");
  return;
}



int psHmacSha1(void *param_1,ushort param_2,undefined4 param_3,undefined4 param_4,void *param_5,
              void *param_6,ushort *param_7)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  uint uVar6;
  byte local_c8 [64];
  undefined auStack_88 [96];
  
  if (param_2 < 0x41) {
    *param_7 = param_2;
  }
  else {
    iVar1 = psSha1Init(local_c8);
    if (iVar1 < 0) {
      return iVar1;
    }
    psSha1Update(local_c8,param_1,param_2);
    psSha1Final(local_c8,param_5);
    *param_7 = 0x14;
    memcpy(param_6,param_5,0x14);
    param_1 = param_6;
  }
  uVar6 = (uint)*param_7;
  uVar3 = 0;
  uVar4 = uVar6;
  if (uVar6 != 0) {
    do {
      pbVar5 = (byte *)((int)param_1 + uVar3);
      pbVar2 = local_c8 + uVar3;
      uVar3 = uVar3 + 1;
      *pbVar2 = *pbVar5 ^ 0x36;
    } while (uVar3 < uVar6);
  }
  for (; uVar4 < 0x40; uVar4 = uVar4 + 1) {
    local_c8[uVar4] = 0x36;
  }
  iVar1 = psSha1Init(auStack_88);
  if (-1 < iVar1) {
    psSha1Update(auStack_88,local_c8,0x40);
    uVar4 = 0;
    if (uVar6 != 0) {
      do {
        pbVar5 = (byte *)((int)param_1 + uVar4);
        pbVar2 = local_c8 + uVar4;
        uVar4 = uVar4 + 1;
        *pbVar2 = *pbVar5 ^ 0x5c;
      } while (uVar4 < uVar6);
    }
    if (uVar6 < 0x40) {
      do {
        pbVar2 = local_c8 + uVar6;
        uVar6 = uVar6 + 1;
        *pbVar2 = 0x5c;
      } while ((int)uVar6 < 0x40);
    }
    psSha1Update(auStack_88,param_3,param_4);
    psHmacSha1Final(local_c8,param_5);
    iVar1 = 0;
  }
  return iVar1;
}



void psHmacSha256Update(int param_1,void *param_2,uint param_3)

{
  uint *puVar1;
  uint uVar2;
  int iVar3;
  
  puVar1 = (uint *)(param_1 + 0x40);
  if (param_3 != 0) {
    do {
      while( true ) {
        iVar3 = *(int *)(param_1 + 0x68);
        if ((iVar3 != 0) || (param_3 < 0x40)) break;
        FUN_004625a4(puVar1);
        param_2 = (void *)((int)param_2 + 0x40);
        psBurnStack(0x128);
        uVar2 = *puVar1;
        param_3 = param_3 - 0x40;
        *puVar1 = uVar2 + 0x200;
        *(uint *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + (uint)(uVar2 + 0x200 < 0x200);
LAB_00462994:
        if (param_3 == 0) {
          return;
        }
      }
      uVar2 = 0x40U - iVar3;
      if (param_3 < 0x40U - iVar3) {
        uVar2 = param_3;
      }
      memcpy((void *)((int)puVar1 + iVar3 + 0x2c),param_2,uVar2);
      param_3 = param_3 - uVar2;
      iVar3 = *(int *)(param_1 + 0x68) + uVar2;
      param_2 = (void *)((int)param_2 + uVar2);
      *(int *)(param_1 + 0x68) = iVar3;
      if (iVar3 == 0x40) {
        FUN_004625a4(puVar1,param_1 + 0x6c);
        psBurnStack(0x128);
        uVar2 = *puVar1;
        *(undefined4 *)(param_1 + 0x68) = 0;
        *puVar1 = uVar2 + 0x200;
        *(uint *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + (uint)(uVar2 + 0x200 < 0x200);
        goto LAB_00462994;
      }
    } while (param_3 != 0);
  }
  return;
}



int psHmacSha256Init(int param_1,int param_2,uint param_3)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  undefined *puVar6;
  
  param_3 = param_3 & 0xffff;
  uVar4 = 0;
  if (param_3 != 0) {
    do {
      pbVar5 = (byte *)(param_2 + uVar4);
      pbVar2 = (byte *)(param_1 + uVar4);
      uVar4 = uVar4 + 1;
      *pbVar2 = *pbVar5 ^ 0x36;
    } while (uVar4 < param_3);
  }
  uVar4 = param_3;
  if (param_3 < 0x40) {
    do {
      uVar3 = uVar4 + 1;
      *(undefined *)(param_1 + uVar4) = 0x36;
      uVar4 = uVar3;
    } while ((int)uVar3 < 0x40);
  }
  iVar1 = psSha256Init(param_1 + 0x40);
  if (-1 < iVar1) {
    psSha256Update(param_1 + 0x40,param_1,0x40);
    uVar4 = 0;
    if (param_3 != 0) {
      do {
        pbVar5 = (byte *)(param_2 + uVar4);
        pbVar2 = (byte *)(param_1 + uVar4);
        uVar4 = uVar4 + 1;
        *pbVar2 = *pbVar5 ^ 0x5c;
      } while (uVar4 < param_3);
    }
    if (param_3 < 0x40) {
      do {
        puVar6 = (undefined *)(param_1 + param_3);
        param_3 = param_3 + 1;
        *puVar6 = 0x5c;
      } while ((int)param_3 < 0x40);
    }
    iVar1 = 0;
  }
  return iVar1;
}



void psHmacSha256Final(void *param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = (int)param_1 + 0x40;
  psSha256Final(iVar2);
  iVar1 = psSha256Init(iVar2);
  if (-1 < iVar1) {
    psSha256Update(iVar2,param_1);
    psSha256Update(iVar2,param_2,0x20);
    psSha256Final(iVar2,param_2);
    memset(param_1,0,0x40);
    return;
  }
  _psTraceStr("psAssert %s","digest/hmac.c",0x40);
  _psTraceInt(&DAT_0049016c,0x1f1);
                    // WARNING: Treating indirect jump as call
  _psError("rc >= 0");
  return;
}



int psHmacSha256(undefined4 *param_1,uint param_2,undefined4 param_3,uint param_4,
                undefined4 *param_5,undefined4 *param_6,ushort *param_7)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  int iVar26;
  uint uVar27;
  uint uVar28;
  undefined4 *puVar29;
  uint in_t0;
  uint in_t1;
  uint in_t2;
  uint in_t3;
  byte *pbVar30;
  uint uVar31;
  byte *pbVar32;
  byte local_d8 [64];
  undefined auStack_98 [112];
  
  param_2 = param_2 & 0xffff;
  if (param_2 < 0x41) {
    *param_7 = (ushort)param_2;
  }
  else {
    uVar31 = param_4;
    iVar26 = psSha256Init(local_d8);
    if (iVar26 < 0) {
      return iVar26;
    }
    psSha256Update(local_d8,param_1);
    puVar29 = param_5;
    psSha256Final(local_d8);
    uVar28 = (int)param_5 + 7U & 3;
    iVar26 = *(int *)(((int)param_5 + 7U) - uVar28);
    uVar27 = (int)param_5 + 0xbU & 3;
    iVar6 = *(int *)(((int)param_5 + 0xbU) - uVar27);
    uVar1 = (int)param_5 + 0xfU & 3;
    iVar7 = *(int *)(((int)param_5 + 0xfU) - uVar1);
    uVar2 = (int)param_5 + 0x13U & 3;
    iVar8 = *(int *)(((int)param_5 + 0x13U) - uVar2);
    uVar3 = (int)param_5 + 0x17U & 3;
    iVar9 = *(int *)(((int)param_5 + 0x17U) - uVar3);
    uVar4 = (int)param_5 + 0x1bU & 3;
    iVar10 = *(int *)(((int)param_5 + 0x1bU) - uVar4);
    uVar5 = (int)param_5 + 0x1fU & 3;
    iVar11 = *(int *)(((int)param_5 + 0x1fU) - uVar5);
    uVar12 = (uint)(param_5 + 1) & 3;
    uVar19 = *(uint *)((int)(param_5 + 1) - uVar12);
    uVar13 = (uint)(param_5 + 2) & 3;
    uVar20 = *(uint *)((int)(param_5 + 2) - uVar13);
    uVar14 = (uint)(param_5 + 3) & 3;
    uVar21 = *(uint *)((int)(param_5 + 3) - uVar14);
    uVar15 = (uint)(param_5 + 4) & 3;
    uVar22 = *(uint *)((int)(param_5 + 4) - uVar15);
    uVar16 = (uint)(param_5 + 5) & 3;
    uVar23 = *(uint *)((int)(param_5 + 5) - uVar16);
    uVar17 = (uint)(param_5 + 6) & 3;
    uVar24 = *(uint *)((int)(param_5 + 6) - uVar17);
    uVar18 = (uint)(param_5 + 7) & 3;
    uVar25 = *(uint *)((int)(param_5 + 7) - uVar18);
    *param_6 = *param_5;
    param_6[1] = (iVar26 << (3 - uVar28) * 8 | in_t3 & 0xffffffffU >> (uVar28 + 1) * 8) &
                 -1 << (4 - uVar12) * 8 | uVar19 >> uVar12 * 8;
    param_6[2] = (iVar6 << (3 - uVar27) * 8 | in_t2 & 0xffffffffU >> (uVar27 + 1) * 8) &
                 -1 << (4 - uVar13) * 8 | uVar20 >> uVar13 * 8;
    param_6[3] = (iVar7 << (3 - uVar1) * 8 | (uint)puVar29 & 0xffffffffU >> (uVar1 + 1) * 8) &
                 -1 << (4 - uVar14) * 8 | uVar21 >> uVar14 * 8;
    param_6[4] = (iVar8 << (3 - uVar2) * 8 | param_2 & 0xffffffffU >> (uVar2 + 1) * 8) &
                 -1 << (4 - uVar15) * 8 | uVar22 >> uVar15 * 8;
    param_6[5] = (iVar9 << (3 - uVar3) * 8 | uVar31 & 0xffffffffU >> (uVar3 + 1) * 8) &
                 -1 << (4 - uVar16) * 8 | uVar23 >> uVar16 * 8;
    param_6[6] = (iVar10 << (3 - uVar4) * 8 | in_t0 & 0xffffffffU >> (uVar4 + 1) * 8) &
                 -1 << (4 - uVar17) * 8 | uVar24 >> uVar17 * 8;
    param_6[7] = (iVar11 << (3 - uVar5) * 8 | in_t1 & 0xffffffffU >> (uVar5 + 1) * 8) &
                 -1 << (4 - uVar18) * 8 | uVar25 >> uVar18 * 8;
    *param_7 = 0x20;
    param_1 = param_6;
  }
  uVar31 = (uint)*param_7;
  uVar28 = 0;
  if (uVar31 != 0) {
    do {
      pbVar32 = (byte *)((int)param_1 + uVar28);
      pbVar30 = local_d8 + uVar28;
      uVar28 = uVar28 + 1;
      *pbVar30 = *pbVar32 ^ 0x36;
    } while (uVar28 < uVar31);
  }
  uVar28 = uVar31;
  if (uVar31 < 0x40) {
    do {
      uVar27 = uVar28 + 1;
      local_d8[uVar28] = 0x36;
      uVar28 = uVar27;
    } while ((int)uVar27 < 0x40);
  }
  iVar26 = psSha256Init(auStack_98);
  if (-1 < iVar26) {
    psSha256Update(auStack_98,local_d8,0x40);
    uVar28 = 0;
    if (uVar31 != 0) {
      do {
        pbVar32 = (byte *)((int)param_1 + uVar28);
        pbVar30 = local_d8 + uVar28;
        uVar28 = uVar28 + 1;
        *pbVar30 = *pbVar32 ^ 0x5c;
      } while (uVar28 < uVar31);
    }
    if (uVar31 < 0x40) {
      do {
        pbVar30 = local_d8 + uVar31;
        uVar31 = uVar31 + 1;
        *pbVar30 = 0x5c;
      } while ((int)uVar31 < 0x40);
    }
    psSha256Update(auStack_98,param_3,param_4);
    psHmacSha256Final(local_d8,param_5);
    iVar26 = 0;
  }
  return iVar26;
}



void psHmacSha384Update(int param_1,void *param_2,uint param_3)

{
  uint *puVar1;
  int iVar2;
  uint uVar3;
  
  puVar1 = (uint *)(param_1 + 0x80);
  if (puVar1 == (uint *)0x0) {
    _psTraceStr("psAssert %s","digest/sha512.c");
    _psTraceInt(&DAT_0049016c,0xd1);
    _psError("sha512 != NULL");
  }
  if (param_2 == (void *)0x0) {
    _psTraceStr("psAssert %s","digest/sha512.c");
    _psTraceInt(&DAT_0049016c,0xd2);
    _psError("buf != NULL");
  }
  if (param_3 != 0) {
    do {
      while( true ) {
        iVar2 = *(int *)(param_1 + 200);
        if ((iVar2 != 0) || (param_3 < 0x80)) break;
        FUN_00462c2c(puVar1);
        param_2 = (void *)((int)param_2 + 0x80);
        psBurnStack(0x2d4);
        uVar3 = *puVar1;
        param_3 = param_3 - 0x80;
        *puVar1 = uVar3 + 0x400;
        *(uint *)(param_1 + 0x84) = *(int *)(param_1 + 0x84) + (uint)(uVar3 + 0x400 < 0x400);
LAB_0046340c:
        if (param_3 == 0) {
          return;
        }
      }
      uVar3 = 0x80U - iVar2;
      if (param_3 < 0x80U - iVar2) {
        uVar3 = param_3;
      }
      memcpy((void *)((int)puVar1 + iVar2 + 0x4c),param_2,uVar3);
      param_3 = param_3 - uVar3;
      iVar2 = *(int *)(param_1 + 200) + uVar3;
      param_2 = (void *)((int)param_2 + uVar3);
      *(int *)(param_1 + 200) = iVar2;
      if (iVar2 == 0x80) {
        FUN_00462c2c(puVar1,param_1 + 0xcc);
        psBurnStack(0x2d4);
        uVar3 = *puVar1;
        *(undefined4 *)(param_1 + 200) = 0;
        *puVar1 = uVar3 + 0x400;
        *(uint *)(param_1 + 0x84) = *(int *)(param_1 + 0x84) + (uint)(uVar3 + 0x400 < 0x400);
        goto LAB_0046340c;
      }
    } while (param_3 != 0);
  }
  return;
}



void psHmacUpdate(int param_1)

{
  byte bVar1;
  code *UNRECOVERED_JUMPTABLE;
  
  bVar1 = *(byte *)(param_1 + 0x150);
  if (bVar1 == 0x13) {
    UNRECOVERED_JUMPTABLE = psSha1Update;
LAB_00464fbc:
                    // WARNING: Could not recover jumptable at 0x00464fc4. Too many branches
                    // WARNING: Treating indirect jump as call
    (*UNRECOVERED_JUMPTABLE)(param_1 + 0x40);
    return;
  }
  if (bVar1 < 0x14) {
    if (bVar1 == 0x12) {
      UNRECOVERED_JUMPTABLE = psMd5Update;
      goto LAB_00464fbc;
    }
  }
  else {
    if (bVar1 == 0x14) {
      UNRECOVERED_JUMPTABLE = psSha256Update;
      goto LAB_00464fbc;
    }
    if (bVar1 == 0x15) {
      psSha384Update(param_1 + 0x80);
      return;
    }
  }
  return;
}



int psHmacSha384Init(int param_1,int param_2,uint param_3)

{
  int iVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  undefined *puVar6;
  
  param_3 = param_3 & 0xffff;
  uVar4 = 0;
  if (param_3 != 0) {
    do {
      pbVar5 = (byte *)(param_2 + uVar4);
      pbVar2 = (byte *)(param_1 + uVar4);
      uVar4 = uVar4 + 1;
      *pbVar2 = *pbVar5 ^ 0x36;
    } while (uVar4 < param_3);
  }
  uVar4 = param_3;
  if (param_3 < 0x80) {
    do {
      uVar3 = uVar4 + 1;
      *(undefined *)(param_1 + uVar4) = 0x36;
      uVar4 = uVar3;
    } while ((int)uVar3 < 0x80);
  }
  iVar1 = psSha384Init(param_1 + 0x80);
  if (-1 < iVar1) {
    psSha384Update(param_1 + 0x80,param_1,0x80);
    uVar4 = 0;
    if (param_3 != 0) {
      do {
        pbVar5 = (byte *)(param_2 + uVar4);
        pbVar2 = (byte *)(param_1 + uVar4);
        uVar4 = uVar4 + 1;
        *pbVar2 = *pbVar5 ^ 0x5c;
      } while (uVar4 < param_3);
    }
    if (param_3 < 0x80) {
      do {
        puVar6 = (undefined *)(param_1 + param_3);
        param_3 = param_3 + 1;
        *puVar6 = 0x5c;
      } while ((int)param_3 < 0x80);
    }
    iVar1 = 0;
  }
  return iVar1;
}



int psHmacInit(int param_1,uint param_2,int param_3,uint param_4)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  byte *pbVar4;
  byte *pbVar5;
  undefined *puVar6;
  
  param_4 = param_4 & 0xffff;
  *(char *)(param_1 + 0x150) = (char)param_2;
  if (param_2 == 0x13) {
    uVar2 = 0;
    uVar3 = param_4;
    if (param_4 != 0) {
      do {
        pbVar5 = (byte *)(param_3 + uVar2);
        pbVar4 = (byte *)(param_1 + uVar2);
        uVar2 = uVar2 + 1;
        *pbVar4 = *pbVar5 ^ 0x36;
      } while (uVar2 < param_4);
    }
    for (; uVar3 < 0x40; uVar3 = uVar3 + 1) {
      *(undefined *)(param_1 + uVar3) = 0x36;
    }
    iVar1 = psSha1Init(param_1 + 0x40);
    if (iVar1 < 0) {
      return iVar1;
    }
    psSha1Update(param_1 + 0x40,param_1,0x40);
    uVar3 = 0;
    if (param_4 != 0) {
      do {
        pbVar5 = (byte *)(param_3 + uVar3);
        pbVar4 = (byte *)(param_1 + uVar3);
        uVar3 = uVar3 + 1;
        *pbVar4 = *pbVar5 ^ 0x5c;
      } while (uVar3 < param_4);
    }
    if (param_4 < 0x40) {
      do {
        puVar6 = (undefined *)(param_1 + param_4);
        param_4 = param_4 + 1;
        *puVar6 = 0x5c;
      } while ((int)param_4 < 0x40);
      return 0;
    }
  }
  else if (param_2 < 0x14) {
    if (param_2 != 0x12) {
      return -6;
    }
    uVar3 = 0;
    if (param_4 != 0) {
      do {
        pbVar5 = (byte *)(param_3 + uVar3);
        pbVar4 = (byte *)(param_1 + uVar3);
        uVar3 = uVar3 + 1;
        *pbVar4 = *pbVar5 ^ 0x36;
      } while (uVar3 < param_4);
    }
    uVar3 = param_4;
    if (param_4 < 0x40) {
      do {
        uVar2 = uVar3 + 1;
        *(undefined *)(param_1 + uVar3) = 0x36;
        uVar3 = uVar2;
      } while ((int)uVar2 < 0x40);
    }
    iVar1 = psMd5Init(param_1 + 0x40);
    if (iVar1 < 0) {
      return iVar1;
    }
    psMd5Update(param_1 + 0x40,param_1,0x40);
    uVar3 = 0;
    if (param_4 != 0) {
      do {
        pbVar5 = (byte *)(param_3 + uVar3);
        pbVar4 = (byte *)(param_1 + uVar3);
        uVar3 = uVar3 + 1;
        *pbVar4 = *pbVar5 ^ 0x5c;
      } while (uVar3 < param_4);
    }
    if (param_4 < 0x40) {
      do {
        puVar6 = (undefined *)(param_1 + param_4);
        param_4 = param_4 + 1;
        *puVar6 = 0x5c;
      } while ((int)param_4 < 0x40);
    }
  }
  else if (param_2 == 0x14) {
    uVar3 = 0;
    if (param_4 != 0) {
      do {
        pbVar4 = (byte *)(param_3 + uVar3);
        pbVar5 = (byte *)(param_1 + uVar3);
        uVar3 = uVar3 + 1;
        *pbVar5 = *pbVar4 ^ 0x36;
      } while (uVar3 < param_4);
    }
    uVar3 = param_4;
    if (param_4 < 0x40) {
      do {
        uVar2 = uVar3 + 1;
        *(undefined *)(param_1 + uVar3) = 0x36;
        uVar3 = uVar2;
      } while ((int)uVar2 < 0x40);
    }
    iVar1 = psSha256Init(param_1 + 0x40);
    if (iVar1 < 0) {
      return iVar1;
    }
    psSha256Update(param_1 + 0x40,param_1,0x40);
    uVar3 = 0;
    if (param_4 != 0) {
      do {
        pbVar5 = (byte *)(param_3 + uVar3);
        pbVar4 = (byte *)(param_1 + uVar3);
        uVar3 = uVar3 + 1;
        *pbVar4 = *pbVar5 ^ 0x5c;
      } while (uVar3 < param_4);
    }
    if (param_4 < 0x40) {
      do {
        puVar6 = (undefined *)(param_1 + param_4);
        param_4 = param_4 + 1;
        *puVar6 = 0x5c;
      } while ((int)param_4 < 0x40);
      return 0;
    }
  }
  else {
    if (param_2 != 0x15) {
      return -6;
    }
    uVar3 = 0;
    if (param_4 != 0) {
      do {
        pbVar5 = (byte *)(param_3 + uVar3);
        pbVar4 = (byte *)(param_1 + uVar3);
        uVar3 = uVar3 + 1;
        *pbVar4 = *pbVar5 ^ 0x36;
      } while (uVar3 < param_4);
    }
    uVar3 = param_4;
    if (param_4 < 0x80) {
      do {
        uVar2 = uVar3 + 1;
        *(undefined *)(param_1 + uVar3) = 0x36;
        uVar3 = uVar2;
      } while ((int)uVar2 < 0x80);
    }
    iVar1 = psSha384Init(param_1 + 0x80);
    if (iVar1 < 0) {
      return iVar1;
    }
    psSha384Update(param_1 + 0x80,param_1,0x80);
    uVar3 = 0;
    if (param_4 != 0) {
      do {
        pbVar5 = (byte *)(param_3 + uVar3);
        pbVar4 = (byte *)(param_1 + uVar3);
        uVar3 = uVar3 + 1;
        *pbVar4 = *pbVar5 ^ 0x5c;
      } while (uVar3 < param_4);
    }
    if (param_4 < 0x80) {
      do {
        puVar6 = (undefined *)(param_1 + param_4);
        param_4 = param_4 + 1;
        *puVar6 = 0x5c;
      } while ((int)param_4 < 0x80);
      return 0;
    }
  }
  return 0;
}



void psHmacSha384Final(void *param_1,undefined4 param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = (int)param_1 + 0x80;
  psSha384Final(iVar2);
  iVar1 = psSha384Init(iVar2);
  if (-1 < iVar1) {
    psSha384Update(iVar2,param_1);
    psSha384Update(iVar2,param_2,0x30);
    psSha384Final(iVar2,param_2);
    memset(param_1,0,0x80);
    return;
  }
  _psTraceStr("psAssert %s","digest/hmac.c",0x80);
  _psTraceInt(&DAT_0049016c,0x26e);
                    // WARNING: Treating indirect jump as call
  _psError("rc >= 0");
  return;
}



void psHmacFinal(int param_1)

{
  byte bVar1;
  
  bVar1 = *(byte *)(param_1 + 0x150);
  if (bVar1 == 0x13) {
    psHmacSha1Final();
    *(undefined *)(param_1 + 0x150) = 0;
  }
  else if (bVar1 < 0x14) {
    if (bVar1 != 0x12) {
LAB_004656b8:
      *(undefined *)(param_1 + 0x150) = 0;
      return;
    }
    psHmacMd5Final();
    *(undefined *)(param_1 + 0x150) = 0;
  }
  else if (bVar1 == 0x14) {
    psHmacSha256Final();
    *(undefined *)(param_1 + 0x150) = 0;
  }
  else {
    if (bVar1 != 0x15) goto LAB_004656b8;
    psHmacSha384Final();
    *(undefined *)(param_1 + 0x150) = 0;
  }
  return;
}



int psHmacSha384(undefined4 *param_1,ushort param_2,undefined4 param_3,undefined4 param_4,
                undefined4 *param_5,undefined4 *param_6,ushort *param_7)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  byte *pbVar8;
  undefined4 uVar9;
  byte *pbVar10;
  uint uVar11;
  byte local_178 [128];
  undefined auStack_f8 [208];
  
  if (param_2 < 0x81) {
    *param_7 = param_2;
  }
  else {
    iVar1 = psSha384Init(local_178);
    if (iVar1 < 0) {
      return iVar1;
    }
    psSha384Update(local_178,param_1,param_2);
    psSha384Final(local_178,param_5);
    puVar6 = param_6;
    puVar7 = param_5;
    do {
      uVar9 = puVar7[1];
      uVar3 = puVar7[2];
      uVar5 = puVar7[3];
      *puVar6 = *puVar7;
      puVar6[1] = uVar9;
      puVar6[2] = uVar3;
      puVar7 = puVar7 + 4;
      puVar6[3] = uVar5;
      puVar6 = puVar6 + 4;
    } while (puVar7 != param_5 + 0xc);
    *param_7 = 0x30;
    param_1 = param_6;
  }
  uVar11 = (uint)*param_7;
  uVar4 = 0;
  if (uVar11 != 0) {
    do {
      pbVar10 = (byte *)((int)param_1 + uVar4);
      pbVar8 = local_178 + uVar4;
      uVar4 = uVar4 + 1;
      *pbVar8 = *pbVar10 ^ 0x36;
    } while (uVar4 < uVar11);
  }
  uVar4 = uVar11;
  if (uVar11 < 0x80) {
    do {
      uVar2 = uVar4 + 1;
      local_178[uVar4] = 0x36;
      uVar4 = uVar2;
    } while ((int)uVar2 < 0x80);
  }
  iVar1 = psSha384Init(auStack_f8);
  if (-1 < iVar1) {
    psSha384Update(auStack_f8,local_178,0x80);
    uVar4 = 0;
    if (uVar11 != 0) {
      do {
        pbVar8 = (byte *)((int)param_1 + uVar4);
        pbVar10 = local_178 + uVar4;
        uVar4 = uVar4 + 1;
        *pbVar10 = *pbVar8 ^ 0x5c;
      } while (uVar4 < uVar11);
    }
    if (uVar11 < 0x80) {
      do {
        pbVar8 = local_178 + uVar11;
        uVar11 = uVar11 + 1;
        *pbVar8 = 0x5c;
      } while ((int)uVar11 < 0x80);
    }
    psSha384Update(auStack_f8,param_3,param_4);
    psHmacSha384Final(local_178,param_5);
    iVar1 = 0;
  }
  return iVar1;
}



undefined4
pkcs1Pad(void *param_1,uint param_2,undefined *param_3,uint param_4,char param_5,undefined4 param_6)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  char *pcVar4;
  uint uVar5;
  
  param_2 = param_2 & 0xffff;
  uVar5 = ((param_4 & 0xffff) - param_2) - 3;
  uVar2 = 0xfffffff7;
  if (7 < uVar5) {
    *param_3 = 0;
    param_3[1] = param_5;
    pcVar3 = param_3 + 2;
    if (param_5 == '\x01') {
      if (uVar5 != 0) {
        do {
          pcVar4 = pcVar3;
          uVar5 = uVar5 - 1;
          *pcVar4 = -1;
          pcVar3 = pcVar4 + 1;
        } while (uVar5 != 0);
        pcVar4[1] = '\0';
        memcpy(pcVar4 + 2,param_1,param_2);
        return 0;
      }
    }
    else {
      iVar1 = psGetPrngLocked(pcVar3,uVar5 & 0xffff,param_6);
      if (iVar1 < 0) {
        return 0xfffffff9;
      }
      while (uVar5 != 0) {
        uVar5 = uVar5 - 1;
        if (*pcVar3 == '\0') {
          *pcVar3 = '\x01';
        }
        pcVar3 = pcVar3 + 1;
      }
    }
    *pcVar3 = '\0';
    memcpy(pcVar3 + 1,param_1,param_2);
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 pkcs1Unpad(char *param_1,uint param_2,char *param_3,uint param_4,char param_5)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  char *pcVar4;
  char *pcVar5;
  
  if ((param_2 & 0xffff) < (param_4 & 0xffff) + 10) {
    return 0xfffffffa;
  }
  pcVar5 = param_1 + (param_2 & 0xffff);
  if ((*param_1 != '\0') || (param_1[1] != param_5)) {
    return 0xffffffff;
  }
  pcVar1 = param_1 + 2;
  if ((pcVar1 < pcVar5) && (cVar3 = param_1[2], cVar3 != '\0')) {
    pcVar4 = pcVar1;
    if (param_5 == '\x01') {
      do {
        pcVar2 = pcVar1;
        pcVar1 = pcVar2 + 1;
        if (cVar3 != -1) {
          return 0xffffffff;
        }
        pcVar4 = pcVar2 + 2;
        if (pcVar5 <= pcVar1) goto LAB_00465b60;
        cVar3 = *pcVar1;
      } while (cVar3 != '\0');
      pcVar4 = pcVar2 + 2;
      goto LAB_00465b60;
    }
    do {
      pcVar1 = pcVar4 + 1;
      pcVar4 = pcVar4 + 2;
      if (pcVar5 <= pcVar1) goto LAB_00465b60;
      pcVar4 = pcVar1;
    } while (*pcVar1 != '\0');
  }
  pcVar4 = pcVar1 + 1;
LAB_00465b60:
  if ((int)pcVar5 - (int)pcVar4 == (param_4 & 0xffff)) {
    for (; pcVar4 < pcVar5; pcVar4 = pcVar4 + 1) {
      *param_3 = *pcVar4;
      param_3 = param_3 + 1;
    }
    return 0;
  }
  return 0xfffffff7;
}



// WARNING: Type propagation algorithm not settling

void psPkcs5Pbkdf2(int param_1,undefined2 param_2,int param_3,undefined4 param_4,int param_5,
                  int param_6,int param_7)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  undefined local_f0 [4];
  undefined4 local_ec;
  undefined4 local_e8;
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined auStack_c8 [160];
  
  if ((((param_1 == 0) || (param_3 == 0)) || (param_6 == 0)) || (param_7 == 0)) {
    _psTraceStr("psAssert %s","keyformat/pkcs.c");
    _psTraceInt(&DAT_0049016c,0x7d6);
    _psError("password && salt && key && kLen");
  }
  iVar6 = 1;
  iVar5 = 0;
  if (param_7 != 0) {
    while( true ) {
      local_dc = CONCAT13((char)iVar6,
                          CONCAT12((char)((uint)iVar6 >> 8),
                                   CONCAT11((char)((uint)iVar6 >> 0x10),(char)((uint)iVar6 >> 0x18))
                                  ));
      local_f0 = (undefined  [4])0x0;
      local_ec = 0;
      local_e8 = 0;
      local_e4 = 0;
      local_e0 = 0;
      local_d8 = 0;
      local_d4 = 0;
      local_d0 = 0;
      local_cc = 0;
      psHmacSha1Init(auStack_c8,param_1,param_2);
      psHmacSha1Update(auStack_c8,param_3,param_4);
      psHmacSha1Update(auStack_c8,&local_dc,4);
      psHmacSha1Final(auStack_c8,local_f0);
      iVar4 = 1;
      local_dc = local_f0;
      local_d8 = local_ec;
      local_d4 = local_e8;
      local_d0 = local_e4;
      local_cc = local_e0;
      iVar6 = iVar6 + 1;
      if (1 < param_5) {
        do {
          psHmacSha1Init(auStack_c8,param_1,param_2);
          psHmacSha1Update(auStack_c8,local_f0,0x14);
          psHmacSha1Final(auStack_c8,local_f0);
          uVar1 = 0;
          do {
            uVar2 = uVar1 + 1;
            *(byte *)((int)&local_dc + uVar1) =
                 *(byte *)((int)&local_dc + uVar1) ^ *(byte *)((int)local_f0 + uVar1);
            uVar1 = uVar2;
          } while (uVar2 < 0x14);
          iVar4 = iVar4 + 1;
        } while (iVar4 < param_5);
      }
      uVar1 = 0;
      if (param_7 == 0) break;
      puVar3 = (undefined4 *)local_f0;
      while( true ) {
        uVar1 = uVar1 + 1;
        *(undefined *)(iVar5 + param_6) = *(undefined *)(puVar3 + 5);
        param_7 = param_7 + -1;
        iVar5 = iVar5 + 1;
        if (0x13 < uVar1) break;
        puVar3 = (undefined4 *)((int)local_f0 + uVar1);
        if (param_7 == 0) goto LAB_00465df4;
      }
      if (param_7 == 0) break;
    }
  }
LAB_00465df4:
  memset_s(local_f0,0x28,0,0x28);
  memset_s(auStack_c8,0xa0,0,0xa0);
  return;
}



undefined4
psPkcs8ParsePrivBin(undefined4 param_1,undefined4 *param_2,int param_3,char *param_4,int param_5)

{
  byte bVar1;
  undefined2 uVar2;
  int iVar3;
  size_t sVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 uVar7;
  uint uVar8;
  uint uVar9;
  undefined4 *puVar10;
  code *pcVar11;
  undefined auStack_378 [2];
  ushort local_376;
  ushort local_374 [2];
  undefined auStack_370 [24];
  undefined auStack_358 [776];
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 *local_40;
  int local_3c;
  undefined4 local_38;
  int local_34;
  undefined4 local_30 [2];
  
  if (0xffff < param_3) {
    return 0xffffffff;
  }
  puVar10 = (undefined4 *)((int)param_2 + param_3);
  local_40 = param_2;
  if (param_4 != (char *)0x0) {
    iVar3 = getAsnSequence(&local_40,(int)puVar10 - (int)param_2 & 0xffff,auStack_378);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    iVar3 = getAsnAlgorithmIdentifier(&local_40,(int)puVar10 - (int)local_40,&local_3c,local_374);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    if (local_3c != 0x695) {
      return 0xffffffff;
    }
    if (local_374[0] != 0x35) {
      return 0xffffffff;
    }
    iVar3 = getAsnSequence(&local_40,(int)puVar10 - (int)local_40 & 0xffff,auStack_378);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    iVar3 = getAsnAlgorithmIdentifier(&local_40,(int)puVar10 - (int)local_40,&local_3c,local_374);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    if (local_3c != 0x694) {
      return 0xffffffff;
    }
    if (local_374[0] != 0x10) {
      return 0xffffffff;
    }
    iVar3 = getAsnSequence(&local_40,(int)puVar10 - (int)local_40 & 0xffff,auStack_378);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    bVar1 = *(byte *)local_40;
    local_40 = (undefined4 *)((int)local_40 + 1);
    if (bVar1 != 4) {
      return 0xffffffff;
    }
    iVar3 = getAsnLength(&local_40,(int)puVar10 - (int)local_40 & 0xffff,&local_376);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    if ((uint)((int)puVar10 - (int)local_40) < (uint)local_376) {
      return 0xffffffff;
    }
    if (local_376 != 8) {
      return 0xffffffff;
    }
    local_48 = *local_40;
    local_44 = local_40[1];
    local_40 = local_40 + 2;
    iVar3 = getAsnInteger(&local_40,(int)puVar10 - (int)local_40,&local_38);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    iVar3 = getAsnAlgorithmIdentifier(&local_40,(int)puVar10 - (int)local_40,&local_3c,local_374);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    if (local_3c != 0x68c) {
      return 0xffffffff;
    }
    if (local_374[0] != 10) {
      return 0xffffffff;
    }
    if (puVar10 == local_40) {
      return 0xffffffff;
    }
    bVar1 = *(byte *)local_40;
    local_40 = (undefined4 *)((int)local_40 + 1);
    if (bVar1 != 4) {
      return 0xffffffff;
    }
    iVar3 = getAsnLength(&local_40,(int)puVar10 - (int)local_40 & 0xffff,&local_376);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    if ((uint)((int)puVar10 - (int)local_40) < (uint)local_376) {
      return 0xffffffff;
    }
    if (local_376 != 8) {
      return 0xffffffff;
    }
    local_50 = *local_40;
    local_4c = local_40[1];
    if (puVar10 == local_40 + 2) {
      return 0xffffffff;
    }
    puVar6 = local_40 + 2;
    local_40 = (undefined4 *)((int)local_40 + 9);
    if (*(byte *)puVar6 != 4) {
      return 0xffffffff;
    }
    iVar3 = getAsnLength(&local_40,(int)puVar10 - (int)local_40 & 0xffff,&local_376);
    if (iVar3 < 0) {
      return 0xffffffff;
    }
    if ((uint)((int)puVar10 - (int)local_40) < (uint)local_376) {
      return 0xffffffff;
    }
    if (local_376 < 0x18) {
      return 0xffffffff;
    }
    sVar4 = strlen(param_4);
    psPkcs5Pbkdf2(param_4,sVar4,&local_48,8,local_38,auStack_370,0x18);
    psDes3Init(auStack_358,&local_50,auStack_370);
    psDes3Decrypt(auStack_358,local_40,local_40,local_376);
    memset_s(auStack_358,0x308,0,0x308);
    memset_s(auStack_370,0x18,0,0x18);
    uVar9 = (uint)local_376;
    if (uVar9 == 0) {
      return 0xffffffff;
    }
    bVar1 = *(byte *)((int)local_40 + (uVar9 - 1));
    uVar5 = (uint)bVar1;
    local_374[0] = (ushort)bVar1;
    if (0xf < (uVar5 - 1 & 0xffff)) {
      return 0xffffffff;
    }
    if (uVar9 < uVar5) {
      return 0xffffffff;
    }
    uVar8 = 0;
    if (uVar5 == 0) {
      uVar5 = (uint)local_374[0];
    }
    else {
      iVar3 = 0;
      do {
        uVar8 = uVar8 + 1 & 0xffff;
        if (*(byte *)((int)local_40 + uVar9 + iVar3 + -1) != uVar5) {
          return 0xffffffff;
        }
        iVar3 = -uVar8;
      } while (uVar8 < uVar5);
    }
    puVar10 = (undefined4 *)((int)local_40 + (uVar9 - uVar5));
  }
  iVar3 = getAsnSequence(&local_40,(int)puVar10 - (int)local_40 & 0xffff,auStack_378);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  iVar3 = getAsnInteger(&local_40,(int)puVar10 - (int)local_40,&local_34);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  if (local_34 != 0) {
    return 0xffffffff;
  }
  iVar3 = getAsnAlgorithmIdentifier(&local_40,(int)puVar10 - (int)local_40,&local_3c,local_374);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  if ((local_3c != 0x206) && (local_3c != 0x285)) {
    return 0xfffffff6;
  }
  if (local_3c == 0x206) {
    if ((puVar10 == local_40) ||
       (bVar1 = *(byte *)local_40, local_40 = (undefined4 *)((int)local_40 + 1), bVar1 != 6)) {
      return 0xffffffe1;
    }
    iVar3 = getAsnLength(&local_40,(int)puVar10 - (int)local_40 & 0xffff,&local_376);
    if (iVar3 < 0) {
      return 0xffffffe1;
    }
    if ((uint)((int)puVar10 - (int)local_40) < (uint)local_376) {
      return 0xffffffe1;
    }
    iVar3 = 0;
    if (local_376 != 0) {
      do {
        bVar1 = *(byte *)local_40;
        local_376 = local_376 - 1;
        local_40 = (undefined4 *)((int)local_40 + 1);
        iVar3 = iVar3 + (uint)bVar1;
      } while (local_376 != 0);
    }
    iVar3 = getEccParamByOid(iVar3,local_30);
    if (iVar3 < 0) {
      return 0xfffffff6;
    }
  }
  if (puVar10 == local_40) {
    return 0xffffffe1;
  }
  bVar1 = *(byte *)local_40;
  local_40 = (undefined4 *)((int)local_40 + 1);
  if (bVar1 != 4) {
    return 0xffffffff;
  }
  iVar3 = getAsnLength(&local_40,(int)puVar10 - (int)local_40 & 0xffff,&local_376);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  if ((uint)((int)puVar10 - (int)local_40) < (uint)local_376) {
    return 0xffffffff;
  }
  if (local_3c == 0x285) {
    psRsaInitKey(param_1,param_5);
    iVar3 = psRsaParsePkcs1PrivKey(param_1,local_40,local_376,param_5);
    pcVar11 = psRsaClearKey;
    if (-1 < iVar3) {
      *(undefined *)(param_5 + 0x6e) = 1;
      uVar2 = psRsaSize(param_5);
      *(undefined2 *)(param_5 + 0x6c) = uVar2;
      goto LAB_0046648c;
    }
LAB_004666c8:
    (*pcVar11)(param_5);
    uVar7 = 0xffffffff;
  }
  else {
LAB_0046648c:
    if (local_3c == 0x206) {
      psEccInitKey(param_1,param_5,local_30[0]);
      iVar3 = psEccParsePrivKey(param_1,local_40,local_376,param_5,local_30[0]);
      if (iVar3 < 0) {
        return 0xffffffff;
      }
      *(undefined *)(param_5 + 0x6e) = 3;
      uVar2 = psEccSize(param_5);
      *(undefined2 *)(param_5 + 0x6c) = uVar2;
    }
    puVar6 = (undefined4 *)((int)local_40 + (uint)local_376);
    local_374[0] = (ushort)((int)puVar10 - (int)puVar6);
    if (((int)puVar10 - (int)puVar6 & 0xffffU) != 0) {
      local_40 = (undefined4 *)((int)puVar6 + 1);
      if (*(byte *)puVar6 == 0xa0) {
        iVar3 = getAsnLength(&local_40,(int)puVar10 - (int)local_40 & 0xffff,&local_376);
        if (iVar3 < 0) {
          return 0xffffffff;
        }
        puVar6 = (undefined4 *)((int)local_40 + (uint)local_376);
        if ((uint)((int)puVar10 - (int)local_40) < (uint)local_376) {
          return 0xffffffff;
        }
        local_374[0] = (short)puVar10 - (short)puVar6;
      }
      local_40 = puVar6;
      if (local_374[0] != 0) {
        pcVar11 = psClearPubKey;
        goto LAB_004666c8;
      }
    }
    uVar7 = 0;
  }
  return uVar7;
}



int psPkcs5Pbkdf1(undefined4 param_1,undefined4 param_2,undefined4 param_3,int param_4,
                 undefined4 *param_5)

{
  int iVar1;
  undefined auStack_f8 [208];
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  
  if (param_4 != 1) {
    _psTraceStr("psAssert %s","keyformat/pkcs.c");
    _psTraceInt(&DAT_0049016c,0x7a1);
    _psError("iter == 1");
  }
  iVar1 = psMd5Init(auStack_f8);
  if (iVar1 == 0) {
    psMd5Update(auStack_f8,param_1,param_2);
    psMd5Update(auStack_f8,param_3,8);
    psMd5Final(auStack_f8,&local_28);
    *param_5 = local_28;
    param_5[1] = local_24;
    param_5[2] = local_20;
    param_5[3] = local_1c;
    iVar1 = psMd5Init(auStack_f8);
    if (iVar1 == 0) {
      psMd5Update(auStack_f8,&local_28,0x10);
      psMd5Update(auStack_f8,param_1,param_2);
      psMd5Update(auStack_f8,param_3,8);
      psMd5Final(auStack_f8,&local_28);
      param_5[4] = local_28;
      param_5[5] = local_24;
      memset_s(&local_28,0x10,0,0x10);
      memset_s(auStack_f8,0xd0,0,0xd0);
      iVar1 = 0;
    }
  }
  return iVar1;
}



int psPkcs1DecodePrivFile
              (undefined4 param_1,int param_2,char *param_3,void **param_4,undefined2 *param_5)

{
  byte bVar1;
  bool bVar2;
  char *__haystack;
  int iVar3;
  char *pcVar4;
  char *__haystack_00;
  char *pcVar5;
  size_t sVar6;
  void *__ptr;
  byte *pbVar7;
  byte *pbVar8;
  uint uVar9;
  byte *pbVar10;
  uint uVar11;
  int iVar12;
  undefined auStack_480 [776];
  undefined auStack_178 [280];
  undefined auStack_60 [32];
  byte local_40 [16];
  char *local_30;
  undefined auStack_2c [4];
  
  iVar12 = 0;
  if (param_2 == 0) {
    return -6;
  }
  iVar3 = psGetFileBuf(param_1,param_2,&local_30,auStack_2c);
  __haystack = local_30;
  if (iVar3 < 0) {
    return iVar3;
  }
  pcVar4 = strstr(local_30,"-----BEGIN");
  if ((((pcVar4 == (char *)0x0) ||
       (pcVar4 = strstr(__haystack,"PRIVATE KEY-----"), pcVar4 == (char *)0x0)) ||
      (__haystack_00 = strstr(pcVar4,"-----END"), __haystack_00 == (char *)0x0)) ||
     (pcVar5 = strstr(__haystack_00,"PRIVATE KEY-----"), pcVar5 == (char *)0x0)) {
    pcVar4 = strstr(__haystack,"-----BEGIN");
    if (((pcVar4 == (char *)0x0) ||
        (pcVar4 = strstr(__haystack,"PUBLIC KEY-----"), pcVar4 == (char *)0x0)) ||
       ((__haystack_00 = strstr(pcVar4,"-----END"), __haystack_00 == (char *)0x0 ||
        (pcVar5 = strstr(__haystack_00,"PUBLIC KEY-----"), pcVar5 == (char *)0x0))))
    goto LAB_00466d44;
    pbVar10 = (byte *)(pcVar4 + 0xf);
    bVar1 = pcVar4[0xf];
    while ((bVar1 == 0xd || (bVar1 == 10))) {
      pbVar10 = pbVar10 + 1;
      bVar1 = *pbVar10;
    }
  }
  else {
    pbVar10 = (byte *)(pcVar4 + 0x10);
    bVar1 = pcVar4[0x10];
    while ((bVar1 == 0xd || (bVar1 == 10))) {
      pbVar10 = pbVar10 + 1;
      bVar1 = *pbVar10;
    }
  }
  pcVar4 = strstr(__haystack,"Proc-Type:");
  uVar11 = (int)__haystack_00 - (int)pbVar10;
  if ((pcVar4 == (char *)0x0) || (pcVar4 = strstr(__haystack,"4,ENCRYPTED"), pcVar4 == (char *)0x0))
  goto LAB_00466b74;
  if (param_3 == (char *)0x0) {
    free(__haystack);
    return -6;
  }
  pcVar4 = strstr(__haystack,"DEK-Info: DES-EDE3-CBC,");
  if (pcVar4 == (char *)0x0) {
    pcVar4 = strstr(__haystack,"DEK-Info: AES-128-CBC,");
    if (pcVar4 == (char *)0x0) {
LAB_00466d44:
      free(__haystack);
      return -0x1f;
    }
    sVar6 = strlen("DEK-Info: AES-128-CBC,");
    pbVar10 = (byte *)(pcVar4 + sVar6);
    pbVar8 = local_40;
    iVar12 = 2;
    bVar2 = true;
    for (pbVar7 = pbVar10; pbVar7 < pbVar10 + 0x20; pbVar7 = pbVar7 + 1) {
      uVar11 = (uint)*pbVar7;
      uVar9 = uVar11 - 0x30 & 0xff;
      if (9 < uVar9) {
        uVar9 = uVar11 - 0x57 & 0xff;
        if ((5 < uVar11 - 0x61) && (uVar9 = uVar11 - 0x37 & 0xff, 5 < uVar11 - 0x41))
        goto LAB_00466fa4;
      }
      if (bVar2) {
        *pbVar8 = (byte)(uVar9 << 4);
      }
      else {
        *pbVar8 = (byte)uVar9 | *pbVar8;
        pbVar8 = pbVar8 + 1;
      }
      bVar2 = (bool)(bVar2 ^ 1);
    }
    iVar3 = 0x20;
  }
  else {
    sVar6 = strlen("DEK-Info: DES-EDE3-CBC,");
    pbVar10 = (byte *)(pcVar4 + sVar6);
    pbVar8 = local_40;
    iVar12 = 1;
    bVar2 = true;
    for (pbVar7 = pbVar10; pbVar7 < pbVar10 + 0x10; pbVar7 = pbVar7 + 1) {
      uVar11 = (uint)*pbVar7;
      uVar9 = uVar11 - 0x30 & 0xff;
      if (9 < uVar9) {
        uVar9 = uVar11 - 0x57 & 0xff;
        if ((5 < uVar11 - 0x61) && (uVar9 = uVar11 - 0x37 & 0xff, 5 < uVar11 - 0x41))
        goto LAB_00466fa4;
      }
      if (bVar2) {
        *pbVar8 = (byte)(uVar9 << 4);
      }
      else {
        *pbVar8 = (byte)uVar9 | *pbVar8;
        pbVar8 = pbVar8 + 1;
      }
      bVar2 = (bool)(bVar2 ^ 1);
    }
    iVar3 = 0x10;
  }
LAB_00466b2c:
  if (-1 < iVar3) {
    pbVar10 = pbVar10 + iVar3;
    sVar6 = strlen(param_3);
    iVar3 = psPkcs5Pbkdf1(param_3,sVar6,local_40,1,auStack_60);
    uVar11 = (int)__haystack_00 - (int)pbVar10;
    if (-1 < iVar3) {
LAB_00466b74:
      __ptr = malloc(uVar11);
      if (__ptr == (void *)0x0) {
        free(local_30);
        _psTraceStr("psError %s","keyformat/pkcs.c");
        _psTraceInt(&DAT_0049016c,0x756);
        _psError("Memory allocation error in psPkcs1DecodePrivFile\n");
        iVar12 = -8;
      }
      else {
        *param_5 = (short)uVar11;
        iVar3 = psBase64decode(pbVar10,uVar11 & 0xffff,__ptr,param_5);
        if (iVar3 < 0) {
          free(__ptr);
          free(local_30);
          return iVar3;
        }
        free(local_30);
        if ((iVar12 == 1) && (param_3 != (char *)0x0)) {
          psDes3Init(auStack_480,local_40,auStack_60);
          psDes3Decrypt(auStack_480,__ptr,__ptr,*param_5);
          memset_s(auStack_480,0x308,0,0x308);
        }
        if ((iVar12 == 2) && (param_3 != (char *)0x0)) {
          psAesInitCBC(auStack_178,local_40,auStack_60,0x10,2);
          psAesDecryptCBC(auStack_178,__ptr,__ptr,*param_5);
          memset_s(auStack_178,0x114,0,0x114);
        }
        memset_s(auStack_60,0x20,0,0x20);
        *param_4 = __ptr;
        iVar12 = 0;
      }
      return iVar12;
    }
  }
  free(local_30);
  return -1;
LAB_00466fa4:
  iVar3 = -1;
  goto LAB_00466b2c;
}



int psPkcs1ParsePrivFile
              (undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  undefined2 *puVar2;
  undefined2 local_98 [4];
  undefined auStack_90 [112];
  void *local_20;
  
  puVar2 = local_98;
  iVar1 = psPkcs1DecodePrivFile();
  if (-1 < iVar1) {
    iVar1 = psRsaParsePkcs1PrivKey(param_1,local_20,local_98[0],param_4,puVar2);
    if ((iVar1 < 0) &&
       (iVar1 = psPkcs8ParsePrivBin(param_1,local_20,local_98[0],param_3,auStack_90), -1 < iVar1)) {
      iVar1 = psRsaCopyKey(param_4,auStack_90);
      psClearPubKey(auStack_90);
    }
    free(local_20);
  }
  return iVar1;
}



undefined4
FUN_0046717c(undefined4 param_1,int param_2,undefined4 param_3,int param_4,undefined *param_5,
            int param_6)

{
  undefined *__ptr;
  undefined4 uVar1;
  uint uVar2;
  undefined *puVar3;
  uint __size;
  int iVar4;
  code *pcVar5;
  undefined auStack_f8 [208];
  
  if ((param_2 == 0) || (param_5 == (undefined *)0x0)) {
    return 0xffffffff;
  }
  __size = 0x14;
  if ((((param_4 == 0) || (__size = 0x10, param_4 == 1)) || (__size = 0x20, param_4 == 2)) ||
     ((__size = 0x30, param_4 == 3 || (__size = 0x40, param_4 == 4)))) {
    __ptr = (undefined *)malloc(__size);
    uVar1 = 0xffffffff;
    if (__ptr != (undefined *)0x0) {
      if (param_6 != 0) {
        __ptr[3] = 0;
        *__ptr = 0;
        __ptr[1] = 0;
        __ptr[2] = 0;
        iVar4 = 1;
        if (param_4 == 0) goto LAB_00467330;
        do {
          if (param_4 == 1) {
            psMd5Init(auStack_f8);
            psMd5Update(auStack_f8,param_2,param_3);
            psMd5Update(auStack_f8,__ptr,4);
            pcVar5 = psMd5Final;
            goto LAB_00467380;
          }
          if (param_4 == 2) {
            psSha256Init(auStack_f8);
            psSha256Update(auStack_f8,param_2,param_3);
            psSha256Update(auStack_f8,__ptr,4);
            pcVar5 = psSha256Final;
            goto LAB_00467380;
          }
          if (param_4 == 3) {
            psSha384Init(auStack_f8);
            psSha384Update(auStack_f8,param_2,param_3);
            psSha384Update(auStack_f8,__ptr,4);
            pcVar5 = psSha384Final;
            goto LAB_00467380;
          }
          if (param_4 == 4) {
            psSha512Init(auStack_f8);
            psSha512Update(auStack_f8,param_2,param_3);
            psSha512Update(auStack_f8,__ptr,4);
            pcVar5 = psSha512Final;
            goto LAB_00467380;
          }
          while( true ) {
            uVar2 = 0;
            if (__size != 0) {
              do {
                puVar3 = __ptr + uVar2;
                if (param_6 == 0) goto LAB_00467288;
                uVar2 = uVar2 + 1;
                *param_5 = *puVar3;
                param_6 = param_6 + -1;
                param_5 = param_5 + 1;
              } while (uVar2 < __size);
            }
            if (param_6 == 0) goto LAB_00467288;
            __ptr[3] = (char)iVar4;
            *__ptr = (char)((uint)iVar4 >> 0x18);
            __ptr[1] = (char)((uint)iVar4 >> 0x10);
            __ptr[2] = (char)((uint)iVar4 >> 8);
            iVar4 = iVar4 + 1;
            if (param_4 != 0) break;
LAB_00467330:
            psSha1Init(auStack_f8);
            psSha1Update(auStack_f8,param_2,param_3);
            psSha1Update(auStack_f8,__ptr,4);
            pcVar5 = psSha1Final;
LAB_00467380:
            (*pcVar5)(auStack_f8,__ptr);
          }
        } while( true );
      }
LAB_00467288:
      free(__ptr);
      uVar1 = 0;
    }
  }
  else {
    uVar1 = 0xfffffff6;
  }
  return uVar1;
}



int psPkcs1PssDecode(undefined4 param_1,int param_2,undefined4 param_3,byte *param_4,uint param_5,
                    uint param_6,int param_7,uint param_8,undefined4 *param_9)

{
  byte *pbVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  size_t __n;
  byte *pbVar5;
  undefined auStack_118 [208];
  byte *local_48;
  undefined *local_44;
  void *local_40;
  void *local_3c;
  int local_38;
  size_t local_34;
  int local_30;
  
  if (param_2 != 0) {
    if (param_9 == (undefined4 *)0x0) {
      return -6;
    }
    *param_9 = 0;
    __n = 0x14;
    if ((((param_7 == 0) || (__n = 0x10, param_7 == 1)) || (__n = 0x20, param_7 == 2)) ||
       ((__n = 0x30, param_7 == 3 || (__n = 0x40, param_7 == 4)))) {
      uVar4 = (param_8 >> 3) + (uint)((param_8 & 7) != 0);
      if (param_6 <= uVar4) {
        if (uVar4 < __n + param_6 + 2) {
          return -6;
        }
        if (param_5 == uVar4) {
          local_48 = (byte *)malloc(uVar4);
          local_38 = -8;
          if (local_48 == (byte *)0x0) {
            return -8;
          }
          memset(local_48,0,uVar4);
          local_44 = (undefined *)malloc(uVar4);
          if (local_44 != (undefined *)0x0) {
            memset(local_44,0,uVar4);
            local_40 = malloc(uVar4);
            if (local_40 != (void *)0x0) {
              memset(local_40,0,uVar4);
              local_3c = malloc(uVar4);
              if (local_3c != (void *)0x0) {
                memset(local_3c,0,uVar4);
                local_38 = -1;
                if (param_4[uVar4 - 1] == 0xbc) {
                  local_34 = (uVar4 - __n) - 1;
                  memcpy(local_48,param_4,local_34);
                  local_30 = uVar4 * 8;
                  memcpy(local_3c,param_4 + local_34,__n);
                  local_38 = -1;
                  if ((((uint)*param_4 & ~(0xff >> ((local_30 - param_8) + 1 & 0x1f))) == 0) &&
                     (local_38 = FUN_0046717c(param_1,local_3c,__n,param_7,local_44,local_34),
                     local_38 == 0)) {
                    uVar3 = 0;
                    if (local_34 != 0) {
                      do {
                        pbVar5 = local_48 + uVar3;
                        pbVar1 = local_44 + uVar3;
                        uVar3 = uVar3 + 1;
                        *pbVar5 = *pbVar5 ^ *pbVar1;
                      } while (uVar3 < local_34);
                    }
                    iVar2 = (uVar4 - param_6) - __n;
                    *local_48 = (byte)(0xff >> ((local_30 - param_8) + 1 & 0x1f)) & *local_48;
                    uVar4 = 0;
                    pbVar1 = local_48;
                    if (iVar2 != 2) {
                      do {
                        uVar4 = uVar4 + 1;
                        if (*pbVar1 != 0) {
                          local_38 = -1;
                          goto LAB_0046772c;
                        }
                        pbVar1 = local_48 + uVar4;
                      } while (uVar4 < iVar2 - 2U);
                    }
                    iVar2 = uVar4 + 1;
                    local_38 = -1;
                    if (local_48[uVar4] == 1) {
                      if (param_7 == 0) {
                        psSha1Init(auStack_118);
                        *local_44 = 0;
                        local_44[1] = 0;
                        local_44[2] = 0;
                        local_44[3] = 0;
                        local_44[4] = 0;
                        local_44[5] = 0;
                        local_44[6] = 0;
                        local_44[7] = 0;
                        psSha1Update(auStack_118,local_44,8);
                        psSha1Update(auStack_118,param_2,param_3);
                        psSha1Update(auStack_118,local_48 + iVar2,param_6);
                        psSha1Final(auStack_118,local_44);
                      }
                      if (param_7 == 1) {
                        psMd5Init(auStack_118);
                        *local_44 = 0;
                        local_44[1] = 0;
                        local_44[2] = 0;
                        local_44[3] = 0;
                        local_44[4] = 0;
                        local_44[5] = 0;
                        local_44[6] = 0;
                        local_44[7] = 0;
                        psMd5Update(auStack_118,local_44,8);
                        psMd5Update(auStack_118,param_2,param_3);
                        psMd5Update(auStack_118,local_48 + iVar2,param_6);
                        psMd5Final(auStack_118,local_44);
                      }
                      if (param_7 == 2) {
                        psSha256Init(auStack_118);
                        *local_44 = 0;
                        local_44[1] = 0;
                        local_44[2] = 0;
                        local_44[3] = 0;
                        local_44[4] = 0;
                        local_44[5] = 0;
                        local_44[6] = 0;
                        local_44[7] = 0;
                        psSha256Update(auStack_118,local_44,8);
                        psSha256Update(auStack_118,param_2,param_3);
                        psSha256Update(auStack_118,local_48 + iVar2,param_6);
                        psSha256Final(auStack_118,local_44);
                      }
                      if (param_7 == 3) {
                        psSha384Init(auStack_118);
                        *local_44 = 0;
                        local_44[1] = 0;
                        local_44[2] = 0;
                        local_44[3] = 0;
                        local_44[4] = 0;
                        local_44[5] = 0;
                        local_44[6] = 0;
                        local_44[7] = 0;
                        psSha384Update(auStack_118,local_44,8);
                        psSha384Update(auStack_118,param_2,param_3);
                        psSha384Update(auStack_118,local_48 + iVar2,param_6);
                        psSha384Final(auStack_118,local_44);
                      }
                      if (param_7 == 4) {
                        psSha512Init(auStack_118);
                        *local_44 = 0;
                        local_44[1] = 0;
                        local_44[2] = 0;
                        local_44[3] = 0;
                        local_44[4] = 0;
                        local_44[5] = 0;
                        local_44[6] = 0;
                        local_44[7] = 0;
                        psSha512Update(auStack_118,local_44,8);
                        psSha512Update(auStack_118,param_2,param_3);
                        psSha512Update(auStack_118,local_48 + iVar2,param_6);
                        psSha512Final(auStack_118,local_44);
                      }
                      iVar2 = memcmp(local_44,local_3c,__n);
                      if (iVar2 == 0) {
                        *param_9 = 1;
                      }
                      local_38 = 0;
                    }
                  }
                }
LAB_0046772c:
                free(local_3c);
              }
              free(local_40);
            }
            free(local_44);
          }
          free(local_48);
          memset_s(auStack_118,0xd0,0,0xd0);
          return local_38;
        }
      }
    }
  }
  return -6;
}



undefined4 FUN_00467cc4(char **param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  char *pcVar4;
  ushort local_28 [2];
  char *local_24;
  int local_20;
  uint local_1c;
  
  local_24 = *param_1;
  pcVar4 = local_24 + param_2;
  if (pcVar4 != local_24) {
    pcVar3 = local_24 + 1;
    if (*local_24 == -0x60) {
      local_24 = pcVar3;
      iVar1 = getAsnLength(&local_24,(int)pcVar4 - (int)pcVar3 & 0xffff,local_28);
      if (iVar1 < 0) {
        return 0xffffffe1;
      }
      if ((int)pcVar4 - (int)local_24 < (int)(uint)local_28[0]) {
        return 0xffffffe1;
      }
      iVar1 = getAsnAlgorithmIdentifier(&local_24,(int)pcVar4 - (int)local_24,&local_20,local_28);
      if (iVar1 < 0) {
        return 0xffffffe1;
      }
      if (param_4 == 0) {
        *(int *)(param_3 + 0x18) = local_20;
      }
      else {
        iVar1 = *(int *)(param_3 + 0x18);
        if (iVar1 != local_20) {
          return 0xffffffe1;
        }
        uVar2 = 0;
        if ((((iVar1 != 0x58) && (uVar2 = 2, iVar1 != 0x19e)) && (uVar2 = 1, iVar1 != 0x289)) &&
           ((uVar2 = 3, iVar1 != 0x19f && (uVar2 = 4, iVar1 != 0x1a0)))) {
          return 0xfffffff6;
        }
        *(undefined4 *)(param_3 + 0x18) = uVar2;
      }
    }
    if (pcVar4 != local_24) {
      pcVar3 = local_24 + 1;
      if (*local_24 == -0x5f) {
        local_24 = pcVar3;
        iVar1 = getAsnLength(&local_24,(int)pcVar4 - (int)pcVar3 & 0xffff,local_28);
        if (iVar1 < 0) {
          return 0xffffffe1;
        }
        if ((int)pcVar4 - (int)local_24 < (int)(uint)local_28[0]) {
          return 0xffffffe1;
        }
        iVar1 = getAsnAlgorithmIdentifier(&local_24,(int)pcVar4 - (int)local_24,&local_20,local_28);
        if (iVar1 < 0) {
          return 0xffffffe1;
        }
        if ((param_4 != 0) && (*(int *)(param_3 + 0x1c) != local_20)) {
          return 0xffffffe1;
        }
        *(int *)(param_3 + 0x1c) = local_20;
        if (local_20 != 0xa8c) {
          return 0xfffffff6;
        }
        iVar1 = getAsnAlgorithmIdentifier(&local_24,(int)pcVar4 - (int)local_24,&local_20,local_28);
        if (iVar1 < 0) {
          return 0xffffffe1;
        }
        if (param_4 == 0) {
          *(int *)(param_3 + 0x20) = local_20;
        }
        else {
          if (*(int *)(param_3 + 0x20) != local_20) {
            return 0xffffffe1;
          }
          *(int *)(param_3 + 0x20) = local_20;
        }
      }
      if (pcVar4 != local_24) {
        pcVar3 = local_24 + 1;
        if (*local_24 == -0x5e) {
          local_24 = pcVar3;
          iVar1 = getAsnLength(&local_24,(int)pcVar4 - (int)pcVar3 & 0xffff,local_28);
          if (iVar1 < 0) {
            return 0xffffffe1;
          }
          if ((int)pcVar4 - (int)local_24 < (int)(uint)local_28[0]) {
            return 0xffffffe1;
          }
          iVar1 = getAsnInteger(&local_24,(int)pcVar4 - (int)local_24,&local_1c);
          if (iVar1 < 0) {
            return 0xffffffe1;
          }
          if (param_4 == 0) {
            *(short *)(param_3 + 0x24) = (short)local_1c;
          }
          else {
            if (*(ushort *)(param_3 + 0x24) != local_1c) {
              return 0xffffffe1;
            }
            *(short *)(param_3 + 0x24) = (short)local_1c;
          }
        }
        if (pcVar4 != local_24) {
          pcVar3 = local_24 + 1;
          if (*local_24 == -0x5d) {
            local_24 = pcVar3;
            iVar1 = getAsnLength(&local_24,(int)pcVar4 - (int)pcVar3 & 0xffff,local_28);
            if (iVar1 < 0) {
              return 0xffffffe1;
            }
            if ((int)pcVar4 - (int)local_24 < (int)(uint)local_28[0]) {
              return 0xffffffe1;
            }
            iVar1 = getAsnInteger(&local_24,(int)pcVar4 - (int)local_24,&local_1c);
            if (iVar1 < 0) {
              return 0xffffffe1;
            }
            if (local_1c != 1) {
              return 0xffffffe1;
            }
          }
          if (local_24 != pcVar4) {
            return 0xffffffe1;
          }
        }
      }
    }
  }
  *param_1 = local_24;
  return 0;
}



undefined4
getSerialNum(undefined4 param_1,char **param_2,uint param_3,void **param_4,ushort *param_5)

{
  char cVar1;
  int iVar2;
  void *__dest;
  uint __size;
  uint uVar3;
  ushort local_18 [2];
  char *local_14;
  
  cVar1 = **param_2;
  if ((cVar1 != -0x7e) && (cVar1 != '\x02')) {
    return 0xffffffe1;
  }
  local_14 = *param_2 + 1;
  if ((param_3 & 0xffff) != 0) {
    uVar3 = (param_3 & 0xffff) - 1;
    iVar2 = getAsnLength(&local_14,uVar3 & 0xffff,local_18);
    if (iVar2 < 0) {
      return 0xffffffe1;
    }
    __size = (uint)local_18[0];
    if ((int)__size <= (int)uVar3) {
      *param_5 = local_18[0];
      if (__size == 0) {
        *param_2 = local_14;
      }
      else {
        __dest = malloc(__size);
        *param_4 = __dest;
        if (__dest == (void *)0x0) {
          _psTraceStr("psError %s","keyformat/x509.c");
          _psTraceInt(&DAT_0049016c,0x10a2);
          _psError("Memory allocation failure in getSerialNum\n");
          return 0xfffffff8;
        }
        memcpy(__dest,local_14,(uint)local_18[0]);
        *param_2 = local_14 + local_18[0];
      }
      return 0;
    }
  }
  return 0xffffffe1;
}



undefined4
FUN_0046821c(undefined4 param_1,byte **param_2,short param_3,uint param_4,void **param_5,
            ushort *param_6)

{
  byte bVar1;
  int iVar2;
  void *__dest;
  undefined4 uVar3;
  byte *local_18 [2];
  
  uVar3 = 0xffffffe1;
  if ((param_3 != 0) && (uVar3 = 0, (uint)**param_2 == (param_4 | 0x80))) {
    local_18[0] = *param_2 + 1;
    iVar2 = getAsnLength(local_18,param_3,param_6);
    uVar3 = 0xffffffe1;
    if ((-1 < iVar2) && (1 < *param_6)) {
      bVar1 = *local_18[0];
      local_18[0] = local_18[0] + 1;
      *param_6 = *param_6 - 1;
      if (bVar1 != 0) {
        _psTraceStr("psAssert %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x11de);
        _psError("ignore_bits == 0");
      }
      __dest = malloc((size_t)*param_6);
      *param_5 = __dest;
      if (__dest == (void *)0x0) {
        _psTraceStr("psError %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x11e3);
        _psError("Memory allocation error in getImplicitBitString\n");
        uVar3 = 0xfffffff8;
      }
      else {
        memcpy(__dest,local_18[0],(size_t)*param_6);
        uVar3 = 0;
        *param_2 = local_18[0] + *param_6;
      }
    }
  }
  return uVar3;
}



undefined4
psX509GetSignature(undefined4 param_1,char **param_2,uint param_3,void **param_4,ushort *param_5)

{
  int iVar1;
  void *__dest;
  char *pcVar2;
  ushort local_20 [2];
  char *local_1c;
  
  pcVar2 = *param_2;
  param_3 = param_3 & 0xffff;
  if ((param_3 != 0) && (local_1c = pcVar2 + 1, *pcVar2 == '\x03')) {
    iVar1 = getAsnLength(&local_1c,param_3 - 1 & 0xffff,local_20);
    if (iVar1 < 0) {
      return 0xffffffe1;
    }
    if (((char *)(uint)local_20[0] <= pcVar2 + (param_3 - (int)local_1c)) &&
       ((char *)0x10 < (char *)(uint)local_20[0])) {
      if (*local_1c != '\0') {
        _psTraceStr("psAssert %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x8e7);
        _psError("*p == 0");
      }
      local_1c = local_1c + 1;
      *param_5 = local_20[0] - 1;
      __dest = malloc((size_t)(local_20[0] - 1));
      *param_4 = __dest;
      if (__dest != (void *)0x0) {
        memcpy(__dest,local_1c,(size_t)*param_5);
        *param_2 = local_1c + *param_5;
        return 0;
      }
      _psTraceStr("psError %s","keyformat/x509.c");
      _psTraceInt(&DAT_0049016c,0x8ee);
      _psError("Memory allocation error in getSignature\n");
      return 0xfffffff8;
    }
  }
  return 0xffffffe1;
}



void psX509FreeDNStruct(void **param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  free(param_1[0x18]);
  free(*param_1);
  free(param_1[1]);
  puVar2 = (undefined4 *)param_1[2];
  while (puVar2 != (undefined4 *)0x0) {
    puVar1 = (undefined4 *)*puVar2;
    free((void *)puVar2[1]);
    free(puVar2);
    puVar2 = puVar1;
  }
  free(param_1[3]);
  free(param_1[5]);
  free(param_1[6]);
  free(param_1[4]);
  puVar2 = (undefined4 *)param_1[7];
  while (puVar2 != (undefined4 *)0x0) {
    puVar1 = (undefined4 *)*puVar2;
    free((void *)puVar2[1]);
    free(puVar2);
    puVar2 = puVar1;
  }
  return;
}



void x509FreeExtensions(undefined4 *param_1)

{
  void *pvVar1;
  void **ppvVar2;
  void **ppvVar3;
  void *pvVar4;
  void **ppvVar5;
  void **ppvVar6;
  
  if (param_1 != (undefined4 *)0x0) {
    pvVar1 = (void *)param_1[3];
    while (pvVar1 != (void *)0x0) {
      pvVar4 = *(void **)((int)pvVar1 + 0x40);
      free(*(void **)((int)pvVar1 + 0x38));
      free(pvVar1);
      pvVar1 = pvVar4;
    }
    pvVar1 = (void *)param_1[4];
    while (pvVar1 != (void *)0x0) {
      pvVar4 = *(void **)((int)pvVar1 + 0x40);
      free(*(void **)((int)pvVar1 + 0x38));
      free(pvVar1);
      pvVar1 = pvVar4;
    }
    ppvVar2 = (void **)param_1[0x34];
    while (ppvVar2 != (void **)0x0) {
      ppvVar5 = (void **)ppvVar2[3];
      free(*ppvVar2);
      free(ppvVar2[1]);
      free(ppvVar2);
      ppvVar2 = ppvVar5;
    }
    if ((void *)param_1[0x37] != (void *)0x0) {
      free((void *)param_1[0x37]);
    }
    pvVar1 = (void *)param_1[0x36];
    while (pvVar1 != (void *)0x0) {
      pvVar4 = *(void **)((int)pvVar1 + 0x40);
      free(*(void **)((int)pvVar1 + 0x38));
      free(pvVar1);
      pvVar1 = pvVar4;
    }
    pvVar1 = (void *)param_1[0x2f];
    while (pvVar1 != (void *)0x0) {
      pvVar4 = *(void **)((int)pvVar1 + 0x40);
      free(*(void **)((int)pvVar1 + 0x38));
      free(pvVar1);
      pvVar1 = pvVar4;
    }
    pvVar1 = (void *)param_1[0x2e];
    while (pvVar1 != (void *)0x0) {
      pvVar4 = *(void **)((int)pvVar1 + 0x40);
      free(*(void **)((int)pvVar1 + 0x38));
      free(pvVar1);
      pvVar1 = pvVar4;
    }
    if ((void *)param_1[8] != (void *)0x0) {
      free((void *)param_1[8]);
    }
    if ((void *)param_1[10] != (void *)0x0) {
      free((void *)param_1[10]);
    }
    if ((void *)param_1[0xb] != (void *)0x0) {
      free((void *)param_1[0xb]);
    }
    psX509FreeDNStruct(param_1 + 0xc,*param_1);
    ppvVar2 = (void **)param_1[0x30];
    while (ppvVar2 != (void **)0x0) {
      ppvVar6 = (void **)ppvVar2[3];
      free(*ppvVar2);
      ppvVar5 = (void **)ppvVar2[2];
      while (ppvVar5 != (void **)0x0) {
        ppvVar3 = (void **)ppvVar5[0xc];
        free(*ppvVar5);
        free(ppvVar5[1]);
        free(ppvVar5[2]);
        free(ppvVar5);
        ppvVar5 = ppvVar3;
      }
      free(ppvVar2);
      ppvVar2 = ppvVar6;
    }
    ppvVar2 = (void **)param_1[0x33];
    while (ppvVar2 != (void **)0x0) {
      ppvVar5 = (void **)ppvVar2[3];
      free(*ppvVar2);
      free(ppvVar2[1]);
      free(ppvVar2);
      ppvVar2 = ppvVar5;
    }
    ppvVar2 = (void **)param_1[0x35];
    if (ppvVar2 != (void **)0x0) {
      if (*ppvVar2 != (void *)0x0) {
        free(*ppvVar2);
        ppvVar2 = (void **)param_1[0x35];
      }
                    // WARNING: Treating indirect jump as call
      free(ppvVar2);
      return;
    }
  }
  return;
}



void psX509FreeCert(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  code *pcVar3;
  
  if (param_1 != (undefined4 *)0x0) {
    do {
      uVar2 = *param_1;
      if ((void *)param_1[0xc4] != (void *)0x0) {
        free((void *)param_1[0xc4]);
      }
      psX509FreeDNStruct(param_1 + 0x29,uVar2);
      psX509FreeDNStruct(param_1 + 0x4a,uVar2);
      if ((void *)param_1[0x27] != (void *)0x0) {
        free((void *)param_1[0x27]);
      }
      if ((void *)param_1[0x6d] != (void *)0x0) {
        free((void *)param_1[0x6d]);
      }
      if ((void *)param_1[0x6e] != (void *)0x0) {
        free((void *)param_1[0x6e]);
      }
      if ((void *)param_1[4] != (void *)0x0) {
        free((void *)param_1[4]);
      }
      if ((void *)param_1[0x70] != (void *)0x0) {
        free((void *)param_1[0x70]);
      }
      if ((void *)param_1[0x71] != (void *)0x0) {
        free((void *)param_1[0x71]);
      }
      if (*(char *)((int)param_1 + 0x96) != '\0') {
        if (param_1[0x6f] == 0x206) {
          pcVar3 = psEccClearKey;
LAB_00468e04:
          puVar1 = param_1 + 10;
        }
        else {
          pcVar3 = psRsaClearKey;
          if (param_1[0x6f] == 0x285) goto LAB_00468e04;
          _psTraceStr("psAssert %s","keyformat/x509.c");
          _psTraceInt(&DAT_0049016c,0x8c3);
          pcVar3 = _psError;
          puVar1 = (undefined4 *)0x491988;
        }
        (*pcVar3)(puVar1);
        *(undefined *)((int)param_1 + 0x96) = 0;
      }
      x509FreeExtensions(param_1 + 0x73);
      puVar1 = (undefined4 *)param_1[199];
      free(param_1);
      param_1 = puVar1;
    } while (puVar1 != (undefined4 *)0x0);
  }
  return;
}



undefined4 psX509ValidateGeneralName(char *param_1)

{
  char cVar1;
  char cVar2;
  undefined4 uVar3;
  char *pcVar4;
  char cVar5;
  int iVar6;
  
  uVar3 = 0;
  if (param_1 != (char *)0x0) {
    cVar2 = *param_1;
    uVar3 = 0xffffffff;
    if (cVar2 != '\0') {
      iVar6 = 0;
      pcVar4 = param_1;
      cVar5 = cVar2;
LAB_00468e68:
      do {
        if (pcVar4 == param_1) {
LAB_00468eac:
          if (((cVar5 == '@') && (iVar6 = iVar6 + 1, pcVar4 != param_1)) &&
             ((pcVar4[1] != '\0' && (iVar6 == 1)))) {
            pcVar4 = pcVar4 + 1;
            cVar5 = *pcVar4;
            if (cVar5 == '\0') break;
            goto LAB_00468e68;
          }
          if (((9 < (byte)(cVar5 - 0x30U)) && (0x19 < (byte)(cVar5 + 0xbfU))) &&
             (0x19 < (byte)(cVar5 + 0x9fU))) {
            return 0xffffffff;
          }
        }
        else {
          if (cVar5 == '.') {
            cVar1 = pcVar4[-1];
            if (cVar1 == '.') {
              return 0xffffffff;
            }
            if (cVar1 == '-') {
              return 0xffffffff;
            }
            if (cVar1 == '@') {
              return 0xffffffff;
            }
LAB_00468e88:
            if (cVar5 == '@') {
              cVar1 = pcVar4[-1];
              if (cVar1 == '.') {
                return 0xffffffff;
              }
              if (cVar1 == '-') {
                return 0xffffffff;
              }
              if (cVar1 == '@') {
                return 0xffffffff;
              }
            }
          }
          else {
            if (cVar5 != '-') goto LAB_00468e88;
            cVar1 = pcVar4[-1];
            if (cVar1 == '.') {
              return 0xffffffff;
            }
            if (cVar1 == '-') {
              return 0xffffffff;
            }
            if (cVar1 == '@') {
              return 0xffffffff;
            }
          }
          if (((pcVar4 == param_1) || (pcVar4[1] == '\0')) || (1 < (byte)(cVar5 - 0x2dU)))
          goto LAB_00468eac;
        }
        pcVar4 = pcVar4 + 1;
        cVar5 = *pcVar4;
      } while (cVar5 != '\0');
      if ((iVar6 == 0) || (uVar3 = 0xffffffff, 9 < (byte)(cVar2 - 0x30U))) {
        return 0;
      }
    }
  }
  return uVar3;
}



undefined4
FUN_00469000(undefined4 param_1,byte **param_2,uint param_3,byte *param_4,void **param_5,
            short param_6)

{
  bool bVar1;
  byte bVar2;
  int iVar3;
  void *__s;
  undefined4 *puVar4;
  uint uVar5;
  byte *pbVar6;
  uint uVar7;
  byte *pbVar8;
  char *__src;
  undefined4 *puVar9;
  uint uVar10;
  int iVar11;
  undefined4 *puVar12;
  ushort local_38 [2];
  byte *local_34;
  byte *local_30;
  
  param_3 = param_3 & 0xffff;
  iVar11 = (int)param_6;
  puVar12 = (undefined4 *)0x0;
  if ((undefined4 *)*param_5 != (undefined4 *)0x0) {
    puVar12 = (undefined4 *)*param_5;
  }
  local_34 = *param_2;
  local_30 = local_34 + param_3;
  do {
    if (param_3 < 4) {
      *param_2 = local_34;
      return 0;
    }
    puVar4 = puVar12;
    if (puVar12 == (undefined4 *)0x0) {
      puVar4 = (undefined4 *)malloc(0x44);
      if (puVar4 == (undefined4 *)0x0) {
        return 0xfffffff8;
      }
      memset(puVar4,0,0x44);
      *puVar4 = param_1;
      *param_5 = puVar4;
      puVar12 = puVar4;
    }
    else {
      do {
        puVar9 = puVar4;
        puVar4 = (undefined4 *)puVar9[0x10];
      } while (puVar4 != (undefined4 *)0x0);
      puVar4 = (undefined4 *)malloc(0x44);
      puVar9[0x10] = puVar4;
      if (puVar4 == (undefined4 *)0x0) {
        return 0xfffffff8;
      }
      memset(puVar4,0,0x44);
      *puVar4 = param_1;
    }
    bVar2 = *local_34;
    local_34 = local_34 + 1;
    puVar4[1] = bVar2 & 0xf;
    uVar10 = param_3 - 1 & 0xffff;
    switch(bVar2 & 0xf) {
    case 0:
      strncpy((char *)(puVar4 + 2),"other",0xf);
      pbVar6 = local_34;
      iVar3 = getAsnLength(&local_34,(int)param_4 - (int)local_34 & 0xffff,local_38);
      if (iVar3 < 0) {
        return 0xffffffe1;
      }
      if (local_38[0] == 0) {
        return 0xffffffe1;
      }
      if ((uint)((int)param_4 - (int)local_34) < (uint)local_38[0]) {
        return 0xffffffe1;
      }
      bVar2 = *local_34;
      local_34 = local_34 + 1;
      if ((bVar2 != 6) ||
         (iVar3 = getAsnLength(&local_34,(int)param_4 - (int)local_34 & 0xffff,puVar4 + 0xf),
         iVar3 < 0)) {
        return 0xffffffff;
      }
      uVar7 = (uint)*(ushort *)(puVar4 + 0xf);
      if ((uint)((int)param_4 - (int)local_34) < uVar7) {
        return 0xffffffff;
      }
      if (0x20 < uVar7) {
        return 0xffffffff;
      }
      memcpy(puVar4 + 6,local_34,uVar7);
      pbVar8 = local_34 + *(ushort *)(puVar4 + 0xf);
      if (param_4 == pbVar8) {
        return 0xffffffe1;
      }
      local_34 = pbVar8 + 1;
      if (*pbVar8 != 0xa0) {
        return 0xffffffe1;
      }
      iVar3 = getAsnLength(&local_34,(int)param_4 - (int)local_34 & 0xffff,local_38);
      if (iVar3 < 0) {
        return 0xffffffe1;
      }
      if (local_38[0] == 0) {
        return 0xffffffe1;
      }
      if ((uint)((int)param_4 - (int)local_34) < (uint)local_38[0]) {
        return 0xffffffe1;
      }
      bVar1 = param_4 == local_34;
      local_34 = local_34 + 1;
      if (bVar1) {
        return 0xffffffe1;
      }
      if ((int)uVar10 <= (int)local_34 - (int)pbVar6) {
        return 0xffffffe1;
      }
      uVar10 = uVar10 - ((int)local_34 - (int)pbVar6) & 0xffff;
      goto LAB_0046914c;
    case 1:
      __src = "email";
      break;
    case 2:
      __src = "DNS";
      break;
    case 3:
      __src = "x400Address";
      break;
    case 4:
      __src = "directoryName";
      break;
    case 5:
      __src = "ediPartyName";
      break;
    case 6:
      __src = "URI";
      break;
    case 7:
      __src = "iPAddress";
      break;
    case 8:
      __src = "registeredID";
      break;
    default:
      __src = "unknown";
    }
    strncpy((char *)(puVar4 + 2),__src,0xf);
LAB_0046914c:
    pbVar6 = local_34;
    iVar3 = getAsnLength(&local_34,(int)param_4 - (int)local_34 & 0xffff,(int)puVar4 + 0x3e);
    if ((((iVar3 < 0) || (uVar7 = (uint)*(ushort *)((int)puVar4 + 0x3e), uVar7 == 0)) ||
        ((uint)((int)param_4 - (int)local_34) < uVar7)) ||
       (((int)uVar10 <= (int)local_34 - (int)pbVar6 ||
        (uVar10 = uVar10 - ((int)local_34 - (int)pbVar6) & 0xffff, uVar10 < uVar7)))) {
      return 0xffffffe1;
    }
    uVar5 = puVar4[1];
    if (uVar5 == 6) {
LAB_004691e0:
      pbVar6 = local_34;
      while (pbVar6 < local_34 + uVar7) {
        bVar2 = *pbVar6;
        pbVar6 = pbVar6 + 1;
        if (0x5e < (byte)(bVar2 - 0x20)) {
          return 0xffffffe1;
        }
      }
    }
    else if (uVar5 < 7) {
      if (uVar5 - 1 < 2) goto LAB_004691e0;
    }
    else if ((uVar5 == 7) && (uVar7 < 4)) {
      return 0xffffffe1;
    }
    __s = malloc(uVar7 + 1);
    puVar4[0xe] = __s;
    if (__s == (void *)0x0) {
      _psTraceStr("psError %s","keyformat/x509.c");
      _psTraceInt(&DAT_0049016c,0xa4d);
      _psError("Memory allocation error: activeName->data\n");
      return 0xfffffff8;
    }
    memset(__s,0,*(ushort *)((int)puVar4 + 0x3e) + 1);
    memcpy((void *)puVar4[0xe],local_34,(uint)*(ushort *)((int)puVar4 + 0x3e));
    local_34 = local_34 + *(ushort *)((int)puVar4 + 0x3e);
    param_3 = uVar10 - *(ushort *)((int)puVar4 + 0x3e) & 0xffff;
    if ((0 < iVar11) && (iVar11 = (iVar11 + -1) * 0x10000 >> 0x10, iVar11 == 0)) {
      *param_2 = local_30;
      return 0;
    }
  } while( true );
}



undefined4
FUN_004695dc(undefined4 param_1,byte *param_2,int param_3,uint param_4,void **param_5,
            undefined2 *param_6)

{
  byte bVar1;
  short sVar2;
  short sVar3;
  int iVar4;
  uint uVar5;
  void *pvVar6;
  short *psVar7;
  short *psVar8;
  uint uVar9;
  int *piVar10;
  int iVar11;
  void **ppvVar12;
  byte *pbVar13;
  byte *pbVar14;
  byte *local_res4 [3];
  short local_70 [32];
  ushort local_30 [2];
  void *local_2c;
  
  param_4 = param_4 & 0xffff;
  local_res4[0] = param_2;
  memset(local_70,0,0x40);
  pbVar14 = local_res4[0];
  iVar4 = getAsnSequence(local_res4,param_3 - (int)local_res4[0] & 0xffff,local_30);
  if (iVar4 < 0) {
    return 0xffffffe1;
  }
  *param_6 = (short)(local_res4[0] + ((uint)local_30[0] - (int)pbVar14));
  pbVar14 = pbVar14 + ((uint)(local_res4[0] + ((uint)local_30[0] - (int)pbVar14)) & 0xffff);
  if (local_30[0] == 0) {
    return 0xffffffe1;
  }
  bVar1 = *local_res4[0];
  local_res4[0] = local_res4[0] + 1;
  if (bVar1 != 6) {
    return 0xffffffe1;
  }
  iVar4 = getAsnLength(local_res4,param_4,local_30);
  if (iVar4 < 0) {
    return 0xffffffe1;
  }
  if (param_4 < local_30[0]) {
    return 0xffffffe1;
  }
  uVar5 = asnParseOid(local_res4[0],(uint)local_30[0],local_70);
  if (uVar5 == 0) {
    return 0xffffffe1;
  }
  if (0x10 < uVar5) {
    _psTraceStr("psAssert %s","keyformat/x509.c");
    _psTraceInt(&DAT_0049016c,0xa6e);
    _psError("oidlen <= MAX_OID_LEN");
  }
  iVar4 = 0;
  piVar10 = &DAT_004910c4;
  iVar11 = 0;
  do {
    uVar9 = 0;
    if (0 < (int)uVar5) {
      psVar8 = &DAT_004910a4 + iVar4 * 0x12;
      psVar7 = local_70;
      do {
        sVar2 = *psVar8;
        sVar3 = *psVar7;
        uVar9 = uVar9 + 1;
        psVar7 = psVar7 + 2;
        psVar8 = psVar8 + 1;
        if (sVar2 != sVar3) break;
        if (uVar9 == uVar5) {
          iVar4 = (&DAT_004910c4)[iVar11];
          goto LAB_004697d0;
        }
      } while ((int)uVar9 < (int)uVar5);
    }
    piVar10 = piVar10 + 9;
    iVar4 = iVar4 + 1;
    iVar11 = iVar11 + 9;
    if (*piVar10 == 0) {
      iVar4 = 0;
LAB_004697d0:
      local_res4[0] = local_res4[0] + local_30[0];
      if (iVar4 == 0x1c) {
        bVar1 = *local_res4[0];
        local_res4[0] = local_res4[0] + 1;
        if (bVar1 != 0x16) {
          return 0xffffffe1;
        }
        iVar4 = getAsnLength(local_res4,param_4,local_30);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        if (param_4 < local_30[0]) {
          return 0xffffffe1;
        }
        pvVar6 = malloc(local_30[0] + 1);
        *param_5 = pvVar6;
        *(ushort *)(param_5 + 8) = local_30[0];
        memcpy(pvVar6,local_res4[0],(size_t)local_30[0]);
        pvVar6 = *param_5;
      }
      else {
        if (iVar4 != 0x1d) {
          return 0xffffffe1;
        }
        iVar4 = getAsnSequence(local_res4,param_3 - (int)local_res4[0] & 0xffff,local_30);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        if (local_30[0] == 0) {
          return 0;
        }
        if (pbVar14 <= local_res4[0]) {
          return 0;
        }
        if (*local_res4[0] == 0x30) {
          iVar4 = getAsnSequence(local_res4,param_3 - (int)local_res4[0] & 0xffff,local_30);
          if (iVar4 < 0) {
            return 0xffffffe1;
          }
          bVar1 = *local_res4[0];
          if ((((bVar1 != 0xc) && (bVar1 != 0x1a)) && (bVar1 != 0x1e)) && (bVar1 != 0x16)) {
            return 0xffffffe1;
          }
          bVar1 = *local_res4[0];
          local_res4[0] = local_res4[0] + 1;
          param_5[0xb] = (void *)(uint)bVar1;
          iVar4 = getAsnLength(local_res4,param_4,local_30);
          if (iVar4 < 0) {
            return 0xffffffe1;
          }
          if (param_4 < local_30[0]) {
            return 0xffffffe1;
          }
          pvVar6 = malloc(local_30[0] + 1);
          param_5[1] = pvVar6;
          if (pvVar6 == (void *)0x0) {
            return 0xfffffff8;
          }
          *(ushort *)((int)param_5 + 0x22) = local_30[0];
          memcpy(pvVar6,local_res4[0],(size_t)local_30[0]);
          *(undefined *)((int)param_5[1] + (uint)local_30[0]) = 0;
          local_res4[0] = local_res4[0] + local_30[0];
          iVar4 = getAsnSequence(local_res4,param_3 - (int)local_res4[0] & 0xffff,local_30);
          if (iVar4 < 0) {
            return 0xffffffe1;
          }
          pbVar13 = local_res4[0] + local_30[0];
          iVar4 = 0;
          if (local_res4[0] != pbVar13) {
            ppvVar12 = param_5 + 3;
            do {
              if (iVar4 == 5) {
                return 0xffffffe1;
              }
              iVar4 = iVar4 + 1;
              iVar11 = getAsnInteger(local_res4,local_30[0],&local_2c);
              if (iVar11 < 0) {
                return 0xffffffe1;
              }
              *ppvVar12 = local_2c;
              ppvVar12 = ppvVar12 + 1;
            } while (local_res4[0] != pbVar13);
          }
          *(short *)((int)param_5 + 0x26) = (short)iVar4;
        }
        if (pbVar14 <= local_res4[0]) {
          return 0;
        }
        bVar1 = *local_res4[0];
        if (((bVar1 != 0xc) && (bVar1 != 0x1a)) && ((bVar1 != 0x1e && (bVar1 != 0x16)))) {
          return 0xffffffe1;
        }
        bVar1 = *local_res4[0];
        local_res4[0] = local_res4[0] + 1;
        param_5[10] = (void *)(uint)bVar1;
        iVar4 = getAsnLength(local_res4,param_4,local_30);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        if (param_4 < local_30[0]) {
          return 0xffffffe1;
        }
        pvVar6 = malloc(local_30[0] + 1);
        param_5[2] = pvVar6;
        if (pvVar6 == (void *)0x0) {
          return 0xfffffff8;
        }
        *(ushort *)(param_5 + 9) = local_30[0];
        memcpy(pvVar6,local_res4[0],(size_t)local_30[0]);
        pvVar6 = param_5[2];
      }
      *(undefined *)((int)pvVar6 + (uint)local_30[0]) = 0;
      return 0;
    }
  } while( true );
}



undefined4
FUN_00469bb4(undefined4 param_1,char *param_2,char *param_3,ushort param_4,void **param_5,
            undefined2 *param_6)

{
  char cVar1;
  int iVar2;
  void *pvVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  int iVar7;
  int iVar8;
  char *pcVar9;
  char *pcVar10;
  char *local_res4 [3];
  undefined4 local_70 [16];
  ushort local_30;
  ushort local_2e [3];
  
  local_res4[0] = param_2;
  memset(local_70,0,0x40);
  pcVar10 = local_res4[0];
  iVar2 = getAsnSequence(local_res4,(int)param_3 - (int)local_res4[0] & 0xffff,&local_30);
  uVar6 = 0xffffffe1;
  if (-1 < iVar2) {
    pcVar9 = local_res4[0] + ((uint)local_30 - (int)pcVar10);
    *param_6 = (short)pcVar9;
    cVar1 = *local_res4[0];
    local_res4[0] = local_res4[0] + 1;
    uVar6 = 0xffffffe1;
    if (cVar1 == '\x06') {
      iVar2 = getAsnLength(local_res4,param_4,&local_30);
      uVar6 = 0xffffffe1;
      if ((-1 < iVar2) && (local_30 <= param_4)) {
        iVar2 = asnParseOid(local_res4[0],local_30,local_70);
        uVar6 = 0xffffffe1;
        if ((iVar2 != 0) && (local_res4[0] = local_res4[0] + local_30, (iVar2 - 1U & 0xff) < 0x10))
        {
          pvVar3 = malloc(iVar2 << 2);
          *param_5 = pvVar3;
          uVar6 = 0xfffffff8;
          if (pvVar3 != (void *)0x0) {
            iVar7 = 0;
            if (0 < iVar2) {
              do {
                iVar8 = iVar7 * 4;
                puVar4 = local_70 + iVar7;
                iVar7 = iVar7 + 1;
                *(undefined4 *)(iVar8 + (int)pvVar3) = *puVar4;
              } while (iVar7 < iVar2);
            }
            *(short *)(param_5 + 1) = (short)iVar2;
            if ((pcVar10 + ((uint)pcVar9 & 0xffff) <= local_res4[0]) || (*local_res4[0] != '0')) {
              return 0;
            }
            iVar2 = getAsnSequence(local_res4,(int)param_3 - (int)local_res4[0] & 0xffff,&local_30);
            uVar6 = 0xffffffe1;
            if (-1 < iVar2) {
              pcVar10 = local_res4[0] + local_30;
              puVar4 = (undefined4 *)malloc(0x34);
              param_5[2] = puVar4;
              uVar6 = 0xfffffff8;
              if (puVar4 != (undefined4 *)0x0) {
                *puVar4 = 0;
                puVar4[1] = 0;
                puVar4[2] = 0;
                puVar4[3] = 0;
                puVar4[4] = 0;
                puVar4[5] = 0;
                puVar4[6] = 0;
                puVar4[7] = 0;
                puVar4[8] = 0;
                puVar4[9] = 0;
                puVar4[10] = 0;
                puVar4[0xb] = 0;
                puVar4[0xc] = 0;
                iVar2 = FUN_004695dc(param_1,local_res4[0],param_3,param_4,puVar4,local_2e);
                uVar6 = 0xffffffe1;
                if (-1 < iVar2) {
                  local_res4[0] = local_res4[0] + local_2e[0];
                  if (pcVar10 <= local_res4[0]) {
                    return 0;
                  }
                  if (param_3 <= local_res4[0]) {
                    return 0;
                  }
                  cVar1 = *local_res4[0];
                  while( true ) {
                    if (cVar1 != '0') {
                      return 0;
                    }
                    puVar5 = (undefined4 *)malloc(0x34);
                    puVar4[0xc] = puVar5;
                    if (puVar5 == (undefined4 *)0x0) {
                      return 0xfffffff8;
                    }
                    puVar5[0xc] = 0;
                    *puVar5 = 0;
                    puVar5[1] = 0;
                    puVar5[2] = 0;
                    puVar5[3] = 0;
                    puVar5[4] = 0;
                    puVar5[5] = 0;
                    puVar5[6] = 0;
                    puVar5[7] = 0;
                    puVar5[8] = 0;
                    puVar5[9] = 0;
                    puVar5[10] = 0;
                    puVar5[0xb] = 0;
                    puVar4 = (undefined4 *)puVar4[0xc];
                    iVar2 = FUN_004695dc(param_1,local_res4[0],param_3,param_4,puVar4,local_2e);
                    if (iVar2 < 0) {
                      return 0xffffffe1;
                    }
                    local_res4[0] = local_res4[0] + local_2e[0];
                    if (pcVar10 <= local_res4[0]) break;
                    if (param_3 <= local_res4[0]) {
                      return 0;
                    }
                    cVar1 = *local_res4[0];
                  }
                  return 0;
                }
              }
            }
          }
        }
      }
    }
  }
  return uVar6;
}



int psX509GetDNAttributes
              (undefined4 param_1,byte **param_2,undefined2 param_3,int param_4,uint param_5)

{
  byte bVar1;
  bool bVar2;
  byte *__src;
  int iVar3;
  int iVar4;
  char *__s;
  size_t sVar5;
  void *__dest;
  byte *pbVar6;
  uint uVar7;
  uint uVar8;
  undefined4 uVar9;
  uint uVar10;
  byte *pbVar11;
  ushort local_a0;
  ushort local_9e;
  ushort local_9c [2];
  undefined auStack_98 [96];
  byte *local_38;
  char *local_34;
  uint local_30 [2];
  
  __src = *param_2;
  local_38 = __src;
  iVar3 = getAsnSequence(&local_38,param_3,&local_a0);
  if (iVar3 < 0) {
    return -0x1f;
  }
  pbVar11 = local_38 + local_a0;
  if ((param_5 >> 1 & 1) != 0) {
    *(short *)(param_4 + 100) = (short)((int)pbVar11 - (int)__src);
    __dest = malloc((int)pbVar11 - (int)__src & 0xffff);
    *(void **)(param_4 + 0x60) = __dest;
    if (__dest == (void *)0x0) {
      _psTraceStr("psError %s","keyformat/x509.c");
      uVar9 = 0x1218;
LAB_0046a860:
      _psTraceInt(&DAT_0049016c,uVar9);
      _psError("Memory allocation error in getDNAttributes\n");
      return -8;
    }
    memcpy(__dest,__src,(size_t)*(undefined2 *)(param_4 + 100));
  }
  iVar3 = 0;
  do {
    if (pbVar11 <= local_38) {
      psSha1Init(auStack_98);
      psSha1Update(auStack_98,__src,(int)pbVar11 - (int)__src);
      psSha1Final(auStack_98,param_4 + 0x20);
      *param_2 = local_38;
      return 0;
    }
    iVar4 = getAsnSet(&local_38,(int)pbVar11 - (int)local_38 & 0xffff,&local_9e);
    if (iVar4 < 0) {
      return -0x1f;
    }
    do {
      pbVar6 = local_38;
      iVar4 = getAsnSequence(&local_38,(int)pbVar11 - (int)local_38 & 0xffff,&local_a0);
      if (iVar4 < 0) {
        return -0x1f;
      }
      if (iVar3 < 1) {
        iVar4 = (int)local_38 - (int)pbVar6;
        if ((uint)local_9e != (uint)local_a0 + iVar4) {
          iVar3 = ((uint)local_9e - iVar4) - (uint)local_a0;
        }
      }
      else {
        iVar3 = iVar3 - (int)(local_38 + ((uint)local_a0 - (int)pbVar6));
      }
      if (pbVar11 <= local_38) {
        return -0x1f;
      }
      bVar1 = *local_38;
      local_38 = local_38 + 1;
      if (bVar1 != 6) {
        return -0x1f;
      }
      iVar4 = getAsnLength(&local_38,(int)pbVar11 - (int)local_38 & 0xffff,local_9c);
      if (iVar4 < 0) {
        return -0x1f;
      }
      uVar10 = (uint)local_9c[0];
      if ((uint)((int)pbVar11 - (int)local_38) < uVar10) {
        return -0x1f;
      }
      *param_2 = local_38;
      if ((int)pbVar11 - (int)local_38 < 2) {
        return -9;
      }
      if (((((((uVar10 == 10) && (*local_38 == 9)) && (local_38[1] == 0x92)) &&
            ((local_38[2] == 0x26 && (local_38[3] == 0x89)))) &&
           ((local_38[4] == 0x93 && ((local_38[5] == 0xf2 && (local_38[6] == 0x2c)))))) &&
          (local_38[7] == 100)) &&
         ((local_38[8] == 1 && (pbVar6 = local_38 + 10, local_38[9] == 0x19)))) {
        uVar10 = 0x19;
      }
      else {
        if ((*local_38 != 0x55) || (local_38[1] != 4)) {
          if ((uint)((int)pbVar11 - (int)local_38) < uVar10 + 1) {
            return -9;
          }
          local_38 = local_38 + uVar10 + 1;
          iVar4 = getAsnLength(&local_38,(int)pbVar11 - (int)local_38 & 0xffff,&local_a0);
          if (iVar4 < 0) {
            return -0x1f;
          }
          uVar10 = (int)pbVar11 - (int)local_38;
          local_38 = local_38 + local_a0;
          if (uVar10 < local_a0) {
            return -0x1f;
          }
          break;
        }
        if (uVar10 != 3) {
          return -9;
        }
        pbVar6 = local_38 + 3;
        if ((int)pbVar11 - (int)(local_38 + 2) < 2) {
          return -9;
        }
        uVar10 = (uint)local_38[2];
      }
      local_38 = pbVar6 + 1;
      bVar1 = *pbVar6;
      iVar4 = getAsnLength(&local_38,(int)pbVar11 - (int)local_38 & 0xffff,&local_a0);
      if (iVar4 < 0) {
        return -9;
      }
      uVar8 = (uint)local_a0;
      if ((uint)((int)pbVar11 - (int)local_38) < uVar8) {
        return -9;
      }
      bVar2 = false;
      if (0x1e < bVar1) {
        return -10;
      }
      uVar7 = 1 << (bVar1 & 0x1f);
      if ((uVar7 & 0x581000) == 0) {
        if ((uVar7 & 8) != 0) goto LAB_0046a26c;
        if ((uVar7 & 0x40000000) == 0) {
          return -10;
        }
        local_34 = (char *)0x0;
        iVar4 = psToUtf8String(param_1,local_38,uVar8,0x1e,&local_34,local_30,2);
        if (iVar4 != 0) {
          return iVar4;
        }
        if (0x7ffd < local_30[0]) {
          free(local_34);
          return -9;
        }
        local_38 = local_38 + local_a0;
        local_a0 = (ushort)local_30[0];
        __s = local_34;
      }
      else {
        bVar2 = true;
LAB_0046a26c:
        __s = (char *)malloc(uVar8 + 2);
        if (__s == (char *)0x0) {
          _psTraceStr("psError %s","keyformat/x509.c");
          uVar9 = 0x12ef;
          goto LAB_0046a860;
        }
        memcpy(__s,local_38,(size_t)local_a0);
        uVar8 = 0;
        do {
          iVar4 = uVar8 + local_a0;
          uVar8 = uVar8 + 1;
          __s[iVar4] = '\0';
        } while (uVar8 < 2);
        if ((bVar2) && (sVar5 = strlen(__s), sVar5 != local_a0)) {
          free(__s);
          return -0x1f;
        }
        local_38 = local_38 + local_a0;
      }
      local_a0 = local_a0 + 2;
      if (uVar10 - 3 < 0x2c) {
                    // WARNING: Could not recover jumptable at 0x0046a260. Too many branches
                    // WARNING: Treating indirect jump as call
        iVar3 = (*(code *)(&_gp + *(int *)(&DAT_00491aa4 + (uVar10 - 3) * 4)))();
        return iVar3;
      }
      free(__s);
    } while (iVar3 != 0);
  } while( true );
}



undefined4
getExplicitExtensions
          (undefined4 param_1,byte **param_2,uint param_3,uint param_4,undefined4 *param_5,
          char param_6)

{
  bool bVar1;
  bool bVar2;
  void **ppvVar3;
  int iVar4;
  uint uVar5;
  void *pvVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  byte *pbVar9;
  short *psVar10;
  char *pcVar11;
  byte bVar12;
  byte *pbVar13;
  undefined4 uVar14;
  short *psVar15;
  uint uVar16;
  int *piVar17;
  int iVar18;
  void **ppvVar19;
  byte *pbVar20;
  int iVar21;
  ushort local_118;
  ushort local_116 [3];
  short local_110 [32];
  ushort local_d0;
  ushort local_ce;
  undefined auStack_cc [4];
  short local_c8 [32];
  ushort local_88 [4];
  undefined4 local_80 [16];
  ushort local_40 [2];
  byte *local_3c;
  byte *local_38;
  byte *local_34;
  byte *local_30;
  int local_2c;
  
  pbVar13 = *param_2;
  param_3 = param_3 & 0xffff;
  local_2c = 0;
  if (param_3 == 0) {
    return 0xfffffffa;
  }
  param_5[1] = 0x7f;
  *param_5 = param_1;
  local_3c = pbVar13;
  if (param_6 == '\0') {
    if ((uint)*pbVar13 != (param_4 | 0xa0)) {
      return 0;
    }
    local_3c = pbVar13 + 1;
    iVar4 = getAsnLength(&local_3c,(uint)(pbVar13 + (param_3 - (int)local_3c)) & 0xffff,&local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    if (pbVar13 + (param_3 - (int)local_3c) < (byte *)(uint)local_118) {
      return 0xffffffe1;
    }
  }
  iVar4 = getAsnSequence(&local_3c,(uint)(pbVar13 + (param_3 - (int)local_3c)) & 0xffff,&local_118);
  if ((iVar4 < 0) ||
     (pbVar20 = local_3c + (int)(byte *)(uint)local_118,
     pbVar13 + (param_3 - (int)local_3c) < (byte *)(uint)local_118)) {
    return 0xffffffe1;
  }
LAB_0046aa08:
  if ((local_3c == pbVar20) || (*local_3c != 0x30)) {
    *param_2 = local_3c;
    return 0;
  }
  iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,local_116);
  pbVar13 = local_3c;
  if (iVar4 < 0) {
    return 0xffffffe1;
  }
  pbVar9 = local_3c + 1;
  if ((int)pbVar20 - (int)local_3c < 1) {
    return 0xffffffe1;
  }
  if (*local_3c != 6) {
    return 0xffffffe1;
  }
  local_3c = pbVar9;
  iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)pbVar9 & 0xffff,&local_118);
  if (iVar4 < 0) {
    return 0xffffffe1;
  }
  if ((uint)((int)pbVar20 - (int)local_3c) < (uint)local_118) {
    return 0xffffffe1;
  }
  uVar5 = asnParseOid(local_3c,(uint)local_118,local_110);
  if (uVar5 == 0) {
    return 0xffffffe1;
  }
  if (0x10 < uVar5) {
    _psTraceStr("psAssert %s","keyformat/x509.c");
    _psTraceInt(&DAT_0049016c,0xa6e);
    _psError("oidlen <= MAX_OID_LEN");
  }
  iVar4 = 0;
  piVar17 = &DAT_004910c4;
  iVar18 = 0;
  do {
    uVar16 = 0;
    if (0 < (int)uVar5) {
      psVar15 = &DAT_004910a4 + iVar4 * 0x12;
      psVar10 = local_110;
      do {
        uVar16 = uVar16 + 1;
        if (*psVar15 != *psVar10) break;
        if (uVar16 == uVar5) {
          uVar5 = (&DAT_004910c4)[iVar18];
          goto LAB_0046ab5c;
        }
        psVar10 = psVar10 + 2;
        psVar15 = psVar15 + 1;
      } while ((int)uVar16 < (int)uVar5);
    }
    piVar17 = piVar17 + 9;
    iVar4 = iVar4 + 1;
    iVar18 = iVar18 + 9;
  } while (*piVar17 != 0);
  uVar5 = 0;
LAB_0046ab5c:
  bVar1 = false;
  pbVar9 = local_3c + local_118;
  if ((int)pbVar20 - (int)pbVar9 < 1) {
    return 0xffffffe1;
  }
  if (*pbVar9 == 1) {
    if ((int)pbVar20 - (int)(pbVar9 + 1) < 2) {
      return 0xffffffe1;
    }
    if (pbVar9[1] != 1) {
      return 0xffffffe1;
    }
    bVar1 = pbVar9[2] != 0;
    pbVar9 = pbVar9 + 3;
  }
  local_3c = pbVar9 + 1;
  if ((int)pbVar20 - (int)pbVar9 < 1) {
    return 0xffffffe1;
  }
  if (*pbVar9 != 4) {
    return 0xffffffe1;
  }
  iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
  pbVar9 = local_3c;
  if (iVar4 < 0) {
    return 0xffffffe1;
  }
  if ((uint)((int)pbVar20 - (int)local_3c) < (uint)local_118) {
    return 0xffffffe1;
  }
  if (bVar1) {
    param_5[5] = param_5[5] | 1 << (uVar5 & 0x1f);
  }
  switch(uVar5) {
  default:
    if (bVar1) {
      _psTrace(
              "An unsupported critical extension was encountered.  X.509 specifications say connections must be terminated in this case. Define ALLOW_UNKNOWN_CRITICAL_EXTENSIONS to bypass this rule if testing and email Inside support to inquire about this extension.\n"
              );
      return 0xffffffe1;
    }
  case 0xf:
    local_3c = pbVar13 + local_116[0];
    goto LAB_0046aa08;
  case 1:
    iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    if (local_118 != 0) {
      pbVar13 = local_3c + 1;
      if (*local_3c == 0x80) {
        local_3c = pbVar13;
        iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)pbVar13 & 0xffff,param_5 + 0x2d);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        if ((uint)((int)pbVar20 - (int)local_3c) < (uint)*(ushort *)(param_5 + 0x2d)) {
          return 0xffffffe1;
        }
        pvVar6 = malloc((uint)*(ushort *)(param_5 + 0x2d));
        param_5[10] = pvVar6;
        if (pvVar6 == (void *)0x0) {
          _psTraceStr("psError %s","keyformat/x509.c");
          _psTraceInt(&DAT_0049016c,0xfb5);
          pcVar11 = "Mem allocation err: extensions->ak.keyId\n";
          goto LAB_0046c488;
        }
        memcpy(pvVar6,local_3c,(uint)*(ushort *)(param_5 + 0x2d));
        local_3c = local_3c + *(ushort *)(param_5 + 0x2d);
      }
      pbVar13 = local_3c + 1;
      if (*local_3c == 0xa1) {
        local_3c = pbVar13;
        iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)pbVar13 & 0xffff,&local_118);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        if (local_118 == 0) {
          return 0xffffffe1;
        }
        if ((uint)((int)pbVar20 - (int)local_3c) < (uint)local_118) {
          return 0xffffffe1;
        }
        bVar12 = *local_3c;
        local_3c = local_3c + 1;
        if (bVar12 != 0xa4) {
          return 0xffffffe1;
        }
        iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        if ((uint)((int)pbVar20 - (int)local_3c) < (uint)local_118) {
          return 0xffffffe1;
        }
        iVar4 = psX509GetDNAttributes
                          (param_1,&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,param_5 + 0xc,0);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
      }
      if ((*local_3c == 0x82) || (*local_3c == 2)) {
        iVar4 = getSerialNum(param_1,&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,param_5 + 0xb,
                             &local_118);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        *(ushort *)((int)param_5 + 0xb6) = local_118;
      }
    }
    goto LAB_0046aa08;
  case 2:
    bVar12 = *local_3c;
    local_3c = local_3c + 1;
    if (bVar12 != 4) {
      return 0xffffffe1;
    }
    iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,param_5 + 9);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    if ((uint)((int)pbVar20 - (int)local_3c) < (uint)*(ushort *)(param_5 + 9)) {
      return 0xffffffe1;
    }
    pvVar6 = malloc((uint)*(ushort *)(param_5 + 9));
    param_5[8] = pvVar6;
    if (pvVar6 == (void *)0x0) {
      _psTraceStr("psError %s","keyformat/x509.c");
      _psTraceInt(&DAT_0049016c,0xffa);
      pcVar11 = "Memory allocation error extensions->sk.id\n";
LAB_0046c488:
      _psError(pcVar11);
      return 0xfffffff8;
    }
    memcpy(pvVar6,local_3c,(uint)*(ushort *)(param_5 + 9));
    local_3c = local_3c + *(ushort *)(param_5 + 9);
    goto LAB_0046aa08;
  case 3:
    bVar12 = *local_3c;
    local_3c = local_3c + 1;
    if (bVar12 != 3) {
      return 0xffffffe1;
    }
    iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    uVar5 = (uint)local_118;
    if ((uint)((int)pbVar20 - (int)local_3c) < uVar5) {
      return 0xffffffe1;
    }
    if (uVar5 < 2) {
      return 0xffffffe1;
    }
    if (((uVar5 < 3) || (local_3c[2] != 0x80)) || (*local_3c != 7)) {
      uVar16 = param_5[6];
    }
    else {
      uVar16 = param_5[6] | 0x8000;
      param_5[6] = uVar16;
    }
    pbVar13 = local_3c + 1;
    local_3c = local_3c + uVar5;
    param_5[6] = uVar16 | *pbVar13;
    goto LAB_0046aa08;
  case 4:
    iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    pbVar13 = local_3c + local_118;
    puVar8 = (undefined4 *)malloc(0x10);
    param_5[0x30] = puVar8;
    *puVar8 = 0;
    puVar8[1] = 0;
    puVar8[2] = 0;
    puVar8[3] = 0;
    iVar4 = FUN_00469bb4(param_1,local_3c,pbVar20,local_116[0],puVar8,&local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    local_3c = local_3c + local_118;
    if ((local_3c < pbVar13) && (local_3c < pbVar20)) {
      bVar12 = *local_3c;
      while (bVar12 == 0x30) {
        puVar7 = (undefined4 *)malloc(0x10);
        puVar8[3] = puVar7;
        puVar7[3] = 0;
        *puVar7 = 0;
        puVar7[1] = 0;
        puVar7[2] = 0;
        puVar8 = (undefined4 *)puVar8[3];
        iVar4 = FUN_00469bb4(param_1,local_3c,pbVar20,local_116[0],puVar8,&local_118);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        local_3c = local_3c + local_118;
        if ((pbVar13 <= local_3c) || (pbVar20 <= local_3c)) break;
        bVar12 = *local_3c;
      }
    }
    goto LAB_0046aa08;
  case 5:
    ppvVar19 = (void **)malloc(0x10);
    local_30 = local_3c;
    param_5[0x33] = ppvVar19;
    *ppvVar19 = (void *)0x0;
    ppvVar19[1] = (void *)0x0;
    ppvVar19[2] = (void *)0x0;
    ppvVar19[3] = (void *)0x0;
    memset(local_80,0,0x40);
    pbVar13 = local_30;
    iVar18 = getAsnSequence(&local_30,(int)pbVar20 - (int)local_30 & 0xffff,local_40);
    iVar4 = 0;
    if (iVar18 < 0) {
      return 0xffffffe1;
    }
    pbVar9 = local_30 + local_40[0];
    local_118 = (short)pbVar9 - (short)pbVar13;
    if (local_30 < pbVar9) {
      bVar12 = *local_30;
      while (bVar12 == 0x30) {
        if (0 < iVar4) {
          puVar8 = (undefined4 *)malloc(0x10);
          ppvVar19[3] = puVar8;
          if (puVar8 == (undefined4 *)0x0) {
            return 0xffffffe1;
          }
          puVar8[3] = 0;
          *puVar8 = 0;
          puVar8[1] = 0;
          puVar8[2] = 0;
          ppvVar19 = (void **)ppvVar19[3];
        }
        iVar18 = getAsnSequence(&local_30,(int)pbVar20 - (int)local_30 & 0xffff,local_40);
        if (iVar18 < 0) {
          return 0xffffffe1;
        }
        bVar12 = *local_30;
        local_30 = local_30 + 1;
        if (bVar12 != 6) {
          return 0xffffffe1;
        }
        iVar18 = getAsnLength(&local_30,(int)pbVar9 - (int)local_30 & 0xffff,local_40);
        if (iVar18 < 0) {
          return 0xffffffe1;
        }
        if ((uint)((int)pbVar9 - (int)local_30) < (uint)local_40[0]) {
          return 0xffffffe1;
        }
        memset(local_80,0,0x40);
        uVar5 = asnParseOid(local_30,local_40[0],local_80);
        uVar5 = uVar5 & 0xffff;
        if (uVar5 == 0) {
          return 0xffffffe1;
        }
        local_30 = local_30 + local_40[0];
        pvVar6 = malloc(uVar5 << 2);
        *ppvVar19 = pvVar6;
        memset(pvVar6,0,uVar5 << 2);
        iVar18 = 0;
        if (uVar5 != 0) {
          pvVar6 = *ppvVar19;
          do {
            iVar21 = iVar18 * 4;
            puVar8 = local_80 + iVar18;
            iVar18 = iVar18 + 1;
            *(undefined4 *)(iVar21 + (int)pvVar6) = *puVar8;
          } while (iVar18 < (int)uVar5);
        }
        *(short *)(ppvVar19 + 2) = (short)uVar5;
        bVar12 = *local_30;
        local_30 = local_30 + 1;
        if (bVar12 != 6) {
          return 0xffffffe1;
        }
        iVar18 = getAsnLength(&local_30,(int)pbVar9 - (int)local_30 & 0xffff,local_40);
        if (iVar18 < 0) {
          return 0xffffffe1;
        }
        if ((uint)((int)pbVar9 - (int)local_30) < (uint)local_40[0]) {
          return 0xffffffe1;
        }
        memset(local_80,0,0x40);
        uVar5 = asnParseOid(local_30,local_40[0],local_80);
        uVar5 = uVar5 & 0xffff;
        if (uVar5 == 0) {
          return 0xffffffe1;
        }
        local_30 = local_30 + local_40[0];
        pvVar6 = malloc(uVar5 << 2);
        ppvVar19[1] = pvVar6;
        memset(pvVar6,0,uVar5 << 2);
        iVar18 = 0;
        if (uVar5 != 0) {
          pvVar6 = ppvVar19[1];
          do {
            iVar21 = iVar18 * 4;
            puVar8 = local_80 + iVar18;
            iVar18 = iVar18 + 1;
            *(undefined4 *)(iVar21 + (int)pvVar6) = *puVar8;
          } while (iVar18 < (int)uVar5);
        }
        *(short *)((int)ppvVar19 + 10) = (short)uVar5;
        iVar4 = iVar4 + 1;
        if (pbVar9 <= local_30) break;
        bVar12 = *local_30;
      }
    }
    if (local_30 != pbVar9) {
      return 0xffffffe1;
    }
    break;
  case 6:
    iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    iVar4 = FUN_00469000(param_1,&local_3c,local_118,pbVar20,param_5 + 3,0xffffffff);
    goto joined_r0x0046b890;
  case 7:
    iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    iVar4 = FUN_00469000(param_1,&local_3c,local_118,pbVar20,param_5 + 4,0xffffffff);
    goto joined_r0x0046b890;
  case 9:
    iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    if (local_118 == 0) {
      param_5[1] = 0;
    }
    else {
      if (*local_3c == 1) {
        if ((int)pbVar20 - (int)local_3c < 3) {
          return 0xffffffe1;
        }
        if (local_3c[1] != 1) {
          return 0xffffffe1;
        }
        if (local_3c[2] == 0) {
          local_3c = local_3c + 3;
          param_5[1] = 0;
        }
        else {
          local_3c = local_3c + 3;
          param_5[1] = 0xff;
        }
      }
      else {
        param_5[1] = 0;
      }
      if (*local_3c == 2) {
        iVar4 = getAsnInteger(&local_3c,(int)pbVar20 - (int)local_3c,param_5 + 2);
joined_r0x0046b890:
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
      }
      else {
        param_5[2] = 0xffffffff;
      }
    }
    goto LAB_0046aa08;
  case 10:
    if (bVar1) {
      return 0xffffffe1;
    }
    iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,local_116);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    if (local_116[0] != 0) {
      do {
        pbVar13 = local_3c;
        if (*local_3c == 0xa0) {
          local_3c = local_3c + 1;
          local_2c = 0;
        }
        if (*local_3c == 0xa1) {
          local_3c = local_3c + 1;
          local_2c = 1;
        }
        local_d0 = 0;
        iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_d0);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        uVar5 = (uint)local_d0;
        if (uVar5 == 0) {
          return 0xffffffe1;
        }
        if ((uint)((int)pbVar20 - (int)local_3c) < uVar5) {
          return 0xffffffe1;
        }
        if ((int)(uint)local_116[0] < (int)(uVar5 + ((int)local_3c - (int)pbVar13))) {
          return 0xffffffe1;
        }
        local_116[0] = local_116[0] - ((short)((int)local_3c - (int)pbVar13) + local_d0);
        if (local_2c == 0) {
          do {
            pbVar13 = local_3c;
            iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
            if (iVar4 < 0) {
              return 0xffffffe1;
            }
            if ((int)(uint)local_d0 < (int)((uint)local_118 + ((int)local_3c - (int)pbVar13))) {
              return 0xffffffe1;
            }
            local_d0 = local_d0 - ((short)((int)local_3c - (int)pbVar13) + local_118);
            iVar4 = FUN_00469000(param_1,&local_3c,(uint)local_118,pbVar20,param_5 + 0x2e,0xffffffff
                                );
            if (iVar4 < 0) {
              return 0xffffffe1;
            }
          } while (local_d0 != 0);
        }
        else {
          do {
            pbVar13 = local_3c;
            iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
            if (iVar4 < 0) {
              return 0xffffffe1;
            }
            if ((int)(uint)local_d0 < (int)((uint)local_118 + ((int)local_3c - (int)pbVar13))) {
              return 0xffffffe1;
            }
            local_d0 = local_d0 - ((short)((int)local_3c - (int)pbVar13) + local_118);
            iVar4 = FUN_00469000(param_1,&local_3c,(uint)local_118,pbVar20,param_5 + 0x2f,0xffffffff
                                );
            if (iVar4 < 0) {
              return 0xffffffe1;
            }
          } while (local_d0 != 0);
        }
      } while (local_116[0] != 0);
    }
    goto LAB_0046aa08;
  case 0xb:
    local_34 = local_3c;
    iVar18 = getAsnSequence(&local_34,(int)pbVar20 - (int)local_3c & 0xffff,local_88);
    iVar4 = 0;
    if (iVar18 < 0) {
      return 0xffffffe1;
    }
    pbVar13 = local_34 + local_88[0];
    local_118 = (short)pbVar13 - (short)pbVar9;
    if (local_88[0] != 0) {
      bVar12 = *local_34;
      while ((byte)(bVar12 + 0x80) < 2) {
        local_34 = local_34 + 1;
        iVar18 = getAsnLength(&local_34,(int)pbVar13 - (int)local_34 & 0xffff,local_88);
        if (iVar18 < 0) {
          return 0xffffffe1;
        }
        if ((uint)((int)pbVar13 - (int)local_34) < (uint)local_88[0]) {
          return 0xffffffe1;
        }
        if (local_88[0] != 1) {
          return 0xffffffe1;
        }
        if (bVar12 == 0x80) {
          param_5[0x31] = (uint)*local_34;
        }
        else {
          param_5[0x32] = (uint)*local_34;
        }
        iVar4 = iVar4 + 1;
        local_34 = local_34 + 1;
        if (1 < iVar4) break;
        bVar12 = *local_34;
      }
      if (local_34 != pbVar13) {
        return 0xffffffe1;
      }
    }
    break;
  case 0xc:
    iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,local_116);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    while (pbVar13 = local_3c, local_116[0] != 0) {
      if (*local_3c != 6) {
        return 0xffffffe1;
      }
      local_3c = local_3c + 1;
      iVar4 = getAsnLength(&local_3c,local_116[0],&local_118);
      if (iVar4 < 0) {
        return 0xffffffe1;
      }
      if (local_116[0] < local_118) {
        return 0xffffffe1;
      }
      uVar5 = asnParseOid(local_3c,local_118,local_110);
      if (uVar5 == 0) {
        return 0xffffffe1;
      }
      if (0x10 < uVar5) {
        _psTraceStr("psAssert %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0xa6e);
        _psError("oidlen <= MAX_OID_LEN");
      }
      iVar4 = 0;
      piVar17 = &DAT_004910c4;
      iVar18 = 0;
      do {
        uVar16 = 0;
        if (0 < (int)uVar5) {
          psVar15 = &DAT_004910a4 + iVar4 * 0x12;
          psVar10 = local_110;
          do {
            uVar16 = uVar16 + 1;
            if (*psVar15 != *psVar10) break;
            if (uVar16 == uVar5) {
              uVar14 = (&DAT_004910c4)[iVar18];
              goto LAB_0046b050;
            }
            psVar10 = psVar10 + 2;
            psVar15 = psVar15 + 1;
          } while ((int)uVar16 < (int)uVar5);
        }
        piVar17 = piVar17 + 9;
        iVar4 = iVar4 + 1;
        iVar18 = iVar18 + 9;
      } while (*piVar17 != 0);
      uVar14 = 0;
LAB_0046b050:
      local_3c = local_3c + local_118;
      if ((uint)local_116[0] < (uint)((int)local_3c - (int)pbVar13)) {
        return 0xffffffe1;
      }
      local_116[0] = local_116[0] - (short)((int)local_3c - (int)pbVar13);
      switch(uVar14) {
      case 0x15:
        param_5[7] = param_5[7] | 1;
        break;
      case 0x16:
        param_5[7] = param_5[7] | 2;
        break;
      case 0x17:
        param_5[7] = param_5[7] | 4;
        break;
      case 0x18:
        param_5[7] = param_5[7] | 8;
        break;
      case 0x19:
        param_5[7] = param_5[7] | 0x10;
        break;
      case 0x1a:
        param_5[7] = param_5[7] | 0x100;
        break;
      case 0x1b:
        param_5[7] = param_5[7] | 0x200;
      }
    }
    goto LAB_0046aa08;
  case 0xd:
    iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,local_116);
    pbVar13 = local_3c;
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    while (local_3c = pbVar13, local_116[0] != 0) {
      iVar4 = getAsnSequence(&local_3c,(int)pbVar20 - (int)pbVar13 & 0xffff,&local_118);
      if (iVar4 < 0) {
        return 0xffffffe1;
      }
      if ((int)(uint)local_116[0] < (int)((uint)local_118 + ((int)local_3c - (int)pbVar13))) {
        return 0xffffffe1;
      }
      local_116[0] = local_116[0] - ((short)((int)local_3c - (int)pbVar13) + local_118);
      bVar12 = *local_3c;
      if (bVar12 == 0xa0) {
        local_3c = local_3c + 1;
        iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        if (local_118 == 0) {
          return 0xffffffe1;
        }
        if ((uint)((int)pbVar20 - (int)local_3c) < (uint)local_118) {
          return 0xffffffe1;
        }
        bVar12 = *local_3c;
        if ((bVar12 & 0xf) == 0) {
          local_3c = local_3c + 1;
          iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
          if (iVar4 < 0) {
            return 0xffffffe1;
          }
          uVar5 = (uint)local_118;
          if (uVar5 == 0) {
            return 0xffffffe1;
          }
          if ((uint)((int)pbVar20 - (int)local_3c) < uVar5) {
            return 0xffffffe1;
          }
          iVar4 = FUN_00469000(param_1,&local_3c,uVar5,pbVar20,param_5 + 0x36,0xffffffff);
          if (0 < iVar4) {
            return 0xffffffe1;
          }
        }
        else {
          local_3c = local_3c + 1;
          if ((bVar12 & 0xf) != 1) {
            return 0xffffffe1;
          }
          iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,&local_118);
          if (iVar4 < 0) {
            return 0xffffffe1;
          }
          uVar5 = (uint)local_118;
          if (uVar5 == 0) {
            return 0xffffffe1;
          }
          uVar16 = (int)pbVar20 - (int)local_3c;
          local_3c = local_3c + uVar5;
          if (uVar16 < uVar5) {
            return 0xffffffe1;
          }
        }
        bVar12 = *local_3c;
      }
      pbVar13 = local_3c + 1;
      if (bVar12 == 0xa1) {
        local_3c = pbVar13;
        iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)pbVar13 & 0xffff,&local_118);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        uVar5 = (uint)local_118;
        if (uVar5 == 0) {
          return 0xffffffe1;
        }
        uVar16 = (int)pbVar20 - (int)local_3c;
        local_3c = local_3c + uVar5;
        if (uVar16 < uVar5) {
          return 0xffffffe1;
        }
      }
      pbVar9 = local_3c + 1;
      pbVar13 = local_3c;
      if (*local_3c == 0xa2) {
        local_3c = pbVar9;
        iVar4 = getAsnLength(&local_3c,(int)pbVar20 - (int)pbVar9 & 0xffff,&local_118);
        if (iVar4 < 0) {
          return 0xffffffe1;
        }
        uVar5 = (uint)local_118;
        if (uVar5 == 0) {
          return 0xffffffe1;
        }
        pbVar13 = local_3c + uVar5;
        if ((uint)((int)pbVar20 - (int)local_3c) < uVar5) {
          return 0xffffffe1;
        }
      }
    }
    goto LAB_0046aa08;
  case 0xe:
    iVar4 = getSerialNum(param_1,&local_3c,(int)pbVar20 - (int)local_3c & 0xffff,param_5 + 0x37,
                         &local_118);
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    param_5[0x38] = (uint)local_118;
    goto LAB_0046aa08;
  case 0x12:
    local_38 = local_3c;
    memset(local_c8,0,0x40);
    pbVar13 = local_38;
    iVar4 = getAsnSequence(&local_38,(int)pbVar20 - (int)local_38 & 0xffff,&local_ce);
    bVar1 = false;
    if (iVar4 < 0) {
      return 0xffffffe1;
    }
    pbVar9 = local_38 + local_ce;
    local_118 = (short)pbVar9 - (short)pbVar13;
    if (param_5[0x34] == 0) {
      puVar8 = (undefined4 *)malloc(0x10);
      param_5[0x34] = puVar8;
      if (puVar8 == (undefined4 *)0x0) {
        return 0xffffffe1;
      }
      bVar1 = true;
      puVar8[3] = 0;
      *puVar8 = 0;
      puVar8[1] = 0;
      puVar8[2] = 0;
    }
    ppvVar19 = (void **)param_5[0x34];
    bVar2 = local_38 < pbVar9;
    while ((bVar2 && (ppvVar3 = ppvVar19, *local_38 == 0x30))) {
      do {
        ppvVar19 = ppvVar3;
        ppvVar3 = (void **)ppvVar19[3];
      } while ((void **)ppvVar19[3] != (void **)0x0);
      if (bVar1) {
        bVar1 = false;
      }
      else {
        puVar8 = (undefined4 *)malloc(0x10);
        ppvVar19[3] = puVar8;
        if (puVar8 == (undefined4 *)0x0) {
          return 0xffffffe1;
        }
        puVar8[3] = 0;
        *puVar8 = 0;
        puVar8[1] = 0;
        puVar8[2] = 0;
        ppvVar19 = (void **)ppvVar19[3];
      }
      iVar4 = getAsnSequence(&local_38,(int)pbVar20 - (int)local_38 & 0xffff,auStack_cc);
      if (iVar4 < 0) {
        return 0xffffffe1;
      }
      bVar12 = *local_38;
      local_38 = local_38 + 1;
      if (bVar12 != 6) {
        return 0xffffffe1;
      }
      iVar4 = getAsnLength(&local_38,(int)pbVar9 - (int)local_38 & 0xffff,&local_ce);
      if (iVar4 < 0) {
        return 0xffffffe1;
      }
      if ((uint)((int)pbVar9 - (int)local_38) < (uint)local_ce) {
        return 0xffffffe1;
      }
      memset(local_c8,0,0x40);
      uVar5 = asnParseOid(local_38,local_ce,local_c8);
      uVar16 = uVar5 & 0xff;
      if ((uVar5 & 0xffff) == 0) {
        return 0xffffffe1;
      }
      if (0x10 < uVar16) {
        _psTraceStr("psAssert %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0xa6e);
        _psError("oidlen <= MAX_OID_LEN");
      }
      iVar4 = 0;
      piVar17 = &DAT_004910c4;
      iVar18 = 0;
      do {
        uVar5 = 0;
        if (uVar16 != 0) {
          psVar15 = &DAT_004910a4 + iVar4 * 0x12;
          psVar10 = local_c8;
          do {
            uVar5 = uVar5 + 1;
            if (*psVar15 != *psVar10) break;
            if (uVar5 == uVar16) {
              iVar4 = (&DAT_004910c4)[iVar18];
              goto LAB_0046b2a8;
            }
            psVar10 = psVar10 + 2;
            psVar15 = psVar15 + 1;
          } while ((int)uVar5 < (int)uVar16);
        }
        piVar17 = piVar17 + 9;
        iVar4 = iVar4 + 1;
        iVar18 = iVar18 + 9;
      } while (*piVar17 != 0);
      iVar4 = 0;
LAB_0046b2a8:
      pbVar13 = local_38 + local_ce;
      if (1 < iVar4 - 0x1eU) {
        return 0xffffffe1;
      }
      local_38 = pbVar13 + 1;
      if (*pbVar13 != 0x86) {
        return 0xffffffe1;
      }
      iVar18 = getAsnLength(&local_38,(int)pbVar9 - (int)local_38 & 0xffff,&local_ce);
      if (iVar18 < 0) {
        return 0xffffffe1;
      }
      uVar5 = (uint)local_ce;
      if ((uint)((int)pbVar9 - (int)local_38) < uVar5) {
        return 0xffffffe1;
      }
      if (iVar4 == 0x1f) {
        pvVar6 = malloc(uVar5);
        *ppvVar19 = pvVar6;
        if (pvVar6 == (void *)0x0) {
          return 0xffffffe1;
        }
        memcpy(pvVar6,local_38,(uint)local_ce);
        local_38 = local_38 + local_ce;
        bVar2 = local_38 < pbVar9;
        *(ushort *)(ppvVar19 + 2) = local_ce;
      }
      else {
        pvVar6 = malloc(uVar5);
        ppvVar19[1] = pvVar6;
        if (pvVar6 == (void *)0x0) {
          return 0xffffffe1;
        }
        memcpy(pvVar6,local_38,(uint)local_ce);
        local_38 = local_38 + local_ce;
        bVar2 = local_38 < pbVar9;
        *(ushort *)((int)ppvVar19 + 10) = local_ce;
      }
    }
  }
  local_3c = local_3c + local_118;
  goto LAB_0046aa08;
}



int psX509ParseCert(undefined4 param_1,byte *param_2,int param_3,void **param_4,uint param_5)

{
  byte bVar1;
  bool bVar2;
  short sVar3;
  byte *__src;
  byte *pbVar4;
  byte *pbVar5;
  undefined4 *puVar6;
  ushort uVar7;
  undefined4 *__s;
  int iVar8;
  void *pvVar9;
  undefined4 *puVar10;
  undefined4 uVar11;
  size_t sVar12;
  int iVar13;
  byte *pbVar14;
  uint uVar15;
  undefined4 uVar16;
  byte *pbVar17;
  undefined4 *puVar18;
  undefined4 *puVar19;
  char *pcVar20;
  byte *pbVar21;
  byte *pbVar22;
  code *pcVar23;
  undefined4 uVar24;
  undefined4 local_230;
  undefined4 local_22c;
  undefined4 local_228;
  undefined4 local_224;
  undefined4 local_220;
  undefined auStack_218 [208];
  ushort local_148;
  ushort local_146;
  ushort local_144;
  ushort local_142;
  ushort local_140 [4];
  undefined4 local_138 [8];
  undefined4 auStack_118 [4];
  undefined4 local_108 [12];
  undefined auStack_d8 [48];
  undefined4 local_a8 [8];
  undefined4 auStack_88 [4];
  undefined4 local_78 [12];
  byte *local_48;
  byte *local_44;
  uint local_40;
  byte *local_3c;
  byte *local_38;
  int local_34;
  uint local_30;
  byte *local_2c;
  
  __s = (undefined4 *)malloc(800);
  *param_4 = __s;
  local_34 = 0;
  if (__s == (undefined4 *)0x0) {
    _psTraceStr("psError %s","keyformat/x509.c");
    _psTraceInt(&DAT_0049016c,0x554);
    _psError("Memory allocation failure in psX509ParseCert\n");
    return -8;
  }
  memset(__s,0,800);
  pbVar22 = param_2 + param_3;
  __s[1] = 1;
  __s[0x74] = 0x7f;
  *__s = param_1;
  local_48 = param_2;
  local_44 = param_2;
  iVar8 = getAsnSequence32(&local_44,(int)pbVar22 - (int)param_2,&local_40,0);
  pbVar21 = param_2 + param_3;
  __src = param_2;
  do {
    if (iVar8 < 0) goto LAB_0046c7a4;
    if (local_40 < 0x10000) {
      pbVar21 = local_44 + local_40;
      if ((param_5 & 1) != 0) {
        *(short *)(__s + 0xc5) = (short)(local_44 + (local_40 - (int)__src));
        pvVar9 = malloc((uint)(local_44 + (local_40 - (int)__src)) & 0xffff);
        __s[0xc4] = pvVar9;
        if (pvVar9 == (void *)0x0) {
          _psTraceStr("psError %s","keyformat/x509.c");
          _psTraceInt(&DAT_0049016c,0x2cd);
          iVar8 = -8;
          _psError("Memory allocation error in psX509ParseCert\n");
          bVar2 = pbVar21 < local_44;
          goto LAB_0046c814;
        }
        memcpy(pvVar9,__src,(size_t)*(undefined2 *)(__s + 0xc5));
      }
      pbVar4 = local_44;
      iVar8 = getAsnSequence(&local_44,(int)pbVar21 - (int)local_44 & 0xffff,&local_148);
      if (iVar8 < 0) {
LAB_0046c7a4:
        bVar2 = pbVar21 < local_44;
        iVar13 = iVar8;
        if (iVar8 == 0) {
LAB_0046c7ac:
          iVar8 = iVar13;
          __s[1] = 0;
          if (local_44 != pbVar21) {
            _psTraceStr("psAssert %s","keyformat/x509.c");
            _psTraceInt(&DAT_0049016c,0x52a);
            _psError("p == end");
          }
LAB_0046c810:
          bVar2 = pbVar21 < local_44;
        }
        goto LAB_0046c814;
      }
      local_2c = local_44 + local_148;
      local_30 = (int)local_2c - (int)pbVar4 & 0xffff;
      uVar15 = (int)pbVar21 - (int)local_44 & 0xffff;
      local_3c = local_44;
      if (uVar15 == 0) {
LAB_0046c7a0:
        iVar8 = -0x1f;
        goto LAB_0046c7a4;
      }
      if (*local_44 == 0xa0) {
        uVar15 = uVar15 - 1;
        local_3c = local_44 + 1;
        iVar8 = getAsnLength(&local_3c,uVar15 & 0xffff,&local_144);
        if (((iVar8 < 0) || ((int)uVar15 < (int)(uint)local_144)) ||
           (iVar8 = getAsnInteger(&local_3c,(uint)local_144,__s + 0x26), iVar8 < 0))
        goto LAB_0046c7a0;
      }
      else {
        __s[0x26] = 0;
      }
      iVar8 = __s[0x26];
      local_44 = local_3c;
      if (((iVar8 < 0) || (iVar8 < 2)) || (iVar8 != 2)) {
        iVar8 = -10;
        __s[1] = 3;
        goto LAB_0046c6c4;
      }
      iVar8 = getSerialNum(param_1,&local_44,(int)pbVar21 - (int)local_3c & 0xffff,__s + 0x27,
                           __s + 0x28);
      if (iVar8 < 0) goto LAB_0046c7a4;
      iVar8 = getAsnAlgorithmIdentifier(&local_44,(int)pbVar21 - (int)local_44,__s + 3,&local_146);
      if (iVar8 < 0) {
        __s[1] = 0xb;
        goto LAB_0046c7a4;
      }
      if (local_146 != 0) {
        if (__s[3] == 0x68e) {
          iVar8 = getAsnSequence(&local_44,(int)pbVar21 - (int)local_44 & 0xffff,&local_148);
          if (-1 < iVar8) {
            __s[7] = 0xa8c;
            *(undefined2 *)(__s + 9) = 0x14;
            __s[6] = 0;
            if ((local_148 == 0) || (iVar8 = FUN_00467cc4(&local_44,local_148,__s,0), -1 < iVar8))
            goto LAB_0046cba4;
          }
          goto LAB_0046c7a4;
        }
LAB_0046c988:
        iVar8 = -10;
        goto LAB_0046c810;
      }
LAB_0046cba4:
      iVar8 = psX509GetDNAttributes
                        (param_1,&local_44,(int)pbVar21 - (int)local_44 & 0xffff,__s + 0x29,param_5)
      ;
      pbVar5 = local_44;
      if (iVar8 < 0) {
        __s[1] = 0xc;
        goto LAB_0046c7a4;
      }
      uVar15 = (int)pbVar21 - (int)local_44 & 0xffff;
      local_38 = local_44;
      pbVar17 = local_38;
      if (((uVar15 == 0) || (local_38 = local_44 + 1, pbVar17 = local_38, *local_44 != 0x30)) ||
         (iVar8 = getAsnLength(&local_38,uVar15 - 1 & 0xffff,&local_142), pbVar17 = local_38,
         iVar8 < 0)) {
LAB_0046cea4:
        local_38 = pbVar17;
        iVar8 = -0x1f;
        goto LAB_0046c7a4;
      }
      if (((pbVar5 + (uVar15 - (int)local_38) < (byte *)(uint)local_142) ||
          ((int)(pbVar5 + (uVar15 - (int)local_38)) < 1)) ||
         (bVar1 = *local_38, 1 < (bVar1 - 0x17 & 0xff))) goto LAB_0046cea4;
      local_38 = local_38 + 1;
      __s[0x6b] = (uint)bVar1;
      iVar8 = getAsnLength(&local_38,(byte *)(uint)local_142,local_140);
      pbVar17 = local_38;
      if (((iVar8 < 0) ||
          (pbVar14 = (byte *)(uint)local_140[0], pbVar5 + (uVar15 - (int)local_38) < pbVar14)) ||
         ((byte *)0x20 < pbVar14)) goto LAB_0046cea4;
      pvVar9 = malloc((size_t)(pbVar14 + 1));
      __s[0x6d] = pvVar9;
      if (pvVar9 == (void *)0x0) {
        _psTraceStr("psError %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x1197);
        pcVar20 = "Memory allocation error in getTimeValidity for notBefore\n";
LAB_0046cf7c:
        _psError(pcVar20);
        iVar8 = -8;
        goto LAB_0046c7a4;
      }
      memcpy(pvVar9,local_38,(size_t)local_140[0]);
      *(undefined *)(__s[0x6d] + (uint)local_140[0]) = 0;
      pbVar17 = local_38 + local_140[0];
      if ((int)(pbVar5 + (uVar15 - (int)pbVar17)) < 1) goto LAB_0046cea4;
      local_38 = pbVar17 + 1;
      if (1 < (*pbVar17 - 0x17 & 0xff)) goto LAB_0046cea4;
      __s[0x6c] = (uint)*pbVar17;
      iVar8 = getAsnLength(&local_38,(uint)local_142 - (uint)local_140[0] & 0xffff,local_140);
      pbVar17 = local_38;
      if (((iVar8 < 0) ||
          (pbVar14 = (byte *)(uint)local_140[0], pbVar5 + (uVar15 - (int)local_38) < pbVar14)) ||
         ((byte *)0x20 < pbVar14)) goto LAB_0046cea4;
      pvVar9 = malloc((size_t)(pbVar14 + 1));
      __s[0x6e] = pvVar9;
      if (pvVar9 == (void *)0x0) {
        _psTraceStr("psError %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x11b1);
        pcVar20 = "Memory allocation error in getTimeValidity for notAfter\n";
        goto LAB_0046cf7c;
      }
      memcpy(pvVar9,local_38,(size_t)local_140[0]);
      *(undefined *)((int)__s[0x6e] + (uint)local_140[0]) = 0;
      local_44 = local_38 + local_140[0];
      local_38 = local_44;
      if (((__s[0x6d] == 0) || (__s[0x6e] == 0)) ||
         (iVar8 = psGetBrokenDownGMTime(local_138,0), iVar8 != 0)) {
LAB_0046ce00:
        iVar8 = -1;
        uVar11 = 8;
LAB_0046ce0c:
        __s[1] = uVar11;
        goto LAB_0046c7a4;
      }
      puVar10 = local_138;
      puVar6 = local_108;
      do {
        puVar19 = puVar6;
        puVar18 = puVar10;
        uVar16 = puVar18[1];
        uVar11 = puVar18[2];
        uVar24 = puVar18[3];
        puVar10 = puVar18 + 4;
        *puVar19 = *puVar18;
        puVar19[1] = uVar16;
        puVar19[2] = uVar11;
        puVar19[3] = uVar24;
        puVar6 = puVar19 + 4;
      } while (puVar10 != auStack_118);
      uVar16 = puVar18[6];
      uVar11 = puVar18[5];
      puVar19[4] = *puVar10;
      puVar19[6] = uVar16;
      puVar19[5] = uVar11;
      iVar8 = psBrokenDownTimeAdd(local_108,0x15180);
      if (iVar8 != 0) goto LAB_0046ce00;
      pcVar20 = (char *)__s[0x6d];
      sVar12 = strlen(pcVar20);
      iVar8 = psBrokenDownTimeImport(auStack_d8,pcVar20,sVar12,(uint)(__s[0x6b] == 0x17) << 1);
      if (iVar8 != 0) goto LAB_0046ce00;
      pcVar20 = (char *)__s[0x6e];
      sVar12 = strlen(pcVar20);
      iVar8 = psBrokenDownTimeImport(local_a8,pcVar20,sVar12,(uint)(__s[0x6c] == 0x17) << 1);
      if (iVar8 != 0) goto LAB_0046ce00;
      puVar10 = local_a8;
      puVar6 = local_78;
      do {
        puVar19 = puVar6;
        puVar18 = puVar10;
        uVar24 = puVar18[1];
        uVar16 = puVar18[2];
        uVar11 = puVar18[3];
        puVar10 = puVar18 + 4;
        *puVar19 = *puVar18;
        puVar19[1] = uVar24;
        puVar19[2] = uVar16;
        puVar19[3] = uVar11;
        puVar6 = puVar19 + 4;
      } while (puVar10 != auStack_88);
      uVar16 = puVar18[5];
      uVar11 = puVar18[6];
      puVar19[4] = *puVar10;
      puVar19[5] = uVar16;
      puVar19[6] = uVar11;
      iVar8 = psBrokenDownTimeAdd(local_78,0x15180);
      if (iVar8 != 0) goto LAB_0046ce00;
      iVar8 = psBrokenDownTimeCmp(auStack_d8,local_108);
      if ((0 < iVar8) || (iVar8 = psBrokenDownTimeCmp(local_138,local_78), 0 < iVar8)) {
        __s[0xad] = __s[0xad] | 8;
      }
      *(short *)((int)__s + 0x31a) = (short)local_44 - (short)__src;
      iVar8 = psX509GetDNAttributes
                        (param_1,&local_44,(int)pbVar21 - (int)local_44 & 0xffff,__s + 0x4a,param_5)
      ;
      if (iVar8 < 0) {
        uVar11 = 0xe;
        goto LAB_0046ce0c;
      }
      sVar3 = (short)local_44;
      *(short *)((int)__s + 0x316) = sVar3 - (short)__src;
      iVar8 = getAsnSequence(&local_44,(int)pbVar21 - (int)local_44 & 0xffff,&local_148);
      if (iVar8 < 0) goto LAB_0046c7a4;
      *(ushort *)(__s + 0xc6) = ((short)local_44 - sVar3) + local_148;
      iVar8 = getAsnAlgorithmIdentifier
                        (&local_44,(int)pbVar21 - (int)local_44,__s + 0x6f,&local_146);
      if (iVar8 < 0) goto LAB_0046c7a4;
      if (__s[0x6f] == 0x206) {
        if (local_146 != 0) {
          if ((int)pbVar21 - (int)local_44 < (int)(uint)local_146) {
            iVar8 = -0x1f;
            goto LAB_0046c810;
          }
          puVar10 = __s + 10;
          psInitPubKey(param_1,puVar10,3);
          iVar8 = getEcPubKey(param_1,&local_44,(int)pbVar21 - (int)local_44 & 0xffff,puVar10,
                              &local_230);
          if (-1 < iVar8) {
            uVar7 = psEccSize(puVar10);
            *(ushort *)(__s + 0x25) = uVar7;
            if (uVar7 < 0x18) {
              psClearPubKey(puVar10);
              iVar8 = -0x1f;
              goto LAB_0046d464;
            }
            goto LAB_0046d338;
          }
          if (iVar8 == -10) {
            __s[1] = 4;
          }
        }
        iVar8 = -0x1f;
        goto LAB_0046c810;
      }
      if (__s[0x6f] != 0x285) {
        iVar8 = -10;
        __s[1] = 6;
        goto LAB_0046c6c4;
      }
      if (local_146 != 0) {
        _psTraceStr("psAssert %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x3e3);
        _psError("plen == 0");
      }
      puVar10 = __s + 10;
      psInitPubKey(param_1,puVar10,1);
      iVar8 = psRsaParseAsnPubKey(param_1,&local_44,(int)pbVar21 - (int)local_44 & 0xffff,puVar10,
                                  &local_230);
      if (iVar8 < 0) {
        uVar11 = 10;
        goto LAB_0046ce0c;
      }
      uVar15 = psRsaSize(puVar10);
      *(short *)(__s + 0x25) = (short)uVar15;
      if (uVar15 < 0x80) {
        psClearPubKey(puVar10);
        iVar8 = -10;
LAB_0046d464:
        __s[1] = 2;
        goto LAB_0046c6c4;
      }
LAB_0046d338:
      __s[0xc0] = local_22c;
      __s[0xbf] = local_230;
      __s[0xc1] = local_228;
      __s[0xc2] = local_224;
      __s[0xc3] = local_220;
      if (*local_44 == 0x30) {
LAB_0046d42c:
        if (local_2c != local_44) {
          iVar8 = -9;
          __s[1] = 0xf;
          goto LAB_0046c6c4;
        }
        if (((((__s[0x50] == 0) && (__s[0x4a] == 0)) && (__s[0x4f] == 0)) &&
            ((__s[0x4b] == 0 && (__s[0x4c] == 0)))) && ((__s[0x51] == 0 && (__s[0x76] == 0)))) {
          iVar8 = -0x1f;
          __s[1] = 9;
          goto LAB_0046c6c4;
        }
        iVar8 = getAsnAlgorithmIdentifier(&local_44,(int)pbVar21 - (int)local_44,__s + 2,&local_146)
        ;
        if (iVar8 < 0) goto LAB_0046c7a4;
        if (local_146 != 0) {
          if (__s[2] != 0x68e) goto LAB_0046c988;
          iVar8 = getAsnSequence(&local_44,(int)pbVar21 - (int)local_44 & 0xffff,&local_148);
          if ((iVar8 < 0) ||
             ((local_148 != 0 && (iVar8 = FUN_00467cc4(&local_44,local_148,__s,1), iVar8 < 0))))
          goto LAB_0046c7a4;
        }
        iVar8 = __s[3];
        if (iVar8 != __s[2]) {
          iVar8 = -0x1f;
          __s[1] = 0x10;
          goto LAB_0046c6c4;
        }
        if (iVar8 == 0x68e) {
          iVar8 = __s[6];
          if (iVar8 == 3) goto LAB_0046d840;
          if (3 < iVar8) {
            iVar13 = 4;
            goto LAB_0046d7fc;
          }
          iVar13 = 2;
LAB_0046d678:
          if (iVar8 == iVar13) {
LAB_0046d748:
            psSha256Init(auStack_218);
            psSha256Update(auStack_218,pbVar4,local_30);
            pcVar23 = psSha256Final;
            goto LAB_0046d77c;
          }
LAB_0046d680:
          iVar8 = -10;
          __s[1] = 5;
          goto LAB_0046c6c4;
        }
        if (iVar8 < 0x68f) {
          if (iVar8 != 0x20d) {
            iVar13 = 0x20e;
            if (iVar8 < 0x20e) {
              iVar13 = 0x20c;
              goto LAB_0046d678;
            }
            goto LAB_0046d7fc;
          }
LAB_0046d840:
          psSha384Init(auStack_218);
          psSha384Update(auStack_218,pbVar4,local_30);
          pcVar23 = psSha384Final;
        }
        else {
          if (iVar8 == 0x690) goto LAB_0046d840;
          iVar13 = 0x691;
          if (iVar8 < 0x690) goto LAB_0046d748;
LAB_0046d7fc:
          if (iVar8 != iVar13) goto LAB_0046d680;
          psSha512Init(auStack_218);
          psSha512Update(auStack_218,pbVar4,local_30);
          pcVar23 = psSha512Final;
        }
LAB_0046d77c:
        (*pcVar23)(auStack_218,__s + 0xaf);
        iVar8 = memcmp(__s + 0xaf,&DAT_00491bbc,6);
        if (iVar8 == 0) goto LAB_0046d680;
        iVar8 = psX509GetSignature(param_1,&local_44,(int)pbVar21 - (int)local_44 & 0xffff,__s + 4,
                                   __s + 5);
        iVar13 = 0;
        if (iVar8 < 0) {
          uVar11 = 0xd;
          goto LAB_0046ce0c;
        }
        goto LAB_0046c7ac;
      }
      iVar8 = FUN_0046821c(param_1,&local_44,(int)pbVar21 - (int)local_44 & 0xffff,1,__s + 0x70,
                           __s + 0x72);
      if (-1 < iVar8) {
        iVar8 = FUN_0046821c(param_1,&local_44,(int)pbVar21 - (int)local_44 & 0xffff,2,__s + 0x71,
                             (int)__s + 0x1ca);
        if ((-1 < iVar8) &&
           (iVar8 = getExplicitExtensions
                              (param_1,&local_44,(int)pbVar21 - (int)local_44 & 0xffff,3,__s + 0x73,
                               0), -1 < iVar8)) goto LAB_0046d42c;
      }
      iVar8 = -0x1f;
      __s[1] = 7;
LAB_0046c6c4:
      if (pbVar21 < local_44) goto LAB_0046c6d0;
LAB_0046c81c:
      local_48 = pbVar21;
      if (iVar8 != 0) goto LAB_0046c72c;
LAB_0046c824:
      local_34 = local_34 + 1;
    }
    else {
      _psTraceStr("psAssert %s","keyformat/x509.c");
      _psTraceInt(&DAT_0049016c,0x2bd);
      iVar8 = -1;
      _psError("oneCertLen <= 0xFFFF");
      bVar2 = pbVar21 < local_44;
LAB_0046c814:
      if (!bVar2) goto LAB_0046c81c;
LAB_0046c6d0:
      _psTraceStr("psAssert %s","keyformat/x509.c");
      _psTraceInt(&DAT_0049016c,0x52c);
      _psError("p <= end");
      local_48 = pbVar21;
      if (iVar8 == 0) goto LAB_0046c824;
LAB_0046c72c:
      if (__s[1] == 0) {
        _psTraceStr("psAssert %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x570);
        _psError("cert->parseStatus != PS_X509_PARSE_SUCCESS");
      }
      if ((param_5 >> 2 & 1) == 0) {
        return iVar8;
      }
    }
    if ((((local_48 == pbVar22) || (pbVar22 + 1 <= local_48)) ||
        ((int)pbVar22 - (int)local_48 < 0x101)) || ((*local_48 == 0 && (local_48[1] == 0)))) {
      iVar8 = -0x1f;
      if ((local_34 != 0) && (iVar8 = local_34, (param_5 >> 2 & 1) == 0)) {
        iVar8 = (int)local_48 - (int)param_2;
      }
      return iVar8;
    }
    puVar10 = (undefined4 *)malloc(800);
    __s[199] = puVar10;
    if (puVar10 == (undefined4 *)0x0) {
      _psTraceStr("psError %s","keyformat/x509.c");
      _psTraceInt(&DAT_0049016c,0x591);
      _psError("Memory allocation error in psX509ParseCert\n");
      return -8;
    }
    memset(puVar10,0,800);
    __src = local_48;
    *puVar10 = param_1;
    puVar10[1] = 1;
    puVar10[0x74] = 0x7f;
    *puVar10 = param_1;
    local_44 = local_48;
    iVar8 = getAsnSequence32(&local_44,(int)pbVar22 - (int)local_48,&local_40,0);
    pbVar21 = __src + param_3;
    __s = puVar10;
  } while( true );
}



// WARNING: Type propagation algorithm not settling

int psX509ParseCertFile(undefined4 param_1,undefined4 param_2,int *param_3,uint param_4)

{
  char cVar1;
  int iVar2;
  int iVar3;
  void **ppvVar4;
  void *__s;
  char *pcVar5;
  char *pcVar6;
  char *pcVar7;
  void **ppvVar8;
  undefined4 uVar9;
  void **ppvVar10;
  char *__haystack;
  uint uVar11;
  void **local_50;
  char *local_4c;
  ushort local_48 [2];
  void **local_44;
  int local_40;
  void **local_3c;
  int local_38;
  int local_34;
  void **local_30;
  uint local_2c;
  
  *param_3 = 0;
  iVar2 = psParseList(param_1,param_2,0x3b,&local_50);
  local_34 = 0;
  if (iVar2 < 0) {
    return iVar2;
  }
  iVar2 = 0;
  local_3c = local_50;
  local_38 = 0;
  if (local_50 != (void **)0x0) {
    local_2c = param_4 >> 2 & 1;
    do {
      iVar3 = psGetFileBuf(param_1,*local_3c,&local_4c,local_48);
      __haystack = local_4c;
      if (iVar3 < 0) {
LAB_0046dcb4:
        psFreeList(local_50,param_1);
        if (local_38 == 0) {
          return iVar3;
        }
        psX509FreeCert(local_38);
        return iVar3;
      }
      local_44 = (void **)0x0;
      uVar11 = (uint)local_48[0];
      local_30 = (void **)0x0;
      if (local_4c == (char *)0x0) {
        iVar2 = -6;
LAB_0046db48:
        psFreeList(local_50,param_1);
        free(local_4c);
        if (local_38 == 0) {
          return iVar2;
        }
        psX509FreeCert(local_38);
        return iVar2;
      }
      ppvVar4 = (void **)malloc(0xc);
      if (ppvVar4 == (void **)0x0) {
        _psTraceStr("psError %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x136);
        iVar2 = -8;
        _psError("Memory allocation error first pemCertFileBufToX509\n");
        goto LAB_0046db48;
      }
      *ppvVar4 = (void *)0x0;
      ppvVar4[1] = (void *)0x0;
      ppvVar4[2] = (void *)0x0;
      ppvVar10 = ppvVar4;
      while (uVar11 != 0) {
        pcVar5 = strstr(__haystack,"-----BEGIN");
        if ((((pcVar5 == (char *)0x0) ||
             (pcVar5 = strstr(__haystack,"CERTIFICATE-----"), pcVar5 == (char *)0x0)) ||
            (pcVar6 = strstr(pcVar5,"-----END"), pcVar6 == (char *)0x0)) ||
           (pcVar7 = strstr(pcVar6,"CERTIFICATE-----"), pcVar7 == (char *)0x0)) {
LAB_0046db30:
          psFreeList(ppvVar4,param_1);
          iVar2 = -0x1f;
          goto LAB_0046db48;
        }
        ppvVar8 = ppvVar10;
        if (ppvVar10 == (void **)0x0) {
          ppvVar8 = (void **)malloc(0xc);
          if (ppvVar8 != (void **)0x0) {
            *ppvVar8 = (void *)0x0;
            ppvVar8[1] = (void *)0x0;
            ppvVar8[2] = (void *)0x0;
            local_30[1] = ppvVar8;
            goto LAB_0046dad4;
          }
          psFreeList(ppvVar4,param_1);
          _psTraceStr("psError %s","keyformat/x509.c");
          uVar9 = 0x14c;
LAB_0046ddfc:
          _psTraceInt(&DAT_0049016c,uVar9);
          _psError("Memory allocation error: pemCertFileBufToX509\n");
          iVar2 = -8;
          goto LAB_0046db48;
        }
LAB_0046dad4:
        *(short *)(ppvVar8 + 2) = (short)pcVar6 - (short)(pcVar5 + 0x10);
        pcVar6 = pcVar7 + 0x10;
        cVar1 = pcVar7[0x10];
        while (((cVar1 == '\r' || (cVar1 == '\n')) || ((cVar1 == '\t' || (cVar1 == ' '))))) {
          pcVar6 = pcVar6 + 1;
          cVar1 = *pcVar6;
        }
        __s = malloc((size_t)*(undefined2 *)(ppvVar8 + 2));
        *ppvVar8 = __s;
        if (__s == (void *)0x0) {
          psFreeList(ppvVar4,param_1);
          _psTraceStr("psError %s","keyformat/x509.c");
          uVar9 = 0x164;
          goto LAB_0046ddfc;
        }
        memset(__s,0,(size_t)*(undefined2 *)(ppvVar8 + 2));
        iVar3 = psBase64decode(pcVar5 + 0x10,*(undefined2 *)(ppvVar8 + 2),*ppvVar8,ppvVar8 + 2);
        uVar11 = uVar11 - ((int)pcVar6 - (int)__haystack) & 0xffff;
        if (iVar3 != 0) goto LAB_0046db30;
        ppvVar10 = (void **)ppvVar8[1];
        __haystack = pcVar6;
        local_30 = ppvVar8;
      }
      local_44 = ppvVar4;
      free(local_4c);
      ppvVar4 = local_44;
      while (local_44 != (void **)0x0) {
        iVar3 = psX509ParseCert(param_1,*local_44,*(undefined2 *)(local_44 + 2),&local_40,param_4);
        if (iVar3 < 0) {
          if (local_2c == 0) {
            psX509FreeCert(local_40);
            psFreeList(local_50,param_1);
            local_50 = ppvVar4;
            goto LAB_0046dcb4;
          }
        }
        else {
          local_34 = local_34 + 1;
        }
        local_44 = (void **)local_44[1];
        if (local_38 == 0) {
          local_38 = local_40;
        }
        else {
          *(int *)(iVar2 + 0x31c) = local_40;
        }
        iVar2 = local_40;
        local_40 = *(int *)(local_40 + 0x31c);
      }
      local_3c = (void **)local_3c[1];
      psFreeList(ppvVar4,param_1);
    } while (local_3c != (void **)0x0);
  }
  psFreeList(local_50,param_1);
  *param_3 = local_38;
  return local_34;
}



// WARNING: Removing unreachable block (ram,0x0046e260)

int psX509AuthenticateCert(undefined4 param_1,int param_2,int param_3,int *param_4)

{
  int *piVar1;
  char cVar2;
  ushort uVar3;
  int iVar4;
  undefined4 uVar5;
  int iVar6;
  void *__dest;
  int iVar7;
  uint uVar8;
  size_t sVar9;
  uint uVar10;
  char *__s;
  int iVar11;
  uint uVar12;
  char acStack_111 [89];
  undefined2 local_b8 [4];
  undefined auStack_b0 [64];
  ushort local_70;
  short local_6e [3];
  undefined auStack_68 [16];
  int local_58;
  int local_54;
  char *local_38;
  int local_34;
  int local_30;
  int local_2c;
  
  local_30 = 0;
  uVar12 = 0;
  iVar7 = -6;
  if (param_2 != 0) {
    iVar7 = param_2;
    if (param_3 == 0) {
      do {
        *(undefined4 *)(iVar7 + 0x2b0) = 0;
        piVar1 = (int *)(iVar7 + 0x31c);
        iVar7 = *piVar1;
      } while (*piVar1 != 0);
      iVar7 = param_2;
      if (*(int *)(param_2 + 0x31c) != 0) {
        iVar7 = *(int *)(param_2 + 0x31c);
      }
    }
    else {
      *(undefined4 *)(param_3 + 0x2b0) = 0;
      iVar7 = param_3;
    }
    while (iVar4 = iVar7, iVar7 != 0) {
      do {
        iVar7 = iVar4;
        if (((1 < *(int *)(iVar7 + 0x98)) && (*(int *)(iVar7 + 0x1d0) != 0xff)) &&
           (param_2 != iVar7)) {
          *(undefined4 *)(param_2 + 0x2b0) = 0xffffffe0;
          return -0x20;
        }
        iVar4 = memcmp((void *)(param_2 + 0xc4),(void *)(iVar7 + 0x148),0x14);
        if (iVar4 != 0) {
          *(undefined4 *)(param_2 + 0x2b0) = 0xffffffdf;
          return -0x21;
        }
        psCRL_determineRevokedStatus(param_2);
        if (*(int *)(param_2 + 0x2b8) == 9) {
          *(undefined4 *)(param_2 + 0x2b0) = 0xffffffdd;
          return -0x23;
        }
        iVar4 = *(int *)(param_2 + 8);
        if (iVar4 == 0x68e) {
          iVar4 = *(int *)(param_2 + 0x18);
          if (iVar4 == 3) {
            uVar12 = 0x30;
            iVar11 = 7;
          }
          else if (iVar4 < 4) {
            uVar12 = 0x20;
            if (iVar4 != 2) {
              return -10;
            }
            iVar11 = 7;
          }
          else {
            uVar12 = 0x40;
            if (iVar4 != 4) {
              return -10;
            }
            iVar11 = 7;
          }
LAB_0046e004:
          iVar4 = -10;
          if (iVar11 == -10) goto LAB_0046e268;
        }
        else {
          if (iVar4 < 0x68f) {
            if (iVar4 == 0x20d) {
              uVar12 = 0x30;
              iVar11 = 6;
            }
            else if (iVar4 < 0x20e) {
              if (iVar4 == 0x20c) {
                uVar12 = 0x20;
                iVar11 = 6;
              }
              else {
LAB_0046e000:
                iVar11 = -10;
              }
            }
            else {
              iVar11 = 6;
              if (iVar4 != 0x20e) goto LAB_0046e000;
              uVar12 = 0x40;
            }
            goto LAB_0046e004;
          }
          if (iVar4 == 0x690) {
            uVar12 = 0x43;
          }
          else if (iVar4 < 0x690) {
            uVar12 = 0x33;
          }
          else {
            iVar11 = -10;
            if (iVar4 != 0x691) goto LAB_0046e004;
            uVar12 = 0x53;
          }
          iVar11 = 5;
        }
        if (iVar11 == 5) {
          if (0x53 < uVar12) {
            _psTraceStr("psAssert %s","keyformat/x509.c");
            _psTraceInt(&DAT_0049016c,0x155d);
            _psError("sigLen <= sizeof(sigOut)");
          }
          __dest = malloc((uint)*(ushort *)(param_2 + 0x14));
          if (__dest == (void *)0x0) {
            _psTraceStr("psError %s","keyformat/x509.c");
            uVar5 = 0x1564;
LAB_0046e844:
            _psTraceInt(&DAT_0049016c,uVar5);
            _psError("Memory allocation error: psX509AuthenticateCert\n");
            return -8;
          }
          memcpy(__dest,*(void **)(param_2 + 0x10),(uint)*(ushort *)(param_2 + 0x14));
          local_30 = psRsaDecryptPub(0,iVar7 + 0x28,__dest,*(undefined2 *)(param_2 + 0x14),
                                     (char *)((int)register0x00000074 + -0x110),uVar12,0);
          if (local_30 < 0) {
            *(undefined4 *)(param_2 + 0x2b0) = 0xffffffde;
LAB_0046e800:
            free(__dest);
            return local_30;
          }
          free(__dest);
          local_38 = (char *)((int)register0x00000074 + -0x110);
          iVar6 = getAsnSequence(&local_38,uVar12,&local_70);
          iVar4 = -0x1f;
          if (-1 < iVar6) {
            iVar6 = getAsnAlgorithmIdentifier
                              (&local_38,
                               (char *)((int)register0x00000074 + -0x110) + (uVar12 - (int)local_38)
                               ,&local_34,local_6e);
            iVar4 = -0x1f;
            if (-1 < iVar6) {
              if (local_6e[0] == 0) {
                cVar2 = *local_38;
              }
              else {
                _psTraceStr("psAssert %s","keyformat/x509.c");
                _psTraceInt(&DAT_0049016c,0x1650);
                _psError("plen == 0");
                cVar2 = *local_38;
              }
              local_38 = local_38 + 1;
              if (cVar2 == '\x04') {
                iVar6 = getAsnLength(&local_38,
                                     (uint)((char *)((int)register0x00000074 + -0x110) +
                                           (uVar12 - (int)local_38)) & 0xffff,&local_70);
                iVar4 = -0x1f;
                if ((-1 < iVar6) &&
                   ((char *)(uint)local_70 <=
                    (char *)((int)register0x00000074 + -0x110) + (uVar12 - (int)local_38))) {
                  memcpy(auStack_b0,local_38,(size_t)(char *)(uint)local_70);
                  if (local_34 == 0x19f) {
                    uVar3 = 0x30;
LAB_0046e7a4:
                    iVar4 = -9;
                    if (local_70 == uVar3) {
                      iVar6 = memcmpct(auStack_b0,param_2 + 700,local_70);
                      iVar4 = -0x28;
                      if (iVar6 == 0) {
                        local_30 = 0;
                        iVar4 = local_30;
                      }
                    }
                  }
                  else {
                    if (local_34 < 0x1a0) {
                      if (local_34 == 0x19e) {
                        uVar3 = 0x20;
                        goto LAB_0046e7a4;
                      }
                    }
                    else if (local_34 == 0x1a0) {
                      uVar3 = 0x40;
                      goto LAB_0046e7a4;
                    }
                    local_30 = -10;
                    iVar4 = local_30;
                  }
                }
              }
              else {
                iVar4 = -0x1f;
              }
            }
          }
LAB_0046e024:
          local_30 = iVar4;
          if (iVar11 != 6) goto LAB_0046e02c;
          local_30 = psEccDsaVerify(0,iVar7 + 0x28,param_2 + 700,uVar12,
                                    *(undefined4 *)(param_2 + 0x10),*(undefined2 *)(param_2 + 0x14),
                                    &local_2c,0);
          iVar4 = local_30;
          if ((local_30 != 0) || (iVar4 = -1, local_2c == -1)) goto LAB_0046e268;
        }
        else {
          iVar4 = local_30;
          if (iVar11 != 7) goto LAB_0046e024;
          __dest = malloc((uint)*(ushort *)(param_2 + 0x14));
          if (__dest == (void *)0x0) {
            _psTraceStr("psError %s","keyformat/x509.c");
            uVar5 = 0x157b;
            goto LAB_0046e844;
          }
          local_b8[0] = *(undefined2 *)(param_2 + 0x14);
          local_30 = psRsaCrypt(0,iVar7 + 0x28,*(undefined4 *)(param_2 + 0x10),local_b8[0],__dest,
                                local_b8,1,0);
          if (local_30 < 0) goto LAB_0046e800;
          iVar4 = psPkcs1PssDecode(0,param_2 + 700,uVar12,__dest,local_b8[0],
                                   *(undefined2 *)(param_2 + 0x24),*(undefined4 *)(param_2 + 0x18),
                                   (uint)*(ushort *)(iVar7 + 0x94) << 3,&local_30);
          if (iVar4 < 0) {
            free(__dest);
            return -1;
          }
          free(__dest);
          iVar4 = local_30;
          if (local_30 != 0) goto LAB_0046e024;
          local_30 = -1;
LAB_0046e02c:
          iVar4 = local_30;
          if (local_30 < 0) {
LAB_0046e268:
            *(undefined4 *)(param_2 + 0x2b0) = 0xffffffde;
            return iVar4;
          }
        }
        uVar10 = (uint)*(ushort *)(param_2 + 0x280);
        if (uVar10 == 0) {
          sVar9 = (size_t)*(ushort *)(iVar7 + 0x1f0);
          if (sVar9 != 0) {
            if (sVar9 == 0) goto LAB_0046e208;
LAB_0046e068:
            if (((uint)*(ushort *)(param_2 + 0x14) == (uint)*(ushort *)(iVar7 + 0x14)) &&
               (iVar4 = memcmp(*(void **)(param_2 + 0x10),*(void **)(iVar7 + 0x10),
                               (uint)*(ushort *)(param_2 + 0x14)), iVar4 == 0)) {
              if (uVar10 != 0) {
                *(undefined4 *)(param_2 + 0x2b0) = 0xffffffd9;
              }
            }
            else {
              *(undefined4 *)(param_2 + 0x2b0) = 0xffffffd9;
            }
          }
        }
        else {
          sVar9 = (size_t)*(ushort *)(iVar7 + 0x1f0);
          if (sVar9 != uVar10) goto LAB_0046e068;
LAB_0046e208:
          iVar4 = memcmp(*(void **)(iVar7 + 0x1ec),*(void **)(param_2 + 500),sVar9);
          if (iVar4 != 0) {
            *(undefined4 *)(param_2 + 0x2b0) = 0xffffffd9;
          }
        }
        if ((*(uint *)(iVar7 + 0x1e4) >> 2 & 1) == 0) {
          if (*(uint *)(iVar7 + 0x1e4) == 0) {
            __s = *(char **)(iVar7 + 0x1b4);
            iVar4 = -1;
            if (__s != (char *)0x0) {
              sVar9 = strlen(__s);
              iVar4 = psBrokenDownTimeImport
                                (auStack_68,__s,sVar9,(uint)(*(int *)(iVar7 + 0x1ac) == 0x17) << 1);
              if (iVar4 == 0) {
                uVar8 = local_54 + 0x76c;
                uVar10 = local_58 + 1U & 0xffff;
                if (((uVar8 < 0x7cc) || (uVar10 == 0)) || (0xc < uVar10)) {
                  local_30 = -1;
                  iVar4 = local_30;
                }
                else if (uVar8 < 0x7d2) {
LAB_0046e734:
                  local_30 = 1;
                  iVar4 = local_30;
                }
                else if (uVar8 == 0x7d2) {
                  iVar4 = 0;
                  if (uVar10 < 4) goto LAB_0046e734;
                }
                else {
                  iVar4 = 0;
                }
              }
            }
            local_30 = iVar4;
            if (local_30 != 0) {
              if (local_30 < 0) {
                return -0x1f;
              }
              goto LAB_0046e150;
            }
          }
          else {
            local_30 = 0;
          }
          *(uint *)(param_2 + 0x2b4) = *(uint *)(param_2 + 0x2b4) | 1;
          *(undefined4 *)(param_2 + 0x2b0) = 0xffffffdb;
        }
LAB_0046e150:
        if (*(int *)(param_2 + 0x2b0) == 0) {
          uVar5 = 1;
          if ((*(uint *)(param_2 + 0x2b4) >> 3 & 1) != 0) {
            uVar5 = 0xffffffdb;
          }
          *(undefined4 *)(param_2 + 0x2b0) = uVar5;
        }
        if ((iVar7 == param_2) || (iVar7 == param_3)) {
          *param_4 = iVar7;
          goto LAB_0046e1b0;
        }
        param_2 = iVar7;
        iVar4 = *(int *)(iVar7 + 0x31c);
      } while (*(int *)(iVar7 + 0x31c) != 0);
      *param_4 = 0;
    }
LAB_0046e1b0:
    iVar7 = 0;
  }
  return iVar7;
}



int psOcspParseResponse(undefined4 param_1,undefined4 param_2,char **param_3,char *param_4,
                       char **param_5)

{
  char cVar1;
  byte bVar2;
  ushort uVar3;
  int iVar4;
  undefined *puVar5;
  uint uVar6;
  char *pcVar7;
  char *pcVar8;
  char *pcVar9;
  code *pcVar10;
  undefined auStack_368 [8];
  undefined auStack_360 [96];
  undefined auStack_300 [112];
  undefined auStack_290 [208];
  undefined auStack_1c0 [208];
  ushort local_f0;
  ushort local_ee;
  ushort local_ec;
  ushort local_ea;
  short local_e8 [4];
  undefined auStack_e0 [32];
  undefined auStack_c0 [32];
  undefined auStack_a0 [32];
  undefined auStack_80 [32];
  char *local_60;
  int local_5c;
  uint local_58;
  int local_54;
  char *local_50;
  char *local_4c;
  char *local_48;
  uint local_44;
  char *local_40;
  char *local_3c;
  undefined4 local_38;
  int local_34;
  char *local_30;
  
  local_60 = *param_3;
  iVar4 = getAsnSequence(&local_60,(int)param_4 - (int)local_60 & 0xffff,auStack_368);
  if (iVar4 < 0) {
    return -0x1f;
  }
  iVar4 = getAsnEnumerated(&local_60,(int)param_4 - (int)local_60,&local_5c);
  if (iVar4 < 0) {
    return -0x1f;
  }
  if (local_5c != 0) {
    if (6 < local_5c) {
      return -0x1f;
    }
    if (local_5c == 4) {
      return -0x1f;
    }
    return local_5c + -0x57;
  }
  pcVar7 = local_60 + 1;
  pcVar9 = local_60;
  if (*local_60 != -0x60) goto LAB_0046e9f4;
  local_60 = pcVar7;
  iVar4 = getAsnLength32(&local_60,(int)param_4 - (int)pcVar7,&local_58,0);
  if (iVar4 < 0) {
    return -0x1f;
  }
  if ((uint)((int)param_4 - (int)local_60) < local_58) {
    return -0x1f;
  }
  iVar4 = getAsnSequence(&local_60,(int)param_4 - (int)local_60 & 0xffff,auStack_368);
  if (iVar4 < 0) {
    return -0x1f;
  }
  param_5[0x44] = local_60;
  iVar4 = getAsnOID(&local_60,(int)param_4 - (int)local_60,&local_54,1,auStack_368);
  if (iVar4 < 0) {
    param_5[0x44] = (char *)0x0;
    return -0x1f;
  }
  cVar1 = *local_60;
  local_60 = local_60 + 1;
  if (cVar1 != '\x04') {
    return -0x1f;
  }
  iVar4 = getAsnLength32(&local_60,(int)param_4 - (int)local_60,&local_58,0);
  if (iVar4 < 0) {
    return -0x1f;
  }
  if ((uint)((int)param_4 - (int)local_60) < local_58) {
    return -0x1f;
  }
  if (local_54 != 0x75) {
    return -0x2a;
  }
  pcVar9 = param_5[0x44];
  memset(param_5,0,0x114);
  param_5[0x44] = pcVar9;
  local_50 = local_60;
  iVar4 = getAsnSequence(&local_50,(int)param_4 - (int)local_60 & 0xffff,&local_f0);
  if (iVar4 < 0) {
    return -0x1f;
  }
  local_30 = local_50;
  iVar4 = getAsnSequence(&local_50,(int)param_4 - (int)local_50 & 0xffff,&local_f0);
  if (iVar4 < 0) {
    return -0x1f;
  }
  uVar6 = (int)param_4 - (int)local_50 & 0xffff;
  local_48 = local_50;
  if (uVar6 == 0) {
    return -0x1f;
  }
  if (*local_50 == -0x60) {
    uVar6 = uVar6 - 1;
    local_48 = local_50 + 1;
    iVar4 = getAsnLength(&local_48,uVar6 & 0xffff,&local_ec);
    if (iVar4 < 0) {
      return -0x1f;
    }
    if ((int)uVar6 < (int)(uint)local_ec) {
      return -0x1f;
    }
    iVar4 = getAsnInteger(&local_48,(uint)local_ec,&local_4c);
    if (iVar4 < 0) {
      return -0x1f;
    }
  }
  else {
    local_4c = (char *)0x0;
  }
  param_5[0x43] = local_4c;
  if (local_4c != (char *)0x0) {
    return -0x2b;
  }
  if (*local_48 == -0x5f) {
    local_50 = local_48 + 1;
    iVar4 = getAsnLength32(&local_50,(int)param_4 - (int)local_50,&local_44,0);
    if (iVar4 < 0) {
      return -0x1f;
    }
    if ((uint)((int)param_4 - (int)local_50) < local_44) {
      return -0x1f;
    }
    if (local_44 == 0) {
      return -0x1f;
    }
    *param_5 = local_50;
    param_5[1] = (char *)0x0;
    local_40 = local_50 + 1;
    if (((*local_50 != '0') ||
        (local_50 = local_50 + local_44,
        iVar4 = getAsnLength32(&local_40,(int)param_4 - (int)local_40,&local_44,0), iVar4 < 0)) ||
       (local_40 + local_44 != local_50)) {
      *param_5 = (char *)0x0;
      return -0x1f;
    }
  }
  else {
    if (*local_48 != -0x5e) {
      return -0x1f;
    }
    local_50 = local_48 + 1;
    iVar4 = getAsnLength32(&local_50,(int)param_4 - (int)local_50,&local_44,0);
    if (iVar4 < 0) {
      return -0x1f;
    }
    if ((uint)((int)param_4 - (int)local_50) < local_44) {
      return -0x1f;
    }
    cVar1 = *local_50;
    local_50 = local_50 + 1;
    if (((cVar1 != '\x04') ||
        (iVar4 = getAsnLength(&local_50,(int)param_4 - (int)local_50 & 0xffff,&local_f0), iVar4 < 0)
        ) || (((uint)((int)param_4 - (int)local_50) < (uint)local_f0 || (local_f0 != 0x14)))) {
      return -1;
    }
    *param_5 = (char *)0x0;
    param_5[1] = local_50;
    local_50 = local_50 + 0x14;
  }
  if ((int)param_4 - (int)local_50 < 1) {
    return -0x1f;
  }
  if (*local_50 != '\x18') {
    return -0x1f;
  }
  local_50 = local_50 + 1;
  iVar4 = getAsnLength(&local_50,(int)param_4 - (int)local_50 & 0xffff,&local_f0);
  if (iVar4 < 0) {
    return -0x1f;
  }
  if ((uint)((int)param_4 - (int)local_50) < (uint)local_f0) {
    return -0x1f;
  }
  iVar4 = psBrokenDownTimeImport(0,local_50,(uint)local_f0,0);
  if (iVar4 < 0) {
    return -0x1f;
  }
  pcVar9 = local_50 + local_f0;
  param_5[2] = local_50;
  *(ushort *)(param_5 + 3) = local_f0;
  local_50 = pcVar9;
  iVar4 = getAsnSequence(&local_50,(int)param_4 - (int)pcVar9 & 0xffff,&local_f0);
  if (iVar4 < 0) {
    return -0x1f;
  }
  pcVar9 = local_50 + local_f0;
  local_ee = 0;
  if (local_50 < pcVar9) {
    do {
      uVar3 = local_ee;
      local_3c = local_50;
      iVar4 = getAsnSequence(&local_3c,(int)pcVar9 - (int)local_50 & 0xffff,&local_ea);
      if (iVar4 < 0) {
        return -0x1f;
      }
      iVar4 = getAsnSequence(&local_3c,(int)pcVar9 - (int)local_3c & 0xffff,&local_ea);
      if (iVar4 < 0) {
        return -0x1f;
      }
      iVar4 = getAsnAlgorithmIdentifier(&local_3c,(int)pcVar9 - (int)local_3c,&local_38,local_e8);
      if (iVar4 < 0) {
        return -0x1f;
      }
      if (local_e8[0] != 0) {
        _psTraceStr("psAssert %s","keyformat/x509.c");
        _psTraceInt(&DAT_0049016c,0x1712);
        _psError("plen == 0");
      }
      *(short *)(param_5 + (uint)uVar3 * 0xd + 4) = (short)local_38;
      cVar1 = *local_3c;
      local_3c = local_3c + 1;
      if (cVar1 != '\x04') {
        return -0x1f;
      }
      iVar4 = getAsnLength(&local_3c,(int)pcVar9 - (int)local_3c & 0xffff,&local_ea);
      if (iVar4 < 0) {
        return -0x1f;
      }
      pcVar7 = local_3c + local_ea;
      if ((uint)((int)pcVar9 - (int)local_3c) < (uint)local_ea) {
        return -0x1f;
      }
      param_5[(uint)uVar3 * 0xd + 5] = local_3c;
      local_3c = pcVar7 + 1;
      if (*pcVar7 != '\x04') {
        return -0x1f;
      }
      iVar4 = getAsnLength(&local_3c,(int)pcVar9 - (int)local_3c & 0xffff,&local_ea);
      if (iVar4 < 0) {
        return -0x1f;
      }
      if ((uint)((int)pcVar9 - (int)local_3c) < (uint)local_ea) {
        return -0x1f;
      }
      param_5[(uint)uVar3 * 0xd + 6] = local_3c;
      cVar1 = local_3c[local_ea];
      if ((cVar1 != -0x7e) && (cVar1 != '\x02')) {
        return -0x1f;
      }
      local_3c = local_3c + local_ea + 1;
      iVar4 = getAsnLength(&local_3c,(int)pcVar9 - (int)local_3c & 0xffff,&local_ea);
      if (iVar4 < 0) {
        return -0x1f;
      }
      pcVar7 = local_3c + local_ea;
      if ((uint)((int)pcVar9 - (int)local_3c) < (uint)local_ea) {
        return -0x1f;
      }
      param_5[(uint)uVar3 * 0xd + 7] = local_3c;
      param_5[(uint)uVar3 * 0xd + 9] = (char *)0x0;
      param_5[(uint)uVar3 * 0xd + 10] = (char *)0x0;
      param_5[(uint)uVar3 * 0xd + 0xb] = (char *)0x0;
      *(undefined2 *)(param_5 + (uint)uVar3 * 0xd + 0xc) = 0;
      *(undefined *)((int)param_5 + (uint)uVar3 * 0x34 + 0x32) = 0;
      *(undefined *)((int)param_5 + (uint)uVar3 * 0x34 + 0x33) = 0;
      *(ushort *)(param_5 + (uint)uVar3 * 0xd + 8) = local_ea;
      cVar1 = *pcVar7;
      if (cVar1 == -0x80) {
        pcVar7 = pcVar7 + 2;
        *(undefined2 *)((int)param_5 + (uint)uVar3 * 0x34 + 0x22) = 0;
      }
      else {
        local_3c = pcVar7 + 1;
        if (cVar1 == -0x5f) {
          *(undefined2 *)((int)param_5 + (uint)uVar3 * 0x34 + 0x22) = 1;
          iVar4 = getAsnLength(&local_3c,(int)pcVar9 - (int)local_3c & 0xffff,&local_ea);
          if (iVar4 < 0) {
            return -0x1f;
          }
          if (((0x10 < local_ea) && (*local_3c == '\x18')) && (local_3c[1] == '\x0f')) {
            pcVar8 = *(char **)(local_3c + 6);
            pcVar7 = *(char **)(local_3c + 10);
            param_5[(uint)uVar3 * 0xd + 9] = *(char **)(local_3c + 2);
            param_5[(uint)uVar3 * 0xd + 10] = pcVar8;
            param_5[(uint)uVar3 * 0xd + 0xb] = pcVar7;
            *(char *)(param_5 + (uint)uVar3 * 0xd + 0xc) = local_3c[0xe];
            *(char *)((int)param_5 + (uint)uVar3 * 0x34 + 0x31) = local_3c[0xf];
            *(char *)((int)param_5 + (uint)uVar3 * 0x34 + 0x32) = local_3c[0x10];
            if (((((0x13 < local_ea) && (local_3c[0x11] == -0x60)) &&
                 ((local_3c[0x12] == '\x03' &&
                  ((local_3c[0x13] == '\n' && (local_3c[0x14] == '\x01')))))) &&
                (bVar2 = local_3c[0x15], bVar2 < 0xb)) && (bVar2 != 7)) {
              *(byte *)((int)param_5 + (uint)uVar3 * 0x34 + 0x33) = bVar2;
            }
          }
          pcVar7 = local_3c + local_ea;
        }
        else {
          pcVar7 = pcVar7 + 2;
          if (cVar1 != -0x7e) {
            return -0x1f;
          }
          *(undefined2 *)((int)param_5 + (uint)uVar3 * 0x34 + 0x22) = 2;
        }
      }
      if ((int)pcVar9 - (int)pcVar7 < 1) {
        return -0x1f;
      }
      local_3c = pcVar7 + 1;
      if (*pcVar7 != '\x18') {
        return -0x1f;
      }
      iVar4 = getAsnLength(&local_3c,(int)pcVar9 - (int)local_3c & 0xffff,&local_ea);
      if (iVar4 < 0) {
        return -0x1f;
      }
      if ((uint)((int)pcVar9 - (int)local_3c) < (uint)local_ea) {
        return -0x1f;
      }
      pcVar7 = local_3c + local_ea;
      param_5[(uint)uVar3 * 0xd + 0xd] = local_3c;
      *(ushort *)(param_5 + (uint)uVar3 * 0xd + 0xe) = local_ea;
      *(undefined2 *)(param_5 + (uint)uVar3 * 0xd + 0x10) = 0;
      param_5[(uint)uVar3 * 0xd + 0xf] = (char *)0x0;
      if ((1 < (uint)((int)pcVar9 - (int)pcVar7)) && (local_3c = pcVar7 + 1, *pcVar7 == -0x60)) {
        iVar4 = getAsnLength(&local_3c,(int)pcVar9 - (int)local_3c & 0xffff,&local_ea);
        if (iVar4 < 0) {
          return -0x1f;
        }
        if ((uint)((int)pcVar9 - (int)local_3c) < (uint)local_ea) {
          return -0x1f;
        }
        if ((*local_3c == '\x18') && (2 < local_ea)) {
          *(ushort *)(param_5 + (uint)uVar3 * 0xd + 0x10) = local_ea - 2;
          param_5[(uint)uVar3 * 0xd + 0xf] = local_3c + 2;
        }
        pcVar7 = local_3c + local_ea;
      }
      local_3c = pcVar7;
      if ((1 < (uint)((int)pcVar9 - (int)local_3c)) && (pcVar7 = local_3c + 1, *local_3c == -0x5f))
      {
        local_3c = pcVar7;
        iVar4 = getAsnLength(&local_3c,(int)pcVar9 - (int)pcVar7 & 0xffff,&local_ea);
        if (iVar4 < 0) {
          return -0x1f;
        }
        if ((uint)((int)pcVar9 - (int)local_3c) < (uint)local_ea) {
          return -0x1f;
        }
        local_3c = local_3c + local_ea;
      }
      local_ee = local_ee + 1;
      local_50 = local_3c;
      if (local_3c >= pcVar9) break;
      if (local_ee == 3) {
        return -0x1f;
      }
    } while (local_3c < pcVar9);
  }
  if (*local_50 == -0x5f) {
    param_5[0x3f] = (char *)0x0;
    param_5[0x40] = (char *)0x0;
    param_5[0x41] = (char *)0x0;
    param_5[0x42] = (char *)0x0;
    iVar4 = psParseBufFromStaticData(auStack_e0,local_50,(int)param_4 - (int)local_50);
    if (iVar4 == 0) {
      iVar4 = psParseBufTryReadTagSub(auStack_e0,auStack_c0,0xa1);
      if (iVar4 != 0) {
        do {
          iVar4 = psParseBufTryReadTagSub(auStack_c0,auStack_a0,0x30);
          if (iVar4 == 0) break;
          psParseBufReadTagSub(auStack_a0,auStack_80,0x30);
          iVar4 = psParseBufTrySkipBytes(auStack_80,&DAT_00491a60,0xb);
          if (iVar4 != 0) {
            psParseBufReadTagRef(auStack_80,param_5 + 0x3f,4);
          }
          psParseBufFinish(auStack_80);
          iVar4 = psParseBufFinish(auStack_a0);
        } while (iVar4 == 0);
        psParseBufFinish(auStack_c0);
      }
    }
    local_50 = local_50 + 1;
    iVar4 = getAsnLength(&local_50,(int)param_4 - (int)local_50 & 0xffff,&local_f0);
    if (iVar4 < 0) {
      return -0x1f;
    }
    uVar6 = (int)param_4 - (int)local_50;
    local_50 = local_50 + local_f0;
    if (uVar6 < local_f0) {
      return -0x1f;
    }
  }
  pcVar9 = local_50;
  iVar4 = getAsnAlgorithmIdentifier(&local_50,(int)param_4 - (int)local_50,&local_34,&local_ee);
  if (iVar4 < 0) {
    return -0x1f;
  }
  if (local_ee != 0) {
    local_50 = local_50 + local_ee;
  }
  *(short *)(param_5 + 0x2b) = (short)local_34;
  if (local_34 == 0x20e) {
LAB_0046f9c4:
    puVar5 = auStack_1c0;
    *(undefined2 *)((int)param_5 + 0xf6) = 0x40;
    psSha512Init(puVar5);
    psSha512Update(puVar5,local_30,(int)pcVar9 - (int)local_30);
    pcVar10 = psSha512Final;
  }
  else if (local_34 < 0x20f) {
    if (local_34 != 0x208) {
      if (0x208 < local_34) {
        if (local_34 == 0x20c) goto LAB_0046f958;
        if (local_34 != 0x20d) {
          return -10;
        }
LAB_0046f5ac:
        puVar5 = auStack_290;
        *(undefined2 *)((int)param_5 + 0xf6) = 0x30;
        psSha384Init(puVar5);
        psSha384Update(puVar5,local_30,(int)pcVar9 - (int)local_30);
        pcVar10 = psSha384Final;
        goto LAB_0046f5ec;
      }
      iVar4 = 0x5b;
LAB_0046f318:
      if (local_34 != iVar4) {
        return -10;
      }
    }
    puVar5 = auStack_360;
    *(undefined2 *)((int)param_5 + 0xf6) = 0x14;
    psSha1Init(puVar5);
    psSha1Update(puVar5,local_30,(int)pcVar9 - (int)local_30);
    pcVar10 = psSha1Final;
  }
  else {
    if (local_34 != 0x68f) {
      if (local_34 < 0x690) {
        iVar4 = 0x689;
        goto LAB_0046f318;
      }
      if (local_34 == 0x690) goto LAB_0046f5ac;
      if (local_34 != 0x691) {
        return -10;
      }
      goto LAB_0046f9c4;
    }
LAB_0046f958:
    puVar5 = auStack_300;
    *(undefined2 *)((int)param_5 + 0xf6) = 0x20;
    psSha256Init(puVar5);
    psSha256Update(puVar5,local_30,(int)pcVar9 - (int)local_30);
    pcVar10 = psSha256Final;
  }
LAB_0046f5ec:
  (*pcVar10)(puVar5,(int)param_5 + 0xb6);
  cVar1 = *local_50;
  local_50 = local_50 + 1;
  if (cVar1 != '\x03') {
    return -0x1f;
  }
  iVar4 = getAsnLength(&local_50,(int)param_4 - (int)local_50 & 0xffff,&local_f0);
  if (iVar4 < 0) {
    return -0x1f;
  }
  if ((uint)((int)param_4 - (int)local_50) < (uint)local_f0) {
    return -0x1f;
  }
  pcVar9 = local_50 + 1;
  if (*local_50 != '\0') {
    return -0x1f;
  }
  local_f0 = local_f0 - 1;
  local_50 = pcVar9 + local_f0;
  param_5[0x2c] = pcVar9;
  *(ushort *)(param_5 + 0x2d) = local_f0;
  if (param_4 != local_50) {
    if (*local_50 != -0x60) {
      return -0x1f;
    }
    local_50 = local_50 + 1;
    iVar4 = getAsnLength(&local_50,(int)param_4 - (int)local_50 & 0xffff,&local_f0);
    if (iVar4 < 0) {
      return -0x1f;
    }
    if ((uint)((int)param_4 - (int)local_50) < (uint)local_f0) {
      return -0x1f;
    }
    iVar4 = getAsnSequence(&local_50,(int)param_4 - (int)local_50 & 0xffff,&local_f0);
    if (iVar4 < 0) {
      return -0x1f;
    }
    uVar6 = (uint)local_f0;
    if (uVar6 != (int)param_4 - (int)local_50) {
      _psTraceStr("psAssert %s","keyformat/x509.c");
      _psTraceInt(&DAT_0049016c,0x18e7);
      _psError("glen == (end - p)");
      uVar6 = (uint)local_f0;
    }
    iVar4 = psX509ParseCert(param_1,local_50,uVar6,param_5 + 0x3e,1);
    if (iVar4 < 0) {
      psX509FreeCert(param_5[0x3e]);
      return -0x1f;
    }
    local_50 = local_50 + iVar4;
  }
  pcVar9 = local_50;
  if (local_50 != param_4) {
    _psTraceStr("psAssert %s","keyformat/x509.c");
    _psTraceInt(&DAT_0049016c,0x18f3);
    _psError("p == end");
    pcVar9 = local_50;
  }
LAB_0046e9f4:
  local_60 = pcVar9;
  if (param_4 != local_60) {
    _psTraceStr("psAssert %s","keyformat/x509.c");
    _psTraceInt(&DAT_0049016c,0x197c);
    _psError("end == p");
  }
  *param_3 = local_60;
  return 0;
}



// WARNING: Removing unreachable block (ram,0x0046fcf4)

int psOcspResponseCheckDates
              (int param_1,int param_2,undefined4 *param_3,undefined *param_4,undefined *param_5,
              undefined4 *param_6,undefined4 param_7)

{
  short sVar1;
  bool bVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined4 *puVar10;
  undefined4 uVar11;
  undefined4 local_148;
  undefined4 local_144;
  undefined4 local_140;
  undefined4 local_13c;
  undefined4 local_138;
  undefined4 local_134;
  undefined4 local_130;
  undefined4 local_12c;
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  undefined auStack_118 [48];
  undefined4 auStack_e8 [12];
  undefined auStack_b8 [48];
  undefined4 local_88 [12];
  undefined4 local_58 [12];
  
  if (2 < param_2) {
    return -6;
  }
  if (param_3 == (undefined4 *)0x0) {
    param_3 = &local_148;
    local_148 = 0;
    local_144 = 0;
    local_140 = 0;
    local_13c = 0;
    local_138 = 0;
    local_134 = 0;
    local_130 = 0;
    local_12c = 0;
    local_128 = 0;
    local_124 = 0;
    local_120 = 0;
  }
  if ((param_3[5] == 0) && (iVar4 = psGetBrokenDownGMTime(param_3,0), iVar4 != 0)) {
    return -1;
  }
  puVar8 = param_3;
  puVar3 = local_88;
  do {
    puVar10 = puVar3;
    puVar9 = puVar8;
    uVar11 = puVar9[1];
    uVar6 = puVar9[2];
    uVar7 = puVar9[3];
    puVar8 = puVar9 + 4;
    *puVar10 = *puVar9;
    puVar10[1] = uVar11;
    puVar10[2] = uVar6;
    puVar10[3] = uVar7;
    puVar3 = puVar10 + 4;
  } while (puVar8 != param_3 + 8);
  uVar7 = *puVar8;
  uVar6 = puVar9[5];
  puVar10[6] = puVar9[6];
  puVar10[4] = uVar7;
  puVar10[5] = uVar6;
  iVar4 = psBrokenDownTimeAdd(local_88,param_7);
  if (iVar4 != 0) {
    return -1;
  }
  if (param_5 == (undefined *)0x0) {
    param_5 = auStack_118;
  }
  if (param_6 == (undefined4 *)0x0) {
    param_6 = auStack_e8;
  }
  if (param_4 == (undefined *)0x0) {
    param_4 = auStack_b8;
  }
  iVar4 = psBrokenDownTimeImport
                    (param_4,*(undefined4 *)(param_1 + 8),(int)*(short *)(param_1 + 0xc),0);
  param_1 = param_2 * 0x34 + param_1;
  bVar2 = false;
  if ((*(int *)(param_1 + 0x34) != 0) &&
     (iVar5 = psBrokenDownTimeImport
                        (param_5,*(int *)(param_1 + 0x34),(int)*(short *)(param_1 + 0x38),0),
     bVar2 = iVar4 == 0, iVar5 != 0)) {
    bVar2 = false;
  }
  iVar4 = *(int *)(param_1 + 0x3c);
  if (iVar4 == 0) {
    if (!bVar2) goto LAB_0046fbc8;
    sVar1 = *(short *)(param_1 + 0x38);
    iVar4 = *(int *)(param_1 + 0x34);
  }
  else {
    sVar1 = *(short *)(param_1 + 0x40);
  }
  iVar4 = psBrokenDownTimeImport(param_6,iVar4,(int)sVar1,0);
  if (iVar4 != 0) {
    return -0x1f;
  }
LAB_0046fbc8:
  iVar4 = -0x1f;
  if (bVar2) {
    puVar8 = param_6;
    puVar3 = local_58;
    do {
      puVar10 = puVar3;
      puVar9 = puVar8;
      uVar11 = puVar9[1];
      uVar7 = puVar9[2];
      uVar6 = puVar9[3];
      puVar8 = puVar9 + 4;
      *puVar10 = *puVar9;
      puVar10[1] = uVar11;
      puVar10[2] = uVar7;
      puVar10[3] = uVar6;
      puVar3 = puVar10 + 4;
    } while (puVar8 != param_6 + 8);
    uVar6 = *puVar8;
    uVar7 = puVar9[5];
    puVar10[6] = puVar9[6];
    puVar10[4] = uVar6;
    puVar10[5] = uVar7;
    iVar4 = psBrokenDownTimeAdd(local_58,param_7);
    if (iVar4 == 0) {
      iVar5 = psBrokenDownTimeCmp(param_5,local_88);
      if (iVar5 < 1) {
        iVar5 = psBrokenDownTimeCmp(local_58,param_3);
        if (iVar5 < 0) {
          iVar4 = -0xd;
        }
      }
      else {
        iVar4 = -0xd;
      }
    }
  }
  return iVar4;
}



undefined4
psOcspResponseValidate(undefined4 param_1,int param_2,int param_3,int *param_4,int **param_5)

{
  ushort uVar1;
  ushort uVar2;
  int *piVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  void *__s2;
  int iVar7;
  int iVar8;
  int *piVar9;
  size_t __n;
  int iVar10;
  undefined auStack_1c8 [64];
  int local_188;
  void *local_184;
  int local_180;
  undefined4 local_17c;
  undefined auStack_178 [32];
  undefined auStack_158 [32];
  undefined auStack_138 [32];
  undefined auStack_118 [32];
  undefined auStack_f8 [32];
  undefined auStack_d8 [32];
  undefined auStack_b8 [32];
  undefined auStack_98 [32];
  undefined auStack_78 [32];
  undefined auStack_58 [32];
  int local_38;
  int local_34;
  int local_30;
  int local_2c;
  
  local_188 = 0;
  local_184 = (void *)0x0;
  local_180 = 0;
  local_17c = 0;
  local_30 = 0;
  local_2c = 0;
  if (param_5 == (int **)0x0) {
    param_5 = (int **)0x4dad3c;
  }
  if (param_5[5] != (int *)0x0) {
    iVar10 = psParseBufFromStaticData(auStack_178,param_5[5],param_5[6]);
    if (iVar10 == 0) {
      psParseBufReadTagSub(auStack_178,auStack_158,0x30);
      psParseBufReadTagSub(auStack_158,auStack_138,0x30);
      psParseBufTrySkipBytes(auStack_138,&DAT_00491bc4,5);
      psParseBufTrySkipTag(auStack_138,0xa1);
      psParseBufReadTagSub(auStack_138,auStack_d8,0x30);
      psParseBufReadTagSub(auStack_d8,auStack_b8,0x30);
      psParseBufReadTagSub(auStack_b8,auStack_98,0x30);
      psParseBufReadTagSub(auStack_98,auStack_78,0x30);
      psParseBufFinish(auStack_78);
      psParseBufFinish(auStack_98);
      psParseBufFinish(auStack_b8);
      psParseBufFinish(auStack_d8);
      iVar10 = psParseBufTryReadTagSub(auStack_138,auStack_118,0xa2);
      if (iVar10 != 0) {
        do {
          iVar10 = psParseBufTryReadTagSub(auStack_118,auStack_f8,0x30);
          if (iVar10 == 0) break;
          psParseBufReadTagSub(auStack_f8,auStack_58,0x30);
          iVar10 = psParseBufTrySkipBytes(auStack_58,&DAT_00491a60,0xb);
          if (iVar10 != 0) {
            psParseBufReadTagRef(auStack_58,&local_188,4);
          }
          psParseBufFinish(auStack_58);
          iVar10 = psParseBufFinish(auStack_f8);
        } while (iVar10 == 0);
        psParseBufFinish(auStack_118);
      }
      psParseBufFinish(auStack_138);
      iVar10 = psParseBufFinish(auStack_158);
    }
    if (iVar10 != 0) {
      return 0xfffffffa;
    }
  }
  iVar5 = param_4[0x3e];
  iVar10 = 0;
  if (iVar5 == 0) {
    iVar5 = iVar10;
    if (param_2 != 0) {
      do {
        iVar7 = param_4[1];
        iVar8 = param_2 + 0x2fc;
        iVar5 = 0x14;
        if (iVar7 == 0) {
          if (((*param_4 != 0) &&
              (iVar5 = getAsnTagLenUnsafe(*param_4,iVar8,0x14), iVar5 - 2U < 0x3ff)) &&
             ((*(int *)(param_2 + 0x310) != 0 &&
              (iVar7 = *(int *)(param_2 + 0x310) + (uint)*(ushort *)(param_2 + 0x31a),
              (uint)*(ushort *)(param_2 + 0x31a) + iVar5 <= (uint)*(ushort *)(param_2 + 0x314))))) {
            iVar8 = *param_4;
            goto LAB_0046ff50;
          }
        }
        else {
LAB_0046ff50:
          iVar7 = memcmpct(iVar7,iVar8,iVar5);
          iVar5 = param_2;
          if (iVar7 == 0) break;
        }
        param_2 = *(int *)(param_2 + 0x31c);
        iVar5 = iVar10;
      } while (param_2 != 0);
      iVar10 = iVar5;
      iVar5 = iVar10;
      if (iVar10 != 0) goto LAB_004700f4;
    }
    iVar7 = *(int *)(param_3 + 0x31c);
    if (iVar7 == 0) {
      return 0xffffffff;
    }
    do {
      iVar8 = param_4[1];
      iVar6 = iVar7 + 0x2fc;
      iVar10 = 0x14;
      if (iVar8 == 0) {
        iVar10 = *param_4;
        if (((iVar10 != 0) && (iVar10 = getAsnTagLenUnsafe(iVar10,iVar10,0x14), iVar10 - 2U < 0x3ff)
            ) && ((*(int *)(iVar7 + 0x310) != 0 &&
                  (iVar8 = *(int *)(iVar7 + 0x310) + (uint)*(ushort *)(iVar7 + 0x31a),
                  (uint)*(ushort *)(iVar7 + 0x31a) + iVar10 <= (uint)*(ushort *)(iVar7 + 0x314)))))
        {
          iVar6 = *param_4;
          goto LAB_0046ffc0;
        }
      }
      else {
LAB_0046ffc0:
        iVar8 = memcmpct(iVar8,iVar6,iVar10);
        iVar10 = iVar7;
        if (iVar8 == 0) break;
      }
      iVar7 = *(int *)(iVar7 + 0x31c);
      iVar10 = iVar5;
    } while (iVar7 != 0);
    if (iVar10 == 0) {
      return 0xffffffff;
    }
  }
  else {
    do {
      iVar8 = param_4[1];
      iVar6 = iVar5 + 0x2fc;
      iVar7 = 0x14;
      if (iVar8 == 0) {
        if ((((*param_4 != 0) && (iVar7 = getAsnTagLenUnsafe(*param_4,iVar6), iVar7 - 2U < 0x3ff))
            && (*(int *)(iVar5 + 0x310) != 0)) &&
           (iVar8 = *(int *)(iVar5 + 0x310) + (uint)*(ushort *)(iVar5 + 0x31a),
           (uint)*(ushort *)(iVar5 + 0x31a) + iVar7 <= (uint)*(ushort *)(iVar5 + 0x314))) {
          iVar6 = *param_4;
          goto LAB_0046fe74;
        }
      }
      else {
LAB_0046fe74:
        iVar7 = memcmpct(iVar8,iVar6,iVar7);
        if (iVar7 == 0) {
          local_38 = param_2;
          if (param_2 != 0) {
            do {
              iVar7 = local_38;
              iVar8 = memcmp((void *)(local_38 + 0x148),(void *)(iVar5 + 0xc4),0x14);
              if (iVar8 == 0) {
                iVar10 = psX509AuthenticateCert(param_1,iVar5,iVar7,&local_38,0,0);
                if (iVar10 != 0) {
                  return 0xffffffff;
                }
                local_38 = 0;
                iVar10 = iVar5;
              }
              else {
                local_38 = *(int *)(iVar7 + 0x31c);
              }
            } while (local_38 != 0);
          }
          break;
        }
      }
      iVar5 = *(int *)(iVar5 + 0x31c);
    } while (iVar5 != 0);
    if (iVar10 == 0) {
      return 0xffffffff;
    }
  }
LAB_004700f4:
  uVar1 = *(ushort *)(param_3 + 0xa0);
  local_34 = 0;
  piVar9 = param_4 + 4;
  do {
    piVar3 = piVar9;
    iVar5 = local_34;
    if (((uint)uVar1 == (int)*(short *)(piVar3 + 4)) &&
       (iVar7 = memcmp(*(void **)(param_3 + 0x9c),(void *)piVar3[3],(uint)uVar1), iVar7 == 0))
    break;
    iVar5 = iVar5 + 1;
    piVar9 = piVar3 + 0xd;
    local_34 = iVar5;
  } while (iVar5 < 3);
  if (iVar5 == 3) {
    return 0xffffffff;
  }
  if (param_5[7] != (int *)0x0) {
    *param_5[7] = iVar5;
    iVar5 = local_34;
  }
  if (*(short *)((int)piVar3 + 0x12) == 0) {
    local_30 = 1;
    local_2c = 0;
  }
  else if (*(short *)((int)piVar3 + 0x12) == 1) {
    local_30 = 1;
    local_2c = 1;
  }
  iVar5 = psOcspResponseCheckDates(param_4,iVar5,0,0,0,0,0x78);
  if (iVar5 != 0) {
    return 0xffffffff;
  }
  if ((local_188 != 0) && (piVar9 = param_5[2], piVar9 != (int *)0x0)) {
    if (param_4[0x3f] == 0) {
      *piVar9 = 0;
    }
    else {
      __s2 = (void *)param_4[0x40];
      if ((((local_180 - (int)local_184 == param_4[0x41] - (int)__s2) && (local_184 != (void *)0x0))
          && (__s2 != (void *)0x0)) &&
         (iVar5 = memcmp(local_184,__s2,local_180 - (int)local_184), iVar5 == 0)) {
        *piVar9 = 1;
      }
      else {
        *piVar9 = 0;
      }
    }
  }
  uVar1 = *(ushort *)(param_4 + 0x2b);
  if (uVar1 == 0x20e) {
    uVar4 = 0x40;
  }
  else {
    if (0x20e < uVar1) {
      if (uVar1 == 0x68f) {
        __n = 0x20;
      }
      else {
        if (uVar1 < 0x690) {
          uVar2 = 0x689;
          goto LAB_0047020c;
        }
        if (uVar1 == 0x690) {
          __n = 0x30;
        }
        else {
          if (uVar1 != 0x691) {
            return 0xfffffff6;
          }
          __n = 0x40;
        }
      }
LAB_0047024c:
      if (*(char *)(iVar10 + 0x96) != '\x01') {
        return 0xffffffff;
      }
      iVar10 = pubRsaDecryptSignedElement
                         (0,iVar10 + 0x28,param_4[0x2c],*(undefined2 *)(param_4 + 0x2d),auStack_1c8,
                          __n,0);
      if (iVar10 < 0) {
        return 0xffffffff;
      }
      iVar10 = memcmp((void *)((int)param_4 + 0xb6),auStack_1c8,__n);
      if (iVar10 != 0) {
        return 0xffffffff;
      }
      goto LAB_004702c0;
    }
    if (uVar1 == 0x208) {
      uVar4 = 0x14;
    }
    else {
      uVar2 = 0x5b;
      if (uVar1 < 0x209) {
LAB_0047020c:
        __n = 0x14;
        if (uVar1 != uVar2) {
          return 0xfffffff6;
        }
        goto LAB_0047024c;
      }
      if (uVar1 == 0x20c) {
        uVar4 = 0x20;
      }
      else {
        if (uVar1 != 0x20d) {
          return 0xfffffff6;
        }
        uVar4 = 0x30;
      }
    }
  }
  if (*(char *)(iVar10 + 0x96) != '\x03') {
    return 0xffffffff;
  }
  local_34 = 0;
  iVar10 = psEccDsaVerify(0,iVar10 + 0x28,(int)param_4 + 0xb6,uVar4,param_4[0x2c],
                          *(undefined2 *)(param_4 + 0x2d),&local_34,0);
  if (iVar10 < 0) {
    return 0xffffffff;
  }
  if (local_34 != 1) {
    return 0xffffffff;
  }
LAB_004702c0:
  if (*param_5 != (int *)0x0) {
    **param_5 = local_30;
  }
  uVar4 = 0xffffffff;
  if (local_30 != 0) {
    if (param_5[1] != (int *)0x0) {
      *param_5[1] = local_2c;
    }
    if (param_5[3] != (int *)0x0) {
      psBrokenDownTimeImport(param_5[3],piVar3 + 5,0xf,0);
    }
    if ((uint *)param_5[4] != (uint *)0x0) {
      *param_5[4] = (uint)*(byte *)((int)piVar3 + 0x23);
    }
    uVar4 = 0xffffffdd;
    if (local_2c == 0) {
      return 0;
    }
  }
  return uVar4;
}



void psOcspResponseValidateOld(void)

{
  psOcspResponseValidate();
  return;
}



undefined4 psCryptoOpen(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  uVar2 = 0;
  if (DAT_004d78c8 != 'Y') {
    iVar1 = strncmp("YYNNNNNYYNY",param_1,7);
    if (iVar1 == 0) {
      iVar1 = psCoreOpen(param_1 + 7);
      if (iVar1 < 0) {
        _psTraceStr("psError %s","layer/matrix.c");
        _psTraceInt(&DAT_0049016c,0x42);
        _psError("pscore open failure\n");
        uVar2 = 0xffffffff;
      }
      else {
        psOpenPrng();
        psCrlOpen();
        strncpy(&DAT_004d78c8,"YYNNNNNYYNY",0x1f);
        uVar2 = 0;
      }
    }
    else {
      _psTraceStr("psError %s","layer/matrix.c");
      _psTraceInt(&DAT_0049016c,0x3d);
      _psErrorStr("Crypto config mismatch.\nLibrary: YYNNNNNYYNY\nCurrent: %s\n",param_1);
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



void psCryptoClose(void)

{
  if (DAT_004d78c8 != 'Y') {
    return;
  }
  DAT_004d78c8 = 0x4e;
  psClosePrng();
  psCoreClose();
                    // WARNING: Treating indirect jump as call
  psCrlClose();
  return;
}



undefined4 pstm_init_size(void *param_1,void **param_2,uint param_3)

{
  void *pvVar1;
  undefined4 uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  
  uVar4 = param_3 & 0xffff;
  uVar2 = 0xfffffff8;
  if (uVar4 < 0x181) {
    pvVar1 = malloc(uVar4 << 2);
    *param_2 = pvVar1;
    uVar2 = 0xfffffff8;
    if (pvVar1 != (void *)0x0) {
      param_2[2] = (void *)((uint)param_2[2] & 0xfe000000 | (param_3 & 0xfff) << 0xc);
      param_2[1] = param_1;
      uVar3 = 0;
      if (uVar4 != 0) {
        do {
          iVar5 = uVar3 * 4;
          uVar3 = uVar3 + 1 & 0xffff;
          *(undefined4 *)(iVar5 + (int)pvVar1) = 0;
        } while (uVar3 < uVar4);
      }
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined4 pstm_init(void *param_1,void **param_2)

{
  void *pvVar1;
  undefined4 uVar2;
  uint uVar3;
  int iVar4;
  
  pvVar1 = malloc(0x180);
  *param_2 = pvVar1;
  uVar2 = 0xfffffff8;
  if (pvVar1 != (void *)0x0) {
    param_2[2] = (void *)((uint)param_2[2] & 0xfe000000 | 0x60000);
    param_2[1] = param_1;
    uVar3 = 0;
    do {
      iVar4 = uVar3 * 4;
      uVar3 = uVar3 + 1 & 0xffff;
      *(undefined4 *)(iVar4 + (int)pvVar1) = 0;
    } while (uVar3 < 0x60);
    uVar2 = 0;
  }
  return uVar2;
}



undefined4 pstm_grow(void **param_1,uint param_2)

{
  void *pvVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = param_2 & 0xffff;
  if (0x180 < uVar3) {
    return 0xfffffff8;
  }
  if (((uint)param_1[2] >> 0xc & 0xfff) < uVar3) {
    pvVar1 = realloc(*param_1,uVar3 << 2);
    if (pvVar1 == (void *)0x0) {
      return 0xfffffff8;
    }
    param_2 = param_2 & 0xfff;
    uVar3 = (uint)param_1[2] >> 0xc & 0xfff;
    param_1[2] = (void *)((uint)param_1[2] & 0xff000fff | param_2 << 0xc);
    *param_1 = pvVar1;
    if (uVar3 < param_2) {
      while( true ) {
        uVar2 = uVar3 + 1 & 0xffff;
        *(undefined4 *)(uVar3 * 4 + (int)pvVar1) = 0;
        if (param_2 <= uVar2) break;
        uVar3 = uVar2 + 1 & 0xffff;
        *(undefined4 *)(uVar2 * 4 + (int)pvVar1) = 0;
        if (param_2 <= uVar3) {
          return 0;
        }
      }
    }
  }
  return 0;
}



undefined4 pstm_copy(void **param_1,void **param_2)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  void *pvVar4;
  uint uVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  void *pvVar8;
  
  if (param_1 == param_2) {
    return 0;
  }
  pvVar8 = param_2[2];
  pvVar4 = param_1[2];
  uVar5 = (uint)pvVar8 >> 0xc & 0xfff;
  uVar2 = (uint)pvVar4 & 0xfff;
  if (uVar5 < uVar2) {
    if (0x180 < uVar2) {
      return 0xfffffff8;
    }
    if (uVar5 < uVar2) {
      pvVar4 = realloc(*param_2,uVar2 << 2);
      if (pvVar4 == (void *)0x0) {
        return 0xfffffff8;
      }
      uVar5 = (uint)param_2[2] >> 0xc & 0xfff;
      *param_2 = pvVar4;
      param_2[2] = (void *)((uint)param_2[2] & 0xff000fff | uVar2 << 0xc);
      if (uVar5 < uVar2) {
        do {
          iVar1 = uVar5 * 4;
          uVar5 = uVar5 + 1 & 0xffff;
          *(undefined4 *)(iVar1 + (int)pvVar4) = 0;
        } while (uVar5 < uVar2);
        pvVar8 = param_2[2];
        pvVar4 = param_1[2];
        uVar2 = (uint)pvVar4 & 0xfff;
        goto LAB_00470c98;
      }
    }
    pvVar8 = param_2[2];
    pvVar4 = param_1[2];
    uVar2 = (uint)pvVar4 & 0xfff;
  }
  else {
    uVar2 = (uint)pvVar4 & 0xfff;
  }
LAB_00470c98:
  puVar6 = (undefined4 *)*param_1;
  puVar7 = (undefined4 *)*param_2;
  uVar5 = 0;
  for (uVar3 = uVar2; uVar3 != 0; uVar3 = uVar3 - 1) {
    *puVar7 = *puVar6;
    puVar6 = puVar6 + 1;
    puVar7 = puVar7 + 1;
    uVar5 = uVar2;
  }
  iVar1 = ((uint)pvVar8 & 0xfff) - uVar5;
  if (uVar5 < ((uint)pvVar8 & 0xfff)) {
    do {
      iVar1 = iVar1 + -1;
      *puVar7 = 0;
      puVar7 = puVar7 + 1;
    } while (iVar1 != 0);
  }
  pvVar8 = param_2[2];
  param_2[2] = (void *)((uint)pvVar8 & 0xfffff000 | (uint)pvVar4 & 0xfff);
  param_2[2] = (void *)((uint)pvVar8 & 0xfefff000 | (uint)pvVar4 & 0xfff |
                       (*(byte *)((int)param_1 + 0xb) & 1) << 0x18);
  return 0;
}



void pstm_clamp(int *param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  uVar2 = param_1[2];
  if ((uVar2 & 0xfff) != 0) {
    iVar1 = *(int *)((uVar2 & 0xfff) * 4 + *param_1 + -4);
    while (iVar1 == 0) {
      uVar3 = (uVar2 & 0xfff) - 1 & 0xfff;
      uVar2 = uVar2 & 0xfffff000 | uVar3;
      param_1[2] = uVar2;
      if (uVar3 == 0) break;
      iVar1 = *(int *)(uVar3 * 4 + *param_1 + -4);
    }
  }
  if ((uVar2 & 0xfff) == 0) {
    param_1[2] = uVar2 & 0xfeffffff;
  }
  return;
}



void pstm_clear(undefined4 *param_1)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 *__ptr;
  
  if ((param_1 != (undefined4 *)0x0) && (__ptr = (undefined4 *)*param_1, __ptr != (undefined4 *)0x0)
     ) {
    puVar2 = __ptr;
    for (uVar1 = param_1[2] & 0xfff; uVar1 != 0; uVar1 = uVar1 - 1) {
      *puVar2 = 0;
      puVar2 = puVar2 + 1;
    }
    free(__ptr);
    param_1[2] = param_1[2] & 0xfe000000;
    *param_1 = 0;
  }
  return;
}



void pstm_clear_multi(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,
                     int param_7,undefined4 *param_8)

{
  uint uVar1;
  undefined4 *puVar2;
  undefined4 *__ptr;
  
  if (((((param_1 != 0) && (pstm_clear(), param_2 != 0)) && (pstm_clear(param_2), param_3 != 0)) &&
      ((pstm_clear(param_3), param_4 != 0 && (pstm_clear(param_4), param_5 != 0)))) &&
     ((pstm_clear(param_5), param_6 != 0 &&
      ((pstm_clear(param_6), param_7 != 0 && (pstm_clear(param_7), param_8 != (undefined4 *)0x0)))))
     ) {
    if ((param_8 != (undefined4 *)0x0) &&
       (__ptr = (undefined4 *)*param_8, __ptr != (undefined4 *)0x0)) {
      puVar2 = __ptr;
      for (uVar1 = param_8[2] & 0xfff; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar2 = 0;
        puVar2 = puVar2 + 1;
      }
      free(__ptr);
      param_8[2] = param_8[2] & 0xfe000000;
      *param_8 = 0;
    }
    return;
  }
  return;
}



undefined4 pstm_cmp_mag(int *param_1,int *param_2)

{
  uint *puVar1;
  uint uVar2;
  undefined4 uVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar2 = param_1[2] & 0xfff;
  uVar3 = 1;
  if ((uVar2 <= (param_2[2] & 0xfffU)) && (uVar3 = 0xffffffff, (param_2[2] & 0xfffU) <= uVar2)) {
    puVar5 = (uint *)(*param_2 + uVar2 * 4);
    puVar1 = (uint *)(*param_1 + uVar2 * 4);
    uVar4 = 0;
    if (uVar2 != 0) {
      do {
        puVar5 = puVar5 + -1;
        puVar1 = puVar1 + -1;
        uVar4 = uVar4 + 1 & 0xffff;
        if (*puVar5 < *puVar1) {
          return 1;
        }
        if (*puVar1 < *puVar5) {
          return 0xffffffff;
        }
      } while (uVar4 < uVar2);
    }
    uVar3 = 0;
  }
  return uVar3;
}



undefined4 pstm_cmp(int *param_1,int *param_2)

{
  uint uVar1;
  uint *puVar2;
  uint uVar3;
  undefined4 uVar4;
  uint *puVar5;
  uint uVar6;
  uint uVar7;
  
  uVar6 = param_1[2];
  uVar3 = param_2[2];
  uVar1 = uVar6 >> 0x18 & 1;
  if (uVar1 == (uVar3 >> 0x18 & 1)) {
    uVar7 = uVar3 & 0xfff;
    if (uVar1 != 1) {
      uVar6 = uVar6 & 0xfff;
      uVar4 = 1;
      if ((uVar6 <= (uVar3 & 0xfff)) && (uVar4 = 0xffffffff, (uVar3 & 0xfff) <= uVar6)) {
        puVar5 = (uint *)(*param_1 + uVar6 * 4);
        puVar2 = (uint *)(*param_2 + uVar6 * 4);
        uVar1 = 0;
        if (uVar6 != 0) {
          do {
            puVar2 = puVar2 + -1;
            puVar5 = puVar5 + -1;
            uVar1 = uVar1 + 1 & 0xffff;
            if (*puVar2 < *puVar5) {
              return 1;
            }
            if (*puVar5 < *puVar2) {
              return 0xffffffff;
            }
          } while (uVar1 < uVar6);
        }
        uVar4 = 0;
      }
      return uVar4;
    }
    uVar4 = 1;
    if ((uVar7 <= (uVar6 & 0xfff)) && (uVar4 = 0xffffffff, (uVar6 & 0xfff) <= uVar7)) {
      puVar2 = (uint *)(*param_2 + uVar7 * 4);
      puVar5 = (uint *)(*param_1 + uVar7 * 4);
      uVar1 = 0;
      if (uVar7 != 0) {
        do {
          puVar2 = puVar2 + -1;
          puVar5 = puVar5 + -1;
          uVar1 = uVar1 + 1 & 0xffff;
          if (*puVar5 < *puVar2) goto LAB_00471180;
          if (*puVar2 < *puVar5) {
            return 0xffffffff;
          }
        } while (uVar1 < uVar7);
      }
      return 0;
    }
  }
  else {
    uVar4 = 0xffffffff;
    if (uVar1 != 1) {
LAB_00471180:
      uVar4 = 1;
    }
  }
  return uVar4;
}



int pstm_cmp_d(uint **param_1,uint param_2)

{
  uint *puVar1;
  
  if (param_2 == 0) {
    puVar1 = param_1[2];
  }
  else {
    puVar1 = param_1[2];
    if (((uint)puVar1 & 0xfff) == 0) {
      return -1;
    }
  }
  if (((uint)puVar1 >> 0x18 & 1) == 1) {
    return -1;
  }
  if (1 < ((uint)puVar1 & 0xfff)) {
    return 1;
  }
  if (**param_1 <= param_2) {
    return -(uint)(**param_1 < param_2);
  }
  return 1;
}



undefined4 pstm_init_for_read_unsigned_bin(void *param_1,void **param_2,uint param_3)

{
  void *pvVar1;
  undefined4 uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  
  uVar4 = ((param_3 & 0xffff) >> 2) + 2;
  uVar2 = 0xfffffff8;
  if (uVar4 < 0x181) {
    pvVar1 = malloc(uVar4 * 4);
    *param_2 = pvVar1;
    uVar2 = 0xfffffff8;
    if (pvVar1 != (void *)0x0) {
      param_2[2] = (void *)((uint)param_2[2] & 0xfe000000 | (uVar4 & 0xfff) << 0xc);
      param_2[1] = param_1;
      uVar3 = 0;
      if (uVar4 != 0) {
        do {
          iVar5 = uVar3 * 4;
          uVar3 = uVar3 + 1 & 0xffff;
          *(undefined4 *)(iVar5 + (int)pvVar1) = 0;
        } while (uVar3 < uVar4);
      }
      uVar2 = 0;
    }
  }
  return uVar2;
}



undefined4 pstm_read_unsigned_bin(void **param_1,undefined *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  uint uVar4;
  void *pvVar5;
  int iVar6;
  void *pvVar7;
  
  uVar2 = ((uint)param_1[2] & 0xfeffffff) >> 0xc & 0xfff;
  param_1[2] = (void *)((uint)param_1[2] & 0xfefff000);
  param_3 = param_3 & 0xffff;
  puVar3 = (undefined4 *)*param_1;
  uVar1 = 0;
  if (uVar2 != 0) {
    do {
      uVar1 = uVar1 + 1 & 0xffff;
      *puVar3 = 0;
      puVar3 = puVar3 + 1;
    } while (uVar1 < uVar2);
  }
  if (0x600 < param_3) {
    uVar1 = param_3 - 0x600 & 0xffff;
    param_2 = param_2 + uVar1;
    param_3 = param_3 - uVar1 & 0xffff;
  }
  uVar2 = param_3 + 3 >> 2 & 0xfff;
  uVar1 = (uint)param_1[2] >> 0xc & 0xfff;
  param_1[2] = (void *)((uint)param_1[2] & 0xfffff000 | uVar2);
  if (uVar1 < uVar2) {
    if (0x180 < uVar2) {
      return 0xfffffff8;
    }
    if (uVar1 < uVar2) {
      pvVar5 = realloc(*param_1,uVar2 << 2);
      if (pvVar5 == (void *)0x0) {
        return 0xfffffff8;
      }
      pvVar7 = param_1[2];
      *param_1 = pvVar5;
      param_1[2] = (void *)((uint)pvVar7 & 0xff000fff | uVar2 << 0xc);
      uVar1 = (uint)pvVar7 >> 0xc & 0xfff;
      while (uVar1 < uVar2) {
        uVar4 = uVar1 + 1 & 0xffff;
        *(undefined4 *)(uVar1 * 4 + (int)pvVar5) = 0;
        if (uVar2 <= uVar4) break;
        *(undefined4 *)(uVar4 * 4 + (int)pvVar5) = 0;
        uVar1 = uVar4 + 1 & 0xffff;
      }
    }
  }
  pvVar5 = *param_1;
  for (iVar6 = (int)(short)((short)param_3 + -1); -1 < iVar6; iVar6 = (iVar6 + -1) * 0x10000 >> 0x10
      ) {
    *(undefined *)(iVar6 + (int)pvVar5) = *param_2;
    param_2 = param_2 + 1;
  }
  pvVar5 = param_1[2];
  if (((uint)pvVar5 & 0xfff) != 0) {
    iVar6 = *(int *)((int)*param_1 + ((uint)pvVar5 & 0xfff) * 4 + -4);
    while (iVar6 == 0) {
      uVar1 = ((uint)pvVar5 & 0xfff) - 1 & 0xfff;
      pvVar5 = (void *)((uint)pvVar5 & 0xfffff000 | uVar1);
      param_1[2] = pvVar5;
      if (uVar1 == 0) break;
      iVar6 = *(int *)((int)*param_1 + uVar1 * 4 + -4);
    }
  }
  if (((uint)pvVar5 & 0xfff) == 0) {
    param_1[2] = (void *)((uint)pvVar5 & 0xfeffffff);
  }
  return 0;
}



undefined4 pstm_read_asn(undefined4 param_1,char **param_2,uint param_3,void **param_4)

{
  int iVar1;
  uint uVar2;
  void *pvVar3;
  undefined4 *puVar4;
  undefined4 *__ptr;
  uint uVar5;
  char *pcVar6;
  uint uVar7;
  ushort local_20 [2];
  char *local_1c;
  
  if (((param_3 & 0xffff) == 0) || (local_1c = *param_2 + 1, **param_2 != '\x02')) {
    return 0xffffffe1;
  }
  uVar5 = (param_3 & 0xffff) - 1;
  iVar1 = getAsnLength(&local_1c,uVar5 & 0xffff,local_20);
  if (iVar1 < 0) {
    return 0xffffffe1;
  }
  if ((int)uVar5 < (int)(uint)local_20[0]) {
    return 0xffffffe1;
  }
  iVar1 = pstm_init_size(param_1,param_4,(local_20[0] >> 2) + 2);
  if (iVar1 != 0) {
    return 0xfffffff8;
  }
  pvVar3 = (void *)((uint)param_4[2] & 0xfefff000);
  __ptr = (undefined4 *)*param_4;
  uVar2 = ((uint)param_4[2] & 0xfeffffff) >> 0xc & 0xfff;
  uVar7 = (uint)local_20[0];
  uVar5 = 0;
  if (uVar2 != 0) {
    param_4[2] = pvVar3;
    puVar4 = __ptr;
    do {
      uVar5 = uVar5 + 1 & 0xffff;
      *puVar4 = 0;
      puVar4 = puVar4 + 1;
    } while (uVar5 < uVar2);
    pvVar3 = param_4[2];
  }
  pcVar6 = local_1c;
  if (0x600 < uVar7) {
    uVar5 = uVar7 - 0x600 & 0xffff;
    pcVar6 = local_1c + uVar5;
    uVar7 = uVar7 - uVar5 & 0xffff;
  }
  uVar2 = uVar7 + 3 >> 2 & 0xfff;
  uVar5 = (uint)pvVar3 >> 0xc & 0xfff;
  param_4[2] = (void *)((uint)pvVar3 & 0xfffff000 | uVar2);
  if (uVar5 < uVar2) {
    if (0x180 < uVar2) {
LAB_004718d8:
      pstm_clear(param_4);
      return 0xffffffe1;
    }
    if (uVar5 < uVar2) {
      pvVar3 = realloc(__ptr,uVar2 << 2);
      if (pvVar3 == (void *)0x0) goto LAB_004718d8;
      uVar5 = (uint)param_4[2] >> 0xc & 0xfff;
      *param_4 = pvVar3;
      param_4[2] = (void *)((uint)param_4[2] & 0xff000fff | uVar2 << 0xc);
      if (uVar5 < uVar2) {
        do {
          iVar1 = uVar5 * 4;
          uVar5 = uVar5 + 1 & 0xffff;
          *(undefined4 *)(iVar1 + (int)pvVar3) = 0;
        } while (uVar5 < uVar2);
        __ptr = (undefined4 *)*param_4;
        goto LAB_00471790;
      }
    }
    __ptr = (undefined4 *)*param_4;
  }
LAB_00471790:
  for (iVar1 = (int)(short)((short)uVar7 + -1); -1 < iVar1; iVar1 = (iVar1 + -1) * 0x10000 >> 0x10)
  {
    *(char *)(iVar1 + (int)__ptr) = *pcVar6;
    pcVar6 = pcVar6 + 1;
  }
  pvVar3 = param_4[2];
  if (((uint)pvVar3 & 0xfff) != 0) {
    iVar1 = *(int *)((int)*param_4 + ((uint)pvVar3 & 0xfff) * 4 + -4);
    while (iVar1 == 0) {
      uVar5 = ((uint)pvVar3 & 0xfff) - 1 & 0xfff;
      pvVar3 = (void *)((uint)pvVar3 & 0xfffff000 | uVar5);
      param_4[2] = pvVar3;
      if (uVar5 == 0) break;
      iVar1 = *(int *)((int)*param_4 + uVar5 * 4 + -4);
    }
  }
  if (((uint)pvVar3 & 0xfff) == 0) {
    param_4[2] = (void *)((uint)pvVar3 & 0xfeffffff);
  }
  *param_2 = local_1c + local_20[0];
  return 0;
}



void pstm_set(int **param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  int *piVar3;
  
  uVar2 = ((uint)param_1[2] & 0xfeffffff) >> 0xc & 0xfff;
  param_1[2] = (int *)((uint)param_1[2] & 0xfefff000);
  piVar3 = *param_1;
  uVar1 = 0;
  if (uVar2 != 0) {
    do {
      uVar1 = uVar1 + 1 & 0xffff;
      *piVar3 = 0;
      piVar3 = piVar3 + 1;
    } while (uVar1 < uVar2);
  }
  **param_1 = param_2;
  param_1[2] = (int *)((uint)param_1[2] & 0xfffff000 | (uint)(param_2 != 0));
  return;
}



uint pstm_unsigned_bin_size(int *param_1)

{
  uint uVar1;
  uint uVar2;
  
  uVar2 = param_1[2] & 0xfff;
  uVar1 = 0;
  if (uVar2 != 0) {
    uVar1 = uVar2 * 0x20 - 0x20;
    for (uVar2 = *(uint *)(uVar2 * 4 + *param_1 + -4); uVar2 != 0; uVar2 = uVar2 >> 1) {
      uVar1 = (int)(short)uVar1 + 1;
    }
    uVar1 = uVar1 & 0xffff;
  }
  uVar2 = (uVar1 >> 3) + 1;
  if ((uVar1 & 7) == 0) {
    uVar2 = uVar1 >> 3;
  }
  return uVar2;
}



undefined4 pstm_sub_s(int *param_1,int *param_2,void **param_3)

{
  undefined4 uVar1;
  undefined4 *puVar2;
  void *pvVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  void *pvVar11;
  int iVar12;
  
  uVar7 = param_2[2];
  uVar6 = param_1[2];
  uVar4 = uVar6 & 0xfff;
  uVar1 = 0xfffffff7;
  if ((uVar7 & 0xfff) <= uVar4) {
    pvVar3 = param_3[2];
    uVar5 = (uint)pvVar3 >> 0xc & 0xfff;
    if (uVar5 < uVar4) {
      if (0x180 < uVar4) {
        return 0xfffffff8;
      }
      if (uVar5 < uVar4) {
        pvVar3 = realloc(*param_3,uVar4 << 2);
        if (pvVar3 == (void *)0x0) {
          return 0xfffffff8;
        }
        pvVar11 = param_3[2];
        *param_3 = pvVar3;
        param_3[2] = (void *)((uint)pvVar11 & 0xff000fff | uVar4 << 0xc);
        uVar6 = (uint)pvVar11 >> 0xc & 0xfff;
        while (uVar6 < uVar4) {
          uVar7 = uVar6 + 1 & 0xffff;
          *(undefined4 *)(uVar6 * 4 + (int)pvVar3) = 0;
          if (uVar4 <= uVar7) break;
          *(undefined4 *)(uVar7 * 4 + (int)pvVar3) = 0;
          uVar6 = uVar7 + 1 & 0xffff;
        }
      }
      uVar7 = param_2[2];
      uVar6 = param_1[2];
      pvVar3 = param_3[2];
    }
    param_3[2] = (void *)((uint)pvVar3 & 0xfffff000 | uVar6 & 0xfff);
    uVar4 = 0;
    iVar9 = 0;
    if ((uVar7 & 0xfff) != 0) {
      iVar12 = *param_2;
      pvVar11 = *param_3;
      iVar10 = *param_1;
      do {
        iVar8 = iVar9 * 4;
        uVar6 = *(int *)(iVar8 + iVar12) + uVar4;
        iVar9 = iVar9 + 1;
        uVar4 = -(uint)(*(uint *)(iVar8 + iVar10) < uVar6) - (uint)(uVar6 < uVar4) & 1;
        *(uint *)(iVar8 + (int)pvVar11) = *(uint *)(iVar8 + iVar10) - uVar6;
      } while (iVar9 < (int)(uVar7 & 0xfff));
    }
    uVar6 = param_1[2];
    if (iVar9 < (int)(uVar6 & 0xfff)) {
      iVar10 = *param_1;
      pvVar11 = *param_3;
      do {
        iVar12 = iVar9 * 4;
        uVar7 = *(uint *)(iVar12 + iVar10);
        iVar9 = iVar9 + 1;
        iVar8 = uVar7 - uVar4;
        uVar4 = -(uint)(uVar7 < uVar4);
        *(int *)(iVar12 + (int)pvVar11) = iVar8;
      } while (iVar9 < (int)(uVar6 & 0xfff));
    }
    if (iVar9 < (int)((uint)pvVar3 & 0xfff)) {
      puVar2 = (undefined4 *)(iVar9 * 4 + (int)*param_3);
      iVar9 = ((uint)pvVar3 & 0xfff) - iVar9;
      do {
        iVar9 = iVar9 + -1;
        *puVar2 = 0;
        puVar2 = puVar2 + 1;
      } while (iVar9 != 0);
    }
    pvVar3 = param_3[2];
    if (((uint)pvVar3 & 0xfff) != 0) {
      iVar9 = *(int *)((int)*param_3 + ((uint)pvVar3 & 0xfff) * 4 + -4);
      while (iVar9 == 0) {
        uVar4 = ((uint)pvVar3 & 0xfff) - 1 & 0xfff;
        pvVar3 = (void *)((uint)pvVar3 & 0xfffff000 | uVar4);
        param_3[2] = pvVar3;
        if (uVar4 == 0) break;
        iVar9 = *(int *)((int)*param_3 + uVar4 * 4 + -4);
      }
    }
    uVar1 = 0;
    if (((uint)pvVar3 & 0xfff) == 0) {
      param_3[2] = (void *)((uint)pvVar3 & 0xfeffffff);
      uVar1 = 0;
    }
  }
  return uVar1;
}



undefined4 FUN_00471ccc(int *param_1,int *param_2,void **param_3)

{
  bool bVar1;
  uint uVar2;
  int iVar3;
  undefined4 *puVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  void *pvVar10;
  int iVar11;
  uint uVar12;
  void *pvVar13;
  uint uVar14;
  void *pvVar15;
  
  uVar14 = param_1[2] & 0xfff;
  if (uVar14 < (param_2[2] & 0xfffU)) {
    uVar14 = (uint)(short)(param_2[2] & 0xfffU);
  }
  pvVar10 = param_3[2];
  uVar7 = (uint)pvVar10 >> 0xc & 0xfff;
  param_3[2] = (void *)((uint)pvVar10 & 0xfffff000 | uVar14);
  if (uVar7 < uVar14) {
    if (0x180 < uVar14) {
      return 0xfffffff8;
    }
    if (uVar7 < uVar14) {
      pvVar13 = realloc(*param_3,uVar14 << 2);
      if (pvVar13 == (void *)0x0) {
        return 0xfffffff8;
      }
      pvVar15 = param_3[2];
      *param_3 = pvVar13;
      param_3[2] = (void *)((uint)pvVar15 & 0xff000fff | uVar14 << 0xc);
      uVar7 = (uint)pvVar15 >> 0xc & 0xfff;
      while (uVar7 < uVar14) {
        uVar2 = uVar7 + 1 & 0xffff;
        *(undefined4 *)(uVar7 * 4 + (int)pvVar13) = 0;
        if (uVar14 <= uVar2) break;
        *(undefined4 *)(uVar2 * 4 + (int)pvVar13) = 0;
        uVar7 = uVar2 + 1 & 0xffff;
      }
    }
  }
  iVar9 = 0;
  uVar7 = 0;
  if (uVar14 != 0) {
    uVar5 = param_1[2];
    uVar2 = param_2[2];
    pvVar13 = *param_3;
    do {
      iVar3 = uVar7 * 4;
      iVar11 = 0;
      if ((int)uVar7 < (int)(uVar5 & 0xfff)) {
        iVar11 = *(int *)(iVar3 + *param_1);
      }
      bVar1 = (int)uVar7 < (int)(uVar2 & 0xfff);
      uVar7 = (int)((uVar7 + 1) * 0x10000) >> 0x10;
      uVar8 = 0;
      if (bVar1) {
        uVar8 = *(uint *)(iVar3 + *param_2);
      }
      uVar6 = iVar11 + uVar8;
      uVar12 = iVar9 + uVar6;
      iVar9 = (uint)(uVar6 < uVar8) + (uint)(uVar12 < uVar6);
      *(uint *)(iVar3 + (int)pvVar13) = uVar12;
    } while ((int)uVar7 < (int)uVar14);
  }
  if ((iVar9 == 0) || (0x17f < (int)uVar7)) goto LAB_00471e68;
  pvVar13 = param_3[2];
  uVar14 = (uint)pvVar13 & 0xfff;
  uVar2 = (uint)pvVar13 & 0xfff;
  if (uVar14 == ((uint)pvVar13 >> 0xc & 0xfff)) {
    uVar2 = uVar14 + 1;
    if (0x180 < uVar2) {
      return 0xfffffff8;
    }
    if (uVar14 < uVar2) {
      pvVar13 = realloc(*param_3,uVar2 * 4);
      if (pvVar13 == (void *)0x0) {
        return 0xfffffff8;
      }
      uVar2 = uVar2 & 0xfff;
      uVar14 = (uint)param_3[2] >> 0xc & 0xfff;
      *param_3 = pvVar13;
      param_3[2] = (void *)((uint)param_3[2] & 0xff000fff | uVar2 << 0xc);
      if (uVar14 < uVar2) {
        do {
          iVar3 = uVar14 * 4;
          uVar14 = uVar14 + 1 & 0xffff;
          *(undefined4 *)(iVar3 + (int)pvVar13) = 0;
        } while (uVar14 < uVar2);
        pvVar13 = param_3[2];
        uVar2 = (uint)pvVar13 & 0xfff;
        goto LAB_00471f84;
      }
    }
    pvVar13 = param_3[2];
    uVar2 = (uint)pvVar13 & 0xfff;
  }
LAB_00471f84:
  uVar7 = (int)((uVar7 + 1) * 0x10000) >> 0x10;
  param_3[2] = (void *)((uint)pvVar13 & 0xfffff000 | uVar2 + 1 & 0xfff);
  *(int *)(uVar2 * 4 + (int)*param_3) = iVar9;
LAB_00471e68:
  param_3[2] = (void *)((uint)param_3[2] & 0xfffff000 | uVar7 & 0xfff);
  if ((int)uVar7 < (int)((uint)pvVar10 & 0xfff)) {
    puVar4 = (undefined4 *)(uVar7 * 4 + (int)*param_3);
    do {
      uVar7 = (int)((uVar7 + 1) * 0x10000) >> 0x10;
      *puVar4 = 0;
      puVar4 = puVar4 + 1;
    } while ((int)uVar7 < (int)((uint)pvVar10 & 0xfff));
  }
  pvVar10 = param_3[2];
  if (((uint)pvVar10 & 0xfff) != 0) {
    iVar9 = *(int *)((int)*param_3 + ((uint)pvVar10 & 0xfff) * 4 + -4);
    while (iVar9 == 0) {
      uVar14 = ((uint)pvVar10 & 0xfff) - 1 & 0xfff;
      pvVar10 = (void *)((uint)pvVar10 & 0xfffff000 | uVar14);
      param_3[2] = pvVar10;
      if (uVar14 == 0) break;
      iVar9 = *(int *)((int)*param_3 + uVar14 * 4 + -4);
    }
  }
  if (((uint)pvVar10 & 0xfff) == 0) {
    param_3[2] = (void *)((uint)pvVar10 & 0xfeffffff);
  }
  return 0;
}



int pstm_add(int *param_1,int *param_2,int param_3)

{
  uint uVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint *puVar7;
  uint *puVar8;
  
  uVar4 = (uint)param_1[2] >> 0x18 & 1;
  uVar6 = (uint)param_2[2] >> 0x18 & 1;
  if (uVar4 == uVar6) {
    *(uint *)(param_3 + 8) = *(uint *)(param_3 + 8) & 0xfeffffff | uVar4 << 0x18;
    iVar2 = FUN_00471ccc();
  }
  else {
    uVar5 = param_1[2] & 0xfff;
    uVar1 = param_2[2] & 0xfff;
    iVar2 = 1;
    if ((uVar5 <= uVar1) && (iVar2 = -1, uVar1 <= uVar5)) {
      puVar7 = (uint *)(*param_2 + uVar5 * 4);
      puVar8 = (uint *)(*param_1 + uVar5 * 4);
      uVar1 = 0;
      if (uVar5 != 0) {
        do {
          puVar8 = puVar8 + -1;
          puVar7 = puVar7 + -1;
          uVar1 = uVar1 + 1 & 0xffff;
          if (*puVar7 < *puVar8) {
            iVar2 = 1;
            goto LAB_004721b8;
          }
          if (*puVar8 < *puVar7) {
            iVar2 = -1;
            goto LAB_004721b8;
          }
        } while (uVar1 < uVar5);
      }
      iVar2 = 0;
    }
LAB_004721b8:
    if (iVar2 == -1) {
      uVar4 = *(uint *)(param_3 + 8) & 0xfeffffff | uVar6 << 0x18;
      *(uint *)(param_3 + 8) = uVar4;
      piVar3 = param_2;
    }
    else {
      *(uint *)(param_3 + 8) = *(uint *)(param_3 + 8) & 0xfeffffff | uVar4 << 0x18;
      piVar3 = param_1;
      param_1 = param_2;
    }
    iVar2 = pstm_sub_s(piVar3,param_1,param_3,uVar4,&_gp);
  }
  if (iVar2 == 0) {
    iVar2 = 0;
  }
  return iVar2;
}



undefined4
pstm_read_radix(undefined4 param_1,void **param_2,byte *param_3,short param_4,byte param_5)

{
  byte bVar1;
  byte bVar2;
  longlong lVar3;
  uint uVar4;
  void *pvVar5;
  uint uVar6;
  int *piVar7;
  undefined4 *puVar8;
  int iVar9;
  void *pvVar10;
  void *pvVar11;
  int iVar12;
  int iVar13;
  uint uVar14;
  int *local_38 [2];
  uint local_30;
  
  uVar14 = (uint)param_5;
  if (0x3e < uVar14 - 2) {
    return 0xfffffffa;
  }
  bVar1 = *param_3;
  if (bVar1 == 0x2d) {
    pvVar11 = param_2[2];
    pvVar5 = (void *)((uint)pvVar11 & 0xfefff000);
    param_4 = param_4 + -1;
    param_3 = param_3 + 1;
    param_2[2] = pvVar5;
    puVar8 = (undefined4 *)*param_2;
  }
  else {
    pvVar11 = param_2[2];
    pvVar5 = (void *)((uint)pvVar11 & 0xfefff000);
    param_2[2] = pvVar5;
    puVar8 = (undefined4 *)*param_2;
  }
  uVar6 = ((uint)pvVar11 & 0xfeffffff) >> 0xc & 0xfff;
  if (uVar6 == 0) {
    pvVar5 = param_2[2];
  }
  else {
    uVar4 = 0;
    do {
      uVar4 = uVar4 + 1 & 0xffff;
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    } while (uVar4 < uVar6);
  }
  if (param_4 == 0) {
LAB_00472664:
    if (((uint)pvVar5 & 0xfff) != 0) {
      param_2[2] = (void *)((uint)pvVar5 & 0xfeffffff | (uint)(bVar1 == 0x2d) << 0x18);
    }
    return 0;
  }
  if (uVar14 >= 0x24) goto LAB_00472650;
LAB_00472348:
  bVar2 = *(byte *)((uint)*param_3 * 2 + __ctype_toupper);
  do {
    iVar13 = 0;
    do {
      iVar12 = iVar13 + 1;
      if ("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/secp521r1"[iVar13] ==
          bVar2) break;
      iVar13 = iVar12;
    } while (iVar12 < 0x40);
    if ((int)uVar14 <= iVar13) goto LAB_00472664;
    uVar4 = (uint)pvVar5 >> 0xc & 0xfff;
    uVar6 = ((uint)pvVar5 & 0xfff) + 1;
    if (uVar4 < uVar6) {
      if (uVar6 < 0x181) {
        if (uVar4 < uVar6) {
          pvVar5 = realloc(*param_2,uVar6 * 4);
          if (pvVar5 == (void *)0x0) goto LAB_00472574;
          pvVar11 = param_2[2];
          *param_2 = pvVar5;
          param_2[2] = (void *)((uint)pvVar11 & 0xff000fff | (uVar6 & 0xfff) << 0xc);
          for (uVar4 = (uint)pvVar11 >> 0xc & 0xfff; uVar4 < (uVar6 & 0xfff);
              uVar4 = uVar4 + 1 & 0xffff) {
            *(undefined4 *)(uVar4 * 4 + (int)pvVar5) = 0;
          }
        }
        pvVar5 = param_2[2];
        goto LAB_004723d0;
      }
    }
    else {
LAB_004723d0:
      uVar4 = (uint)param_2[2] & 0xfff;
      pvVar11 = (void *)((uint)pvVar5 & 0xfffff000 | uVar4);
      param_2[2] = pvVar11;
      uVar6 = 0;
      iVar12 = 0;
      if (uVar4 != 0) {
        pvVar10 = *param_2;
        do {
          iVar9 = iVar12 * 4;
          iVar12 = (iVar12 + 1) * 0x10000 >> 0x10;
          lVar3 = (ulonglong)*(uint *)(iVar9 + (int)pvVar10) * (ulonglong)uVar14 + (ulonglong)uVar6;
          uVar6 = (uint)((ulonglong)lVar3 >> 0x20);
          *(int *)(iVar9 + (int)pvVar10) = (int)lVar3;
        } while (iVar12 < (int)uVar4);
      }
      if ((uVar6 != 0) && (uVar4 != 0x180)) {
        param_2[2] = (void *)((uint)pvVar5 & 0xfffff000 | uVar4 + 1 & 0xfff);
        pvVar11 = param_2[2];
        *(uint *)(uVar4 * 4 + (int)*param_2) = uVar6;
        iVar12 = (iVar12 + 1) * 0x10000 >> 0x10;
      }
      if (iVar12 < (int)((uint)pvVar5 & 0xfff)) {
        puVar8 = (undefined4 *)(iVar12 * 4 + (int)*param_2);
        do {
          iVar12 = (iVar12 + 1) * 0x10000 >> 0x10;
          *puVar8 = 0;
          puVar8 = puVar8 + 1;
        } while (iVar12 < (int)((uint)pvVar5 & 0xfff));
      }
      if (((uint)pvVar11 & 0xfff) != 0) {
        iVar12 = *(int *)((int)*param_2 + ((uint)pvVar11 & 0xfff) * 4 + -4);
        while (iVar12 == 0) {
          uVar6 = ((uint)pvVar11 & 0xfff) - 1 & 0xfff;
          pvVar11 = (void *)((uint)pvVar11 & 0xfffff000 | uVar6);
          param_2[2] = pvVar11;
          if (uVar6 == 0) break;
          iVar12 = *(int *)((int)*param_2 + uVar6 * 4 + -4);
        }
      }
      if (((uint)pvVar11 & 0xfff) == 0) {
        param_2[2] = (void *)((uint)pvVar11 & 0xfeffffff);
      }
    }
LAB_00472574:
    iVar12 = pstm_init_size(param_1,local_38,4);
    if (iVar12 == 0) {
      uVar4 = (local_30 & 0xfeffffff) >> 0xc & 0xfff;
      uVar6 = 0;
      piVar7 = local_38[0];
      if (uVar4 != 0) {
        do {
          uVar6 = uVar6 + 1 & 0xffff;
          *piVar7 = 0;
          piVar7 = piVar7 + 1;
        } while (uVar6 < uVar4);
      }
      *local_38[0] = iVar13;
      local_30 = local_30 & 0xfefff000 | (uint)(iVar13 != 0);
      pstm_add(param_2,local_38,param_2);
      pstm_clear(local_38);
    }
    param_4 = param_4 + -1;
    param_3 = param_3 + 1;
    if (param_4 == 0) {
      pvVar5 = param_2[2];
      goto LAB_00472664;
    }
    pvVar5 = param_2[2];
    if (uVar14 < 0x24) goto LAB_00472348;
LAB_00472650:
    bVar2 = *param_3;
  } while( true );
}



int pstm_sub(int *param_1,int *param_2,int param_3)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  uint *puVar6;
  
  uVar3 = (uint)param_1[2] >> 0x18 & 1;
  if (uVar3 == ((uint)param_2[2] >> 0x18 & 1)) {
    uVar4 = param_1[2] & 0xfff;
    uVar2 = param_2[2] & 0xfff;
    iVar1 = 1;
    if ((uVar4 <= uVar2) && (iVar1 = -1, uVar2 <= uVar4)) {
      puVar5 = (uint *)(*param_2 + uVar4 * 4);
      puVar6 = (uint *)(*param_1 + uVar4 * 4);
      uVar2 = 0;
      if (uVar4 != 0) {
        do {
          puVar6 = puVar6 + -1;
          puVar5 = puVar5 + -1;
          uVar2 = uVar2 + 1 & 0xffff;
          if (*puVar5 < *puVar6) {
            iVar1 = 1;
            goto LAB_00472890;
          }
          if (*puVar6 < *puVar5) {
            iVar1 = -1;
            goto LAB_00472890;
          }
        } while (uVar2 < uVar4);
      }
      iVar1 = 0;
    }
LAB_00472890:
    if (iVar1 == -1) {
      *(uint *)(param_3 + 8) = *(uint *)(param_3 + 8) & 0xfeffffff | (uVar3 ^ 1) << 0x18;
      iVar1 = pstm_sub_s(param_2,param_1,param_3,uVar3,&_gp);
    }
    else {
      *(uint *)(param_3 + 8) = *(uint *)(param_3 + 8) & 0xfeffffff | uVar3 << 0x18;
      iVar1 = pstm_sub_s(param_1,param_2,param_3);
    }
  }
  else {
    *(uint *)(param_3 + 8) = *(uint *)(param_3 + 8) & 0xfeffffff | uVar3 << 0x18;
    iVar1 = FUN_00471ccc();
  }
  if (iVar1 == 0) {
    iVar1 = 0;
  }
  return iVar1;
}



undefined4 pstm_montgomery_setup(uint **param_1,int *param_2)

{
  uint uVar1;
  int iVar2;
  undefined4 uVar3;
  
  uVar1 = **param_1;
  uVar3 = 0xfffffffa;
  iVar2 = (uVar1 + 2 & 4) * 2 + uVar1;
  if (((uVar1 ^ 1) & 1) == 0) {
    uVar3 = 0;
    iVar2 = iVar2 * (2 - uVar1 * iVar2);
    iVar2 = iVar2 * (2 - uVar1 * iVar2);
    *param_2 = -(iVar2 * (2 - uVar1 * iVar2));
  }
  return uVar3;
}



// WARNING: Removing unreachable block (ram,0x00472e0c)

undefined4 pstm_montgomery_calc_normalization(uint **param_1,int *param_2)

{
  bool bVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint *puVar8;
  uint *puVar9;
  uint *puVar10;
  uint *puVar11;
  int iVar12;
  uint uVar13;
  
  uVar6 = param_2[2] & 0xfff;
  uVar2 = 0;
  if (uVar6 != 0) {
    uVar2 = 0;
    for (uVar6 = *(uint *)(uVar6 * 4 + *param_2 + -4); uVar6 != 0; uVar6 = uVar6 >> 1) {
      uVar2 = (int)(short)uVar2 + 1;
    }
    uVar2 = uVar2 & 0xffff;
  }
  uVar2 = uVar2 & 0x1f;
  uVar6 = param_2[2] & 0xfff;
  if (uVar2 == 0) {
    uVar2 = 0x20;
  }
  if (uVar6 < 2) {
    puVar8 = *param_1;
    uVar6 = ((uint)param_1[2] & 0xfeffffff) >> 0xc & 0xfff;
    param_1[2] = (uint *)((uint)param_1[2] & 0xfefff000);
    uVar2 = 0;
    puVar4 = puVar8;
    if (uVar6 != 0) {
      do {
        uVar2 = uVar2 + 1 & 0xffff;
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      } while (uVar2 < uVar6);
    }
    *puVar8 = 1;
    param_1[2] = (uint *)((uint)param_1[2] & 0xfffff000 | 1);
    uVar2 = 1;
  }
  else {
    puVar8 = *param_1;
    iVar12 = (uVar6 * 0x20 + uVar2 + -0x21) * 0x10000;
    uVar3 = ((uint)param_1[2] & 0xfeffffff) >> 0xc & 0xfff;
    uVar13 = iVar12 >> 0x10;
    param_1[2] = (uint *)((uint)param_1[2] & 0xfefff000);
    uVar6 = 0;
    puVar4 = puVar8;
    if (uVar3 != 0) {
      do {
        uVar6 = uVar6 + 1 & 0xffff;
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      } while (uVar6 < uVar3);
    }
    if (-1 < (int)uVar13) {
      uVar6 = iVar12 >> 0x15 & 0xffff;
      if (0x17f < uVar6) {
        return 0xfff7;
      }
      uVar7 = uVar6 + 1 & 0xfff;
      uVar3 = (uint)param_1[2] >> 0xc & 0xfff;
      param_1[2] = (uint *)((uint)param_1[2] & 0xfffff000 | uVar7);
      if (uVar3 < uVar7) {
        if (0x180 < uVar7) {
          return 0xfff8;
        }
        if (uVar3 < uVar7) {
          puVar4 = (uint *)realloc(puVar8,uVar7 << 2);
          if (puVar4 == (uint *)0x0) {
            return 0xfff8;
          }
          uVar3 = (uint)param_1[2] >> 0xc & 0xfff;
          *param_1 = puVar4;
          param_1[2] = (uint *)((uint)param_1[2] & 0xff000fff | uVar7 << 0xc);
          if (uVar3 < uVar7) {
            do {
              uVar5 = uVar3 + 1 & 0xffff;
              puVar4[uVar3] = 0;
              uVar3 = uVar5;
            } while (uVar5 < uVar7);
            puVar8 = *param_1;
            goto LAB_00472b1c;
          }
        }
        puVar8 = *param_1;
      }
LAB_00472b1c:
      uVar2 = uVar2 - 1 & 0xffff;
      puVar8[uVar6] = 1 << (uVar13 & 0x1f);
      if (0x1f < uVar2) {
        return 0;
      }
      goto LAB_00472bfc;
    }
  }
  uVar2 = uVar2 - 1 & 0xffff;
  if (0x1f < uVar2) {
    return 0;
  }
LAB_00472bfc:
  do {
    puVar4 = param_1[2];
    uVar3 = (uint)puVar4 >> 0xc & 0xfff;
    uVar6 = ((uint)puVar4 & 0xfff) + 1;
    if (uVar3 < uVar6) {
      if (0x180 < uVar6) {
        return 0xfffffff8;
      }
      if (uVar3 < uVar6) {
        puVar4 = (uint *)realloc(*param_1,uVar6 * 4);
        if (puVar4 == (uint *)0x0) {
          return 0xfffffff8;
        }
        puVar8 = param_1[2];
        *param_1 = puVar4;
        param_1[2] = (uint *)((uint)puVar8 & 0xff000fff | (uVar6 & 0xfff) << 0xc);
        for (uVar3 = (uint)puVar8 >> 0xc & 0xfff; uVar3 < (uVar6 & 0xfff);
            uVar3 = uVar3 + 1 & 0xffff) {
          puVar4[uVar3] = 0;
        }
      }
      puVar4 = param_1[2];
    }
    uVar6 = (uint)param_1[2] & 0xfff;
    puVar10 = (uint *)((uint)puVar4 & 0xfffff000 | uVar6);
    puVar11 = *param_1;
    param_1[2] = puVar10;
    uVar3 = 0;
    iVar12 = 0;
    puVar8 = puVar11;
    puVar9 = puVar11;
    if (uVar6 == 0) {
LAB_00472cdc:
      uVar6 = (uint)puVar10 & 0xfff;
    }
    else {
      do {
        uVar13 = *puVar8;
        iVar12 = (iVar12 + 1) * 0x10000 >> 0x10;
        *puVar9 = uVar13 << 1 | uVar3;
        puVar8 = puVar8 + 1;
        puVar9 = puVar9 + 1;
        uVar3 = -((int)uVar13 >> 0x1f);
      } while (iVar12 < (int)uVar6);
      if ((uVar3 != 0) && (uVar6 != 0x17f)) {
        puVar10 = (uint *)((uint)puVar4 & 0xfffff000 | uVar6 + 1 & 0xfff);
        *puVar9 = 1;
        param_1[2] = puVar10;
        goto LAB_00472cdc;
      }
    }
    uVar3 = (uint)(short)uVar6;
    bVar1 = uVar3 < ((uint)puVar4 & 0xfff);
    puVar11 = puVar11 + uVar6;
    while (bVar1) {
      uVar3 = (int)((uVar3 + 1) * 0x10000) >> 0x10;
      *puVar11 = 0;
      bVar1 = (int)uVar3 < (int)((uint)puVar4 & 0xfff);
      puVar11 = puVar11 + 1;
    }
    param_1[2] = (uint *)((uint)param_1[2] & 0xfeffffff | (uint)puVar10 & 0x1000000);
    uVar6 = (uint)param_1[2] & 0xfff;
    iVar12 = 1;
    if ((uVar6 <= (param_2[2] & 0xfffU)) && (iVar12 = -1, (param_2[2] & 0xfffU) <= uVar6)) {
      puVar8 = *param_1 + uVar6;
      puVar4 = (uint *)(*param_2 + uVar6 * 4);
      uVar3 = 0;
      if (uVar6 != 0) {
        do {
          puVar8 = puVar8 + -1;
          puVar4 = puVar4 + -1;
          uVar3 = uVar3 + 1 & 0xffff;
          if (*puVar4 < *puVar8) {
            iVar12 = 1;
            goto LAB_00472d48;
          }
          if (*puVar8 < *puVar4) {
            iVar12 = -1;
            goto LAB_00472d48;
          }
        } while (uVar3 < uVar6);
      }
      iVar12 = 0;
    }
LAB_00472d48:
    if ((iVar12 != -1) && (iVar12 = pstm_sub_s(param_1,param_2,param_1), iVar12 != 0)) {
      return 0xfffffff8;
    }
    uVar2 = uVar2 + 1 & 0xffff;
    if (0x1f < uVar2) {
      return 0;
    }
  } while( true );
}



undefined4 FUN_00472f30(void **param_1,short param_2,void **param_3)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  void *pvVar4;
  uint *puVar5;
  uint uVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  void *pvVar10;
  uint uVar11;
  int iVar12;
  
  iVar12 = (int)param_2;
  if (param_1 != param_3) {
    pvVar10 = param_3[2];
    pvVar4 = param_1[2];
    uVar6 = (uint)pvVar10 >> 0xc & 0xfff;
    uVar2 = (uint)pvVar4 & 0xfff;
    if (uVar6 < uVar2) {
      if (0x180 < uVar2) {
        return 0xfffffff8;
      }
      if (uVar6 < uVar2) {
        pvVar4 = realloc(*param_3,uVar2 << 2);
        if (pvVar4 == (void *)0x0) {
          return 0xfffffff8;
        }
        uVar6 = (uint)param_3[2] >> 0xc & 0xfff;
        *param_3 = pvVar4;
        param_3[2] = (void *)((uint)param_3[2] & 0xff000fff | uVar2 << 0xc);
        if (uVar6 < uVar2) {
          do {
            iVar1 = uVar6 * 4;
            uVar6 = uVar6 + 1 & 0xffff;
            *(undefined4 *)(iVar1 + (int)pvVar4) = 0;
          } while (uVar6 < uVar2);
          pvVar10 = param_3[2];
          pvVar4 = param_1[2];
          uVar2 = (uint)pvVar4 & 0xfff;
          goto LAB_00472f90;
        }
      }
      pvVar10 = param_3[2];
      pvVar4 = param_1[2];
      uVar2 = (uint)pvVar4 & 0xfff;
    }
    else {
      uVar2 = (uint)pvVar4 & 0xfff;
    }
LAB_00472f90:
    puVar7 = (undefined4 *)*param_1;
    puVar8 = (undefined4 *)*param_3;
    uVar6 = 0;
    for (uVar3 = uVar2; uVar3 != 0; uVar3 = uVar3 - 1) {
      *puVar8 = *puVar7;
      puVar7 = puVar7 + 1;
      puVar8 = puVar8 + 1;
      uVar6 = uVar2;
    }
    if (uVar6 < ((uint)pvVar10 & 0xfff)) {
      iVar1 = ((uint)pvVar10 & 0xfff) - uVar6;
      do {
        iVar1 = iVar1 + -1;
        *puVar8 = 0;
        puVar8 = puVar8 + 1;
      } while (iVar1 != 0);
    }
    pvVar10 = param_3[2];
    param_3[2] = (void *)((uint)pvVar10 & 0xfffff000 | (uint)pvVar4 & 0xfff);
    param_3[2] = (void *)((uint)pvVar10 & 0xfefff000 | (uint)pvVar4 & 0xfff |
                         (*(byte *)((int)param_1 + 0xb) & 1) << 0x18);
  }
  if (0x1f < iVar12) {
    iVar1 = iVar12;
    if (iVar12 < 0) {
      iVar1 = iVar12 + 0x1f;
    }
    uVar2 = iVar1 >> 5 & 0xffff;
    if (uVar2 != 0) {
      pvVar4 = param_3[2];
      uVar3 = (uint)pvVar4 >> 0xc & 0xfff;
      uVar6 = ((uint)pvVar4 & 0xfff) + uVar2;
      uVar11 = (uint)pvVar4 & 0xfff;
      if (uVar3 < uVar6) {
        uVar11 = uVar6 & 0xffff;
        if (0x180 < uVar11) {
          return 0xfffffff8;
        }
        if (uVar3 < uVar11) {
          pvVar4 = realloc(*param_3,uVar11 << 2);
          if (pvVar4 == (void *)0x0) {
            return 0xfffffff8;
          }
          uVar6 = uVar6 & 0xfff;
          uVar3 = (uint)param_3[2] >> 0xc & 0xfff;
          *param_3 = pvVar4;
          param_3[2] = (void *)((uint)param_3[2] & 0xff000fff | uVar6 << 0xc);
          if (uVar3 < uVar6) {
            do {
              iVar1 = uVar3 * 4;
              uVar3 = uVar3 + 1 & 0xffff;
              *(undefined4 *)(iVar1 + (int)pvVar4) = 0;
            } while (uVar3 < uVar6);
            pvVar4 = param_3[2];
            uVar11 = (uint)pvVar4 & 0xfff;
            goto LAB_0047308c;
          }
        }
        pvVar4 = param_3[2];
        uVar11 = (uint)pvVar4 & 0xfff;
      }
LAB_0047308c:
      uVar6 = uVar11 + uVar2 & 0xfff;
      puVar9 = (undefined4 *)*param_3;
      puVar7 = puVar9 + uVar6;
      puVar8 = puVar7 + -uVar2;
      param_3[2] = (void *)((uint)pvVar4 & 0xfffff000 | uVar6);
      while (uVar6 = uVar6 - 1 & 0xffff, uVar2 <= uVar6) {
        puVar8 = puVar8 + -1;
        puVar7 = puVar7 + -1;
        *puVar7 = *puVar8;
      }
      uVar6 = 0;
      if (uVar2 != 0) {
        do {
          uVar6 = uVar6 + 1 & 0xffff;
          *puVar9 = 0;
          puVar9 = puVar9 + 1;
        } while (uVar6 < uVar2);
      }
    }
  }
  iVar1 = iVar12;
  if (iVar12 < 0) {
    iVar1 = iVar12 + 0x1f;
  }
  uVar2 = (iVar12 + (iVar1 >> 5) * -0x20) * 0x10000 >> 0x10;
  if (uVar2 == 0) {
    pvVar4 = param_3[2];
  }
  else {
    pvVar4 = param_3[2];
    uVar3 = 0;
    uVar6 = 0;
    if (((uint)pvVar4 & 0xfff) != 0) {
      pvVar10 = *param_3;
      do {
        puVar5 = (uint *)(uVar6 * 4 + (int)pvVar10);
        uVar11 = *puVar5;
        uVar6 = uVar6 + 1 & 0xffff;
        *puVar5 = (uVar11 << (uVar2 & 0x1f)) + uVar3;
        uVar3 = uVar11 >> (0x20 - uVar2 & 0x1f);
      } while (uVar6 < ((uint)pvVar4 & 0xfff));
      uVar2 = (uint)pvVar4 & 0xfff;
      if ((uVar3 == 0) || (0x17f < uVar6)) goto LAB_00473210;
      uVar2 = (uint)pvVar4 & 0xfff;
      uVar6 = (uint)pvVar4 & 0xfff;
      if (uVar2 == ((uint)pvVar4 >> 0xc & 0xfff)) {
        uVar6 = uVar2 + 1;
        if (0x180 < uVar6) {
          return 0xfffffff8;
        }
        if (uVar2 < uVar6) {
          pvVar4 = realloc(*param_3,uVar6 * 4);
          if (pvVar4 == (void *)0x0) {
            return 0xfffffff8;
          }
          uVar6 = uVar6 & 0xfff;
          uVar2 = (uint)param_3[2] >> 0xc & 0xfff;
          *param_3 = pvVar4;
          param_3[2] = (void *)((uint)param_3[2] & 0xff000fff | uVar6 << 0xc);
          if (uVar2 < uVar6) {
            do {
              iVar12 = uVar2 * 4;
              uVar2 = uVar2 + 1 & 0xffff;
              *(undefined4 *)(iVar12 + (int)pvVar4) = 0;
            } while (uVar2 < uVar6);
            pvVar4 = param_3[2];
            uVar6 = (uint)pvVar4 & 0xfff;
            goto LAB_004731ac;
          }
        }
        pvVar4 = param_3[2];
        uVar6 = (uint)pvVar4 & 0xfff;
      }
LAB_004731ac:
      pvVar4 = (void *)((uint)pvVar4 & 0xfffff000 | uVar6 + 1 & 0xfff);
      param_3[2] = pvVar4;
      *(uint *)(uVar6 * 4 + (int)*param_3) = uVar3;
    }
  }
  uVar2 = (uint)pvVar4 & 0xfff;
LAB_00473210:
  if (uVar2 != 0) {
    iVar12 = *(int *)((int)*param_3 + uVar2 * 4 + -4);
    while (iVar12 == 0) {
      uVar2 = ((uint)pvVar4 & 0xfff) - 1 & 0xfff;
      pvVar4 = (void *)((uint)pvVar4 & 0xfffff000 | uVar2);
      param_3[2] = pvVar4;
      if (uVar2 == 0) break;
      iVar12 = *(int *)((int)*param_3 + uVar2 * 4 + -4);
    }
  }
  if (((uint)pvVar4 & 0xfff) == 0) {
    param_3[2] = (void *)((uint)pvVar4 & 0xfeffffff);
  }
  return 0;
}



undefined4
pstm_div_2d(undefined4 param_1,void **param_2,short param_3,void **param_4,void **param_5)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  void *pvVar4;
  uint uVar5;
  undefined4 *puVar6;
  uint uVar7;
  undefined4 *puVar8;
  void *pvVar9;
  uint *puVar10;
  int iVar11;
  undefined4 uVar12;
  int iVar13;
  uint uVar14;
  
  uVar14 = (uint)param_3;
  if ((int)uVar14 < 1) {
    if (param_2 == param_4) goto LAB_00473a7c;
    pvVar9 = param_4[2];
    pvVar4 = param_2[2];
    uVar2 = (uint)pvVar9 >> 0xc & 0xfff;
    uVar14 = (uint)pvVar4 & 0xfff;
    if (uVar2 < uVar14) {
      if (0x180 < uVar14) {
        return 0xfffffff8;
      }
      if (uVar2 < uVar14) {
        pvVar4 = realloc(*param_4,uVar14 << 2);
        if (pvVar4 == (void *)0x0) {
          return 0xfffffff8;
        }
        uVar2 = (uint)param_4[2] >> 0xc & 0xfff;
        *param_4 = pvVar4;
        param_4[2] = (void *)((uint)param_4[2] & 0xff000fff | uVar14 << 0xc);
        if (uVar2 < uVar14) {
          do {
            iVar1 = uVar2 * 4;
            uVar2 = uVar2 + 1 & 0xffff;
            *(undefined4 *)(iVar1 + (int)pvVar4) = 0;
          } while (uVar2 < uVar14);
          pvVar9 = param_4[2];
          pvVar4 = param_2[2];
          goto LAB_004739f0;
        }
      }
      pvVar9 = param_4[2];
      pvVar4 = param_2[2];
    }
LAB_004739f0:
    puVar6 = (undefined4 *)*param_2;
    puVar8 = (undefined4 *)*param_4;
    uVar14 = 0;
    for (uVar2 = (uint)pvVar4 & 0xfff; uVar2 != 0; uVar2 = uVar2 - 1) {
      *puVar8 = *puVar6;
      puVar6 = puVar6 + 1;
      puVar8 = puVar8 + 1;
      uVar14 = (uint)pvVar4 & 0xfff;
    }
    if (uVar14 < ((uint)pvVar9 & 0xfff)) {
      iVar1 = ((uint)pvVar9 & 0xfff) - uVar14;
      do {
        iVar1 = iVar1 + -1;
        *puVar8 = 0;
        puVar8 = puVar8 + 1;
      } while (iVar1 != 0);
    }
    pvVar9 = param_4[2];
    param_4[2] = (void *)((uint)pvVar9 & 0xfffff000 | (uint)pvVar4 & 0xfff);
    param_4[2] = (void *)((uint)pvVar9 & 0xfefff000 | (uint)pvVar4 & 0xfff |
                         (*(byte *)((int)param_2 + 0xb) & 1) << 0x18);
LAB_00473a7c:
    if (param_5 != (void **)0x0) {
      uVar2 = ((uint)param_5[2] & 0xfeffffff) >> 0xc & 0xfff;
      param_5[2] = (void *)((uint)param_5[2] & 0xfefff000);
      puVar6 = (undefined4 *)*param_5;
      uVar14 = 0;
      if (uVar2 != 0) {
        do {
          uVar14 = uVar14 + 1 & 0xffff;
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        } while (uVar14 < uVar2);
      }
    }
    return 0;
  }
  if (param_2 != param_4) {
    pvVar9 = param_4[2];
    pvVar4 = param_2[2];
    uVar5 = (uint)pvVar9 >> 0xc & 0xfff;
    uVar2 = (uint)pvVar4 & 0xfff;
    if (uVar5 < uVar2) {
      if (0x180 < uVar2) {
LAB_00473c0c:
        uVar12 = 0xfffffff8;
        goto LAB_004736b0;
      }
      if (uVar5 < uVar2) {
        pvVar4 = realloc(*param_4,uVar2 << 2);
        if (pvVar4 == (void *)0x0) goto LAB_00473c0c;
        uVar5 = (uint)param_4[2] >> 0xc & 0xfff;
        *param_4 = pvVar4;
        param_4[2] = (void *)((uint)param_4[2] & 0xff000fff | uVar2 << 0xc);
        if (uVar5 < uVar2) {
          do {
            iVar1 = uVar5 * 4;
            uVar5 = uVar5 + 1 & 0xffff;
            *(undefined4 *)(iVar1 + (int)pvVar4) = 0;
          } while (uVar5 < uVar2);
          pvVar9 = param_4[2];
          pvVar4 = param_2[2];
          uVar2 = (uint)pvVar4 & 0xfff;
          goto LAB_00473504;
        }
      }
      pvVar9 = param_4[2];
      pvVar4 = param_2[2];
      uVar2 = (uint)pvVar4 & 0xfff;
    }
    else {
      uVar2 = (uint)pvVar4 & 0xfff;
    }
LAB_00473504:
    puVar6 = (undefined4 *)*param_2;
    puVar8 = (undefined4 *)*param_4;
    uVar5 = 0;
    for (uVar3 = uVar2; uVar3 != 0; uVar3 = uVar3 - 1) {
      *puVar8 = *puVar6;
      puVar6 = puVar6 + 1;
      puVar8 = puVar8 + 1;
      uVar5 = uVar2;
    }
    if (uVar5 < ((uint)pvVar9 & 0xfff)) {
      iVar1 = ((uint)pvVar9 & 0xfff) - uVar5;
      do {
        iVar1 = iVar1 + -1;
        *puVar8 = 0;
        puVar8 = puVar8 + 1;
      } while (iVar1 != 0);
    }
    pvVar9 = param_4[2];
    param_4[2] = (void *)((uint)pvVar9 & 0xfffff000 | (uint)pvVar4 & 0xfff);
    param_4[2] = (void *)((uint)pvVar9 & 0xfefff000 | (uint)pvVar4 & 0xfff |
                         (*(byte *)((int)param_2 + 0xb) & 1) << 0x18);
  }
  if ((int)uVar14 < 0x20) {
LAB_00473904:
    pvVar9 = param_4[2];
LAB_00473908:
    if ((int)uVar14 < 0) goto LAB_0047360c;
LAB_00473910:
    uVar5 = (int)((uVar14 + ((int)uVar14 >> 5) * -0x20) * 0x10000) >> 0x10;
    uVar2 = (uint)pvVar9 & 0xfff;
    if (uVar5 != 0) goto LAB_00473930;
  }
  else {
    uVar2 = uVar14;
    if ((int)uVar14 < 0) {
      uVar2 = uVar14 + 0x1f;
    }
    pvVar4 = param_4[2];
    uVar2 = (int)uVar2 >> 5 & 0xffff;
    if (uVar2 < ((uint)pvVar4 & 0xfff)) {
      iVar1 = ((uint)pvVar4 & 0xfff) - uVar2;
      uVar5 = 0;
      if (0 < iVar1) {
        pvVar9 = *param_4;
        do {
          iVar13 = uVar5 + uVar2;
          iVar11 = uVar5 * 4;
          uVar5 = uVar5 + 1 & 0xffff;
          *(undefined4 *)(iVar11 + (int)pvVar9) = *(undefined4 *)(iVar13 * 4 + (int)pvVar9);
        } while ((int)uVar5 < iVar1);
      }
      if (uVar5 < ((uint)pvVar4 & 0xfff)) {
        pvVar9 = *param_4;
        do {
          iVar1 = uVar5 * 4;
          uVar5 = uVar5 + 1 & 0xffff;
          *(undefined4 *)(iVar1 + (int)pvVar9) = 0;
        } while (uVar5 < ((uint)pvVar4 & 0xfff));
      }
      uVar2 = ((uint)pvVar4 & 0xfff) - uVar2 & 0xfff;
      param_4[2] = (void *)((uint)pvVar4 & 0xfffff000 | uVar2);
      if (uVar2 != 0) {
        iVar1 = *(int *)((int)*param_4 + uVar2 * 4 + -4);
        while (iVar1 == 0) {
          uVar2 = ((uint)param_4[2] & 0xfff) - 1 & 0xfff;
          param_4[2] = (void *)((uint)param_4[2] & 0xfffff000 | uVar2);
          if (uVar2 == 0) break;
          iVar1 = *(int *)((int)*param_4 + uVar2 * 4 + -4);
        }
      }
      pvVar9 = param_4[2];
      if (((uint)pvVar9 & 0xfff) == 0) {
        pvVar9 = (void *)((uint)pvVar9 & 0xfeffffff);
        param_4[2] = pvVar9;
      }
      goto LAB_00473908;
    }
    pvVar9 = (void *)((uint)pvVar4 & 0xfefff000);
    uVar5 = ((uint)pvVar4 & 0xfeffffff) >> 0xc & 0xfff;
    param_4[2] = pvVar9;
    puVar6 = (undefined4 *)*param_4;
    uVar2 = 0;
    if (uVar5 == 0) goto LAB_00473904;
    do {
      uVar2 = uVar2 + 1 & 0xffff;
      *puVar6 = 0;
      puVar6 = puVar6 + 1;
    } while (uVar2 < uVar5);
    if (-1 < (int)uVar14) goto LAB_00473910;
LAB_0047360c:
    uVar5 = (int)((uVar14 + ((int)(uVar14 + 0x1f) >> 5) * -0x20) * 0x10000) >> 0x10;
    if (uVar5 == 0) {
      uVar2 = (uint)pvVar9 & 0xfff;
    }
    else {
LAB_00473930:
      uVar2 = (uint)pvVar9 & 0xfff;
      puVar10 = (uint *)((int)*param_4 + uVar2 * 4);
      uVar3 = 0;
      while( true ) {
        uVar2 = (int)((uVar2 - 1) * 0x10000) >> 0x10;
        puVar10 = puVar10 + -1;
        if ((int)uVar2 < 0) break;
        uVar7 = *puVar10;
        *puVar10 = uVar7 >> (uVar5 & 0x1f) | uVar3 << (0x20 - uVar5 & 0x1f);
        uVar3 = uVar7 & (1 << (uVar5 & 0x1f)) - 1U;
      }
      uVar2 = (uint)pvVar9 & 0xfff;
    }
  }
  if (uVar2 != 0) {
    iVar1 = *(int *)((int)*param_4 + uVar2 * 4 + -4);
    while (iVar1 == 0) {
      uVar2 = ((uint)pvVar9 & 0xfff) - 1 & 0xfff;
      pvVar9 = (void *)((uint)pvVar9 & 0xfffff000 | uVar2);
      param_4[2] = pvVar9;
      if (uVar2 == 0) break;
      iVar1 = *(int *)((int)*param_4 + uVar2 * 4 + -4);
    }
  }
  uVar12 = 0;
  if (((uint)pvVar9 & 0xfff) == 0) {
    param_4[2] = (void *)((uint)pvVar9 & 0xfeffffff);
  }
LAB_004736b0:
  if (param_5 == (void **)0x0) {
    return uVar12;
  }
  if ((int)uVar14 < 1) {
    uVar2 = ((uint)param_5[2] & 0xfeffffff) >> 0xc & 0xfff;
    param_5[2] = (void *)((uint)param_5[2] & 0xfefff000);
    puVar6 = (undefined4 *)*param_5;
    uVar14 = 0;
    if (uVar2 != 0) {
      do {
        uVar14 = uVar14 + 1 & 0xffff;
        *puVar6 = 0;
        puVar6 = puVar6 + 1;
      } while (uVar14 < uVar2);
      return uVar12;
    }
    return uVar12;
  }
  if (param_2 != param_5) {
    pvVar9 = param_5[2];
    pvVar4 = param_2[2];
    uVar5 = (uint)pvVar9 >> 0xc & 0xfff;
    uVar2 = (uint)pvVar4 & 0xfff;
    if (uVar5 < uVar2) {
      if (0x180 < uVar2) {
        return 0xfffffff8;
      }
      if (uVar5 < uVar2) {
        pvVar4 = realloc(*param_5,uVar2 << 2);
        if (pvVar4 == (void *)0x0) {
          return 0xfffffff8;
        }
        pvVar9 = param_5[2];
        *param_5 = pvVar4;
        param_5[2] = (void *)((uint)pvVar9 & 0xff000fff | uVar2 << 0xc);
        for (uVar5 = (uint)pvVar9 >> 0xc & 0xfff; uVar5 < uVar2; uVar5 = uVar5 + 1 & 0xffff) {
          *(undefined4 *)(uVar5 * 4 + (int)pvVar4) = 0;
        }
      }
      pvVar4 = param_2[2];
      pvVar9 = param_5[2];
    }
    puVar6 = (undefined4 *)*param_2;
    puVar8 = (undefined4 *)*param_5;
    uVar5 = 0;
    for (uVar2 = (uint)pvVar4 & 0xfff; uVar2 != 0; uVar2 = uVar2 - 1) {
      *puVar8 = *puVar6;
      puVar6 = puVar6 + 1;
      puVar8 = puVar8 + 1;
      uVar5 = (uint)pvVar4 & 0xfff;
    }
    iVar1 = ((uint)pvVar9 & 0xfff) - uVar5;
    if (uVar5 < ((uint)pvVar9 & 0xfff)) {
      do {
        iVar1 = iVar1 + -1;
        *puVar8 = 0;
        puVar8 = puVar8 + 1;
      } while (iVar1 != 0);
    }
    pvVar9 = param_5[2];
    param_5[2] = (void *)((uint)pvVar9 & 0xfffff000 | (uint)pvVar4 & 0xfff);
    param_5[2] = (void *)((uint)pvVar9 & 0xfefff000 | (uint)pvVar4 & 0xfff |
                         (*(byte *)((int)param_2 + 0xb) & 1) << 0x18);
  }
  if ((int)uVar14 < (int)(((uint)param_2[2] & 0xfff) << 5)) {
    uVar2 = uVar14;
    if ((int)uVar14 < 0) {
      uVar2 = uVar14 + 0x1f;
    }
    uVar2 = (int)uVar2 >> 5;
    if ((uVar14 & 0x1f) != 0) {
      uVar2 = uVar2 + 1;
    }
    uVar2 = uVar2 & 0xffff;
    pvVar4 = param_5[2];
    if (uVar2 < ((uint)pvVar4 & 0xfff)) {
      pvVar9 = *param_5;
      do {
        iVar1 = uVar2 * 4;
        uVar2 = uVar2 + 1 & 0xffff;
        *(undefined4 *)(iVar1 + (int)pvVar9) = 0;
      } while (uVar2 < ((uint)pvVar4 & 0xfff));
    }
    else {
      pvVar9 = *param_5;
    }
    uVar2 = uVar14;
    if ((int)uVar14 < 0) {
      uVar2 = uVar14 + 0x1f;
    }
    puVar10 = (uint *)(((int)uVar2 >> 5) * 4 + (int)pvVar9);
    *puVar10 = *puVar10 & 0xffffffffU >> (-uVar14 & 0x1f);
    if (((uint)pvVar4 & 0xfff) != 0) {
      iVar1 = *(int *)((int)pvVar9 + ((uint)pvVar4 & 0xfff) * 4 + -4);
      while (iVar1 == 0) {
        uVar14 = ((uint)pvVar4 & 0xfff) - 1 & 0xfff;
        pvVar4 = (void *)((uint)pvVar4 & 0xfffff000 | uVar14);
        param_5[2] = pvVar4;
        if (uVar14 == 0) break;
        iVar1 = *(int *)((int)pvVar9 + uVar14 * 4 + -4);
      }
    }
    if (((uint)pvVar4 & 0xfff) == 0) {
      param_5[2] = (void *)((uint)pvVar4 & 0xfeffffff);
    }
  }
  return uVar12;
}



undefined4 pstm_div_2(int *param_1,void **param_2)

{
  bool bVar1;
  uint uVar2;
  uint uVar3;
  undefined4 *puVar4;
  void *pvVar5;
  uint uVar6;
  uint *puVar7;
  void *pvVar8;
  int iVar9;
  uint *puVar10;
  
  pvVar5 = param_2[2];
  uVar3 = param_1[2];
  uVar6 = (uint)pvVar5 >> 0xc & 0xfff;
  uVar2 = uVar3 & 0xfff;
  if (uVar6 < uVar2) {
    if (0x180 < uVar2) {
      return 0xfffffff8;
    }
    if (uVar6 < uVar2) {
      pvVar5 = realloc(*param_2,uVar2 << 2);
      if (pvVar5 == (void *)0x0) {
        return 0xfffffff8;
      }
      pvVar8 = param_2[2];
      *param_2 = pvVar5;
      param_2[2] = (void *)((uint)pvVar8 & 0xff000fff | uVar2 << 0xc);
      uVar3 = (uint)pvVar8 >> 0xc & 0xfff;
      while (uVar3 < uVar2) {
        uVar6 = uVar3 + 1 & 0xffff;
        *(undefined4 *)(uVar3 * 4 + (int)pvVar5) = 0;
        if (uVar2 <= uVar6) break;
        *(undefined4 *)(uVar6 * 4 + (int)pvVar5) = 0;
        uVar3 = uVar6 + 1 & 0xffff;
      }
    }
    pvVar5 = param_2[2];
    uVar3 = param_1[2];
  }
  uVar3 = uVar3 & 0xfff;
  param_2[2] = (void *)((uint)pvVar5 & 0xfffff000 | uVar3);
  pvVar8 = *param_2;
  puVar7 = (uint *)(*param_1 + uVar3 * 4);
  puVar10 = (uint *)((int)pvVar8 + uVar3 * 4);
  uVar2 = 0;
  while( true ) {
    puVar7 = puVar7 + -1;
    puVar10 = puVar10 + -1;
    uVar3 = (int)((uVar3 - 1) * 0x10000) >> 0x10;
    if ((int)uVar3 < 0) break;
    uVar6 = *puVar7;
    *puVar10 = uVar6 >> 1 | uVar2 << 0x1f;
    uVar2 = uVar6 & 1;
  }
  uVar3 = (uint)(short)((uint)param_2[2] & 0xfff);
  bVar1 = uVar3 < ((uint)pvVar5 & 0xfff);
  puVar4 = (undefined4 *)((int)pvVar8 + ((uint)param_2[2] & 0xfff) * 4);
  while (bVar1) {
    uVar3 = (int)((uVar3 + 1) * 0x10000) >> 0x10;
    *puVar4 = 0;
    bVar1 = (int)uVar3 < (int)((uint)pvVar5 & 0xfff);
    puVar4 = puVar4 + 1;
  }
  uVar3 = (uint)param_2[2] & 0xfff;
  param_2[2] = (void *)((uint)param_2[2] & 0xfeffffff | (*(byte *)((int)param_1 + 0xb) & 1) << 0x18)
  ;
  if (uVar3 != 0) {
    iVar9 = *(int *)((int)pvVar8 + uVar3 * 4 + -4);
    while (iVar9 == 0) {
      uVar3 = ((uint)param_2[2] & 0xfff) - 1 & 0xfff;
      param_2[2] = (void *)((uint)param_2[2] & 0xfffff000 | uVar3);
      if (uVar3 == 0) break;
      iVar9 = *(int *)((int)pvVar8 + uVar3 * 4 + -4);
    }
  }
  if (((uint)param_2[2] & 0xfff) == 0) {
    param_2[2] = (void *)((uint)param_2[2] & 0xfeffffff);
  }
  return 0;
}



int pstm_init_copy(undefined4 param_1,void **param_2,void **param_3,char param_4)

{
  int iVar1;
  uint uVar2;
  void *pvVar3;
  uint uVar4;
  undefined4 *puVar5;
  uint uVar6;
  undefined4 *puVar7;
  void *pvVar8;
  
  if (param_2 == param_3) {
    return 0;
  }
  uVar6 = (uint)param_3[2] >> 0xc & 0xfff;
  if ((param_4 != '\0') && (iVar1 = ((uint)param_3[2] & 0xfff) * 2, uVar6 <= iVar1 + 2U)) {
    uVar6 = iVar1 + 3;
  }
  iVar1 = pstm_init_size(param_1,param_2,uVar6);
  if (iVar1 != 0) {
    return iVar1;
  }
  if (param_3 == param_2) {
    return 0;
  }
  pvVar8 = param_2[2];
  pvVar3 = param_3[2];
  uVar4 = (uint)pvVar8 >> 0xc & 0xfff;
  uVar6 = (uint)pvVar3 & 0xfff;
  if (uVar4 < uVar6) {
    if (0x180 < uVar6) {
      return -8;
    }
    if (uVar4 < uVar6) {
      pvVar3 = realloc(*param_2,uVar6 << 2);
      if (pvVar3 == (void *)0x0) {
        return -8;
      }
      uVar4 = (uint)param_2[2] >> 0xc & 0xfff;
      *param_2 = pvVar3;
      param_2[2] = (void *)((uint)param_2[2] & 0xff000fff | uVar6 << 0xc);
      if (uVar4 < uVar6) {
        do {
          iVar1 = uVar4 * 4;
          uVar4 = uVar4 + 1 & 0xffff;
          *(undefined4 *)(iVar1 + (int)pvVar3) = 0;
        } while (uVar4 < uVar6);
        pvVar3 = param_3[2];
        pvVar8 = param_2[2];
        uVar6 = (uint)pvVar3 & 0xfff;
        goto LAB_0047416c;
      }
    }
    pvVar3 = param_3[2];
    pvVar8 = param_2[2];
    uVar6 = (uint)pvVar3 & 0xfff;
  }
  else {
    uVar6 = (uint)pvVar3 & 0xfff;
  }
LAB_0047416c:
  puVar5 = (undefined4 *)*param_3;
  puVar7 = (undefined4 *)*param_2;
  uVar4 = 0;
  for (uVar2 = uVar6; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar7 = *puVar5;
    puVar5 = puVar5 + 1;
    puVar7 = puVar7 + 1;
    uVar4 = uVar6;
  }
  iVar1 = ((uint)pvVar8 & 0xfff) - uVar4;
  if (uVar4 < ((uint)pvVar8 & 0xfff)) {
    do {
      iVar1 = iVar1 + -1;
      *puVar7 = 0;
      puVar7 = puVar7 + 1;
    } while (iVar1 != 0);
  }
  pvVar8 = param_2[2];
  param_2[2] = (void *)((uint)pvVar8 & 0xfffff000 | (uint)pvVar3 & 0xfff);
  param_2[2] = (void *)((uint)pvVar8 & 0xfefff000 | (uint)pvVar3 & 0xfff |
                       (*(byte *)((int)param_3 + 0xb) & 1) << 0x18);
  return 0;
}



// WARNING: Removing unreachable block (ram,0x00474d5c)
// WARNING: Removing unreachable block (ram,0x00474d70)

int pstm_div(undefined4 param_1,undefined4 **param_2,undefined4 **param_3,undefined4 *param_4,
            undefined4 **param_5)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 **ppuVar6;
  uint *puVar7;
  undefined4 *puVar8;
  uint *puVar9;
  uint uVar10;
  undefined4 *puVar11;
  byte bVar12;
  undefined4 *puVar13;
  short sVar14;
  undefined4 *local_80;
  undefined4 *local_7c;
  undefined4 *local_78;
  undefined4 *local_70 [2];
  uint local_68;
  undefined4 *local_60 [2];
  uint local_58;
  undefined4 *local_50;
  undefined4 *local_4c;
  undefined4 *local_48;
  undefined4 *local_40;
  undefined4 *local_3c;
  undefined4 *local_38;
  int local_30;
  int local_2c;
  
  uVar1 = (uint)param_3[2] & 0xfff;
  if (uVar1 == 0) {
    return -9;
  }
  puVar13 = param_2[2];
  uVar10 = (uint)puVar13 & 0xfff;
  iVar4 = 1;
  if ((uVar10 <= uVar1) && (iVar4 = -1, uVar1 <= uVar10)) {
    puVar9 = *param_2 + uVar10;
    puVar7 = *param_3 + uVar10;
    uVar1 = 0;
    if (uVar10 != 0) {
      do {
        puVar9 = puVar9 + -1;
        puVar7 = puVar7 + -1;
        uVar1 = uVar1 + 1 & 0xffff;
        if (*puVar7 < *puVar9) {
          iVar4 = 1;
          goto LAB_004743d8;
        }
        if (*puVar9 < *puVar7) {
          iVar4 = -1;
          goto LAB_004743d8;
        }
      } while (uVar1 < uVar10);
    }
    iVar4 = 0;
  }
LAB_004743d8:
  if (iVar4 != -1) {
    iVar4 = pstm_init_size(param_1,&local_80,0x60);
    if (iVar4 != 0) {
      return iVar4;
    }
    ppuVar6 = local_70;
    iVar4 = pstm_init_size(param_1,ppuVar6,0x60);
    if (iVar4 != 0) {
      pstm_clear(&local_80);
      return iVar4;
    }
    iVar4 = pstm_init_size(param_1,local_60,0x60);
    if (iVar4 != 0) {
      pstm_clear(&local_80);
LAB_004749b4:
      pstm_clear(ppuVar6);
      return iVar4;
    }
    iVar4 = pstm_init_size(param_1,&local_50,0x60);
    if (iVar4 != 0) {
      pstm_clear(&local_80);
      pstm_clear(ppuVar6);
      ppuVar6 = local_60;
      goto LAB_004749b4;
    }
    uVar10 = (local_58 & 0xfeffffff) >> 0xc & 0xfff;
    uVar1 = 0;
    puVar13 = local_60[0];
    if (uVar10 != 0) {
      do {
        uVar1 = uVar1 + 1 & 0xffff;
        *puVar13 = 0;
        puVar13 = puVar13 + 1;
      } while (uVar1 < uVar10);
    }
    *local_60[0] = 1;
    puVar13 = param_2[2];
    local_58 = local_58 & 0xfefff000 | 1;
    uVar10 = (uint)puVar13 & 0xfff;
    uVar1 = 0;
    if (uVar10 != 0) {
      uVar1 = uVar10 * 0x20 - 0x20;
      for (uVar10 = (*param_2)[uVar10 - 1]; uVar10 != 0; uVar10 = uVar10 >> 1) {
        uVar1 = (int)(short)uVar1 + 1;
      }
      uVar1 = uVar1 & 0xffff;
    }
    uVar2 = (uint)param_3[2] & 0xfff;
    uVar10 = 0;
    if (uVar2 != 0) {
      uVar10 = uVar2 * 0x20 - 0x20;
      for (uVar2 = (*param_3)[uVar2 - 1]; uVar2 != 0; uVar2 = uVar2 >> 1) {
        uVar10 = (int)(short)uVar10 + 1;
      }
      uVar10 = uVar10 & 0xffff;
    }
    local_30 = uVar1 - uVar10;
    if (param_2 != &local_80) {
      uVar10 = (uint)puVar13 & 0xfff;
      uVar1 = (uint)local_78 >> 0xc & 0xfff;
      if (uVar1 < uVar10) {
        if (0x180 < uVar10) {
LAB_00474d50:
          local_2c = -8;
          goto LAB_0047492c;
        }
        if (uVar1 < uVar10) {
          puVar13 = (undefined4 *)realloc(local_80,uVar10 << 2);
          if (puVar13 == (undefined4 *)0x0) goto LAB_00474d50;
          uVar2 = (uint)local_78 & 0xff000fff;
          for (uVar1 = (uint)local_78 >> 0xc & 0xfff; local_80 = puVar13,
              local_78 = (undefined4 *)(uVar2 | uVar10 << 0xc), uVar1 < uVar10;
              uVar1 = uVar1 + 1 & 0xffff) {
            puVar13[uVar1] = 0;
          }
        }
        puVar13 = param_2[2];
      }
      puVar11 = *param_2;
      uVar10 = 0;
      puVar5 = local_80;
      for (uVar1 = (uint)puVar13 & 0xfff; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar5 = *puVar11;
        puVar11 = puVar11 + 1;
        puVar5 = puVar5 + 1;
        uVar10 = (uint)puVar13 & 0xfff;
      }
      iVar4 = ((uint)local_78 & 0xfff) - uVar10;
      if (uVar10 < ((uint)local_78 & 0xfff)) {
        do {
          iVar4 = iVar4 + -1;
          *puVar5 = 0;
          puVar5 = puVar5 + 1;
        } while (iVar4 != 0);
      }
      local_78 = (undefined4 *)((uint)local_78 & 0xfefff000 | (uint)puVar13 & 0xfff);
    }
    local_78 = (undefined4 *)((uint)local_78 & 0xfeffffff);
    if (param_3 != ppuVar6) {
      puVar13 = param_3[2];
      uVar10 = local_68 >> 0xc & 0xfff;
      uVar1 = (uint)puVar13 & 0xfff;
      if (uVar10 < uVar1) {
        if (0x180 < uVar1) {
LAB_00474d64:
          local_2c = -8;
          goto LAB_0047492c;
        }
        if (uVar10 < uVar1) {
          puVar13 = (undefined4 *)realloc(local_70[0],uVar1 << 2);
          if (puVar13 == (undefined4 *)0x0) goto LAB_00474d64;
          uVar2 = local_68 & 0xff000fff;
          for (uVar10 = local_68 >> 0xc & 0xfff; local_70[0] = puVar13,
              local_68 = uVar2 | uVar1 << 0xc, uVar10 < uVar1; uVar10 = uVar10 + 1 & 0xffff) {
            puVar13[uVar10] = 0;
          }
        }
        puVar13 = param_3[2];
      }
      puVar11 = *param_3;
      uVar10 = 0;
      puVar5 = local_70[0];
      for (uVar1 = (uint)puVar13 & 0xfff; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar5 = *puVar11;
        puVar11 = puVar11 + 1;
        puVar5 = puVar5 + 1;
        uVar10 = (uint)puVar13 & 0xfff;
      }
      iVar4 = (local_68 & 0xfff) - uVar10;
      if (uVar10 < (local_68 & 0xfff)) {
        do {
          iVar4 = iVar4 + -1;
          *puVar5 = 0;
          puVar5 = puVar5 + 1;
        } while (iVar4 != 0);
      }
      local_68 = local_68 & 0xfefff000 | (uint)puVar13 & 0xfff;
    }
    sVar14 = (short)local_30;
    local_68 = local_68 & 0xfeffffff;
    local_2c = FUN_00472f30(ppuVar6,(int)sVar14,ppuVar6);
    if ((local_2c == 0) &&
       (local_2c = FUN_00472f30(local_60,(int)sVar14,local_60), iVar4 = local_30, local_2c == 0)) {
      while (-1 < iVar4) {
        local_2c = 0;
        iVar4 = iVar4 + -1;
        uVar1 = local_68 >> 0x18 & 1;
        if (uVar1 == ((uint)local_78 >> 0x18 & 1)) {
          uVar10 = (uint)local_78 & 0xfff;
          if (uVar1 == 1) {
            iVar3 = 1;
            if ((uVar10 <= (local_68 & 0xfff)) && (iVar3 = -1, (local_68 & 0xfff) <= uVar10)) {
              puVar9 = local_70[0] + uVar10;
              puVar7 = local_80 + uVar10;
              uVar1 = 0;
              if (uVar10 != 0) {
                do {
                  puVar9 = puVar9 + -1;
                  puVar7 = puVar7 + -1;
                  uVar1 = uVar1 + 1 & 0xffff;
                  if (*puVar9 < *puVar7) {
                    iVar3 = 1;
                    goto LAB_00474bf4;
                  }
                  if (*puVar7 < *puVar9) {
                    iVar3 = -1;
                    goto LAB_00474bf4;
                  }
                } while (uVar1 < ((uint)local_78 & 0xfff));
              }
              iVar3 = 0;
            }
          }
          else {
            uVar1 = local_68 & 0xfff;
            iVar3 = 1;
            if ((uVar1 <= ((uint)local_78 & 0xfff)) &&
               (iVar3 = -1, ((uint)local_78 & 0xfff) <= uVar1)) {
              puVar7 = local_70[0] + uVar1;
              puVar9 = local_80 + uVar1;
              uVar10 = 0;
              if (uVar1 != 0) {
                do {
                  puVar9 = puVar9 + -1;
                  puVar7 = puVar7 + -1;
                  uVar10 = uVar10 + 1 & 0xffff;
                  if (*puVar9 < *puVar7) {
                    iVar3 = 1;
                    goto LAB_00474bf4;
                  }
                  if (*puVar7 < *puVar9) {
                    iVar3 = -1;
                    goto LAB_00474bf4;
                  }
                } while (uVar10 < (local_68 & 0xfff));
              }
              iVar3 = 0;
            }
          }
        }
        else {
          iVar3 = -1;
          if (uVar1 != 1) {
            iVar3 = 1;
          }
        }
LAB_00474bf4:
        if ((((iVar3 != 1) &&
             ((local_2c = pstm_sub(&local_80,ppuVar6,&local_80), local_2c != 0 ||
              (local_2c = pstm_add(&local_50,local_60,&local_50), local_2c != 0)))) ||
            (local_2c = pstm_div_2d(param_1,ppuVar6,1,ppuVar6,0), local_2c != 0)) ||
           (local_2c = pstm_div_2d(param_1,local_60,1,local_60,0), local_2c != 0))
        goto LAB_0047492c;
      }
      bVar12 = *(byte *)((int)param_2 + 0xb) & 1;
      uVar1 = (uint)(bVar12 != (*(byte *)((int)param_3 + 0xb) & 1));
      if (param_4 != (undefined4 *)0x0) {
        local_40 = (undefined4 *)*param_4;
        local_3c = (undefined4 *)param_4[1];
        local_38 = (undefined4 *)param_4[2];
        *param_4 = local_50;
        param_4[1] = local_4c;
        param_4[2] = local_48;
        if (((uint)local_48 & 0xfff) == 0) {
          uVar1 = 0;
        }
        param_4[2] = param_4[2] & 0xfeffffff | uVar1 << 0x18;
        local_50 = local_40;
        local_4c = local_3c;
        local_48 = local_38;
      }
      if (param_5 != (undefined4 **)0x0) {
        local_40 = *param_5;
        local_3c = param_5[1];
        local_38 = param_5[2];
        param_5[1] = local_7c;
        *param_5 = local_80;
        param_5[2] = local_78;
        if (((uint)local_78 & 0xfff) == 0) {
          bVar12 = 0;
        }
        param_5[2] = (undefined4 *)((uint)param_5[2] & 0xfeffffff | (uint)bVar12 << 0x18);
        local_80 = local_40;
        local_7c = local_3c;
        local_78 = local_38;
      }
    }
LAB_0047492c:
    pstm_clear(&local_80);
    pstm_clear(ppuVar6);
    pstm_clear(local_60);
    pstm_clear(&local_50);
    return local_2c;
  }
  iVar4 = 0;
  if ((param_5 == (undefined4 **)0x0) || (iVar4 = 0, param_2 == param_5)) goto LAB_004744a4;
  puVar11 = param_5[2];
  uVar10 = (uint)puVar13 & 0xfff;
  uVar1 = (uint)puVar11 >> 0xc & 0xfff;
  if (uVar1 < uVar10) {
    if (0x180 < uVar10) {
LAB_004745e4:
      iVar4 = -8;
      goto LAB_004744a4;
    }
    if (uVar1 < uVar10) {
      puVar13 = (undefined4 *)realloc(*param_5,uVar10 << 2);
      if (puVar13 == (undefined4 *)0x0) goto LAB_004745e4;
      uVar1 = (uint)param_5[2] >> 0xc & 0xfff;
      *param_5 = puVar13;
      param_5[2] = (undefined4 *)((uint)param_5[2] & 0xff000fff | uVar10 << 0xc);
      if (uVar1 < uVar10) {
        do {
          uVar2 = uVar1 + 1 & 0xffff;
          puVar13[uVar1] = 0;
          uVar1 = uVar2;
        } while (uVar2 < uVar10);
        puVar13 = param_2[2];
        puVar11 = param_5[2];
        uVar1 = (uint)puVar13 & 0xfff;
        goto LAB_00474414;
      }
    }
    puVar13 = param_2[2];
    puVar11 = param_5[2];
    uVar1 = (uint)puVar13 & 0xfff;
  }
  else {
    uVar1 = (uint)puVar13 & 0xfff;
  }
LAB_00474414:
  puVar5 = *param_2;
  puVar8 = *param_5;
  uVar10 = 0;
  for (uVar2 = uVar1; uVar2 != 0; uVar2 = uVar2 - 1) {
    *puVar8 = *puVar5;
    puVar5 = puVar5 + 1;
    puVar8 = puVar8 + 1;
    uVar10 = uVar1;
  }
  iVar4 = ((uint)puVar11 & 0xfff) - uVar10;
  if (uVar10 < ((uint)puVar11 & 0xfff)) {
    do {
      iVar4 = iVar4 + -1;
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    } while (iVar4 != 0);
  }
  puVar11 = param_5[2];
  param_5[2] = (undefined4 *)((uint)puVar11 & 0xfffff000 | (uint)puVar13 & 0xfff);
  param_5[2] = (undefined4 *)
               ((uint)puVar11 & 0xfefff000 | (uint)puVar13 & 0xfff |
               (*(byte *)((int)param_2 + 0xb) & 1) << 0x18);
  iVar4 = 0;
LAB_004744a4:
  if (param_4 == (undefined4 *)0x0) {
    return iVar4;
  }
  uVar10 = (param_4[2] & 0xfeffffff) >> 0xc & 0xfff;
  param_4[2] = param_4[2] & 0xfefff000;
  param_4 = (undefined4 *)*param_4;
  uVar1 = 0;
  if (uVar10 == 0) {
    return iVar4;
  }
  do {
    uVar1 = uVar1 + 1 & 0xffff;
    *param_4 = 0;
    param_4 = param_4 + 1;
  } while (uVar1 < uVar10);
  return iVar4;
}



int pstm_mod(undefined4 param_1,undefined4 param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 local_40;
  undefined4 local_3c;
  uint local_38;
  
  iVar1 = pstm_init_size(param_1,&local_40,*(uint *)(param_3 + 8) >> 0xc & 0xfff);
  if (iVar1 != 0) {
    return iVar1;
  }
  iVar1 = pstm_div(param_1,param_2,param_3,0,&local_40);
  if (iVar1 == 0) {
    if ((local_38 >> 0x18 & 1) == (*(byte *)(param_3 + 0xb) & 1)) {
      uVar2 = param_4[2];
      uVar4 = *param_4;
      uVar3 = param_4[1];
      param_4[2] = local_38;
      *param_4 = local_40;
      param_4[1] = local_3c;
      local_40 = uVar4;
      local_3c = uVar3;
      local_38 = uVar2;
    }
    else {
      iVar1 = pstm_add(&local_40,param_3,param_4);
    }
  }
  pstm_clear(&local_40);
  return iVar1;
}



int pstm_mulmod(undefined4 param_1,int param_2,int param_3,undefined4 param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  undefined auStack_30 [16];
  
  uVar3 = *(uint *)(param_2 + 8) >> 0xc & 0xfff;
  uVar2 = (*(uint *)(param_2 + 8) & 0xfff) + (*(uint *)(param_3 + 8) & 0xfff) + 1;
  if ((param_2 == param_5) && (uVar2 < uVar3)) {
    uVar2 = uVar3;
  }
  iVar1 = pstm_init_size(param_1,auStack_30,uVar2);
  if (iVar1 != 0) {
    return iVar1;
  }
  iVar1 = pstm_mul_comba(param_1,param_2,param_3,auStack_30,0,0);
  if (iVar1 == 0) {
    iVar1 = pstm_mod(param_1,auStack_30,param_4,param_5);
    pstm_clear(auStack_30);
  }
  else {
    pstm_clear(auStack_30);
  }
  return iVar1;
}



int pstm_exptmod(undefined4 param_1,undefined4 **param_2,int *param_3,uint **param_4,
                undefined4 **param_5)

{
  short sVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  short sVar8;
  uint uVar9;
  uint *puVar10;
  uint uVar11;
  undefined4 *puVar12;
  undefined4 **ppuVar13;
  int iVar14;
  int iVar15;
  undefined4 *apuStack_1f8 [2];
  undefined4 uStack_1f0;
  undefined4 *local_1ec [2];
  uint local_1e4;
  undefined4 *local_78 [2];
  uint local_70;
  undefined auStack_68 [16];
  int local_58;
  void *local_54;
  uint local_50;
  int local_4c;
  int local_48;
  int local_44;
  size_t local_40;
  int local_3c;
  int local_38;
  int local_34;
  uint local_30;
  
  uVar9 = (uint)param_4[2] & 0xfff;
  sVar8 = 0;
  if (uVar9 != 0) {
    uVar3 = (*param_4)[uVar9 - 1];
    iVar2 = uVar9 * 0x20 + -0x20;
    while( true ) {
      sVar8 = (short)iVar2;
      if (uVar3 == 0) break;
      iVar2 = sVar8 + 1;
      uVar3 = uVar3 >> 1;
    }
  }
  if (sVar8 != 0x600) {
    if (sVar8 < 0x601) {
      sVar1 = 0x400;
      if (sVar8 != 0x200) {
LAB_004752d0:
        if (sVar8 != sVar1) {
          return -1;
        }
      }
    }
    else if (sVar8 != 0xc00) {
      sVar1 = 0x1000;
      if (0xc00 < sVar8) goto LAB_004752d0;
      if (sVar8 != 0x800) {
        return -1;
      }
    }
  }
  uVar9 = param_3[2] & 0xfff;
  sVar8 = 0;
  if (uVar9 != 0) {
    uVar3 = *(uint *)(uVar9 * 4 + *param_3 + -4);
    iVar2 = uVar9 * 0x20 + -0x20;
    while( true ) {
      sVar8 = (short)iVar2;
      if (uVar3 == 0) break;
      iVar2 = sVar8 + 1;
      uVar3 = uVar3 >> 1;
    }
  }
  uVar9 = **param_4;
  iVar2 = (0x31 < sVar8) + 2;
  if (((uVar9 ^ 1) & 1) != 0) {
    return -6;
  }
  iVar15 = (uVar9 + 2 & 4) * 2 + uVar9;
  iVar15 = iVar15 * (2 - uVar9 * iVar15);
  iVar15 = iVar15 * (2 - uVar9 * iVar15);
  local_58 = -(iVar15 * (2 - uVar9 * iVar15));
  iVar15 = pstm_init_size(param_1,local_78,((uint)param_4[2] & 0xfff) * 2 + 1);
  if (iVar15 != 0) {
    return iVar15;
  }
  iVar15 = pstm_montgomery_calc_normalization(local_78,param_4);
  if ((iVar15 != 0) || (iVar15 = pstm_init_size(param_1,local_1ec,local_70 & 0xfff), iVar15 != 0))
  goto LAB_00475bd0;
  puVar12 = param_2[2];
  uVar9 = (uint)param_4[2] & 0xfff;
  iVar15 = 1;
  if ((uVar9 <= ((uint)puVar12 & 0xfff)) && (iVar15 = -1, ((uint)puVar12 & 0xfff) <= uVar9)) {
    puVar10 = *param_4 + uVar9;
    puVar5 = *param_2 + uVar9;
    uVar3 = 0;
    if (uVar9 != 0) {
      do {
        puVar10 = puVar10 + -1;
        puVar5 = puVar5 + -1;
        uVar3 = uVar3 + 1 & 0xffff;
        if (*puVar5 < *puVar10) {
          iVar15 = 1;
          goto LAB_00475508;
        }
        if (*puVar10 < *puVar5) {
          iVar15 = -1;
          goto LAB_00475508;
        }
      } while (uVar3 < uVar9);
    }
    iVar15 = 0;
  }
LAB_00475508:
  if (iVar15 == 1) {
    uVar9 = (uint)puVar12 & 0xfff;
    if (param_2 != local_1ec) {
      uVar3 = local_1e4 >> 0xc & 0xfff;
      if (uVar3 < uVar9) {
        if (0x180 < uVar9) {
LAB_00475e4c:
          iVar15 = -8;
          goto LAB_00475530;
        }
        if (uVar3 < uVar9) {
          puVar12 = (undefined4 *)realloc(local_1ec[0],uVar9 << 2);
          if (puVar12 == (undefined4 *)0x0) goto LAB_00475e4c;
          uVar11 = local_1e4 & 0xff000fff;
          for (uVar3 = local_1e4 >> 0xc & 0xfff; local_1ec[0] = puVar12,
              local_1e4 = uVar11 | uVar9 << 0xc, uVar3 < uVar9; uVar3 = uVar3 + 1 & 0xffff) {
            puVar12[uVar3] = 0;
          }
        }
        puVar12 = param_2[2];
      }
      puVar7 = *param_2;
      uVar9 = 0;
      puVar6 = local_1ec[0];
      for (uVar3 = (uint)puVar12 & 0xfff; uVar3 != 0; uVar3 = uVar3 - 1) {
        *puVar6 = *puVar7;
        puVar7 = puVar7 + 1;
        puVar6 = puVar6 + 1;
        uVar9 = (uint)puVar12 & 0xfff;
      }
      iVar15 = (local_1e4 & 0xfff) - uVar9;
      if (uVar9 < (local_1e4 & 0xfff)) {
        do {
          iVar15 = iVar15 + -1;
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        } while (iVar15 != 0);
      }
      local_1e4 = local_1e4 & 0xfefff000 | (uint)puVar12 & 0xfff | (uint)puVar12 & 0x1000000;
    }
LAB_00475538:
    uVar9 = (local_1e4 & 0xfff) + (local_70 & 0xfff) + 1;
    uVar3 = local_1e4 >> 0xc & 0xfff;
    if (uVar9 < uVar3) {
      uVar9 = uVar3;
    }
    iVar15 = pstm_init_size(param_1,auStack_68,uVar9);
    if (iVar15 == 0) {
      iVar15 = pstm_mul_comba(param_1,local_1ec,local_78,auStack_68,0,0);
      if (iVar15 == 0) {
        iVar15 = pstm_mod(param_1,auStack_68,param_4,local_1ec);
        pstm_clear(auStack_68);
      }
      else {
        pstm_clear(auStack_68);
      }
    }
    if (iVar15 == 0) {
      local_40 = (local_1e4 & 0xfff) * 8 + 0x18;
      local_54 = malloc(local_40);
      iVar15 = -8;
      if (local_54 != (void *)0x0) {
        local_30 = (0x31 < sVar8) + 1;
        iVar15 = 0xc << local_30;
        ppuVar13 = (undefined4 **)((int)apuStack_1f8 + iVar15);
        if (ppuVar13 == local_1ec) {
LAB_00475714:
          iVar4 = 0;
          if (0 < (int)local_30) {
            iVar14 = (int)apuStack_1f8 + (0xc << (local_30 & 0x1f));
            uVar9 = local_40 & 0xffff;
            do {
              iVar15 = pstm_sqr_comba(param_1,iVar14,iVar14,local_54,uVar9);
              if (iVar15 != 0) goto LAB_00475ba0;
              iVar15 = pstm_montgomery_reduce(param_1,iVar14,param_4,local_58,local_54,uVar9);
              iVar4 = (iVar4 + 1) * 0x10000 >> 0x10;
              if (iVar15 != 0) goto LAB_00475ba0;
            } while (iVar4 < (int)local_30);
          }
          iVar15 = 1 << (local_30 & 0x1f);
          iVar4 = (iVar15 + 1) * 0x10000 >> 0x10;
          if (iVar4 < 1 << iVar2) {
            iVar14 = 0xc << (local_30 & 0x1f);
            local_38 = iVar15;
            local_3c = 1 << iVar2;
            ppuVar13 = apuStack_1f8 + iVar4 * 3;
            do {
              iVar15 = pstm_init_size(param_1,ppuVar13,
                                      ((uint)*(byte *)((int)&uStack_1f0 + iVar14 + 2) << 4 |
                                      (uint)(*(byte *)((int)&uStack_1f0 + iVar14 + 1) >> 4)) + 1);
              ppuVar13 = ppuVar13 + 3;
              if (iVar15 != 0) {
                iVar2 = (int)(short)local_38;
                if (iVar2 < iVar4) {
                  ppuVar13 = apuStack_1f8 + iVar2 * 3;
                  do {
                    pstm_clear(ppuVar13);
                    iVar2 = (iVar2 + 1) * 0x10000 >> 0x10;
                    ppuVar13 = ppuVar13 + 3;
                  } while (iVar2 < iVar4);
                }
                goto LAB_00475ba0;
              }
              iVar4 = (iVar4 + 1) * 0x10000 >> 0x10;
            } while (iVar4 < local_3c);
          }
          uVar9 = local_40;
          iVar4 = ((1 << (local_30 & 0x1f)) + 1) * 0x10000 >> 0x10;
          if (iVar4 < 1 << iVar2) {
            uVar3 = local_40 & 0xffff;
            ppuVar13 = apuStack_1f8 + iVar4 * 3;
            local_34 = 1 << iVar2;
            do {
              iVar15 = pstm_mul_comba(param_1,ppuVar13 + -3,local_1ec,ppuVar13,local_54,uVar3);
              if (iVar15 != 0) goto LAB_00475b3c;
              iVar15 = pstm_montgomery_reduce(param_1,ppuVar13,param_4,local_58,local_54,uVar3);
              iVar4 = (iVar4 + 1) * 0x10000 >> 0x10;
              if (iVar15 != 0) goto LAB_00475b3c;
              ppuVar13 = ppuVar13 + 3;
            } while (iVar4 < local_34);
          }
          uVar9 = uVar9 & 0xffff;
          local_44 = (int)(((param_3[2] & 0xfffU) - 1) * 0x10000) >> 0x10;
          iVar4 = 0;
          local_48 = 1;
          iVar14 = 0;
          local_4c = 0;
          local_50 = 0;
          do {
            while( true ) {
              do {
                local_48 = (local_48 + -1) * 0x10000 >> 0x10;
                if (local_48 == 0) {
                  iVar15 = local_44 * 4;
                  if (local_44 == -1) {
                    if ((iVar4 != 2) || (iVar4 = 0, local_4c < 1)) goto LAB_00475ff8;
                    goto LAB_00475f18;
                  }
                  local_44 = (local_44 + -1) * 0x10000 >> 0x10;
                  iVar14 = *(int *)(iVar15 + *param_3);
                  local_48 = 0x20;
                }
                uVar3 = (uint)(iVar14 < 0);
                iVar14 = iVar14 << 1;
              } while ((iVar4 == 0) && (uVar3 == 0));
              if ((iVar4 == 1) && (uVar3 == 0)) break;
              local_4c = (local_4c + 1) * 0x10000 >> 0x10;
              local_50 = local_50 | uVar3 << (iVar2 - local_4c & 0x1fU);
              iVar4 = 2;
              if (local_4c == iVar2) {
                iVar4 = 0;
                if (iVar2 != 0) {
                  do {
                    iVar15 = pstm_sqr_comba(param_1,local_78,local_78,local_54,uVar9);
                    if (iVar15 != 0) goto LAB_00475b3c;
                    iVar15 = pstm_montgomery_reduce
                                       (param_1,local_78,param_4,local_58,local_54,uVar9);
                    iVar4 = (iVar4 + 1) * 0x10000 >> 0x10;
                    if (iVar15 != 0) goto LAB_00475b3c;
                  } while (iVar4 < iVar2);
                }
                iVar15 = pstm_mul_comba(param_1,local_78,apuStack_1f8 + local_50 * 3,local_78,
                                        local_54,uVar9);
                if ((iVar15 != 0) ||
                   (iVar15 = pstm_montgomery_reduce
                                       (param_1,local_78,param_4,local_58,local_54,uVar9),
                   iVar15 != 0)) goto LAB_00475b3c;
                iVar4 = 1;
                local_4c = 0;
                local_50 = 0;
              }
            }
            iVar15 = pstm_sqr_comba(param_1,local_78,local_78,local_54,uVar9);
          } while ((iVar15 == 0) &&
                  (iVar15 = pstm_montgomery_reduce(param_1,local_78,param_4,local_58,local_54,uVar9)
                  , iVar15 == 0));
          goto LAB_00475b3c;
        }
        iVar4 = (local_1e4 & 0xfff) * 2;
        uVar9 = local_1e4 >> 0xc & 0xfff;
        if (uVar9 <= iVar4 + 2U) {
          uVar9 = iVar4 + 3;
        }
        iVar4 = pstm_init_size(param_1,ppuVar13,uVar9);
        if ((iVar4 == 0) && (local_1ec != ppuVar13)) {
          uVar11 = *(uint *)((int)&uStack_1f0 + iVar15);
          uVar3 = uVar11 >> 0xc & 0xfff;
          uVar9 = local_1e4 & 0xfff;
          if (uVar3 < uVar9) {
            if (0x180 < uVar9) {
LAB_00475ed0:
              iVar4 = -8;
              goto LAB_0047570c;
            }
            if (uVar3 < uVar9) {
              puVar12 = (undefined4 *)realloc(*ppuVar13,uVar9 << 2);
              if (puVar12 == (undefined4 *)0x0) goto LAB_00475ed0;
              uVar3 = *(uint *)((int)&uStack_1f0 + iVar15);
              *ppuVar13 = puVar12;
              *(uint *)((int)&uStack_1f0 + iVar15) = uVar3 & 0xff000fff | uVar9 << 0xc;
              for (uVar3 = uVar3 >> 0xc & 0xfff; uVar3 < uVar9; uVar3 = uVar3 + 1 & 0xffff) {
                puVar12[uVar3] = 0;
              }
            }
            uVar11 = *(uint *)((int)&uStack_1f0 + iVar15);
          }
          puVar12 = *ppuVar13;
          uVar3 = 0;
          puVar7 = local_1ec[0];
          for (uVar9 = local_1e4 & 0xfff; uVar9 != 0; uVar9 = uVar9 - 1) {
            *puVar12 = *puVar7;
            puVar7 = puVar7 + 1;
            puVar12 = puVar12 + 1;
            uVar3 = local_1e4 & 0xfff;
          }
          iVar4 = (uVar11 & 0xfff) - uVar3;
          if (uVar3 < (uVar11 & 0xfff)) {
            do {
              iVar4 = iVar4 + -1;
              *puVar12 = 0;
              puVar12 = puVar12 + 1;
            } while (iVar4 != 0);
          }
          uVar3 = *(uint *)((int)&uStack_1f0 + iVar15);
          uVar9 = local_1e4 & 0xfff;
          *(uint *)((int)&uStack_1f0 + iVar15) = uVar3 & 0xfffff000 | uVar9;
          *(uint *)((int)&uStack_1f0 + iVar15) =
               uVar3 & 0xfefff000 | uVar9 | (local_1e4 >> 0x18 & 1) << 0x18;
          iVar4 = 0;
        }
LAB_0047570c:
        iVar15 = -8;
        if (iVar4 == 0) goto LAB_00475714;
        goto LAB_00475ba0;
      }
    }
  }
  else {
    iVar15 = pstm_mod(param_1,param_2,param_4,local_1ec);
LAB_00475530:
    if (iVar15 == 0) goto LAB_00475538;
  }
  goto LAB_00475bb8;
  while( true ) {
    iVar15 = pstm_montgomery_reduce(param_1,local_78,param_4,local_58,local_54,uVar9);
    if (iVar15 != 0) goto LAB_00475b3c;
    if (((int)local_50 >> iVar2 & 1U) != 0) {
      iVar15 = pstm_mul_comba(param_1,local_78,local_1ec,local_78,local_54,uVar9);
      if ((iVar15 != 0) ||
         (iVar15 = pstm_montgomery_reduce(param_1,local_78,param_4,local_58,local_54,uVar9),
         iVar15 != 0)) goto LAB_00475b3c;
    }
    iVar4 = (int)(short)((short)iVar4 + 1);
    if (local_4c <= iVar4) break;
LAB_00475f18:
    local_50 = local_50 << 1;
    iVar15 = pstm_sqr_comba(param_1,local_78,local_78,local_54,uVar9);
    if (iVar15 != 0) goto LAB_00475b3c;
  }
LAB_00475ff8:
  iVar15 = pstm_montgomery_reduce(param_1,local_78,param_4,local_58,local_54,uVar9);
  if ((iVar15 == 0) && (iVar15 = 0, local_78 != param_5)) {
    puVar12 = param_5[2];
    uVar3 = (uint)puVar12 >> 0xc & 0xfff;
    uVar9 = local_70 & 0xfff;
    if (uVar3 < uVar9) {
      if (0x180 < uVar9) {
LAB_00476184:
        iVar15 = -8;
        goto LAB_00475b3c;
      }
      if (uVar3 < uVar9) {
        puVar12 = (undefined4 *)realloc(*param_5,uVar9 << 2);
        if (puVar12 == (undefined4 *)0x0) goto LAB_00476184;
        puVar7 = param_5[2];
        *param_5 = puVar12;
        param_5[2] = (undefined4 *)((uint)puVar7 & 0xff000fff | uVar9 << 0xc);
        for (uVar3 = (uint)puVar7 >> 0xc & 0xfff; uVar3 < uVar9; uVar3 = uVar3 + 1 & 0xffff) {
          puVar12[uVar3] = 0;
        }
      }
      puVar12 = param_5[2];
    }
    puVar7 = *param_5;
    uVar3 = 0;
    for (uVar9 = local_70 & 0xfff; uVar9 != 0; uVar9 = uVar9 - 1) {
      *puVar7 = *local_78[0];
      local_78[0] = local_78[0] + 1;
      puVar7 = puVar7 + 1;
      uVar3 = local_70 & 0xfff;
    }
    iVar15 = ((uint)puVar12 & 0xfff) - uVar3;
    if (uVar3 < ((uint)puVar12 & 0xfff)) {
      do {
        iVar15 = iVar15 + -1;
        *puVar7 = 0;
        puVar7 = puVar7 + 1;
      } while (iVar15 != 0);
    }
    param_5[2] = (undefined4 *)
                 ((uint)param_5[2] & 0xfefff000 | local_70 & 0xfff | local_70 & 0x1000000);
    iVar15 = 0;
  }
LAB_00475b3c:
  iVar4 = (int)(short)(1 << (local_30 & 0x1f));
  if (iVar4 < 1 << iVar2) {
    ppuVar13 = apuStack_1f8 + iVar4 * 3;
    do {
      pstm_clear(ppuVar13);
      iVar4 = (iVar4 + 1) * 0x10000 >> 0x10;
      ppuVar13 = ppuVar13 + 3;
    } while (iVar4 < 1 << iVar2);
  }
LAB_00475ba0:
  free(local_54);
LAB_00475bb8:
  pstm_clear(local_1ec);
LAB_00475bd0:
  pstm_clear(local_78);
  return iVar15;
}



int pstm_to_unsigned_bin(undefined4 param_1,undefined4 **param_2,int param_3)

{
  undefined uVar1;
  int iVar2;
  uint uVar3;
  undefined4 *puVar4;
  undefined *puVar5;
  undefined4 *puVar6;
  uint uVar7;
  undefined *puVar8;
  undefined4 *puVar9;
  uint uVar10;
  undefined4 *local_28;
  undefined4 local_24;
  uint local_20;
  
  local_28 = (undefined4 *)0x0;
  local_24 = 0;
  local_20 = 0;
  if (&local_28 == param_2) goto LAB_00476204;
  iVar2 = pstm_init_size(param_1,&local_28,(uint)param_2[2] >> 0xc & 0xfff);
  if ((iVar2 == 0) && (param_2 != &local_28)) {
    puVar9 = param_2[2];
    uVar7 = local_20 >> 0xc & 0xfff;
    uVar10 = (uint)puVar9 & 0xfff;
    if (uVar7 < uVar10) {
      if (0x180 < uVar10) {
LAB_00476404:
        iVar2 = -8;
        goto LAB_004761fc;
      }
      if (uVar7 < uVar10) {
        puVar9 = (undefined4 *)realloc(local_28,uVar10 << 2);
        if (puVar9 == (undefined4 *)0x0) goto LAB_00476404;
        uVar3 = local_20 & 0xff000fff | uVar10 << 0xc;
        uVar7 = local_20 >> 0xc & 0xfff;
        local_28 = puVar9;
        local_20 = uVar3;
        if (uVar7 < uVar10) {
          do {
            uVar3 = uVar7 + 1 & 0xffff;
            puVar9[uVar7] = 0;
            uVar7 = uVar3;
          } while (uVar3 < uVar10);
          puVar9 = param_2[2];
          uVar10 = (uint)puVar9 & 0xfff;
          goto LAB_00476314;
        }
      }
      puVar9 = param_2[2];
      uVar10 = (uint)puVar9 & 0xfff;
    }
    else {
      uVar10 = (uint)puVar9 & 0xfff;
    }
LAB_00476314:
    puVar6 = *param_2;
    uVar7 = 0;
    puVar4 = local_28;
    for (uVar3 = uVar10; uVar3 != 0; uVar3 = uVar3 - 1) {
      *puVar4 = *puVar6;
      puVar6 = puVar6 + 1;
      puVar4 = puVar4 + 1;
      uVar7 = uVar10;
    }
    if (uVar7 < (local_20 & 0xfff)) {
      iVar2 = (local_20 & 0xfff) - uVar7;
      do {
        iVar2 = iVar2 + -1;
        *puVar4 = 0;
        puVar4 = puVar4 + 1;
      } while (iVar2 != 0);
    }
    local_20 = local_20 & 0xfefff000 | (uint)puVar9 & 0xfff | (uint)puVar9 & 0x1000000;
    iVar2 = 0;
  }
LAB_004761fc:
  if (iVar2 != 0) {
    return iVar2;
  }
LAB_00476204:
  uVar10 = 0;
  if ((local_20 & 0xfff) != 0) {
    do {
      *(char *)(uVar10 + param_3) = (char)*local_28;
      uVar10 = uVar10 + 1 & 0xffff;
      iVar2 = pstm_div_2d(param_1,&local_28,8,&local_28,0);
      if (iVar2 != 0) {
        pstm_clear(&local_28);
        return iVar2;
      }
    } while ((local_20 & 0xfff) != 0);
    if (uVar10 != 0) {
      uVar10 = uVar10 - 1 & 0xffff;
      uVar7 = 0;
      if (uVar10 != 0) {
        do {
          puVar5 = (undefined *)(uVar7 + param_3);
          puVar8 = (undefined *)(uVar10 + param_3);
          uVar1 = *puVar5;
          uVar7 = uVar7 + 1 & 0xffff;
          uVar10 = uVar10 - 1 & 0xffff;
          *puVar5 = *puVar8;
          *puVar8 = uVar1;
        } while (uVar7 < uVar10);
      }
    }
  }
  pstm_clear(&local_28);
  return 0;
}



// WARNING: Removing unreachable block (ram,0x00477364)

int pstm_invmod(undefined4 param_1,uint **param_2,uint **param_3,uint **param_4)

{
  byte bVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  uint *puVar6;
  uint **ppuVar7;
  ushort uVar8;
  uint *puVar9;
  uint **ppuVar10;
  bool bVar11;
  uint *puVar12;
  uint uVar13;
  uint *local_108 [2];
  uint local_100;
  uint *local_f8 [2];
  uint local_f0;
  uint *local_e8 [2];
  uint local_e0;
  uint *local_d8 [2];
  uint local_d0;
  uint *local_c8 [2];
  uint local_c0;
  uint *local_b8 [2];
  uint local_b0;
  uint *local_a8 [2];
  uint local_a0;
  uint *local_98 [2];
  uint local_90;
  uint *local_88 [2];
  uint local_80;
  uint *local_78 [2];
  uint local_70;
  uint *local_68 [2];
  uint local_60;
  uint *local_58 [2];
  uint local_50;
  uint *local_48 [2];
  uint local_40;
  uint *local_38 [2];
  uint local_30;
  
  puVar12 = param_3[2];
  if ((((uint)puVar12 & 0xfff) != 0) && (((**param_3 ^ 1) & 1) != 0)) {
    if (((uint)puVar12 >> 0x18 & 1) == 1) {
      return -9;
    }
    if (((uint)puVar12 & 0xfff) == 0) {
      return -9;
    }
    iVar2 = pstm_init_size(param_1,local_a8);
    if (iVar2 != 0) {
      return -8;
    }
    iVar2 = pstm_mod(param_1,param_2,param_3,local_a8);
    if (iVar2 != 0) goto LAB_0047733c;
    if (local_98 != param_3) {
      iVar3 = pstm_init_size(param_1,local_98,(uint)param_3[2] >> 0xc & 0xfff);
      if ((iVar3 == 0) && (param_3 != local_98)) {
        puVar12 = param_3[2];
        uVar5 = local_90 >> 0xc & 0xfff;
        uVar4 = (uint)puVar12 & 0xfff;
        if (uVar5 < uVar4) {
          if (0x180 < uVar4) {
LAB_00477a28:
            iVar3 = -8;
            goto LAB_00476d58;
          }
          if (uVar5 < uVar4) {
            puVar12 = (uint *)realloc(local_98[0],uVar4 << 2);
            if (puVar12 == (uint *)0x0) goto LAB_00477a28;
            uVar13 = local_90 & 0xff000fff;
            for (uVar5 = local_90 >> 0xc & 0xfff; local_98[0] = puVar12,
                local_90 = uVar13 | uVar4 << 0xc, uVar5 < uVar4; uVar5 = uVar5 + 1 & 0xffff) {
              puVar12[uVar5] = 0;
            }
          }
          puVar12 = param_3[2];
        }
        puVar6 = *param_3;
        uVar4 = 0;
        puVar9 = local_98[0];
        for (uVar5 = (uint)puVar12 & 0xfff; uVar5 != 0; uVar5 = uVar5 - 1) {
          *puVar9 = *puVar6;
          puVar6 = puVar6 + 1;
          puVar9 = puVar9 + 1;
          uVar4 = (uint)puVar12 & 0xfff;
        }
        iVar3 = (local_90 & 0xfff) - uVar4;
        if (uVar4 < (local_90 & 0xfff)) {
          do {
            iVar3 = iVar3 + -1;
            *puVar9 = 0;
            puVar9 = puVar9 + 1;
          } while (iVar3 != 0);
        }
        local_90 = local_90 & 0xfefff000 | (uint)puVar12 & 0xfff | (uint)puVar12 & 0x1000000;
        iVar3 = 0;
      }
LAB_00476d58:
      if (iVar3 != 0) goto LAB_0047733c;
    }
    bVar11 = false;
    if (((local_a0 & 0xfff) != 0) && (((*local_a8[0] ^ 1) & 1) != 0)) {
      bVar11 = true;
    }
    if (bVar11) {
      bVar11 = false;
      if (((local_90 & 0xfff) != 0) && (((*local_98[0] ^ 1) & 1) != 0)) {
        bVar11 = true;
      }
      iVar2 = -1;
      if (!bVar11) goto LAB_00476da4;
    }
    else {
LAB_00476da4:
      if (local_88 != local_a8) {
        iVar2 = pstm_init_size(param_1,local_88,local_a0 >> 0xc & 0xfff);
        if ((iVar2 == 0) && (local_a8 != local_88)) {
          uVar5 = local_80 >> 0xc & 0xfff;
          uVar4 = local_a0 & 0xfff;
          if (uVar5 < uVar4) {
            if (0x180 < uVar4) {
LAB_00477a38:
              iVar2 = -8;
              goto LAB_00476eb0;
            }
            if (uVar5 < uVar4) {
              puVar12 = (uint *)realloc(local_88[0],uVar4 << 2);
              if (puVar12 == (uint *)0x0) goto LAB_00477a38;
              uVar13 = local_80 & 0xff000fff;
              for (uVar5 = local_80 >> 0xc & 0xfff; local_88[0] = puVar12,
                  local_80 = uVar13 | uVar4 << 0xc, uVar5 < uVar4; uVar5 = uVar5 + 1 & 0xffff) {
                puVar12[uVar5] = 0;
              }
            }
          }
          uVar4 = 0;
          puVar12 = local_88[0];
          for (uVar5 = local_a0 & 0xfff; uVar5 != 0; uVar5 = uVar5 - 1) {
            *puVar12 = *local_a8[0];
            local_a8[0] = local_a8[0] + 1;
            puVar12 = puVar12 + 1;
            uVar4 = local_a0 & 0xfff;
          }
          iVar2 = (local_80 & 0xfff) - uVar4;
          if (uVar4 < (local_80 & 0xfff)) {
            do {
              iVar2 = iVar2 + -1;
              *puVar12 = 0;
              puVar12 = puVar12 + 1;
            } while (iVar2 != 0);
          }
          local_80 = local_80 & 0xfefff000 | local_a0 & 0xfff | (local_a0 >> 0x18 & 1) << 0x18;
          iVar2 = 0;
        }
LAB_00476eb0:
        if (iVar2 != 0) goto LAB_00477324;
      }
      if (local_78 == local_98) {
LAB_00476fd4:
        iVar2 = pstm_init_size(param_1,local_68,4);
        if (iVar2 == 0) {
          iVar2 = pstm_init_size(param_1,local_38,4);
          if (iVar2 == 0) {
            uVar5 = (local_60 & 0xfeffffff) >> 0xc & 0xfff;
            bVar11 = uVar5 != 0;
            uVar4 = 0;
            puVar12 = local_68[0];
            while (bVar11) {
              uVar4 = uVar4 + 1 & 0xffff;
              *puVar12 = 0;
              bVar11 = uVar4 < uVar5;
              puVar12 = puVar12 + 1;
            }
            *local_68[0] = 1;
            local_60 = local_60 & 0xfefff000 | 1;
            uVar4 = 0;
            if (((local_30 & 0xfeffffff) >> 0xc & 0xfff) != 0) {
              puVar12 = local_38[0];
              do {
                uVar4 = uVar4 + 1 & 0xffff;
                *puVar12 = 0;
                puVar12 = puVar12 + 1;
              } while (uVar4 < ((local_30 & 0xfefff000) >> 0xc & 0xfff));
            }
            *local_38[0] = 1;
            local_30 = local_30 & 0xfefff000 | 1;
            iVar2 = pstm_init_size(param_1,local_58,0x60);
            if (iVar2 == 0) {
              iVar2 = pstm_init_size(param_1,local_48,0x60);
              if (iVar2 == 0) {
                do {
                  while( true ) {
                    bVar11 = false;
                    if (((local_80 & 0xfff) != 0) && (((*local_88[0] ^ 1) & 1) != 0)) {
                      bVar11 = true;
                    }
                    if (!bVar11) break;
                    iVar2 = pstm_div_2(local_88,local_88);
                    if (iVar2 != 0) goto LAB_00477294;
                    bVar11 = false;
                    if (((local_60 & 0xfff) != 0) && ((*local_68[0] & 1) != 0)) {
                      bVar11 = true;
                    }
                    if (bVar11) {
LAB_00477254:
                      iVar2 = pstm_add(local_68,local_98,local_68);
                      if ((iVar2 != 0) || (iVar2 = pstm_sub(local_58,local_a8,local_58), iVar2 != 0)
                         ) goto LAB_00477294;
                    }
                    else {
                      bVar11 = false;
                      if (((local_50 & 0xfff) != 0) && ((*local_58[0] & 1) != 0)) {
                        bVar11 = true;
                      }
                      if (bVar11) goto LAB_00477254;
                    }
                    iVar2 = pstm_div_2(local_68,local_68);
                    if ((iVar2 != 0) || (iVar2 = pstm_div_2(local_58,local_58), iVar2 != 0))
                    goto LAB_00477294;
                  }
                  while( true ) {
                    bVar11 = false;
                    if (((local_70 & 0xfff) != 0) && (((*local_78[0] ^ 1) & 1) != 0)) {
                      bVar11 = true;
                    }
                    if (!bVar11) break;
                    iVar2 = pstm_div_2(local_78,local_78);
                    if (iVar2 != 0) goto LAB_00477294;
                    bVar11 = false;
                    if (((local_40 & 0xfff) != 0) && ((*local_48[0] & 1) != 0)) {
                      bVar11 = true;
                    }
                    if (bVar11) {
LAB_00477b58:
                      iVar2 = pstm_add(local_48,local_98,local_48);
                      if ((iVar2 != 0) || (iVar2 = pstm_sub(local_38,local_a8,local_38), iVar2 != 0)
                         ) goto LAB_00477294;
                    }
                    else {
                      bVar11 = false;
                      if (((local_30 & 0xfff) != 0) && ((*local_38[0] & 1) != 0)) {
                        bVar11 = true;
                      }
                      if (bVar11) goto LAB_00477b58;
                    }
                    iVar2 = pstm_div_2(local_48,local_48);
                    if ((iVar2 != 0) || (iVar2 = pstm_div_2(local_38,local_38), iVar2 != 0))
                    goto LAB_00477294;
                  }
                  uVar4 = local_80 >> 0x18 & 1;
                  if (uVar4 == (local_70 >> 0x18 & 1)) {
                    uVar5 = local_80 & 0xfff;
                    if (uVar4 == 1) {
                      uVar4 = local_70 & 0xfff;
                      iVar2 = 1;
                      if ((uVar4 <= (local_80 & 0xfff)) && (iVar2 = -1, (local_80 & 0xfff) <= uVar4)
                         ) {
                        puVar6 = local_88[0] + uVar4;
                        puVar12 = local_78[0] + uVar4;
                        uVar5 = 0;
                        if (uVar4 != 0) {
                          do {
                            puVar6 = puVar6 + -1;
                            puVar12 = puVar12 + -1;
                            uVar5 = uVar5 + 1 & 0xffff;
                            if (*puVar6 < *puVar12) goto LAB_00477de8;
                            if (*puVar12 < *puVar6) {
                              iVar2 = -1;
                              goto LAB_00477dec;
                            }
                          } while (uVar5 < (local_70 & 0xfff));
                        }
                        iVar2 = 0;
                      }
                    }
                    else {
                      iVar2 = 1;
                      if ((uVar5 <= (local_70 & 0xfff)) && (iVar2 = -1, (local_70 & 0xfff) <= uVar5)
                         ) {
                        puVar6 = local_78[0] + uVar5;
                        puVar12 = local_88[0] + uVar5;
                        uVar4 = 0;
                        if (uVar5 != 0) {
                          do {
                            puVar6 = puVar6 + -1;
                            puVar12 = puVar12 + -1;
                            uVar4 = uVar4 + 1 & 0xffff;
                            if (*puVar6 < *puVar12) {
                              iVar2 = 1;
                              goto LAB_00477dec;
                            }
                            iVar2 = -1;
                            if (*puVar12 < *puVar6) goto LAB_00477dec;
                          } while (uVar4 < (local_80 & 0xfff));
                        }
                        iVar2 = 0;
                      }
                    }
                  }
                  else {
                    iVar2 = -1;
                    if (uVar4 != 1) {
LAB_00477de8:
                      iVar2 = 1;
                    }
                  }
LAB_00477dec:
                  if (iVar2 == -1) {
                    iVar2 = pstm_sub(local_78,local_88,local_78);
                    if ((iVar2 != 0) || (iVar2 = pstm_sub(local_48,local_68,local_48), iVar2 != 0))
                    goto LAB_00477294;
                    ppuVar10 = local_58;
                    ppuVar7 = local_38;
                  }
                  else {
                    iVar2 = pstm_sub(local_88,local_78,local_88);
                    if ((iVar2 != 0) || (iVar2 = pstm_sub(local_68,local_48,local_68), iVar2 != 0))
                    goto LAB_00477294;
                    ppuVar7 = local_58;
                    ppuVar10 = local_38;
                  }
                  iVar2 = pstm_sub(ppuVar7,ppuVar10,ppuVar7);
                  if (iVar2 != 0) goto LAB_00477294;
                } while ((local_80 & 0xfff) != 0);
                if ((((local_70 & 0xfff) == 0) || ((local_70 >> 0x18 & 1) == 1)) ||
                   (1 < (local_70 & 0xfff))) {
                  iVar2 = -1;
                }
                else {
                  iVar2 = -1;
                  if ((*local_78[0] < 2) && (*local_78[0] != 0)) {
                    do {
                      uVar4 = 0xffffffff;
                      if (((local_40 >> 0x18 & 1) != 1) && (uVar4 = 1, (local_40 & 0xfff) < 2)) {
                        uVar4 = (uint)(*local_48[0] != 0);
                      }
                      if (uVar4 != 0xffffffff) goto LAB_00478030;
                      iVar2 = pstm_add(local_48,param_3,local_48);
                    } while (iVar2 == 0);
                  }
                }
LAB_00477294:
                pstm_clear(local_48);
                goto LAB_004772ac;
              }
            }
            else {
LAB_004772ac:
              pstm_clear(local_38);
            }
            pstm_clear(local_58);
          }
          pstm_clear(local_68);
        }
        pstm_clear(local_78);
      }
      else {
        iVar2 = pstm_init_size(param_1,local_78,local_90 >> 0xc & 0xfff);
        if ((iVar2 == 0) && (local_98 != local_78)) {
          uVar5 = local_70 >> 0xc & 0xfff;
          uVar4 = local_90 & 0xfff;
          if (uVar5 < uVar4) {
            if (0x180 < uVar4) {
LAB_00477a30:
              iVar2 = -8;
              goto LAB_00476fcc;
            }
            if (uVar5 < uVar4) {
              puVar12 = (uint *)realloc(local_78[0],uVar4 << 2);
              if (puVar12 == (uint *)0x0) goto LAB_00477a30;
              uVar13 = local_70 & 0xff000fff;
              for (uVar5 = local_70 >> 0xc & 0xfff; local_78[0] = puVar12,
                  local_70 = uVar13 | uVar4 << 0xc, uVar5 < uVar4; uVar5 = uVar5 + 1 & 0xffff) {
                puVar12[uVar5] = 0;
              }
            }
          }
          uVar4 = 0;
          puVar12 = local_98[0];
          puVar6 = local_78[0];
          for (uVar5 = local_90 & 0xfff; uVar5 != 0; uVar5 = uVar5 - 1) {
            *puVar6 = *puVar12;
            puVar12 = puVar12 + 1;
            puVar6 = puVar6 + 1;
            uVar4 = local_90 & 0xfff;
          }
          iVar2 = (local_70 & 0xfff) - uVar4;
          if (uVar4 < (local_70 & 0xfff)) {
            do {
              iVar2 = iVar2 + -1;
              *puVar6 = 0;
              puVar6 = puVar6 + 1;
            } while (iVar2 != 0);
          }
          local_70 = local_70 & 0xfefff000 | local_90 & 0xfff | (local_90 >> 0x18 & 1) << 0x18;
          iVar2 = 0;
        }
LAB_00476fcc:
        if (iVar2 == 0) goto LAB_00476fd4;
      }
      pstm_clear(local_88);
    }
LAB_00477324:
    pstm_clear(local_98);
LAB_0047733c:
    pstm_clear(local_a8);
    return iVar2;
  }
  if (local_108 != param_3) {
    iVar2 = pstm_init_size(param_1,local_108,(uint)puVar12 >> 0xc & 0xfff);
    if ((iVar2 == 0) && (param_3 != local_108)) {
      puVar12 = param_3[2];
      uVar5 = local_100 >> 0xc & 0xfff;
      uVar4 = (uint)puVar12 & 0xfff;
      uVar13 = (uint)puVar12 & 0xfff;
      if (uVar5 < uVar4) {
        if (0x180 < uVar4) {
LAB_0047736c:
          iVar2 = -8;
          goto LAB_00476624;
        }
        if (uVar5 < uVar4) {
          puVar12 = (uint *)realloc(local_108[0],uVar4 << 2);
          if (puVar12 == (uint *)0x0) goto LAB_0047736c;
          uVar13 = local_100 & 0xff000fff | uVar4 << 0xc;
          uVar5 = local_100 >> 0xc & 0xfff;
          local_108[0] = puVar12;
          local_100 = uVar13;
          if (uVar5 < uVar4) {
            do {
              uVar13 = uVar5 + 1 & 0xffff;
              puVar12[uVar5] = 0;
              uVar5 = uVar13;
            } while (uVar13 < uVar4);
            puVar12 = param_3[2];
            uVar13 = (uint)puVar12 & 0xfff;
            goto LAB_00476598;
          }
        }
        puVar12 = param_3[2];
        uVar13 = (uint)puVar12 & 0xfff;
      }
LAB_00476598:
      puVar6 = *param_3;
      uVar4 = 0;
      puVar9 = local_108[0];
      for (uVar5 = uVar13; uVar5 != 0; uVar5 = uVar5 - 1) {
        *puVar9 = *puVar6;
        puVar6 = puVar6 + 1;
        puVar9 = puVar9 + 1;
        uVar4 = uVar13;
      }
      if (uVar4 < (local_100 & 0xfff)) {
        iVar2 = (local_100 & 0xfff) - uVar4;
        do {
          iVar2 = iVar2 + -1;
          *puVar9 = 0;
          puVar9 = puVar9 + 1;
        } while (iVar2 != 0);
      }
      local_100 = local_100 & 0xfefff000 | (uint)puVar12 & 0xfff | (uint)puVar12 & 0x1000000;
      iVar2 = 0;
    }
LAB_00476624:
    if (iVar2 != 0) {
      return iVar2;
    }
  }
  iVar2 = pstm_init_size(param_1,local_f8,(uint)param_2[2] >> 0xc & 0xfff);
  if (iVar2 != 0) goto LAB_00476b9c;
  if (param_2 != local_f8) {
    puVar12 = param_2[2];
    uVar5 = local_f0 >> 0xc & 0xfff;
    uVar4 = (uint)puVar12 & 0xfff;
    uVar13 = (uint)puVar12 & 0xfff;
    if (uVar5 < uVar4) {
      if (0x180 < uVar4) {
LAB_0047735c:
        iVar2 = -8;
        goto LAB_00476b9c;
      }
      if (uVar5 < uVar4) {
        puVar12 = (uint *)realloc(local_f8[0],uVar4 << 2);
        if (puVar12 == (uint *)0x0) goto LAB_0047735c;
        uVar13 = local_f0 & 0xff000fff | uVar4 << 0xc;
        uVar5 = local_f0 >> 0xc & 0xfff;
        local_f8[0] = puVar12;
        local_f0 = uVar13;
        if (uVar5 < uVar4) {
          do {
            uVar13 = uVar5 + 1 & 0xffff;
            puVar12[uVar5] = 0;
            uVar5 = uVar13;
          } while (uVar13 < uVar4);
          puVar12 = param_2[2];
          uVar13 = (uint)puVar12 & 0xfff;
          goto LAB_0047670c;
        }
      }
      puVar12 = param_2[2];
      uVar13 = (uint)puVar12 & 0xfff;
    }
LAB_0047670c:
    puVar6 = *param_2;
    uVar4 = 0;
    puVar9 = local_f8[0];
    for (uVar5 = uVar13; uVar5 != 0; uVar5 = uVar5 - 1) {
      *puVar9 = *puVar6;
      puVar6 = puVar6 + 1;
      puVar9 = puVar9 + 1;
      uVar4 = uVar13;
    }
    iVar2 = (local_f0 & 0xfff) - uVar4;
    if (uVar4 < (local_f0 & 0xfff)) {
      do {
        iVar2 = iVar2 + -1;
        *puVar9 = 0;
        puVar9 = puVar9 + 1;
      } while (iVar2 != 0);
    }
    local_f0 = local_f0 & 0xfefff000 | (uint)puVar12 & 0xfff;
  }
  local_f0 = local_f0 & 0xfeffffff;
  if (local_e8 == local_108) {
LAB_00476898:
    if (local_d8 == local_f8) {
LAB_0047698c:
      iVar2 = pstm_init_size(param_1,local_c8,0x60);
      if (iVar2 == 0) {
        iVar2 = pstm_init_size(param_1,local_b8,0x60);
        if (iVar2 == 0) {
          uVar5 = (local_b0 & 0xfeffffff) >> 0xc & 0xfff;
          bVar11 = uVar5 != 0;
          uVar4 = 0;
          puVar12 = local_b8[0];
          while (bVar11) {
            uVar4 = uVar4 + 1 & 0xffff;
            *puVar12 = 0;
            bVar11 = uVar4 < uVar5;
            puVar12 = puVar12 + 1;
          }
          *local_b8[0] = 1;
          local_b0 = local_b0 & 0xfefff000 | 1;
          uVar8 = 0;
          do {
            while( true ) {
              bVar11 = false;
              if (((local_e0 & 0xfff) != 0) && (((*local_e8[0] ^ 1) & 1) != 0)) {
                bVar11 = true;
              }
              if (!bVar11) break;
              iVar2 = pstm_div_2(local_e8,local_e8);
              if (iVar2 != 0) goto LAB_00476b24;
              bVar11 = false;
              if (((local_c0 & 0xfff) != 0) && ((*local_c8[0] & 1) != 0)) {
                bVar11 = true;
              }
              if (((bVar11) && (iVar2 = pstm_sub(local_c8,local_108,local_c8), iVar2 != 0)) ||
                 (iVar2 = pstm_div_2(local_c8,local_c8), iVar2 != 0)) goto LAB_00476b24;
            }
            while( true ) {
              bVar11 = false;
              if (((local_d0 & 0xfff) != 0) && (((*local_d8[0] ^ 1) & 1) != 0)) {
                bVar11 = true;
              }
              if (!bVar11) break;
              iVar2 = pstm_div_2(local_d8,local_d8);
              if (iVar2 != 0) goto LAB_00476b24;
              bVar11 = false;
              if (((local_b0 & 0xfff) != 0) && ((*local_b8[0] & 1) != 0)) {
                bVar11 = true;
              }
              if (((bVar11) && (iVar2 = pstm_sub(local_b8,local_108,local_b8), iVar2 != 0)) ||
                 (iVar2 = pstm_div_2(local_b8,local_b8), iVar2 != 0)) goto LAB_00476b24;
            }
            uVar4 = local_e0 >> 0x18 & 1;
            if (uVar4 == (local_d0 >> 0x18 & 1)) {
              uVar5 = local_e0 & 0xfff;
              if (uVar4 == 1) {
                uVar4 = local_d0 & 0xfff;
                iVar2 = 1;
                if ((uVar4 <= (local_e0 & 0xfff)) && (iVar2 = -1, (local_e0 & 0xfff) <= uVar4)) {
                  puVar6 = local_e8[0] + uVar4;
                  puVar12 = local_d8[0] + uVar4;
                  uVar5 = 0;
                  if (uVar4 != 0) {
                    do {
                      puVar6 = puVar6 + -1;
                      puVar12 = puVar12 + -1;
                      uVar5 = uVar5 + 1 & 0xffff;
                      if (*puVar6 < *puVar12) {
                        iVar2 = 1;
                        goto LAB_0047786c;
                      }
                      if (*puVar12 < *puVar6) {
                        iVar2 = -1;
                        goto LAB_0047786c;
                      }
                    } while (uVar5 < (local_d0 & 0xfff));
                  }
                  iVar2 = 0;
                }
              }
              else {
                iVar2 = 1;
                if ((uVar5 <= (local_d0 & 0xfff)) && (iVar2 = -1, (local_d0 & 0xfff) <= uVar5)) {
                  puVar6 = local_d8[0] + uVar5;
                  puVar12 = local_e8[0] + uVar5;
                  uVar4 = 0;
                  if (uVar5 != 0) {
                    do {
                      puVar6 = puVar6 + -1;
                      puVar12 = puVar12 + -1;
                      uVar4 = uVar4 + 1 & 0xffff;
                      if (*puVar6 < *puVar12) {
                        iVar2 = 1;
                        goto LAB_0047786c;
                      }
                      if (*puVar12 < *puVar6) {
                        iVar2 = -1;
                        goto LAB_0047786c;
                      }
                    } while (uVar4 < (local_e0 & 0xfff));
                  }
                  iVar2 = 0;
                }
              }
            }
            else {
              iVar2 = -1;
              if (uVar4 != 1) {
                iVar2 = 1;
              }
            }
LAB_0047786c:
            if (iVar2 == -1) {
              iVar2 = pstm_sub(local_d8,local_e8,local_d8);
              ppuVar7 = local_c8;
              ppuVar10 = local_b8;
            }
            else {
              iVar2 = pstm_sub(local_e8,local_d8,local_e8);
              ppuVar7 = local_b8;
              ppuVar10 = local_c8;
            }
            if ((iVar2 != 0) || (iVar2 = pstm_sub(ppuVar10,ppuVar7,ppuVar10), iVar2 != 0))
            goto LAB_00476b24;
            bVar11 = 0x1000 < uVar8;
            uVar8 = uVar8 + 1;
            if (bVar11) {
              iVar2 = -9;
              goto LAB_00476b24;
            }
          } while ((local_e0 & 0xfff) != 0);
          if ((((local_d0 & 0xfff) == 0) || ((local_d0 >> 0x18 & 1) == 1)) ||
             (1 < (local_d0 & 0xfff))) {
            iVar2 = -1;
          }
          else {
            iVar2 = -1;
            if ((*local_d8[0] < 2) && (*local_d8[0] != 0)) {
              bVar1 = *(byte *)((int)param_2 + 0xb);
joined_r0x00477c64:
              if ((local_b0 >> 0x18 & 1) == 1) goto LAB_00477d84;
              if (local_b8 == param_4) goto LAB_00477d58;
              puVar12 = param_4[2];
              uVar5 = local_b0 & 0xfff;
              uVar4 = (uint)puVar12 >> 0xc & 0xfff;
              if (uVar5 <= uVar4) goto LAB_00477cc0;
              if (uVar5 < 0x181) {
                if (uVar4 < uVar5) {
                  puVar12 = (uint *)realloc(*param_4,uVar5 << 2);
                  if (puVar12 == (uint *)0x0) goto LAB_004783b4;
                  puVar6 = param_4[2];
                  *param_4 = puVar12;
                  param_4[2] = (uint *)((uint)puVar6 & 0xff000fff | uVar5 << 0xc);
                  for (uVar4 = (uint)puVar6 >> 0xc & 0xfff; uVar4 < uVar5;
                      uVar4 = uVar4 + 1 & 0xffff) {
                    puVar12[uVar4] = 0;
                  }
                }
                puVar12 = param_4[2];
LAB_00477cc0:
                puVar6 = *param_4;
                uVar5 = 0;
                for (uVar4 = local_b0 & 0xfff; uVar4 != 0; uVar4 = uVar4 - 1) {
                  *puVar6 = *local_b8[0];
                  local_b8[0] = local_b8[0] + 1;
                  puVar6 = puVar6 + 1;
                  uVar5 = local_b0 & 0xfff;
                }
                iVar2 = ((uint)puVar12 & 0xfff) - uVar5;
                if (uVar5 < ((uint)puVar12 & 0xfff)) {
                  do {
                    iVar2 = iVar2 + -1;
                    *puVar6 = 0;
                    puVar6 = puVar6 + 1;
                  } while (iVar2 != 0);
                }
                param_4[2] = (uint *)((uint)param_4[2] & 0xfefff000 | local_b0 & 0xfff |
                                     local_b0 & 0x1000000);
LAB_00477d58:
                iVar2 = 0;
                param_4[2] = (uint *)((uint)param_4[2] & 0xfeffffff | (bVar1 & 1) << 0x18);
                goto LAB_00476b24;
              }
LAB_004783b4:
              iVar2 = -8;
            }
          }
LAB_00476b24:
          pstm_clear(local_b8);
        }
        pstm_clear(local_c8);
      }
      pstm_clear(local_d8);
    }
    else {
      iVar2 = pstm_init_size(param_1,local_d8,local_f0 >> 0xc & 0xfff);
      if ((iVar2 == 0) && (local_f8 != local_d8)) {
        uVar5 = local_d0 >> 0xc & 0xfff;
        uVar4 = local_f0 & 0xfff;
        if (uVar5 < uVar4) {
          if (0x180 < uVar4) {
LAB_00477838:
            iVar2 = -8;
            goto LAB_00476984;
          }
          if (uVar5 < uVar4) {
            puVar12 = (uint *)realloc(local_d8[0],uVar4 << 2);
            if (puVar12 == (uint *)0x0) goto LAB_00477838;
            uVar13 = local_d0 & 0xff000fff | uVar4 << 0xc;
            uVar5 = local_d0 >> 0xc & 0xfff;
            local_d8[0] = puVar12;
            local_d0 = uVar13;
            if (uVar5 < uVar4) {
              do {
                uVar13 = uVar5 + 1 & 0xffff;
                puVar12[uVar5] = 0;
                uVar5 = uVar13;
              } while (uVar13 < uVar4);
              uVar4 = local_f0 & 0xfff;
              goto LAB_004768f8;
            }
          }
          uVar4 = local_f0 & 0xfff;
        }
        else {
          uVar4 = local_f0 & 0xfff;
        }
LAB_004768f8:
        uVar5 = 0;
        puVar12 = local_f8[0];
        puVar6 = local_d8[0];
        for (uVar13 = uVar4; uVar13 != 0; uVar13 = uVar13 - 1) {
          *puVar6 = *puVar12;
          puVar12 = puVar12 + 1;
          puVar6 = puVar6 + 1;
          uVar5 = uVar4;
        }
        iVar2 = (local_d0 & 0xfff) - uVar5;
        if (uVar5 < (local_d0 & 0xfff)) {
          do {
            iVar2 = iVar2 + -1;
            *puVar6 = 0;
            puVar6 = puVar6 + 1;
          } while (iVar2 != 0);
        }
        local_d0 = local_d0 & 0xfefff000 | local_f0 & 0xfff | (local_f0 >> 0x18 & 1) << 0x18;
        iVar2 = 0;
      }
LAB_00476984:
      if (iVar2 == 0) goto LAB_0047698c;
    }
    pstm_clear(local_e8);
  }
  else {
    iVar2 = pstm_init_size(param_1,local_e8,local_100 >> 0xc & 0xfff);
    if ((iVar2 == 0) && (local_108 != local_e8)) {
      uVar5 = local_e0 >> 0xc & 0xfff;
      uVar4 = local_100 & 0xfff;
      if (uVar5 < uVar4) {
        if (0x180 < uVar4) {
LAB_0047782c:
          iVar2 = -8;
          goto LAB_00476890;
        }
        if (uVar5 < uVar4) {
          puVar12 = (uint *)realloc(local_e8[0],uVar4 << 2);
          if (puVar12 == (uint *)0x0) goto LAB_0047782c;
          uVar13 = local_e0 & 0xff000fff | uVar4 << 0xc;
          uVar5 = local_e0 >> 0xc & 0xfff;
          local_e8[0] = puVar12;
          local_e0 = uVar13;
          if (uVar5 < uVar4) {
            do {
              uVar13 = uVar5 + 1 & 0xffff;
              puVar12[uVar5] = 0;
              uVar5 = uVar13;
            } while (uVar13 < uVar4);
            uVar4 = local_100 & 0xfff;
            goto LAB_00476804;
          }
        }
        uVar4 = local_100 & 0xfff;
      }
      else {
        uVar4 = local_100 & 0xfff;
      }
LAB_00476804:
      uVar5 = 0;
      puVar12 = local_108[0];
      puVar6 = local_e8[0];
      for (uVar13 = uVar4; uVar13 != 0; uVar13 = uVar13 - 1) {
        *puVar6 = *puVar12;
        puVar12 = puVar12 + 1;
        puVar6 = puVar6 + 1;
        uVar5 = uVar4;
      }
      iVar2 = (local_e0 & 0xfff) - uVar5;
      if (uVar5 < (local_e0 & 0xfff)) {
        do {
          iVar2 = iVar2 + -1;
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        } while (iVar2 != 0);
      }
      local_e0 = local_e0 & 0xfefff000 | local_100 & 0xfff | (local_100 >> 0x18 & 1) << 0x18;
      iVar2 = 0;
    }
LAB_00476890:
    if (iVar2 == 0) goto LAB_00476898;
  }
  pstm_clear(local_f8);
LAB_00476b9c:
  pstm_clear(local_108);
  return iVar2;
LAB_00478030:
  uVar4 = local_40 & 0xfff;
  iVar2 = 1;
  if ((uVar4 <= ((uint)param_3[2] & 0xfff)) && (iVar2 = -1, ((uint)param_3[2] & 0xfff) <= uVar4)) {
    puVar12 = local_48[0] + uVar4;
    puVar6 = *param_3 + uVar4;
    uVar5 = 0;
    if (uVar4 != 0) {
      do {
        puVar6 = puVar6 + -1;
        puVar12 = puVar12 + -1;
        uVar5 = uVar5 + 1 & 0xffff;
        if (*puVar6 < *puVar12) {
          iVar2 = 1;
          goto LAB_00478158;
        }
        if (*puVar12 < *puVar6) {
          iVar2 = -1;
          goto LAB_00478158;
        }
      } while (uVar5 < (local_40 & 0xfff));
    }
    iVar2 = 0;
  }
LAB_00478158:
  if (iVar2 != -1) goto code_r0x00478160;
  iVar2 = 0;
  if (local_48 != param_4) {
    puVar12 = param_4[2];
    uVar5 = local_40 & 0xfff;
    uVar4 = (uint)puVar12 >> 0xc & 0xfff;
    if (uVar5 <= uVar4) goto LAB_004781e4;
    if (uVar5 < 0x181) {
      if (uVar4 < uVar5) {
        puVar12 = (uint *)realloc(*param_4,uVar5 << 2);
        if (puVar12 == (uint *)0x0) goto LAB_0047830c;
        puVar6 = param_4[2];
        *param_4 = puVar12;
        param_4[2] = (uint *)((uint)puVar6 & 0xff000fff | uVar5 << 0xc);
        for (uVar4 = (uint)puVar6 >> 0xc & 0xfff; uVar4 < uVar5; uVar4 = uVar4 + 1 & 0xffff) {
          puVar12[uVar4] = 0;
        }
      }
      puVar12 = param_4[2];
LAB_004781e4:
      puVar6 = *param_4;
      uVar5 = 0;
      for (uVar4 = local_40 & 0xfff; uVar4 != 0; uVar4 = uVar4 - 1) {
        *puVar6 = *local_48[0];
        local_48[0] = local_48[0] + 1;
        puVar6 = puVar6 + 1;
        uVar5 = local_40 & 0xfff;
      }
      if (uVar5 < ((uint)puVar12 & 0xfff)) {
        iVar2 = ((uint)puVar12 & 0xfff) - uVar5;
        do {
          iVar2 = iVar2 + -1;
          *puVar6 = 0;
          puVar6 = puVar6 + 1;
        } while (iVar2 != 0);
      }
      param_4[2] = (uint *)((uint)param_4[2] & 0xfefff000 | local_40 & 0xfff | local_40 & 0x1000000)
      ;
      iVar2 = 0;
      goto LAB_00477294;
    }
LAB_0047830c:
    iVar2 = -8;
  }
  goto LAB_00477294;
code_r0x00478160:
  iVar2 = pstm_sub(local_48,param_3,local_48);
  if (iVar2 != 0) goto LAB_00477294;
  goto LAB_00478030;
LAB_00477d84:
  iVar2 = pstm_add(local_b8,param_3,local_b8);
  if (iVar2 != 0) goto LAB_00476b24;
  goto joined_r0x00477c64;
}



undefined4
pstm_montgomery_reduce
          (undefined4 param_1,uint **param_2,uint **param_3,int param_4,uint *param_5,ushort param_6
          )

{
  longlong lVar1;
  uint *__s;
  int iVar2;
  uint *puVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint *puVar7;
  uint *puVar8;
  uint *puVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  undefined4 uVar14;
  uint uVar15;
  uint *puVar16;
  uint uVar17;
  
  uVar15 = (uint)param_3[2] & 0xfff;
  if (((uint)param_2[2] >> 0xc & 0xfff) < uVar15) {
    return 0xfffffff7;
  }
  uVar13 = uVar15 * 8 + 4;
  if ((param_5 == (uint *)0x0) || (param_6 < uVar13)) {
    __s = (uint *)malloc(uVar13);
    if (__s == (uint *)0x0) {
      return 0xfffffff8;
    }
    memset(__s,0,uVar13);
    puVar8 = param_2[2];
  }
  else {
    memset(param_5,0,(uint)param_6);
    puVar8 = param_2[2];
    __s = param_5;
  }
  uVar13 = (uint)puVar8 & 0xfff;
  if (uVar13 == 0) {
    puVar8 = *param_2;
  }
  else {
    puVar8 = *param_2;
    iVar2 = 0;
    do {
      iVar4 = iVar2 + 1;
      __s[iVar2] = puVar8[iVar2];
      iVar2 = iVar4;
    } while (iVar4 < (int)uVar13);
  }
  if (uVar15 != 0) {
    puVar16 = *param_3;
    puVar9 = __s;
    uVar10 = uVar15;
    do {
      uVar17 = *puVar9;
      uVar6 = 0;
      puVar3 = puVar9;
      uVar5 = uVar15;
      puVar7 = puVar16;
      if (uVar15 != 0) {
        do {
          uVar5 = uVar5 - 1;
          lVar1 = (ulonglong)(uVar17 * param_4) * (ulonglong)*puVar7;
          uVar11 = (int)lVar1 + uVar6;
          uVar12 = uVar11 + *puVar3;
          uVar6 = (int)((ulonglong)lVar1 >> 0x20) + (uint)(uVar11 < uVar6) +
                  (uint)(uVar12 < *puVar3);
          *puVar3 = uVar12;
          puVar3 = puVar3 + 1;
          puVar7 = puVar7 + 1;
        } while (uVar5 != 0);
        for (; uVar6 != 0; uVar6 = (uint)(uVar5 + uVar6 < uVar6)) {
          uVar5 = *puVar3;
          *puVar3 = uVar5 + uVar6;
          puVar3 = puVar3 + 1;
        }
      }
      uVar10 = uVar10 - 1;
      puVar9 = puVar9 + 1;
    } while (uVar10 != 0);
  }
  puVar9 = __s + uVar15;
  uVar15 = uVar15 + 1;
  uVar6 = 0;
  for (uVar10 = uVar15; uVar10 != 0; uVar10 = uVar10 - 1) {
    *puVar8 = *puVar9;
    puVar9 = puVar9 + 1;
    puVar8 = puVar8 + 1;
    uVar6 = uVar15;
  }
  iVar2 = uVar13 - uVar6;
  if (uVar6 < uVar13) {
    do {
      iVar2 = iVar2 + -1;
      *puVar8 = 0;
      puVar8 = puVar8 + 1;
    } while (iVar2 != 0);
  }
  param_2[2] = (uint *)((uint)param_2[2] & 0xfffff000 | uVar15 & 0xfff);
  pstm_clamp(param_2);
  iVar2 = pstm_cmp_mag(param_2,param_3);
  uVar14 = 0;
  if ((iVar2 != -1) && (iVar2 = pstm_sub_s(param_2,param_3,param_2), iVar2 != 0)) {
    uVar14 = 0xfffffff8;
  }
  if ((__s != (uint *)0x0) && (__s != param_5)) {
    free(__s);
  }
  return uVar14;
}



undefined4
pstm_mul_comba(undefined4 param_1,int *param_2,int *param_3,uint **param_4,uint *param_5,
              ushort param_6)

{
  bool bVar1;
  bool bVar2;
  uint *__s;
  int iVar3;
  int iVar4;
  uint *puVar5;
  uint *puVar6;
  uint *puVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  int iVar12;
  uint uVar13;
  uint uVar14;
  int iVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  
  uVar16 = (param_2[2] & 0xfffU) + (param_3[2] & 0xfffU);
  uVar17 = (uint)param_6;
  bVar2 = false;
  if ((((uint)param_4[2] >> 0xc & 0xfff) < uVar16) &&
     (iVar10 = pstm_grow(param_4,uVar16), iVar10 != 0)) {
    return 0xfffffff8;
  }
  uVar14 = uVar16 * 4;
  if (param_5 == (uint *)0x0) {
    __s = (uint *)malloc(uVar14);
  }
  else {
    __s = param_5;
    if (uVar14 <= uVar17) goto LAB_00478770;
    __s = (uint *)malloc(uVar14);
    bVar2 = true;
  }
  uVar17 = uVar14;
  if (__s == (uint *)0x0) {
    return 0xfffffff8;
  }
LAB_00478770:
  bVar1 = uVar16 != 0;
  memset(__s,0,uVar17);
  iVar10 = 0;
  if (bVar1) {
    uVar18 = param_3[2];
    uVar11 = param_2[2];
    iVar15 = *param_2;
    iVar12 = *param_3;
    puVar6 = __s;
    uVar17 = 0;
    uVar14 = 0;
    do {
      iVar3 = (uVar18 & 0xfff) - 1;
      if (iVar10 < iVar3) {
        iVar3 = iVar10;
      }
      iVar8 = (uVar11 & 0xfff) - (iVar10 - iVar3);
      puVar7 = (uint *)(iVar15 + (iVar10 - iVar3) * 4);
      puVar5 = (uint *)(iVar12 + iVar3 * 4);
      iVar4 = iVar3 + 1;
      if (iVar8 < iVar3 + 1) {
        iVar4 = iVar8;
      }
      uVar13 = 0;
      if (0 < iVar4) {
        do {
          iVar4 = iVar4 + -1;
          uVar9 = *puVar7;
          puVar7 = puVar7 + 1;
          uVar19 = (uint)((ulonglong)uVar9 * (ulonglong)*puVar5);
          uVar20 = (uint)((ulonglong)uVar9 * (ulonglong)*puVar5 >> 0x20);
          uVar17 = uVar17 + uVar19;
          uVar9 = (uint)(uVar17 < uVar19);
          uVar19 = uVar14 + uVar20;
          uVar14 = uVar19 + uVar9;
          uVar13 = uVar13 + (uVar19 < uVar20) + (uint)(uVar14 < uVar9);
          puVar5 = puVar5 + -1;
        } while (iVar4 != 0);
      }
      iVar10 = iVar10 + 1;
      *puVar6 = uVar17;
      puVar6 = puVar6 + 1;
      uVar17 = uVar14;
      uVar14 = uVar13;
    } while (iVar10 < (int)uVar16);
  }
  puVar7 = param_4[2];
  param_4[2] = (uint *)((uint)puVar7 & 0xfffff000 | uVar16 & 0xfff);
  param_4[2] = (uint *)((uint)puVar7 & 0xfefff000 | uVar16 & 0xfff |
                       ((*(byte *)((int)param_3 + 0xb) ^ *(byte *)((int)param_2 + 0xb)) & 1) << 0x18
                       );
  puVar6 = *param_4;
  uVar17 = uVar16;
  uVar14 = 0;
  puVar5 = __s;
  while (bVar1) {
    uVar17 = uVar17 - 1;
    *puVar6 = *puVar5;
    puVar5 = puVar5 + 1;
    bVar1 = uVar17 != 0;
    puVar6 = puVar6 + 1;
    uVar14 = uVar16;
  }
  iVar10 = ((uint)puVar7 & 0xfff) - uVar14;
  if (uVar14 < ((uint)puVar7 & 0xfff)) {
    do {
      iVar10 = iVar10 + -1;
      *puVar6 = 0;
      puVar6 = puVar6 + 1;
    } while (iVar10 != 0);
  }
  pstm_clamp(param_4);
  if ((param_5 == (uint *)0x0) || (bVar2)) {
    free(__s);
  }
  return 0;
}



undefined4
pstm_sqr_comba(undefined4 param_1,int *param_2,uint **param_3,uint *param_4,ushort param_5)

{
  bool bVar1;
  longlong lVar2;
  bool bVar3;
  uint *__s;
  uint uVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  uint *puVar9;
  uint *puVar10;
  int iVar11;
  uint uVar12;
  int iVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint *puVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  
  uVar5 = param_2[2] & 0xfff;
  uVar19 = uVar5 << 1;
  uVar20 = (uint)param_5;
  bVar3 = false;
  if ((((uint)param_3[2] >> 0xc & 0xfff) < uVar19) &&
     (iVar6 = pstm_grow(param_3,uVar19), iVar6 != 0)) {
    return 0xfffffff8;
  }
  uVar18 = uVar5 << 3;
  if (param_4 == (uint *)0x0) {
    __s = (uint *)malloc(uVar18);
  }
  else {
    __s = param_4;
    if (uVar18 <= uVar20) goto LAB_00478a94;
    __s = (uint *)malloc(uVar18);
    bVar3 = true;
  }
  uVar20 = uVar18;
  if (__s == (uint *)0x0) {
    return 0xfffffff8;
  }
LAB_00478a94:
  bVar1 = uVar5 != 0;
  memset(__s,0,uVar20);
  uVar20 = 0;
  if (bVar1) {
    uVar12 = param_2[2];
    iVar6 = *param_2;
    uVar5 = 0;
    uVar18 = 0;
    puVar17 = __s;
    do {
      uVar7 = (uVar12 & 0xfff) - 1;
      if ((int)uVar20 < (int)uVar7) {
        uVar7 = uVar20;
      }
      iVar11 = uVar20 - uVar7;
      iVar13 = (uVar12 & 0xfff) - iVar11;
      puVar10 = (uint *)(iVar6 + iVar11 * 4);
      puVar9 = (uint *)(iVar6 + uVar7 * 4);
      iVar8 = uVar7 + 1;
      if (iVar13 < (int)(uVar7 + 1)) {
        iVar8 = iVar13;
      }
      iVar11 = (int)((uVar7 - iVar11) + 1) >> 1;
      if (iVar11 < iVar8) {
        iVar8 = iVar11;
      }
      uVar7 = 0;
      if (0 < iVar8) {
        do {
          iVar8 = iVar8 + -1;
          uVar4 = *puVar10;
          puVar10 = puVar10 + 1;
          uVar21 = (uint)((ulonglong)uVar4 * (ulonglong)*puVar9);
          uVar22 = (uint)((ulonglong)uVar4 * (ulonglong)*puVar9 >> 0x20);
          uVar4 = (uint)(uVar5 + uVar21 < uVar21);
          uVar14 = uVar18 + uVar22;
          uVar15 = uVar14 + uVar4;
          uVar5 = uVar5 + uVar21 + uVar21;
          uVar16 = uVar15 + uVar22;
          uVar18 = uVar16 + (uVar5 < uVar21);
          uVar7 = uVar7 + (uVar14 < uVar22) + (uint)(uVar15 < uVar4) + (uint)(uVar16 < uVar22) +
                  (uint)(uVar18 < (uVar5 < uVar21));
          puVar9 = puVar9 + -1;
        } while (iVar8 != 0);
      }
      if (((uVar20 ^ 1) & 1) != 0) {
        uVar4 = *(uint *)(((int)uVar20 >> 1) * 4 + iVar6);
        lVar2 = (ulonglong)uVar4 * (ulonglong)uVar4;
        uVar4 = (uint)lVar2;
        uVar15 = (uint)((ulonglong)lVar2 >> 0x20);
        uVar5 = uVar5 + uVar4;
        uVar4 = (uint)(uVar5 < uVar4);
        uVar14 = uVar18 + uVar15;
        uVar18 = uVar14 + uVar4;
        uVar7 = uVar7 + (uVar14 < uVar15) + (uint)(uVar18 < uVar4);
      }
      uVar20 = uVar20 + 1;
      *puVar17 = uVar5;
      puVar17 = puVar17 + 1;
      uVar5 = uVar18;
      uVar18 = uVar7;
    } while ((int)uVar20 < (int)uVar19);
  }
  puVar17 = param_3[2];
  param_3[2] = (uint *)((uint)puVar17 & 0xfffff000 | uVar19 & 0xfff);
  uVar18 = (uint)puVar17 & 0xfff;
  puVar17 = *param_3;
  uVar20 = uVar19;
  uVar5 = 0;
  puVar9 = __s;
  while (bVar1) {
    uVar20 = uVar20 - 1;
    *puVar17 = *puVar9;
    puVar9 = puVar9 + 1;
    bVar1 = uVar20 != 0;
    puVar17 = puVar17 + 1;
    uVar5 = uVar19;
  }
  iVar6 = uVar18 - uVar5;
  if (uVar5 < uVar18) {
    do {
      iVar6 = iVar6 + -1;
      *puVar17 = 0;
      puVar17 = puVar17 + 1;
    } while (iVar6 != 0);
  }
  pstm_clamp(param_3);
  if ((param_4 == (uint *)0x0) || (bVar3)) {
    free(__s);
  }
  return 0;
}



void psOpenPrng(void)

{
  psCreateMutex(&DAT_004dad5c,0);
  DAT_004d78e8 = 1;
  DAT_004dad74 = 0;
  return;
}



void psClosePrng(void)

{
  (*(code *)(undefined *)0x0)(&DAT_004dad5c);
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



undefined4 psGetPrngLocked(undefined4 param_1,uint param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
  uVar1 = 0xffffffff;
  if (DAT_004d78e8 != 0) {
    psLockMutex(&DAT_004dad5c);
    DAT_004dad74 = DAT_004dad74 + (param_2 & 0xffff);
    uVar1 = psGetEntropy(param_1,param_2 & 0xffff,param_3);
    psUnlockMutex(&DAT_004dad5c);
  }
  return uVar1;
}



undefined4 psEccInitKey(undefined4 param_1,void *param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
  uVar1 = 0xfffffff8;
  if (param_2 != (void *)0x0) {
    memset(param_2,0,0x40);
    *(undefined4 *)((int)param_2 + 0x34) = param_3;
    *(undefined4 *)((int)param_2 + 0x30) = param_1;
    *(undefined4 *)((int)param_2 + 0x38) = param_1;
    uVar1 = 0;
  }
  return uVar1;
}



void psEccClearKey(int param_1)

{
  if (param_1 == 0) {
    _psTraceStr("psAssert %s","pubkey/ecc.c");
    _psTraceInt(&DAT_0049016c,0xff);
    _psError(&DAT_00492674);
  }
  pstm_clear(param_1);
  pstm_clear_multi(param_1 + 0xc,param_1 + 0x18,param_1 + 0x24,0,0,0,0,0);
  *(undefined *)(param_1 + 0x3c) = 0;
  *(undefined4 *)(param_1 + 0x34) = 0;
  *(undefined4 *)(param_1 + 0x38) = 0;
  *(undefined4 *)(param_1 + 0x30) = 0;
  return;
}



undefined4 psEccNewKey(undefined4 param_1,void **param_2,undefined4 param_3)

{
  void *__s;
  undefined4 uVar1;
  
  __s = malloc(0x40);
  uVar1 = 0xfffffff8;
  if (__s != (void *)0x0) {
    *(undefined *)((int)__s + 0x3c) = 0;
    memset(__s,0,0x40);
    *param_2 = __s;
    *(undefined4 *)((int)__s + 0x30) = param_1;
    *(undefined4 *)((int)__s + 0x34) = param_3;
    *(undefined4 *)((int)__s + 0x38) = param_1;
    uVar1 = 0;
  }
  return uVar1;
}



int psEccCopyKey(int param_1,int param_2)

{
  undefined uVar1;
  undefined4 uVar2;
  int iVar3;
  
  iVar3 = *(int *)(param_1 + 0x38);
  if (iVar3 == 0) {
    iVar3 = *(int *)(param_2 + 0x38);
    uVar2 = *(undefined4 *)(param_2 + 0x30);
    *(int *)(param_1 + 0x38) = iVar3;
    *(undefined4 *)(param_1 + 0x30) = uVar2;
  }
  else {
    *(int *)(param_1 + 0x30) = iVar3;
  }
  uVar1 = *(undefined *)(param_2 + 0x3c);
  *(undefined4 *)(param_1 + 0x34) = *(undefined4 *)(param_2 + 0x34);
  *(undefined *)(param_1 + 0x3c) = uVar1;
  iVar3 = pstm_init_copy(iVar3,param_1 + 0xc,param_2 + 0xc,0);
  if (((iVar3 == 0) &&
      (iVar3 = pstm_init_copy(*(undefined4 *)(param_1 + 0x38),param_1 + 0x18,param_2 + 0x18,0),
      iVar3 == 0)) &&
     (iVar3 = pstm_init_copy(*(undefined4 *)(param_1 + 0x38),param_1 + 0x24,param_2 + 0x24,0),
     iVar3 == 0)) {
    if (*(char *)(param_1 + 0x3c) != '\x02') {
      return 0;
    }
    iVar3 = pstm_init_copy(*(undefined4 *)(param_1 + 0x38),param_1,param_2,0);
  }
  if (-1 < iVar3) {
    return iVar3;
  }
  if (param_2 == 0) {
    _psTraceStr("psAssert %s","pubkey/ecc.c");
    _psTraceInt(&DAT_0049016c,0xff);
    _psError(&DAT_00492674);
  }
  pstm_clear(param_2);
  pstm_clear_multi(param_2 + 0xc,param_2 + 0x18,param_2 + 0x24,0,0,0,0,0);
  *(undefined *)(param_2 + 0x3c) = 0;
  *(undefined4 *)(param_2 + 0x34) = 0;
  *(undefined4 *)(param_2 + 0x38) = 0;
  *(undefined4 *)(param_2 + 0x30) = 0;
  return iVar3;
}



void psEccDeleteKey(void **param_1)

{
  void *__ptr;
  
  __ptr = *param_1;
  if (__ptr == (void *)0x0) {
    _psTraceStr("psAssert %s","pubkey/ecc.c");
    _psTraceInt(&DAT_0049016c,0xff);
    _psError(&DAT_00492674);
  }
  pstm_clear(__ptr);
  pstm_clear_multi((int)__ptr + 0xc,(int)__ptr + 0x18,(int)__ptr + 0x24,0,0,0,0,0);
  *(undefined4 *)((int)__ptr + 0x34) = 0;
  *(undefined4 *)((int)__ptr + 0x38) = 0;
  *(undefined4 *)((int)__ptr + 0x30) = 0;
  *(undefined *)((int)__ptr + 0x3c) = 0;
  free(__ptr);
  *param_1 = (void *)0x0;
  return;
}



int psEccSize(int param_1)

{
  if ((param_1 != 0) && (*(byte **)(param_1 + 0x34) != (byte *)0x0)) {
    return (**(byte **)(param_1 + 0x34) & 0x7f) << 1;
  }
  return 0;
}



undefined4 getEccParamByOid(int param_1,char **param_2)

{
  char *pcVar1;
  
  if (DAT_004d78ec != '\0') {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(int *)(pcVar1 + 8) == param_1) {
        *param_2 = pcVar1;
        return 0;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  *param_2 = (char *)0x0;
  return 0xffffffff;
}



undefined4 getEccParamById(short param_1,char **param_2)

{
  short *psVar1;
  char *pcVar2;
  char *pcVar3;
  
  if (param_1 == 0) {
    *param_2 = &DAT_004d78ec;
    return 0;
  }
  if (DAT_004d78ec != '\0') {
    pcVar2 = &DAT_004d78ec;
    pcVar3 = pcVar2;
    do {
      psVar1 = (short *)(pcVar2 + 2);
      pcVar2 = pcVar2 + 0x28;
      if (*psVar1 == param_1) {
        *param_2 = pcVar3;
        return 0;
      }
      pcVar3 = pcVar3 + 0x28;
    } while (*pcVar2 != '\0');
  }
  *param_2 = (char *)0x0;
  return 0xffffffff;
}



void psGetEccCurveIdList(int param_1,byte *param_2)

{
  undefined2 uVar1;
  int iVar2;
  undefined *puVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  uVar5 = 0;
  uVar4 = 0;
  if (DAT_004d78ec != '\0') {
    iVar2 = 0;
    do {
      iVar2 = iVar2 + uVar4;
      uVar4 = uVar4 + 1 & 0xffff;
      uVar6 = uVar5 + 1 & 0xffff;
      puVar3 = (undefined *)(uVar5 + param_1);
      if ((int)uVar5 < (int)(*param_2 - 2)) {
        uVar1 = (&DAT_004d78ee)[iVar2 * 4];
        uVar5 = uVar6 + 1 & 0xffff;
        *puVar3 = (char)((ushort)uVar1 >> 8);
        *(char *)(uVar6 + param_1) = (char)uVar1;
      }
      iVar2 = uVar4 << 2;
    } while ((&DAT_004d78ec)[uVar4 * 0x28] != '\0');
  }
  *param_2 = (byte)uVar5;
  return;
}



void userSuppliedEccList(undefined *param_1,byte *param_2,uint param_3)

{
  char *pcVar1;
  uint uVar2;
  int iVar3;
  
  uVar2 = 0;
  if (((param_3 >> 4 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0x19) {
        if (0 < (int)(*param_2 - 2)) {
          uVar2 = 2;
          *param_1 = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          param_1[1] = (char)*(undefined2 *)(pcVar1 + 2);
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  if (((param_3 >> 0x13 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0x1c) {
        if ((int)uVar2 < (int)(*param_2 - 2)) {
          iVar3 = uVar2 + 1;
          param_1[uVar2] = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          uVar2 = uVar2 + 2;
          param_1[iVar3] = (char)*(undefined2 *)(pcVar1 + 2);
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  if (((param_3 >> 3 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0x18) {
        if ((int)uVar2 < (int)(*param_2 - 2)) {
          iVar3 = uVar2 + 1;
          param_1[uVar2] = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          uVar2 = uVar2 + 2;
          param_1[iVar3] = (char)*(undefined2 *)(pcVar1 + 2);
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  if (((param_3 >> 0x12 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0x1b) {
        if ((int)uVar2 < (int)(*param_2 - 2)) {
          iVar3 = uVar2 + 1;
          param_1[uVar2] = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          uVar2 = uVar2 + 2;
          param_1[iVar3] = (char)*(undefined2 *)(pcVar1 + 2);
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  if (((param_3 >> 2 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0x17) {
        if ((int)uVar2 < (int)(*param_2 - 2)) {
          iVar3 = uVar2 + 1;
          param_1[uVar2] = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          uVar2 = uVar2 + 2;
          param_1[iVar3] = (char)*(undefined2 *)(pcVar1 + 2);
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  if (((param_3 >> 0x11 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0x1a) {
        if ((int)uVar2 < (int)(*param_2 - 2)) {
          iVar3 = uVar2 + 1;
          param_1[uVar2] = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          uVar2 = uVar2 + 2;
          param_1[iVar3] = (char)*(undefined2 *)(pcVar1 + 2);
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  if (((param_3 >> 1 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0x15) {
        if ((int)uVar2 < (int)(*param_2 - 2)) {
          iVar3 = uVar2 + 1;
          param_1[uVar2] = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          uVar2 = uVar2 + 2;
          param_1[iVar3] = (char)*(undefined2 *)(pcVar1 + 2);
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  if (((param_3 >> 0x10 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0xff) {
        if ((int)uVar2 < (int)(*param_2 - 2)) {
          param_1[uVar2] = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          uVar2 = uVar2 + 1 & 0xff;
          param_1[uVar2] = (char)*(undefined2 *)(pcVar1 + 2);
          uVar2 = uVar2 + 1 & 0xff;
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  if (((param_3 & 1) != 0) && (DAT_004d78ec != '\0')) {
    pcVar1 = &DAT_004d78ec;
    do {
      if (*(short *)(pcVar1 + 2) == 0x13) {
        if ((int)uVar2 < (int)(*param_2 - 2)) {
          param_1[uVar2] = (char)((ushort)*(undefined2 *)(pcVar1 + 2) >> 8);
          uVar2 = uVar2 + 1 & 0xff;
          param_1[uVar2] = (char)*(undefined2 *)(pcVar1 + 2);
          *param_2 = (char)uVar2 + 1;
          return;
        }
        break;
      }
      pcVar1 = pcVar1 + 0x28;
    } while (*pcVar1 != '\0');
  }
  *param_2 = (byte)uVar2;
  return;
}



undefined4 compiledInEcFlags(void)

{
  return 0x1f;
}



void * FUN_00479ad4(undefined4 param_1,short param_2)

{
  void *__ptr;
  int iVar1;
  
  __ptr = malloc(0x28);
  if (__ptr == (void *)0x0) {
    return (void *)0x0;
  }
  *(undefined4 *)((int)__ptr + 0x24) = param_1;
  if (param_2 == 0) {
    iVar1 = pstm_init(param_1,__ptr);
    if (iVar1 != 0) goto LAB_00479c28;
    iVar1 = pstm_init(param_1,(int)__ptr + 0xc);
    if (iVar1 == 0) {
      iVar1 = pstm_init(param_1,(int)__ptr + 0x18);
LAB_00479bd0:
      if (iVar1 == 0) {
        return __ptr;
      }
      pstm_clear((int)__ptr + 0xc);
    }
  }
  else {
    iVar1 = pstm_init_size(param_1,__ptr,param_2);
    if (iVar1 != 0) goto LAB_00479c28;
    iVar1 = pstm_init_size(param_1,(int)__ptr + 0xc,param_2);
    if (iVar1 == 0) {
      iVar1 = pstm_init_size(param_1,(int)__ptr + 0x18,param_2);
      goto LAB_00479bd0;
    }
  }
  pstm_clear(__ptr);
LAB_00479c28:
  free(__ptr);
  return (void *)0x0;
}



int psEccX963ImportKey(undefined4 param_1,char *param_2,uint param_3,void *param_4,byte *param_5)

{
  int iVar1;
  void *__ptr;
  int iVar2;
  undefined *puVar3;
  uint uVar4;
  size_t __size;
  uint uVar5;
  int iVar6;
  int iVar7;
  undefined auStack_70 [8];
  uint local_68;
  undefined auStack_60 [16];
  undefined auStack_50 [16];
  undefined auStack_40 [16];
  int local_30;
  
  param_3 = param_3 & 0xffff;
  if ((param_3 < 0x31) || (((param_3 ^ 1) & 1) != 0)) {
    return -6;
  }
  if (*(char *)((int)param_4 + 0x3c) != '\x02') {
    if (param_4 == (void *)0x0) {
      return -8;
    }
    memset(param_4,0,0x40);
    *(undefined *)((int)param_4 + 0x3c) = 1;
    *(undefined4 *)((int)param_4 + 0x38) = param_1;
    *(undefined4 *)((int)param_4 + 0x30) = param_1;
    *(byte **)((int)param_4 + 0x34) = param_5;
  }
  uVar5 = (int)(param_3 - 1) >> 1;
  iVar6 = (int)param_4 + 0xc;
  uVar4 = uVar5 & 0xffff;
  iVar1 = pstm_init_for_read_unsigned_bin(param_1,iVar6,uVar4);
  if (iVar1 < 0) {
    return -8;
  }
  iVar7 = (int)param_4 + 0x18;
  iVar1 = pstm_init_for_read_unsigned_bin(param_1,iVar7,uVar4);
  local_30 = (int)param_4 + 0x24;
  if (iVar1 < 0) {
    pstm_clear(iVar6);
    return -8;
  }
  iVar1 = pstm_init_size(param_1,local_30,1);
  if (iVar1 < 0) {
    pstm_clear(iVar6);
    pstm_clear(iVar7);
    return -8;
  }
  iVar1 = -10;
  if (((*param_2 != '\x04') || (iVar1 = pstm_read_unsigned_bin(iVar6,param_2 + 1,uVar4), iVar1 != 0)
      ) || (iVar1 = pstm_read_unsigned_bin(iVar7,param_2 + uVar5 + 1,uVar4), iVar1 != 0))
  goto LAB_00479d90;
  pstm_set(local_30,1);
  if (param_5 == (byte *)0x0) {
    return 0;
  }
  if (param_5[4] == 0) {
    return 0;
  }
  iVar1 = pstm_init_for_read_unsigned_bin(param_1,auStack_70,*param_5);
  if (iVar1 < 0) goto LAB_00479d90;
  iVar1 = pstm_init_for_read_unsigned_bin(param_1,auStack_60,*param_5);
  if (iVar1 < 0) {
    pstm_clear(auStack_70);
    goto LAB_00479d90;
  }
  iVar1 = pstm_read_radix(param_1,auStack_70,*(undefined4 *)(param_5 + 0x10),(uint)*param_5 << 1,
                          0x10);
  if ((-1 < iVar1) &&
     (iVar1 = pstm_read_radix(param_1,auStack_60,*(undefined4 *)(param_5 + 0x18),(uint)*param_5 << 1
                              ,0x10), -1 < iVar1)) {
    puVar3 = auStack_50;
    iVar1 = pstm_init(param_1,puVar3);
    if (iVar1 < 0) goto LAB_0047a19c;
    iVar1 = pstm_init(param_1,auStack_40);
    if (iVar1 < 0) goto LAB_0047a18c;
    __size = (local_68 & 0xfff) * 8 + 4;
    __ptr = malloc(__size);
    if (__ptr != (void *)0x0) {
      iVar1 = pstm_sqr_comba(param_1,(int)param_4 + 0x18,puVar3,__ptr,__size);
      if (((-1 < iVar1) &&
          (iVar1 = pstm_sqr_comba(param_1,iVar6,auStack_40,__ptr,__size), -1 < iVar1)) &&
         ((iVar1 = pstm_mod(param_1,auStack_40,auStack_70,auStack_40), -1 < iVar1 &&
          ((((iVar1 = pstm_mul_comba(param_1,iVar6,auStack_40,auStack_40,__ptr,__size), -1 < iVar1
             && (iVar1 = pstm_sub(puVar3,auStack_40,puVar3), -1 < iVar1)) &&
            (iVar1 = pstm_add(puVar3,iVar6,puVar3), -1 < iVar1)) &&
           ((iVar1 = pstm_add(puVar3,iVar6,puVar3), -1 < iVar1 &&
            (iVar1 = pstm_add(puVar3,iVar6,puVar3), -1 < iVar1)))))))) {
        iVar1 = pstm_mod(param_1,puVar3,auStack_70,puVar3);
        while (-1 < iVar1) {
          iVar1 = pstm_cmp_d(puVar3,0);
          if (iVar1 != -1) goto LAB_0047a314;
          iVar1 = pstm_add(puVar3,auStack_70,puVar3);
        }
      }
      goto LAB_0047a154;
    }
    pstm_clear(puVar3);
    iVar1 = -8;
    pstm_clear(auStack_40);
  }
  goto LAB_0047a280;
  while (iVar1 = pstm_sub(puVar3,auStack_70), -1 < iVar1) {
LAB_0047a314:
    iVar1 = pstm_cmp(puVar3,auStack_70);
    if (iVar1 == -1) {
      iVar2 = pstm_cmp(puVar3,auStack_60,puVar3);
      iVar1 = -9;
      if (iVar2 == 0) {
        iVar1 = 0;
      }
      break;
    }
  }
LAB_0047a154:
  free(__ptr);
  pstm_clear(puVar3);
  puVar3 = auStack_40;
LAB_0047a18c:
  pstm_clear(puVar3);
LAB_0047a19c:
  if (-1 < iVar1) {
    pstm_clear(auStack_70);
    pstm_clear(auStack_60);
    return 0;
  }
LAB_0047a280:
  pstm_clear(auStack_70);
  pstm_clear(auStack_60);
LAB_00479d90:
  if (param_4 == (void *)0x0) {
    _psTraceStr("psAssert %s","pubkey/ecc.c");
    _psTraceInt(&DAT_0049016c,0xff);
    _psError(&DAT_00492674);
  }
  pstm_clear(param_4);
  pstm_clear_multi(iVar6,iVar7,local_30,0,0,0,0,0);
  *(undefined *)((int)param_4 + 0x3c) = 0;
  *(undefined4 *)((int)param_4 + 0x34) = 0;
  *(undefined4 *)((int)param_4 + 0x38) = 0;
  *(undefined4 *)((int)param_4 + 0x30) = 0;
  return iVar1;
}



undefined4
psEccParsePrivKey(undefined4 param_1,byte *param_2,uint param_3,void *param_4,char *param_5)

{
  int *piVar1;
  byte bVar2;
  int iVar3;
  char *pcVar4;
  char *pcVar5;
  byte *pbVar6;
  ushort uVar7;
  uint uVar8;
  uint uVar9;
  byte *pbVar10;
  ushort local_30 [2];
  byte *local_2c;
  int local_28;
  char *local_24;
  
  pbVar10 = param_2 + (param_3 & 0xffff);
  local_2c = param_2;
  iVar3 = getAsnSequence(&local_2c,param_3 & 0xffff,local_30);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  iVar3 = getAsnInteger(&local_2c,(int)pbVar10 - (int)local_2c & 0xffff,&local_28);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  if (local_28 != 1) {
    return 0xffffffff;
  }
  bVar2 = *local_2c;
  local_2c = local_2c + 1;
  if (bVar2 != 4) {
    return 0xffffffff;
  }
  iVar3 = getAsnLength(&local_2c,(int)pbVar10 - (int)local_2c & 0xffff,local_30);
  if (iVar3 < 0) {
    return 0xffffffff;
  }
  uVar8 = (uint)local_30[0];
  if (((int)pbVar10 - (int)local_2c & 0xffffU) < uVar8) {
    return 0xffffffff;
  }
  if (uVar8 < 0x18) {
    return 0xffffffff;
  }
  uVar9 = uVar8;
  if (param_4 != (void *)0x0) {
    memset(param_4,0,0x40);
    uVar9 = (uint)local_30[0];
    *(undefined4 *)((int)param_4 + 0x38) = param_1;
    *(undefined4 *)((int)param_4 + 0x30) = param_1;
    *(char **)((int)param_4 + 0x34) = param_5;
  }
  iVar3 = pstm_init_for_read_unsigned_bin(param_1,param_4,uVar9);
  if ((iVar3 == 0) && (iVar3 = pstm_read_unsigned_bin(param_4,local_2c,local_30[0]), iVar3 == 0)) {
    pbVar6 = local_2c + local_30[0];
    *(undefined *)((int)param_4 + 0x3c) = 2;
    local_2c = pbVar6 + 1;
    if (*pbVar6 == 0xa0) {
      iVar3 = getAsnLength(&local_2c,(int)pbVar10 - (int)local_2c & 0xffff,local_30);
      if (((((-1 < iVar3) && ((uint)local_30[0] <= ((int)pbVar10 - (int)local_2c & 0xffffU))) &&
           (local_30[0] != 0)) &&
          ((bVar2 = *local_2c, local_2c = local_2c + 1, bVar2 == 6 &&
           (iVar3 = getAsnLength(&local_2c,(int)pbVar10 - (int)local_2c & 0xffff,local_30),
           -1 < iVar3)))) && ((uint)local_30[0] <= ((int)pbVar10 - (int)local_2c & 0xffffU))) {
        iVar3 = 0;
        if (local_30[0] != 0) {
          do {
            bVar2 = *local_2c;
            local_30[0] = local_30[0] - 1;
            local_2c = local_2c + 1;
            iVar3 = iVar3 + (uint)bVar2;
          } while (local_30[0] != 0);
        }
        local_24 = (char *)0x0;
        if (DAT_004d78ec != '\0') {
          pcVar4 = &DAT_004d78ec;
          pcVar5 = pcVar4;
          do {
            piVar1 = (int *)(pcVar4 + 8);
            pcVar4 = pcVar4 + 0x28;
            if (*piVar1 == iVar3) {
              local_24 = pcVar5;
              if (param_5 == (char *)0x0) {
                *(char **)((int)param_4 + 0x34) = pcVar5;
                goto LAB_0047a554;
              }
              if (param_5 == pcVar5) {
                *(char **)((int)param_4 + 0x34) = pcVar5;
                goto LAB_0047a554;
              }
              break;
            }
            pcVar5 = pcVar5 + 0x28;
          } while (*pcVar4 != '\0');
        }
      }
    }
    else {
      local_2c = pbVar6;
      if (param_5 != (char *)0x0) {
        *(char **)((int)param_4 + 0x34) = param_5;
LAB_0047a554:
        pbVar6 = local_2c + 1;
        if (*local_2c == 0xa1) {
          local_2c = pbVar6;
          iVar3 = getAsnLength(&local_2c,(int)pbVar10 - (int)pbVar6 & 0xffff,local_30);
          if (((((iVar3 < 0) || (((int)pbVar10 - (int)local_2c & 0xffffU) < (uint)local_30[0])) ||
               ((local_30[0] == 0 ||
                (((bVar2 = *local_2c, local_2c = local_2c + 1, bVar2 != 3 ||
                  (iVar3 = getAsnLength(&local_2c,(int)pbVar10 - (int)local_2c & 0xffff,local_30),
                  iVar3 < 0)) || (((int)pbVar10 - (int)local_2c & 0xffffU) < (uint)local_30[0]))))))
              || ((uVar7 = local_30[0] - 1, local_30[0] == 0 ||
                  (bVar2 = *local_2c, local_2c = local_2c + 1, local_30[0] = uVar7, bVar2 != 0))))
             || (iVar3 = psEccX963ImportKey(param_1,local_2c,uVar7,param_4,
                                            *(undefined4 *)((int)param_4 + 0x34)), iVar3 < 0))
          goto LAB_0047a6c8;
          local_2c = local_2c + local_30[0];
        }
        pbVar6 = local_2c;
        if (((pbVar10 <= local_2c) || (*local_2c != 4)) ||
           ((((int)pbVar10 - (int)local_2c) - 1U != uVar8 << 1 ||
            (iVar3 = psEccX963ImportKey(param_1,local_2c,(int)pbVar10 - (int)local_2c & 0xffff,
                                        param_4,*(undefined4 *)((int)param_4 + 0x34)),
            pbVar6 = pbVar10, -1 < iVar3)))) {
          local_2c = pbVar6;
          if (pbVar10 != local_2c) {
            uVar8 = (int)pbVar10 - (int)local_2c;
            if (local_2c < pbVar10) {
              do {
                pbVar6 = local_2c + 1;
                local_30[0] = (ushort)uVar8;
                if ((uint)*local_2c != (uVar8 & 0xffff)) goto LAB_0047a6c8;
                local_2c = pbVar6;
              } while (pbVar6 < pbVar10);
            }
          }
          return 0;
        }
      }
    }
  }
LAB_0047a6c8:
  if (param_4 == (void *)0x0) {
    _psTraceStr("psAssert %s","pubkey/ecc.c");
    _psTraceInt(&DAT_0049016c,0xff);
    _psError(&DAT_00492674);
  }
  pstm_clear(param_4);
  pstm_clear_multi((int)param_4 + 0xc,(int)param_4 + 0x18,(int)param_4 + 0x24,0,0,0,0,0);
  *(undefined *)((int)param_4 + 0x3c) = 0;
  *(undefined4 *)((int)param_4 + 0x34) = 0;
  *(undefined4 *)((int)param_4 + 0x38) = 0;
  *(undefined4 *)((int)param_4 + 0x30) = 0;
  return 0xffffffff;
}



int psEccParsePrivFile(undefined4 param_1,undefined4 param_2,undefined4 param_3,int param_4)

{
  int iVar1;
  undefined2 local_98;
  undefined auStack_90 [12];
  undefined auStack_84 [12];
  undefined auStack_78 [12];
  undefined auStack_6c [12];
  undefined4 local_60;
  undefined4 local_5c;
  int local_58;
  undefined local_54;
  void *local_20;
  
  iVar1 = psPkcs1DecodePrivFile();
  if (iVar1 < 0) {
    return iVar1;
  }
  iVar1 = psEccParsePrivKey(param_1,local_20,local_98,param_4,0);
  if (-1 < iVar1) goto LAB_0047a95c;
  iVar1 = psPkcs8ParsePrivBin(param_1,local_20,local_98,param_3,auStack_90);
  if (iVar1 < 0) {
    free(local_20);
    return iVar1;
  }
  iVar1 = *(int *)(param_4 + 0x38);
  if (iVar1 == 0) {
    *(int *)(param_4 + 0x38) = local_58;
    *(undefined4 *)(param_4 + 0x30) = local_60;
    iVar1 = local_58;
  }
  else {
    *(int *)(param_4 + 0x30) = iVar1;
  }
  *(undefined4 *)(param_4 + 0x34) = local_5c;
  *(undefined *)(param_4 + 0x3c) = local_54;
  iVar1 = pstm_init_copy(iVar1,param_4 + 0xc,auStack_84,0);
  if (iVar1 == 0) {
    iVar1 = pstm_init_copy(*(undefined4 *)(param_4 + 0x38),param_4 + 0x18,auStack_78,0);
    if ((iVar1 != 0) ||
       (iVar1 = pstm_init_copy(*(undefined4 *)(param_4 + 0x38),param_4 + 0x24,auStack_6c,0),
       iVar1 != 0)) goto LAB_0047aa78;
    if (*(char *)(param_4 + 0x3c) == '\x02') {
      iVar1 = pstm_init_copy(*(undefined4 *)(param_4 + 0x38),param_4,auStack_90,0);
      goto LAB_0047aa78;
    }
  }
  else {
LAB_0047aa78:
    if (iVar1 < 0) {
      if (auStack_90 == (undefined *)0x0) {
        _psTraceStr("psAssert %s","pubkey/ecc.c");
        _psTraceInt(&DAT_0049016c,0xff);
        _psError(&DAT_00492674);
      }
      pstm_clear(auStack_90);
      pstm_clear_multi(auStack_84,auStack_78,auStack_6c,0,0,0,0,0);
      local_5c = 0;
      local_58 = 0;
      local_60 = 0;
      local_54 = 0;
    }
  }
  psClearPubKey(auStack_90);
LAB_0047a95c:
  free(local_20);
  return 0;
}



undefined4
getEcPubKey(undefined4 param_1,byte **param_2,uint param_3,undefined4 param_4,undefined4 param_5)

{
  int *piVar1;
  byte bVar2;
  byte *pbVar3;
  int iVar4;
  char *pcVar5;
  byte *pbVar6;
  undefined auStack_100 [208];
  ushort local_30 [2];
  byte *local_2c;
  char *local_28;
  
  pbVar3 = *param_2;
  param_3 = param_3 & 0xffff;
  pbVar6 = pbVar3 + param_3;
  if (param_3 != 0) {
    local_2c = pbVar3 + 1;
    if (*pbVar3 == 6) {
      iVar4 = getAsnLength(&local_2c,(int)pbVar6 - (int)local_2c & 0xffff,local_30);
      if (iVar4 < 0) {
        return 0xffffffe1;
      }
      if ((uint)local_30[0] <= ((int)pbVar6 - (int)local_2c & 0xffffU)) {
        iVar4 = 0;
        if (local_30[0] != 0) {
          do {
            bVar2 = *local_2c;
            local_30[0] = local_30[0] - 1;
            local_2c = local_2c + 1;
            iVar4 = iVar4 + (uint)bVar2;
          } while (local_30[0] != 0);
          local_30[0] = 0;
        }
        if (DAT_004d78ec != '\0') {
          pcVar5 = &DAT_004d78ec;
          local_28 = pcVar5;
          do {
            piVar1 = (int *)(pcVar5 + 8);
            pcVar5 = pcVar5 + 0x28;
            if (*piVar1 == iVar4) {
              if ((int)pbVar6 * 0x10000 >> 0x10 == (int)(short)local_2c) {
                return 0xffffffe1;
              }
              bVar2 = *local_2c;
              local_2c = local_2c + 1;
              if (bVar2 != 3) {
                return 0xffffffe1;
              }
              iVar4 = getAsnLength(&local_2c,param_3 - 1 & 0xffff,local_30);
              if (iVar4 < 0) {
                return 0xffffffe1;
              }
              if (((int)pbVar6 - (int)local_2c & 0xffffU) < (uint)local_30[0]) {
                return 0xffffffe1;
              }
              local_2c = local_2c + 1;
              if (local_30[0] == 0) {
                return 0xffffffe1;
              }
              local_30[0] = local_30[0] - 1;
              psSha1Init(auStack_100);
              psSha1Update(auStack_100,local_2c,local_30[0]);
              psSha1Final(auStack_100,param_5);
              iVar4 = psEccX963ImportKey(param_1,local_2c,local_30[0],param_4,local_28);
              if (-1 < iVar4) {
                *param_2 = local_2c + local_30[0];
                return 0;
              }
              return 0xffffffe1;
            }
            local_28 = local_28 + 0x28;
          } while (*pcVar5 != '\0');
        }
        return 0xfffffff6;
      }
    }
  }
  return 0xffffffe1;
}



int psEccX963ExportKey(undefined4 param_1,int param_2,undefined *param_3,ushort *param_4)

{
  int iVar1;
  uint __n;
  ushort uVar2;
  uint uVar3;
  undefined auStack_128 [256];
  
  __n = (uint)**(byte **)(param_2 + 0x34);
  uVar3 = __n * 2 + 1;
  iVar1 = -9;
  uVar2 = (ushort)uVar3;
  if (*param_4 < uVar3) {
    *param_4 = uVar2;
  }
  else {
    *param_3 = 4;
    memset(auStack_128,0,0x100);
    iVar1 = pstm_unsigned_bin_size(param_2 + 0xc);
    iVar1 = pstm_to_unsigned_bin(param_1,param_2 + 0xc,auStack_128 + (__n - iVar1));
    if (iVar1 == 0) {
      memcpy(param_3 + 1,auStack_128,__n);
      memset(auStack_128,0,0x100);
      iVar1 = pstm_unsigned_bin_size(param_2 + 0x18);
      iVar1 = pstm_to_unsigned_bin(param_1,param_2 + 0x18,auStack_128 + (__n - iVar1));
      if (iVar1 == 0) {
        memcpy(param_3 + __n + 1,auStack_128,__n);
        iVar1 = 0;
        *param_4 = uVar2;
      }
    }
  }
  return iVar1;
}



int FUN_0047af84(undefined4 param_1,int param_2,int param_3,int param_4,undefined4 *param_5,
                int param_6)

{
  int iVar1;
  void *__ptr;
  uint uVar2;
  uint uVar3;
  size_t __size;
  int iVar4;
  int iVar5;
  undefined auStack_70 [16];
  uint *local_60 [2];
  uint local_58;
  undefined auStack_50 [16];
  undefined auStack_40 [16];
  int local_30;
  
  if (param_2 != param_3) {
    iVar1 = pstm_copy(param_2,param_3);
    if (iVar1 < 0) {
      return -8;
    }
    iVar1 = pstm_copy(param_2 + 0xc,param_3 + 0xc);
    if (iVar1 < 0) {
      return -8;
    }
    iVar1 = pstm_copy(param_2 + 0x18,param_3 + 0x18);
    if (iVar1 < 0) {
      return -8;
    }
  }
  uVar3 = *(uint *)(param_3 + 8) & 0xfff;
  uVar2 = *(uint *)(param_3 + 0x14) & 0xfff;
  if (uVar3 < uVar2) {
    uVar3 = uVar2;
  }
  uVar2 = *(uint *)(param_3 + 0x20) & 0xfff;
  if (uVar3 < uVar2) {
    uVar3 = uVar2;
  }
  iVar5 = uVar3 * 2 + 1;
  iVar1 = pstm_init_size(param_1,auStack_70,iVar5);
  if (iVar1 < 0) {
    return -8;
  }
  iVar1 = pstm_init_size(param_1,local_60,iVar5);
  if (iVar1 < 0) {
    pstm_clear(auStack_70);
    return -8;
  }
  __size = (*(uint *)(param_4 + 8) & 0xfff) * 8 + 4;
  __ptr = malloc(__size);
  iVar1 = -8;
  if (__ptr != (void *)0x0) {
    iVar4 = param_3 + 0x18;
    iVar1 = pstm_sqr_comba(param_1,iVar4,auStack_70,__ptr,__size);
    if ((iVar1 == 0) &&
       (iVar1 = pstm_montgomery_reduce(param_1,auStack_70,param_4,*param_5,__ptr,__size), iVar1 == 0
       )) {
      local_30 = param_3 + 0xc;
      iVar1 = pstm_mul_comba(param_1,iVar4,local_30,iVar4,__ptr,__size);
      if (((iVar1 == 0) &&
          ((iVar1 = pstm_montgomery_reduce(param_1,iVar4,param_4,*param_5,__ptr,__size), iVar1 == 0
           && (iVar1 = pstm_add(iVar4,iVar4,iVar4), iVar1 == 0)))) &&
         ((iVar1 = pstm_cmp(iVar4,param_4), iVar1 == -1 ||
          (iVar1 = pstm_sub(iVar4,param_4,iVar4), iVar1 == 0)))) {
        if (param_6 == 0) {
          iVar1 = pstm_sub(param_3,auStack_70,local_60);
          if ((iVar1 != 0) ||
             (((iVar1 = pstm_cmp_d(local_60,0), iVar1 == -1 &&
               (iVar1 = pstm_add(local_60,param_4,local_60), iVar1 != 0)) ||
              (iVar1 = pstm_add(auStack_70,param_3,auStack_70), iVar1 != 0)))) goto LAB_0047b7ec;
          iVar1 = pstm_cmp(auStack_70,param_4);
          if ((((iVar1 != -1) && (iVar1 = pstm_sub(auStack_70,param_4,auStack_70), iVar1 != 0)) ||
              (iVar1 = pstm_mul_comba(param_1,auStack_70,local_60,local_60,__ptr,__size), iVar1 != 0
              )) || ((iVar1 = pstm_montgomery_reduce(param_1,local_60,param_4,*param_5,__ptr,__size)
                     , iVar1 != 0 || (iVar1 = pstm_add(local_60,local_60,auStack_70), iVar1 != 0))))
          goto LAB_0047b7ec;
          iVar1 = pstm_cmp(auStack_70,param_4);
          if (((iVar1 != -1) && (iVar1 = pstm_sub(auStack_70,param_4,auStack_70), iVar1 != 0)) ||
             (iVar1 = pstm_add(auStack_70,local_60,auStack_70), iVar1 != 0)) goto LAB_0047b7ec;
          iVar1 = pstm_cmp(auStack_70,param_4);
          if ((iVar1 != -1) && (iVar1 = pstm_sub(auStack_70,param_4,auStack_70), iVar1 != 0))
          goto LAB_0047b7ec;
        }
        else {
          iVar1 = pstm_init_size(param_1,auStack_50,iVar5);
          if (iVar1 < 0) {
            return -8;
          }
          iVar1 = pstm_init_size(param_1,auStack_40,iVar5);
          if (iVar1 < 0) {
            pstm_clear(auStack_50);
            return -8;
          }
          iVar1 = pstm_sqr_comba(param_1,param_3,auStack_50,__ptr,__size);
          if (((iVar1 != 0) ||
              (iVar1 = pstm_montgomery_reduce(param_1,auStack_50,param_4,*param_5,__ptr,__size),
              iVar1 != 0)) || (iVar1 = pstm_add(auStack_50,auStack_50,auStack_40), iVar1 != 0))
          goto LAB_0047b7ec;
          iVar1 = pstm_cmp(auStack_40,param_4);
          if ((((iVar1 != -1) && (iVar1 = pstm_sub(auStack_40,param_4,auStack_40), iVar1 != 0)) ||
              ((iVar1 = pstm_add(auStack_50,auStack_40,auStack_50), iVar1 != 0 ||
               ((iVar1 = pstm_cmp(auStack_50,param_4), iVar1 != -1 &&
                (iVar1 = pstm_sub(auStack_50,param_4,auStack_50), iVar1 != 0)))))) ||
             ((iVar1 = pstm_sqr_comba(param_1,auStack_70,auStack_40,__ptr,__size), iVar1 != 0 ||
              ((((iVar1 = pstm_mod(param_1,auStack_40,param_4,auStack_40), iVar1 != 0 ||
                 (iVar1 = pstm_mul_comba(param_1,auStack_40,param_6,auStack_40,__ptr,__size),
                 iVar1 != 0)) ||
                (iVar1 = pstm_montgomery_reduce(param_1,auStack_40,param_4,*param_5,__ptr,__size),
                iVar1 != 0)) || (iVar1 = pstm_add(auStack_50,auStack_40,auStack_70), iVar1 != 0)))))
             ) goto LAB_0047b7ec;
          iVar1 = pstm_cmp(auStack_70,param_4);
          if ((iVar1 != -1) && (iVar1 = pstm_sub(auStack_70,param_4,auStack_70), iVar1 != 0))
          goto LAB_0047b7ec;
          pstm_clear_multi(auStack_50,auStack_40,0,0,0,0,0,0);
        }
        iVar1 = pstm_add(local_30,local_30,local_30);
        if ((((iVar1 == 0) &&
             ((iVar1 = pstm_cmp(local_30,param_4), iVar1 == -1 ||
              (iVar1 = pstm_sub(local_30,param_4,local_30), iVar1 == 0)))) &&
            ((iVar1 = pstm_sqr_comba(param_1,local_30,local_30,__ptr,__size), iVar1 == 0 &&
             ((((((iVar1 = pstm_montgomery_reduce(param_1,local_30,param_4,*param_5,__ptr,__size),
                  iVar1 == 0 &&
                  (iVar1 = pstm_sqr_comba(param_1,local_30,local_60,__ptr,__size), iVar1 == 0)) &&
                 (iVar1 = pstm_montgomery_reduce(param_1,local_60,param_4,*param_5,__ptr,__size),
                 iVar1 == 0)) &&
                ((((local_58 & 0xfff) == 0 || ((*local_60[0] & 1) == 0)) ||
                 (iVar1 = pstm_add(local_60,param_4,local_60), iVar1 == 0)))) &&
               ((iVar1 = pstm_div_2(local_60,local_60), iVar1 == 0 &&
                (iVar1 = pstm_mul_comba(param_1,local_30,param_3,local_30,__ptr,__size), iVar1 == 0)
                ))) && ((iVar1 = pstm_montgomery_reduce
                                           (param_1,local_30,param_4,*param_5,__ptr,__size),
                        iVar1 == 0 &&
                        (((iVar1 = pstm_sqr_comba(param_1,auStack_70,param_3,__ptr,__size),
                          iVar1 == 0 &&
                          (iVar1 = pstm_montgomery_reduce
                                             (param_1,param_3,param_4,*param_5,__ptr,__size),
                          iVar1 == 0)) && (iVar1 = pstm_sub(param_3,local_30,param_3), iVar1 == 0)))
                        ))))))) &&
           ((((iVar1 = pstm_cmp_d(param_3,0), iVar1 != -1 ||
              (iVar1 = pstm_add(param_3,param_4,param_3), iVar1 == 0)) &&
             (iVar1 = pstm_sub(param_3,local_30,param_3), iVar1 == 0)) &&
            ((((iVar1 = pstm_cmp_d(param_3,0), iVar1 != -1 ||
               (iVar1 = pstm_add(param_3,param_4,param_3), iVar1 == 0)) &&
              ((iVar1 = pstm_sub(local_30,param_3,local_30), iVar1 == 0 &&
               ((((iVar1 = pstm_cmp_d(local_30,0), iVar1 != -1 ||
                  (iVar1 = pstm_add(local_30,param_4,local_30), iVar1 == 0)) &&
                 (iVar1 = pstm_mul_comba(param_1,local_30,auStack_70,local_30,__ptr,__size),
                 iVar1 == 0)) &&
                ((iVar1 = pstm_montgomery_reduce(param_1,local_30,param_4,*param_5,__ptr,__size),
                 iVar1 == 0 && (iVar1 = pstm_sub(local_30,local_60,local_30), iVar1 == 0)))))))) &&
             ((iVar1 = pstm_cmp_d(local_30,0), iVar1 != -1 ||
              (iVar1 = pstm_add(local_30,param_4,local_30), iVar1 == 0)))))))) {
          iVar1 = 0;
        }
      }
    }
  }
LAB_0047b7ec:
  pstm_clear_multi(auStack_70,local_60,0,0,0,0,0,0);
  if (__ptr != (void *)0x0) {
    free(__ptr);
  }
  return iVar1;
}



int FUN_0047bb44(undefined4 param_1,int param_2,int param_3,int param_4,int param_5,
                undefined4 *param_6,undefined4 param_7)

{
  int iVar1;
  int iVar2;
  size_t __size;
  int iVar3;
  void *__ptr;
  undefined auStack_80 [16];
  undefined auStack_70 [16];
  undefined auStack_60 [16];
  uint *local_50 [2];
  uint local_48;
  undefined auStack_40 [16];
  int local_30;
  size_t local_2c;
  
  iVar1 = pstm_init_size(param_1,auStack_80,*(uint *)(param_2 + 8) >> 0xc & 0xfff);
  __ptr = (void *)0x0;
  iVar2 = -8;
  if (-1 < iVar1) {
    iVar1 = pstm_init_size(param_1,auStack_70,*(uint *)(param_2 + 8) >> 0xc & 0xfff);
    iVar2 = -8;
    if (-1 < iVar1) {
      iVar1 = pstm_init_size(param_1,auStack_60,*(uint *)(param_2 + 8) >> 0xc & 0xfff);
      if (-1 < iVar1) {
        iVar1 = pstm_init_size(param_1,local_50,*(uint *)(param_2 + 0x14) >> 0xc & 0xfff);
        if (-1 < iVar1) {
          iVar1 = pstm_init_size(param_1,auStack_40,*(uint *)(param_2 + 0x20) >> 0xc & 0xfff);
          iVar3 = param_3 + 0xc;
          if (-1 < iVar1) {
            iVar2 = pstm_sub(param_5,iVar3,auStack_80);
            if (iVar2 == 0) {
              iVar1 = pstm_cmp(param_2,param_3);
              if (iVar1 == 0) {
                iVar1 = pstm_cmp(param_2 + 0x18,param_3 + 0x18);
                if ((iVar1 == 0) &&
                   ((iVar1 = pstm_cmp(param_2 + 0xc,iVar3), iVar1 == 0 ||
                    (iVar1 = pstm_cmp(param_2 + 0xc,auStack_80), iVar1 == 0)))) {
                  pstm_clear_multi(auStack_80,auStack_70,auStack_60,local_50,auStack_40,0,0,0);
                  iVar1 = FUN_0047af84(param_1,param_2,param_4,param_5,param_6,param_7);
                  return iVar1;
                }
              }
              iVar2 = pstm_copy(param_2,auStack_60);
              if (((iVar2 == 0) && (iVar2 = pstm_copy(param_2 + 0xc,local_50), iVar2 == 0)) &&
                 (iVar2 = pstm_copy(param_2 + 0x18,auStack_40), iVar2 == 0)) {
                __size = (*(uint *)(param_5 + 8) & 0xfff) * 8 + 4;
                __ptr = malloc(__size);
                iVar2 = -8;
                if (__ptr != (void *)0x0) {
                  local_30 = param_3 + 0x18;
                  iVar1 = pstm_cmp_d(local_30,1);
                  local_2c = __size;
                  if (((iVar1 == 0) ||
                      (((((iVar2 = pstm_sqr_comba(param_1,local_30,auStack_80,__ptr,__size),
                          iVar2 == 0 &&
                          (iVar2 = pstm_montgomery_reduce
                                             (param_1,auStack_80,param_5,*param_6,__ptr,local_2c),
                          iVar2 == 0)) &&
                         ((iVar2 = pstm_mul_comba(param_1,auStack_80,auStack_60,auStack_60,__ptr,
                                                  local_2c), iVar2 == 0 &&
                          ((iVar2 = pstm_montgomery_reduce
                                              (param_1,auStack_60,param_5,*param_6,__ptr,local_2c),
                           iVar2 == 0 &&
                           (iVar2 = pstm_mul_comba(param_1,local_30,auStack_80,auStack_80,__ptr,
                                                   local_2c), iVar2 == 0)))))) &&
                        (iVar2 = pstm_montgomery_reduce
                                           (param_1,auStack_80,param_5,*param_6,__ptr,local_2c),
                        iVar2 == 0)) &&
                       ((iVar2 = pstm_mul_comba(param_1,auStack_80,local_50,local_50,__ptr,local_2c)
                        , iVar2 == 0 &&
                        (iVar2 = pstm_montgomery_reduce
                                           (param_1,local_50,param_5,*param_6,__ptr,local_2c),
                        iVar2 == 0)))))) &&
                     ((((iVar2 = pstm_sqr_comba(param_1,auStack_40,auStack_80,__ptr,local_2c),
                        iVar2 == 0 &&
                        (((iVar2 = pstm_montgomery_reduce
                                             (param_1,auStack_80,param_5,*param_6,__ptr,local_2c),
                          iVar2 == 0 &&
                          (iVar2 = pstm_mul_comba(param_1,param_3,auStack_80,auStack_70,__ptr,
                                                  local_2c), iVar2 == 0)) &&
                         (iVar2 = pstm_montgomery_reduce
                                            (param_1,auStack_70,param_5,*param_6,__ptr,local_2c),
                         iVar2 == 0)))) &&
                       (((iVar2 = pstm_mul_comba(param_1,auStack_40,auStack_80,auStack_80,__ptr,
                                                 local_2c), iVar2 == 0 &&
                         (iVar2 = pstm_montgomery_reduce
                                            (param_1,auStack_80,param_5,*param_6,__ptr,local_2c),
                         iVar2 == 0)) &&
                        (iVar2 = pstm_mul_comba(param_1,iVar3,auStack_80,auStack_80,__ptr,local_2c),
                        iVar2 == 0)))) &&
                      (((iVar2 = pstm_montgomery_reduce
                                           (param_1,auStack_80,param_5,*param_6,__ptr,local_2c),
                        iVar2 == 0 && (iVar2 = pstm_sub(local_50,auStack_80,local_50), iVar2 == 0))
                       && ((iVar1 = pstm_cmp_d(local_50,0), iVar1 != -1 ||
                           (iVar2 = pstm_add(local_50,param_5,local_50), iVar2 == 0)))))))) {
                    iVar2 = pstm_add(auStack_80,auStack_80,auStack_80);
                    if (iVar2 == 0) {
                      iVar1 = pstm_cmp(auStack_80,param_5);
                      if (((iVar1 == -1) ||
                          (iVar2 = pstm_sub(auStack_80,param_5,auStack_80), iVar2 == 0)) &&
                         (iVar2 = pstm_add(auStack_80,local_50,auStack_80), iVar2 == 0)) {
                        iVar1 = pstm_cmp(auStack_80,param_5);
                        if (((iVar1 == -1) ||
                            (iVar2 = pstm_sub(auStack_80,param_5,auStack_80), iVar2 == 0)) &&
                           ((((iVar2 = pstm_sub(auStack_60,auStack_70,auStack_60), iVar2 == 0 &&
                              ((iVar1 = pstm_cmp_d(auStack_60,0), iVar1 != -1 ||
                               (iVar2 = pstm_add(auStack_60,param_5,auStack_60), iVar2 == 0)))) &&
                             (iVar2 = pstm_add(auStack_70,auStack_70,auStack_70), iVar2 == 0)) &&
                            ((((iVar1 = pstm_cmp(auStack_70,param_5), iVar1 == -1 ||
                               (iVar2 = pstm_sub(auStack_70,param_5,auStack_70), iVar2 == 0)) &&
                              (iVar2 = pstm_add(auStack_70,auStack_60,auStack_70), iVar2 == 0)) &&
                             ((iVar1 = pstm_cmp(auStack_70,param_5), iVar1 == -1 ||
                              (iVar2 = pstm_sub(auStack_70,param_5,auStack_70), iVar2 == 0)))))))) {
                          iVar1 = pstm_cmp_d(local_30,1);
                          if ((((iVar1 == 0) ||
                               ((iVar2 = pstm_mul_comba(param_1,auStack_40,local_30,auStack_40,__ptr
                                                        ,local_2c), iVar2 == 0 &&
                                (iVar2 = pstm_montgomery_reduce
                                                   (param_1,auStack_40,param_5,*param_6,__ptr,
                                                    local_2c), iVar2 == 0)))) &&
                              ((iVar2 = pstm_mul_comba(param_1,auStack_40,auStack_60,auStack_40,
                                                       __ptr,local_2c), iVar2 == 0 &&
                               ((((iVar2 = pstm_montgomery_reduce
                                                     (param_1,auStack_40,param_5,*param_6,__ptr,
                                                      local_2c), iVar2 == 0 &&
                                  (iVar2 = pstm_mul_comba(param_1,auStack_80,auStack_60,auStack_80,
                                                          __ptr,local_2c), iVar2 == 0)) &&
                                 (iVar2 = pstm_montgomery_reduce
                                                    (param_1,auStack_80,param_5,*param_6,__ptr,
                                                     local_2c), iVar2 == 0)) &&
                                (((iVar2 = pstm_sqr_comba(param_1,auStack_60,auStack_60,__ptr,
                                                          local_2c), iVar2 == 0 &&
                                  (iVar2 = pstm_montgomery_reduce
                                                     (param_1,auStack_60,param_5,*param_6,__ptr,
                                                      local_2c), iVar2 == 0)) &&
                                 ((iVar2 = pstm_mul_comba(param_1,auStack_70,auStack_60,auStack_70,
                                                          __ptr,local_2c), iVar2 == 0 &&
                                  ((iVar2 = pstm_montgomery_reduce
                                                      (param_1,auStack_70,param_5,*param_6,__ptr,
                                                       local_2c), iVar2 == 0 &&
                                   (iVar2 = pstm_mul_comba(param_1,auStack_80,auStack_60,auStack_80,
                                                           __ptr,local_2c), iVar2 == 0))))))))))))
                             && ((iVar2 = pstm_montgomery_reduce
                                                    (param_1,auStack_80,param_5,*param_6,__ptr,
                                                     local_2c), iVar2 == 0 &&
                                 ((((((iVar2 = pstm_sqr_comba(param_1,local_50,auStack_60,__ptr,
                                                              local_2c), iVar2 == 0 &&
                                      (iVar2 = pstm_montgomery_reduce
                                                         (param_1,auStack_60,param_5,*param_6,__ptr,
                                                          local_2c), iVar2 == 0)) &&
                                     (iVar2 = pstm_sub(auStack_60,auStack_70,auStack_60), iVar2 == 0
                                     )) && (((iVar1 = pstm_cmp_d(auStack_60,0), iVar1 != -1 ||
                                             (iVar2 = pstm_add(auStack_60,param_5,auStack_60),
                                             iVar2 == 0)) &&
                                            ((iVar2 = pstm_sub(auStack_70,auStack_60,auStack_70),
                                             iVar2 == 0 &&
                                             ((iVar1 = pstm_cmp_d(auStack_70,0), iVar1 != -1 ||
                                              (iVar2 = pstm_add(auStack_70,param_5,auStack_70),
                                              iVar2 == 0)))))))) &&
                                   ((iVar2 = pstm_sub(auStack_70,auStack_60,auStack_70), iVar2 == 0
                                    && ((((((iVar1 = pstm_cmp_d(auStack_70,0), iVar1 != -1 ||
                                            (iVar2 = pstm_add(auStack_70,param_5,auStack_70),
                                            iVar2 == 0)) &&
                                           (iVar2 = pstm_mul_comba(param_1,auStack_70,local_50,
                                                                   auStack_70,__ptr,local_2c),
                                           iVar2 == 0)) &&
                                          ((iVar2 = pstm_montgomery_reduce
                                                              (param_1,auStack_70,param_5,*param_6,
                                                               __ptr,local_2c), iVar2 == 0 &&
                                           (iVar2 = pstm_sub(auStack_70,auStack_80,local_50),
                                           iVar2 == 0)))) &&
                                         ((iVar1 = pstm_cmp_d(local_50,0), iVar1 != -1 ||
                                          (iVar2 = pstm_add(local_50,param_5,local_50), iVar2 == 0))
                                         )) && ((((local_48 & 0xfff) == 0 ||
                                                 ((*local_50[0] & 1) == 0)) ||
                                                (iVar2 = pstm_add(local_50,param_5,local_50),
                                                iVar2 == 0)))))))) &&
                                  (((iVar2 = pstm_div_2(local_50,local_50), iVar2 == 0 &&
                                    (iVar2 = pstm_copy(auStack_60,param_4), iVar2 == 0)) &&
                                   (iVar2 = pstm_copy(local_50,param_4 + 0xc), iVar2 == 0)))))))) {
                            iVar2 = pstm_copy(auStack_40,param_4 + 0x18);
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            pstm_clear(auStack_40);
          }
          pstm_clear(local_50);
        }
        pstm_clear(auStack_60);
      }
      pstm_clear(auStack_70);
    }
    pstm_clear(auStack_80);
    if (__ptr != (void *)0x0) {
      free(__ptr);
    }
  }
  return iVar2;
}



int FUN_0047c990(undefined4 param_1,int param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  void *__ptr;
  int iVar2;
  size_t __size;
  undefined auStack_48 [16];
  undefined auStack_38 [16];
  
  iVar1 = pstm_init_size(param_1,auStack_48,*(uint *)(param_2 + 8) >> 0xc & 0xfff);
  iVar2 = -8;
  if (-1 < iVar1) {
    iVar1 = pstm_init_size(param_1,auStack_38,*(uint *)(param_2 + 8) >> 0xc & 0xfff);
    if (iVar1 < 0) {
      pstm_clear(auStack_48);
      iVar2 = -8;
    }
    else {
      __size = (*(uint *)(param_3 + 8) & 0xfff) * 8 + 4;
      __ptr = malloc(__size);
      iVar2 = -8;
      if (__ptr != (void *)0x0) {
        iVar1 = param_2 + 0x18;
        iVar2 = pstm_montgomery_reduce(param_1,iVar1,param_3,*param_4,__ptr,__size);
        if (iVar2 == 0) {
          iVar2 = pstm_invmod(param_1,iVar1,param_3,auStack_48);
          if (iVar2 == 0) {
            iVar2 = pstm_sqr_comba(param_1,auStack_48,auStack_38,__ptr,__size);
            if (iVar2 == 0) {
              iVar2 = pstm_mod(param_1,auStack_38,param_3,auStack_38);
              if (iVar2 == 0) {
                iVar2 = pstm_mul_comba(param_1,auStack_48,auStack_38,auStack_48,__ptr,__size);
                if (iVar2 == 0) {
                  iVar2 = pstm_mod(param_1,auStack_48,param_3,auStack_48);
                  if (iVar2 == 0) {
                    iVar2 = pstm_mul_comba(param_1,param_2,auStack_38,param_2,__ptr,__size);
                    if (iVar2 == 0) {
                      iVar2 = pstm_montgomery_reduce(param_1,param_2,param_3,*param_4,__ptr,__size);
                      if (iVar2 == 0) {
                        param_2 = param_2 + 0xc;
                        iVar2 = pstm_mul_comba(param_1,param_2,auStack_48,param_2,__ptr,__size);
                        if (iVar2 == 0) {
                          iVar2 = pstm_montgomery_reduce
                                            (param_1,param_2,param_3,*param_4,__ptr,__size);
                          if (iVar2 == 0) {
                            pstm_set(iVar1,1);
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
      pstm_clear_multi(auStack_48,auStack_38,0,0,0,0,0,0);
      if (__ptr != (void *)0x0) {
        free(__ptr);
      }
    }
  }
  return iVar2;
}



int FUN_0047ccb8(undefined4 param_1,int *param_2,int param_3,int param_4,undefined *param_5,
                byte param_6,undefined *param_7)

{
  int iVar1;
  int iVar2;
  undefined *puVar3;
  int *piVar4;
  code *pcVar5;
  undefined *puVar6;
  uint uVar7;
  undefined *puVar8;
  int iVar9;
  int iVar10;
  int aiStack_a0 [2];
  undefined *local_98;
  undefined *local_94;
  undefined *local_90;
  undefined *local_88;
  int local_80 [8];
  undefined auStack_60 [4];
  undefined auStack_5c [12];
  undefined auStack_50 [4];
  uint local_4c;
  int local_48;
  uint local_44;
  int local_40;
  uint local_3c;
  undefined *local_38;
  undefined *local_34;
  int local_30;
  
  local_88 = &_gp;
  local_4c = (uint)param_6;
  iVar1 = pstm_montgomery_setup(param_5,auStack_50);
  if (iVar1 != 0) {
    return iVar1;
  }
  iVar1 = (**(code **)(local_88 + -0x77f4))
                    (param_1,auStack_60,*(uint *)(param_5 + 8) >> 0xc & 0xfff);
  if (iVar1 != 0) {
    return iVar1;
  }
  iVar1 = (**(code **)(local_88 + -0x7540))(auStack_60,param_5);
  if (iVar1 != 0) {
    (**(code **)(local_88 + -0x7770))(auStack_60);
    return iVar1;
  }
  iVar9 = *(int *)(local_88 + -0x7fc0);
  iVar1 = 0;
  piVar4 = local_80;
  do {
    iVar2 = (*(code *)(iVar9 + -0x652c))(param_1,(*(uint *)(param_3 + 8) & 0xfff) * 2 + 1);
    *piVar4 = iVar2;
    piVar4 = piVar4 + 1;
    if (iVar2 == 0) {
      piVar4 = local_80;
      puVar8 = local_88;
      if (0 < iVar1) {
        do {
          iVar9 = *piVar4;
          iVar1 = iVar1 + -1;
          piVar4 = piVar4 + 1;
          if (iVar9 != 0) {
            (**(code **)(puVar8 + -0x7770))(iVar9);
            (**(code **)(local_88 + -0x7770))(iVar9 + 0xc);
            (**(code **)(local_88 + -0x7770))(iVar9 + 0x18);
            (**(code **)(local_88 + -0x7b84))(iVar9);
            puVar8 = local_88;
          }
        } while (iVar1 != 0);
      }
      (**(code **)(puVar8 + -0x7770))(auStack_60);
      return -8;
    }
    iVar1 = iVar1 + 1;
  } while (iVar1 < 8);
  puVar3 = (undefined *)(*(code *)(iVar9 + -0x652c))(param_1,*(uint *)(param_3 + 8) >> 0xc & 0xfff);
  iVar1 = -8;
  puVar8 = local_88;
  if (puVar3 != (undefined *)0x0) {
    iVar1 = (**(code **)(local_88 + -0x7264))(auStack_60,1);
    if (iVar1 == 0) {
      iVar1 = (**(code **)(local_88 + -0x709c))(param_3,puVar3);
      puVar8 = local_88;
      if (iVar1 != 0) goto LAB_0047d180;
      local_38 = puVar3 + 0xc;
      iVar1 = (**(code **)(local_88 + -0x709c))(param_3 + 0xc,local_38);
      puVar8 = local_88;
      if (iVar1 != 0) goto LAB_0047d180;
      local_34 = puVar3 + 0x18;
      iVar1 = (**(code **)(local_88 + -0x709c))(param_3 + 0x18,local_34);
    }
    else {
      local_98 = puVar3;
      iVar1 = (**(code **)(local_88 + -0x75c0))(param_1,param_3,auStack_60,param_5);
      puVar8 = local_88;
      if (iVar1 != 0) goto LAB_0047d180;
      local_98 = puVar3 + 0xc;
      local_38 = local_98;
      iVar1 = (**(code **)(local_88 + -0x75c0))(param_1,param_3 + 0xc,auStack_60,param_5);
      puVar8 = local_88;
      if (iVar1 != 0) goto LAB_0047d180;
      local_98 = puVar3 + 0x18;
      local_34 = local_98;
      iVar1 = (**(code **)(local_88 + -0x75c0))(param_1,param_3 + 0x18,auStack_60,param_5);
    }
    puVar8 = local_88;
    if (iVar1 == 0) {
      (**(code **)(local_88 + -0x7770))(auStack_60);
      local_98 = auStack_50;
      pcVar5 = (code *)(*(int *)(local_88 + -0x7fc0) + -0x507c);
      local_94 = param_7;
      iVar1 = (*pcVar5)(param_1,puVar3,local_80[0],param_5);
      puVar8 = local_88;
      if (iVar1 == 0) {
        local_98 = auStack_50;
        local_94 = param_7;
        iVar1 = (*pcVar5)(param_1,local_80[0],local_80[0],param_5);
        puVar8 = local_88;
        if (iVar1 == 0) {
          local_98 = auStack_50;
          local_94 = param_7;
          iVar1 = (*pcVar5)(param_1,local_80[0],local_80[0],param_5);
          puVar8 = local_88;
          if (iVar1 == 0) {
            iVar9 = *(int *)(local_88 + -0x7fc0);
            iVar2 = 9;
            puVar6 = auStack_5c;
            do {
              local_94 = auStack_50;
              local_98 = param_5;
              local_90 = param_7;
              iVar1 = (*(code *)(iVar9 + -0x44bc))
                                (param_1,*(undefined4 *)(puVar6 + -0x24),puVar3,
                                 *(undefined4 *)(puVar6 + -0x20));
              iVar2 = iVar2 + 1;
              puVar6 = puVar6 + 4;
              puVar8 = local_88;
              if (iVar1 != 0) goto LAB_0047d180;
            } while (iVar2 < 0x10);
            iVar2 = 0;
            local_3c = *(byte *)(param_2 + 2) - 1;
            local_40 = 1;
            iVar9 = 0;
            local_44 = 0;
            iVar10 = 0;
            local_48 = 1;
            do {
              while( true ) {
                do {
                  local_40 = local_40 + -1;
                  if (local_40 == 0) {
                    if (local_3c == 0xffffffff) {
                      if ((iVar2 != 2) || (iVar10 < 1)) goto LAB_0047d14c;
                      iVar9 = *(int *)(puVar8 + -0x7fc0);
                      local_30 = 0;
                      goto LAB_0047d500;
                    }
                    iVar9 = 0;
                    if ((local_3c & 0xff) < (param_2[2] & 0xfffU)) {
                      iVar9 = *(int *)((local_3c & 0xff) * 4 + *param_2);
                    }
                    local_3c = local_3c - 1;
                    local_40 = 0x20;
                  }
                  iVar1 = -(iVar9 >> 0x1f);
                  iVar9 = iVar9 << 1;
                } while ((iVar2 == 0) && (iVar1 == 0));
                if ((iVar2 == 1) && (iVar1 == 0)) break;
                iVar10 = iVar10 + 1;
                uVar7 = local_44 | iVar1 << (4U - iVar10 & 0x1f);
                local_44 = uVar7;
                iVar2 = 2;
                if (iVar10 == 4) {
                  iVar2 = 0;
                  if (local_48 == 1) {
                    iVar1 = (**(code **)(puVar8 + -0x709c))(aiStack_a0[uVar7],param_4);
                    puVar8 = local_88;
                    if (((iVar1 != 0) ||
                        (iVar1 = (**(code **)(local_88 + -0x709c))
                                           (aiStack_a0[uVar7] + 0xc,param_4 + 0xc),
                        puVar8 = local_88, iVar1 != 0)) ||
                       (iVar1 = (**(code **)(local_88 + -0x709c))
                                          (aiStack_a0[uVar7] + 0x18,param_4 + 0x18),
                       puVar8 = local_88, iVar1 != 0)) goto LAB_0047d180;
                    iVar10 = 0;
                    iVar2 = 1;
                    local_48 = 0;
                    local_44 = 0;
                  }
                  else {
                    pcVar5 = *(code **)(*(int *)(puVar8 + -0x7fe4) + 0x4a88);
                    do {
                      local_98 = auStack_50;
                      local_94 = param_7;
                      iVar1 = (*pcVar5)(param_1,param_4,param_4,param_5);
                      iVar2 = iVar2 + 1;
                      puVar8 = local_88;
                      if (iVar1 != 0) goto LAB_0047d180;
                    } while (iVar2 < 4);
                    local_94 = auStack_50;
                    local_98 = param_5;
                    local_90 = param_7;
                    iVar1 = (*(code *)(*(int *)(local_88 + -0x7fc0) + -0x44bc))
                                      (param_1,param_4,aiStack_a0[local_44],param_4);
                    puVar8 = local_88;
                    if (iVar1 != 0) goto LAB_0047d180;
                    iVar10 = 0;
                    iVar2 = 1;
                    local_44 = 0;
                  }
                }
              }
              local_94 = param_7;
              local_98 = auStack_50;
              iVar1 = (*(code *)(*(int *)(puVar8 + -0x7fc0) + -0x507c))
                                (param_1,param_4,param_4,param_5);
              puVar8 = local_88;
            } while (iVar1 == 0);
          }
        }
      }
    }
  }
  goto LAB_0047d180;
  while (local_30 = local_30 + 1, local_30 < iVar10) {
LAB_0047d500:
    local_44 = local_44 << 1;
    if (local_48 == 0) {
      local_98 = auStack_50;
      local_94 = param_7;
      iVar1 = (*(code *)(iVar9 + -0x507c))(param_1,param_4,param_4,param_5);
      puVar8 = local_88;
      if (iVar1 != 0) goto LAB_0047d180;
    }
    if ((local_44 >> 4 & 1) != 0) {
      if (local_48 == 1) {
        iVar1 = (**(code **)(puVar8 + -0x709c))(puVar3,param_4,puVar3,param_4);
        local_48 = 0;
        puVar8 = local_88;
        if (iVar1 != 0) goto LAB_0047d180;
        iVar1 = (**(code **)(local_88 + -0x709c))(local_38,param_4 + 0xc);
        puVar8 = local_88;
        if (iVar1 != 0) goto LAB_0047d180;
        iVar1 = (**(code **)(local_88 + -0x709c))(local_34,param_4 + 0x18);
      }
      else {
        local_94 = auStack_50;
        local_98 = param_5;
        local_90 = param_7;
        iVar1 = (*(code *)(*(int *)(puVar8 + -0x7fc0) + -0x44bc))(param_1,param_4);
      }
      puVar8 = local_88;
      if (iVar1 != 0) goto LAB_0047d180;
    }
  }
LAB_0047d14c:
  iVar1 = 0;
  if (local_4c != 0) {
    iVar1 = (*(code *)(*(int *)(puVar8 + -0x7fc0) + -0x3670))(param_1,param_4,param_5,auStack_50);
    puVar8 = local_88;
  }
LAB_0047d180:
  (**(code **)(puVar8 + -0x7770))(auStack_60);
  if (puVar3 != (undefined *)0x0) {
    (**(code **)(local_88 + -0x7770))(puVar3);
    (**(code **)(local_88 + -0x7770))(puVar3 + 0xc);
    (**(code **)(local_88 + -0x7770))(puVar3 + 0x18);
    (**(code **)(local_88 + -0x7b84))(puVar3);
  }
  piVar4 = local_80;
  iVar9 = 7;
  puVar8 = local_88;
  do {
    iVar2 = *piVar4;
    iVar9 = iVar9 + -1;
    piVar4 = piVar4 + 1;
    if (iVar2 != 0) {
      (**(code **)(puVar8 + -0x7770))(iVar2);
      (**(code **)(local_88 + -0x7770))(iVar2 + 0xc);
      (**(code **)(local_88 + -0x7770))(iVar2 + 0x18);
      (**(code **)(local_88 + -0x7b84))(iVar2);
      puVar8 = local_88;
    }
  } while (-1 < iVar9);
  return iVar1;
}



int psEccGenSharedSecret(undefined4 param_1,int param_2,int param_3,void *param_4,ushort *param_5)

{
  void *__ptr;
  int iVar1;
  uint __n;
  undefined *puVar2;
  undefined *__ptr_00;
  code *pcVar3;
  undefined auStack_38 [16];
  
  __ptr_00 = (undefined *)0x0;
  if (*(char *)(param_2 + 0x3c) != '\x02') {
    return -6;
  }
  if ((*(int *)(param_3 + 0x34) != 0) && (*(int *)(param_2 + 0x34) != *(int *)(param_3 + 0x34))) {
    return -6;
  }
  __ptr = (void *)FUN_00479ad4(param_1,(*(uint *)(param_2 + 8) & 0xfff) * 2 + 1);
  if (__ptr == (void *)0x0) {
    return -8;
  }
  puVar2 = *(undefined **)(param_2 + 0x34);
  if (puVar2[4] == '\0') {
    __ptr_00 = (undefined *)malloc(0xc);
    if (__ptr_00 == (undefined *)0x0) {
LAB_0047d958:
      pstm_clear(__ptr);
      pstm_clear((int)__ptr + 0xc);
      pstm_clear((int)__ptr + 0x18);
      free(__ptr);
      return -8;
    }
    iVar1 = pstm_init_for_read_unsigned_bin(param_1,__ptr_00,**(undefined **)(param_2 + 0x34));
    if (iVar1 < 0) {
      free(__ptr_00);
      goto LAB_0047d958;
    }
    iVar1 = pstm_read_radix(param_1,__ptr_00,*(undefined4 *)(*(byte **)(param_2 + 0x34) + 0x14),
                            (uint)**(byte **)(param_2 + 0x34) << 1,0x10);
    if (iVar1 != 0) {
      pstm_clear(__ptr_00);
      free(__ptr_00);
      goto LAB_0047d740;
    }
    puVar2 = *(undefined **)(param_2 + 0x34);
  }
  iVar1 = pstm_init_for_read_unsigned_bin(param_1,auStack_38,*puVar2);
  if (iVar1 == 0) {
    iVar1 = pstm_read_radix(param_1,auStack_38,*(undefined4 *)(*(byte **)(param_2 + 0x34) + 0x10),
                            (uint)**(byte **)(param_2 + 0x34) << 1,0x10);
    if (iVar1 == 0) {
      iVar1 = FUN_0047ccb8(param_1,param_2,param_3 + 0xc,__ptr,auStack_38,1,__ptr_00);
      if (iVar1 == 0) {
        __n = pstm_unsigned_bin_size(auStack_38);
        iVar1 = -9;
        if (__n <= *param_5) {
          memset(param_4,0,__n);
          iVar1 = pstm_unsigned_bin_size(__ptr);
          iVar1 = pstm_to_unsigned_bin(param_1,__ptr,(__n - iVar1) + (int)param_4);
          if (iVar1 != 0) goto LAB_0047d8b8;
        }
        *param_5 = (ushort)__n;
      }
    }
LAB_0047d8b8:
    if (__ptr_00 != (undefined *)0x0) {
      pstm_clear(__ptr_00);
      free(__ptr_00);
    }
    pcVar3 = pstm_clear;
    __ptr_00 = auStack_38;
LAB_0047d724:
    (*pcVar3)(__ptr_00);
  }
  else if (__ptr_00 != (undefined *)0x0) {
    pstm_clear(__ptr_00);
    pcVar3 = free;
    goto LAB_0047d724;
  }
  if (__ptr == (void *)0x0) {
    return iVar1;
  }
LAB_0047d740:
  pstm_clear(__ptr);
  pstm_clear((int)__ptr + 0xc);
  pstm_clear((int)__ptr + 0x18);
  free(__ptr);
  return iVar1;
}



int psEccGenKey(undefined4 param_1,void *param_2,byte *param_3,undefined4 param_4)

{
  void *__ptr;
  int iVar1;
  uint uVar2;
  int iVar3;
  void *__ptr_00;
  uint uVar4;
  int iVar5;
  undefined auStack_60 [8];
  uint local_58;
  undefined auStack_50 [16];
  undefined auStack_40 [16];
  void *local_30;
  int local_2c;
  
  local_30 = (void *)0x0;
  if ((param_2 == (void *)0x0) || (param_3 == (byte *)0x0)) {
    return -10;
  }
  memset(param_2,0,0x40);
  *(undefined4 *)((int)param_2 + 0x38) = param_1;
  *(undefined4 *)((int)param_2 + 0x30) = param_1;
  *(byte **)((int)param_2 + 0x34) = param_3;
  uVar4 = (uint)*param_3;
  __ptr = malloc(0x84);
  iVar5 = uVar4 << 1;
  if (__ptr == (void *)0x0) {
    _psTraceStr("psError %s","pubkey/ecc.c");
    _psTraceInt(&DAT_0049016c,0x1fa);
    iVar1 = -8;
    _psError("Memory allocation error in psEccGenKey\n");
  }
  else {
    iVar1 = pstm_init_for_read_unsigned_bin(param_1,auStack_50,uVar4);
    if (iVar1 < 0) {
LAB_0047dc28:
      iVar1 = -8;
    }
    else {
      iVar1 = pstm_read_radix(param_1,auStack_50,
                              *(undefined4 *)(*(int *)((int)param_2 + 0x34) + 0x1c),iVar5,0x10);
      if (iVar1 == 0) {
        while( true ) {
          uVar2 = psGetPrngLocked(__ptr,uVar4,param_4);
          if (uVar2 != uVar4) break;
          iVar1 = pstm_init_for_read_unsigned_bin(param_1,auStack_40,uVar4);
          if (iVar1 < 0) {
            pstm_clear(auStack_50,__ptr,uVar4);
            goto LAB_0047dc28;
          }
          iVar1 = pstm_read_unsigned_bin(auStack_40);
          if (iVar1 != 0) {
            pstm_clear(auStack_50,auStack_50);
            pstm_clear(auStack_40);
            goto LAB_0047db74;
          }
          iVar1 = pstm_cmp(auStack_40);
          if (iVar1 != 1) {
            pstm_clear(auStack_40);
            pstm_clear(auStack_50);
            if (*(char *)(*(int *)((int)param_2 + 0x34) + 4) == '\0') {
              local_30 = malloc(0xc);
              if (local_30 == (void *)0x0) goto LAB_0047dc28;
              iVar1 = pstm_init_for_read_unsigned_bin(param_1,local_30,uVar4);
              if (iVar1 < 0) {
                iVar1 = -8;
                free(local_30);
                goto LAB_0047db74;
              }
              iVar1 = pstm_read_radix(param_1,local_30,
                                      *(undefined4 *)(*(int *)((int)param_2 + 0x34) + 0x14),iVar5,
                                      0x10);
              if (iVar1 == 0) goto LAB_0047dcf0;
            }
            else {
LAB_0047dcf0:
              iVar3 = pstm_init_for_read_unsigned_bin(param_1,auStack_60,uVar4);
              iVar1 = -8;
              if (-1 < iVar3) {
                __ptr_00 = (void *)FUN_00479ad4(param_1,local_58 >> 0xc & 0xfff);
                if (__ptr_00 == (void *)0x0) {
                  iVar1 = -8;
                }
                else {
                  iVar1 = pstm_read_radix(param_1,auStack_60,
                                          *(undefined4 *)(*(int *)((int)param_2 + 0x34) + 0x10),
                                          iVar5,0x10);
                  if ((iVar1 == 0) &&
                     (iVar1 = pstm_read_radix(param_1,__ptr_00,
                                              *(undefined4 *)(*(int *)((int)param_2 + 0x34) + 0x20),
                                              iVar5,0x10), iVar1 == 0)) {
                    local_2c = (int)__ptr_00 + 0xc;
                    iVar1 = pstm_read_radix(param_1,local_2c,
                                            *(undefined4 *)(*(int *)((int)param_2 + 0x34) + 0x24),
                                            iVar5,0x10);
                    if (iVar1 == 0) {
                      pstm_set((int)__ptr_00 + 0x18,1);
                      iVar5 = pstm_init_for_read_unsigned_bin(param_1,param_2,uVar4);
                      iVar1 = -8;
                      if ((-1 < iVar5) &&
                         (iVar1 = pstm_read_unsigned_bin(param_2,__ptr,uVar4), iVar1 == 0)) {
                        iVar5 = pstm_init_size(param_1,(int)param_2 + 0xc,
                                               (*(uint *)((int)param_2 + 8) & 0xfff) * 2 + 1);
                        iVar1 = -8;
                        if (-1 < iVar5) {
                          iVar5 = pstm_init_size(param_1,(int)param_2 + 0x18,
                                                 (*(uint *)((int)param_2 + 8) & 0xfff) * 2 + 1);
                          iVar1 = -8;
                          if (-1 < iVar5) {
                            iVar5 = pstm_init_size(param_1,(int)param_2 + 0x24,
                                                   (*(uint *)((int)param_2 + 8) & 0xfff) * 2 + 1);
                            iVar1 = -8;
                            if (-1 < iVar5) {
                              iVar1 = FUN_0047ccb8(param_1,param_2,__ptr_00,(int)param_2 + 0xc,
                                                   auStack_60,1,local_30);
                              if (iVar1 == 0) {
                                *(undefined *)((int)param_2 + 0x3c) = 2;
                                pstm_clear(__ptr_00);
                                pstm_clear(local_2c);
                                pstm_clear((int)__ptr_00 + 0x18);
                                free(__ptr_00);
                                pstm_clear(auStack_60);
                                if (local_30 != (void *)0x0) {
                                  pstm_clear(local_30);
                                  free(local_30);
                                }
                                free(__ptr);
                                return 0;
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                  if (__ptr_00 != (void *)0x0) {
                    pstm_clear(__ptr_00);
                    pstm_clear((int)__ptr_00 + 0xc);
                    pstm_clear((int)__ptr_00 + 0x18);
                    free(__ptr_00);
                  }
                }
                pstm_clear(auStack_60);
              }
            }
            if (local_30 != (void *)0x0) {
              pstm_clear(local_30);
              free(local_30);
            }
            goto LAB_0047db74;
          }
          pstm_clear(auStack_40);
        }
        pstm_clear(auStack_50);
        iVar1 = -7;
      }
      else {
        pstm_clear(auStack_50);
      }
    }
LAB_0047db74:
    free(__ptr);
  }
  if (param_2 == (void *)0x0) {
    _psTraceStr("psAssert %s","pubkey/ecc.c");
    _psTraceInt(&DAT_0049016c,0xff);
    _psError(&DAT_00492674);
  }
  pstm_clear(param_2);
  pstm_clear_multi((int)param_2 + 0xc,(int)param_2 + 0x18,(int)param_2 + 0x24,0,0,0,0,0);
  *(undefined *)((int)param_2 + 0x3c) = 0;
  *(undefined4 *)((int)param_2 + 0x34) = 0;
  *(undefined4 *)((int)param_2 + 0x38) = 0;
  *(undefined4 *)((int)param_2 + 0x30) = 0;
  return iVar1;
}



int psEccDsaVerify(undefined4 param_1,int param_2,undefined4 param_3,ushort param_4,int param_5,
                  ushort param_6,undefined4 *param_7)

{
  int iVar1;
  void *__ptr;
  void *__ptr_00;
  int iVar2;
  void *__ptr_01;
  undefined auStack_d0 [16];
  undefined auStack_c0 [8];
  uint local_b8;
  undefined auStack_b0 [16];
  undefined auStack_a0 [16];
  undefined auStack_90 [8];
  uint local_88;
  undefined auStack_80 [16];
  undefined auStack_70 [16];
  undefined auStack_60 [8];
  uint local_58;
  undefined auStack_50 [8];
  uint local_48;
  undefined auStack_40 [4];
  int local_3c;
  undefined auStack_38 [4];
  uint local_34;
  uint local_30;
  
  *param_7 = 0xffffffff;
  local_3c = param_5;
  param_5 = (uint)param_6 + param_5;
  iVar1 = getAsnSequence(&local_3c,(uint)param_6,auStack_40);
  __ptr_01 = (void *)0x0;
  if (iVar1 < 0) {
    return iVar1;
  }
  iVar1 = pstm_read_asn(param_1,&local_3c,param_5 - local_3c & 0xffff,auStack_60);
  if (iVar1 < 0) {
    return iVar1;
  }
  iVar1 = pstm_read_asn(param_1,&local_3c,param_5 - local_3c & 0xffff,auStack_50);
  if (iVar1 < 0) {
    pstm_clear(auStack_60);
    return iVar1;
  }
  local_34 = (uint)**(byte **)(param_2 + 0x34) << 1;
  iVar1 = pstm_init_for_read_unsigned_bin(param_1,auStack_80,(uint)**(byte **)(param_2 + 0x34));
  if (iVar1 < 0) {
    pstm_clear(auStack_50);
    pstm_clear(auStack_60);
    return -8;
  }
  iVar1 = pstm_init_for_read_unsigned_bin(param_1,auStack_70,**(undefined **)(param_2 + 0x34));
  iVar2 = -8;
  if (iVar1 < 0) goto LAB_0047e618;
  iVar1 = pstm_init_size(param_1,auStack_d0,*(uint *)(param_2 + 0x14) >> 0xc & 0xfff);
  if (-1 < iVar1) {
    iVar1 = pstm_init_size(param_1,auStack_c0,local_48 >> 0xc & 0xfff);
    if (-1 < iVar1) {
      if (**(byte **)(param_2 + 0x34) < param_4) {
        param_4 = (ushort)**(byte **)(param_2 + 0x34);
      }
      iVar1 = pstm_init_for_read_unsigned_bin(param_1,auStack_90,param_4);
      if (-1 < iVar1) {
        iVar1 = pstm_init_size(param_1,auStack_b0,
                               (local_88 >> 0xc & 0xfff) + (local_b8 >> 0xc & 0xfff));
        if (-1 < iVar1) {
          iVar1 = pstm_init_size(param_1,auStack_a0,
                                 (local_58 >> 0xc & 0xfff) + (local_b8 >> 0xc & 0xfff));
          if (-1 < iVar1) {
            __ptr = (void *)FUN_00479ad4(param_1,*(uint *)(param_2 + 0x14) >> 0xb & 0x1ffe);
            if (__ptr != (void *)0x0) {
              __ptr_00 = (void *)FUN_00479ad4(param_1,*(uint *)(param_2 + 0x14) >> 0xb & 0x1ffe);
              if (__ptr_00 != (void *)0x0) {
                local_30 = local_34 & 0xffff;
                iVar2 = pstm_read_radix(param_1,auStack_80,
                                        *(undefined4 *)(*(int *)(param_2 + 0x34) + 0x1c),local_30,
                                        0x10);
                if ((iVar2 == 0) &&
                   (iVar2 = pstm_read_radix(param_1,auStack_70,
                                            *(undefined4 *)(*(int *)(param_2 + 0x34) + 0x10),
                                            local_30,0x10), iVar2 == 0)) {
                  if (((local_58 & 0xfff) == 0) ||
                     (((local_48 & 0xfff) == 0 ||
                      (iVar1 = pstm_cmp(auStack_60,auStack_80), iVar1 != -1)))) {
                    iVar2 = -0x1f;
                  }
                  else {
                    iVar1 = pstm_cmp(auStack_50,auStack_80);
                    iVar2 = -0x1f;
                    if ((iVar1 == -1) &&
                       ((((iVar2 = pstm_read_unsigned_bin(auStack_90,param_3,param_4), iVar2 == 0 &&
                          (iVar2 = pstm_invmod(param_1,auStack_50,auStack_80,auStack_c0), iVar2 == 0
                          )) && (iVar2 = pstm_mulmod(param_1,auStack_90,auStack_c0,auStack_80,
                                                     auStack_b0), iVar2 == 0)) &&
                        (((iVar2 = pstm_mulmod(param_1,auStack_60,auStack_c0,auStack_80,auStack_a0),
                          iVar2 == 0 &&
                          (iVar2 = pstm_read_radix(param_1,__ptr,
                                                   *(undefined4 *)(*(int *)(param_2 + 0x34) + 0x20),
                                                   local_30,0x10), iVar2 == 0)) &&
                         (iVar2 = pstm_read_radix(param_1,(int)__ptr + 0xc,
                                                  *(undefined4 *)(*(int *)(param_2 + 0x34) + 0x24),
                                                  local_30,0x10), iVar2 == 0)))))) {
                      pstm_set((int)__ptr + 0x18,1);
                      iVar2 = pstm_copy(param_2 + 0xc,__ptr_00);
                      if (((iVar2 == 0) &&
                          (iVar2 = pstm_copy(param_2 + 0x18,(int)__ptr_00 + 0xc), iVar2 == 0)) &&
                         (iVar2 = pstm_copy(param_2 + 0x24,(int)__ptr_00 + 0x18), iVar2 == 0)) {
                        if (*(char *)(*(int *)(param_2 + 0x34) + 4) == '\0') {
                          __ptr_01 = malloc(0xc);
                          if (__ptr_01 == (void *)0x0) goto LAB_0047e4bc;
                          iVar1 = pstm_init_for_read_unsigned_bin
                                            (param_1,__ptr_01,**(undefined **)(param_2 + 0x34));
                          if ((-1 < iVar1) &&
                             (iVar2 = pstm_read_radix(param_1,__ptr_01,
                                                      *(undefined4 *)
                                                       (*(byte **)(param_2 + 0x34) + 0x14),
                                                      (uint)**(byte **)(param_2 + 0x34) << 1,0x10),
                             iVar2 == 0)) goto LAB_0047e938;
                        }
                        else {
LAB_0047e938:
                          iVar2 = FUN_0047ccb8(param_1,auStack_b0,__ptr,__ptr,auStack_70,0,__ptr_01)
                          ;
                          if ((iVar2 == 0) &&
                             ((iVar2 = FUN_0047ccb8(param_1,auStack_a0,__ptr_00,__ptr_00,auStack_70,
                                                    0,__ptr_01), iVar2 == 0 &&
                              (iVar2 = pstm_montgomery_setup(auStack_70,auStack_38), iVar2 == 0))))
                          {
                            iVar2 = FUN_0047bb44(param_1,__ptr_00,__ptr,__ptr,auStack_70,auStack_38,
                                                 __ptr_01);
                            if ((iVar2 == 0) &&
                               (((iVar2 = FUN_0047c990(param_1,__ptr,auStack_70,auStack_38),
                                 iVar2 == 0 &&
                                 (iVar2 = pstm_mod(param_1,__ptr,auStack_80,auStack_d0), iVar2 == 0)
                                 ) && (iVar1 = pstm_cmp(auStack_d0,auStack_60), iVar1 == 0)))) {
                              *param_7 = 1;
                            }
                          }
                        }
                        if (__ptr_01 != (void *)0x0) {
                          pstm_clear(__ptr_01);
                          free(__ptr_01);
                        }
                      }
                    }
                  }
                }
LAB_0047e4bc:
                if (__ptr_00 != (void *)0x0) {
                  pstm_clear(__ptr_00);
                  pstm_clear((int)__ptr_00 + 0xc);
                  pstm_clear((int)__ptr_00 + 0x18);
                  free(__ptr_00);
                }
              }
              if (__ptr != (void *)0x0) {
                pstm_clear(__ptr);
                pstm_clear((int)__ptr + 0xc);
                pstm_clear((int)__ptr + 0x18);
                free(__ptr);
              }
            }
            pstm_clear(auStack_a0);
          }
          pstm_clear(auStack_b0);
        }
        pstm_clear(auStack_90);
      }
      pstm_clear(auStack_c0);
    }
    pstm_clear(auStack_d0);
  }
  pstm_clear(auStack_70);
LAB_0047e618:
  pstm_clear(auStack_80);
  pstm_clear(auStack_50);
  pstm_clear(auStack_60);
  return iVar2;
}



int psEccDsaSign(undefined4 param_1,int param_2,undefined4 param_3,uint param_4,undefined *param_5,
                ushort *param_6,byte param_7,undefined4 param_8)

{
  bool bVar1;
  int iVar2;
  uint uVar3;
  undefined *puVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  undefined *puVar8;
  undefined auStack_b8 [12];
  undefined auStack_ac [12];
  undefined auStack_a0 [12];
  undefined auStack_94 [12];
  undefined4 local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined local_7c;
  int local_78 [2];
  uint local_70;
  int local_68 [2];
  uint local_60;
  undefined auStack_58 [16];
  undefined auStack_48 [8];
  uint local_40;
  uint local_38;
  int local_34;
  int local_30;
  
  local_38 = (uint)param_7;
  iVar6 = -8;
  local_30 = 0;
  local_34 = 0;
  if (*(char *)(param_2 + 0x3c) != '\x02') {
    return -6;
  }
  uVar5 = (uint)**(byte **)(param_2 + 0x34);
  uVar7 = param_4 & 0xffff;
  if (uVar5 < (param_4 & 0xffff)) {
    uVar7 = uVar5;
  }
  iVar2 = pstm_init_for_read_unsigned_bin(param_1,auStack_48,uVar5);
  if (iVar2 < 0) {
    return -8;
  }
  iVar2 = pstm_init_for_read_unsigned_bin(param_1,auStack_58,uVar7);
  if (iVar2 < 0) goto LAB_0047ed68;
  iVar2 = pstm_init_size(param_1,local_78,local_40 >> 0xc & 0xfff);
  if (-1 < iVar2) {
    iVar2 = pstm_init_size(param_1,local_68,local_40 >> 0xc & 0xfff);
    if (-1 < iVar2) {
      iVar6 = pstm_read_radix(param_1,auStack_48,*(undefined4 *)(*(int *)(param_2 + 0x34) + 0x1c),
                              uVar5 << 1,0x10);
      if (iVar6 == 0) {
        iVar6 = pstm_read_unsigned_bin(auStack_58,param_3,uVar7);
        uVar7 = 0;
        if (iVar6 == 0) {
          do {
            bVar1 = uVar7 < 100;
            do {
              if (!bVar1) {
LAB_0047ed1c:
                iVar6 = -7;
                goto LAB_0047ed20;
              }
              while( true ) {
                uVar7 = uVar7 + 1;
                iVar6 = psEccGenKey(param_1,auStack_b8,*(undefined4 *)(param_2 + 0x34),param_8);
                if (iVar6 != 0) goto LAB_0047ed20;
                iVar6 = pstm_mod(param_1,auStack_ac,auStack_48,local_78);
                if (iVar6 != 0) goto LAB_0047f0f0;
                if ((local_70 & 0xfff) != 0) break;
                pstm_clear(auStack_b8);
                pstm_clear_multi(auStack_ac,auStack_a0,auStack_94,0,0,0,0,0);
                local_84 = 0;
                local_80 = 0;
                local_88 = 0;
                local_7c = 0;
                if (99 < uVar7) goto LAB_0047ed1c;
              }
              iVar6 = pstm_invmod(param_1,auStack_b8,auStack_48,auStack_b8);
              if ((((iVar6 != 0) ||
                   (iVar6 = pstm_mulmod(param_1,param_2,local_78,auStack_48,local_68), iVar6 != 0))
                  || (iVar6 = pstm_add(auStack_58,local_68,local_68), iVar6 != 0)) ||
                 ((iVar6 = pstm_mod(param_1,local_68,auStack_48,local_68), iVar6 != 0 ||
                  (iVar6 = pstm_mulmod(param_1,local_68,auStack_b8,auStack_48,local_68), iVar6 != 0)
                  ))) goto LAB_0047f0f0;
              pstm_clear(auStack_b8);
              pstm_clear_multi(auStack_ac,auStack_a0,auStack_94,0,0,0,0,0);
              local_84 = 0;
              local_80 = 0;
              local_88 = 0;
              local_7c = 0;
              uVar5 = pstm_unsigned_bin_size(local_78);
              uVar3 = pstm_unsigned_bin_size(local_68);
              bVar1 = uVar7 < 100;
            } while (((int)(uVar5 + 6) < (int)(uint)**(byte **)(param_2 + 0x34)) ||
                    ((int)(uVar3 + 6) < (int)(uint)**(byte **)(param_2 + 0x34)));
          } while ((local_60 & 0xfff) == 0);
          if (*(char *)(uVar5 + local_78[0] + -1) < '\0') {
            uVar5 = uVar5 + 1 & 0xffff;
            local_34 = 1;
          }
          if (*(char *)(uVar3 + local_68[0] + -1) < '\0') {
            uVar3 = uVar3 + 1 & 0xffff;
            local_30 = 1;
          }
          uVar7 = uVar5 + uVar3 + 6 & 0xffff;
          if (0x7f < (int)(uVar7 - 3)) {
            uVar7 = uVar7 + 1 & 0xffff;
          }
          if (local_38 == 0) {
            iVar6 = -1;
            if (uVar7 <= *param_6) goto LAB_0047efc4;
          }
          else {
            iVar6 = -1;
            if (uVar7 + 2 <= (uint)*param_6) {
              *param_5 = (char)(uVar7 >> 8);
              param_5[1] = (char)uVar7;
              param_5 = param_5 + 2;
LAB_0047efc4:
              *param_5 = 0x30;
              if ((int)(uVar7 - 3) < 0x80) {
                param_5[1] = (char)uVar7 + -2;
                param_5 = param_5 + 2;
                *param_6 = 0;
              }
              else {
                param_5[1] = 0x81;
                param_5[2] = (char)(uVar7 - 3);
                param_5 = param_5 + 3;
                *param_6 = 1;
              }
              *param_5 = 2;
              param_5[1] = (char)uVar5;
              puVar8 = param_5 + 2;
              if (local_38 == 0) {
                *param_6 = *param_6 + 4;
              }
              else {
                *param_6 = *param_6 + 6;
              }
              if (local_34 != 0) {
                *puVar8 = 0;
                puVar8 = param_5 + 3;
              }
              iVar6 = pstm_to_unsigned_bin(param_1,local_78,puVar8);
              if (iVar6 == 0) {
                puVar8 = puVar8 + (uVar5 - local_34);
                *param_6 = (short)uVar5 + *param_6;
                *puVar8 = 2;
                puVar8[1] = (char)uVar3;
                puVar4 = puVar8 + 2;
                if (local_30 != 0) {
                  puVar8[2] = 0;
                  puVar4 = puVar8 + 3;
                }
                iVar6 = pstm_to_unsigned_bin(param_1,local_68,puVar4);
                if (iVar6 == 0) {
                  *param_6 = (short)uVar3 + *param_6 + 2;
                }
                else {
LAB_0047f0f0:
                  pstm_clear(auStack_b8);
                  pstm_clear_multi(auStack_ac,auStack_a0,auStack_94,0,0,0,0,0);
                  local_84 = 0;
                  local_80 = 0;
                  local_88 = 0;
                  local_7c = 0;
                }
              }
            }
          }
        }
      }
LAB_0047ed20:
      pstm_clear(local_68);
    }
    pstm_clear(local_78);
  }
  pstm_clear(auStack_58);
LAB_0047ed68:
  pstm_clear(auStack_48);
  return iVar6;
}



undefined4 psInitPubKey(undefined4 param_1,int param_2,char param_3,undefined4 param_4)

{
  undefined4 uVar1;
  
  uVar1 = 0xfffffffa;
  if (param_2 != 0) {
    if (param_3 == '\x01') {
      psRsaInitKey();
      *(undefined4 *)(param_2 + 0x68) = param_1;
    }
    else if (param_3 == '\x03') {
      psEccInitKey(param_1,param_2,0,param_4,&_gp);
      *(undefined4 *)(param_2 + 0x68) = param_1;
    }
    else {
      *(undefined4 *)(param_2 + 0x68) = param_1;
    }
    *(char *)(param_2 + 0x6e) = param_3;
    *(undefined2 *)(param_2 + 0x6c) = 0;
    uVar1 = 0;
  }
  return uVar1;
}



void psClearPubKey(int param_1)

{
  code *pcVar1;
  
  if (param_1 == 0) {
    return;
  }
  pcVar1 = psRsaClearKey;
  if (*(char *)(param_1 + 0x6e) != '\x01') {
    if (*(char *)(param_1 + 0x6e) != '\x03') {
      *(undefined *)(param_1 + 0x6e) = 0;
      goto LAB_0047f2b0;
    }
    pcVar1 = psEccClearKey;
  }
  (*pcVar1)();
  *(undefined *)(param_1 + 0x6e) = 0;
LAB_0047f2b0:
  *(undefined4 *)(param_1 + 0x68) = 0;
  *(undefined2 *)(param_1 + 0x6c) = 0;
  return;
}



undefined4 psHashLenToSigAlg(undefined2 param_1,char param_2)

{
  undefined4 uVar1;
  
  if ((param_2 != '\x01') && (param_2 != '\x03')) {
    _psTraceStr("psAssert %s","pubkey/pubkey.c");
    _psTraceInt(&DAT_0049016c,0x164);
    _psError("key_type == PS_RSA || key_type == PS_ECC");
  }
  switch(param_1) {
  case 0x10:
    if (param_2 == '\x01') {
      return 0xfffffffa;
    }
  default:
    uVar1 = 0xfffffff6;
    break;
  case 0x14:
    uVar1 = 0x689;
    if (param_2 != '\x01') {
      return 0x208;
    }
    break;
  case 0x20:
    uVar1 = 0x68f;
    if (param_2 != '\x01') {
      return 0x20c;
    }
    break;
  case 0x30:
    uVar1 = 0x690;
    if (param_2 != '\x01') {
      return 0x20d;
    }
    break;
  case 0x40:
    uVar1 = 0x691;
    if (param_2 != '\x01') {
      return 0x20e;
    }
  }
  return uVar1;
}



undefined4
psVerifySig(undefined4 param_1,undefined4 param_2,undefined2 param_3,undefined4 param_4,
           undefined2 param_5,int param_6,undefined4 param_7,undefined4 *param_8)

{
  int iVar1;
  undefined auStack_70 [64];
  int local_30 [2];
  
  memset(auStack_70,0,0x40);
  *param_8 = 0;
  if (*(char *)(param_6 + 0x6e) == '\x01') {
    iVar1 = pubRsaDecryptSignedElementExt
                      (param_1,param_6,param_4,param_5,auStack_70,param_3,param_7,0);
    if (-1 < iVar1) {
      iVar1 = memcmpct(param_2,auStack_70,param_3);
      if (iVar1 == 0) goto LAB_0047f610;
      goto LAB_0047f580;
    }
  }
  else {
    if (*(char *)(param_6 + 0x6e) != '\x03') {
      return 0xfffffff6;
    }
    iVar1 = psEccDsaVerify(param_1,param_6,param_2,param_3,param_4,param_5,local_30,0);
    if (-1 < iVar1) {
      if (local_30[0] == 1) {
LAB_0047f610:
        *param_8 = 1;
        return 0;
      }
LAB_0047f580:
      *param_8 = 0;
      return 0xffffffeb;
    }
  }
  return 0xffffffff;
}



undefined4 psRsaInitKey(undefined4 param_1,void *param_2)

{
  undefined4 uVar1;
  
  uVar1 = 0xfffffff8;
  if (param_2 != (void *)0x0) {
    memset(param_2,0,0x68);
    *(undefined4 *)((int)param_2 + 0x60) = param_1;
    uVar1 = 0;
  }
  return uVar1;
}



void psRsaClearKey(int param_1)

{
  pstm_clear(param_1 + 0x18);
  pstm_clear(param_1);
  pstm_clear(param_1 + 0xc);
  pstm_clear(param_1 + 0x48);
  pstm_clear(param_1 + 0x54);
  pstm_clear(param_1 + 0x30);
  pstm_clear(param_1 + 0x3c);
  pstm_clear(param_1 + 0x24);
  *(undefined4 *)(param_1 + 0x60) = 0;
  *(undefined2 *)(param_1 + 100) = 0;
  *(undefined *)(param_1 + 0x66) = 0;
  return;
}



int psRsaCopyKey(int param_1,int param_2)

{
  undefined uVar1;
  undefined2 uVar2;
  int iVar3;
  
  iVar3 = pstm_init_copy(*(undefined4 *)(param_2 + 0x60),param_1 + 0x18,param_2 + 0x18,0);
  if (((((iVar3 == 0) &&
        (iVar3 = pstm_init_copy(*(undefined4 *)(param_2 + 0x60),param_1,param_2,0), iVar3 == 0)) &&
       (iVar3 = pstm_init_copy(*(undefined4 *)(param_2 + 0x60),param_1 + 0xc,param_2 + 0xc,0),
       iVar3 == 0)) &&
      ((iVar3 = pstm_init_copy(*(undefined4 *)(param_2 + 0x60),param_1 + 0x48,param_2 + 0x48,0),
       iVar3 == 0 &&
       (iVar3 = pstm_init_copy(*(undefined4 *)(param_2 + 0x60),param_1 + 0x54,param_2 + 0x54,0),
       iVar3 == 0)))) &&
     ((iVar3 = pstm_init_copy(*(undefined4 *)(param_2 + 0x60),param_1 + 0x30,param_2 + 0x30,0),
      iVar3 == 0 &&
      ((iVar3 = pstm_init_copy(*(undefined4 *)(param_2 + 0x60),param_1 + 0x3c,param_2 + 0x3c,0),
       iVar3 == 0 &&
       (iVar3 = pstm_init_copy(*(undefined4 *)(param_2 + 0x60),param_1 + 0x24,param_2 + 0x24,0),
       iVar3 == 0)))))) {
    uVar2 = *(undefined2 *)(param_2 + 100);
    uVar1 = *(undefined *)(param_2 + 0x66);
    *(undefined4 *)(param_1 + 0x60) = *(undefined4 *)(param_2 + 0x60);
    *(undefined2 *)(param_1 + 100) = uVar2;
    *(undefined *)(param_1 + 0x66) = uVar1;
    return 0;
  }
  if (-1 < iVar3) {
    return iVar3;
  }
  psRsaClearKey(param_1);
  return iVar3;
}



undefined2 psRsaSize(int param_1)

{
  return *(undefined2 *)(param_1 + 100);
}



undefined4 psRsaCmpPubKey(int param_1,int param_2)

{
  int iVar1;
  
  iVar1 = pstm_cmp(param_1 + 0x18,param_2 + 0x18);
  if ((iVar1 == 0) && (iVar1 = pstm_cmp(param_1,param_2), iVar1 == 0)) {
    return 0;
  }
  return 0xffffffff;
}



undefined4
psRsaParseAsnPubKey(undefined4 param_1,char **param_2,uint param_3,int param_4,undefined4 param_5)

{
  char cVar1;
  char *pcVar2;
  undefined2 uVar3;
  int iVar4;
  uint uVar5;
  undefined auStack_f8 [208];
  ushort local_28;
  ushort local_26;
  char *local_24;
  
  if ((param_3 & 0xffff) != 0) {
    local_24 = *param_2 + 1;
    if (**param_2 == '\x03') {
      uVar5 = (param_3 & 0xffff) - 1;
      iVar4 = getAsnLength(&local_24,uVar5 & 0xffff,&local_28);
      if (iVar4 < 0) {
        return 0xffffffe1;
      }
      if (((int)(uint)local_28 <= (int)uVar5) &&
         (cVar1 = *local_24, local_24 = local_24 + 1, cVar1 == '\0')) {
        if (local_28 == 0) {
          return 0xffffffe1;
        }
        psSha1Init(auStack_f8);
        psSha1Update(auStack_f8,local_24,local_28 - 1);
        psSha1Final(auStack_f8,param_5);
        iVar4 = getAsnSequence(&local_24,local_28,&local_26);
        pcVar2 = local_24;
        if (-1 < iVar4) {
          iVar4 = pstm_read_asn(param_1,&local_24,(uint)local_26,param_4 + 0x18);
          if ((-1 < iVar4) &&
             (iVar4 = pstm_read_asn(param_1,&local_24,
                                    (uint)(pcVar2 + ((uint)local_26 - (int)local_24)) & 0xffff,
                                    param_4), -1 < iVar4)) {
            uVar3 = pstm_unsigned_bin_size(param_4 + 0x18);
            *(undefined4 *)(param_4 + 0x60) = param_1;
            *param_2 = local_24;
            *(undefined2 *)(param_4 + 100) = uVar3;
            return 0;
          }
        }
      }
    }
  }
  return 0xffffffe1;
}



undefined4 psRsaParsePkcs1PrivKey(undefined4 param_1,uint param_2,uint param_3,void *param_4)

{
  uint uVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  int iVar4;
  uint uVar5;
  uint local_res4 [3];
  ushort local_20 [2];
  int local_1c;
  
  uVar3 = 0xfffffff8;
  if (param_4 != (void *)0x0) {
    local_res4[0] = param_2;
    memset(param_4,0,0x68);
    *(undefined4 *)((int)param_4 + 0x60) = param_1;
    uVar5 = (param_3 & 0xffff) + local_res4[0];
    iVar4 = getAsnSequence(local_res4,param_3 & 0xffff,local_20);
    uVar1 = local_res4[0];
    if (((((iVar4 < 0) ||
          (iVar4 = getAsnInteger(local_res4,uVar5 - local_res4[0] & 0xffff,&local_1c), iVar4 < 0))
         || (local_1c != 0)) ||
        ((((iVar4 = pstm_read_asn(param_1,local_res4,uVar5 - local_res4[0] & 0xffff,
                                  (int)param_4 + 0x18), iVar4 < 0 ||
           (iVar4 = pstm_read_asn(param_1,local_res4,uVar5 - local_res4[0] & 0xffff,param_4),
           iVar4 < 0)) ||
          ((iVar4 = pstm_read_asn(param_1,local_res4,uVar5 - local_res4[0] & 0xffff,
                                  (int)param_4 + 0xc), iVar4 < 0 ||
           ((iVar4 = pstm_read_asn(param_1,local_res4,uVar5 - local_res4[0] & 0xffff,
                                   (int)param_4 + 0x48), iVar4 < 0 ||
            (iVar4 = pstm_read_asn(param_1,local_res4,uVar5 - local_res4[0] & 0xffff,
                                   (int)param_4 + 0x54), iVar4 < 0)))))) ||
         (iVar4 = pstm_read_asn(param_1,local_res4,uVar5 - local_res4[0] & 0xffff,
                                (int)param_4 + 0x30), iVar4 < 0)))) ||
       (((iVar4 = pstm_read_asn(param_1,local_res4,uVar5 - local_res4[0] & 0xffff,
                                (int)param_4 + 0x3c), iVar4 < 0 ||
         (iVar4 = pstm_read_asn(param_1,local_res4,uVar5 - local_res4[0] & 0xffff,
                                (int)param_4 + 0x24), iVar4 < 0)) ||
        ((uint)local_20[0] != (local_res4[0] - uVar1 & 0xffff))))) {
      psRsaClearKey(param_4);
      uVar3 = 0xffffffe1;
    }
    else {
      *(undefined *)((int)param_4 + 0x66) = 1;
      uVar2 = pstm_unsigned_bin_size((int)param_4 + 0x18);
      *(undefined2 *)((int)param_4 + 100) = uVar2;
      if (uVar5 != local_res4[0]) {
        for (; local_res4[0] < uVar5; local_res4[0] = local_res4[0] + 1) {
        }
      }
      uVar3 = 0;
    }
  }
  return uVar3;
}



undefined4
psRsaCrypt(undefined4 param_1,int param_2,int param_3,short param_4,undefined *param_5,
          ushort *param_6,char param_7)

{
  bool bVar1;
  int iVar2;
  uint __n;
  int iVar3;
  undefined4 uVar4;
  undefined4 local_60 [4];
  undefined4 local_50 [4];
  undefined4 local_40 [4];
  int local_30;
  
  if (param_3 == 0) {
    return 0xfffffffa;
  }
  if (param_5 == (undefined *)0x0) {
    return 0xfffffffa;
  }
  if (param_6 == (ushort *)0x0) {
    return 0xfffffffa;
  }
  if (param_2 == 0) {
    return 0xfffffffa;
  }
  local_40[0] = 0;
  local_50[0] = 0;
  local_60[0] = 0;
  iVar2 = pstm_init_for_read_unsigned_bin(param_1,local_60,param_4 + 4);
  if (iVar2 != 0) {
    return 0xffffffff;
  }
  iVar2 = pstm_read_unsigned_bin(local_60,param_3,param_4);
  iVar3 = param_2 + 0x18;
  if (iVar2 != 0) {
    pstm_clear(local_60);
    return 0xffffffff;
  }
  iVar2 = pstm_cmp(iVar3,local_60);
  uVar4 = 0xfffffff7;
  if (iVar2 == -1) goto LAB_0047ff58;
  if (param_7 == '\x02') {
    if (*(char *)(param_2 + 0x66) == '\0') {
      iVar2 = param_2 + 0xc;
      goto LAB_0047fff4;
    }
    iVar2 = pstm_init_size(param_1,local_50,*(uint *)(param_2 + 0x50) >> 0xc & 0xfff);
    uVar4 = 0xffffffff;
    if (iVar2 != 0) goto LAB_0047ff58;
    iVar2 = pstm_init_size(param_1,local_40,*(uint *)(param_2 + 0x5c) >> 0xc & 0xfff);
    if (iVar2 != 0) {
      pstm_clear(local_50);
      goto LAB_0047ff58;
    }
    iVar2 = pstm_exptmod(param_1,local_60,param_2 + 0x30,param_2 + 0x48,local_50);
    if ((iVar2 != 0) ||
       (local_30 = param_2 + 0x54,
       iVar2 = pstm_exptmod(param_1,local_60,param_2 + 0x3c,param_2 + 0x54,local_40), iVar2 != 0)) {
LAB_0047ff50:
      uVar4 = 0xffffffff;
      goto LAB_0047ff58;
    }
    iVar2 = pstm_sub(local_50,local_40,local_60);
    if ((iVar2 != 0) ||
       (iVar2 = pstm_mulmod(param_1,local_60,param_2 + 0x24,param_2 + 0x48,local_60), iVar2 != 0))
    goto LAB_0047ff50;
    iVar2 = pstm_mul_comba(param_1,local_60,local_30,local_60,0,0);
    uVar4 = 0xffffffff;
    if (iVar2 != 0) goto LAB_0047ff58;
    iVar2 = pstm_add(local_60,local_40,local_60);
  }
  else {
    iVar2 = param_2;
    if (param_7 != '\x01') goto LAB_0047ff50;
LAB_0047fff4:
    iVar2 = pstm_exptmod(param_1,local_60,iVar2,iVar3,local_60);
  }
  uVar4 = 0xffffffff;
  if (iVar2 == 0) {
    __n = pstm_unsigned_bin_size(iVar3);
    uVar4 = 0xffffffff;
    if (__n <= *param_6) {
      bVar1 = __n < *(ushort *)(param_2 + 100);
      while (bVar1) {
        *param_5 = 0;
        __n = __n + 1;
        bVar1 = __n < *(ushort *)(param_2 + 100);
        param_5 = param_5 + 1;
      }
      *param_6 = (ushort)__n;
      memset(param_5,0,__n);
      iVar2 = pstm_unsigned_bin_size(local_60);
      iVar2 = pstm_to_unsigned_bin(param_1,local_60,param_5 + (__n - iVar2));
      uVar4 = 0;
      if (iVar2 != 0) {
        uVar4 = 0xffffffff;
      }
    }
  }
LAB_0047ff58:
  if ((param_7 == '\x02') && (*(char *)(param_2 + 0x66) != '\0')) {
    pstm_clear_multi(local_50,local_40,0,0,0,0,0,0);
  }
  pstm_clear(local_60);
  return uVar4;
}



int psRsaEncryptPub(undefined4 param_1,int param_2,undefined4 param_3,undefined2 param_4,
                   undefined4 param_5,ushort param_6,undefined4 param_7)

{
  ushort uVar1;
  int iVar2;
  ushort local_20 [4];
  
  uVar1 = *(ushort *)(param_2 + 100);
  local_20[0] = param_6;
  iVar2 = -6;
  if (uVar1 <= param_6) {
    iVar2 = pkcs1Pad(param_3,param_4,param_5,uVar1,2,param_7);
    if (-1 < iVar2) {
      iVar2 = psRsaCrypt(param_1,param_2,param_5,uVar1,param_5,local_20,1,param_7);
      if (-1 < iVar2) {
        iVar2 = (local_20[0] == uVar1) - 1;
      }
    }
  }
  return iVar2;
}



int psRsaDecryptPub(undefined4 param_1,int param_2,undefined4 param_3,short param_4,
                   undefined4 param_5,undefined2 param_6,undefined4 param_7)

{
  int iVar1;
  short *psVar2;
  undefined4 uVar3;
  short local_20 [4];
  
  iVar1 = -6;
  if (*(short *)(param_2 + 100) == param_4) {
    psVar2 = local_20;
    uVar3 = 1;
    local_20[0] = param_4;
    iVar1 = psRsaCrypt();
    if (-1 < iVar1) {
      iVar1 = -1;
      if (local_20[0] == param_4) {
        iVar1 = pkcs1Unpad(param_3,param_4,param_5,param_6,1,psVar2,uVar3,param_7);
        if (-1 < iVar1) {
          iVar1 = 0;
        }
      }
    }
  }
  return iVar1;
}



int psRsaEncryptPriv(undefined4 param_1,int param_2,undefined4 param_3,uint param_4,void *param_5,
                    ushort param_6,undefined4 param_7)

{
  ushort uVar1;
  int iVar2;
  void *__dest;
  void *__ptr;
  ushort local_30;
  ushort local_2e [3];
  
  local_30 = param_6;
  __ptr = (void *)0x0;
  __dest = (void *)0x0;
  if (param_4 < 0x1c) {
    return -6;
  }
  uVar1 = *(ushort *)(param_2 + 100);
  if (param_6 < uVar1) {
    return -6;
  }
  iVar2 = pkcs1Pad(param_3,param_4,param_5,uVar1,1,param_7);
  if (iVar2 < 0) {
    return iVar2;
  }
  iVar2 = psRsaCrypt(param_1,param_2,param_5,uVar1,param_5,&local_30,2,param_7);
  if (iVar2 < 0) {
    return iVar2;
  }
  if (((local_30 != uVar1) || (__ptr = malloc(param_4), __ptr == (void *)0x0)) ||
     (__dest = malloc((size_t)local_30), __dest == (void *)0x0)) goto LAB_004805a4;
  memcpy(__dest,param_5,(size_t)local_30);
  uVar1 = *(ushort *)(param_2 + 100);
  if (uVar1 != local_30) goto LAB_004805a4;
  local_2e[0] = local_30;
  iVar2 = psRsaCrypt(param_1,param_2,__dest,local_30,__dest,local_2e,1,param_7);
  if (iVar2 < 0) {
LAB_00480758:
    if (iVar2 < 0) goto LAB_004805a4;
  }
  else {
    if (local_2e[0] != uVar1) goto LAB_004805a4;
    iVar2 = pkcs1Unpad(__dest,local_2e[0],__ptr,param_4,1);
    if (iVar2 < 0) goto LAB_00480758;
  }
  iVar2 = memcmpct(param_3,__ptr,param_4);
  if (iVar2 == 0) {
    memset_s(__ptr,param_4,0,param_4);
    free(__ptr);
    memset_s(__dest,local_30,0,local_30);
    free(__dest);
    return 0;
  }
LAB_004805a4:
  memset_s(param_5,param_6,0,param_6);
  if (__dest != (void *)0x0) {
    memset_s(__dest,local_30,0,local_30);
    free(__dest);
  }
  if (__ptr != (void *)0x0) {
    memset_s(__ptr,param_4,0,param_4);
    free(__ptr);
  }
  return -1;
}



undefined4
privRsaEncryptSignedElement
          (undefined4 param_1,undefined4 param_2,void *param_3,ushort param_4,undefined4 param_5,
          undefined2 param_6,undefined4 param_7)

{
  int iVar1;
  undefined *__dest;
  size_t __n;
  undefined4 uVar2;
  undefined4 local_70;
  undefined4 local_6c;
  undefined4 local_68;
  undefined4 local_64;
  undefined2 local_60;
  undefined local_5e;
  undefined auStack_5d [69];
  
  if (param_4 == 0x20) {
    local_64 = 0x5010204;
    local_5e = 0x20;
    local_70 = 0xd303130;
    local_6c = 0x86600906;
    local_68 = 0x3650148;
    local_60 = 0x400;
    __dest = auStack_5d;
    __n = 0x20;
    uVar2 = 0x33;
  }
  else if (param_4 < 0x21) {
    if (param_4 != 0x14) {
      return 0xfffffff6;
    }
    local_70 = 0x9302130;
    local_6c = 0xe2b0506;
    local_68 = 0x51a0203;
    local_64 = CONCAT13(local_64._3_1_,0x140400);
    __dest = (undefined *)((int)&local_64 + 3);
    __n = 0x14;
    uVar2 = 0x23;
  }
  else {
    if (param_4 != 0x30) {
      return 0xfffffff6;
    }
    local_6c = 0x86600906;
    local_64 = 0x5020204;
    local_5e = 0x30;
    local_70 = 0xd304130;
    local_68 = 0x3650148;
    local_60 = 0x400;
    __dest = auStack_5d;
    __n = 0x30;
    uVar2 = 0x43;
  }
  memcpy(__dest,param_3,__n);
  iVar1 = psRsaEncryptPriv(param_1,param_2,&local_70,uVar2,param_5,param_6,param_7);
  if (iVar1 < 0) {
    memset_s(&local_70,0x53,0,0x53);
    return 0xfffffff9;
  }
  memset_s(&local_70,0x53,0,0x53);
  return 0;
}



int pubRsaDecryptSignedElementExt
              (undefined4 param_1,int param_2,undefined4 param_3,short param_4,void *param_5,
              ushort param_6,undefined4 param_7,undefined4 param_8)

{
  char cVar1;
  char *pcVar2;
  char *__ptr;
  char *pcVar3;
  int iVar4;
  size_t __size;
  char *__n;
  undefined auStack_38 [2];
  undefined auStack_36 [2];
  short local_34 [2];
  char *local_30;
  int local_2c;
  
  __n = (char *)(uint)param_6;
  __size = 0x33;
  if ((((__n == (char *)0x20) || (__size = 0x23, __n == (char *)0x14)) ||
      (__size = 0x43, __n == (char *)0x30)) || (__size = 0x53, __n == (char *)0x40)) {
    __ptr = (char *)malloc(__size);
    if (__ptr == (char *)0x0) {
      return -8;
    }
    iVar4 = -6;
    local_30 = __ptr;
    if (*(short *)(param_2 + 100) == param_4) {
      local_34[0] = param_4;
      iVar4 = psRsaCrypt(param_1,param_2,param_3,param_4,param_3,local_34,1,param_8);
      if (iVar4 < 0) {
LAB_00480bf4:
        if (-1 < iVar4) {
LAB_00480ae0:
          pcVar2 = local_30;
          iVar4 = getAsnSequence(&local_30,__size,auStack_38);
          if ((-1 < iVar4) &&
             (iVar4 = getAsnAlgorithmIdentifier
                                (&local_30,(uint)(pcVar2 + (__size - (int)local_30)) & 0xffff,
                                 &local_2c,auStack_36), -1 < iVar4)) {
            if (local_2c == 0x19e) {
              if (__n != (char *)0x20) {
                _psTraceStr("psAssert %s","pubkey/rsa.c");
                _psTraceInt(&DAT_0049016c,0x8e);
                pcVar3 = "outlen == SHA256_HASH_SIZE";
                goto LAB_00480ba8;
              }
            }
            else if (local_2c == 0x58) {
              if (__n != (char *)0x14) {
                _psTraceStr("psAssert %s","pubkey/rsa.c");
                _psTraceInt(&DAT_0049016c,0x92);
                pcVar3 = "outlen == SHA1_HASH_SIZE";
                goto LAB_00480ba8;
              }
            }
            else if (local_2c == 0x19f) {
              if (__n != (char *)0x30) {
                _psTraceStr("psAssert %s","pubkey/rsa.c");
                _psTraceInt(&DAT_0049016c,0x96);
                pcVar3 = "outlen == SHA384_HASH_SIZE";
                goto LAB_00480ba8;
              }
            }
            else if (local_2c == 0x289) {
              if (__n != (char *)0x10) {
                _psTraceStr("psAssert %s","pubkey/rsa.c");
                _psTraceInt(&DAT_0049016c,0xa1);
                pcVar3 = "outlen == MD5_HASH_SIZE";
                goto LAB_00480ba8;
              }
            }
            else if (__n != (char *)0x40) {
              _psTraceStr("psAssert %s","pubkey/rsa.c");
              _psTraceInt(&DAT_0049016c,0xa6);
              pcVar3 = "outlen == SHA512_HASH_SIZE";
LAB_00480ba8:
              _psError(pcVar3);
            }
            if (((0 < (int)(pcVar2 + (__size - (int)local_30))) &&
                (cVar1 = *local_30, local_30 = local_30 + 1, cVar1 == '\x04')) &&
               ((iVar4 = getAsnLength(&local_30,(uint)(pcVar2 + (__size - (int)local_30)) & 0xffff,
                                      auStack_38), -1 < iVar4 &&
                (pcVar2 + (__size - (int)local_30) == __n)))) {
              memcpy(param_5,local_30,(size_t)__n);
              free(__ptr);
              return 0;
            }
          }
          free(__ptr);
          goto LAB_00480bec;
        }
      }
      else {
        iVar4 = -1;
        if (local_34[0] == param_4) {
          iVar4 = pkcs1Unpad(param_3,param_4,__ptr,__size,1);
          if (iVar4 < 0) goto LAB_00480bf4;
          goto LAB_00480ae0;
        }
      }
    }
    free(__ptr);
  }
  else {
LAB_00480bec:
    iVar4 = -1;
  }
  return iVar4;
}



// WARNING: Switch with 1 destination removed at 0x00480e7c

int pubRsaDecryptSignedElement
              (undefined4 param_1,int param_2,undefined4 param_3,short param_4,undefined4 param_5,
              uint param_6,undefined4 param_7)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  int iVar4;
  int iVar5;
  char *pcVar6;
  code *pcVar7;
  int iVar8;
  undefined auStack_38 [2];
  undefined auStack_36 [2];
  short asStack_34 [2];
  char *pcStack_30;
  int iStack_2c;
  undefined *local_28;
  
  local_28 = &_gp;
  pcVar6 = (char *)(param_6 & 0xffff);
  iVar4 = psHashLenToSigAlg(pcVar6,1);
  iVar8 = *(int *)(local_28 + -0x7a18);
  if (iVar4 < 0) {
    return iVar4;
  }
  iVar4 = 0x33;
  if ((((pcVar6 == (char *)0x20) || (iVar4 = 0x23, pcVar6 == (char *)0x14)) ||
      (iVar4 = 0x43, pcVar6 == (char *)0x30)) || (iVar4 = 0x53, pcVar6 == (char *)0x40)) {
    pcVar3 = (char *)(**(code **)(iVar8 + 0x58014))(iVar4);
    if (pcVar3 == (char *)0x0) {
      return -8;
    }
    iVar5 = -6;
    pcStack_30 = pcVar3;
    if (*(short *)(param_2 + 100) == param_4) {
      asStack_34[0] = param_4;
      iVar5 = (**(code **)(iVar8 + 0x57f04))
                        (param_1,param_2,param_3,param_4,param_3,asStack_34,1,param_7);
      if (iVar5 < 0) {
LAB_00480bf4:
        if (-1 < iVar5) {
LAB_00480ae0:
          pcVar2 = pcStack_30;
          iVar5 = (**(code **)(iVar8 + 0x57858))(&pcStack_30,iVar4,auStack_38);
          if ((-1 < iVar5) &&
             (iVar5 = (**(code **)(iVar8 + 0x57f18))
                                (&pcStack_30,(uint)(pcVar2 + (iVar4 - (int)pcStack_30)) & 0xffff,
                                 &iStack_2c,auStack_36), -1 < iVar5)) {
            if (iStack_2c == 0x19e) {
              if (pcVar6 != (char *)0x20) {
                (**(code **)(iVar8 + 0x58234))
                          (*(int *)(iVar8 + 0x570e8) + 0x160,*(int *)(iVar8 + 0x570e8) + 0x27e8);
                (**(code **)(iVar8 + 0x57d58))(*(int *)(iVar8 + 0x570e8) + 0x16c,0x8e);
                pcVar7 = *(code **)(iVar8 + 0x57c20);
                iVar5 = *(int *)(iVar8 + 0x570e8) + 0x2814;
                goto LAB_00480ba8;
              }
            }
            else if (iStack_2c == 0x58) {
              if (pcVar6 != (char *)0x14) {
                (**(code **)(iVar8 + 0x58234))
                          (*(int *)(iVar8 + 0x570e8) + 0x160,*(int *)(iVar8 + 0x570e8) + 0x27e8);
                (**(code **)(iVar8 + 0x57d58))(*(int *)(iVar8 + 0x570e8) + 0x16c,0x92);
                pcVar7 = *(code **)(iVar8 + 0x57c20);
                iVar5 = *(int *)(iVar8 + 0x570e8) + 0x2830;
                goto LAB_00480ba8;
              }
            }
            else if (iStack_2c == 0x19f) {
              if (pcVar6 != (char *)0x30) {
                (**(code **)(iVar8 + 0x58234))
                          (*(int *)(iVar8 + 0x570e8) + 0x160,*(int *)(iVar8 + 0x570e8) + 0x27e8);
                (**(code **)(iVar8 + 0x57d58))(*(int *)(iVar8 + 0x570e8) + 0x16c,0x96);
                pcVar7 = *(code **)(iVar8 + 0x57c20);
                iVar5 = *(int *)(iVar8 + 0x570e8) + 0x284c;
                goto LAB_00480ba8;
              }
            }
            else if (iStack_2c == 0x289) {
              if (pcVar6 != (char *)0x10) {
                (**(code **)(iVar8 + 0x58234))
                          (*(int *)(iVar8 + 0x570e8) + 0x160,*(int *)(iVar8 + 0x570e8) + 0x27e8);
                (**(code **)(iVar8 + 0x57d58))(*(int *)(iVar8 + 0x570e8) + 0x16c,0xa1);
                pcVar7 = *(code **)(iVar8 + 0x57c20);
                iVar5 = *(int *)(iVar8 + 0x570e8) + 0x2868;
                goto LAB_00480ba8;
              }
            }
            else if (pcVar6 != (char *)0x40) {
              (**(code **)(iVar8 + 0x58234))
                        (*(int *)(iVar8 + 0x570e8) + 0x160,*(int *)(iVar8 + 0x570e8) + 0x27e8);
              (**(code **)(iVar8 + 0x57d58))(*(int *)(iVar8 + 0x570e8) + 0x16c,0xa6);
              pcVar7 = *(code **)(iVar8 + 0x57c20);
              iVar5 = *(int *)(iVar8 + 0x570e8) + 0x27f8;
LAB_00480ba8:
              (*pcVar7)(iVar5);
            }
            if (((0 < (int)(pcVar2 + (iVar4 - (int)pcStack_30))) &&
                (cVar1 = *pcStack_30, pcStack_30 = pcStack_30 + 1, cVar1 == '\x04')) &&
               ((iVar5 = (**(code **)(iVar8 + 0x57ea0))
                                   (&pcStack_30,(uint)(pcVar2 + (iVar4 - (int)pcStack_30)) & 0xffff,
                                    auStack_38), -1 < iVar5 &&
                (pcVar2 + (iVar4 - (int)pcStack_30) == pcVar6)))) {
              (**(code **)(iVar8 + 0x580a8))(param_5,pcStack_30,pcVar6);
              (**(code **)(iVar8 + 0x57544))(pcVar3);
              return 0;
            }
          }
          (**(code **)(iVar8 + 0x57544))(pcVar3);
          goto LAB_00480bec;
        }
      }
      else {
        iVar5 = -1;
        if (asStack_34[0] == param_4) {
          iVar5 = (**(code **)(iVar8 + 0x577c8))(param_3,param_4,pcVar3,iVar4,1);
          if (iVar5 < 0) goto LAB_00480bf4;
          goto LAB_00480ae0;
        }
      }
    }
    (**(code **)(iVar8 + 0x57544))(pcVar3);
  }
  else {
LAB_00480bec:
    iVar5 = -1;
  }
  return iVar5;
}



int psRsaDecryptPriv(undefined4 param_1,int param_2,void *param_3,short param_4,undefined4 param_5,
                    undefined2 param_6,undefined4 param_7)

{
  int iVar1;
  short *psVar2;
  undefined4 uVar3;
  short local_20 [4];
  
  iVar1 = -6;
  if (*(short *)(param_2 + 100) == param_4) {
    psVar2 = local_20;
    uVar3 = 2;
    local_20[0] = param_4;
    iVar1 = psRsaCrypt();
    if (-1 < iVar1) {
      iVar1 = -1;
      if (local_20[0] == param_4) {
        iVar1 = pkcs1Unpad(param_3,param_4,param_5,param_6,2,psVar2,uVar3,param_7);
        memset(param_3,0,(size_t)param_4);
      }
    }
  }
  return iVar1;
}



void psAesEncryptBlock(uint *param_1,byte *param_2,undefined *param_3)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint *puVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  int local_3c;
  
  uVar9 = ((uint)*param_2 << 0x18 | (uint)param_2[1] << 0x10 | (uint)param_2[2] << 8 |
          (uint)param_2[3]) ^ *param_1;
  uVar10 = ((uint)param_2[4] << 0x18 | (uint)param_2[5] << 0x10 | (uint)param_2[6] << 8 |
           (uint)param_2[7]) ^ param_1[1];
  uVar8 = ((uint)param_2[8] << 0x18 | (uint)param_2[9] << 0x10 | (uint)param_2[10] << 8 |
          (uint)param_2[0xb]) ^ param_1[2];
  uVar4 = ((uint)param_2[0xc] << 0x18 | (uint)param_2[0xd] << 0x10 | (uint)param_2[0xe] << 8 |
          (uint)param_2[0xf]) ^ param_1[3];
  local_3c = 0;
  puVar7 = param_1;
  while( true ) {
    uVar11 = uVar9 >> 0xe;
    uVar3 = uVar8 >> 0xe;
    uVar6 = uVar10 >> 6;
    uVar5 = uVar8 >> 6;
    uVar12 = uVar8 & 0xff;
    uVar2 = uVar9 & 0xff;
    uVar8 = *(uint *)(&DAT_00493490 + (uVar8 >> 0x18) * 4) ^
            (*(uint *)(&DAT_00493490 + (uVar4 >> 0xe & 0x3fc)) << 0x18 |
            *(uint *)(&DAT_00493490 + (uVar4 >> 0xe & 0x3fc)) >> 8) ^
            (*(uint *)(&DAT_00493490 + (uVar9 >> 6 & 0x3fc)) << 0x10 |
            *(uint *)(&DAT_00493490 + (uVar9 >> 6 & 0x3fc)) >> 0x10) ^
            (*(uint *)(&DAT_00493490 + (uVar10 & 0xff) * 4) << 8 |
            *(uint *)(&DAT_00493490 + (uVar10 & 0xff) * 4) >> 0x18) ^ puVar7[6];
    uVar9 = *(uint *)(&DAT_00493490 + (uVar9 >> 0x18) * 4) ^
            (*(uint *)(&DAT_00493490 + (uVar10 >> 0xe & 0x3fc)) << 0x18 |
            *(uint *)(&DAT_00493490 + (uVar10 >> 0xe & 0x3fc)) >> 8) ^
            (*(uint *)(&DAT_00493490 + (uVar5 & 0x3fc)) << 0x10 |
            *(uint *)(&DAT_00493490 + (uVar5 & 0x3fc)) >> 0x10) ^
            (*(uint *)(&DAT_00493490 + (uVar4 & 0xff) * 4) << 8 |
            *(uint *)(&DAT_00493490 + (uVar4 & 0xff) * 4) >> 0x18) ^ puVar7[4];
    uVar10 = *(uint *)(&DAT_00493490 + (uVar10 >> 0x18) * 4) ^
             (*(uint *)(&DAT_00493490 + (uVar3 & 0x3fc)) << 0x18 |
             *(uint *)(&DAT_00493490 + (uVar3 & 0x3fc)) >> 8) ^
             (*(uint *)(&DAT_00493490 + (uVar4 >> 6 & 0x3fc)) << 0x10 |
             *(uint *)(&DAT_00493490 + (uVar4 >> 6 & 0x3fc)) >> 0x10) ^
             (*(uint *)(&DAT_00493490 + uVar2 * 4) << 8 |
             *(uint *)(&DAT_00493490 + uVar2 * 4) >> 0x18) ^ puVar7[5];
    uVar4 = *(uint *)(&DAT_00493490 + (uVar4 >> 0x18) * 4) ^
            (*(uint *)(&DAT_00493490 + (uVar11 & 0x3fc)) << 0x18 |
            *(uint *)(&DAT_00493490 + (uVar11 & 0x3fc)) >> 8) ^
            (*(uint *)(&DAT_00493490 + (uVar6 & 0x3fc)) << 0x10 |
            *(uint *)(&DAT_00493490 + (uVar6 & 0x3fc)) >> 0x10) ^
            (*(uint *)(&DAT_00493490 + uVar12 * 4) << 8 |
            *(uint *)(&DAT_00493490 + uVar12 * 4) >> 0x18) ^ puVar7[7];
    if (*(ushort *)(param_1 + 0x40) - 2 == local_3c) break;
    local_3c = local_3c + 1;
    puVar7 = puVar7 + 4;
  }
  uVar2 = *(uint *)(&DAT_00493090 + (uVar10 >> 0x18) * 4);
  uVar3 = *(uint *)(&DAT_00493090 + (uVar8 >> 0xe & 0x3fc));
  uVar6 = *(uint *)(&DAT_00493090 + (uVar9 >> 0x18) * 4) & 0xff000000 ^
          *(uint *)(&DAT_00493090 + (uVar10 >> 0xe & 0x3fc)) & 0xff0000 ^
          *(uint *)(&DAT_00493090 + (uVar8 >> 6 & 0x3fc)) & 0xff00 ^
          (uint)(byte)(&DAT_00493090)[(uVar4 & 0xff) * 4] ^ puVar7[8];
  uVar5 = *(uint *)(&DAT_00493090 + (uVar4 >> 6 & 0x3fc));
  *param_3 = (char)(uVar6 >> 0x18);
  param_3[1] = (char)(uVar6 >> 0x10);
  param_3[2] = (char)(uVar6 >> 8);
  param_3[3] = (char)uVar6;
  uVar11 = *(uint *)(&DAT_00493090 + (uVar8 >> 0x18) * 4);
  uVar6 = *(uint *)(&DAT_00493090 + (uVar4 >> 0xe & 0x3fc));
  uVar2 = uVar2 & 0xff000000 ^ uVar3 & 0xff0000 ^ uVar5 & 0xff00 ^
          (uint)(byte)(&DAT_00493090)[(uVar9 & 0xff) * 4] ^ puVar7[9];
  uVar3 = *(uint *)(&DAT_00493090 + (uVar9 >> 6 & 0x3fc));
  param_3[4] = (char)(uVar2 >> 0x18);
  param_3[5] = (char)(uVar2 >> 0x10);
  param_3[6] = (char)(uVar2 >> 8);
  param_3[7] = (char)uVar2;
  uVar2 = *(uint *)(&DAT_00493090 + (uVar4 >> 0x18) * 4);
  uVar9 = *(uint *)(&DAT_00493090 + (uVar9 >> 0xe & 0x3fc));
  uVar4 = uVar11 & 0xff000000 ^ uVar6 & 0xff0000 ^ uVar3 & 0xff00 ^
          (uint)(byte)(&DAT_00493090)[(uVar10 & 0xff) * 4] ^ puVar7[10];
  uVar10 = *(uint *)(&DAT_00493090 + (uVar10 >> 6 & 0x3fc));
  param_3[9] = (char)(uVar4 >> 0x10);
  param_3[10] = (char)(uVar4 >> 8);
  bVar1 = (&DAT_00493090)[(uVar8 & 0xff) * 4];
  param_3[8] = (char)(uVar4 >> 0x18);
  param_3[0xb] = (char)uVar4;
  uVar4 = uVar2 & 0xff000000 ^ uVar9 & 0xff0000 ^ uVar10 & 0xff00 ^ (uint)bVar1 ^ puVar7[0xb];
  param_3[0xc] = (char)(uVar4 >> 0x18);
  param_3[0xd] = (char)(uVar4 >> 0x10);
  param_3[0xf] = (char)uVar4;
  param_3[0xe] = (char)(uVar4 >> 8);
  psBurnStack(0x2c);
  return;
}



void psAesDecryptBlock(uint *param_1,byte *param_2,undefined *param_3)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint *puVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  int local_3c;
  
  uVar5 = ((uint)*param_2 << 0x18 | (uint)param_2[1] << 0x10 | (uint)param_2[2] << 8 |
          (uint)param_2[3]) ^ *param_1;
  uVar4 = ((uint)param_2[4] << 0x18 | (uint)param_2[5] << 0x10 | (uint)param_2[6] << 8 |
          (uint)param_2[7]) ^ param_1[1];
  uVar10 = ((uint)param_2[8] << 0x18 | (uint)param_2[9] << 0x10 | (uint)param_2[10] << 8 |
           (uint)param_2[0xb]) ^ param_1[2];
  uVar11 = ((uint)param_2[0xc] << 0x18 | (uint)param_2[0xd] << 0x10 | (uint)param_2[0xe] << 8 |
           (uint)param_2[0xf]) ^ param_1[3];
  local_3c = 0;
  puVar9 = param_1;
  while( true ) {
    uVar6 = uVar10 >> 0xe;
    uVar2 = uVar5 >> 0xe;
    uVar8 = uVar4 >> 6;
    uVar12 = uVar5 & 0xff;
    uVar7 = uVar10 >> 6;
    uVar3 = uVar10 & 0xff;
    uVar10 = *(uint *)(&DAT_00492c90 + (uVar10 >> 0x18) * 4) ^
             (*(uint *)(&DAT_00492c90 + (uVar4 >> 0xe & 0x3fc)) << 0x18 |
             *(uint *)(&DAT_00492c90 + (uVar4 >> 0xe & 0x3fc)) >> 8) ^
             (*(uint *)(&DAT_00492c90 + (uVar5 >> 6 & 0x3fc)) << 0x10 |
             *(uint *)(&DAT_00492c90 + (uVar5 >> 6 & 0x3fc)) >> 0x10) ^
             (*(uint *)(&DAT_00492c90 + (uVar11 & 0xff) * 4) << 8 |
             *(uint *)(&DAT_00492c90 + (uVar11 & 0xff) * 4) >> 0x18) ^ puVar9[6];
    uVar5 = *(uint *)(&DAT_00492c90 + (uVar5 >> 0x18) * 4) ^
            (*(uint *)(&DAT_00492c90 + (uVar11 >> 0xe & 0x3fc)) << 0x18 |
            *(uint *)(&DAT_00492c90 + (uVar11 >> 0xe & 0x3fc)) >> 8) ^
            (*(uint *)(&DAT_00492c90 + (uVar7 & 0x3fc)) << 0x10 |
            *(uint *)(&DAT_00492c90 + (uVar7 & 0x3fc)) >> 0x10) ^
            (*(uint *)(&DAT_00492c90 + (uVar4 & 0xff) * 4) << 8 |
            *(uint *)(&DAT_00492c90 + (uVar4 & 0xff) * 4) >> 0x18) ^ puVar9[4];
    uVar4 = *(uint *)(&DAT_00492c90 + (uVar4 >> 0x18) * 4) ^
            (*(uint *)(&DAT_00492c90 + (uVar2 & 0x3fc)) << 0x18 |
            *(uint *)(&DAT_00492c90 + (uVar2 & 0x3fc)) >> 8) ^
            (*(uint *)(&DAT_00492c90 + (uVar11 >> 6 & 0x3fc)) << 0x10 |
            *(uint *)(&DAT_00492c90 + (uVar11 >> 6 & 0x3fc)) >> 0x10) ^
            (*(uint *)(&DAT_00492c90 + uVar3 * 4) << 8 |
            *(uint *)(&DAT_00492c90 + uVar3 * 4) >> 0x18) ^ puVar9[5];
    uVar11 = *(uint *)(&DAT_00492c90 + (uVar11 >> 0x18) * 4) ^
             (*(uint *)(&DAT_00492c90 + (uVar6 & 0x3fc)) << 0x18 |
             *(uint *)(&DAT_00492c90 + (uVar6 & 0x3fc)) >> 8) ^
             (*(uint *)(&DAT_00492c90 + (uVar8 & 0x3fc)) << 0x10 |
             *(uint *)(&DAT_00492c90 + (uVar8 & 0x3fc)) >> 0x10) ^
             (*(uint *)(&DAT_00492c90 + uVar12 * 4) << 8 |
             *(uint *)(&DAT_00492c90 + uVar12 * 4) >> 0x18) ^ puVar9[7];
    if (*(ushort *)(param_1 + 0x40) - 2 == local_3c) break;
    local_3c = local_3c + 1;
    puVar9 = puVar9 + 4;
  }
  uVar7 = *(uint *)(&DAT_00492880 + (uVar5 >> 0xe & 0x3fc));
  uVar2 = *(uint *)(&DAT_00492880 + (uVar4 >> 0x18) * 4);
  uVar3 = *(uint *)(&DAT_00492880 + (uVar5 >> 0x18) * 4) & 0xff000000 ^
          *(uint *)(&DAT_00492880 + (uVar11 >> 0xe & 0x3fc)) & 0xff0000 ^
          *(uint *)(&DAT_00492880 + (uVar10 >> 6 & 0x3fc)) & 0xff00 ^
          (uint)(byte)(&DAT_00492880)[(uVar4 & 0xff) * 4] ^ puVar9[8];
  uVar6 = *(uint *)(&DAT_00492880 + (uVar11 >> 6 & 0x3fc));
  *param_3 = (char)(uVar3 >> 0x18);
  param_3[1] = (char)(uVar3 >> 0x10);
  param_3[2] = (char)(uVar3 >> 8);
  param_3[3] = (char)uVar3;
  uVar8 = *(uint *)(&DAT_00492880 + (uVar10 >> 0x18) * 4);
  uVar12 = *(uint *)(&DAT_00492880 + (uVar4 >> 0xe & 0x3fc));
  uVar2 = uVar2 & 0xff000000 ^ uVar7 & 0xff0000 ^ uVar6 & 0xff00 ^
          (uint)(byte)(&DAT_00492880)[(uVar10 & 0xff) * 4] ^ puVar9[9];
  uVar3 = *(uint *)(&DAT_00492880 + (uVar5 >> 6 & 0x3fc));
  param_3[4] = (char)(uVar2 >> 0x18);
  param_3[5] = (char)(uVar2 >> 0x10);
  param_3[6] = (char)(uVar2 >> 8);
  param_3[7] = (char)uVar2;
  uVar2 = *(uint *)(&DAT_00492880 + (uVar11 >> 0x18) * 4);
  uVar10 = *(uint *)(&DAT_00492880 + (uVar10 >> 0xe & 0x3fc));
  uVar11 = uVar8 & 0xff000000 ^ uVar12 & 0xff0000 ^ uVar3 & 0xff00 ^
           (uint)(byte)(&DAT_00492880)[(uVar11 & 0xff) * 4] ^ puVar9[10];
  uVar4 = *(uint *)(&DAT_00492880 + (uVar4 >> 6 & 0x3fc));
  param_3[9] = (char)(uVar11 >> 0x10);
  param_3[10] = (char)(uVar11 >> 8);
  bVar1 = (&DAT_00492880)[(uVar5 & 0xff) * 4];
  param_3[8] = (char)(uVar11 >> 0x18);
  param_3[0xb] = (char)uVar11;
  uVar4 = uVar2 & 0xff000000 ^ uVar10 & 0xff0000 ^ uVar4 & 0xff00 ^ (uint)bVar1 ^ puVar9[0xb];
  param_3[0xc] = (char)(uVar4 >> 0x18);
  param_3[0xd] = (char)(uVar4 >> 0x10);
  param_3[0xf] = (char)uVar4;
  param_3[0xe] = (char)(uVar4 >> 8);
  psBurnStack(0x2c);
  return;
}



undefined4 psAesInitBlockKey(uint *param_1,byte *param_2,byte param_3,int param_4)

{
  uint *puVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  uint uVar5;
  uint *puVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  uint local_118 [40];
  uint local_78 [8];
  uint auStack_58 [8];
  uint auStack_38 [8];
  
  uVar7 = (uint)*param_2 << 0x18 | (uint)param_2[1] << 0x10 | (uint)param_2[2] << 8 |
          (uint)param_2[3];
  *param_1 = uVar7;
  uVar5 = (uint)param_2[4] << 0x18 | (uint)param_2[5] << 0x10 | (uint)param_2[6] << 8 |
          (uint)param_2[7];
  param_1[1] = uVar5;
  uVar4 = (uint)param_2[8] << 0x18 | (uint)param_2[9] << 0x10 | (uint)param_2[10] << 8 |
          (uint)param_2[0xb];
  param_1[2] = uVar4;
  uVar2 = (uint)param_2[0xc] << 0x18 | (uint)param_2[0xd] << 0x10 | (uint)param_2[0xe] << 8 |
          (uint)param_2[0xf];
  param_1[3] = uVar2;
  iVar8 = 0;
  if (param_3 == 0x18) {
    uVar9 = 0xc;
    *(undefined2 *)(param_1 + 0x40) = 0xc;
    param_1[4] = (uint)param_2[0x10] << 0x18 | (uint)param_2[0x11] << 0x10 |
                 (uint)param_2[0x12] << 8 | (uint)param_2[0x13];
    param_1[5] = (uint)param_2[0x14] << 0x18 | (uint)param_2[0x15] << 0x10 |
                 (uint)param_2[0x16] << 8 | (uint)param_2[0x17];
    puVar3 = &DAT_00493890;
    puVar1 = param_1;
    while( true ) {
      uVar5 = puVar1[5];
      uVar7 = *puVar1 ^ *(uint *)(&DAT_00493090 + (uint)*(byte *)((int)puVar1 + 0x16) * 4) &
                        0xff000000 ^
                        *(uint *)(&DAT_00493090 + (uint)*(byte *)((int)puVar1 + 0x15) * 4) &
                        0xff0000 ^ *(uint *)(&DAT_00493090 + (uVar5 & 0xff) * 4) & 0xff00 ^
                        (uint)(byte)(&DAT_00493090)[(uVar5 >> 0x18) * 4] ^ *puVar3;
      uVar2 = puVar1[1] ^ uVar7;
      uVar10 = puVar1[2] ^ uVar2;
      uVar4 = puVar1[3] ^ uVar10;
      iVar8 = iVar8 + 1;
      puVar1[6] = uVar7;
      puVar1[7] = uVar2;
      puVar1[8] = uVar10;
      puVar1[9] = uVar4;
      puVar3 = puVar3 + 1;
      if (iVar8 == 8) break;
      uVar4 = puVar1[4] ^ uVar4;
      puVar1[0xb] = uVar5 ^ uVar4;
      puVar1[10] = uVar4;
      puVar1 = puVar1 + 6;
    }
  }
  else if (param_3 < 0x19) {
    uVar9 = 10;
    if (param_3 != 0x10) {
      return 0xffffffeb;
    }
    puVar3 = &DAT_00493890;
    *(undefined2 *)(param_1 + 0x40) = 10;
    puVar1 = param_1;
    while( true ) {
      uVar7 = uVar7 ^ *(uint *)(&DAT_00493090 + (uVar2 >> 0xe & 0x3fc)) & 0xff000000 ^
                      *(uint *)(&DAT_00493090 + (uVar2 >> 6 & 0x3fc)) & 0xff0000 ^
                      *(uint *)(&DAT_00493090 + (uVar2 & 0xff) * 4) & 0xff00 ^
                      (uint)(byte)(&DAT_00493090)[(uVar2 >> 0x18) * 4] ^ *puVar3;
      uVar4 = uVar4 ^ uVar5 ^ uVar7;
      iVar8 = iVar8 + 1;
      puVar1[7] = uVar2 ^ uVar4;
      puVar1[4] = uVar7;
      puVar1[5] = uVar5 ^ uVar7;
      puVar1[6] = uVar4;
      puVar3 = puVar3 + 1;
      if (iVar8 == 10) break;
      uVar5 = puVar1[5];
      uVar4 = puVar1[6];
      uVar2 = puVar1[7];
      puVar1 = puVar1 + 4;
    }
  }
  else {
    if (param_3 != 0x20) {
      return 0xffffffeb;
    }
    uVar9 = 0xe;
    *(undefined2 *)(param_1 + 0x40) = 0xe;
    param_1[4] = (uint)param_2[0x10] << 0x18 | (uint)param_2[0x11] << 0x10 |
                 (uint)param_2[0x12] << 8 | (uint)param_2[0x13];
    param_1[5] = (uint)param_2[0x14] << 0x18 | (uint)param_2[0x15] << 0x10 |
                 (uint)param_2[0x16] << 8 | (uint)param_2[0x17];
    param_1[6] = (uint)param_2[0x18] << 0x18 | (uint)param_2[0x19] << 0x10 |
                 (uint)param_2[0x1a] << 8 | (uint)param_2[0x1b];
    puVar3 = &DAT_00493890;
    param_1[7] = (uint)param_2[0x1c] << 0x18 | (uint)param_2[0x1d] << 0x10 |
                 (uint)param_2[0x1e] << 8 | (uint)param_2[0x1f];
    puVar1 = param_1;
    while( true ) {
      uVar5 = puVar1[7];
      uVar2 = *puVar1 ^ *(uint *)(&DAT_00493090 + (uint)*(byte *)((int)puVar1 + 0x1e) * 4) &
                        0xff000000 ^
                        *(uint *)(&DAT_00493090 + (uint)*(byte *)((int)puVar1 + 0x1d) * 4) &
                        0xff0000 ^ *(uint *)(&DAT_00493090 + (uVar5 & 0xff) * 4) & 0xff00 ^
                        (uint)(byte)(&DAT_00493090)[(uVar5 >> 0x18) * 4] ^ *puVar3;
      uVar4 = puVar1[1] ^ uVar2;
      uVar10 = puVar1[2] ^ uVar4;
      uVar7 = puVar1[3] ^ uVar10;
      iVar8 = iVar8 + 1;
      puVar1[8] = uVar2;
      puVar1[9] = uVar4;
      puVar1[10] = uVar10;
      puVar1[0xb] = uVar7;
      puVar3 = puVar3 + 1;
      if (iVar8 == 7) break;
      uVar7 = puVar1[4] ^
              *(uint *)(&DAT_00493090 + (uVar7 >> 0x18) * 4) & 0xff000000 ^
              *(uint *)(&DAT_00493090 + ((uVar7 >> 8 & 0xff00) >> 6)) & 0xff0000 ^
              *(uint *)(&DAT_00493090 + (uVar7 >> 8 & 0xff) * 4) & 0xff00 ^
              (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4];
      uVar4 = puVar1[5] ^ uVar7;
      uVar2 = puVar1[6] ^ uVar4;
      puVar1[0xf] = uVar5 ^ uVar2;
      puVar1[0xc] = uVar7;
      puVar1[0xd] = uVar4;
      puVar1[0xe] = uVar2;
      puVar1 = puVar1 + 8;
    }
  }
  if (param_4 != 1) {
    if (param_4 != 2) {
      return 0xfffffffa;
    }
    *(short *)((int)param_1 + 0x102) = (short)param_4;
    puVar3 = local_118;
    puVar1 = param_1;
    do {
      uVar5 = *puVar1;
      uVar2 = puVar1[1];
      uVar7 = puVar1[2];
      uVar4 = puVar1[3];
      puVar1 = puVar1 + 4;
      *puVar3 = uVar5;
      puVar3[1] = uVar2;
      puVar3[2] = uVar7;
      puVar3[3] = uVar4;
      puVar3 = puVar3 + 4;
    } while (puVar1 != param_1 + 0x40);
    if (uVar9 == 0xc) {
      puVar1 = auStack_58;
    }
    else if (uVar9 < 0xd) {
      if (uVar9 != 10) {
        return 0;
      }
      puVar1 = local_78;
    }
    else {
      if (uVar9 != 0xe) {
        return 0;
      }
      puVar1 = auStack_38;
    }
    *param_1 = *puVar1;
    param_1[1] = puVar1[1];
    param_1[2] = puVar1[2];
    param_1[3] = puVar1[3];
    if (1 < uVar9) {
      iVar8 = uVar9 - 1;
      puVar3 = puVar1;
      puVar6 = param_1;
      do {
        puVar1 = puVar3 + -4;
        uVar7 = *puVar1;
        param_1 = puVar6 + 4;
        *param_1 = *(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[(uVar7 >> 0x18) * 4] * 4) ^
                   (*(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[uVar7 >> 0xe & 0x3fc] * 4)
                    << 0x18 |
                   *(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[uVar7 >> 0xe & 0x3fc] * 4)
                   >> 8) ^ (*(uint *)(&DAT_00492c90 +
                                     (uint)(byte)(&DAT_00493090)[uVar7 >> 6 & 0x3fc] * 4) << 0x10 |
                           *(uint *)(&DAT_00492c90 +
                                    (uint)(byte)(&DAT_00493090)[uVar7 >> 6 & 0x3fc] * 4) >> 0x10) ^
                   (*(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4] * 4)
                    << 8 | *(uint *)(&DAT_00492c90 +
                                    (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4] * 4) >> 0x18);
        uVar7 = puVar3[-3];
        iVar8 = iVar8 + -1;
        puVar6[5] = *(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[(uVar7 >> 0x18) * 4] * 4)
                    ^ (*(uint *)(&DAT_00492c90 +
                                (uint)(byte)(&DAT_00493090)[uVar7 >> 0xe & 0x3fc] * 4) << 0x18 |
                      *(uint *)(&DAT_00492c90 +
                               (uint)(byte)(&DAT_00493090)[uVar7 >> 0xe & 0x3fc] * 4) >> 8) ^
                    (*(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[uVar7 >> 6 & 0x3fc] * 4)
                     << 0x10 |
                    *(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[uVar7 >> 6 & 0x3fc] * 4)
                    >> 0x10) ^
                    (*(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4] * 4)
                     << 8 | *(uint *)(&DAT_00492c90 +
                                     (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4] * 4) >> 0x18);
        uVar7 = puVar3[-2];
        puVar6[6] = *(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[(uVar7 >> 0x18) * 4] * 4)
                    ^ (*(uint *)(&DAT_00492c90 +
                                (uint)(byte)(&DAT_00493090)[uVar7 >> 0xe & 0x3fc] * 4) << 0x18 |
                      *(uint *)(&DAT_00492c90 +
                               (uint)(byte)(&DAT_00493090)[uVar7 >> 0xe & 0x3fc] * 4) >> 8) ^
                    (*(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[uVar7 >> 6 & 0x3fc] * 4)
                     << 0x10 |
                    *(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[uVar7 >> 6 & 0x3fc] * 4)
                    >> 0x10) ^
                    (*(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4] * 4)
                     << 8 | *(uint *)(&DAT_00492c90 +
                                     (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4] * 4) >> 0x18);
        uVar7 = puVar3[-1];
        puVar6[7] = *(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[(uVar7 >> 0x18) * 4] * 4)
                    ^ (*(uint *)(&DAT_00492c90 +
                                (uint)(byte)(&DAT_00493090)[uVar7 >> 0xe & 0x3fc] * 4) << 0x18 |
                      *(uint *)(&DAT_00492c90 +
                               (uint)(byte)(&DAT_00493090)[uVar7 >> 0xe & 0x3fc] * 4) >> 8) ^
                    (*(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[uVar7 >> 6 & 0x3fc] * 4)
                     << 0x10 |
                    *(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[uVar7 >> 6 & 0x3fc] * 4)
                    >> 0x10) ^
                    (*(uint *)(&DAT_00492c90 + (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4] * 4)
                     << 8 | *(uint *)(&DAT_00492c90 +
                                     (uint)(byte)(&DAT_00493090)[(uVar7 & 0xff) * 4] * 4) >> 0x18);
        puVar3 = puVar1;
        puVar6 = param_1;
      } while (iVar8 != 0);
    }
    param_1[4] = puVar1[-4];
    param_1[5] = puVar1[-3];
    param_1[6] = puVar1[-2];
    param_1[7] = puVar1[-1];
    memset_s(local_118,0x100,0,0x100);
    return 0;
  }
  *(short *)((int)param_1 + 0x102) = (short)param_4;
  return 0;
}



void FUN_004823c0(int param_1,int param_2,uint *param_3)

{
  byte bVar1;
  char *pcVar2;
  undefined *puVar3;
  char *pcVar4;
  undefined *puVar5;
  uint uVar6;
  uint uVar7;
  uint *puVar8;
  uint uVar9;
  uint *puVar10;
  uint *puVar11;
  int iVar12;
  uint uVar13;
  uint *puVar14;
  uint local_180 [25];
  char acStack_11c [28];
  undefined local_100 [56];
  char local_c8 [28];
  undefined local_ac [28];
  uint local_90 [32];
  
  puVar8 = local_180;
  uVar13 = 0;
  do {
    uVar9 = uVar13 + 1;
    local_100[uVar13] =
         ((uint)*(byte *)((uint)((byte)(&DAT_00494188)[uVar13] >> 3) + param_1) &
         (&DAT_00494168)[(byte)(&DAT_00494188)[uVar13] & 7]) ==
         (&DAT_00494168)[(byte)(&DAT_00494188)[uVar13] & 7];
    uVar13 = uVar9;
  } while (uVar9 < 0x38);
  uVar13 = 0;
  do {
    uVar9 = uVar13;
    if (param_2 == 1) {
      uVar9 = 0xf - uVar13;
    }
    bVar1 = (&DAT_00494158)[uVar13];
    iVar12 = uVar9 * 2 + 1;
    puVar8[iVar12] = 0;
    pcVar4 = local_c8;
    puVar8[uVar9 * 2] = 0;
    pcVar2 = acStack_11c + bVar1;
    uVar6 = 0;
    do {
      while (0x1b < bVar1 + uVar6) {
        uVar6 = uVar6 + 1;
        *pcVar4 = *pcVar2;
        pcVar2 = pcVar2 + 1;
        pcVar4 = pcVar4 + 1;
        if (0x1b < uVar6) goto LAB_004824f8;
      }
      uVar6 = uVar6 + 1;
      *pcVar4 = pcVar2[0x1c];
      pcVar2 = pcVar2 + 1;
      pcVar4 = pcVar4 + 1;
    } while (uVar6 < 0x1c);
LAB_004824f8:
    bVar1 = (&DAT_00494158)[uVar13];
    uVar6 = 0x1c;
    puVar5 = local_100 + bVar1;
    puVar3 = local_ac;
    do {
      while (0x37 < bVar1 + uVar6) {
        uVar6 = uVar6 + 1;
        *puVar3 = *puVar5;
        puVar5 = puVar5 + 1;
        puVar3 = puVar3 + 1;
        if (0x37 < uVar6) goto LAB_0048255c;
      }
      uVar6 = uVar6 + 1;
      *puVar3 = puVar5[0x1c];
      puVar5 = puVar5 + 1;
      puVar3 = puVar3 + 1;
    } while (uVar6 < 0x38);
LAB_0048255c:
    uVar6 = 0;
    puVar11 = &DAT_004940c8;
    do {
      uVar7 = uVar6 + 1;
      if (local_c8[(byte)(&DAT_00494128)[uVar6]] != '\0') {
        puVar8[uVar9 * 2] = puVar8[uVar9 * 2] | *puVar11;
      }
      if (local_c8[(byte)(&DAT_00494140)[uVar6]] != '\0') {
        puVar8[iVar12] = puVar8[iVar12] | *puVar11;
      }
      puVar11 = puVar11 + 1;
      uVar6 = uVar7;
    } while (uVar7 < 0x18);
    uVar13 = uVar13 + 1;
    puVar11 = local_90;
    if (0xf < uVar13) {
      iVar12 = 0xf;
      puVar10 = puVar11;
      do {
        iVar12 = iVar12 + -1;
        uVar13 = (*puVar8 & 0xfc0000) << 6;
        *puVar10 = uVar13;
        puVar14 = puVar10 + 1;
        uVar13 = uVar13 | (*puVar8 & 0xfc0) << 10;
        *puVar10 = uVar13;
        uVar13 = uVar13 | (puVar8[1] & 0xfc0000) >> 10;
        *puVar10 = uVar13;
        *puVar10 = uVar13 | (puVar8[1] & 0xfc0) >> 6;
        uVar13 = (*puVar8 & 0x3f000) << 0xc;
        puVar10[1] = uVar13;
        uVar13 = uVar13 | (*puVar8 & 0x3f) << 0x10;
        puVar10[1] = uVar13;
        uVar13 = uVar13 | (puVar8[1] & 0x3f000) >> 4;
        puVar10[1] = uVar13;
        puVar10 = puVar10 + 2;
        *puVar14 = uVar13 | puVar8[1] & 0x3f;
        puVar8 = puVar8 + 2;
      } while (-1 < iVar12);
      do {
        uVar13 = *puVar11;
        uVar6 = puVar11[1];
        uVar7 = puVar11[2];
        uVar9 = puVar11[3];
        puVar11 = puVar11 + 4;
        *param_3 = uVar13;
        param_3[1] = uVar6;
        param_3[2] = uVar7;
        param_3[3] = uVar9;
        param_3 = param_3 + 4;
      } while (puVar11 != (uint *)&stack0xfffffff0);
      psBurnStack(0x8c);
      psBurnStack(0x104);
      return;
    }
  } while( true );
}



void FUN_00482744(uint *param_1,uint *param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  
  uVar4 = (*param_1 >> 4 ^ param_1[1]) & 0xf0f0f0f;
  uVar2 = *param_1 ^ uVar4 << 4;
  uVar4 = param_1[1] ^ uVar4;
  uVar3 = (uVar2 >> 0x10 ^ uVar4) & 0xffff;
  uVar4 = uVar4 ^ uVar3;
  uVar2 = uVar2 ^ uVar3 << 0x10;
  uVar3 = (uVar4 >> 2 ^ uVar2) & 0x33333333;
  uVar4 = uVar4 ^ uVar3 << 2;
  uVar2 = uVar2 ^ uVar3;
  uVar3 = (uVar4 >> 8 ^ uVar2) & 0xff00ff;
  uVar4 = uVar4 ^ uVar3 << 8;
  uVar2 = uVar2 ^ uVar3;
  uVar3 = uVar4 << 1 | uVar4 >> 0x1f;
  uVar4 = (uVar2 ^ uVar3) & 0xaaaaaaaa;
  uVar2 = uVar2 ^ uVar4;
  uVar2 = uVar2 << 1 | uVar2 >> 0x1f;
  uVar3 = uVar3 ^ uVar4;
  iVar5 = 7;
  do {
    uVar1 = (uVar3 << 0x1c | uVar3 >> 4) ^ *param_2;
    uVar4 = param_2[1] ^ uVar3;
    uVar2 = uVar2 ^ *(uint *)(&DAT_00493fc8 + (uVar1 & 0x3f) * 4) ^
                    *(uint *)(&DAT_00493ec8 + (uVar1 >> 6 & 0xfc)) ^
                    *(uint *)(&DAT_00493dc8 + (uVar1 >> 0xe & 0xfc)) ^
                    *(uint *)(&DAT_00493cc8 + (uVar1 >> 0x16 & 0xfc)) ^
            *(uint *)(&DAT_00493bb8 + (uVar4 & 0x3f) * 4) ^
            *(uint *)(&DAT_00493ab8 + (uVar4 >> 6 & 0xfc)) ^
            *(uint *)(&DAT_004939b8 + (uVar4 >> 0xe & 0xfc)) ^
            *(uint *)(&DAT_004938b8 + (uVar4 >> 0x16 & 0xfc));
    uVar1 = (uVar2 << 0x1c | uVar2 >> 4) ^ param_2[2];
    uVar4 = param_2[3] ^ uVar2;
    iVar5 = iVar5 + -1;
    uVar3 = uVar3 ^ *(uint *)(&DAT_00493fc8 + (uVar1 & 0x3f) * 4) ^
                    *(uint *)(&DAT_00493ec8 + (uVar1 >> 6 & 0xfc)) ^
                    *(uint *)(&DAT_00493dc8 + (uVar1 >> 0xe & 0xfc)) ^
                    *(uint *)(&DAT_00493cc8 + (uVar1 >> 0x16 & 0xfc)) ^
            *(uint *)(&DAT_00493bb8 + (uVar4 & 0x3f) * 4) ^
            *(uint *)(&DAT_00493ab8 + (uVar4 >> 6 & 0xfc)) ^
            *(uint *)(&DAT_004939b8 + (uVar4 >> 0xe & 0xfc)) ^
            *(uint *)(&DAT_004938b8 + (uVar4 >> 0x16 & 0xfc));
    param_2 = param_2 + 4;
  } while (-1 < iVar5);
  uVar3 = uVar3 << 0x1f | uVar3 >> 1;
  uVar1 = (uVar2 ^ uVar3) & 0xaaaaaaaa;
  uVar4 = uVar2 << 0x1f | (uVar2 ^ uVar1) >> 1;
  uVar3 = uVar3 ^ uVar1;
  uVar2 = (uVar4 >> 8 ^ uVar3) & 0xff00ff;
  uVar4 = uVar4 ^ uVar2 << 8;
  uVar3 = uVar3 ^ uVar2;
  uVar2 = (uVar4 >> 2 ^ uVar3) & 0x33333333;
  uVar3 = uVar3 ^ uVar2;
  uVar4 = uVar4 ^ uVar2 << 2;
  uVar2 = (uVar3 >> 0x10 ^ uVar4) & 0xffff;
  uVar3 = uVar3 ^ uVar2 << 0x10;
  uVar4 = uVar4 ^ uVar2;
  uVar2 = (uVar3 >> 4 ^ uVar4) & 0xf0f0f0f;
  param_1[1] = uVar4 ^ uVar2;
  *param_1 = uVar3 ^ uVar2 << 4;
  psBurnStack(0x14);
  return;
}



undefined4 psDes3Init(void *param_1,int param_2,int param_3)

{
  int iVar1;
  int iVar2;
  
  memset(param_1,0,0x308);
  if ((param_3 != 0) && (param_1 != (void *)0x0)) {
    FUN_004823c0(param_3,0,param_1);
    FUN_004823c0(param_3 + 8,1,(int)param_1 + 0x80);
    FUN_004823c0(param_3 + 0x10,0,(int)param_1 + 0x100);
    FUN_004823c0(param_3,1,(int)param_1 + 0x280);
    FUN_004823c0(param_3 + 8,0,(int)param_1 + 0x200);
    FUN_004823c0(param_3 + 0x10,1,(int)param_1 + 0x180);
    iVar1 = 0;
    do {
      iVar2 = iVar1 + 1;
      *(undefined *)((int)param_1 + iVar1 + 0x300) = *(undefined *)(param_2 + iVar1);
      iVar1 = iVar2;
    } while (iVar2 < 8);
    return 0;
  }
  return 0xfffffffa;
}



void psDes3Decrypt(int param_1,byte *param_2,int param_3,uint param_4)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  byte local_48 [8];
  byte local_40 [8];
  uint local_38;
  uint local_34;
  int local_30;
  
  uVar6 = 0;
  if (param_4 != 0) {
    local_30 = param_1 + 0x180;
    do {
      local_38 = (uint)*param_2 << 0x18 | (uint)param_2[1] << 0x10 | (uint)param_2[2] << 8 |
                 (uint)param_2[3];
      local_34 = (uint)param_2[4] << 0x18 | (uint)param_2[5] << 0x10 | (uint)param_2[6] << 8 |
                 (uint)param_2[7];
      FUN_00482744(&local_38,local_30);
      FUN_00482744(&local_38,param_1 + 0x200);
      FUN_00482744(&local_38,param_1 + 0x280);
      local_48[5] = (char)(local_34 >> 0x10);
      local_48[0] = (byte)(local_38 >> 0x18);
      local_48[1] = (char)(local_38 >> 0x10);
      local_48[2] = (char)(local_38 >> 8);
      local_48[3] = (char)local_38;
      local_48[4] = (char)(local_34 >> 0x18);
      local_48[6] = (char)(local_34 >> 8);
      local_48[7] = (char)local_34;
      uVar3 = 0;
      do {
        bVar2 = param_2[uVar3];
        uVar5 = uVar3 + 1;
        *(byte *)(param_3 + uVar3) = local_48[uVar3] ^ *(byte *)(uVar3 + param_1 + 0x300);
        local_40[uVar3] = bVar2;
        uVar3 = uVar5;
      } while (uVar5 < 8);
      uVar3 = 0;
      do {
        iVar4 = uVar3 + param_1;
        pbVar1 = local_40 + uVar3;
        uVar3 = uVar3 + 1;
        *(byte *)(iVar4 + 0x300) = *pbVar1;
      } while (uVar3 < 8);
      uVar6 = uVar6 + 8;
      param_2 = param_2 + 8;
      param_3 = param_3 + 8;
    } while (uVar6 < param_4);
  }
  memset_s(local_48,8,0,8);
  memset_s(local_40,8,0,8);
  return;
}



int getAsnTagLenUnsafe(char *param_1)

{
  uint uVar1;
  uint __n;
  undefined auStack_d [5];
  
  if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
    __n = (uint)(byte)param_1[1];
    uVar1 = __n - 0x81;
    if (0x7f < __n) {
      __n = __n - 0x80;
      if (2 < uVar1) {
        return 0;
      }
      memcpy(auStack_d + -__n,param_1 + 2,__n);
    }
    return __n + 2;
  }
  return 0;
}



undefined4 getAsnLength32(byte **param_1,int param_2,byte **param_3,int param_4)

{
  undefined4 uVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  
  pbVar2 = *param_1;
  *param_3 = (byte *)0x0;
  if (param_2 < 1) {
    return 0xfffffff7;
  }
  pbVar4 = pbVar2 + 1;
  pbVar3 = (byte *)((int)(char)*pbVar2 & 0x7f);
  if ((char)*pbVar2 < 0) {
    if (pbVar2 + (param_2 - (int)pbVar4) < pbVar3) {
      return 0xfffffff7;
    }
    switch(pbVar3) {
    case (byte *)0x0:
      if (param_4 != 0) {
        *param_1 = pbVar4;
        *param_3 = (byte *)(param_2 + -1);
        return 0xfffd;
      }
      return 0xfffffff7;
    case (byte *)0x1:
      pbVar3 = (byte *)(uint)*pbVar4;
      pbVar4 = pbVar2 + 2;
      break;
    case (byte *)0x2:
      pbVar3 = (byte *)(uint)CONCAT11(*pbVar4,pbVar2[2]);
      pbVar4 = pbVar2 + 3;
      break;
    case (byte *)0x3:
      pbVar3 = (byte *)((uint)*pbVar4 << 0x10 | (uint)pbVar2[2] << 8 | (uint)pbVar2[3]);
      pbVar4 = pbVar2 + 4;
      break;
    case (byte *)0x4:
      pbVar3 = (byte *)((uint)*pbVar4 << 0x18 | (uint)pbVar2[2] << 0x10 | (uint)pbVar2[3] << 8 |
                       (uint)pbVar2[4]);
      pbVar4 = pbVar2 + 5;
      break;
    default:
      return 0xfffffff7;
    }
  }
  if ((param_4 != 0) || (uVar1 = 0xfffffff7, pbVar3 <= pbVar2 + (param_2 - (int)pbVar4))) {
    *param_1 = pbVar4;
    *param_3 = pbVar3;
    uVar1 = 0;
  }
  return uVar1;
}



undefined4 getAsnLength(byte **param_1,uint param_2,undefined2 *param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  
  pbVar1 = *param_1;
  param_2 = param_2 & 0xffff;
  if (param_2 == 0) {
    return 0xfffffff7;
  }
  pbVar3 = pbVar1 + 1;
  pbVar2 = (byte *)((int)(char)*pbVar1 & 0x7f);
  if ((char)*pbVar1 < 0) {
    if (pbVar1 + (param_2 - (int)pbVar3) < pbVar2) {
      return 0xfffffff7;
    }
    switch(pbVar2) {
    default:
      goto LAB_004830ac;
    case (byte *)0x1:
      pbVar2 = (byte *)(uint)*pbVar3;
      pbVar3 = pbVar1 + 2;
      break;
    case (byte *)0x2:
      pbVar2 = (byte *)(uint)CONCAT11(*pbVar3,pbVar1[2]);
      pbVar3 = pbVar1 + 3;
      break;
    case (byte *)0x3:
      pbVar2 = (byte *)((uint)*pbVar3 << 0x10 | (uint)pbVar1[2] << 8 | (uint)pbVar1[3]);
      pbVar3 = pbVar1 + 4;
      break;
    case (byte *)0x4:
      pbVar2 = (byte *)((uint)*pbVar3 << 0x18 | (uint)pbVar1[2] << 0x10 | (uint)pbVar1[3] << 8 |
                       (uint)pbVar1[4]);
      pbVar3 = pbVar1 + 5;
    }
  }
  if (pbVar2 <= pbVar1 + (param_2 - (int)pbVar3)) {
    *param_1 = pbVar3;
    *param_3 = (short)pbVar2;
    return 0;
  }
LAB_004830ac:
  return 0xfffffff7;
}



undefined4 getAsnSequence32(byte **param_1,int param_2,byte **param_3,int param_4)

{
  byte *pbVar1;
  byte *pbVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  byte *local_8;
  
  pbVar2 = *param_1;
  if (param_2 == 0) {
    return 0xffffffe1;
  }
  if (*pbVar2 != 0x30) {
    return 0xffffffe1;
  }
  *param_3 = (byte *)0x0;
  uVar3 = 0xfffffff7;
  if (param_2 + -1 < 1) {
    return 0xfffffff7;
  }
  local_8 = pbVar2 + 2;
  pbVar1 = (byte *)((int)(char)pbVar2[1] & 0x7f);
  if (-1 < (char)pbVar2[1]) goto LAB_004831f0;
  if (pbVar2 + (param_2 - (int)local_8) < pbVar1) {
    return 0xfffffff7;
  }
  switch(pbVar1) {
  case (byte *)0x0:
    if (param_4 == 0) {
      return 0xfffffff7;
    }
    uVar4 = 0xfffd;
    *param_3 = (byte *)(param_2 + -2);
    goto LAB_00483204;
  case (byte *)0x1:
    pbVar1 = (byte *)(uint)*local_8;
    local_8 = pbVar2 + 3;
    break;
  case (byte *)0x2:
    pbVar1 = (byte *)(uint)CONCAT11(*local_8,pbVar2[3]);
    local_8 = pbVar2 + 4;
    break;
  case (byte *)0x3:
    pbVar1 = (byte *)((uint)*local_8 << 0x10 | (uint)pbVar2[3] << 8 | (uint)pbVar2[4]);
    local_8 = pbVar2 + 5;
    break;
  case (byte *)0x4:
    pbVar1 = (byte *)((uint)*local_8 << 0x18 | (uint)pbVar2[3] << 0x10 | (uint)pbVar2[4] << 8 |
                     (uint)pbVar2[5]);
    local_8 = pbVar2 + 6;
    break;
  default:
    goto switchD_00483288_caseD_5;
  }
LAB_004831f0:
  if ((param_4 == 0) && (pbVar2 + (param_2 - (int)local_8) < pbVar1)) {
    uVar3 = 0xfffffff7;
  }
  else {
    uVar4 = 0;
    *param_3 = pbVar1;
LAB_00483204:
    if (param_4 == 0) {
      uVar3 = 0xfffffff7;
      if (*param_3 <= (byte *)(param_2 - ((int)local_8 - (int)pbVar2))) {
        *param_1 = local_8;
        uVar3 = uVar4;
      }
    }
    else {
      *param_1 = local_8;
      uVar3 = uVar4;
    }
  }
switchD_00483288_caseD_5:
  return uVar3;
}



int getAsnSequence(byte **param_1,uint param_2,undefined2 *param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  int iVar3;
  byte *pbVar4;
  byte *local_8;
  
  pbVar1 = *param_1;
  param_2 = param_2 & 0xffff;
  local_8 = (byte *)0x0;
  iVar3 = -0x1f;
  if (((param_2 == 0) || (*pbVar1 != 0x30)) || (iVar3 = -9, (int)(param_2 - 1) < 1))
  goto switchD_00483428_caseD_5;
  pbVar2 = pbVar1 + 2;
  pbVar4 = (byte *)((int)(char)pbVar1[1] & 0x7f);
  if (-1 < (char)pbVar1[1]) goto LAB_004833a8;
  iVar3 = -9;
  if (pbVar1 + (param_2 - (int)pbVar2) < pbVar4) goto switchD_00483428_caseD_5;
  switch(pbVar4) {
  case (byte *)0x0:
    goto switchD_00483428_caseD_0;
  case (byte *)0x1:
    pbVar4 = (byte *)(uint)*pbVar2;
    pbVar2 = pbVar1 + 3;
    break;
  case (byte *)0x2:
    pbVar4 = (byte *)(uint)CONCAT11(*pbVar2,pbVar1[3]);
    pbVar2 = pbVar1 + 4;
    break;
  case (byte *)0x3:
    pbVar4 = (byte *)((uint)*pbVar2 << 0x10 | (uint)pbVar1[3] << 8 | (uint)pbVar1[4]);
    pbVar2 = pbVar1 + 5;
    break;
  case (byte *)0x4:
    pbVar4 = (byte *)((uint)*pbVar2 << 0x18 | (uint)pbVar1[3] << 0x10 | (uint)pbVar1[4] << 8 |
                     (uint)pbVar1[5]);
    pbVar2 = pbVar1 + 6;
    break;
  default:
    goto switchD_00483428_caseD_5;
  }
LAB_004833a8:
  if (pbVar1 + (param_2 - (int)pbVar2) < pbVar4) {
switchD_00483428_caseD_0:
    iVar3 = -9;
  }
  else {
    if ((byte *)(param_2 - ((int)pbVar2 - (int)*param_1)) < pbVar4) {
      return -9;
    }
    iVar3 = 0;
    *param_1 = pbVar2;
    local_8 = pbVar4;
  }
switchD_00483428_caseD_5:
  if (-1 < iVar3) {
    iVar3 = 0;
    *param_3 = (short)local_8;
  }
  return iVar3;
}



int getAsnSet(byte **param_1,uint param_2,undefined2 *param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte *pbVar3;
  int iVar4;
  byte *pbVar5;
  byte *local_8;
  
  pbVar1 = *param_1;
  pbVar2 = (byte *)(param_2 & 0xffff);
  local_8 = (byte *)0x0;
  iVar4 = -0x1f;
  if (((pbVar2 == (byte *)0x0) || (*pbVar1 != 0x31)) || (iVar4 = -9, (int)(pbVar2 + -1) < 1))
  goto switchD_0048373c_caseD_5;
  pbVar3 = pbVar1 + 2;
  pbVar5 = (byte *)((int)(char)pbVar1[1] & 0x7f);
  if (-1 < (char)pbVar1[1]) goto LAB_004836bc;
  iVar4 = -9;
  if (pbVar1 + ((int)pbVar2 - (int)pbVar3) < pbVar5) goto switchD_0048373c_caseD_5;
  switch(pbVar5) {
  case (byte *)0x0:
    goto switchD_0048373c_caseD_0;
  case (byte *)0x1:
    pbVar5 = (byte *)(uint)*pbVar3;
    pbVar3 = pbVar1 + 3;
    break;
  case (byte *)0x2:
    pbVar5 = (byte *)(uint)CONCAT11(*pbVar3,pbVar1[3]);
    pbVar3 = pbVar1 + 4;
    break;
  case (byte *)0x3:
    pbVar5 = (byte *)((uint)*pbVar3 << 0x10 | (uint)pbVar1[3] << 8 | (uint)pbVar1[4]);
    pbVar3 = pbVar1 + 5;
    break;
  case (byte *)0x4:
    pbVar5 = (byte *)((uint)*pbVar3 << 0x18 | (uint)pbVar1[3] << 0x10 | (uint)pbVar1[4] << 8 |
                     (uint)pbVar1[5]);
    pbVar3 = pbVar1 + 6;
    break;
  default:
    goto switchD_0048373c_caseD_5;
  }
LAB_004836bc:
  if (pbVar1 + ((int)pbVar2 - (int)pbVar3) < pbVar5) {
switchD_0048373c_caseD_0:
    iVar4 = -9;
  }
  else {
    if (pbVar2 < pbVar3 + ((int)pbVar5 - (int)*param_1)) {
      return -9;
    }
    iVar4 = 0;
    *param_1 = pbVar3;
    local_8 = pbVar5;
  }
switchD_0048373c_caseD_5:
  if (-1 < iVar4) {
    iVar4 = 0;
    *param_3 = (short)local_8;
  }
  return iVar4;
}



undefined4 getAsnEnumerated(byte **param_1,int param_2,uint *param_3)

{
  bool bVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  
  pbVar3 = *param_1;
  if (param_2 == 0) {
    return 0xffffffe1;
  }
  if (*pbVar3 != 10) {
    return 0xffffffe1;
  }
  if (param_2 + -1 < 1) {
    return 0xfffffff7;
  }
  pbVar5 = pbVar3 + 2;
  pbVar4 = (byte *)((int)(char)pbVar3[1] & 0x7f);
  if (-1 < (char)pbVar3[1]) goto LAB_00483828;
  if (pbVar3 + (param_2 - (int)pbVar5) < pbVar4) {
    return 0xfffffff7;
  }
  switch(pbVar4) {
  case (byte *)0x1:
    pbVar4 = (byte *)(uint)*pbVar5;
    pbVar5 = pbVar3 + 3;
    break;
  case (byte *)0x2:
    pbVar4 = (byte *)(uint)CONCAT11(*pbVar5,pbVar3[3]);
    pbVar5 = pbVar3 + 4;
    break;
  case (byte *)0x3:
    pbVar4 = (byte *)((uint)*pbVar5 << 0x10 | (uint)pbVar3[3] << 8 | (uint)pbVar3[4]);
    pbVar5 = pbVar3 + 5;
    break;
  case (byte *)0x4:
    pbVar4 = (byte *)((uint)*pbVar5 << 0x18 | (uint)pbVar3[3] << 0x10 | (uint)pbVar3[4] << 8 |
                     (uint)pbVar3[5]);
    pbVar5 = pbVar3 + 6;
    break;
  default:
    goto switchD_0048393c_caseD_5;
  }
LAB_00483828:
  if (pbVar4 <= pbVar3 + (param_2 - (int)pbVar5)) {
    if ((pbVar4 < (byte *)0x5) && (pbVar4 <= pbVar3 + (param_2 - (int)pbVar5))) {
      uVar6 = 0;
      if ((char)*pbVar5 < '\0') {
        while (bVar1 = pbVar4 != (byte *)0x0, pbVar4 = pbVar4 + -1, bVar1) {
          bVar2 = *pbVar5;
          pbVar5 = pbVar5 + 1;
          uVar6 = uVar6 << 8 | ~(uint)bVar2 & 0xff;
        }
        *param_3 = ~uVar6;
        *param_1 = pbVar5;
      }
      else {
        for (; pbVar4 != (byte *)0x0; pbVar4 = pbVar4 + -1) {
          bVar2 = *pbVar5;
          pbVar5 = pbVar5 + 1;
          uVar6 = uVar6 << 8 | (uint)bVar2;
        }
        *param_3 = uVar6;
        *param_1 = pbVar5;
      }
      return 0;
    }
    return 0xfffffff7;
  }
switchD_0048393c_caseD_5:
  return 0xfffffff7;
}



undefined4 getAsnInteger(byte **param_1,int param_2,uint *param_3)

{
  bool bVar1;
  byte bVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  
  pbVar3 = *param_1;
  if (param_2 == 0) {
    return 0xffffffe1;
  }
  if (*pbVar3 != 2) {
    return 0xffffffe1;
  }
  if (param_2 + -1 < 1) {
    return 0xfffffff7;
  }
  pbVar5 = pbVar3 + 2;
  pbVar4 = (byte *)((int)(char)pbVar3[1] & 0x7f);
  if (-1 < (char)pbVar3[1]) goto LAB_00483a28;
  if (pbVar3 + (param_2 - (int)pbVar5) < pbVar4) {
    return 0xfffffff7;
  }
  switch(pbVar4) {
  case (byte *)0x1:
    pbVar4 = (byte *)(uint)*pbVar5;
    pbVar5 = pbVar3 + 3;
    break;
  case (byte *)0x2:
    pbVar4 = (byte *)(uint)CONCAT11(*pbVar5,pbVar3[3]);
    pbVar5 = pbVar3 + 4;
    break;
  case (byte *)0x3:
    pbVar4 = (byte *)((uint)*pbVar5 << 0x10 | (uint)pbVar3[3] << 8 | (uint)pbVar3[4]);
    pbVar5 = pbVar3 + 5;
    break;
  case (byte *)0x4:
    pbVar4 = (byte *)((uint)*pbVar5 << 0x18 | (uint)pbVar3[3] << 0x10 | (uint)pbVar3[4] << 8 |
                     (uint)pbVar3[5]);
    pbVar5 = pbVar3 + 6;
    break;
  default:
    goto switchD_00483b3c_caseD_5;
  }
LAB_00483a28:
  if (pbVar4 <= pbVar3 + (param_2 - (int)pbVar5)) {
    if ((pbVar4 < (byte *)0x5) && (pbVar4 <= pbVar3 + (param_2 - (int)pbVar5))) {
      uVar6 = 0;
      if ((char)*pbVar5 < '\0') {
        while (bVar1 = pbVar4 != (byte *)0x0, pbVar4 = pbVar4 + -1, bVar1) {
          bVar2 = *pbVar5;
          pbVar5 = pbVar5 + 1;
          uVar6 = uVar6 << 8 | ~(uint)bVar2 & 0xff;
        }
        *param_3 = ~uVar6;
        *param_1 = pbVar5;
      }
      else {
        for (; pbVar4 != (byte *)0x0; pbVar4 = pbVar4 + -1) {
          bVar2 = *pbVar5;
          pbVar5 = pbVar5 + 1;
          uVar6 = uVar6 << 8 | (uint)bVar2;
        }
        *param_3 = uVar6;
        *param_1 = pbVar5;
      }
      return 0;
    }
    return 0xfffffff7;
  }
switchD_00483b3c_caseD_5:
  return 0xfffffff7;
}



uint asnParseOid(byte *param_1,uint param_2,uint *param_3)

{
  byte bVar1;
  byte bVar2;
  uint uVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  uint *puVar7;
  
  uVar3 = 0;
  if ((param_2 & 0xffff) != 0) {
    pbVar5 = param_1 + (param_2 & 0xffff);
    pbVar6 = param_1 + 1;
    *param_3 = *param_1 / 0x28;
    param_3[1] = (uint)*param_1 % 0x28;
    uVar4 = 0xf;
    do {
      uVar3 = uVar4 - 1 & 0xff;
      param_3[uVar4] = 0;
      uVar4 = uVar3;
    } while (2 < uVar3);
    for (; pbVar6 < pbVar5; pbVar6 = pbVar6 + 1) {
      while( true ) {
        if (0xf < uVar3) {
          return 0;
        }
        bVar1 = *pbVar6;
        if ((char)bVar1 < '\0') break;
        pbVar6 = pbVar6 + 1;
        puVar7 = param_3 + uVar3;
        uVar3 = uVar3 + 1 & 0xff;
        *puVar7 = (uint)bVar1;
        if (pbVar5 <= pbVar6) goto LAB_00483c88;
      }
      uVar4 = param_3[uVar3] | bVar1 & 0x7f;
      param_3[uVar3] = uVar4;
      bVar2 = 1;
      bVar1 = *pbVar6;
      while ((char)bVar1 < '\0') {
        pbVar6 = pbVar6 + 1;
        if (4 < bVar2) {
          return 0;
        }
        param_3[uVar3] = uVar4 << 7;
        if (pbVar5 <= pbVar6) break;
        uVar4 = param_3[uVar3] | *pbVar6 & 0x7f;
        param_3[uVar3] = uVar4;
        bVar2 = bVar2 + 1;
        bVar1 = *pbVar6;
      }
      uVar3 = uVar3 + 1 & 0xff;
    }
LAB_00483c88:
    if (0xf < uVar3) {
      uVar3 = 0;
    }
  }
  return uVar3;
}



void FUN_00483d30(uint *param_1,void *param_2,size_t param_3)

{
  int iVar1;
  undefined *puVar2;
  uint uVar3;
  
  uVar3 = *param_1;
  if (uVar3 == 0x285) goto LAB_00483e10;
LAB_00483d74:
  if ((int)uVar3 < 0x286) {
    if (uVar3 == 0x1a2) {
      puVar2 = &UNK_00494494;
    }
    else if ((int)uVar3 < 0x1a3) {
      if (uVar3 == 0x97) {
        puVar2 = &UNK_00494298;
      }
      else if ((int)uVar3 < 0x98) {
        if (uVar3 == 0x75) {
          puVar2 = &UNK_004944e0;
        }
        else if ((int)uVar3 < 0x76) {
          if (uVar3 == 0x5b) {
            puVar2 = &UNK_00494530;
          }
          else if ((int)uVar3 < 0x5c) {
            if (uVar3 != 0x58) {
LAB_004844dc:
              *param_1 = uVar3 | 0x8000;
              return;
            }
            puVar2 = &UNK_00494320;
          }
          else {
            if (uVar3 != 0x74) goto LAB_004844dc;
            puVar2 = &UNK_00494404;
          }
        }
        else if (uVar3 == 0x90) {
          puVar2 = &UNK_004942b4;
        }
        else if ((int)uVar3 < 0x91) {
          if (uVar3 != 0x8f) goto LAB_004844dc;
          puVar2 = &UNK_00494270;
        }
        else if (uVar3 == 0x91) {
          puVar2 = &UNK_004942c0;
        }
        else {
          if (uVar3 != 0x96) goto LAB_004844dc;
          puVar2 = &UNK_00494288;
        }
      }
      else if (uVar3 == 0xbf) {
        puVar2 = &UNK_00494508;
      }
      else if ((int)uVar3 < 0xc0) {
        if (uVar3 == 0xbd) {
          puVar2 = &UNK_00494548;
        }
        else if ((int)uVar3 < 0xbe) {
          if (uVar3 != 0x98) goto LAB_004844dc;
          puVar2 = &UNK_00494260;
        }
        else {
          puVar2 = &UNK_0049446c;
        }
      }
      else if (uVar3 == 0x19f) {
        puVar2 = &UNK_004945e0;
      }
      else if ((int)uVar3 < 0x1a0) {
        if (uVar3 != 0x19e) goto LAB_004844dc;
        puVar2 = &UNK_004943b8;
      }
      else if (uVar3 == 0x1a0) {
        puVar2 = &UNK_00494654;
      }
      else {
        if (uVar3 != 0x1a1) goto LAB_004844dc;
        puVar2 = &UNK_00494460;
      }
    }
    else if (uVar3 == 0x1de) {
      puVar2 = &UNK_004942a8;
    }
    else if ((int)uVar3 < 0x1df) {
      if (uVar3 == 0x1c6) {
        puVar2 = &UNK_004944c8;
      }
      else if ((int)uVar3 < 0x1c7) {
        if (uVar3 == 0x1b5) {
          puVar2 = &UNK_00494554;
        }
        else if ((int)uVar3 < 0x1b6) {
          if (uVar3 != 0x1b2) goto LAB_004844dc;
          puVar2 = &UNK_00494340;
        }
        else {
          if (uVar3 != 0x1b6) goto LAB_004844dc;
          puVar2 = &UNK_00494410;
        }
      }
      else if (uVar3 == 0x1ca) {
        puVar2 = &UNK_004945b8;
      }
      else if ((int)uVar3 < 0x1cb) {
        if (uVar3 != 0x1c9) goto LAB_004844dc;
        puVar2 = &UNK_00494394;
      }
      else if (uVar3 == 0x1d0) {
        puVar2 = &UNK_004942cc;
      }
      else {
        if (uVar3 != 0x1d1) goto LAB_004844dc;
        puVar2 = &UNK_0049427c;
      }
    }
    else if (uVar3 == 0x20b) {
      puVar2 = &UNK_00494524;
    }
    else if ((int)uVar3 < 0x20c) {
      if (uVar3 == 0x205) {
        puVar2 = &UNK_00494594;
      }
      else if ((int)uVar3 < 0x206) {
        if (uVar3 != 0x203) goto LAB_004844dc;
        puVar2 = &UNK_00494378;
      }
      else if (uVar3 == 0x206) {
        puVar2 = &UNK_00494604;
      }
      else {
        if (uVar3 != 0x208) goto LAB_004844dc;
        puVar2 = &UNK_004943f8;
      }
    }
    else if (uVar3 == 0x20d) {
      puVar2 = &UNK_004945ac;
    }
    else if ((int)uVar3 < 0x20d) {
      puVar2 = &UNK_00494428;
    }
    else if (uVar3 == 0x20e) {
      puVar2 = &UNK_0049463c;
    }
    else {
      if (uVar3 != 0x264) goto LAB_004844dc;
      puVar2 = &UNK_004943a0;
    }
  }
  else if (uVar3 == 0x29e) {
    puVar2 = &UNK_004944a0;
  }
  else if ((int)uVar3 < 0x29f) {
    if (uVar3 == 0x290) {
      puVar2 = &UNK_004944b0;
    }
    else if ((int)uVar3 < 0x291) {
      if (uVar3 == 0x28b) {
        puVar2 = &UNK_004944d4;
      }
      else if ((int)uVar3 < 0x28c) {
        if (uVar3 == 0x288) {
          puVar2 = &UNK_00494560;
        }
        else if ((int)uVar3 < 0x289) {
          if (uVar3 != 0x286) goto LAB_004844dc;
          puVar2 = &UNK_00494334;
        }
        else {
          if (uVar3 != 0x289) goto LAB_004844dc;
          puVar2 = &UNK_0049441c;
        }
      }
      else if (uVar3 == 0x28d) {
        puVar2 = &UNK_004945a0;
      }
      else if ((int)uVar3 < 0x28d) {
        puVar2 = &UNK_00494444;
      }
      else if (uVar3 == 0x28e) {
        puVar2 = &UNK_004945f8;
      }
      else {
        if (uVar3 != 0x28f) goto LAB_004844dc;
        puVar2 = &UNK_004943ac;
      }
    }
    else if (uVar3 == 0x295) {
      puVar2 = &UNK_004944f8;
    }
    else if ((int)uVar3 < 0x296) {
      if (uVar3 == 0x292) {
        puVar2 = &UNK_00494538;
      }
      else if ((int)uVar3 < 0x292) {
        puVar2 = &UNK_00494450;
      }
      else if (uVar3 == 0x293) {
        puVar2 = &UNK_0049462c;
      }
      else {
        if (uVar3 != 0x294) goto LAB_004844dc;
        puVar2 = &UNK_0049435c;
      }
    }
    else if (uVar3 == 0x29b) {
      puVar2 = &UNK_004945d0;
    }
    else if ((int)uVar3 < 0x29c) {
      if (uVar3 != 0x296) goto LAB_004844dc;
      puVar2 = &UNK_004943c4;
    }
    else if (uVar3 == 0x29c) {
      puVar2 = &UNK_0049461c;
    }
    else {
      if (uVar3 != 0x29d) goto LAB_004844dc;
      puVar2 = &UNK_00494484;
    }
  }
  else if (uVar3 == 0x689) {
    puVar2 = &UNK_004944bc;
  }
  else if ((int)uVar3 < 0x68a) {
    if (uVar3 == 0x2a4) {
      puVar2 = &UNK_00494514;
    }
    else if ((int)uVar3 < 0x2a5) {
      if (uVar3 == 0x2a0) {
        puVar2 = &UNK_0049456c;
      }
      else if ((int)uVar3 < 0x2a0) {
        puVar2 = &UNK_00494434;
      }
      else {
        if (uVar3 != 0x2a3) goto LAB_004844dc;
        puVar2 = &UNK_0049434c;
      }
    }
    else if (uVar3 == 0x59e) {
      puVar2 = &UNK_00494588;
    }
    else if ((int)uVar3 < 0x59f) {
      if (uVar3 != 0x2af) goto LAB_004844dc;
      puVar2 = &UNK_00494384;
    }
    else if (uVar3 == 0x5a1) {
      puVar2 = &UNK_004945ec;
    }
    else {
      if (uVar3 != 0x686) goto LAB_004844dc;
      puVar2 = &UNK_004943e0;
    }
  }
  else if (uVar3 == 0x691) {
    puVar2 = &UNK_004944ec;
  }
  else if ((int)uVar3 < 0x692) {
    if (uVar3 == 0x68e) {
      puVar2 = &UNK_0049457c;
    }
    else if ((int)uVar3 < 0x68f) {
      if (uVar3 != 0x68c) goto LAB_004844dc;
      puVar2 = &UNK_0049436c;
    }
    else if (uVar3 == 0x68f) {
      puVar2 = &UNK_00494648;
    }
    else {
      if (uVar3 != 0x690) goto LAB_004844dc;
      puVar2 = &UNK_00494478;
    }
  }
  else if (uVar3 == 0x694) {
    puVar2 = &UNK_004945c4;
  }
  else if ((int)uVar3 < 0x695) {
    if (uVar3 != 0x692) goto LAB_004844dc;
    puVar2 = &UNK_004943d4;
  }
  else if (uVar3 == 0x695) {
    puVar2 = &UNK_00494610;
  }
  else {
    if (uVar3 != 0xa8c) goto LAB_004844dc;
    puVar2 = &UNK_004943ec;
  }
  if ((int)(char)puVar2[1] == param_3) goto LAB_00483e2c;
  do {
    uVar3 = uVar3 + 0x400;
    *param_1 = uVar3;
    while( true ) {
      if (uVar3 != 0x285) goto LAB_00483d74;
LAB_00483e10:
      puVar2 = &UNK_00494328;
      if (param_3 != 9) break;
LAB_00483e2c:
      iVar1 = memcmp(param_2,puVar2 + 2,param_3);
      uVar3 = uVar3 + 0x400;
      if (iVar1 == 0) {
        return;
      }
      *param_1 = uVar3;
    }
  } while( true );
}



undefined4 getAsnOID(byte **param_1,int param_2,int *param_3,char param_4,short *param_5)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  undefined4 uVar5;
  byte *pbVar6;
  byte *pbVar7;
  
  pbVar2 = *param_1;
  if (*pbVar2 != 6) {
    return 0xffffffe1;
  }
  if ((int)(pbVar2 + (param_2 - (int)(pbVar2 + 1))) < 1) {
    return 0xfffffff7;
  }
  pbVar3 = pbVar2 + 2;
  pbVar6 = (byte *)((int)(char)pbVar2[1] & 0x7f);
  if ((char)pbVar2[1] < 0) {
    uVar5 = 0xfffffff7;
    if (pbVar2 + (param_2 - (int)pbVar3) < pbVar6) {
      return 0xfffffff7;
    }
    switch(pbVar6) {
    case (byte *)0x0:
      return 0xfffffff7;
    case (byte *)0x1:
      pbVar6 = (byte *)(uint)*pbVar3;
      pbVar3 = pbVar2 + 3;
      break;
    case (byte *)0x2:
      pbVar6 = (byte *)(uint)CONCAT11(*pbVar3,pbVar2[3]);
      pbVar3 = pbVar2 + 4;
      break;
    case (byte *)0x3:
      pbVar6 = (byte *)((uint)*pbVar3 << 0x10 | (uint)pbVar2[3] << 8 | (uint)pbVar2[4]);
      pbVar3 = pbVar2 + 5;
      break;
    case (byte *)0x4:
      pbVar6 = (byte *)((uint)*pbVar3 << 0x18 | (uint)pbVar2[3] << 0x10 | (uint)pbVar2[4] << 8 |
                       (uint)pbVar2[5]);
      pbVar3 = pbVar2 + 6;
      break;
    default:
      goto switchD_004846c0_caseD_5;
    }
  }
  uVar5 = 0xfffffff7;
  if (pbVar6 <= pbVar2 + (param_2 - (int)pbVar3)) {
    uVar5 = 0xfffffff7;
    if ((pbVar6 <= pbVar2 + (param_2 - (int)pbVar3)) &&
       (1 < (int)(pbVar2 + (param_2 - (int)pbVar3)))) {
      *param_3 = 0;
      pbVar4 = pbVar3;
      for (pbVar7 = pbVar6; pbVar7 != (byte *)0x0; pbVar7 = pbVar7 + -1) {
        bVar1 = *pbVar4;
        pbVar4 = pbVar4 + 1;
        *param_3 = *param_3 + (uint)bVar1;
      }
      FUN_00483d30(param_3,pbVar3,pbVar6,0,&_gp);
      uVar5 = 0;
      if (param_4 == '\0') {
        *param_5 = 0;
        *param_1 = pbVar4;
      }
      else {
        pbVar2 = pbVar2 + (param_2 - (int)pbVar4);
        *param_5 = (short)pbVar2;
        if (*pbVar4 == 5) {
          uVar5 = 0xfffffff7;
          if ((1 < (int)pbVar2) && (1 < ((uint)pbVar2 & 0xffff))) {
            uVar5 = 0;
            *param_5 = (short)pbVar2 + -2;
            *param_1 = pbVar4 + 2;
          }
        }
        else {
          *param_1 = pbVar4;
        }
      }
    }
  }
switchD_004846c0_caseD_5:
  return uVar5;
}



int getAsnAlgorithmIdentifier(byte **param_1,int param_2,int *param_3,short *param_4)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *pbVar5;
  int iVar6;
  byte *pbVar7;
  byte *local_38;
  byte *local_34;
  
  pbVar3 = *param_1;
  if (param_2 == 0) {
    return -0x1f;
  }
  iVar6 = -0x1f;
  local_38 = pbVar3;
  if (*pbVar3 == 0x30) {
    local_34 = (byte *)0x0;
    iVar6 = -9;
    if (param_2 + -1 < 1) goto switchD_004849f8_caseD_5;
    pbVar7 = pbVar3 + 2;
    pbVar4 = (byte *)((int)(char)pbVar3[1] & 0x7f);
    if (-1 < (char)pbVar3[1]) goto LAB_00484888;
    iVar6 = -9;
    if (pbVar3 + (param_2 - (int)pbVar7) < pbVar4) goto switchD_004849f8_caseD_5;
    switch(pbVar4) {
    case (byte *)0x0:
      goto switchD_004849f8_caseD_0;
    case (byte *)0x1:
      pbVar4 = (byte *)(uint)*pbVar7;
      pbVar7 = pbVar3 + 3;
      break;
    case (byte *)0x2:
      pbVar4 = (byte *)(uint)CONCAT11(*pbVar7,pbVar3[3]);
      pbVar7 = pbVar3 + 4;
      break;
    case (byte *)0x3:
      pbVar4 = (byte *)((uint)*pbVar7 << 0x10 | (uint)pbVar3[3] << 8 | (uint)pbVar3[4]);
      pbVar7 = pbVar3 + 5;
      break;
    case (byte *)0x4:
      pbVar4 = (byte *)((uint)*pbVar7 << 0x18 | (uint)pbVar3[3] << 0x10 | (uint)pbVar3[4] << 8 |
                       (uint)pbVar3[5]);
      pbVar7 = pbVar3 + 6;
      break;
    default:
      goto switchD_004849f8_caseD_5;
    }
LAB_00484888:
    if (pbVar3 + (param_2 - (int)pbVar7) < pbVar4) {
switchD_004849f8_caseD_0:
      iVar6 = -9;
    }
    else {
      if ((byte *)(param_2 - ((int)pbVar7 - (int)pbVar3)) < pbVar4) {
        return -9;
      }
      iVar6 = 0;
      local_38 = pbVar7;
      local_34 = pbVar4;
    }
  }
switchD_004849f8_caseD_5:
  if (iVar6 < 0) {
    return iVar6;
  }
  if ((int)(pbVar3 + (param_2 - (int)local_38)) < 1) {
    return -9;
  }
  iVar6 = -0x1f;
  if ((*local_38 != 6) || (iVar6 = -9, (int)(local_38 + ((int)local_34 - (int)(local_38 + 1))) < 1))
  goto switchD_00484ab0_caseD_5;
  pbVar3 = local_38 + 2;
  pbVar7 = (byte *)((int)(char)local_38[1] & 0x7f);
  if (-1 < (char)local_38[1]) goto LAB_004848ec;
  if (local_38 + ((int)local_34 - (int)pbVar3) < pbVar7) goto switchD_00484ab0_caseD_5;
  iVar6 = -9;
  switch(pbVar7) {
  case (byte *)0x0:
    goto LAB_004849b4;
  case (byte *)0x1:
    pbVar7 = (byte *)(uint)*pbVar3;
    pbVar3 = local_38 + 3;
    break;
  case (byte *)0x2:
    pbVar7 = (byte *)(uint)CONCAT11(*pbVar3,local_38[3]);
    pbVar3 = local_38 + 4;
    break;
  case (byte *)0x3:
    pbVar7 = (byte *)((uint)*pbVar3 << 0x10 | (uint)local_38[3] << 8 | (uint)local_38[4]);
    pbVar3 = local_38 + 5;
    break;
  case (byte *)0x4:
    pbVar7 = (byte *)((uint)*pbVar3 << 0x18 | (uint)local_38[3] << 0x10 | (uint)local_38[4] << 8 |
                     (uint)local_38[5]);
    pbVar3 = local_38 + 6;
    break;
  default:
    goto switchD_00484ab0_caseD_5;
  }
LAB_004848ec:
  if (local_38 + ((int)local_34 - (int)pbVar3) < pbVar7) {
LAB_004849b4:
    iVar6 = -9;
  }
  else {
    iVar6 = -9;
    if ((pbVar7 <= local_38 + ((int)local_34 - (int)pbVar3)) &&
       (1 < (int)(local_38 + ((int)local_34 - (int)pbVar3)))) {
      *param_3 = 0;
      pbVar4 = pbVar3;
      pbVar5 = pbVar7;
      pbVar2 = local_38;
      while (pbVar5 != (byte *)0x0) {
        bVar1 = *pbVar4;
        pbVar4 = pbVar4 + 1;
        *param_3 = *param_3 + (uint)bVar1;
        pbVar5 = pbVar5 + -1;
        pbVar2 = pbVar5;
      }
      FUN_00483d30(param_3,pbVar3,pbVar7,pbVar2,&_gp);
      pbVar3 = local_38 + ((int)local_34 - (int)pbVar4);
      *param_4 = (short)pbVar3;
      if (*pbVar4 == 5) {
        if (((int)pbVar3 < 2) || (pbVar4 = pbVar4 + 2, ((uint)pbVar3 & 0xffff) < 2)) {
          *param_1 = local_38;
          return -9;
        }
        *param_4 = (short)pbVar3 + -2;
      }
      *param_1 = pbVar4;
      return 0;
    }
  }
switchD_00484ab0_caseD_5:
  *param_1 = local_38;
  return iVar6;
}



undefined4 psBase64decode(int param_1,uint param_2,int param_3,ushort *param_4)

{
  short sVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  
  param_2 = param_2 & 0xffff;
  if (((param_1 == 0) || (param_3 == 0)) || (iVar6 = 3, param_4 == (ushort *)0x0)) {
    return 0xfffffffa;
  }
  uVar7 = 0;
  uVar5 = 0;
  sVar1 = 0;
  uVar4 = 0;
  if (param_2 != 0) {
LAB_00484be4:
    do {
      if ((*(byte *)(uVar4 + param_1) < 0x7b) &&
         (uVar3 = (uint)(byte)(&DAT_00494660)[*(byte *)(uVar4 + param_1)], uVar3 != 0xff)) {
        if (uVar3 == 0xfe) {
          iVar6 = (iVar6 + -1) * 0x10000 >> 0x10;
          uVar3 = 0;
          if (iVar6 < 0) {
            return 0xfffffff7;
          }
        }
        else if (iVar6 != 3) {
          return 0xffffffe1;
        }
        sVar1 = sVar1 + 1;
        uVar2 = uVar7 << 6;
        uVar7 = uVar2 | uVar3;
        if (sVar1 == 4) {
          if ((int)(uint)*param_4 < (int)(uVar5 + iVar6)) {
            return 0xfffffff7;
          }
          *(char *)(uVar5 + param_3) = (char)(uVar2 >> 0x10);
          uVar5 = uVar5 + 1 & 0xffff;
          if (1 < iVar6) {
            *(char *)(uVar5 + param_3) = (char)(uVar2 >> 8);
            uVar5 = uVar5 + 1 & 0xffff;
          }
          if (2 < iVar6) {
            *(char *)(uVar5 + param_3) = (char)uVar7;
            uVar5 = uVar5 + 1 & 0xffff;
          }
          uVar4 = uVar4 + 1 & 0xffff;
          uVar7 = 0;
          sVar1 = 0;
          if (param_2 <= uVar4) break;
          goto LAB_00484be4;
        }
      }
      uVar4 = uVar4 + 1 & 0xffff;
    } while (uVar4 < param_2);
    if (sVar1 != 0) {
      return 0xffffffe1;
    }
  }
  *param_4 = (ushort)uVar5;
  return 0;
}



undefined4 psCrlOpen(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  psCreateMutex(&DAT_004dad78,0,param_3,param_4,&_gp);
  return 0;
}



int FUN_00484d44(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  size_t sVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  undefined4 uVar10;
  int iVar11;
  char *__s;
  undefined auStack_b0 [48];
  undefined4 local_80 [8];
  undefined4 auStack_60 [4];
  undefined4 local_50 [12];
  
  if ((param_1 != 0) && (DAT_004d79dc != 0)) {
    iVar11 = DAT_004d79dc;
    do {
      iVar2 = memcmpct(iVar11 + 0xd8,param_1 + 0xc4,0x14);
      iVar4 = -0x21;
      if (iVar2 == 0) {
        iVar4 = 1;
      }
      if (iVar4 == 1) {
        __s = *(char **)(iVar11 + 0xa8);
        iVar4 = *(int *)(iVar11 + 0xa4);
        iVar2 = psGetBrokenDownGMTime(auStack_b0,0);
        if (iVar2 != 0) goto LAB_00484ed8;
        sVar3 = strlen(__s);
        iVar2 = psBrokenDownTimeImport(local_80,__s,sVar3,(uint)(iVar4 == 0x17) << 1);
        puVar8 = local_80;
        puVar1 = local_50;
        if (iVar2 == 0) goto LAB_00484e74;
        goto LAB_00484ed8;
      }
      iVar11 = *(int *)(iVar11 + 0x224);
    } while (iVar11 != 0);
  }
  return 0;
LAB_00484e74:
  do {
    puVar9 = puVar1;
    puVar7 = puVar8;
    uVar10 = puVar7[1];
    uVar5 = puVar7[2];
    uVar6 = puVar7[3];
    puVar8 = puVar7 + 4;
    *puVar9 = *puVar7;
    puVar9[1] = uVar10;
    puVar9[2] = uVar5;
    puVar9[3] = uVar6;
    puVar1 = puVar9 + 4;
  } while (puVar8 != auStack_60);
  uVar6 = *puVar8;
  uVar5 = puVar7[5];
  puVar9[6] = puVar7[6];
  puVar9[4] = uVar6;
  puVar9[5] = uVar5;
  iVar2 = psBrokenDownTimeAdd(local_50,0x15180);
  if (iVar2 == 0) {
    iVar2 = psBrokenDownTimeCmp(auStack_b0,local_50);
    if (0 < iVar2) {
      *(undefined2 *)(iVar11 + 0xb6) = 1;
    }
  }
  else {
LAB_00484ed8:
    *(undefined2 *)(iVar11 + 0xb6) = 1;
  }
  return iVar11;
}



void FUN_00484f2c(undefined4 *param_1)

{
  void **__ptr;
  void **ppvVar1;
  
  if (param_1 != (undefined4 *)0x0) {
    psX509FreeDNStruct(param_1 + 0x2e,*param_1);
    x509FreeExtensions(param_1 + 0x4f);
    __ptr = (void **)param_1[0x88];
    while (__ptr != (void **)0x0) {
      ppvVar1 = (void **)__ptr[0xd];
      free(*__ptr);
      free(__ptr);
      __ptr = ppvVar1;
    }
    param_1[0x88] = 0;
    free((void *)param_1[0x2c]);
    free((void *)param_1[0x2a]);
    memset(param_1,0,0x228);
    (*(code *)(undefined *)0x0)(param_1);
    (*(code *)(undefined *)0x0)();
    FUN_00408660();
    return;
  }
  return;
}



void psCrlClose(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  
  psLockMutex(&DAT_004dad78);
  iVar6 = DAT_004d79dc;
  iVar4 = DAT_004d79dc;
joined_r0x004850a0:
  do {
    do {
      DAT_004d79dc = iVar4;
      iVar1 = iVar6;
      if (iVar1 == 0) {
        if (DAT_004d79dc == 0) {
          psUnlockMutex(&DAT_004dad78);
        }
        else {
          _psTraceStr("psAssert %s","keyformat/crl.c");
          _psTraceInt(&DAT_0049016c,0xff);
          _psError("g_CRL == NULL");
          psUnlockMutex(&DAT_004dad78);
        }
        (*(code *)(undefined *)0x0)(&DAT_004dad78);
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        (*(code *)(undefined *)0x0)();
        FUN_00408660();
        return;
      }
      iVar6 = *(int *)(iVar1 + 0x224);
      iVar4 = DAT_004d79dc;
    } while ((DAT_004d79dc == 0) || (iVar1 == 0));
    iVar4 = *(int *)(DAT_004d79dc + 0x224);
    iVar2 = DAT_004d79dc;
    iVar5 = 0;
    while (iVar3 = iVar2, iVar3 != iVar1) {
      iVar2 = *(int *)(iVar3 + 0x224);
      iVar4 = DAT_004d79dc;
      if (iVar2 == 0) goto joined_r0x004850a0;
      iVar4 = *(int *)(iVar2 + 0x224);
      iVar5 = iVar3;
    }
    FUN_00484f2c();
    if (iVar5 != 0) {
      *(int *)(iVar5 + 0x224) = iVar4;
      iVar4 = DAT_004d79dc;
    }
  } while( true );
}



undefined4 psCRL_determineRevokedStatusBDT(int param_1,undefined4 *param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  int local_28;
  undefined4 local_24;
  
  if (param_1 == 0) {
    return 0;
  }
  psLockMutex(&DAT_004dad78);
  iVar1 = FUN_00484d44(param_1);
  if (iVar1 == 0) {
    if (*(int *)(param_1 + 0x2a4) == 0) {
      *(undefined4 *)(param_1 + 0x2b8) = 6;
    }
    else {
      *(undefined4 *)(param_1 + 0x2b8) = 5;
    }
    goto LAB_0048536c;
  }
  if (*(short *)(iVar1 + 0xb6) != 0) {
    *(undefined4 *)(param_1 + 0x2b8) = 0xb;
    goto LAB_0048536c;
  }
  if ((*(int *)(iVar1 + 4) == 0) && (iVar4 = *(int *)(param_1 + 0x31c), iVar4 != 0)) {
    local_28 = 0;
    *(undefined4 *)(iVar1 + 4) = 0;
    if ((*(uint *)(iVar4 + 0x1e4) >> 1 & 1) != 0) {
      iVar3 = memcmpct(iVar1 + 0xd8,iVar4 + 0x148,0x14);
      if (iVar3 == 0) {
        local_24 = 0;
        iVar4 = psVerifySig(0,iVar1 + 8,*(undefined2 *)(iVar1 + 0x48),*(undefined4 *)(iVar1 + 0xb0),
                            *(undefined2 *)(iVar1 + 0xb4),iVar4 + 0x28,*(undefined4 *)(iVar1 + 0xac)
                            ,&local_28,&local_24);
        if ((iVar4 == 0) && (local_28 == 1)) {
          *(undefined4 *)(iVar1 + 4) = 1;
        }
      }
    }
  }
  iVar4 = -1;
  if (param_1 == 0) {
LAB_0048546c:
    if ((iVar4 == 1) && (*(int *)(iVar1 + 4) == 1)) {
      *(undefined4 *)(param_1 + 0x2b8) = 9;
      goto LAB_0048536c;
    }
    if ((iVar4 != 1) || (uVar8 = 10, *(int *)(iVar1 + 4) != 0)) goto LAB_0048536c;
  }
  else {
    iVar3 = iVar1;
    if (iVar1 == 0) {
      iVar3 = FUN_00484d44(param_1);
      iVar4 = -1;
      if (iVar3 == 0) goto LAB_0048546c;
    }
    puVar2 = *(undefined4 **)(iVar3 + 0x220);
    if (puVar2 != (undefined4 *)0x0) {
LAB_004852d8:
      if ((*(short *)(param_1 + 0xa0) != *(short *)(puVar2 + 1)) ||
         (iVar4 = memcmpct(*(undefined4 *)(param_1 + 0x9c),*puVar2,*(short *)(param_1 + 0xa0)),
         iVar4 != 0)) goto LAB_004852c8;
      if (param_2 != (undefined4 *)0x0) {
        puVar6 = puVar2 + 2;
        do {
          puVar7 = param_2;
          puVar5 = puVar6;
          uVar10 = puVar5[1];
          uVar9 = puVar5[2];
          uVar8 = puVar5[3];
          puVar6 = puVar5 + 4;
          *puVar7 = *puVar5;
          puVar7[1] = uVar10;
          puVar7[2] = uVar9;
          puVar7[3] = uVar8;
          param_2 = puVar7 + 4;
        } while (puVar6 != puVar2 + 10);
        uVar8 = *puVar6;
        uVar9 = puVar5[5];
        puVar7[6] = puVar5[6];
        puVar7[4] = uVar8;
        puVar7[5] = uVar9;
      }
      iVar4 = 1;
      goto LAB_0048546c;
    }
LAB_00485450:
    iVar4 = 0;
    if (*(int *)(iVar1 + 4) == 1) {
      *(undefined4 *)(param_1 + 0x2b8) = 7;
      goto LAB_0048536c;
    }
    uVar8 = 8;
    if (*(int *)(iVar1 + 4) != 0) goto LAB_0048546c;
  }
  *(undefined4 *)(param_1 + 0x2b8) = uVar8;
LAB_0048536c:
  psUnlockMutex(&DAT_004dad78);
  return *(undefined4 *)(param_1 + 0x2b8);
LAB_004852c8:
  puVar2 = (undefined4 *)puVar2[0xd];
  if (puVar2 == (undefined4 *)0x0) goto LAB_00485450;
  goto LAB_004852d8;
}



// WARNING: Removing unreachable block (ram,0x00485310)
// WARNING: Removing unreachable block (ram,0x00485318)
// WARNING: Removing unreachable block (ram,0x00485344)

undefined4 psCRL_determineRevokedStatus(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int iVar4;
  int iVar5;
  int iStack_28;
  undefined4 uStack_24;
  
  if (param_1 == 0) {
    return 0;
  }
  psLockMutex(&DAT_004dad78);
  iVar1 = FUN_00484d44(param_1);
  if (iVar1 == 0) {
    if (*(int *)(param_1 + 0x2a4) == 0) {
      *(undefined4 *)(param_1 + 0x2b8) = 6;
    }
    else {
      *(undefined4 *)(param_1 + 0x2b8) = 5;
    }
    goto LAB_0048536c;
  }
  if (*(short *)(iVar1 + 0xb6) != 0) {
    *(undefined4 *)(param_1 + 0x2b8) = 0xb;
    goto LAB_0048536c;
  }
  if ((*(int *)(iVar1 + 4) == 0) && (iVar5 = *(int *)(param_1 + 0x31c), iVar5 != 0)) {
    iStack_28 = 0;
    *(undefined4 *)(iVar1 + 4) = 0;
    if ((*(uint *)(iVar5 + 0x1e4) >> 1 & 1) != 0) {
      iVar4 = memcmpct(iVar1 + 0xd8,iVar5 + 0x148,0x14);
      if (iVar4 == 0) {
        uStack_24 = 0;
        iVar5 = psVerifySig(0,iVar1 + 8,*(undefined2 *)(iVar1 + 0x48),*(undefined4 *)(iVar1 + 0xb0),
                            *(undefined2 *)(iVar1 + 0xb4),iVar5 + 0x28,*(undefined4 *)(iVar1 + 0xac)
                            ,&iStack_28,&uStack_24);
        if ((iVar5 == 0) && (iStack_28 == 1)) {
          *(undefined4 *)(iVar1 + 4) = 1;
        }
      }
    }
  }
  iVar5 = -1;
  if (param_1 == 0) {
LAB_0048546c:
    if ((iVar5 == 1) && (*(int *)(iVar1 + 4) == 1)) {
      *(undefined4 *)(param_1 + 0x2b8) = 9;
      goto LAB_0048536c;
    }
    if ((iVar5 != 1) || (uVar3 = 10, *(int *)(iVar1 + 4) != 0)) goto LAB_0048536c;
  }
  else {
    iVar4 = iVar1;
    if (iVar1 == 0) {
      iVar4 = FUN_00484d44(param_1);
      iVar5 = -1;
      if (iVar4 == 0) goto LAB_0048546c;
    }
    for (puVar2 = *(undefined4 **)(iVar4 + 0x220); puVar2 != (undefined4 *)0x0;
        puVar2 = (undefined4 *)puVar2[0xd]) {
      if ((*(short *)(param_1 + 0xa0) == *(short *)(puVar2 + 1)) &&
         (iVar5 = memcmpct(*(undefined4 *)(param_1 + 0x9c),*puVar2,*(short *)(param_1 + 0xa0)),
         iVar5 == 0)) {
        iVar5 = 1;
        goto LAB_0048546c;
      }
    }
    iVar5 = 0;
    if (*(int *)(iVar1 + 4) == 1) {
      *(undefined4 *)(param_1 + 0x2b8) = 7;
      goto LAB_0048536c;
    }
    uVar3 = 8;
    if (*(int *)(iVar1 + 4) != 0) goto LAB_0048546c;
  }
  *(undefined4 *)(param_1 + 0x2b8) = uVar3;
LAB_0048536c:
  psUnlockMutex(&DAT_004dad78);
  return *(undefined4 *)(param_1 + 0x2b8);
}



undefined memset_s(undefined *param_1,uint param_2,int param_3,uint param_4)

{
  uint local_resc;
  
  local_resc = param_4;
  if (param_2 < param_4) {
    local_resc = param_2;
  }
  memset(param_1,param_3,local_resc);
  return *param_1;
}



void psCoreClose(void)

{
  if (DAT_004d79e0 == 'Y') {
    DAT_004d79e0 = 0x4e;
    psDestroyMutex((pthread_mutex_t *)&DAT_004dad90);
    osdepMutexClose();
    osdepEntropyClose();
    return;
  }
  return;
}



byte memcmpct(int param_1,int param_2,int param_3)

{
  byte bVar1;
  
  bVar1 = 0;
  while (param_3 != 0) {
    param_3 = param_3 + -1;
    bVar1 = bVar1 | *(byte *)(param_1 + param_3) ^ *(byte *)(param_2 + param_3);
  }
  return bVar1;
}



void _psErrorStr(void)

{
  int iVar1;
  
  _psTraceStr();
  iVar1 = _psGetTraceFile();
  if (iVar1 == 0) {
    return;
  }
  (*(code *)(undefined *)0x0)("\n",iVar1);
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



undefined4 psCoreOpen(char *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  uVar2 = 1;
  if (DAT_004d79e0 != 'Y') {
    strncpy(&DAT_004d79e0,"YYNY",0x1f);
    iVar1 = strncmp(&DAT_004d79e0,param_1,4);
    if (iVar1 == 0) {
      iVar1 = osdepTimeOpen();
      uVar2 = 0xffffffff;
      if (-1 < iVar1) {
        iVar1 = osdepEntropyOpen();
        if (-1 < iVar1) {
          iVar1 = osdepMutexOpen();
          if (-1 < iVar1) {
            iVar1 = psCreateMutex(&DAT_004dad90,0);
            if (-1 < iVar1) {
              return 0;
            }
            osdepMutexClose();
          }
          osdepEntropyClose();
        }
        osdepTimeClose();
        uVar2 = 0xffffffff;
      }
    }
    else {
      _psTraceStr("psError %s","corelib.c");
      _psTraceInt(&DAT_0049016c,0x41);
      _psTraceStr("Core config mismatch.\nLibrary: YYNY\nCurrent: %s\n",param_1);
      _psTrace("\n");
      uVar2 = 0xffffffff;
    }
  }
  return uVar2;
}



void _psError(void)

{
  int iVar1;
  
  _psTrace();
  iVar1 = _psGetTraceFile();
  if (iVar1 == 0) {
    return;
  }
  (*(code *)(undefined *)0x0)("\n",iVar1);
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



void _psErrorInt(void)

{
  int iVar1;
  
  _psTraceInt();
  iVar1 = _psGetTraceFile();
  if (iVar1 == 0) {
    return;
  }
  (*(code *)(undefined *)0x0)("\n",iVar1);
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



void psFreeList(void **param_1)

{
  void **ppvVar1;
  
  if (param_1 != (void **)0x0) {
    do {
      while( true ) {
        ppvVar1 = (void **)param_1[1];
        if (*param_1 == (void *)0x0) break;
        free(*param_1);
        free(param_1);
        param_1 = ppvVar1;
        if (ppvVar1 == (void **)0x0) {
          return;
        }
      }
      free(param_1);
      param_1 = ppvVar1;
    } while (ppvVar1 != (void **)0x0);
  }
  return;
}



undefined4 psParseList(undefined4 param_1,char *param_2,char param_3,undefined4 *param_4)

{
  char cVar1;
  size_t sVar2;
  void **__ptr;
  void *__s;
  void **ppvVar3;
  undefined4 uVar4;
  char *pcVar5;
  void **ppvVar6;
  int iVar7;
  
  *param_4 = 0;
  sVar2 = strlen(param_2);
  iVar7 = sVar2 + 1;
  uVar4 = 0xfffffffa;
  if (sVar2 != 0) {
    __ptr = (void **)malloc(0xc);
    uVar4 = 0xfffffff8;
    if (__ptr != (void **)0x0) {
      *__ptr = (void *)0x0;
      __ptr[1] = (void *)0x0;
      __ptr[2] = (void *)0x0;
      ppvVar6 = (void **)0x0;
      ppvVar3 = __ptr;
      for (; iVar7 != 0; iVar7 = iVar7 + -1) {
        sVar2 = 0;
        if (ppvVar3 == (void **)0x0) {
          ppvVar3 = (void **)malloc(0xc);
          if (ppvVar3 == (void **)0x0) {
            do {
              ppvVar6 = (void **)__ptr[1];
              if (*__ptr != (void *)0x0) {
                free(*__ptr);
              }
              free(__ptr);
              __ptr = ppvVar6;
            } while (ppvVar6 != (void **)0x0);
            return 0xfffffff8;
          }
          *ppvVar3 = (void *)0x0;
          ppvVar3[1] = (void *)0x0;
          ppvVar3[2] = (void *)0x0;
          ppvVar6[1] = ppvVar3;
        }
        cVar1 = *param_2;
        pcVar5 = param_2;
        while ((cVar1 != param_3 && (cVar1 != '\0'))) {
          pcVar5 = pcVar5 + 1;
          sVar2 = sVar2 + 1;
          iVar7 = iVar7 + -1;
          cVar1 = *pcVar5;
        }
        __s = malloc(sVar2 + 1);
        *ppvVar3 = __s;
        if (__s == (void *)0x0) {
          do {
            ppvVar6 = (void **)__ptr[1];
            if (*__ptr == (void *)0x0) {
              free(__ptr);
            }
            else {
              free(*__ptr);
              free(__ptr);
            }
            __ptr = ppvVar6;
          } while (ppvVar6 != (void **)0x0);
          return 0xfffffff8;
        }
        *(short *)(ppvVar3 + 2) = (short)sVar2;
        memset(__s,0,sVar2 + 1);
        memcpy(*ppvVar3,param_2,sVar2);
        param_2 = pcVar5 + 1;
        ppvVar6 = ppvVar3;
        ppvVar3 = (void **)ppvVar3[1];
      }
      *param_4 = __ptr;
      uVar4 = 0;
    }
  }
  return uVar4;
}



void psBurnStack(uint param_1)

{
  undefined auStack_28 [32];
  
  memset_s(auStack_28,0x20,0,0x20);
  if (param_1 < 0x21) {
    return;
  }
  psBurnStack(param_1 - 0x20);
  return;
}



undefined4 psBrokenDownTimeAdd(int *param_1,int param_2)

{
  undefined4 uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  
  uVar1 = 0xffffffff;
  if (-1 < param_2) {
    if (0x34aadc80 < param_2) {
      iVar3 = param_1[5];
      do {
        param_2 = param_2 + -0x34aadc80;
        iVar3 = iVar3 + 0x1c;
      } while (0x34aadc80 < param_2);
      param_1[5] = iVar3;
    }
    uVar1 = 0;
    if (param_2 != 0) {
      param_2 = *param_1 + param_2;
      if (param_2 < 0x3c) {
        iVar3 = param_1[1];
        *param_1 = param_2;
      }
      else {
        iVar3 = param_1[1] + param_2 / 0x3c;
        *param_1 = param_2 % 0x3c;
        param_1[1] = iVar3;
      }
      if (iVar3 < 0x3c) {
        iVar7 = param_1[2];
      }
      else {
        iVar7 = param_1[2] + iVar3 / 0x3c;
        param_1[1] = iVar3 % 0x3c;
        param_1[2] = iVar7;
      }
      if (iVar7 < 0x18) {
        iVar3 = param_1[3];
      }
      else {
        iVar4 = iVar7 / 0x18;
        iVar7 = iVar7 % 0x18;
        iVar3 = param_1[3] + iVar4;
        param_1[3] = iVar3;
        param_1[2] = iVar7;
        param_1[6] = (param_1[6] + iVar4) % 7;
      }
      iVar4 = param_1[4];
      do {
        uVar2 = 0xffffffff;
        if ((iVar4 < 0xc) && (uVar2 = (uint)(byte)(&DAT_004d7a00)[iVar4], uVar2 == 0x1c)) {
          uVar6 = param_1[5] + 0x76c;
          iVar5 = 0;
          if ((uVar6 & 3) == 0) {
            if ((uVar6 == ((int)uVar6 / 100) * 100) && (uVar6 != ((int)uVar6 / 400) * 400))
            goto LAB_00485e84;
            iVar5 = 1;
          }
          uVar2 = iVar5 + 0x1c;
        }
LAB_00485e84:
        if (iVar3 <= (int)uVar2) {
          return 0;
        }
        uVar2 = 0xffffffff;
        if ((iVar4 < 0xc) && (uVar2 = (uint)(byte)(&DAT_004d7a00)[iVar4], uVar2 == 0x1c)) {
          uVar6 = param_1[5] + 0x76c;
          iVar5 = 0;
          if ((uVar6 & 3) == 0) {
            if ((uVar6 == ((int)uVar6 / 100) * 100) && (uVar6 != ((int)uVar6 / 400) * 400))
            goto LAB_00485eb4;
            iVar5 = 1;
          }
          uVar2 = iVar5 + 0x1c;
        }
LAB_00485eb4:
        iVar5 = iVar4 + 1;
        iVar3 = iVar3 - uVar2;
        param_1[3] = iVar3;
        if (0xb < iVar5) {
          iVar5 = iVar4 + -0xb;
          param_1[5] = param_1[5] + 1;
        }
        param_1[4] = iVar5;
        iVar7 = iVar7 % 0x3c;
        param_1[2] = iVar7;
        iVar4 = iVar5;
      } while( true );
    }
  }
  return uVar1;
}



int psGetBrokenDownGMTime(tm *param_1,int param_2)

{
  time_t tVar1;
  tm *ptVar2;
  int iVar3;
  int local_20 [2];
  
  tVar1 = time((time_t *)0x0);
  iVar3 = -1;
  if (tVar1 != -1) {
    if (((param_2 < 0) && (tVar1 < tVar1 + param_2)) || (local_20[0] = tVar1 + param_2, 0 < param_2)
       ) {
      local_20[0] = tVar1;
    }
    ptVar2 = gmtime_r(local_20,param_1);
    iVar3 = -1;
    if (ptVar2 != (tm *)0x0) {
      iVar3 = 0;
    }
    if ((local_20[0] < 0) && (param_1->tm_year < 0x46)) {
      psBrokenDownTimeAdd(param_1,0x6955b900);
      psBrokenDownTimeAdd(param_1,0x6955b900);
      psBrokenDownTimeAdd(param_1,0x2d548e00);
    }
    if ((iVar3 == 0) && (0 < param_2)) {
      iVar3 = psBrokenDownTimeAdd(param_1,param_2);
    }
  }
  return iVar3;
}



undefined4 psBrokenDownTimeImport(uint *param_1,byte *param_2,uint param_3,uint param_4)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  byte *pbVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint local_38 [12];
  byte *local_8;
  
  if (0xff < param_3) {
    return 0xffffffff;
  }
  iVar2 = 2;
  if ((param_4 >> 1 & 1) == 0) {
    iVar2 = 4;
  }
  if (param_1 == (uint *)0x0) {
    param_1 = local_38;
  }
  else {
    *param_1 = 0;
    param_1[1] = 0;
    param_1[2] = 0;
    param_1[3] = 0;
    param_1[4] = 0;
    param_1[5] = 0;
    param_1[6] = 0;
    param_1[7] = 0;
    param_1[8] = 0;
    param_1[9] = 0;
    param_1[10] = 0;
  }
  local_8 = param_2;
  if (iVar2 == 4) {
    if ((param_3 != 0xf) && ((param_4 & 1) != 0)) {
      return 0xffffffff;
    }
    if ((param_3 < 0xe) && ((param_4 & 1) == 0)) {
      return 0xffffffff;
    }
    iVar2 = 4;
    uVar8 = 0;
    do {
      bVar1 = *local_8;
      iVar2 = iVar2 + -1;
      uVar8 = ((uint)bVar1 + uVar8 * 10) - 0x30;
      local_8 = local_8 + 1;
      pbVar6 = param_2;
      if (9 < (bVar1 - 0x30 & 0xff)) goto LAB_00486650;
    } while (iVar2 != 0);
    pbVar6 = local_8;
    if ((uVar8 < 0x76c) || (2999 < uVar8)) {
LAB_00486650:
      local_8 = pbVar6;
      uVar8 = 0xffffffff;
    }
  }
  else {
    if (iVar2 != 2) {
      return 0xffffffff;
    }
    if ((param_3 != 0xd) && ((param_4 & 1) != 0)) {
      return 0xffffffff;
    }
    if ((param_3 < 0xc) && ((param_4 & 1) == 0)) {
      return 0xffffffff;
    }
    iVar2 = 2;
    uVar5 = 0;
    do {
      bVar1 = *local_8;
      iVar2 = iVar2 + -1;
      uVar5 = ((uint)bVar1 + uVar5 * 10) - 0x30;
      local_8 = local_8 + 1;
      pbVar6 = param_2;
      if (9 < (bVar1 - 0x30 & 0xff)) goto LAB_00486650;
    } while (iVar2 != 0);
    uVar8 = 0xffffffff;
    if (uVar5 < 100) {
      uVar8 = uVar5;
    }
  }
  if (uVar8 == 0xffffffff) {
    return 0xffffffff;
  }
  iVar2 = 2;
  uVar5 = 0;
  pbVar6 = local_8;
  do {
    bVar1 = *pbVar6;
    iVar2 = iVar2 + -1;
    uVar5 = ((uint)bVar1 + uVar5 * 10) - 0x30;
    pbVar6 = pbVar6 + 1;
    if (9 < (bVar1 - 0x30 & 0xff)) goto LAB_00486648;
  } while (iVar2 != 0);
  local_8 = pbVar6;
  if ((uVar5 == 0) || (0xc < uVar5)) {
LAB_00486648:
    uVar5 = 0xffffffff;
  }
  uVar3 = 0;
  if (uVar5 == 0xffffffff) {
    return 0xffffffff;
  }
  iVar2 = 2;
  pbVar6 = local_8;
  do {
    bVar1 = *pbVar6;
    iVar2 = iVar2 + -1;
    uVar3 = ((uint)bVar1 + uVar3 * 10) - 0x30;
    pbVar6 = pbVar6 + 1;
    if (9 < (bVar1 - 0x30 & 0xff)) goto LAB_00486658;
  } while (iVar2 != 0);
  local_8 = pbVar6;
  if ((uVar3 == 0) || (0x1f < uVar3)) {
LAB_00486658:
    uVar3 = 0xffffffff;
  }
  uVar4 = 0;
  if (uVar3 != 0xffffffff) {
    iVar2 = 2;
    pbVar6 = local_8;
    do {
      bVar1 = *pbVar6;
      iVar2 = iVar2 + -1;
      uVar4 = ((uint)bVar1 + uVar4 * 10) - 0x30;
      pbVar6 = pbVar6 + 1;
      if (9 < (bVar1 - 0x30 & 0xff)) {
        uVar10 = 0xffffffff;
        goto LAB_00486438;
      }
    } while (iVar2 != 0);
    uVar10 = 0xffffffff;
    local_8 = pbVar6;
    if (uVar4 < 0x18) {
      uVar10 = uVar4;
    }
LAB_00486438:
    uVar4 = 0;
    if (uVar10 == 0xffffffff) {
      return 0xffffffff;
    }
    iVar2 = 2;
    pbVar6 = local_8;
    do {
      bVar1 = *pbVar6;
      iVar2 = iVar2 + -1;
      uVar4 = ((uint)bVar1 + uVar4 * 10) - 0x30;
      pbVar6 = pbVar6 + 1;
      if (9 < (bVar1 - 0x30 & 0xff)) {
        uVar9 = 0xffffffff;
        goto LAB_0048649c;
      }
    } while (iVar2 != 0);
    uVar9 = 0xffffffff;
    local_8 = pbVar6;
    if (uVar4 < 0x3c) {
      uVar9 = uVar4;
    }
LAB_0048649c:
    uVar4 = 0;
    if (uVar9 == 0xffffffff) {
      return 0xffffffff;
    }
    iVar2 = 2;
    pbVar6 = local_8;
    do {
      bVar1 = *pbVar6;
      iVar2 = iVar2 + -1;
      uVar4 = ((uint)bVar1 + uVar4 * 10) - 0x30;
      pbVar6 = pbVar6 + 1;
      if (9 < (bVar1 - 0x30 & 0xff)) {
        uVar7 = 0xffffffff;
        goto LAB_00486500;
      }
    } while (iVar2 != 0);
    uVar7 = 0xffffffff;
    local_8 = pbVar6;
    if (uVar4 < 0x3d) {
      uVar7 = uVar4;
    }
LAB_00486500:
    if ((uVar7 != 0xffffffff) && (((param_4 & 1) == 0 || (*local_8 == 0x5a)))) {
      if (uVar8 < 0x32) {
        uVar8 = uVar8 + 100;
      }
      else if (uVar8 < 0x76c) {
        if (99 < uVar8) {
          return 0xffffffff;
        }
      }
      else {
        uVar8 = uVar8 - 0x76c;
      }
      param_1[2] = uVar10;
      param_1[1] = uVar9;
      *param_1 = uVar7;
      param_1[5] = uVar8;
      param_1[4] = uVar5 - 1;
      param_1[3] = uVar3;
      uVar4 = 0xffffffff;
      if ((int)(uVar5 - 1) < 0xc) {
        uVar4 = (uint)*(byte *)(uVar5 + 0x4d79ff);
        uVar8 = uVar8 + 0x76c;
        if (uVar4 == 0x1c) {
          iVar2 = 0;
          if (((uVar8 & 3) == 0) &&
             ((uVar8 != ((int)uVar8 / 100) * 100 || (uVar8 == ((int)uVar8 / 400) * 400)))) {
            iVar2 = 1;
          }
          uVar4 = iVar2 + 0x1c;
        }
      }
      if ((int)uVar3 <= (int)uVar4) {
        return 0;
      }
      param_1[10] = 0;
      *param_1 = 0;
      param_1[1] = 0;
      param_1[2] = 0;
      param_1[3] = 0;
      param_1[4] = 0;
      param_1[5] = 0;
      param_1[6] = 0;
      param_1[7] = 0;
      param_1[8] = 0;
      param_1[9] = 0;
      return 0xffffffff;
    }
  }
  return 0xffffffff;
}



void psBrokenDownTimeCmp(tm *param_1,tm *param_2)

{
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  
  local_38 = 0x21;
  local_2c = 0;
  local_30 = 0;
  local_34 = 0;
  local_28 = 0;
  local_24 = 0;
  local_20 = 0;
  local_1c = 0;
  strftime((char *)&local_38,0x10,"%Y%m%d%H%M%SZ",param_1);
  strftime((char *)&local_28,0x10,"%Y%m%d%H%M%SZ",param_2);
  memcmp(&local_38,&local_28,0x10);
  return;
}



int psToUtf8String(undefined4 param_1,undefined4 param_2,uint param_3,uint param_4,int *param_5,
                  int *param_6,uint param_7)

{
  char cVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  char *pcVar5;
  undefined *puVar6;
  int iVar7;
  int iVar8;
  undefined auStack_78 [4];
  char *local_74;
  char *local_70;
  int local_64;
  undefined auStack_58 [32];
  char local_38 [8];
  char local_30;
  char local_2f;
  int aiStack_28 [2];
  
  iVar8 = 1;
  iVar7 = -10;
  if ((param_7 & 0xfffffffd) == 0) {
    if ((param_4 < 0x12) || ((0x13 < param_4 && (iVar8 = 2, param_4 != 0x1e)))) {
      return -10;
    }
    if (((iVar8 != 2) || (iVar7 = -1, (param_3 & 1) == 0)) &&
       (iVar3 = psParseBufFromStaticData(auStack_78,param_2,param_3), iVar7 = iVar3, iVar3 == 0)) {
      iVar4 = psDynBufInit(param_1,auStack_58,param_3 + 2);
      iVar7 = -8;
      if (iVar4 != 0) {
        if (iVar8 == 1) {
          while ((local_64 == 0 && (local_70 != local_74))) {
            cVar1 = *local_74;
            local_38[0] = cVar1;
            if (cVar1 < '\x01') {
              iVar3 = -9;
            }
            else {
              pcVar5 = (char *)psDynBufAppendSize(auStack_58,1);
              if (pcVar5 != (char *)0x0) {
                *pcVar5 = cVar1;
              }
            }
            psParseBufSkipBytes(auStack_78,local_38,1);
          }
        }
        else {
          while ((local_64 == 0 && (1 < (uint)((int)local_70 - (int)local_74)))) {
            local_30 = *local_74;
            local_2f = local_74[1];
            sVar2 = CONCAT11(local_30,local_2f);
            if ((sVar2 == 0) || ((ushort)(sVar2 + 0x2800U) < 0x800)) {
              iVar3 = -9;
            }
            else {
              psDynBufAppendUtf8(auStack_58,sVar2);
            }
            psParseBufSkipBytes(auStack_78,&local_30,2);
          }
        }
        if (param_6 == (int *)0x0) {
          param_6 = aiStack_28;
        }
        puVar6 = (undefined *)psDynBufAppendSize(auStack_58,1);
        if (puVar6 != (undefined *)0x0) {
          *puVar6 = 0;
        }
        if (((param_7 >> 1 & 1) != 0) &&
           (puVar6 = (undefined *)psDynBufAppendSize(auStack_58,1), puVar6 != (undefined *)0x0)) {
          *puVar6 = 0;
        }
        if (iVar3 == 0) {
          iVar8 = psDynBufDetach(auStack_58,param_6);
          iVar4 = *param_6;
          *param_5 = iVar8;
          iVar7 = iVar4 + -2;
          if ((param_7 >> 1 & 1) == 0) {
            iVar7 = iVar4 + -1;
          }
          *param_6 = iVar7;
          iVar7 = -8;
          if (iVar8 != 0) {
            iVar7 = iVar3;
          }
        }
        else {
          psDynBufUninit(auStack_58);
          iVar7 = iVar3;
        }
      }
    }
  }
  return iVar7;
}



void psDynBufInit(void *param_1,void **param_2,void *param_3)

{
  void *pvVar1;
  
  pvVar1 = malloc((size_t)param_3);
  *param_2 = pvVar1;
  param_2[1] = pvVar1;
  param_2[2] = pvVar1;
  if (pvVar1 != (void *)0x0) {
    param_2[3] = param_3;
    param_2[4] = param_1;
    param_2[5] = (void *)(uint)(*param_2 == (void *)0x0);
    param_2[6] = (void *)0x0;
    return;
  }
  param_2[3] = (void *)0x0;
  param_2[4] = param_1;
  param_2[5] = (void *)(uint)(*param_2 == (void *)0x0);
  param_2[6] = (void *)0x0;
  return;
}



void psDynBufUninit(void **param_1)

{
  if ((undefined **)param_1[4] != &psStaticAllocationsPool) {
    free(*param_1);
  }
  param_1[6] = (void *)0x0;
  *param_1 = (void *)0x0;
  param_1[1] = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[3] = (void *)0x0;
  param_1[5] = (void *)0x0;
  param_1[4] = (void *)0x0;
  return;
}



void * psDynBufDetach(void **param_1,size_t *param_2)

{
  void *__dest;
  size_t __size;
  size_t __n;
  undefined **ppuVar1;
  
  if (param_1[5] == (void *)0x0) {
    ppuVar1 = (undefined **)param_1[4];
    __n = (int)param_1[2] - (int)param_1[1];
    __size = __n;
    if (__n == 0) {
      __size = 1;
    }
    __dest = malloc(__size);
    if (__dest != (void *)0x0) {
      memcpy(__dest,param_1[1],__n);
      *param_2 = __n;
    }
    if (ppuVar1 != &psStaticAllocationsPool) {
      free(*param_1);
    }
    param_1[4] = (void *)0x0;
    *param_1 = (void *)0x0;
    param_1[1] = (void *)0x0;
    param_1[2] = (void *)0x0;
    param_1[3] = (void *)0x0;
    return __dest;
  }
  if ((undefined **)param_1[4] != &psStaticAllocationsPool) {
    free(*param_1);
  }
  param_1[6] = (void *)0x0;
  *param_1 = (void *)0x0;
  param_1[1] = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[3] = (void *)0x0;
  param_1[5] = (void *)0x0;
  param_1[4] = (void *)0x0;
  return (void *)0x0;
}



void FUN_00486d88(uint *param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = param_1[6];
  if (uVar3 == 0) {
    __assert("sub->master != ((void *)0)","psbuf.c",0x124);
    uVar3 = param_1[6];
  }
  if (param_1[4] != 0) {
    __assert("sub->pool == ((void *)0)","psbuf.c",0x129);
  }
  uVar1 = *param_1;
  uVar2 = *(uint *)(uVar3 + 4);
  if ((uVar1 < uVar2) || (*(uint *)(uVar3 + 8) < uVar1)) {
    __assert("sub->buf.buf >= db->buf.start && sub->buf.buf <= db->buf.end","psbuf.c",300);
    uVar1 = *param_1;
    uVar2 = *(uint *)(uVar3 + 4);
  }
  if ((uVar2 <= uVar1 + param_1[3]) && (uVar1 + param_1[3] <= *(uint *)(uVar3 + 8))) {
    return;
  }
  (*(code *)(undefined *)0x0)
            ("sub->buf.buf + sub->buf.size >= db->buf.start && sub->buf.buf + sub->buf.size <= db->buf.end"
             ,"psbuf.c",0x12e,"assert_subbuf");
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



void * FUN_00486f04(void **param_1,int param_2,uint param_3)

{
  void *pvVar1;
  int iVar2;
  void *pvVar3;
  void *pvVar4;
  void *pvVar5;
  int iVar6;
  void *pvVar7;
  size_t __n;
  size_t __n_00;
  int iVar8;
  void *local_3c;
  void *local_38;
  
  pvVar5 = *param_1;
  pvVar3 = param_1[1];
  __n_00 = (int)param_1[2] - (int)pvVar3;
  iVar8 = ((int)pvVar5 + (int)param_1[3]) - (int)param_1[2];
  if (param_1[5] != (void *)0x0) {
    return (void *)0x0;
  }
  if (param_2 - 1U < 0xff) {
    param_2 = 0x100;
  }
  if (param_3 < 0x100) {
    param_3 = 0x100;
  }
  pvVar1 = param_1[6];
  iVar6 = (int)pvVar3 + (param_2 - (int)pvVar5);
  if (pvVar1 != (void *)0x0) {
    iVar6 = *(int *)((int)pvVar1 + 4);
    __n = *(int *)((int)pvVar1 + 8) - ((int)pvVar5 + (int)param_1[3]);
    FUN_00486d88();
    pvVar1 = (void *)FUN_00486f04(param_1[6],0,param_2 + param_3);
    if (pvVar1 == (void *)0x0) {
      param_1[5] = (void *)((int)param_1[5] + 1);
    }
    else {
      pvVar4 = param_1[6];
      iVar2 = *(int *)((int)pvVar4 + 8) + param_2 + param_3;
      *(int *)((int)pvVar4 + 8) = iVar2;
      if (__n != 0) {
        pvVar4 = (void *)(iVar2 - __n);
        memmove(pvVar4,(void *)((int)pvVar4 + (-param_3 - param_2)),__n);
        pvVar4 = param_1[6];
      }
      pvVar7 = (void *)((int)pvVar5 + (*(int *)((int)pvVar4 + 4) - iVar6));
      pvVar4 = (void *)((int)pvVar7 + (int)pvVar3 + (param_2 - (int)pvVar5));
      *param_1 = pvVar7;
      param_1[1] = pvVar4;
      if (param_2 != 0) {
        memmove(pvVar4,(void *)((int)pvVar4 - param_2),__n_00);
      }
      param_1[2] = (void *)((int)param_1[1] + __n_00);
      param_1[3] = (void *)((int)pvVar3 + param_3 + iVar8 + __n_00 + (param_2 - (int)pvVar5));
    }
    FUN_00486d88(param_1);
    return pvVar1;
  }
  pvVar5 = (void *)(iVar6 + __n_00 + param_3 + iVar8);
  pvVar3 = malloc((size_t)pvVar5);
  if (pvVar3 == (void *)0x0) {
    param_1[5] = (void *)((int)param_1[5] + 1);
    return (void *)0x0;
  }
  pvVar1 = (void *)((int)pvVar3 + iVar6);
  pvVar4 = (void *)((int)pvVar3 + (int)pvVar5);
  local_38 = (void *)((int)pvVar3 + __n_00);
  if (pvVar4 < pvVar1) {
    local_3c = pvVar3;
    pvVar1 = pvVar3;
    if (local_38 <= pvVar4) goto LAB_00487208;
LAB_0048711c:
    local_38 = pvVar1;
    pvVar1 = (void *)0x0;
    local_3c = local_38;
  }
  else {
    local_38 = (void *)((int)pvVar1 + __n_00);
    local_3c = (void *)((int)pvVar3 + iVar6);
    if (pvVar4 < local_38) goto LAB_0048711c;
LAB_00487208:
    pvVar1 = local_3c;
    if (local_3c != (void *)0x0) goto LAB_00487150;
  }
  __assert("loc != ((void *)0)","psbuf.c",0x195);
LAB_00487150:
  memcpy(pvVar1,param_1[1],__n_00);
  if ((undefined **)param_1[4] != &psStaticAllocationsPool) {
    free(*param_1);
  }
  *param_1 = pvVar3;
  param_1[3] = pvVar5;
  param_1[1] = local_3c;
  param_1[2] = local_38;
  return pvVar1;
}



int psDynBufAppendSize(int *param_1,int param_2)

{
  int iVar1;
  int iVar2;
  
  iVar2 = param_1[2];
  iVar1 = 0;
  if ((((uint)(*param_1 + param_1[3]) < (uint)(iVar2 + param_2)) ||
      (param_1[2] = iVar2 + param_2, iVar1 = iVar2, iVar2 == 0)) &&
     (iVar2 = iVar1, iVar1 = FUN_00486f04(param_1,0,param_2), iVar1 != 0)) {
    iVar2 = param_1[2];
    iVar1 = 0;
    if (((uint)(*param_1 + param_1[3]) < (uint)(iVar2 + param_2)) ||
       (param_1[2] = iVar2 + param_2, iVar1 = iVar2, iVar2 == 0)) {
      __assert("loc != ((void *)0)","psbuf.c",0x1af);
      return iVar1;
    }
  }
  return iVar2;
}



byte * psDynBufAppendUtf8(int param_1,uint param_2,undefined4 param_3)

{
  byte bVar1;
  byte *pbVar2;
  
  if (param_2 < 0x20000) {
    bVar1 = (byte)param_2;
    if (param_2 < 0x80) {
      pbVar2 = (byte *)psDynBufAppendSize(param_1,1,param_3,param_2 < 0x80,&_gp);
      if (pbVar2 != (byte *)0x0) {
        *pbVar2 = bVar1;
      }
    }
    else if (param_2 < 0x800) {
      pbVar2 = (byte *)psDynBufAppendSize(param_1,2);
      if (pbVar2 != (byte *)0x0) {
        *pbVar2 = (byte)(param_2 >> 6) | 0xc0;
        pbVar2[1] = bVar1 & 0x3f | 0x80;
      }
    }
    else if (param_2 < 0x10000) {
      pbVar2 = (byte *)psDynBufAppendSize(param_1,3);
      if (pbVar2 != (byte *)0x0) {
        *pbVar2 = (byte)(param_2 >> 0xc) | 0xe0;
        pbVar2[1] = (byte)(param_2 >> 6) & 0x3f | 0x80;
        pbVar2[2] = bVar1 & 0x3f | 0x80;
      }
    }
    else {
      pbVar2 = (byte *)psDynBufAppendSize(param_1,4);
      if (pbVar2 != (byte *)0x0) {
        *pbVar2 = (byte)(param_2 >> 0x12) | 0xf0;
        pbVar2[1] = (byte)(param_2 >> 0xc) & 0x3f | 0x80;
        pbVar2[2] = (byte)(param_2 >> 6) & 0x3f | 0x80;
        pbVar2[3] = bVar1 & 0x3f | 0x80;
      }
    }
    return pbVar2;
  }
  *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  return (byte *)0x0;
}



undefined4 psParseBufFromStaticData(int *param_1,int param_2,int param_3)

{
  if (param_2 == 0) {
    param_1[3] = 0;
    param_1[1] = 0;
    param_1[2] = 0;
    *param_1 = 0;
  }
  else {
    param_1[3] = param_3;
    param_1[1] = param_2;
    param_1[2] = param_2 + param_3;
    *param_1 = param_2;
    if (param_2 != 0) {
      param_1[4] = (int)&psStaticAllocationsPool;
      param_1[6] = 0;
      param_1[5] = 0;
      return 0;
    }
  }
  param_1[4] = (int)&psStaticAllocationsPool;
  param_1[6] = 0;
  param_1[5] = 1;
  return 0xfffffffa;
}



uint psParseBufTrySkipBytes(int param_1,void *param_2,uint param_3)

{
  int iVar1;
  void *__s2;
  
  if (*(int *)(param_1 + 0x14) == 0) {
    __s2 = *(void **)(param_1 + 4);
    if ((param_3 <= (uint)(*(int *)(param_1 + 8) - (int)__s2)) &&
       (iVar1 = memcmp(param_2,__s2,param_3), iVar1 == 0)) {
      *(uint *)(param_1 + 4) = (int)__s2 + param_3;
      return param_3;
    }
  }
  else {
    __s2 = *(void **)(param_1 + 4);
  }
  *(void **)(param_1 + 4) = __s2;
  return 0;
}



uint psParseBufSkipBytes(int param_1,void *param_2,uint param_3)

{
  int iVar1;
  void *__s2;
  uint uVar2;
  uint uVar3;
  
  uVar2 = 0;
  uVar3 = uVar2;
  if (*(int *)(param_1 + 0x14) == 0) {
    __s2 = *(void **)(param_1 + 4);
    if ((param_3 <= (uint)(*(int *)(param_1 + 8) - (int)__s2)) &&
       (iVar1 = memcmp(param_2,__s2,param_3), uVar3 = param_3, iVar1 != 0)) goto LAB_004876e8;
  }
  else {
    __s2 = *(void **)(param_1 + 4);
  }
  __s2 = (void *)((int)__s2 + uVar3);
  uVar2 = uVar3;
LAB_004876e8:
  *(void **)(param_1 + 4) = __s2;
  if (uVar2 == 0) {
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  }
  return uVar2;
}



uint psParseBufTryReadTagSub(char *param_1,char **param_2,char param_3)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  char *pcVar5;
  uint uVar6;
  int iVar7;
  undefined auStackX_0 [16];
  char *apcStack_28 [8];
  int local_8;
  
  pcVar5 = *(char **)(param_1 + 4);
  uVar6 = *(int *)(param_1 + 8) - (int)pcVar5;
  iVar4 = 1;
  iVar7 = 2;
  uVar2 = 0;
  if ((1 < uVar6) && ((param_3 == '\0' || (*pcVar5 == param_3)))) {
    bVar1 = pcVar5[1];
    uVar2 = 1;
    if ((char)bVar1 < '\0') {
      uVar2 = 0;
      if ((((uVar6 < 0x83) || ((bVar1 == 0x81 && (-1 < pcVar5[2])))) ||
          ((bVar1 == 0x82 && (uVar2 = 0, pcVar5[2] == '\0')))) ||
         ((((bVar1 == 0x83 && (uVar2 = 0, pcVar5[2] == '\0')) ||
           ((bVar1 == 0x84 && (uVar2 = 0, pcVar5[2] == '\0')))) ||
          ((uVar2 = 0, bVar1 == 0x80 || (0x84 < bVar1)))))) goto LAB_004877a4;
      uVar2 = (uint)(byte)(bVar1 + 0x80);
      iVar4 = 2;
      iVar7 = uVar2 + 2;
    }
    uVar3 = 0;
    for (; uVar2 != 0; uVar2 = uVar2 - 1 & 0xff) {
      uVar3 = uVar3 * 0x100 + (uint)(byte)pcVar5[iVar4];
      iVar4 = iVar4 + 1;
    }
    uVar2 = 0;
    if (((uVar3 < 0x40000001) && (uVar3 = uVar3 + iVar7, uVar3 <= uVar6)) &&
       (uVar2 = uVar3, auStackX_0 != (undefined *)0x8)) {
      local_8 = iVar7;
    }
  }
LAB_004877a4:
  if (param_2 == (char **)0x0) {
    param_2 = apcStack_28;
  }
  if (uVar2 != 0) {
    param_2[6] = param_1;
    pcVar5 = pcVar5 + local_8;
    param_2[2] = pcVar5 + (int)(char *)(uVar2 - local_8);
    param_2[5] = (char *)0x0;
    *param_2 = pcVar5;
    param_2[1] = pcVar5;
    param_2[3] = (char *)(uVar2 - local_8);
    param_2[4] = (char *)0x0;
    return uVar2;
  }
  param_2[6] = param_1;
  param_2[5] = (char *)0x1;
  param_2[2] = (char *)0x0;
  param_2[1] = (char *)0x0;
  *param_2 = (char *)0x0;
  param_2[3] = (char *)0x0;
  param_2[4] = (char *)0x0;
  return 0;
}



uint psParseBufReadTagSub(int *param_1,int *param_2,char param_3)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  char *pcVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  undefined auStackX_0 [16];
  int aiStack_28 [8];
  int local_8;
  
  pcVar6 = (char *)param_1[1];
  uVar7 = param_1[2] - (int)pcVar6;
  iVar5 = 1;
  iVar8 = 2;
  uVar2 = 0;
  if ((1 < uVar7) && ((param_3 == '\0' || (*pcVar6 == param_3)))) {
    bVar1 = pcVar6[1];
    uVar2 = 1;
    if ((char)bVar1 < '\0') {
      uVar2 = 0;
      if ((((uVar7 < 0x83) || ((bVar1 == 0x81 && (-1 < pcVar6[2])))) ||
          ((bVar1 == 0x82 && (uVar2 = 0, pcVar6[2] == '\0')))) ||
         ((((bVar1 == 0x83 && (uVar2 = 0, pcVar6[2] == '\0')) ||
           ((bVar1 == 0x84 && (uVar2 = 0, pcVar6[2] == '\0')))) ||
          ((uVar2 = 0, bVar1 == 0x80 || (0x84 < bVar1)))))) goto LAB_004879a8;
      uVar2 = (uint)(byte)(bVar1 + 0x80);
      iVar5 = 2;
      iVar8 = uVar2 + 2;
    }
    uVar3 = 0;
    for (; uVar2 != 0; uVar2 = uVar2 - 1 & 0xff) {
      uVar3 = uVar3 * 0x100 + (uint)(byte)pcVar6[iVar5];
      iVar5 = iVar5 + 1;
    }
    uVar2 = 0;
    if (((uVar3 < 0x40000001) && (uVar3 = uVar3 + iVar8, uVar3 <= uVar7)) &&
       (uVar2 = uVar3, auStackX_0 != (undefined *)0x8)) {
      local_8 = iVar8;
    }
  }
LAB_004879a8:
  piVar4 = param_2;
  if (param_2 == (int *)0x0) {
    piVar4 = aiStack_28;
  }
  if (uVar2 == 0) {
    piVar4[5] = 1;
    piVar4[6] = (int)param_1;
    piVar4[2] = 0;
    piVar4[1] = 0;
    *piVar4 = 0;
    piVar4[3] = 0;
    piVar4[4] = 0;
    iVar9 = *param_1;
    iVar8 = param_1[1];
    iVar5 = param_1[2];
    param_1[5] = param_1[5] + 1;
    param_2[3] = param_1[3];
    *param_2 = iVar9;
    param_2[1] = iVar8;
    param_2[2] = iVar5;
    return 0;
  }
  iVar5 = param_1[1] + local_8;
  piVar4[2] = iVar5 + (uVar2 - local_8);
  piVar4[6] = (int)param_1;
  piVar4[5] = 0;
  *piVar4 = iVar5;
  piVar4[1] = iVar5;
  piVar4[3] = uVar2 - local_8;
  piVar4[4] = 0;
  return uVar2;
}



uint psParseBufReadTagRef(int param_1,int *param_2,char param_3)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  char *pcVar5;
  int *piVar6;
  uint uVar7;
  int iVar8;
  undefined auStackX_0 [16];
  int local_48;
  int local_44;
  int local_40;
  int local_3c;
  int aiStack_28 [8];
  int local_8;
  
  pcVar5 = *(char **)(param_1 + 4);
  uVar7 = *(int *)(param_1 + 8) - (int)pcVar5;
  piVar6 = &local_48;
  iVar4 = 1;
  iVar8 = 2;
  uVar2 = 0;
  if ((uVar7 < 2) || ((param_3 != '\0' && (*pcVar5 != param_3)))) goto LAB_00487be0;
  bVar1 = pcVar5[1];
  uVar2 = 1;
  if ((char)bVar1 < '\0') {
    uVar2 = 0;
    if ((((uVar7 < 0x83) || ((bVar1 == 0x81 && (-1 < pcVar5[2])))) ||
        ((bVar1 == 0x82 && (uVar2 = 0, pcVar5[2] == '\0')))) ||
       (((bVar1 == 0x83 && (uVar2 = 0, pcVar5[2] == '\0')) ||
        ((bVar1 == 0x84 && (uVar2 = 0, pcVar5[2] == '\0')))))) goto LAB_00487be0;
    if ((bVar1 == 0x80) || (0x84 < bVar1)) {
      uVar2 = 0;
      goto LAB_00487be0;
    }
    uVar2 = (uint)(byte)(bVar1 + 0x80);
    iVar4 = 2;
    iVar8 = uVar2 + 2;
  }
  uVar3 = 0;
  for (; uVar2 != 0; uVar2 = uVar2 - 1 & 0xff) {
    uVar3 = uVar3 * 0x100 + (uint)(byte)pcVar5[iVar4];
    iVar4 = iVar4 + 1;
  }
  uVar2 = 0;
  if (((uVar3 < 0x40000001) && (uVar3 = uVar3 + iVar8, uVar3 <= uVar7)) &&
     (uVar2 = uVar3, auStackX_0 != (undefined *)0x8)) {
    local_8 = iVar8;
  }
LAB_00487be0:
  if (piVar6 == (int *)0x0) {
    piVar6 = aiStack_28;
  }
  if (uVar2 != 0) {
    iVar4 = *(int *)(param_1 + 4) + local_8;
    piVar6[1] = iVar4;
    piVar6[3] = uVar2 - local_8;
    piVar6[5] = 0;
    piVar6[2] = iVar4 + (uVar2 - local_8);
    *piVar6 = iVar4;
    piVar6[4] = 0;
    piVar6[6] = param_1;
    *param_2 = local_48;
    param_2[3] = local_3c;
    param_2[1] = local_44;
    param_2[2] = local_40;
    *(uint *)(param_1 + 4) = *(int *)(param_1 + 4) + uVar2;
    return uVar2;
  }
  piVar6[5] = 1;
  piVar6[6] = param_1;
  piVar6[2] = 0;
  piVar6[1] = 0;
  *piVar6 = 0;
  piVar6[3] = 0;
  piVar6[4] = 0;
  *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  return 0;
}



int psParseBufFinish(void **param_1)

{
  int iVar1;
  void *pvVar2;
  void *pvVar3;
  
  pvVar2 = param_1[6];
  if (pvVar2 == (void *)0x0) {
    pvVar2 = param_1[5];
  }
  else if (param_1[5] == (void *)0x0) {
    pvVar3 = *param_1;
    *param_1 = (void *)0x0;
    *(int *)((int)pvVar2 + 4) = (int)pvVar3 + (int)param_1[3];
    pvVar2 = (void *)0x0;
  }
  else {
    iVar1 = *(int *)((int)pvVar2 + 0x14);
    *param_1 = (void *)0x0;
    *(int *)((int)pvVar2 + 0x14) = iVar1 + 1;
    pvVar2 = param_1[5];
  }
  if ((undefined **)param_1[4] != &psStaticAllocationsPool) {
    free(*param_1);
  }
  param_1[4] = (void *)0x0;
  *param_1 = (void *)0x0;
  param_1[1] = (void *)0x0;
  param_1[2] = (void *)0x0;
  param_1[3] = (void *)0x0;
  param_1[6] = (void *)0x0;
  param_1[5] = (void *)0x0;
  return -(uint)(pvVar2 != (void *)0x0);
}



uint psParseBufTrySkipTag(void *param_1,char param_2)

{
  byte bVar1;
  void *pvVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  char *pcVar6;
  void **ppvVar7;
  uint uVar8;
  void *pvVar9;
  int iVar10;
  void *pvVar11;
  undefined auStackX_0 [16];
  void *local_58 [3];
  int local_4c;
  undefined **local_48;
  int local_44;
  int local_40;
  void *apvStack_38 [8];
  int local_18;
  
  pcVar6 = *(char **)((int)param_1 + 4);
  ppvVar7 = local_58;
  uVar8 = *(int *)((int)param_1 + 8) - (int)pcVar6;
  iVar5 = 1;
  iVar10 = 2;
  uVar3 = 0;
  if ((uVar8 < 2) || ((param_2 != '\0' && (*pcVar6 != param_2)))) goto LAB_00487f34;
  bVar1 = pcVar6[1];
  uVar3 = 1;
  if ((char)bVar1 < '\0') {
    uVar3 = 0;
    if ((((uVar8 < 0x83) || ((bVar1 == 0x81 && (-1 < pcVar6[2])))) ||
        ((bVar1 == 0x82 && (uVar3 = 0, pcVar6[2] == '\0')))) ||
       (((bVar1 == 0x83 && (uVar3 = 0, pcVar6[2] == '\0')) ||
        ((bVar1 == 0x84 && (uVar3 = 0, pcVar6[2] == '\0')))))) goto LAB_00487f34;
    if ((bVar1 == 0x80) || (0x84 < bVar1)) {
      uVar3 = 0;
      goto LAB_00487f34;
    }
    uVar3 = (uint)(byte)(bVar1 + 0x80);
    iVar5 = 2;
    iVar10 = uVar3 + 2;
  }
  uVar4 = 0;
  for (; uVar3 != 0; uVar3 = uVar3 - 1 & 0xff) {
    uVar4 = uVar4 * 0x100 + (uint)(byte)pcVar6[iVar5];
    iVar5 = iVar5 + 1;
  }
  uVar3 = 0;
  if (((uVar4 < 0x40000001) && (uVar4 = uVar4 + iVar10, uVar4 <= uVar8)) &&
     (uVar3 = uVar4, auStackX_0 != (undefined *)0x18)) {
    local_18 = iVar10;
  }
LAB_00487f34:
  iVar5 = local_18;
  if (ppvVar7 == (void **)0x0) {
    ppvVar7 = apvStack_38;
  }
  if (uVar3 != 0) {
    iVar10 = *(int *)((int)param_1 + 4);
    ppvVar7[6] = param_1;
    pvVar11 = (void *)(iVar10 + iVar5);
    pvVar9 = (void *)(uVar3 - iVar5);
    ppvVar7[2] = (void *)((int)pvVar11 + (int)pvVar9);
    ppvVar7[5] = (void *)0x0;
    *ppvVar7 = pvVar11;
    pvVar2 = local_58[0];
    ppvVar7[1] = pvVar11;
    ppvVar7[3] = pvVar9;
    ppvVar7[4] = (void *)0x0;
    if (local_40 != 0) {
      if (local_44 == 0) {
        local_58[0] = (void *)0x0;
        *(int *)(local_40 + 4) = (int)pvVar2 + local_4c;
      }
      else {
        local_58[0] = (void *)0x0;
        *(int *)(local_40 + 0x14) = *(int *)(local_40 + 0x14) + 1;
      }
    }
    if (local_48 != &psStaticAllocationsPool) {
      free(local_58[0]);
    }
    return uVar3;
  }
  ppvVar7[6] = param_1;
  ppvVar7[5] = (void *)0x1;
  ppvVar7[2] = (void *)0x0;
  ppvVar7[1] = (void *)0x0;
  *ppvVar7 = (void *)0x0;
  ppvVar7[3] = (void *)0x0;
  ppvVar7[4] = (void *)0x0;
  return 0;
}



int osdepTimeOpen(void)

{
  int iVar1;
  timeval tStack_10;
  
  iVar1 = gettimeofday(&tStack_10,(__timezone_ptr_t)0x0);
  return -(uint)(iVar1 < 0);
}



void osdepTimeClose(void)

{
  return;
}



__time_t psGetTime(timeval *param_1)

{
  int iVar1;
  __time_t _Var2;
  timeval local_10;
  
  if (param_1 == (timeval *)0x0) {
    iVar1 = gettimeofday(&local_10,(__timezone_ptr_t)0x0);
    _Var2 = -1;
    if (-1 < iVar1) {
      return local_10.tv_sec;
    }
  }
  else {
    iVar1 = gettimeofday(param_1,(__timezone_ptr_t)0x0);
    _Var2 = -1;
    if (-1 < iVar1) {
      _Var2 = param_1->tv_sec;
    }
  }
  return _Var2;
}



int psDiffMsecs(int param_1,int param_2,int param_3,int param_4)

{
  if (param_4 < param_2) {
    return ((param_3 + -1) - param_1) * 1000 + ((param_4 + 1000000) - param_2) / 1000;
  }
  return (param_3 - param_1) * 1000 + (param_4 - param_2) / 1000;
}



undefined4 osdepMutexOpen(void)

{
  return 0;
}



void osdepMutexClose(void)

{
  return;
}



void psLockMutex(pthread_mutex_t *param_1)

{
  int iVar1;
  
  iVar1 = pthread_mutex_lock(param_1);
  if (iVar1 == 0) {
    return;
  }
                    // WARNING: Subroutine does not return
  abort();
}



void psUnlockMutex(pthread_mutex_t *param_1)

{
  int iVar1;
  
  iVar1 = pthread_mutex_unlock(param_1);
  if (iVar1 == 0) {
    return;
  }
                    // WARNING: Subroutine does not return
  abort();
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int psDestroyMutex(pthread_mutex_t *__mutex)

{
  int iVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  iVar1 = FUN_00408660();
  return iVar1;
}



void osdepEntropyClose(void)

{
  if (DAT_004d7a14 != DAT_004d7a10) {
    close(DAT_004d7a14);
  }
  (*(code *)(undefined *)0x0)(DAT_004d7a10);
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



int psGetEntropy(void *param_1,size_t param_2)

{
  bool bVar1;
  bool bVar2;
  int iVar3;
  ssize_t sVar4;
  int *piVar5;
  int iVar6;
  int iVar7;
  
  iVar7 = 0;
  bVar2 = false;
  iVar6 = 0;
  if (param_2 != 0) {
    do {
      while ((sVar4 = read(DAT_004d7a14,param_1,param_2), sVar4 < 0 || (0x400 < iVar6))) {
        piVar5 = __errno_location();
        iVar3 = *piVar5;
        if (iVar3 == 4) {
          bVar1 = 0x400 < iVar6;
          iVar6 = iVar6 + 1;
          if (bVar1) {
            return -7;
          }
        }
        else {
          if (((iVar3 == 0xb) || (iVar3 != 9)) || (bVar2)) goto LAB_00488570;
          close(DAT_004d7a14);
          DAT_004d7a14 = open("/dev/random",0x80);
          if (DAT_004d7a14 < 0) goto LAB_00488570;
          bVar2 = true;
        }
        if (param_2 == 0) goto LAB_00488570;
      }
      param_2 = param_2 - sVar4;
      iVar7 = iVar7 + sVar4;
      param_1 = (void *)((int)param_1 + sVar4);
    } while (param_2 != 0);
LAB_00488570:
    bVar2 = false;
    iVar6 = 0;
    for (; param_2 != 0; param_2 = param_2 - sVar4) {
      while( true ) {
        sVar4 = read(DAT_004d7a10,param_1,param_2);
        if ((-1 < sVar4) && (iVar6 < 0x401)) break;
        piVar5 = __errno_location();
        bVar1 = 0x400 < iVar6;
        if (*piVar5 == 4) {
          iVar6 = iVar6 + 1;
          if (bVar1) {
            return -7;
          }
        }
        else {
          if (*piVar5 != 9) {
            return -7;
          }
          if (bVar2) {
            return -7;
          }
          close(DAT_004d7a10);
          DAT_004d7a10 = open("/dev/urandom",0x80);
          if (DAT_004d7a10 < 0) {
            return -7;
          }
          bVar2 = true;
        }
        if (param_2 == 0) {
          return iVar7;
        }
      }
      iVar7 = iVar7 + sVar4;
      param_1 = (void *)((int)param_1 + sVar4);
    }
  }
  return iVar7;
}



FILE * _psGetTraceFile(void)

{
  char *__filename;
  
  if (DAT_004d7a18 != (FILE *)0x0) {
    return DAT_004d7a18;
  }
  pthread_mutex_lock((pthread_mutex_t *)&DAT_004d7a1c);
  if (DAT_004d7a18 == (FILE *)0x0) {
    __filename = getenv("PSCORE_DEBUG_FILE");
    if (__filename == (char *)0x0) {
      __filename = getenv("PSCORE_DEBUG_FILE_APPEND");
    }
    else {
      DAT_004d7a18 = fopen(__filename,"w");
      if (DAT_004d7a18 == (FILE *)0x0) {
        fprintf(stderr,"%s: Unable to open file %s, %s.\n","_psGetTraceFile",__filename,
                "producing log to standard output");
        DAT_004d7a18 = stdout;
      }
    }
    if ((DAT_004d7a18 == (FILE *)0x0) && (__filename != (char *)0x0)) {
      DAT_004d7a18 = fopen(__filename,"a");
      if (DAT_004d7a18 == (FILE *)0x0) {
        fprintf(stderr,"%s: Unable to open file %s, %s.\n","_psGetTraceFile",__filename,
                "producing log to standard output");
        DAT_004d7a18 = stdout;
      }
    }
    if (DAT_004d7a18 == (FILE *)0x0) {
      DAT_004d7a18 = stdout;
      goto LAB_00488708;
    }
  }
  else {
LAB_00488708:
    if (DAT_004d7a18 == (FILE *)0x0) goto LAB_00488718;
  }
  setvbuf(DAT_004d7a18,(char *)0x0,2,0);
LAB_00488718:
  pthread_mutex_unlock((pthread_mutex_t *)&DAT_004d7a1c);
  return DAT_004d7a18;
}



void _psTraceInt(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  
  iVar1 = _psGetTraceFile();
  if (iVar1 == 0) {
    return;
  }
  (*(code *)(undefined *)0x0)(iVar1,param_1,param_2);
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



void _psTraceStr(undefined4 param_1,int param_2)

{
  int iVar1;
  
  iVar1 = _psGetTraceFile();
  if (param_2 == 0) {
    if (iVar1 == 0) {
      return;
    }
  }
  else {
    if (iVar1 == 0) {
      return;
    }
    (*(code *)(undefined *)0x0)(iVar1,param_1,param_2);
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
    (*(code *)(undefined *)0x0)();
  }
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



undefined4 osdepEntropyOpen(void)

{
  undefined4 uVar1;
  FILE *pFVar2;
  
  DAT_004d7a10 = open("/dev/urandom",0);
  if (DAT_004d7a10 < 0) {
    pFVar2 = (FILE *)_psGetTraceFile();
    if (pFVar2 != (FILE *)0x0) {
      fprintf(pFVar2,"psError %s","POSIX/osdep.c");
    }
    pFVar2 = (FILE *)_psGetTraceFile();
    if (pFVar2 != (FILE *)0x0) {
      fprintf(pFVar2,":%d ",0x155);
    }
    _psErrorInt("open of urandom failed %d\n",DAT_004d7a10);
    uVar1 = 0xfffffff9;
  }
  else {
    DAT_004d7a14 = open("/dev/random",0x80);
    if (DAT_004d7a14 < 0) {
      DAT_004d7a14 = DAT_004d7a10;
    }
    uVar1 = 0;
  }
  return uVar1;
}



undefined4 psCreateMutex(pthread_mutex_t *param_1,uint param_2)

{
  int iVar1;
  FILE *pFVar2;
  char *pcVar3;
  pthread_mutexattr_t apStack_18 [2];
  
  if ((param_2 & 0xfffffffe) == 0) {
    iVar1 = pthread_mutexattr_init(apStack_18);
    if (iVar1 < 0) {
      pFVar2 = (FILE *)_psGetTraceFile();
      if (pFVar2 != (FILE *)0x0) {
        fprintf(pFVar2,"psError %s","POSIX/osdep.c");
      }
      pFVar2 = (FILE *)_psGetTraceFile();
      if (pFVar2 != (FILE *)0x0) {
        fprintf(pFVar2,":%d ",0x110);
      }
      _psErrorInt("pthread_mutexattr_init failed %d\n",iVar1);
      return 0xfffffff9;
    }
    if (((param_2 & 1) == 0) ||
       (param_2 = pthread_mutexattr_setpshared(apStack_18,1), -1 < (int)param_2)) {
      param_2 = pthread_mutex_init(param_1,apStack_18);
      if (param_2 == 0) {
        pthread_mutexattr_destroy(apStack_18);
        return 0;
      }
      pthread_mutexattr_destroy(apStack_18);
      pFVar2 = (FILE *)_psGetTraceFile();
      if (pFVar2 != (FILE *)0x0) {
        fprintf(pFVar2,"psError %s","POSIX/osdep.c");
      }
      pFVar2 = (FILE *)_psGetTraceFile();
      if (pFVar2 != (FILE *)0x0) {
        fprintf(pFVar2,":%d ",0x11e);
      }
      pcVar3 = "pthread_mutex_init failed %d\n";
    }
    else {
      pthread_mutexattr_destroy(apStack_18);
      pFVar2 = (FILE *)_psGetTraceFile();
      if (pFVar2 != (FILE *)0x0) {
        fprintf(pFVar2,"psError %s","POSIX/osdep.c");
      }
      pFVar2 = (FILE *)_psGetTraceFile();
      if (pFVar2 != (FILE *)0x0) {
        fprintf(pFVar2,":%d ",0x118);
      }
      pcVar3 = "pthread_mutexattr shared failed %d\n";
    }
  }
  else {
    pFVar2 = (FILE *)_psGetTraceFile();
    if (pFVar2 != (FILE *)0x0) {
      fprintf(pFVar2,"psError %s","POSIX/osdep.c");
    }
    pFVar2 = (FILE *)_psGetTraceFile();
    if (pFVar2 != (FILE *)0x0) {
      fprintf(pFVar2,":%d ",0x10b);
    }
    pcVar3 = "psCreateMutex unsupported flag %u\n";
  }
  _psErrorInt(pcVar3,param_2);
  return 0xfffffff9;
}



void _psTrace(undefined4 param_1)

{
  int iVar1;
  
  iVar1 = _psGetTraceFile();
  if (iVar1 == 0) {
    return;
  }
  (*(code *)(undefined *)0x0)(param_1,iVar1);
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



undefined4 psGetFileBufFp(undefined4 param_1,FILE *param_2,void **param_3,int *param_4)

{
  int iVar1;
  void *__s;
  size_t sVar2;
  undefined4 uVar3;
  stat sStack_a8;
  
  iVar1 = fileno(param_2);
  iVar1 = fstat(iVar1,&sStack_a8);
  if (iVar1 == 0) {
    __s = malloc(sStack_a8.st_atim.tv_sec + 1);
    *param_3 = __s;
    if (__s == (void *)0x0) {
      fclose(param_2);
      uVar3 = 0xfffffff8;
    }
    else {
      memset(__s,0,sStack_a8.st_atim.tv_sec + 1);
      iVar1 = *param_4;
      while( true ) {
        sVar2 = fread((void *)((int)*param_3 + iVar1),1,0x200,param_2);
        if ((sVar2 == 0) || (iVar1 = *param_4 + sVar2, sStack_a8.st_atim.tv_sec <= *param_4)) break;
        *param_4 = iVar1;
      }
      fclose(param_2);
      uVar3 = 0;
    }
  }
  else {
    fclose(param_2);
    uVar3 = 0xfffffff9;
  }
  return uVar3;
}



// WARNING: Switch with 1 destination removed at 0x00489068

undefined4 psGetFileBuf(undefined4 param_1,char *param_2,int *param_3,int *param_4)

{
  int iVar1;
  FILE *pFVar2;
  undefined4 uVar3;
  int iVar4;
  undefined auStack_a8 [56];
  int iStack_70;
  undefined *local_18;
  
  local_18 = &_gp;
  *param_4 = 0;
  *param_3 = 0;
  uVar3 = 0xfffffffa;
  if (param_2 != (char *)0x0) {
    pFVar2 = fopen(param_2,"r");
    iVar4 = *(int *)(local_18 + -0x7098);
    uVar3 = 0xfffffff9;
    if (pFVar2 != (FILE *)0x0) {
      uVar3 = (**(code **)(iVar4 + 0x4f1d4))(pFVar2);
      iVar1 = (**(code **)(iVar4 + 0x4f8b8))(uVar3,auStack_a8);
      if (iVar1 == 0) {
        iVar1 = (**(code **)(iVar4 + 0x4faf4))(iStack_70 + 1);
        *param_3 = iVar1;
        if (iVar1 == 0) {
          (**(code **)(iVar4 + 0x4f56c))(pFVar2);
          uVar3 = 0xfffffff8;
        }
        else {
          (**(code **)(iVar4 + 0x4f5b4))(iVar1,0,iStack_70 + 1);
          iVar1 = *param_4;
          while ((iVar1 = (**(code **)(iVar4 + 0x4f618))(*param_3 + iVar1,1,0x200,pFVar2),
                 iVar1 != 0 && (iVar1 = *param_4 + iVar1, *param_4 < iStack_70))) {
            *param_4 = iVar1;
          }
          (**(code **)(iVar4 + 0x4f56c))(pFVar2);
          uVar3 = 0;
        }
      }
      else {
        (**(code **)(iVar4 + 0x4f56c))(pFVar2);
        uVar3 = 0xfffffff9;
      }
      return uVar3;
    }
  }
  return uVar3;
}



void FUN_00489090(void)

{
  code **ppcVar1;
  code *pcVar2;
  
  if (DAT_004d4a68 != (code *)0xffffffff) {
    ppcVar1 = (code **)&DAT_004d4a64;
    pcVar2 = DAT_004d4a68;
    do {
      (*pcVar2)();
      pcVar2 = *ppcVar1;
      ppcVar1 = ppcVar1 + -1;
    } while (pcVar2 != (code *)0xffffffff);
  }
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strcpy(char *__dest,char *__src)

{
  char *pcVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t waitpid(__pid_t __pid,int *__stat_loc,int __options)

{
  __pid_t _Var1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  _Var1 = FUN_00408660();
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int ioctl(int __fd,ulong __request,...)

{
  int iVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int printf(char *__format,...)

{
  int iVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t recv(int __fd,void *__buf,size_t __n,int __flags)

{
  ssize_t sVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  sVar1 = FUN_00408660();
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sigemptyset(sigset_t *__set)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strerror(int __errnum)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memmove(void *__dest,void *__src,size_t __n)

{
  void *pvVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pvVar1 = (void *)FUN_00408660();
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int snprintf(char *__s,size_t __maxlen,char *__format,...)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int munmap(void *__addr,size_t __len)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long atol(char *__nptr)

{
  long lVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  lVar1 = FUN_00408660();
  return lVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * getenv(char *__name)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int usleep(__useconds_t __useconds)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int execve(char *__path,char **__argv,char **__envp)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t getpid(void)

{
  __pid_t _Var1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  _Var1 = FUN_00408660();
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * fgets(char *__s,int __n,FILE *__stream)

{
  char *pcVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memcpy(void *__dest,void *__src,size_t __n)

{
  void *pvVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  pvVar1 = (void *)FUN_00408660();
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int setvbuf(FILE *__stream,char *__buf,int __modes,size_t __n)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutexattr_destroy(pthread_mutexattr_t *__attr)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int puts(char *__s)

{
  int iVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int system(char *__command)

{
  int iVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int feof(FILE *__stream)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * malloc(size_t __size)

{
  void *pvVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pvVar1 = (void *)FUN_00408660();
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int remove(char *__filename)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

uint sleep(uint __seconds)

{
  uint uVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  uVar1 = FUN_00408660();
  return uVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int vsnprintf(char *__s,size_t __maxlen,char *__format,__gnuc_va_list __arg)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int socket(int __domain,int __type,int __protocol)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int select(int __nfds,fd_set *__readfds,fd_set *__writefds,fd_set *__exceptfds,timeval *__timeout)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__off_t lseek(int __fd,__off_t __offset,int __whence)

{
  __off_t _Var1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  _Var1 = FUN_00408660();
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * mmap(void *__addr,size_t __len,int __prot,int __flags,int __fd,__off_t __offset)

{
  void *pvVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pvVar1 = (void *)FUN_00408660();
  return pvVar1;
}



void nvram_bufget(void)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strncasecmp(char *__s1,char *__s2,size_t __n)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t send(int __fd,void *__buf,size_t __n,int __flags)

{
  ssize_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void abort(void)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

tm * gmtime_r(time_t *__timer,tm *__tp)

{
  tm *ptVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  ptVar1 = (tm *)FUN_00408660();
  return ptVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

long strtol(char *__nptr,char **__endptr,int __base)

{
  long lVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  lVar1 = FUN_00408660();
  return lVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int accept(int __fd,sockaddr *__addr,socklen_t *__addr_len)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strrchr(char *__s,int __c)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int nanosleep(timespec *__requested_time,timespec *__remaining)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t write(int __fd,void *__buf,size_t __n)

{
  ssize_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

double atof(char *__nptr)

{
  double dVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  dVar1 = (double)FUN_00408660();
  return dVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fstat(int __fd,stat *__buf)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fprintf(FILE *__stream,char *__format,...)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * ctime(time_t *__timer)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strcat(char *__dest,char *__src)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int bind(int __fd,sockaddr *__addr,socklen_t __len)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

in_addr_t inet_addr(char *__cp)

{
  in_addr_t iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int setsockopt(int __fd,int __level,int __optname,void *__optval,socklen_t __optlen)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fseek(FILE *__stream,long __off,int __whence)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memchr(void *__s,int __c,size_t __n)

{
  void *pvVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pvVar1 = (void *)FUN_00408660();
  return pvVar1;
}



void crc32(void)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strstr(char *__haystack,char *__needle)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int rand(void)

{
  int iVar1;
  
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__sighandler_t signal(int __sig,__sighandler_t __handler)

{
  __sighandler_t p_Var1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  p_Var1 = (__sighandler_t)FUN_00408660();
  return p_Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

ssize_t read(int __fd,void *__buf,size_t __nbytes)

{
  ssize_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strncmp(char *__s1,char *__s2,size_t __n)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strncpy(char *__dest,char *__src,size_t __n)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strcasecmp(char *__s1,char *__s2)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * realloc(void *__ptr,size_t __size)

{
  void *pvVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pvVar1 = (void *)FUN_00408660();
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strtok(char *__s,char *__delim)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int memcmp(void *__s1,void *__s2,size_t __n)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int listen(int __fd,int __n)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t fork(void)

{
  __pid_t _Var1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  _Var1 = FUN_00408660();
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sscanf(char *__s,char *__format,...)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sigaction(int __sig,sigaction *__act,sigaction *__oact)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t fread(void *__ptr,size_t __size,size_t __n,FILE *__stream)

{
  size_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



void __uClibc_main(void)

{
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  (*(code *)(undefined *)0x0)();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int gettimeofday(timeval *__tv,__timezone_ptr_t __tz)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

FILE * fopen(char *__filename,char *__modes)

{
  FILE *pFVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pFVar1 = (FILE *)FUN_00408660();
  return pFVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

tm * localtime(time_t *__timer)

{
  tm *ptVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  ptVar1 = (tm *)FUN_00408660();
  return ptVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void * memset(void *__s,int __c,size_t __n)

{
  void *pvVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pvVar1 = (void *)FUN_00408660();
  return pvVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void srand(uint __seed)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fclose(FILE *__stream)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * inet_ntoa(in_addr __in)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

time_t time(time_t *__timer)

{
  time_t tVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  tVar1 = FUN_00408660();
  return tVar1;
}



void nvram_commit(void)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutexattr_setpshared(pthread_mutexattr_t *__attr,int __pshared)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int strcmp(char *__s1,char *__s2)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int shutdown(int __fd,int __how)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_unlock(pthread_mutex_t *__mutex)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int sprintf(char *__s,char *__format,...)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strcspn(char *__s,char *__reject)

{
  size_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



void nvram_bufset(void)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void srandom(uint __seed)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



void nvram_close(void)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutexattr_init(pthread_mutexattr_t *__attr)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strftime(char *__s,size_t __maxsize,char *__format,tm *__tp)

{
  size_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int stat(char *__file,stat *__buf)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t fwrite(void *__ptr,size_t __size,size_t __n,FILE *__s)

{
  size_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int access(char *__name,int __type)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_destroy(pthread_mutex_t *__mutex)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void rewind(FILE *__stream)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_lock(pthread_mutex_t *__mutex)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int * __errno_location(void)

{
  int *piVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  piVar1 = (int *)FUN_00408660();
  return piVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void exit(int __status)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int atoi(char *__nptr)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fileno(FILE *__stream)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strspn(char *__s,char *__accept)

{
  size_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * tempnam(char *__dir,char *__pfx)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int pthread_mutex_init(pthread_mutex_t *__mutex,pthread_mutexattr_t *__mutexattr)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

size_t strlen(char *__s)

{
  size_t sVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  sVar1 = FUN_00408660();
  return sVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int open(char *__file,int __oflag,...)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



void nvram_init(void)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void __assert(char *__assertion,char *__file,int __line)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

char * strchr(char *__s,int __c)

{
  char *pcVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  pcVar1 = (char *)FUN_00408660();
  return pcVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fputs(char *__s,FILE *__stream)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int fcntl(int __fd,int __cmd,...)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

__pid_t getpgid(__pid_t __pid)

{
  __pid_t _Var1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  _Var1 = FUN_00408660();
  return _Var1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int close(int __fd)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int vfprintf(FILE *__s,char *__format,__gnuc_va_list __arg)

{
  int iVar1;
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  iVar1 = FUN_00408660();
  return iVar1;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

void free(void *__ptr)

{
  int unaff_gp;
  
  (**(code **)(unaff_gp + -0x7ff0))();
  (**(code **)(unaff_gp + -0x7ff0))();
  FUN_00408660();
  return;
}



// WARNING: Unknown calling convention -- yet parameter storage is locked

int getsockname(int __fd,sockaddr *__addr,socklen_t *__len)

{
  int iVar1;
  
  (*(code *)(undefined *)0x0)();
  iVar1 = FUN_00408660();
  return iVar1;
}



void _fini(void)

{
  FUN_00408660();
  return;
}


